<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="AugmentWebviewStateStore">
    <option name="stateMap">
      <map>
        <entry key="CHAT_STATE" value="eyJjdXJyZW50Q29udmVyc2F0aW9uSWQiOiJlMzE0YzcwMC0wOTUzLTRmM2MtODBkMS0yOTlmOWM3ZTZjMTMiLCJjb252ZXJzYXRpb25zIjp7ImEwYWU2ZDYwLTM4MWEtNDJhYi04NmFkLTE3NDJmYWQxY2ZiYyI6eyJpZCI6ImEwYWU2ZDYwLTM4MWEtNDJhYi04NmFkLTE3NDJmYWQxY2ZiYyIsIm5hbWUiOiJXZWxjb21lIHRvIHRoZSBBdWdtZW50IEFnZW50IiwiY3JlYXRlZEF0SXNvIjoiMjAyNS0wNC0yMVQxNTo1NzowOS41MTFaIiwibGFzdEludGVyYWN0ZWRBdElzbyI6IjIwMjUtMDQtMjJUMDQ6NDQ6MzYuOTQxWiIsImNoYXRIaXN0b3J5IjpbeyJyZXF1ZXN0X2lkIjoiOTE3OWY3NDQtZDNmNS00ZWMyLTgyZjctMDM5NWI4NWIxMDE0IiwidXVpZCI6ImM1YzExMGQ5LTBmYjItNGM1Mi05NTRkLWEyMGE4M2QyOTUzNiIsImNoYXRJdGVtVHlwZSI6ImFnZW50aWMtY2hlY2twb2ludC1kZWxpbWl0ZXIiLCJzdGF0dXMiOiJzdWNjZXNzIiwiZnJvbVRpbWVzdGFtcCI6MCwidG9UaW1lc3RhbXAiOjE3NDUyNTEwMjk1MTMsInNlZW5fc3RhdGUiOiJzZWVuIn0seyJzdGF0dXMiOiJzdWNjZXNzIiwicmVxdWVzdF9pZCI6ImRkZmFkYThmLTcwMWMtNGI3Ny04ZmZlLTYwY2MwMDQxYmQ5YSIsInJlcXVlc3RfbWVzc2FnZSI6IkzDoG0gY2hvIHTDtGkgdHJhbmcgcXXhuqNuIGzDrSBraHV54bq/biBtw6NpIGdp4buRbmcgdHJhbmcgTGljaFRyaW5oVGF1UGFuZWwgIiwicmljaF90ZXh0X2pzb25fcmVwciI6eyJ0eXBlIjoiZG9jIiwiY29udGVudCI6W3sidHlwZSI6InBhcmFncmFwaCIsImNvbnRlbnQiOlt7InR5cGUiOiJ0ZXh0IiwidGV4dCI6IkzDoG0gY2hvIHTDtGkgdHJhbmcgcXXhuqNuIGzDrSBraHV54bq/biBtw6NpIGdp4buRbmcgdHJhbmcgTGljaFRyaW5oVGF1UGFuZWwgIn1dfV19LCJtZW50aW9uZWRfaXRlbXMiOltdLCJzdHJ1Y3R1cmVkX291dHB1dF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjUsImNvbnRlbnQiOiIiLCJ0b29sX3VzZSI6eyJ0b29sX3VzZV9pZCI6InRvb2x1XzAxTHlxS0VvWGthcXBOUU5uc1d3eGs4NyIsInRvb2xfbmFtZSI6InN0ci1yZXBsYWNlLWVkaXRvciIsImlucHV0X2pzb24iOiJ7XCJjb21tYW5kXCI6IFwidmlld1wiLCBcInBhdGhcIjogXCJzcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9MaWNoVHJpbmhUYXVQYW5lbC5qYXZhXCJ9In19LHsiaWQiOjAsInR5cGUiOjAsImNvbnRlbnQiOiJJJ2xsIGhlbHAgeW91IGNyZWF0ZSBhIHByb21vdGlvbiBtYW5hZ2VtZW50IHBhZ2Ugc2ltaWxhciB0byB0aGUgTGljaFRyaW5oVGF1UGFuZWwuIExldCBtZSBmaXJzdCBleGFtaW5lIHRoZSBMaWNoVHJpbmhUYXVQYW5lbCB0byB1bmRlcnN0YW5kIGl0cyBzdHJ1Y3R1cmUgYW5kIGZ1bmN0aW9uYWxpdHksIHRoZW4gY3JlYXRlIGEgc2ltaWxhciBwYWdlIGZvciBwcm9tb3Rpb24gbWFuYWdlbWVudC5cblxuIyMgSW5mb3JtYXRpb24gR2F0aGVyaW5nXG5cbkxldCdzIGZpcnN0IGxvb2sgYXQgdGhlIExpY2hUcmluaFRhdVBhbmVsLmphdmEgZmlsZTpcbiJ9LHsiaWQiOjIsInR5cGUiOjIsImNvbnRlbnQiOiIifSx7ImlkIjozLCJ0eXBlIjozLCJjb250ZW50IjoiIn1dLCJzZWVuX3N0YXRlIjoic2VlbiIsInN0cnVjdHVyZWRfcmVxdWVzdF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjAsInRleHRfbm9kZSI6eyJjb250ZW50IjoiTMOgbSBjaG8gdMO0aSB0cmFuZyBxdeG6o24gbMOtIGtodXnhur9uIG3Do2kgZ2nhu5FuZyB0cmFuZyBMaWNoVHJpbmhUYXVQYW5lbCAifX0seyJpZCI6MiwidHlwZSI6NCwiaWRlX3N0YXRlX25vZGUiOnsid29ya3NwYWNlRm9sZGVycyI6W3sicmVwb3NpdG9yeVJvb3QiOiJFOi9MVFBUSkFWQS9OaG9tL1BoYW5UYW5KYXZhTmhvbUdQVC9Qcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyIsImZvbGRlclJvb3QiOiJFOi9MVFBUSkFWQS9OaG9tL1BoYW5UYW5KYXZhTmhvbUdQVC9Qcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyJ9XSwid29ya3NwYWNlRm9sZGVyc1VuY2hhbmdlZCI6ZmFsc2V9fV0sInJlc3BvbnNlX3RleHQiOiJJJ2xsIGhlbHAgeW91IGNyZWF0ZSBhIHByb21vdGlvbiBtYW5hZ2VtZW50IHBhZ2Ugc2ltaWxhciB0byB0aGUgTGljaFRyaW5oVGF1UGFuZWwuIExldCBtZSBmaXJzdCBleGFtaW5lIHRoZSBMaWNoVHJpbmhUYXVQYW5lbCB0byB1bmRlcnN0YW5kIGl0cyBzdHJ1Y3R1cmUgYW5kIGZ1bmN0aW9uYWxpdHksIHRoZW4gY3JlYXRlIGEgc2ltaWxhciBwYWdlIGZvciBwcm9tb3Rpb24gbWFuYWdlbWVudC5cblxuIyMgSW5mb3JtYXRpb24gR2F0aGVyaW5nXG5cbkxldCdzIGZpcnN0IGxvb2sgYXQgdGhlIExpY2hUcmluaFRhdVBhbmVsLmphdmEgZmlsZTpcbiIsIndvcmtzcGFjZV9maWxlX2NodW5rcyI6W119LHsic3RhdHVzIjoic3VjY2VzcyIsInJlcXVlc3RfaWQiOiJmOGQ1ZjE4My1mZGMxLTQzOWEtYTVjNS1jMjc4ODZjNTkzMjgiLCJyZXF1ZXN0X21lc3NhZ2UiOiIiLCJzdHJ1Y3R1cmVkX291dHB1dF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjUsImNvbnRlbnQiOiIiLCJ0b29sX3VzZSI6eyJ0b29sX3VzZV9pZCI6InRvb2x1XzAxRW1Qbm1uaU5uSFBDMkRDMUh5NXRwVyIsInRvb2xfbmFtZSI6ImNvZGViYXNlLXJldHJpZXZhbCIsImlucHV0X2pzb24iOiJ7XCJpbmZvcm1hdGlvbl9yZXF1ZXN0XCI6IFwiRmluZCB0aGUgbW9kZWwgY2xhc3NlcyByZWxhdGVkIHRvIExpY2hUcmluaFRhdSwgVGF1LCBhbmQgVHJhbmdUaGFpLiBBbHNvLCBsb29rIGZvciBhbnkgREFPIGNsYXNzZXMgcmVsYXRlZCB0byBwcm9tb3Rpb25zIG9yIGRpc2NvdW50cy5cIn0ifX0seyJpZCI6MCwidHlwZSI6MCwiY29udGVudCI6IkxldCBtZSBleGFtaW5lIHRoZSBtb2RlbCBjbGFzc2VzIHRvIHVuZGVyc3RhbmQgdGhlIGRhdGEgc3RydWN0dXJlOlxuIn0seyJpZCI6MiwidHlwZSI6MiwiY29udGVudCI6IiJ9LHsiaWQiOjMsInR5cGUiOjMsImNvbnRlbnQiOiIifV0sInNlZW5fc3RhdGUiOiJzZWVuIiwic3RydWN0dXJlZF9yZXF1ZXN0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6MSwidG9vbF9yZXN1bHRfbm9kZSI6eyJjb250ZW50IjoiSGVyZSdzIHRoZSByZXN1bHQgb2YgcnVubmluZyBgY2F0IC1uYCBvbiBzcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9MaWNoVHJpbmhUYXVQYW5lbC5qYXZhOlxuICAgICAxXHRwYWNrYWdlIGd1aUNsaWVudDtcbiAgICAgMlx0XG4gICAgIDNcdGltcG9ydCBjb20udG9lZHRlci5jYWxlbmRhci5KRGF0ZUNob29zZXI7XG4gICAgIDRcdGltcG9ydCBkYW8uTGljaFRyaW5oVGF1REFPO1xuICAgICA1XHRpbXBvcnQgZGFvLlRhdURBTztcbiAgICAgNlx0aW1wb3J0IG1vZGVsLkxpY2hUcmluaFRhdTtcbiAgICAgN1x0aW1wb3J0IG1vZGVsLlRhdTtcbiAgICAgOFx0aW1wb3J0IG1vZGVsLlRyYW5nVGhhaTtcbiAgICAgOVx0aW1wb3J0IHNlcnZpY2UuQUlUcmF2ZWxUaW1lUHJlZGljdG9yO1xuICAgIDEwXHRpbXBvcnQgc2VydmljZS5TY2hlZHVsZVN0YXR1c01hbmFnZXI7XG4gICAgMTFcdFxuICAgIDEyXHRpbXBvcnQgamF2YXguc3dpbmcuZXZlbnQuRG9jdW1lbnRMaXN0ZW5lcjtcbiAgICAxM1x0aW1wb3J0IGphdmF4LnN3aW5nLmV2ZW50LkRvY3VtZW50RXZlbnQ7XG4gICAgMTRcdGltcG9ydCBqYXZhLmF3dC5ldmVudC5LZXlBZGFwdGVyO1xuICAgIDE1XHRpbXBvcnQgamF2YS5hd3QuZXZlbnQuS2V5RXZlbnQ7XG4gICAgMTZcdGltcG9ydCBqYXZhLmJlYW5zLlByb3BlcnR5Q2hhbmdlTGlzdGVuZXI7XG4gICAgMTdcdGltcG9ydCBqYXZhLnRpbWUuZm9ybWF0LkRhdGVUaW1lUGFyc2VFeGNlcHRpb247XG4gICAgMThcdGltcG9ydCBqYXZhLnV0aWwuKjtcbiAgICAxOVx0aW1wb3J0IGphdmF4Lm5hbWluZy5Db250ZXh0O1xuICAgIDIwXHRpbXBvcnQgamF2YXgubmFtaW5nLkluaXRpYWxDb250ZXh0O1xuICAgIDIxXHRpbXBvcnQgamF2YXguc3dpbmcuKjtcbiAgICAyMlx0aW1wb3J0IGphdmF4LnN3aW5nLnRhYmxlLkRlZmF1bHRUYWJsZUNlbGxSZW5kZXJlcjtcbiAgICAyM1x0aW1wb3J0IGphdmF4LnN3aW5nLnRhYmxlLkRlZmF1bHRUYWJsZU1vZGVsO1xuICAgIDI0XHRpbXBvcnQgamF2YXguc3dpbmcudGFibGUuSlRhYmxlSGVhZGVyO1xuICAgIDI1XHRpbXBvcnQgamF2YS5hd3QuKjtcbiAgICAyNlx0aW1wb3J0IGphdmEuYXd0LmV2ZW50LkFjdGlvbkV2ZW50O1xuICAgIDI3XHRpbXBvcnQgamF2YS5hd3QuZXZlbnQuS2V5QWRhcHRlcjtcbiAgICAyOFx0aW1wb3J0IGphdmEuYXd0LmV2ZW50LktleUV2ZW50O1xuICAgIDI5XHRpbXBvcnQgamF2YS5hd3QuaW1hZ2UuQnVmZmVyZWRJbWFnZTtcbiAgICAzMFx0aW1wb3J0IGphdmEucm1pLlJlbW90ZUV4Y2VwdGlvbjtcbiAgICAzMVx0aW1wb3J0IGphdmEucm1pLnJlZ2lzdHJ5LkxvY2F0ZVJlZ2lzdHJ5O1xuICAgIDMyXHRpbXBvcnQgamF2YS5ybWkucmVnaXN0cnkuUmVnaXN0cnk7XG4gICAgMzNcdGltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlO1xuICAgIDM0XHRpbXBvcnQgamF2YS50aW1lLkxvY2FsRGF0ZVRpbWU7XG4gICAgMzVcdGltcG9ydCBqYXZhLnRpbWUuTG9jYWxUaW1lO1xuICAgIDM2XHRpbXBvcnQgamF2YS50aW1lLlpvbmVJZDtcbiAgICAzN1x0aW1wb3J0IGphdmEudGltZS5mb3JtYXQuRGF0ZVRpbWVGb3JtYXR0ZXI7XG4gICAgMzhcdGltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0O1xuICAgIDM5XHRpbXBvcnQgamF2YS51dGlsLkxpc3Q7XG4gICAgNDBcdGltcG9ydCBqYXZhLnV0aWwubG9nZ2luZy5MZXZlbDtcbiAgICA0MVx0aW1wb3J0IGphdmEudXRpbC5sb2dnaW5nLkxvZ2dlcjtcbiAgICA0Mlx0aW1wb3J0IGphdmEudXRpbC5zdHJlYW0uQ29sbGVjdG9ycztcbiAgICA0M1x0XG4gICAgNDRcdHB1YmxpYyBjbGFzcyBMaWNoVHJpbmhUYXVQYW5lbCBleHRlbmRzIEpQYW5lbCB7XG4gICAgNDVcdFxuICAgIDQ2XHQgICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9nZ2VyIExPR0dFUiA9IExvZ2dlci5nZXRMb2dnZXIoTGljaFRyaW5oVGF1UGFuZWwuY2xhc3MuZ2V0TmFtZSgpKTtcbiAgICA0N1x0ICAgIC8vIMSQ4buLYSBjaOG7iSBJUCB2w6AgcG9ydCBj4bunYSBSTUkgc2VydmVyXG4gICAgNDhcdCAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmcgUk1JX1NFUlZFUl9JUCA9IFwiMTI3LjAuMC4xXCI7XG4gICAgNDlcdCAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBpbnQgUk1JX1NFUlZFUl9QT1JUID0gOTA5MDtcbiAgICA1MFx0ICAgIHByaXZhdGUgSlRhYmxlIHNjaGVkdWxlVGFibGU7XG4gICAgNTFcdCAgICBwcml2YXRlIERlZmF1bHRUYWJsZU1vZGVsIHRhYmxlTW9kZWw7XG4gICAgNTJcdCAgICBwcml2YXRlIEpEYXRlQ2hvb3NlciBkYXRlQ2hvb3NlcjtcbiAgICA1M1x0ICAgIHByaXZhdGUgSkJ1dHRvbiBzZWFyY2hCdXR0b247XG4gICAgNTRcdCAgICBwcml2YXRlIEpCdXR0b24gcmVmcmVzaEJ1dHRvbjtcbiAgICA1NVx0ICAgIHByaXZhdGUgSkJ1dHRvbiBhZGRCdXR0b247XG4gICAgNTZcdCAgICBwcml2YXRlIEpCdXR0b24gZWRpdEJ1dHRvbjtcbiAgICA1N1x0ICAgIHByaXZhdGUgSkJ1dHRvbiBkZWxldGVCdXR0b247XG4gICAgNThcdCAgICBwcml2YXRlIEpDb21ib0JveDxPYmplY3Q+IGZpbHRlckNvbWJvQm94O1xuICAgIDU5XHQgICAgcHJpdmF0ZSBKVGFiYmVkUGFuZSB2aWV3VGFiYmVkUGFuZTsgLy8gVGFiIMSR4buDIGNodXnhu4NuIMSR4buVaSBnaeG7r2EgZOG6oW5nIGLhuqNuZyB2w6AgbOG7i2NoXG4gICAgNjBcdCAgICBwcml2YXRlIFRyYWluU2NoZWR1bGVDYWxlbmRhclBhbmVsIGNhbGVuZGFyUGFuZWw7IC8vIFBhbmVsIGThuqFuZyBs4buLY2hcbiAgICA2MVx0ICAgIHByaXZhdGUgSlBhbmVsIHRhYmxlVmlld1BhbmVsOyAvLyBQYW5lbCBjaOG7qWEgYuG6o25nXG4gICAgNjJcdFxuICAgIDYzXHQgICAgcHJpdmF0ZSBMaWNoVHJpbmhUYXVEQU8gbGljaFRyaW5oVGF1REFPO1xuICAgIDY0XHQgICAgcHJpdmF0ZSBib29sZWFuIGlzQ29ubmVjdGVkID0gZmFsc2U7XG4gICAgNjVcdCAgICBwcml2YXRlIHN0YXRpYyBMb2NhbERhdGUgbGFzdEdlbmVyYXRlZERhdGUgPSBMb2NhbERhdGUubm93KCk7XG4gICAgNjZcdCAgICBwcml2YXRlIHN0YXRpYyBpbnQgY291bnQgPSAwO1xuICAgIDY3XHQgICAgcHJpdmF0ZSBTY2hlZHVsZVN0YXR1c01hbmFnZXIgc3RhdHVzTWFuYWdlcjtcbiAgICA2OFx0ICAgIHByaXZhdGUgQUlUcmF2ZWxUaW1lUHJlZGljdG9yIGFpUHJlZGljdG9yO1xuICAgIDY5XHQgICAgcHJpdmF0ZSBDaGF0Ym90RGlhbG9nIGNoYXRib3REaWFsb2c7XG4gICAgNzBcdFxuICAgIDcxXHQgICAgcHVibGljIExpY2hUcmluaFRhdVBhbmVsKCkge1xuICAgIDcyXHQgICAgICAgIHNldExheW91dChuZXcgQm9yZGVyTGF5b3V0KDEwLCAxMCkpO1xuICAgIDczXHQgICAgICAgIHNldEJvcmRlcihCb3JkZXJGYWN0b3J5LmNyZWF0ZUVtcHR5Qm9yZGVyKDEwLCAxMCwgMTAsIDEwKSk7XG4gICAgNzRcdFxuICAgIDc1XHQgICAgICAgIC8vIENvbm5lY3QgdG8gUk1JIHNlcnZlclxuICAgIDc2XHQgICAgICAgIGNvbm5lY3RUb1JNSVNlcnZlcigpO1xuICAgIDc3XHRcbiAgICA3OFx0ICAgICAgICAvLyBBZGQgY29tcG9uZW50cyB0byB0aGUgcGFuZWxcbiAgICA3OVx0ICAgICAgICBhZGQoY3JlYXRlVGl0bGVQYW5lbCgpLCBCb3JkZXJMYXlvdXQuTk9SVEgpO1xuICAgIDgwXHQgICAgICAgIGFkZChjcmVhdGVDZW50ZXJQYW5lbCgpLCBCb3JkZXJMYXlvdXQuQ0VOVEVSKTtcbiAgICA4MVx0XG4gICAgODJcdCAgICAgICAgLy8gTG9hZCBpbml0aWFsIGRhdGFcbiAgICA4M1x0ICAgICAgICBpZiAoaXNDb25uZWN0ZWQpIHtcbiAgICA4NFx0ICAgICAgICAgICAgdHJ5IHtcbiAgICA4NVx0ICAgICAgICAgICAgICAgIGluaXRTdGF0dXNNYW5hZ2VyKCk7XG4gICAgODZcdCAgICAgICAgICAgICAgICBsb2FkQWxsU2NoZWR1bGVEYXRhKCk7XG4gICAgODdcdCAgICAgICAgICAgICAgICB0aGlzLmFpUHJlZGljdG9yID0gQUlUcmF2ZWxUaW1lUHJlZGljdG9yLmdldEluc3RhbmNlKCk7XG4gICAgODhcdCAgICAgICAgICAgIH0gY2F0Y2ggKFJlbW90ZUV4Y2VwdGlvbiBleCkge1xuICAgIDg5XHQgICAgICAgICAgICAgICAgTE9HR0VSLmxvZyhMZXZlbC5TRVZFUkUsIFwiRXJyb3IgbG9hZGluZyBzY2hlZHVsZSBkYXRhXCIsIGV4KTtcbiAgICA5MFx0ICAgICAgICAgICAgICAgIHNob3dFcnJvck1lc3NhZ2UoXCJLaMO0bmcgdGjhu4MgdOG6o2kgZOG7ryBsaeG7h3UgbOG7i2NoIHRyw6xuaFwiLCBleCk7XG4gICAgOTFcdCAgICAgICAgICAgIH1cbiAgICA5Mlx0ICAgICAgICB9IGVsc2Uge1xuICAgIDkzXHQgICAgICAgICAgICBzaG93RXJyb3JNZXNzYWdlKFwiS2jDtG5nIHRo4buDIGvhur90IG7hu5FpIMSR4bq/biBtw6F5IGNo4bunXCIsIG51bGwpO1xuICAgIDk0XHQgICAgICAgIH1cbiAgICA5NVx0ICAgICAgICBsb2FkRGF0YUluQmFja2dyb3VuZCgpO1xuICAgIDk2XHQgICAgfVxuICAgIDk3XHRcbiAgICA5OFx0ICAgIHByaXZhdGUgdm9pZCBsb2FkRGF0YUluQmFja2dyb3VuZCgpIHtcbiAgICA5OVx0ICAgICAgICBTd2luZ1dvcmtlcjxCb29sZWFuLCBWb2lkPiB3b3JrZXIgPSBuZXcgU3dpbmdXb3JrZXI8PigpIHtcbiAgIDEwMFx0ICAgICAgICAgICAgQE92ZXJyaWRlXG4gICAxMDFcdCAgICAgICAgICAgIHByb3RlY3RlZCBCb29sZWFuIGRvSW5CYWNrZ3JvdW5kKCkgdGhyb3dzIEV4Y2VwdGlvbiB7XG4gICAxMDJcdCAgICAgICAgICAgICAgICAvLyBL4bq/dCBu4buRaSDEkeG6v24gUk1JIHNlcnZlclxuICAgMTAzXHQgICAgICAgICAgICAgICAgY29ubmVjdFRvUk1JU2VydmVyKCk7XG4gICAxMDRcdCAgICAgICAgICAgICAgICByZXR1cm4gaXNDb25uZWN0ZWQ7XG4gICAxMDVcdCAgICAgICAgICAgIH1cbiAgIDEwNlx0XG4gICAxMDdcdCAgICAgICAgICAgIEBPdmVycmlkZVxuICAgMTA4XHQgICAgICAgICAgICBwcm90ZWN0ZWQgdm9pZCBkb25lKCkge1xuICAgMTA5XHQgICAgICAgICAgICAgICAgdHJ5IHtcbiAgIDExMFx0ICAgICAgICAgICAgICAgICAgICBib29sZWFuIGNvbm5lY3RlZCA9IGdldCgpO1xuICAgMTExXHQgICAgICAgICAgICAgICAgICAgIGlmIChjb25uZWN0ZWQpIHtcbiAgIDExMlx0ICAgICAgICAgICAgICAgICAgICAgICAgLy8gWMOzYSB0aMO0bmcgYsOhbyBcIsSRYW5nIHThuqNpXCJcbiAgIDExM1x0ICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVNb2RlbC5zZXRSb3dDb3VudCgwKTtcbiAgIDExNFx0ICAgICAgICAgICAgICAgICAgICAgICAgLy8gVOG6o2kgZOG7ryBsaeG7h3UgbOG7i2NoIHRyw6xuaFxuICAgMTE1XHQgICAgICAgICAgICAgICAgICAgICAgICBsb2FkQWxsU2NoZWR1bGVEYXRhKCk7XG4gICAxMTZcdFxuICAgMTE3XHQgICAgICAgICAgICAgICAgICAgICAgICAvLyBLaOG7n2kgdOG6oW8gdHLDrG5oIHF14bqjbiBsw70gdHLhuqFuZyB0aMOhaVxuICAgMTE4XHQgICAgICAgICAgICAgICAgICAgICAgICBpbml0U3RhdHVzTWFuYWdlcigpO1xuICAgMTE5XHQgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAxMjBcdCAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlTW9kZWwuc2V0Um93Q291bnQoMCk7XG4gICAxMjFcdCAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlTW9kZWwuYWRkUm93KG5ldyBPYmplY3RbXXtcIktow7RuZyB0aOG7gyBr4bq/dCBu4buRaSDEkeG6v24gbcOheSBjaOG7p1wiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwifSk7XG4gICAxMjJcdCAgICAgICAgICAgICAgICAgICAgICAgIHNob3dFcnJvck1lc3NhZ2UoXCJLaMO0bmcgdGjhu4Mga+G6v3QgbuG7kWkgxJHhur9uIG3DoXkgY2jhu6dcIiwgbnVsbCk7XG4gICAxMjNcdCAgICAgICAgICAgICAgICAgICAgfVxuICAgMTI0XHQgICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgIDEyNVx0ICAgICAgICAgICAgICAgICAgICBMT0dHRVIubG9nKExldmVsLlNFVkVSRSwgXCJFcnJvciBsb2FkaW5nIHNjaGVkdWxlIGRhdGFcIiwgZSk7XG4gICAxMjZcdCAgICAgICAgICAgICAgICAgICAgdGFibGVNb2RlbC5zZXRSb3dDb3VudCgwKTtcbiAgIDEyN1x0ICAgICAgICAgICAgICAgICAgICB0YWJsZU1vZGVsLmFkZFJvdyhuZXcgT2JqZWN0W117XCJM4buXaTogXCIgKyBlLmdldE1lc3NhZ2UoKSwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIn0pO1xuICAgMTI4XHQgICAgICAgICAgICAgICAgICAgIHNob3dFcnJvck1lc3NhZ2UoXCJLaMO0bmcgdGjhu4MgdOG6o2kgZOG7ryBsaeG7h3UgbOG7i2NoIHRyw6xuaFwiLCBlKTtcbiAgIDEyOVx0ICAgICAgICAgICAgICAgIH1cbiAgIDEzMFx0ICAgICAgICAgICAgfVxuICAgMTMxXHQgICAgICAgIH07XG4gICAxMzJcdFxuICAgMTMzXHQgICAgICAgIHdvcmtlci5leGVjdXRlKCk7XG4gICAxMzRcdCAgICB9XG4gICAxMzVcdFxuICAgMTM2XHQgICAgcHJpdmF0ZSB2b2lkIGluaXRTdGF0dXNNYW5hZ2VyKCkge1xuICAgMTM3XHQgICAgICAgIGlmIChpc0Nvbm5lY3RlZCAmJiBsaWNoVHJpbmhUYXVEQU8gIT0gbnVsbCkge1xuICAgMTM4XHQgICAgICAgICAgICAvLyBU4bqhbyBjYWxsYmFjayBsw6BtIG3hu5tpIGThu68gbGnhu4d1XG4gICAxMzlcdCAgICAgICAgICAgIFJ1bm5hYmxlIHJlZnJlc2hDYWxsYmFjayA9IHRoaXM6OnJlZnJlc2hEYXRhQWZ0ZXJVcGRhdGU7XG4gICAxNDBcdFxuICAgMTQxXHQgICAgICAgICAgICAvLyBLaOG7n2kgdOG6oW8gdHLDrG5oIHF14bqjbiBsw70gdHLhuqFuZyB0aMOhaVxuICAgMTQyXHQgICAgICAgICAgICBzdGF0dXNNYW5hZ2VyID0gbmV3IFNjaGVkdWxlU3RhdHVzTWFuYWdlcihsaWNoVHJpbmhUYXVEQU8sIHJlZnJlc2hDYWxsYmFjayk7XG4gICAxNDNcdFxuICAgMTQ0XHQgICAgICAgICAgICBMT0dHRVIuaW5mbyhcIsSQw6Mga2jhu59pIHThuqFvIHRyw6xuaCBxdeG6o24gbMO9IGPhuq1wIG5o4bqtdCB0cuG6oW5nIHRow6FpIHThu7EgxJHhu5luZ1wiKTtcbiAgIDE0NVx0ICAgICAgICB9XG4gICAxNDZcdCAgICB9XG4gICAxNDdcdCAgICBwcml2YXRlIHZvaWQgcmVmcmVzaERhdGFBZnRlclVwZGF0ZSgpIHtcbiAgIDE0OFx0ICAgICAgICB0cnkge1xuICAgMTQ5XHQgICAgICAgICAgICAvLyBMw6BtIG3hu5tpIGThu68gbGnhu4d1IHRyw6puIGdpYW8gZGnhu4duIG3DoCBraMO0bmcgZ+G7jWkgY+G6rXAgbmjhuq10IHRy4bqhbmcgdGjDoWkgbOG6oWlcbiAgIDE1MFx0ICAgICAgICAgICAgbG9hZERhdGFXaXRob3V0U3RhdHVzQ2hlY2soKTtcbiAgIDE1MVx0XG4gICAxNTJcdCAgICAgICAgICAgIC8vIEhp4buDbiB0aOG7iyB0aMO0bmcgYsOhbyBuaOG7jyAodMO5eSBjaOG7jW4pXG4gICAxNTNcdCAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oXCLEkMOjIGPhuq1wIG5o4bqtdCB0cuG6oW5nIHRow6FpIGPDoWMgbOG7i2NoIHRyw6xuaCB0w6B1XCIpO1xuICAgMTU0XHRcbiAgIDE1NVx0ICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZXgpIHtcbiAgIDE1Nlx0ICAgICAgICAgICAgTE9HR0VSLmxvZyhMZXZlbC5TRVZFUkUsIFwiTOG7l2kga2hpIGzDoG0gbeG7m2kgZOG7ryBsaeG7h3Ugc2F1IGtoaSBj4bqtcCBuaOG6rXQgdHLhuqFuZyB0aMOhaVwiLCBleCk7XG4gICAxNTdcdCAgICAgICAgfVxuICAgMTU4XHQgICAgfVxuICAgMTU5XHRcbiAgIDE2MFx0ICAgIHByaXZhdGUgdm9pZCBsb2FkRGF0YVdpdGhvdXRTdGF0dXNDaGVjaygpIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xuICAgMTYxXHQgICAgICAgIGlmICghaXNDb25uZWN0ZWQgfHwgbGljaFRyaW5oVGF1REFPID09IG51bGwpIHtcbiAgIDE2Mlx0ICAgICAgICAgICAgY29ubmVjdFRvUk1JU2VydmVyKCk7XG4gICAxNjNcdCAgICAgICAgICAgIGlmICghaXNDb25uZWN0ZWQpIHtcbiAgIDE2NFx0ICAgICAgICAgICAgICAgIHRocm93IG5ldyBSZW1vdGVFeGNlcHRpb24oXCJOb3QgY29ubmVjdGVkIHRvIFJNSSBzZXJ2ZXJcIik7XG4gICAxNjVcdCAgICAgICAgICAgIH1cbiAgIDE2Nlx0ICAgICAgICB9XG4gICAxNjdcdFxuICAgMTY4XHQgICAgICAgIHRhYmxlTW9kZWwuc2V0Um93Q291bnQoMCk7XG4gICAxNjlcdFxuICAgMTcwXHQgICAgICAgIHRyeSB7XG4gICAxNzFcdCAgICAgICAgICAgIExpc3Q8TGljaFRyaW5oVGF1PiBzY2hlZHVsZXMgPSBsaWNoVHJpbmhUYXVEQU8uZ2V0QWxsTGlzdCgpO1xuICAgMTcyXHRcbiAgIDE3M1x0ICAgICAgICAgICAgaWYgKHNjaGVkdWxlcyA9PSBudWxsIHx8IHNjaGVkdWxlcy5pc0VtcHR5KCkpIHtcbiAgIDE3NFx0ICAgICAgICAgICAgICAgIExPR0dFUi5pbmZvKFwiS2jDtG5nIGPDsyBs4buLY2ggdHLDrG5oIG7DoG8gxJHhu4MgaGnhu4NuIHRo4buLLlwiKTtcbiAgIDE3NVx0ICAgICAgICAgICAgICAgIHJldHVybjtcbiAgIDE3Nlx0ICAgICAgICAgICAgfVxuICAgMTc3XHRcbiAgIDE3OFx0ICAgICAgICAgICAgLy8gTOG7jWMgdsOgIGhp4buDbiB0aOG7iyBk4buvIGxp4buHdSB0aGVvIGLhu5kgbOG7jWMgaGnhu4duIHThuqFpXG4gICAxNzlcdCAgICAgICAgICAgIFN0cmluZyBmaWx0ZXJPcHRpb24gPSBmaWx0ZXJDb21ib0JveC5nZXRTZWxlY3RlZEl0ZW0oKS50b1N0cmluZygpO1xuICAgMTgwXHQgICAgICAgICAgICBmb3IgKExpY2hUcmluaFRhdSBzY2hlZHVsZSA6IHNjaGVkdWxlcykge1xuICAgMTgxXHQgICAgICAgICAgICAgICAgaWYgKG1hdGNoZXNGaWx0ZXIoc2NoZWR1bGUsIGZpbHRlck9wdGlvbikpIHtcbiAgIDE4Mlx0ICAgICAgICAgICAgICAgICAgICB0YWJsZU1vZGVsLmFkZFJvdyhjcmVhdGVUYWJsZVJvdyhzY2hlZHVsZSkpO1xuICAgMTgzXHQgICAgICAgICAgICAgICAgfVxuICAgMTg0XHQgICAgICAgICAgICB9XG4gICAxODVcdFxuICAgMTg2XHQgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAxODdcdCAgICAgICAgICAgIExPR0dFUi5sb2coTGV2ZWwuU0VWRVJFLCBcIkzhu5dpIGNoaSB0aeG6v3Qga2hpIHThuqNpIGThu68gbGnhu4d1OiBcIiArIGUuZ2V0TWVzc2FnZSgpLCBlKTtcbiAgIDE4OFx0ICAgICAgICAgICAgdGhyb3cgbmV3IFJlbW90ZUV4Y2VwdGlvbihcIkzhu5dpIGtoaSB04bqjaSBk4buvIGxp4buHdTogXCIgKyBlLmdldE1lc3NhZ2UoKSwgZSk7XG4gICAxODlcdCAgICAgICAgfVxuICAgMTkwXHQgICAgfVxuICAgMTkxXHRcbiAgIDE5Mlx0ICAgIC8qKlxuICAgMTkzXHQgICAgICogSGnhu4NuIHRo4buLIHRow7RuZyBiw6FvIG5o4buPIOG7nyBnw7NjIG3DoG4gaMOsbmhcbiAgIDE5NFx0ICAgICAqL1xuICAgMTk1XHQgICAgcHJpdmF0ZSB2b2lkIHNob3dOb3RpZmljYXRpb24oU3RyaW5nIG1lc3NhZ2UpIHtcbiAgIDE5Nlx0ICAgICAgICAvLyBC4bqhbiBjw7MgdGjhu4MgdHJp4buDbiBraGFpIG3hu5l0IHRow7RuZyBiw6FvIG5o4buPIOG7nyBnw7NjIG3DoG4gaMOsbmhcbiAgIDE5N1x0ICAgICAgICAvLyBob+G6t2MgY+G6rXAgbmjhuq10IG3hu5l0IGxhYmVsIHRy4bqhbmcgdGjDoWkgdHLDqm4gZ2lhbyBkaeG7h25cbiAgIDE5OFx0ICAgIH1cbiAgIDE5OVx0XG4gICAyMDBcdCAgICBwcml2YXRlIEpQYW5lbCBjcmVhdGVUaXRsZVBhbmVsKCkge1xuICAgMjAxXHQgICAgICAgIEpQYW5lbCBwYW5lbCA9IG5ldyBKUGFuZWwobmV3IEJvcmRlckxheW91dCgpKTtcbiAgIDIwMlx0XG4gICAyMDNcdCAgICAgICAgSkxhYmVsIHRpdGxlTGFiZWwgPSBuZXcgSkxhYmVsKFwiUVXhuqJOIEzDnSBM4buKQ0ggVFLDjE5IIFTDgFVcIiwgSkxhYmVsLkNFTlRFUik7XG4gICAyMDRcdCAgICAgICAgdGl0bGVMYWJlbC5zZXRGb250KG5ldyBGb250KFwiQXJpYWxcIiwgRm9udC5CT0xELCAyMCkpO1xuICAgMjA1XHQgICAgICAgIHRpdGxlTGFiZWwuc2V0Rm9yZWdyb3VuZChuZXcgQ29sb3IoNDEsIDEyOCwgMTg1KSk7XG4gICAyMDZcdCAgICAgICAgdGl0bGVMYWJlbC5zZXRCb3JkZXIoQm9yZGVyRmFjdG9yeS5jcmVhdGVFbXB0eUJvcmRlcigwLCAwLCAxMCwgMCkpO1xuICAgMjA3XHRcbiAgIDIwOFx0ICAgICAgICBwYW5lbC5hZGQodGl0bGVMYWJlbCwgQm9yZGVyTGF5b3V0LkNFTlRFUik7XG4gICAyMDlcdCAgICAgICAgcmV0dXJuIHBhbmVsO1xuICAgMjEwXHQgICAgfVxuICAgMjExXHRcbiAgIDIxMlx0ICAgIHByaXZhdGUgSlBhbmVsIGNyZWF0ZUNlbnRlclBhbmVsKCkge1xuICAgMjEzXHQgICAgICAgIEpQYW5lbCBwYW5lbCA9IG5ldyBKUGFuZWwobmV3IEJvcmRlckxheW91dCgxMCwgMTApKTtcbiAgIDIxNFx0XG4gICAyMTVcdCAgICAgICAgcGFuZWwuYWRkKGNyZWF0ZVNlYXJjaFBhbmVsKCksIEJvcmRlckxheW91dC5OT1JUSCk7XG4gICAyMTZcdFxuICAgMjE3XHQgICAgICAgIC8vIFThuqFvIFRhYmJlZFBhbmUgxJHhu4MgY2jhu6lhIGPhuqMgY2jhur8gxJHhu5kgeGVtIGLhuqNuZyB2w6AgbOG7i2NoXG4gICAyMThcdCAgICAgICAgdmlld1RhYmJlZFBhbmUgPSBuZXcgSlRhYmJlZFBhbmUoKTtcbiAgIDIxOVx0XG4gICAyMjBcdCAgICAgICAgLy8gVOG6oW8gcGFuZWwgY2jhur8gxJHhu5kgeGVtIGLhuqNuZ1xuICAgMjIxXHQgICAgICAgIHRhYmxlVmlld1BhbmVsID0gbmV3IEpQYW5lbChuZXcgQm9yZGVyTGF5b3V0KCkpO1xuICAgMjIyXHQgICAgICAgIHRhYmxlVmlld1BhbmVsLmFkZChjcmVhdGVUYWJsZVBhbmVsKCksIEJvcmRlckxheW91dC5DRU5URVIpO1xuICAgMjIzXHQgICAgICAgIGNhbGVuZGFyUGFuZWwgPSBuZXcgVHJhaW5TY2hlZHVsZUNhbGVuZGFyUGFuZWwoaXNDb25uZWN0ZWQgPyBsaWNoVHJpbmhUYXVEQU8gOiBudWxsKTtcbiAgIDIyNFx0ICAgICAgICAvLyBO4bq/dSDEkcOjIGvhur90IG7hu5FpLCB04bqhbyBwYW5lbCBs4buLY2hcbiAgIDIyNVx0ICAgICAgICBpZiAoaXNDb25uZWN0ZWQgJiYgbGljaFRyaW5oVGF1REFPICE9IG51bGwpIHtcbiAgIDIyNlx0ICAgICAgICAgICAgLy8gVGhp4bq/dCBs4bqtcCBsaXN0ZW5lciBjaG8gc+G7sSBraeG7h24gY2xpY2sgbmfDoHlcbiAgIDIyN1x0ICAgICAgICAgICAgY2FsZW5kYXJQYW5lbC5zZXREYXlQYW5lbENsaWNrTGlzdGVuZXIoKGRhdGUsIHNjaGVkdWxlcykgLT4ge1xuICAgMjI4XHQgICAgICAgICAgICAgICAgLy8gSGnhu4NuIHRo4buLIGRhbmggc8OhY2ggbOG7i2NoIHRyw6xuaCBj4bunYSBuZ8OgeSDEkcaw4bujYyBjaOG7jW5cbiAgIDIyOVx0ICAgICAgICAgICAgICAgIGlmICghc2NoZWR1bGVzLmlzRW1wdHkoKSkge1xuICAgMjMwXHQgICAgICAgICAgICAgICAgICAgIHNob3dTY2hlZHVsZURldGFpbHNEaWFsb2coZGF0ZSwgc2NoZWR1bGVzKTtcbiAgIDIzMVx0ICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAyMzJcdCAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2codGhpcyxcbiAgIDIzM1x0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiS2jDtG5nIGPDsyBs4buLY2ggdHLDrG5oIG7DoG8gY2hvIG5nw6B5IFwiICsgZGF0ZSxcbiAgIDIzNFx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiVGjDtG5nIHRpblwiLFxuICAgMjM1XHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRSk7XG4gICAyMzZcdCAgICAgICAgICAgICAgICB9XG4gICAyMzdcdCAgICAgICAgICAgIH0pO1xuICAgMjM4XHQgICAgICAgIH0gZWxzZSB7XG4gICAyMzlcdCAgICAgICAgICAgIC8vIFPhu60gZOG7pW5nIFRyYWluU2NoZWR1bGVDYWxlbmRhclBhbmVsIHRoYXkgdsOsIEpQYW5lbFxuICAgMjQwXHQgICAgICAgICAgICBjYWxlbmRhclBhbmVsID0gbmV3IFRyYWluU2NoZWR1bGVDYWxlbmRhclBhbmVsKG51bGwpO1xuICAgMjQxXHRcbiAgIDI0Mlx0ICAgICAgICAgICAgLy8gVGjDqm0gbmjDo24gbOG7l2kgdsOgbyBwYW5lbFxuICAgMjQzXHQgICAgICAgICAgICBKTGFiZWwgZXJyb3JMYWJlbCA9IG5ldyBKTGFiZWwoXCJLaMO0bmcgdGjhu4Mga+G6v3QgbuG7kWkgxJHhur9uIHNlcnZlciDEkeG7gyBoaeG7g24gdGjhu4sgbOG7i2NoXCIpO1xuICAgMjQ0XHQgICAgICAgICAgICBlcnJvckxhYmVsLnNldEhvcml6b250YWxBbGlnbm1lbnQoSkxhYmVsLkNFTlRFUik7XG4gICAyNDVcdCAgICAgICAgICAgIGVycm9yTGFiZWwuc2V0Rm9yZWdyb3VuZChDb2xvci5SRUQpO1xuICAgMjQ2XHQgICAgICAgICAgICBjYWxlbmRhclBhbmVsLnJlbW92ZUFsbCgpOyAvLyBYw7NhIHThuqV0IGPhuqMgdGjDoG5oIHBo4bqnbiBraMOhY1xuICAgMjQ3XHQgICAgICAgICAgICBjYWxlbmRhclBhbmVsLnNldExheW91dChuZXcgQm9yZGVyTGF5b3V0KCkpO1xuICAgMjQ4XHQgICAgICAgICAgICBjYWxlbmRhclBhbmVsLmFkZChlcnJvckxhYmVsLCBCb3JkZXJMYXlvdXQuQ0VOVEVSKTtcbiAgIDI0OVx0ICAgICAgICB9XG4gICAyNTBcdFxuICAgMjUxXHQgICAgICAgIC8vIFRow6ptIGPDoWMgdGFiIHbDoG8gVGFiYmVkUGFuZVxuICAgMjUyXHQgICAgICAgIHZpZXdUYWJiZWRQYW5lLmFkZFRhYihcIkThuqFuZyBC4bqjbmdcIiwgbmV3IEltYWdlSWNvbigpLCB0YWJsZVZpZXdQYW5lbCwgXCJIaeG7g24gdGjhu4sgZOG6oW5nIGLhuqNuZ1wiKTtcbiAgIDI1M1x0ICAgICAgICB2aWV3VGFiYmVkUGFuZS5hZGRUYWIoXCJE4bqhbmcgTOG7i2NoXCIsIG5ldyBJbWFnZUljb24oKSwgY2FsZW5kYXJQYW5lbCwgXCJIaeG7g24gdGjhu4sgZOG6oW5nIGzhu4tjaFwiKTtcbiAgIDI1NFx0XG4gICAyNTVcdCAgICAgICAgcGFuZWwuYWRkKHZpZXdUYWJiZWRQYW5lLCBCb3JkZXJMYXlvdXQuQ0VOVEVSKTtcbiAgIDI1Nlx0ICAgICAgICBwYW5lbC5hZGQoY3JlYXRlQWN0aW9uUGFuZWwoKSwgQm9yZGVyTGF5b3V0LlNPVVRIKTtcbiAgIDI1N1x0XG4gICAyNThcdCAgICAgICAgcmV0dXJuIHBhbmVsO1xuICAgMjU5XHQgICAgfVxuICAgMjYwXHQgICAgLy8gSGnhu4duIGjhu5lwIHRob+G6oWkgY2hpIHRp4bq/dCBs4buLY2ggdHLDrG5oIGtoaSBjbGljayB2w6BvIG3hu5l0IG5nw6B5IHRyb25nIGzhu4tjaFxuICAgMjYxXHQgICAgcHJpdmF0ZSB2b2lkIHNob3dTY2hlZHVsZURldGFpbHNEaWFsb2coTG9jYWxEYXRlIGRhdGUsIExpc3Q8TGljaFRyaW5oVGF1PiBzY2hlZHVsZXMpIHtcbiAgIDI2Mlx0ICAgICAgICBKRGlhbG9nIGRpYWxvZyA9IG5ldyBKRGlhbG9nKCk7XG4gICAyNjNcdCAgICAgICAgZGlhbG9nLnNldFRpdGxlKFwiTOG7i2NoIHRyw6xuaCBuZ8OgeSBcIiArIGRhdGUpO1xuICAgMjY0XHQgICAgICAgIGRpYWxvZy5zZXRTaXplKDgwMCwgNDAwKTtcbiAgIDI2NVx0ICAgICAgICBkaWFsb2cuc2V0TG9jYXRpb25SZWxhdGl2ZVRvKHRoaXMpO1xuICAgMjY2XHQgICAgICAgIGRpYWxvZy5zZXRNb2RhbCh0cnVlKTtcbiAgIDI2N1x0ICAgICAgICBkaWFsb2cuc2V0TGF5b3V0KG5ldyBCb3JkZXJMYXlvdXQoKSk7XG4gICAyNjhcdFxuICAgMjY5XHQgICAgICAgIC8vIFThuqFvIHBhbmVsIGNo4bupYSBi4bqjbmcgbOG7i2NoIHRyw6xuaFxuICAgMjcwXHQgICAgICAgIEpQYW5lbCBjb250ZW50UGFuZWwgPSBuZXcgSlBhbmVsKG5ldyBCb3JkZXJMYXlvdXQoKSk7XG4gICAyNzFcdCAgICAgICAgY29udGVudFBhbmVsLnNldEJvcmRlcihCb3JkZXJGYWN0b3J5LmNyZWF0ZUVtcHR5Qm9yZGVyKDEwLCAxMCwgMTAsIDEwKSk7XG4gICAyNzJcdFxuICAgMjczXHQgICAgICAgIC8vIFThuqFvIG1vZGVsIGNobyBi4bqjbmcgbOG7i2NoIHRyw6xuaFxuICAgMjc0XHQgICAgICAgIERlZmF1bHRUYWJsZU1vZGVsIG1vZGVsID0gbmV3IERlZmF1bHRUYWJsZU1vZGVsKCk7XG4gICAyNzVcdCAgICAgICAgbW9kZWwuYWRkQ29sdW1uKFwiTcOjIGzhu4tjaCB0csOsbmhcIik7XG4gICAyNzZcdCAgICAgICAgbW9kZWwuYWRkQ29sdW1uKFwiVMOgdVwiKTtcbiAgIDI3N1x0ICAgICAgICBtb2RlbC5hZGRDb2x1bW4oXCJUdXnhur9uIMSRxrDhu51uZ1wiKTtcbiAgIDI3OFx0ICAgICAgICBtb2RlbC5hZGRDb2x1bW4oXCJHaeG7nSDEkWlcIik7XG4gICAyNzlcdCAgICAgICAgbW9kZWwuYWRkQ29sdW1uKFwiR2nhu50gxJHhur9uIChk4buxIGtp4bq/bilcIik7XG4gICAyODBcdCAgICAgICAgbW9kZWwuYWRkQ29sdW1uKFwiVHLhuqFuZyB0aMOhaVwiKTtcbiAgIDI4MVx0XG4gICAyODJcdCAgICAgICAgLy8gVGjDqm0gZOG7ryBsaeG7h3UgdsOgbyBi4bqjbmdcbiAgIDI4M1x0ICAgICAgICBmb3IgKExpY2hUcmluaFRhdSBsaWNoVHJpbmggOiBzY2hlZHVsZXMpIHtcbiAgIDI4NFx0ICAgICAgICAgICAgbW9kZWwuYWRkUm93KG5ldyBPYmplY3RbXXtcbiAgIDI4NVx0ICAgICAgICAgICAgICAgICAgICBsaWNoVHJpbmguZ2V0TWFMaWNoKCksXG4gICAyODZcdCAgICAgICAgICAgICAgICAgICAgbGljaFRyaW5oLmdldFRhdSgpLmdldE1hVGF1KCkgKyBcIiAtIFwiICsgbGljaFRyaW5oLmdldFRhdSgpLmdldFRlblRhdSgpLFxuICAgMjg3XHQgICAgICAgICAgICAgICAgICAgIGxpY2hUcmluaC5nZXRUYXUoKS5nZXRUdXllblRhdSgpLmdldEdhRGkoKSArIFwiIC0gXCIgKyBsaWNoVHJpbmguZ2V0VGF1KCkuZ2V0VHV5ZW5UYXUoKS5nZXRHYURlbigpLFxuICAgMjg4XHQgICAgICAgICAgICAgICAgICAgIGxpY2hUcmluaC5nZXRHaW9EaSgpLnRvU3RyaW5nKCksXG4gICAyODlcdCAgICAgICAgICAgICAgICAgICAgbGljaFRyaW5oLmdldEdpb0RpKCkucGx1c0hvdXJzKGVzdGltYXRlVHJhdmVsVGltZShsaWNoVHJpbmgpKS50b1N0cmluZygpLFxuICAgMjkwXHQgICAgICAgICAgICAgICAgICAgIGxpY2hUcmluaC5nZXRUcmFuZ1RoYWkoKVxuICAgMjkxXHQgICAgICAgICAgICB9KTtcbiAgIDI5Mlx0ICAgICAgICB9XG4gICAyOTNcdFxuICAgMjk0XHQgICAgICAgIC8vIFThuqFvIGLhuqNuZyBoaeG7g24gdGjhu4sgbOG7i2NoIHRyw6xuaFxuICAgMjk1XHQgICAgICAgIEpUYWJsZSBzY2hlZHVsZVRhYmxlID0gbmV3IEpUYWJsZShtb2RlbCk7XG4gICAyOTZcdCAgICAgICAgc2NoZWR1bGVUYWJsZS5zZXRSb3dIZWlnaHQoMjUpO1xuICAgMjk3XHQgICAgICAgIHNjaGVkdWxlVGFibGUuc2V0U2VsZWN0aW9uTW9kZShMaXN0U2VsZWN0aW9uTW9kZWwuU0lOR0xFX1NFTEVDVElPTik7XG4gICAyOThcdCAgICAgICAgc2NoZWR1bGVUYWJsZS5nZXRUYWJsZUhlYWRlcigpLnNldEZvbnQobmV3IEZvbnQoXCJBcmlhbFwiLCBGb250LkJPTEQsIDEyKSk7XG4gICAyOTlcdFxuICAgMzAwXHQgICAgICAgIC8vIFNldCByZW5kZXJlciBjaG8gY+G7mXQgdHLhuqFuZyB0aMOhaSDEkeG7gyBoaeG7g24gdGjhu4sgbcOgdSB0xrDGoW5nIOG7qW5nXG4gICAzMDFcdCAgICAgICAgc2NoZWR1bGVUYWJsZS5nZXRDb2x1bW5Nb2RlbCgpLmdldENvbHVtbig1KS5zZXRDZWxsUmVuZGVyZXIobmV3IERlZmF1bHRUYWJsZUNlbGxSZW5kZXJlcigpIHtcbiAgIDMwMlx0ICAgICAgICAgICAgQE92ZXJyaWRlXG4gICAzMDNcdCAgICAgICAgICAgIHB1YmxpYyBDb21wb25lbnQgZ2V0VGFibGVDZWxsUmVuZGVyZXJDb21wb25lbnQoSlRhYmxlIHRhYmxlLCBPYmplY3QgdmFsdWUsXG4gICAzMDRcdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbGVhbiBpc1NlbGVjdGVkLCBib29sZWFuIGhhc0ZvY3VzLFxuICAgMzA1XHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCByb3csIGludCBjb2x1bW4pIHtcbiAgIDMwNlx0ICAgICAgICAgICAgICAgIENvbXBvbmVudCBjb21wID0gc3VwZXIuZ2V0VGFibGVDZWxsUmVuZGVyZXJDb21wb25lbnQodGFibGUsIHZhbHVlLCBpc1NlbGVjdGVkLCBoYXNGb2N1cywgcm93LCBjb2x1bW4pO1xuICAgMzA3XHRcbiAgIDMwOFx0ICAgICAgICAgICAgICAgIFN0cmluZyBzdGF0dXMgPSB2YWx1ZS50b1N0cmluZygpO1xuICAgMzA5XHRcbiAgIDMxMFx0ICAgICAgICAgICAgICAgIC8vIFRoaeG6v3QgbOG6rXAgbcOgdSBu4buBbiB0xrDGoW5nIOG7qW5nIHbhu5tpIHRy4bqhbmcgdGjDoWlcbiAgIDMxMVx0ICAgICAgICAgICAgICAgIGlmIChcIsSQw6Mga2jhu59pIGjDoG5oXCIuZXF1YWxzKHN0YXR1cykpIHtcbiAgIDMxMlx0ICAgICAgICAgICAgICAgICAgICBjb21wLnNldEJhY2tncm91bmQobmV3IENvbG9yKDQ2LCAyMDQsIDExMykpOyAvLyBYYW5oIGzDoVxuICAgMzEzXHQgICAgICAgICAgICAgICAgICAgIGNvbXAuc2V0Rm9yZWdyb3VuZChDb2xvci5XSElURSk7XG4gICAzMTRcdCAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKFwixJDDoyBo4buneVwiLmVxdWFscyhzdGF0dXMpKSB7XG4gICAzMTVcdCAgICAgICAgICAgICAgICAgICAgY29tcC5zZXRCYWNrZ3JvdW5kKG5ldyBDb2xvcigyMzEsIDc2LCA2MCkpOyAvLyDEkOG7j1xuICAgMzE2XHQgICAgICAgICAgICAgICAgICAgIGNvbXAuc2V0Rm9yZWdyb3VuZChDb2xvci5XSElURSk7XG4gICAzMTdcdCAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKFwiQuG7iyB0cuG7hVwiLmVxdWFscyhzdGF0dXMpKSB7XG4gICAzMThcdCAgICAgICAgICAgICAgICAgICAgY29tcC5zZXRCYWNrZ3JvdW5kKG5ldyBDb2xvcigyNDMsIDE1NiwgMTgpKTsgLy8gQ2FtXG4gICAzMTlcdCAgICAgICAgICAgICAgICAgICAgY29tcC5zZXRGb3JlZ3JvdW5kKENvbG9yLldISVRFKTtcbiAgIDMyMFx0ICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXCJDaMawYSBraOG7n2kgaMOgbmhcIi5lcXVhbHMoc3RhdHVzKSkge1xuICAgMzIxXHQgICAgICAgICAgICAgICAgICAgIGNvbXAuc2V0QmFja2dyb3VuZChuZXcgQ29sb3IoNTIsIDE1MiwgMjE5KSk7IC8vIFhhbmggZMawxqFuZ1xuICAgMzIyXHQgICAgICAgICAgICAgICAgICAgIGNvbXAuc2V0Rm9yZWdyb3VuZChDb2xvci5XSElURSk7XG4gICAzMjNcdCAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgMzI0XHQgICAgICAgICAgICAgICAgICAgIGlmIChpc1NlbGVjdGVkKSB7XG4gICAzMjVcdCAgICAgICAgICAgICAgICAgICAgICAgIGNvbXAuc2V0QmFja2dyb3VuZCh0YWJsZS5nZXRTZWxlY3Rpb25CYWNrZ3JvdW5kKCkpO1xuICAgMzI2XHQgICAgICAgICAgICAgICAgICAgICAgICBjb21wLnNldEZvcmVncm91bmQodGFibGUuZ2V0U2VsZWN0aW9uRm9yZWdyb3VuZCgpKTtcbiAgIDMyN1x0ICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgMzI4XHQgICAgICAgICAgICAgICAgICAgICAgICBjb21wLnNldEJhY2tncm91bmQodGFibGUuZ2V0QmFja2dyb3VuZCgpKTtcbiAgIDMyOVx0ICAgICAgICAgICAgICAgICAgICAgICAgY29tcC5zZXRGb3JlZ3JvdW5kKHRhYmxlLmdldEZvcmVncm91bmQoKSk7XG4gICAzMzBcdCAgICAgICAgICAgICAgICAgICAgfVxuICAgMzMxXHQgICAgICAgICAgICAgICAgfVxuICAgMzMyXHRcbiAgIDMzM1x0ICAgICAgICAgICAgICAgIHJldHVybiBjb21wO1xuICAgMzM0XHQgICAgICAgICAgICB9XG4gICAzMzVcdCAgICAgICAgfSk7XG4gICAzMzZcdFxuICAgMzM3XHQgICAgICAgIC8vIFRow6ptIGLhuqNuZyB2w6BvIHNjcm9sbCBwYW5lXG4gICAzMzhcdCAgICAgICAgSlNjcm9sbFBhbmUgc2Nyb2xsUGFuZSA9IG5ldyBKU2Nyb2xsUGFuZShzY2hlZHVsZVRhYmxlKTtcbiAgIDMzOVx0ICAgICAgICBjb250ZW50UGFuZWwuYWRkKHNjcm9sbFBhbmUsIEJvcmRlckxheW91dC5DRU5URVIpO1xuICAgMzQwXHRcbiAgIDM0MVx0ICAgICAgICAvLyBUaMOqbSBjw6FjIG7DunQgdGhhbyB0w6FjXG4gICAzNDJcdCAgICAgICAgSlBhbmVsIGJ1dHRvblBhbmVsID0gbmV3IEpQYW5lbChuZXcgRmxvd0xheW91dChGbG93TGF5b3V0LlJJR0hUKSk7XG4gICAzNDNcdCAgICAgICAgSkJ1dHRvbiBlZGl0QnV0dG9uID0gbmV3IEpCdXR0b24oXCJDaOG7iW5oIHPhu61hXCIsIGNyZWF0ZUVkaXRJY29uKDE2LCAxNikpO1xuICAgMzQ0XHQgICAgICAgIEpCdXR0b24gZGVsZXRlQnV0dG9uID0gbmV3IEpCdXR0b24oXCJYw7NhXCIsIGNyZWF0ZURlbGV0ZUljb24oMTYsIDE2KSk7XG4gICAzNDVcdCAgICAgICAgSkJ1dHRvbiBjbG9zZUJ1dHRvbiA9IG5ldyBKQnV0dG9uKFwixJDDs25nXCIpO1xuICAgMzQ2XHRcbiAgIDM0N1x0ICAgICAgICAvLyBT4buxIGtp4buHbiBjaG8gbsO6dCBjaOG7iW5oIHPhu61hXG4gICAzNDhcdCAgICAgICAgZWRpdEJ1dHRvbi5hZGRBY3Rpb25MaXN0ZW5lcihlIC0+IHtcbiAgIDM0OVx0ICAgICAgICAgICAgaW50IHJvdyA9IHNjaGVkdWxlVGFibGUuZ2V0U2VsZWN0ZWRSb3coKTtcbiAgIDM1MFx0ICAgICAgICAgICAgaWYgKHJvdyA9PSAtMSkge1xuICAgMzUxXHQgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coZGlhbG9nLFxuICAgMzUyXHQgICAgICAgICAgICAgICAgICAgICAgICBcIlZ1aSBsw7JuZyBjaOG7jW4gbeG7mXQgbOG7i2NoIHRyw6xuaCDEkeG7gyBjaOG7iW5oIHPhu61hXCIsXG4gICAzNTNcdCAgICAgICAgICAgICAgICAgICAgICAgIFwiVGjDtG5nIGLDoW9cIixcbiAgIDM1NFx0ICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRSk7XG4gICAzNTVcdCAgICAgICAgICAgICAgICByZXR1cm47XG4gICAzNTZcdCAgICAgICAgICAgIH1cbiAgIDM1N1x0XG4gICAzNThcdCAgICAgICAgICAgIC8vIEzhuqV5IG3DoyBs4buLY2ggdHLDrG5oIMSRw6MgY2jhu41uXG4gICAzNTlcdCAgICAgICAgICAgIFN0cmluZyBtYUxpY2ggPSAoU3RyaW5nKSBzY2hlZHVsZVRhYmxlLmdldFZhbHVlQXQocm93LCAwKTtcbiAgIDM2MFx0XG4gICAzNjFcdCAgICAgICAgICAgIC8vIMSQw7NuZyBkaWFsb2cgaGnhu4duIHThuqFpXG4gICAzNjJcdCAgICAgICAgICAgIGRpYWxvZy5kaXNwb3NlKCk7XG4gICAzNjNcdFxuICAgMzY0XHQgICAgICAgICAgICAvLyBH4buNaSBow6BtIGNo4buJbmggc+G7rWEgduG7m2kgbcOjIGzhu4tjaCB0csOsbmhcbiAgIDM2NVx0ICAgICAgICAgICAgZWRpdFNjaGVkdWxlQnlJZChtYUxpY2gpO1xuICAgMzY2XHQgICAgICAgIH0pO1xuICAgMzY3XHRcbiAgIDM2OFx0ICAgICAgICAvLyBT4buxIGtp4buHbiBjaG8gbsO6dCB4w7NhXG4gICAzNjlcdCAgICAgICAgZGVsZXRlQnV0dG9uLmFkZEFjdGlvbkxpc3RlbmVyKGUgLT4ge1xuICAgMzcwXHQgICAgICAgICAgICBpbnQgcm93ID0gc2NoZWR1bGVUYWJsZS5nZXRTZWxlY3RlZFJvdygpO1xuICAgMzcxXHQgICAgICAgICAgICBpZiAocm93ID09IC0xKSB7XG4gICAzNzJcdCAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhkaWFsb2csXG4gICAzNzNcdCAgICAgICAgICAgICAgICAgICAgICAgIFwiVnVpIGzDsm5nIGNo4buNbiBt4buZdCBs4buLY2ggdHLDrG5oIMSR4buDIHjDs2FcIixcbiAgIDM3NFx0ICAgICAgICAgICAgICAgICAgICAgICAgXCJUaMO0bmcgYsOhb1wiLFxuICAgMzc1XHQgICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5JTkZPUk1BVElPTl9NRVNTQUdFKTtcbiAgIDM3Nlx0ICAgICAgICAgICAgICAgIHJldHVybjtcbiAgIDM3N1x0ICAgICAgICAgICAgfVxuICAgMzc4XHRcbiAgIDM3OVx0ICAgICAgICAgICAgLy8gTOG6pXkgbcOjIGzhu4tjaCB0csOsbmggxJHDoyBjaOG7jW5cbiAgIDM4MFx0ICAgICAgICAgICAgU3RyaW5nIG1hTGljaCA9IChTdHJpbmcpIHNjaGVkdWxlVGFibGUuZ2V0VmFsdWVBdChyb3csIDApO1xuICAgMzgxXHRcbiAgIDM4Mlx0ICAgICAgICAgICAgLy8gWMOhYyBuaOG6rW4geMOzYVxuICAgMzgzXHQgICAgICAgICAgICBpbnQgb3B0aW9uID0gSk9wdGlvblBhbmUuc2hvd0NvbmZpcm1EaWFsb2coZGlhbG9nLFxuICAgMzg0XHQgICAgICAgICAgICAgICAgICAgIFwiQuG6oW4gY8OzIGNo4bqvYyBjaOG6r24gbXXhu5FuIHjDs2EgbOG7i2NoIHRyw6xuaCBcIiArIG1hTGljaCArIFwiP1wiLFxuICAgMzg1XHQgICAgICAgICAgICAgICAgICAgIFwiWMOhYyBuaOG6rW4geMOzYVwiLFxuICAgMzg2XHQgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLllFU19OT19PUFRJT04sXG4gICAzODdcdCAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuV0FSTklOR19NRVNTQUdFKTtcbiAgIDM4OFx0XG4gICAzODlcdCAgICAgICAgICAgIGlmIChvcHRpb24gPT0gSk9wdGlvblBhbmUuWUVTX09QVElPTikge1xuICAgMzkwXHQgICAgICAgICAgICAgICAgdHJ5IHtcbiAgIDM5MVx0ICAgICAgICAgICAgICAgICAgICAvLyBUaOG7sWMgaGnhu4duIHjDs2FcbiAgIDM5Mlx0ICAgICAgICAgICAgICAgICAgICBib29sZWFuIGRlbGV0ZWQgPSBsaWNoVHJpbmhUYXVEQU8uZGVsZXRlKG1hTGljaCk7XG4gICAzOTNcdFxuICAgMzk0XHQgICAgICAgICAgICAgICAgICAgIGlmIChkZWxldGVkKSB7XG4gICAzOTVcdCAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKGRpYWxvZyxcbiAgIDM5Nlx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIsSQw6MgeMOzYSB0aMOgbmggY8O0bmcgbOG7i2NoIHRyw6xuaCBcIiArIG1hTGljaCxcbiAgIDM5N1x0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlRow6BuaCBjw7RuZ1wiLFxuICAgMzk4XHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLklORk9STUFUSU9OX01FU1NBR0UpO1xuICAgMzk5XHRcbiAgIDQwMFx0ICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ+G6rXAgbmjhuq10IGzhuqFpIGThu68gbGnhu4d1XG4gICA0MDFcdCAgICAgICAgICAgICAgICAgICAgICAgIHJlZnJlc2hEYXRhKCk7XG4gICA0MDJcdFxuICAgNDAzXHQgICAgICAgICAgICAgICAgICAgICAgICAvLyDEkMOzbmcgZGlhbG9nXG4gICA0MDRcdCAgICAgICAgICAgICAgICAgICAgICAgIGRpYWxvZy5kaXNwb3NlKCk7XG4gICA0MDVcdCAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgIDQwNlx0ICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coZGlhbG9nLFxuICAgNDA3XHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiS2jDtG5nIHRo4buDIHjDs2EgbOG7i2NoIHRyw6xuaCBcIiArIG1hTGljaCxcbiAgIDQwOFx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsXG4gICA0MDlcdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRSk7XG4gICA0MTBcdCAgICAgICAgICAgICAgICAgICAgfVxuICAgNDExXHQgICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGV4KSB7XG4gICA0MTJcdCAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coZGlhbG9nLFxuICAgNDEzXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaSBraGkgeMOzYSBs4buLY2ggdHLDrG5oOiBcIiArIGV4LmdldE1lc3NhZ2UoKSxcbiAgIDQxNFx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2lcIixcbiAgIDQxNVx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0UpO1xuICAgNDE2XHQgICAgICAgICAgICAgICAgfVxuICAgNDE3XHQgICAgICAgICAgICB9XG4gICA0MThcdCAgICAgICAgfSk7XG4gICA0MTlcdFxuICAgNDIwXHQgICAgICAgIC8vIFPhu7Ega2nhu4duIGNobyBuw7p0IMSRw7NuZ1xuICAgNDIxXHQgICAgICAgIGNsb3NlQnV0dG9uLmFkZEFjdGlvbkxpc3RlbmVyKGUgLT4gZGlhbG9nLmRpc3Bvc2UoKSk7XG4gICA0MjJcdFxuICAgNDIzXHQgICAgICAgIGJ1dHRvblBhbmVsLmFkZChlZGl0QnV0dG9uKTtcbiAgIDQyNFx0ICAgICAgICBidXR0b25QYW5lbC5hZGQoZGVsZXRlQnV0dG9uKTtcbiAgIDQyNVx0ICAgICAgICBidXR0b25QYW5lbC5hZGQoY2xvc2VCdXR0b24pO1xuICAgNDI2XHRcbiAgIDQyN1x0ICAgICAgICBkaWFsb2cuYWRkKGNvbnRlbnRQYW5lbCwgQm9yZGVyTGF5b3V0LkNFTlRFUik7XG4gICA0MjhcdCAgICAgICAgZGlhbG9nLmFkZChidXR0b25QYW5lbCwgQm9yZGVyTGF5b3V0LlNPVVRIKTtcbiAgIDQyOVx0XG4gICA0MzBcdCAgICAgICAgZGlhbG9nLnNldFZpc2libGUodHJ1ZSk7XG4gICA0MzFcdCAgICB9XG4gICA0MzJcdCAgICBwcml2YXRlIHZvaWQgZWRpdFNjaGVkdWxlQnlJZChTdHJpbmcgbWFMaWNoKSB7XG4gICA0MzNcdCAgICAgICAgLy8gVE9ETzogVHJp4buDbiBraGFpIGNo4bupYyBuxINuZyBjaOG7iW5oIHPhu61hIGzhu4tjaCB0csOsbmggdGhlbyBtw6NcbiAgIDQzNFx0ICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyh0aGlzLFxuICAgNDM1XHQgICAgICAgICAgICAgICAgXCJDaOG7qWMgbsSDbmcgY2jhu4luaCBz4butYSBs4buLY2ggdHLDrG5oIHPhur0gxJHGsOG7o2MgdHJp4buDbiBraGFpIHRyb25nIHBoacOqbiBi4bqjbiB0aeG6v3AgdGhlby5cIixcbiAgIDQzNlx0ICAgICAgICAgICAgICAgIFwiVGjDtG5nIGLDoW9cIixcbiAgIDQzN1x0ICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLklORk9STUFUSU9OX01FU1NBR0UpO1xuICAgNDM4XHQgICAgfVxuICAgNDM5XHRcbiAgIDQ0MFx0ICAgIHByaXZhdGUgdm9pZCBjb25uZWN0VG9STUlTZXJ2ZXIoKSB7XG4gICA0NDFcdCAgICAgICAgdHJ5IHtcbiAgIDQ0Mlx0ICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwixJBhbmcga+G6v3QgbuG7kWkgxJHhur9uIFJNSSBzZXJ2ZXIuLi5cIik7XG4gICA0NDNcdFxuICAgNDQ0XHQgICAgICAgICAgICAvLyBT4butIGThu6VuZyB0cuG7sWMgdGnhur9wIFJNSSByZWdpc3RyeSB0aGF5IHbDrCBKTkRJXG4gICA0NDVcdCAgICAgICAgICAgIFJlZ2lzdHJ5IHJlZ2lzdHJ5ID0gTG9jYXRlUmVnaXN0cnkuZ2V0UmVnaXN0cnkoUk1JX1NFUlZFUl9JUCwgUk1JX1NFUlZFUl9QT1JUKTtcbiAgIDQ0Nlx0ICAgICAgICAgICAgbGljaFRyaW5oVGF1REFPID0gKExpY2hUcmluaFRhdURBTykgcmVnaXN0cnkubG9va3VwKFwibGljaFRyaW5oVGF1REFPXCIpO1xuICAgNDQ3XHRcbiAgIDQ0OFx0ICAgICAgICAgICAgLy8gS2nhu4NtIHRyYSBr4bq/dCBu4buRaSDEkeG6v24gY8ahIHPhu58gZOG7ryBsaeG7h3VcbiAgIDQ0OVx0ICAgICAgICAgICAgdHJ5IHtcbiAgIDQ1MFx0ICAgICAgICAgICAgICAgIGJvb2xlYW4gZGJDb25uZWN0ZWQgPSBsaWNoVHJpbmhUYXVEQU8udGVzdENvbm5lY3Rpb24oKTtcbiAgIDQ1MVx0ICAgICAgICAgICAgICAgIGlmIChkYkNvbm5lY3RlZCkge1xuICAgNDUyXHQgICAgICAgICAgICAgICAgICAgIGlzQ29ubmVjdGVkID0gdHJ1ZTtcbiAgIDQ1M1x0ICAgICAgICAgICAgICAgICAgICBMT0dHRVIuaW5mbyhcIkvhur90IG7hu5FpIHRow6BuaCBjw7RuZyDEkeG6v24gUk1JIHNlcnZlciB2w6AgY8ahIHPhu58gZOG7ryBsaeG7h3VcIik7XG4gICA0NTRcdFxuICAgNDU1XHQgICAgICAgICAgICAgICAgICAgIC8vIEtp4buDbSB0cmEgdsOgIGdoaSBsb2cgZGFuaCBzw6FjaCB0cuG6oW5nIHRow6FpXG4gICA0NTZcdCAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgIDQ1N1x0ICAgICAgICAgICAgICAgICAgICAgICAgTGlzdDxUcmFuZ1RoYWk+IHN0YXR1c2VzID0gbGljaFRyaW5oVGF1REFPLmdldFRyYW5nVGhhaSgpO1xuICAgNDU4XHQgICAgICAgICAgICAgICAgICAgICAgICBMT0dHRVIuaW5mbyhcIsSQw6MgdOG6o2kgXCIgKyAoc3RhdHVzZXMgIT0gbnVsbCA/IHN0YXR1c2VzLnNpemUoKSA6IDApICsgXCIgdHLhuqFuZyB0aMOhaSB04burIGPGoSBz4bufIGThu68gbGnhu4d1XCIpO1xuICAgNDU5XHQgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICA0NjBcdCAgICAgICAgICAgICAgICAgICAgICAgIExPR0dFUi5sb2coTGV2ZWwuV0FSTklORywgXCJM4buXaSBraGkgdOG6o2kgZGFuaCBzw6FjaCB0cuG6oW5nIHRow6FpIHRyb25nIHF1w6EgdHLDrG5oIGvhur90IG7hu5FpXCIsIGUpO1xuICAgNDYxXHQgICAgICAgICAgICAgICAgICAgIH1cbiAgIDQ2Mlx0ICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICA0NjNcdCAgICAgICAgICAgICAgICAgICAgaXNDb25uZWN0ZWQgPSBmYWxzZTtcbiAgIDQ2NFx0ICAgICAgICAgICAgICAgICAgICBMT0dHRVIud2FybmluZyhcIkvhur90IG7hu5FpIHRow6BuaCBjw7RuZyDEkeG6v24gUk1JIHNlcnZlciBuaMawbmcga2jDtG5nIHRo4buDIGvhur90IG7hu5FpIMSR4bq/biBjxqEgc+G7nyBk4buvIGxp4buHdVwiKTtcbiAgIDQ2NVx0ICAgICAgICAgICAgICAgICAgICBzaG93RXJyb3JNZXNzYWdlKFwiS+G6v3QgbuG7kWkgxJHhur9uIFJNSSBzZXJ2ZXIgdGjDoG5oIGPDtG5nIG5oxrBuZyBraMO0bmcgdGjhu4Mga+G6v3QgbuG7kWkgxJHhur9uIGPGoSBz4bufIGThu68gbGnhu4d1XCIsIG51bGwpO1xuICAgNDY2XHQgICAgICAgICAgICAgICAgfVxuICAgNDY3XHQgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgNDY4XHQgICAgICAgICAgICAgICAgaXNDb25uZWN0ZWQgPSBmYWxzZTtcbiAgIDQ2OVx0ICAgICAgICAgICAgICAgIExPR0dFUi5sb2coTGV2ZWwuU0VWRVJFLCBcIktp4buDbSB0cmEga+G6v3QgbuG7kWkgY8ahIHPhu58gZOG7ryBsaeG7h3UgdGjhuqV0IGLhuqFpXCIsIGUpO1xuICAgNDcwXHQgICAgICAgICAgICAgICAgc2hvd0Vycm9yTWVzc2FnZShcIktp4buDbSB0cmEga+G6v3QgbuG7kWkgY8ahIHPhu58gZOG7ryBsaeG7h3UgdGjhuqV0IGLhuqFpXCIsIGUpO1xuICAgNDcxXHQgICAgICAgICAgICB9XG4gICA0NzJcdCAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGV4KSB7XG4gICA0NzNcdCAgICAgICAgICAgIExPR0dFUi5sb2coTGV2ZWwuU0VWRVJFLCBcIktow7RuZyB0aOG7gyBr4bq/dCBu4buRaSDEkeG6v24gUk1JIHNlcnZlclwiLCBleCk7XG4gICA0NzRcdCAgICAgICAgICAgIGlzQ29ubmVjdGVkID0gZmFsc2U7XG4gICA0NzVcdCAgICAgICAgICAgIHNob3dFcnJvck1lc3NhZ2UoXCJLaMO0bmcgdGjhu4Mga+G6v3QgbuG7kWkgxJHhur9uIFJNSSBzZXJ2ZXI6IFwiICsgZXguZ2V0TWVzc2FnZSgpLCBleCk7XG4gICA0NzZcdCAgICAgICAgfVxuICAgNDc3XHQgICAgfVxuICAgNDc4XHRcbiAgIDQ3OVx0ICAgIHByaXZhdGUgSlBhbmVsIGNyZWF0ZVNlYXJjaFBhbmVsKCkge1xuICAgNDgwXHQgICAgICAgIEpQYW5lbCBvdXRlclBhbmVsID0gbmV3IEpQYW5lbChuZXcgQm9yZGVyTGF5b3V0KCkpO1xuICAgNDgxXHQgICAgICAgIG91dGVyUGFuZWwuc2V0Qm9yZGVyKEJvcmRlckZhY3RvcnkuY3JlYXRlVGl0bGVkQm9yZGVyKFwiVMOsbSBLaeG6v20gTOG7i2NoIFRyw6xuaFwiKSk7XG4gICA0ODJcdFxuICAgNDgzXHQgICAgICAgIC8vIFBhbmVsIGNo4bupYSB04bqldCBj4bqjIGPDoWMgxJFp4buBdSBraGnhu4NuIHTDrG0ga2nhur9tXG4gICA0ODRcdCAgICAgICAgSlBhbmVsIG1haW5TZWFyY2hQYW5lbCA9IG5ldyBKUGFuZWwobmV3IEJvcmRlckxheW91dCgwLCAxMCkpO1xuICAgNDg1XHRcbiAgIDQ4Nlx0ICAgICAgICAvLyBQYW5lbCBjaG8gaMOgbmcgxJHhuqd1IHRpw6puIChuZ8OgeSDEkWkgdsOgIHRy4bqhbmcgdGjDoWkpXG4gICA0ODdcdCAgICAgICAgSlBhbmVsIGZpcnN0Um93UGFuZWwgPSBuZXcgSlBhbmVsKG5ldyBGbG93TGF5b3V0KEZsb3dMYXlvdXQuTEVGVCwgMTAsIDUpKTtcbiAgIDQ4OFx0XG4gICA0ODlcdCAgICAgICAgLy8gVGjDoG5oIHBo4bqnbiB0w6xtIGtp4bq/bSB0aGVvIG5nw6B5XG4gICA0OTBcdCAgICAgICAgSkxhYmVsIGRhdGVMYWJlbCA9IG5ldyBKTGFiZWwoXCJOZ8OgeSDEkWk6XCIpO1xuICAgNDkxXHQgICAgICAgIGRhdGVDaG9vc2VyID0gbmV3IEpEYXRlQ2hvb3NlcigpO1xuICAgNDkyXHQgICAgICAgIGRhdGVDaG9vc2VyLnNldERhdGVGb3JtYXRTdHJpbmcoXCJ5eXl5LU1NLWRkXCIpO1xuICAgNDkzXHQgICAgICAgIGRhdGVDaG9vc2VyLnNldERhdGUobmV3IERhdGUoKSk7XG4gICA0OTRcdCAgICAgICAgZGF0ZUNob29zZXIuc2V0UHJlZmVycmVkU2l6ZShuZXcgRGltZW5zaW9uKDE1MCwgMjgpKTtcbiAgIDQ5NVx0XG4gICA0OTZcdCAgICAgICAgLy8gVGjDoG5oIHBo4bqnbiBs4buNYyB0aGVvIHRy4bqhbmcgdGjDoWlcbiAgIDQ5N1x0ICAgICAgICBKTGFiZWwgZmlsdGVyTGFiZWwgPSBuZXcgSkxhYmVsKFwiTOG7jWMgdGhlbyB0cuG6oW5nIHRow6FpOlwiKTtcbiAgIDQ5OFx0ICAgICAgICBEZWZhdWx0Q29tYm9Cb3hNb2RlbDxPYmplY3Q+IGZpbHRlck1vZGVsID0gbmV3IERlZmF1bHRDb21ib0JveE1vZGVsPD4oKTtcbiAgIDQ5OVx0ICAgICAgICBmaWx0ZXJNb2RlbC5hZGRFbGVtZW50KFwiVOG6pXQgY+G6o1wiKTtcbiAgIDUwMFx0XG4gICA1MDFcdCAgICAgICAgdHJ5IHtcbiAgIDUwMlx0ICAgICAgICAgICAgaWYgKGlzQ29ubmVjdGVkICYmIGxpY2hUcmluaFRhdURBTyAhPSBudWxsKSB7XG4gICA1MDNcdCAgICAgICAgICAgICAgICBMaXN0PFRyYW5nVGhhaT4gZGJTdGF0dXNlcyA9IGxpY2hUcmluaFRhdURBTy5nZXRUcmFuZ1RoYWkoKTtcbiAgIDUwNFx0ICAgICAgICAgICAgICAgIGlmIChkYlN0YXR1c2VzICE9IG51bGwgJiYgIWRiU3RhdHVzZXMuaXNFbXB0eSgpKSB7XG4gICA1MDVcdCAgICAgICAgICAgICAgICAgICAgZm9yIChUcmFuZ1RoYWkgc3RhdHVzIDogZGJTdGF0dXNlcykge1xuICAgNTA2XHQgICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJNb2RlbC5hZGRFbGVtZW50KHN0YXR1cyk7XG4gICA1MDdcdCAgICAgICAgICAgICAgICAgICAgfVxuICAgNTA4XHQgICAgICAgICAgICAgICAgICAgIExPR0dFUi5pbmZvKFwixJDDoyB04bqjaSB0aMOgbmggY8O0bmcgXCIgKyBkYlN0YXR1c2VzLnNpemUoKSArIFwiIHRy4bqhbmcgdGjDoWkgdOG7qyBjxqEgc+G7nyBk4buvIGxp4buHdVwiKTtcbiAgIDUwOVx0ICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICA1MTBcdCAgICAgICAgICAgICAgICAgICAgTE9HR0VSLndhcm5pbmcoXCJLaMO0bmcgdMOsbSB0aOG6pXkgdHLhuqFuZyB0aMOhaSBuw6BvIHRyb25nIGPGoSBz4bufIGThu68gbGnhu4d1XCIpO1xuICAgNTExXHQgICAgICAgICAgICAgICAgfVxuICAgNTEyXHQgICAgICAgICAgICB9XG4gICA1MTNcdCAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgIDUxNFx0ICAgICAgICAgICAgTE9HR0VSLmxvZyhMZXZlbC5TRVZFUkUsIFwiTOG7l2kga2hpIHThuqNpIGRhbmggc8OhY2ggdHLhuqFuZyB0aMOhaTogXCIgKyBlLmdldE1lc3NhZ2UoKSwgZSk7XG4gICA1MTVcdCAgICAgICAgfVxuICAgNTE2XHRcbiAgIDUxN1x0ICAgICAgICBmaWx0ZXJDb21ib0JveCA9IG5ldyBKQ29tYm9Cb3g8PihmaWx0ZXJNb2RlbCk7XG4gICA1MThcdCAgICAgICAgZmlsdGVyQ29tYm9Cb3guc2V0UHJlZmVycmVkU2l6ZShuZXcgRGltZW5zaW9uKDE1MCwgMjgpKTtcbiAgIDUxOVx0XG4gICA1MjBcdCAgICAgICAgLy8gQ3VzdG9tIHJlbmRlcmVyIMSR4buDIGhp4buDbiB0aOG7iyBtw7QgdOG6oyBj4bunYSBlbnVtXG4gICA1MjFcdCAgICAgICAgZmlsdGVyQ29tYm9Cb3guc2V0UmVuZGVyZXIobmV3IERlZmF1bHRMaXN0Q2VsbFJlbmRlcmVyKCkge1xuICAgNTIyXHQgICAgICAgICAgICBAT3ZlcnJpZGVcbiAgIDUyM1x0ICAgICAgICAgICAgcHVibGljIENvbXBvbmVudCBnZXRMaXN0Q2VsbFJlbmRlcmVyQ29tcG9uZW50KEpMaXN0PD8+IGxpc3QsIE9iamVjdCB2YWx1ZSwgaW50IGluZGV4LFxuICAgNTI0XHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbGVhbiBpc1NlbGVjdGVkLCBib29sZWFuIGNlbGxIYXNGb2N1cykge1xuICAgNTI1XHQgICAgICAgICAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgVHJhbmdUaGFpKSB7XG4gICA1MjZcdCAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSAoKFRyYW5nVGhhaSkgdmFsdWUpLmdldFZhbHVlKCk7XG4gICA1MjdcdCAgICAgICAgICAgICAgICB9XG4gICA1MjhcdCAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZ2V0TGlzdENlbGxSZW5kZXJlckNvbXBvbmVudChsaXN0LCB2YWx1ZSwgaW5kZXgsIGlzU2VsZWN0ZWQsIGNlbGxIYXNGb2N1cyk7XG4gICA1MjlcdCAgICAgICAgICAgIH1cbiAgIDUzMFx0ICAgICAgICB9KTtcbiAgIDUzMVx0XG4gICA1MzJcdCAgICAgICAgLy8gVGjDqm0gY8OhYyB0aMOgbmggcGjhuqduIHbDoG8gcGFuZWwgaMOgbmcgxJHhuqd1XG4gICA1MzNcdCAgICAgICAgZmlyc3RSb3dQYW5lbC5hZGQoZGF0ZUxhYmVsKTtcbiAgIDUzNFx0ICAgICAgICBmaXJzdFJvd1BhbmVsLmFkZChkYXRlQ2hvb3Nlcik7XG4gICA1MzVcdCAgICAgICAgZmlyc3RSb3dQYW5lbC5hZGQoZmlsdGVyTGFiZWwpO1xuICAgNTM2XHQgICAgICAgIGZpcnN0Um93UGFuZWwuYWRkKGZpbHRlckNvbWJvQm94KTtcbiAgIDUzN1x0XG4gICA1MzhcdCAgICAgICAgLy8gUGFuZWwgY2hvIGjDoG5nIHRo4bupIGhhaSAoZ2EgxJFpLCBnYSDEkeG6v24sIGdp4budIMSRaSlcbiAgIDUzOVx0ICAgICAgICBKUGFuZWwgc2Vjb25kUm93UGFuZWwgPSBuZXcgSlBhbmVsKG5ldyBGbG93TGF5b3V0KEZsb3dMYXlvdXQuTEVGVCwgMTAsIDUpKTtcbiAgIDU0MFx0XG4gICA1NDFcdCAgICAgICAgLy8gVGjDoG5oIHBo4bqnbiB0w6xtIGtp4bq/bSB0aGVvIGdhIMSRaVxuICAgNTQyXHQgICAgICAgIEpMYWJlbCBkZXBTdGF0aW9uTGFiZWwgPSBuZXcgSkxhYmVsKFwiR2EgxJFpOlwiKTtcbiAgIDU0M1x0XG4gICA1NDRcdCAgICAgICAgLy8gU+G7rSBk4bulbmcgbW9kZWwgY2hvIGF1dG9jb21wbGV0ZSBDb21ib0JveFxuICAgNTQ1XHQgICAgICAgIERlZmF1bHRDb21ib0JveE1vZGVsPFN0cmluZz4gZGVwU3RhdGlvbk1vZGVsID0gbmV3IERlZmF1bHRDb21ib0JveE1vZGVsPD4oKTtcbiAgIDU0Nlx0ICAgICAgICBkZXBTdGF0aW9uTW9kZWwuYWRkRWxlbWVudChcIlThuqV0IGPhuqNcIik7XG4gICA1NDdcdFxuICAgNTQ4XHQgICAgICAgIC8vIFThuqFvIENvbWJvQm94IGNobyBnYSDEkWkgduG7m2kgQXV0b0NvbXBsZXRlXG4gICA1NDlcdCAgICAgICAgSkNvbWJvQm94PFN0cmluZz4gZGVwU3RhdGlvbkNvbWJvQm94ID0gbmV3IEpDb21ib0JveDw+KGRlcFN0YXRpb25Nb2RlbCk7XG4gICA1NTBcdCAgICAgICAgZGVwU3RhdGlvbkNvbWJvQm94LnNldFByZWZlcnJlZFNpemUobmV3IERpbWVuc2lvbigxNTAsIDI4KSk7XG4gICA1NTFcdCAgICAgICAgZGVwU3RhdGlvbkNvbWJvQm94LnNldEVkaXRhYmxlKHRydWUpO1xuICAgNTUyXHRcbiAgIDU1M1x0ICAgICAgICAvLyBUaMOqbSBBdXRvQ29tcGxldGUgY2hvIENvbWJvQm94IGdhIMSRaVxuICAgNTU0XHQgICAgICAgIHNldHVwQXV0b0NvbXBsZXRlKGRlcFN0YXRpb25Db21ib0JveCk7XG4gICA1NTVcdFxuICAgNTU2XHQgICAgICAgIC8vIFRow6BuaCBwaOG6p24gdMOsbSBraeG6v20gdGhlbyBnYSDEkeG6v25cbiAgIDU1N1x0ICAgICAgICBKTGFiZWwgYXJyU3RhdGlvbkxhYmVsID0gbmV3IEpMYWJlbChcIkdhIMSR4bq/bjpcIik7XG4gICA1NThcdFxuICAgNTU5XHQgICAgICAgIC8vIFPhu60gZOG7pW5nIG1vZGVsIGNobyBhdXRvY29tcGxldGUgQ29tYm9Cb3hcbiAgIDU2MFx0ICAgICAgICBEZWZhdWx0Q29tYm9Cb3hNb2RlbDxTdHJpbmc+IGFyclN0YXRpb25Nb2RlbCA9IG5ldyBEZWZhdWx0Q29tYm9Cb3hNb2RlbDw+KCk7XG4gICA1NjFcdCAgICAgICAgYXJyU3RhdGlvbk1vZGVsLmFkZEVsZW1lbnQoXCJU4bqldCBj4bqjXCIpO1xuICAgNTYyXHRcbiAgIDU2M1x0ICAgICAgICAvLyBU4bqhbyBDb21ib0JveCBjaG8gZ2EgxJHhur9uIHbhu5tpIEF1dG9Db21wbGV0ZVxuICAgNTY0XHQgICAgICAgIEpDb21ib0JveDxTdHJpbmc+IGFyclN0YXRpb25Db21ib0JveCA9IG5ldyBKQ29tYm9Cb3g8PihhcnJTdGF0aW9uTW9kZWwpO1xuICAgNTY1XHQgICAgICAgIGFyclN0YXRpb25Db21ib0JveC5zZXRQcmVmZXJyZWRTaXplKG5ldyBEaW1lbnNpb24oMTUwLCAyOCkpO1xuICAgNTY2XHQgICAgICAgIGFyclN0YXRpb25Db21ib0JveC5zZXRFZGl0YWJsZSh0cnVlKTtcbiAgIDU2N1x0XG4gICA1NjhcdCAgICAgICAgLy8gVGjDqm0gQXV0b0NvbXBsZXRlIGNobyBDb21ib0JveCBnYSDEkeG6v25cbiAgIDU2OVx0ICAgICAgICBzZXR1cEF1dG9Db21wbGV0ZShhcnJTdGF0aW9uQ29tYm9Cb3gpO1xuICAgNTcwXHRcbiAgIDU3MVx0ICAgICAgICAvLyBU4bqjaSBkYW5oIHPDoWNoIGdhIHThu6sgY8ahIHPhu58gZOG7ryBsaeG7h3UgdsOgIHRow6ptIHbDoG8gQ29tYm9Cb3hcbiAgIDU3Mlx0ICAgICAgICBsb2FkU3RhdGlvbkxpc3QoZGVwU3RhdGlvbkNvbWJvQm94LCBhcnJTdGF0aW9uQ29tYm9Cb3gpO1xuICAgNTczXHRcbiAgIDU3NFx0ICAgICAgICAvLyBUaMOgbmggcGjhuqduIHTDrG0ga2nhur9tIHRoZW8gZ2nhu50gxJFpIC0gVEhBWSDEkOG7lEk6IETDuW5nIHNwaW5uZXIgdGhheSBjaG8gVGV4dEZpZWxkXG4gICA1NzVcdCAgICAgICAgSkxhYmVsIGRlcFRpbWVMYWJlbCA9IG5ldyBKTGFiZWwoXCJHaeG7nSDEkWk6XCIpO1xuICAgNTc2XHRcbiAgIDU3N1x0ICAgICAgICAvLyBU4bqhbyBtw7QgaMOsbmggY2hvIGdp4budICgwLTIzKSB2w6AgcGjDunQgKDAtNTkpXG4gICA1NzhcdCAgICAgICAgU3Bpbm5lck51bWJlck1vZGVsIGhvdXJNb2RlbCA9IG5ldyBTcGlubmVyTnVtYmVyTW9kZWwoMCwgMCwgMjMsIDEpO1xuICAgNTc5XHQgICAgICAgIFNwaW5uZXJOdW1iZXJNb2RlbCBtaW51dGVNb2RlbCA9IG5ldyBTcGlubmVyTnVtYmVyTW9kZWwoMCwgMCwgNTksIDEpO1xuICAgNTgwXHRcbiAgIDU4MVx0ICAgICAgICBKU3Bpbm5lciBob3VyU3Bpbm5lciA9IG5ldyBKU3Bpbm5lcihob3VyTW9kZWwpO1xuICAgNTgyXHQgICAgICAgIEpTcGlubmVyIG1pbnV0ZVNwaW5uZXIgPSBuZXcgSlNwaW5uZXIobWludXRlTW9kZWwpO1xuICAgNTgzXHRcbiAgIDU4NFx0ICAgICAgICAvLyBUaGnhur90IGzhuq1wIGVkaXRvciDEkeG7gyBoaeG7g24gdGjhu4sgxJHDum5nIMSR4buLbmggZOG6oW5nXG4gICA1ODVcdCAgICAgICAgSlNwaW5uZXIuTnVtYmVyRWRpdG9yIGhvdXJFZGl0b3IgPSBuZXcgSlNwaW5uZXIuTnVtYmVyRWRpdG9yKGhvdXJTcGlubmVyLCBcIjAwXCIpO1xuICAgNTg2XHQgICAgICAgIGhvdXJTcGlubmVyLnNldEVkaXRvcihob3VyRWRpdG9yKTtcbiAgIDU4N1x0ICAgICAgICBKU3Bpbm5lci5OdW1iZXJFZGl0b3IgbWludXRlRWRpdG9yID0gbmV3IEpTcGlubmVyLk51bWJlckVkaXRvcihtaW51dGVTcGlubmVyLCBcIjAwXCIpO1xuICAgNTg4XHQgICAgICAgIG1pbnV0ZVNwaW5uZXIuc2V0RWRpdG9yKG1pbnV0ZUVkaXRvcik7XG4gICA1ODlcdFxuICAgNTkwXHQgICAgICAgIC8vIFBhbmVsIGNo4bupYSBjw6FjIHNwaW5uZXIgZ2nhu50gdsOgIHBow7p0XG4gICA1OTFcdCAgICAgICAgSlBhbmVsIHRpbWVTcGlubmVyUGFuZWwgPSBuZXcgSlBhbmVsKG5ldyBGbG93TGF5b3V0KEZsb3dMYXlvdXQuTEVGVCwgMCwgMCkpO1xuICAgNTkyXHRcbiAgIDU5M1x0ICAgICAgICAvLyBUaMOqbSBuaMOjbiBcIjpcIiBnaeG7r2EgZ2nhu50gdsOgIHBow7p0XG4gICA1OTRcdCAgICAgICAgSkxhYmVsIHNlcGFyYXRvciA9IG5ldyBKTGFiZWwoXCIgOiBcIik7XG4gICA1OTVcdCAgICAgICAgc2VwYXJhdG9yLnNldEZvbnQobmV3IEZvbnQoXCJTYW5zU2VyaWZcIiwgRm9udC5CT0xELCAxNCkpO1xuICAgNTk2XHRcbiAgIDU5N1x0ICAgICAgICB0aW1lU3Bpbm5lclBhbmVsLmFkZChob3VyU3Bpbm5lcik7XG4gICA1OThcdCAgICAgICAgdGltZVNwaW5uZXJQYW5lbC5hZGQoc2VwYXJhdG9yKTtcbiAgIDU5OVx0ICAgICAgICB0aW1lU3Bpbm5lclBhbmVsLmFkZChtaW51dGVTcGlubmVyKTtcbiAgIDYwMFx0XG4gICA2MDFcdCAgICAgICAgLy8gQ2hlY2tib3ggxJHhu4MgbmfGsOG7nWkgZMO5bmcgY8OzIHRo4buDIGNo4buNbiB0w6xtIHRoZW8gZ2nhu50gaGF5IGtow7RuZ1xuICAgNjAyXHQgICAgICAgIEpDaGVja0JveCB1c2VUaW1lQ2hlY2tCb3ggPSBuZXcgSkNoZWNrQm94KFwiVMOsbSB0aGVvIGdp4budXCIpO1xuICAgNjAzXHQgICAgICAgIHVzZVRpbWVDaGVja0JveC5hZGRBY3Rpb25MaXN0ZW5lcihlIC0+IHtcbiAgIDYwNFx0ICAgICAgICAgICAgYm9vbGVhbiBzZWxlY3RlZCA9IHVzZVRpbWVDaGVja0JveC5pc1NlbGVjdGVkKCk7XG4gICA2MDVcdCAgICAgICAgICAgIGhvdXJTcGlubmVyLnNldEVuYWJsZWQoc2VsZWN0ZWQpO1xuICAgNjA2XHQgICAgICAgICAgICBtaW51dGVTcGlubmVyLnNldEVuYWJsZWQoc2VsZWN0ZWQpO1xuICAgNjA3XHQgICAgICAgIH0pO1xuICAgNjA4XHRcbiAgIDYwOVx0ICAgICAgICAvLyBN4bq3YyDEkeG7i25oIGtow7RuZyB0w6xtIGtp4bq/bSB0aGVvIGdp4budXG4gICA2MTBcdCAgICAgICAgdXNlVGltZUNoZWNrQm94LnNldFNlbGVjdGVkKGZhbHNlKTtcbiAgIDYxMVx0ICAgICAgICBob3VyU3Bpbm5lci5zZXRFbmFibGVkKGZhbHNlKTtcbiAgIDYxMlx0ICAgICAgICBtaW51dGVTcGlubmVyLnNldEVuYWJsZWQoZmFsc2UpO1xuICAgNjEzXHRcbiAgIDYxNFx0ICAgICAgICAvLyBUaMOqbSBjw6FjIHRow6BuaCBwaOG6p24gdsOgbyBwYW5lbCBow6BuZyB0aOG7qSBoYWlcbiAgIDYxNVx0ICAgICAgICBzZWNvbmRSb3dQYW5lbC5hZGQoZGVwU3RhdGlvbkxhYmVsKTtcbiAgIDYxNlx0ICAgICAgICBzZWNvbmRSb3dQYW5lbC5hZGQoZGVwU3RhdGlvbkNvbWJvQm94KTtcbiAgIDYxN1x0ICAgICAgICBzZWNvbmRSb3dQYW5lbC5hZGQoYXJyU3RhdGlvbkxhYmVsKTtcbiAgIDYxOFx0ICAgICAgICBzZWNvbmRSb3dQYW5lbC5hZGQoYXJyU3RhdGlvbkNvbWJvQm94KTtcbiAgIDYxOVx0ICAgICAgICBzZWNvbmRSb3dQYW5lbC5hZGQoZGVwVGltZUxhYmVsKTtcbiAgIDYyMFx0ICAgICAgICBzZWNvbmRSb3dQYW5lbC5hZGQodGltZVNwaW5uZXJQYW5lbCk7XG4gICA2MjFcdCAgICAgICAgc2Vjb25kUm93UGFuZWwuYWRkKHVzZVRpbWVDaGVja0JveCk7XG4gICA2MjJcdFxuICAgNjIzXHQgICAgICAgIC8vIFBhbmVsIGNobyBjw6FjIG7DunQgdMOsbSBraeG6v20gdsOgIGzDoG0gbeG7m2lcbiAgIDYyNFx0ICAgICAgICBKUGFuZWwgYnV0dG9uUGFuZWwgPSBuZXcgSlBhbmVsKG5ldyBGbG93TGF5b3V0KEZsb3dMYXlvdXQuTEVGVCwgMTAsIDUpKTtcbiAgIDYyNVx0XG4gICA2MjZcdCAgICAgICAgLy8gTsO6dCB0w6xtIGtp4bq/bSB24bubaSBiaeG7g3UgdMaw4bujbmcgdMO5eSBjaOG7iW5oXG4gICA2MjdcdCAgICAgICAgc2VhcmNoQnV0dG9uID0gbmV3IEpCdXR0b24oXCJUw6xtIEtp4bq/bVwiKTtcbiAgIDYyOFx0ICAgICAgICBzZWFyY2hCdXR0b24uc2V0SWNvbihjcmVhdGVTZWFyY2hJY29uKDE2LCAxNikpO1xuICAgNjI5XHQgICAgICAgIHNlYXJjaEJ1dHRvbi5hZGRBY3Rpb25MaXN0ZW5lcihlIC0+IHtcbiAgIDYzMFx0ICAgICAgICAgICAgdHJ5IHtcbiAgIDYzMVx0ICAgICAgICAgICAgICAgIC8vIEzhuqV5IGPDoWMgZ2nDoSB0cuG7iyB0w6xtIGtp4bq/bVxuICAgNjMyXHQgICAgICAgICAgICAgICAgRGF0ZSBzZWxlY3RlZERhdGUgPSBkYXRlQ2hvb3Nlci5nZXREYXRlKCk7XG4gICA2MzNcdCAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWREYXRlID09IG51bGwpIHtcbiAgIDYzNFx0ICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKFwiVnVpIGzDsm5nIGNo4buNbiBuZ8OgeSBo4bujcCBs4buHLlwiKTtcbiAgIDYzNVx0ICAgICAgICAgICAgICAgIH1cbiAgIDYzNlx0XG4gICA2MzdcdCAgICAgICAgICAgICAgICBMb2NhbERhdGUgbG9jYWxEYXRlID0gc2VsZWN0ZWREYXRlLnRvSW5zdGFudCgpXG4gICA2MzhcdCAgICAgICAgICAgICAgICAgICAgICAgIC5hdFpvbmUoWm9uZUlkLnN5c3RlbURlZmF1bHQoKSlcbiAgIDYzOVx0ICAgICAgICAgICAgICAgICAgICAgICAgLnRvTG9jYWxEYXRlKCk7XG4gICA2NDBcdFxuICAgNjQxXHQgICAgICAgICAgICAgICAgU3RyaW5nIGdhRGkgPSBkZXBTdGF0aW9uQ29tYm9Cb3guZ2V0U2VsZWN0ZWRJdGVtKCkudG9TdHJpbmcoKTtcbiAgIDY0Mlx0ICAgICAgICAgICAgICAgIGlmIChnYURpLmVxdWFscyhcIlThuqV0IGPhuqNcIikpIGdhRGkgPSBudWxsO1xuICAgNjQzXHRcbiAgIDY0NFx0ICAgICAgICAgICAgICAgIFN0cmluZyBnYURlbiA9IGFyclN0YXRpb25Db21ib0JveC5nZXRTZWxlY3RlZEl0ZW0oKS50b1N0cmluZygpO1xuICAgNjQ1XHQgICAgICAgICAgICAgICAgaWYgKGdhRGVuLmVxdWFscyhcIlThuqV0IGPhuqNcIikpIGdhRGVuID0gbnVsbDtcbiAgIDY0Nlx0XG4gICA2NDdcdCAgICAgICAgICAgICAgICAvLyBM4bqleSBnacOhIHRy4buLIGdp4budIG7hur91IGNoZWNrYm94IMSRxrDhu6NjIGNo4buNblxuICAgNjQ4XHQgICAgICAgICAgICAgICAgU3RyaW5nIGdpb0RpID0gbnVsbDtcbiAgIDY0OVx0ICAgICAgICAgICAgICAgIGlmICh1c2VUaW1lQ2hlY2tCb3guaXNTZWxlY3RlZCgpKSB7XG4gICA2NTBcdCAgICAgICAgICAgICAgICAgICAgaW50IGhvdXIgPSAoaW50KSBob3VyU3Bpbm5lci5nZXRWYWx1ZSgpO1xuICAgNjUxXHQgICAgICAgICAgICAgICAgICAgIGludCBtaW51dGUgPSAoaW50KSBtaW51dGVTcGlubmVyLmdldFZhbHVlKCk7XG4gICA2NTJcdCAgICAgICAgICAgICAgICAgICAgZ2lvRGkgPSBTdHJpbmcuZm9ybWF0KFwiJTAyZDolMDJkXCIsIGhvdXIsIG1pbnV0ZSk7XG4gICA2NTNcdCAgICAgICAgICAgICAgICB9XG4gICA2NTRcdFxuICAgNjU1XHQgICAgICAgICAgICAgICAgLy8gVGjhu7FjIGhp4buHbiB0w6xtIGtp4bq/bSBk4buxYSB0csOqbiBjw6FjIHRyxrDhu51uZyDEkcOjIG5o4bqtcFxuICAgNjU2XHQgICAgICAgICAgICAgICAgc2VhcmNoU2NoZWR1bGVzKGxvY2FsRGF0ZSwgZ2FEaSwgZ2FEZW4sIGdpb0RpKTtcbiAgIDY1N1x0XG4gICA2NThcdCAgICAgICAgICAgIH0gY2F0Y2ggKElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBleCkge1xuICAgNjU5XHQgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coTGljaFRyaW5oVGF1UGFuZWwudGhpcyxcbiAgIDY2MFx0ICAgICAgICAgICAgICAgICAgICAgICAgZXguZ2V0TWVzc2FnZSgpLCBcIkzhu5dpIHTDrG0ga2nhur9tXCIsIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0UpO1xuICAgNjYxXHQgICAgICAgICAgICB9IGNhdGNoIChSZW1vdGVFeGNlcHRpb24gZXgpIHtcbiAgIDY2Mlx0ICAgICAgICAgICAgICAgIExPR0dFUi5sb2coTGV2ZWwuU0VWRVJFLCBcIkzhu5dpIGtoaSB0w6xtIGtp4bq/bSBs4buLY2ggdHLDrG5oXCIsIGV4KTtcbiAgIDY2M1x0ICAgICAgICAgICAgICAgIHNob3dFcnJvck1lc3NhZ2UoXCJM4buXaSBraGkgdMOsbSBraeG6v20gbOG7i2NoIHRyw6xuaFwiLCBleCk7XG4gICA2NjRcdCAgICAgICAgICAgIH1cbiAgIDY2NVx0ICAgICAgICB9KTtcbiAgIDY2Nlx0XG4gICA2NjdcdCAgICAgICAgLy8gTsO6dCBsw6BtIG3hu5tpIHbhu5tpIGJp4buDdSB0xrDhu6NuZyB0w7l5IGNo4buJbmhcbiAgIDY2OFx0ICAgICAgICByZWZyZXNoQnV0dG9uID0gbmV3IEpCdXR0b24oXCJMw6BtIE3hu5tpXCIpO1xuICAgNjY5XHQgICAgICAgIHJlZnJlc2hCdXR0b24uc2V0SWNvbihjcmVhdGVSZWZyZXNoSWNvbigxNiwgMTYpKTtcbiAgIDY3MFx0ICAgICAgICByZWZyZXNoQnV0dG9uLmFkZEFjdGlvbkxpc3RlbmVyKGUgLT4ge1xuICAgNjcxXHQgICAgICAgICAgICAvLyDEkOG6t3QgbOG6oWkgY8OhYyB0csaw4budbmcgdMOsbSBraeG6v20gduG7gSBnacOhIHRy4buLIG3hurdjIMSR4buLbmhcbiAgIDY3Mlx0ICAgICAgICAgICAgZGF0ZUNob29zZXIuc2V0RGF0ZShuZXcgRGF0ZSgpKTtcbiAgIDY3M1x0ICAgICAgICAgICAgZmlsdGVyQ29tYm9Cb3guc2V0U2VsZWN0ZWRJdGVtKFwiVOG6pXQgY+G6o1wiKTtcbiAgIDY3NFx0ICAgICAgICAgICAgZGVwU3RhdGlvbkNvbWJvQm94LnNldFNlbGVjdGVkSXRlbShcIlThuqV0IGPhuqNcIik7XG4gICA2NzVcdCAgICAgICAgICAgIGFyclN0YXRpb25Db21ib0JveC5zZXRTZWxlY3RlZEl0ZW0oXCJU4bqldCBj4bqjXCIpO1xuICAgNjc2XHQgICAgICAgICAgICB1c2VUaW1lQ2hlY2tCb3guc2V0U2VsZWN0ZWQoZmFsc2UpO1xuICAgNjc3XHQgICAgICAgICAgICBob3VyU3Bpbm5lci5zZXRWYWx1ZSgwKTtcbiAgIDY3OFx0ICAgICAgICAgICAgbWludXRlU3Bpbm5lci5zZXRWYWx1ZSgwKTtcbiAgIDY3OVx0ICAgICAgICAgICAgaG91clNwaW5uZXIuc2V0RW5hYmxlZChmYWxzZSk7XG4gICA2ODBcdCAgICAgICAgICAgIG1pbnV0ZVNwaW5uZXIuc2V0RW5hYmxlZChmYWxzZSk7XG4gICA2ODFcdFxuICAgNjgyXHQgICAgICAgICAgICAvLyBMw6BtIG3hu5tpIGThu68gbGnhu4d1XG4gICA2ODNcdCAgICAgICAgICAgIHJlZnJlc2hEYXRhKCk7XG4gICA2ODRcdCAgICAgICAgfSk7XG4gICA2ODVcdFxuICAgNjg2XHQgICAgICAgIC8vIFRow6ptIGPDoWMgbsO6dCB2w6BvIHBhbmVsIG7DunRcbiAgIDY4N1x0ICAgICAgICBidXR0b25QYW5lbC5hZGQoc2VhcmNoQnV0dG9uKTtcbiAgIDY4OFx0ICAgICAgICBidXR0b25QYW5lbC5hZGQocmVmcmVzaEJ1dHRvbik7XG4gICA2ODlcdFxuICAgNjkwXHQgICAgICAgIC8vIFThu5VuZyBo4bujcCB04bqldCBj4bqjIGPDoWMgcGFuZWwgdsOgbyBwYW5lbCBjaMOtbmhcbiAgIDY5MVx0ICAgICAgICBtYWluU2VhcmNoUGFuZWwuYWRkKGZpcnN0Um93UGFuZWwsIEJvcmRlckxheW91dC5OT1JUSCk7XG4gICA2OTJcdCAgICAgICAgbWFpblNlYXJjaFBhbmVsLmFkZChzZWNvbmRSb3dQYW5lbCwgQm9yZGVyTGF5b3V0LkNFTlRFUik7XG4gICA2OTNcdCAgICAgICAgbWFpblNlYXJjaFBhbmVsLmFkZChidXR0b25QYW5lbCwgQm9yZGVyTGF5b3V0LlNPVVRIKTtcbiAgIDY5NFx0XG4gICA2OTVcdCAgICAgICAgb3V0ZXJQYW5lbC5hZGQobWFpblNlYXJjaFBhbmVsLCBCb3JkZXJMYXlvdXQuQ0VOVEVSKTtcbiAgIDY5Nlx0ICAgICAgICByZXR1cm4gb3V0ZXJQYW5lbDtcbiAgIDY5N1x0ICAgIH1cbiAgIDY5OFx0XG4gICA2OTlcdCAgICAvKipcbiAgIDcwMFx0ICAgICAqIFRoaeG6v3QgbOG6rXAgY2jhu6ljIG7Eg25nIEF1dG9Db21wbGV0ZSBjaG8gSkNvbWJvQm94XG4gICA3MDFcdCAgICAgKiBAcGFyYW0gY29tYm9Cb3ggSkNvbWJvQm94IGPhuqduIHRow6ptIGNo4bupYyBuxINuZyBBdXRvQ29tcGxldGVcbiAgIDcwMlx0ICAgICAqL1xuICAgNzAzXHQgICAgcHJpdmF0ZSB2b2lkIHNldHVwQXV0b0NvbXBsZXRlKEpDb21ib0JveDxTdHJpbmc+IGNvbWJvQm94KSB7XG4gICA3MDRcdCAgICAgICAgZmluYWwgSlRleHRGaWVsZCBlZGl0b3IgPSAoSlRleHRGaWVsZCkgY29tYm9Cb3guZ2V0RWRpdG9yKCkuZ2V0RWRpdG9yQ29tcG9uZW50KCk7XG4gICA3MDVcdFxuICAgNzA2XHQgICAgICAgIC8vIFThuqFvIG3hu5l0IEFycmF5TGlzdCDEkeG7gyBsxrB1IGPDoWMgbeG7pWMgYmFuIMSR4bqndVxuICAgNzA3XHQgICAgICAgIGZpbmFsIExpc3Q8U3RyaW5nPiBvcmlnaW5hbEl0ZW1zID0gbmV3IEFycmF5TGlzdDw+KCk7XG4gICA3MDhcdFxuICAgNzA5XHQgICAgICAgIC8vIMSQ4bqjbSBi4bqjbyBjb21ib0JveCBsdcO0biBjw7MgXCJU4bqldCBj4bqjXCIgbMOgIGzhu7FhIGNo4buNbiBt4bq3YyDEkeG7i25oIMSR4bqndSB0acOqblxuICAgNzEwXHQgICAgICAgIGNvbWJvQm94LmFkZEl0ZW0oXCJU4bqldCBj4bqjXCIpO1xuICAgNzExXHQgICAgICAgIG9yaWdpbmFsSXRlbXMuYWRkKFwiVOG6pXQgY+G6o1wiKTtcbiAgIDcxMlx0XG4gICA3MTNcdCAgICAgICAgLy8gVOG6oW8gbeG7mXQgbOG7jWMgdsSDbiBi4bqjbiDEkeG7gyB44butIGzDvSBz4buxIGtp4buHbiBiw6BuIHBow61tIHRoYXkgdsOsIGTDuW5nIERvY3VtZW50TGlzdGVuZXJcbiAgIDcxNFx0ICAgICAgICBlZGl0b3IuYWRkS2V5TGlzdGVuZXIobmV3IEtleUFkYXB0ZXIoKSB7XG4gICA3MTVcdCAgICAgICAgICAgIEBPdmVycmlkZVxuICAgNzE2XHQgICAgICAgICAgICBwdWJsaWMgdm9pZCBrZXlSZWxlYXNlZChLZXlFdmVudCBlKSB7XG4gICA3MTdcdCAgICAgICAgICAgICAgICAvLyBC4buPIHF1YSBjw6FjIHBow61tIMSR4bq3YyBiaeG7h3RcbiAgIDcxOFx0ICAgICAgICAgICAgICAgIGlmIChlLmdldEtleUNvZGUoKSA9PSBLZXlFdmVudC5WS19FTlRFUiB8fFxuICAgNzE5XHQgICAgICAgICAgICAgICAgICAgICAgICBlLmdldEtleUNvZGUoKSA9PSBLZXlFdmVudC5WS19FU0NBUEUgfHxcbiAgIDcyMFx0ICAgICAgICAgICAgICAgICAgICAgICAgZS5nZXRLZXlDb2RlKCkgPT0gS2V5RXZlbnQuVktfVVAgfHxcbiAgIDcyMVx0ICAgICAgICAgICAgICAgICAgICAgICAgZS5nZXRLZXlDb2RlKCkgPT0gS2V5RXZlbnQuVktfRE9XTikge1xuICAgNzIyXHQgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgIDcyM1x0ICAgICAgICAgICAgICAgIH1cbiAgIDcyNFx0XG4gICA3MjVcdCAgICAgICAgICAgICAgICAvLyBM4bqleSB2xINuIGLhuqNuIGhp4buHbiB04bqhaSB0cm9uZyBlZGl0b3JcbiAgIDcyNlx0ICAgICAgICAgICAgICAgIFN0cmluZyB0ZXh0ID0gZWRpdG9yLmdldFRleHQoKTtcbiAgIDcyN1x0XG4gICA3MjhcdCAgICAgICAgICAgICAgICAvLyBLaMO0bmcgdGjhu7FjIGhp4buHbiBs4buNYyBu4bq/dSB2xINuIGLhuqNuIHF1w6Egbmfhuq9uXG4gICA3MjlcdCAgICAgICAgICAgICAgICBpZiAodGV4dC5sZW5ndGgoKSA8IDEpIHtcbiAgIDczMFx0ICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICA3MzFcdCAgICAgICAgICAgICAgICB9XG4gICA3MzJcdFxuICAgNzMzXHQgICAgICAgICAgICAgICAgLy8gU+G7rSBk4bulbmcgU3dpbmdVdGlsaXRpZXMuaW52b2tlTGF0ZXIgxJHhu4MgdHLDoW5oIGzhu5dpIGtoaSBz4butYSDEkeG7lWkgbcO0IGjDrG5oIHRyb25nIGzDumMgeOG7rSBsw70gc+G7sSBraeG7h25cbiAgIDczNFx0ICAgICAgICAgICAgICAgIFN3aW5nVXRpbGl0aWVzLmludm9rZUxhdGVyKCgpIC0+IHtcbiAgIDczNVx0ICAgICAgICAgICAgICAgICAgICBmaWx0ZXJJdGVtcyhjb21ib0JveCwgdGV4dCwgb3JpZ2luYWxJdGVtcyk7XG4gICA3MzZcdCAgICAgICAgICAgICAgICB9KTtcbiAgIDczN1x0ICAgICAgICAgICAgfVxuICAgNzM4XHQgICAgICAgIH0pO1xuICAgNzM5XHQgICAgfVxuICAgNzQwXHQgICAgcHJpdmF0ZSB2b2lkIGZpbHRlckl0ZW1zKEpDb21ib0JveDxTdHJpbmc+IGNvbWJvQm94LCBTdHJpbmcgdGV4dCwgTGlzdDxTdHJpbmc+IG9yaWdpbmFsSXRlbXMpIHtcbiAgIDc0MVx0ICAgICAgICAvLyBMxrB1IGzhuqFpIGPDoWMgbOG7sWEgY2jhu41uIGhp4buHbiB04bqhaVxuICAgNzQyXHQgICAgICAgIE9iamVjdCBzZWxlY3RlZEl0ZW0gPSBjb21ib0JveC5nZXRTZWxlY3RlZEl0ZW0oKTtcbiAgIDc0M1x0ICAgICAgICBTdHJpbmcgdHlwZWRUZXh0ID0gdGV4dC50b0xvd2VyQ2FzZSgpO1xuICAgNzQ0XHRcbiAgIDc0NVx0ICAgICAgICAvLyDEkMOzbmcgcG9wdXAgdHJvbmcga2hpIHRoYXkgxJHhu5VpIG3hu6VjXG4gICA3NDZcdCAgICAgICAgYm9vbGVhbiBpc1BvcHVwVmlzaWJsZSA9IGNvbWJvQm94LmlzUG9wdXBWaXNpYmxlKCk7XG4gICA3NDdcdCAgICAgICAgaWYgKGlzUG9wdXBWaXNpYmxlKSB7XG4gICA3NDhcdCAgICAgICAgICAgIGNvbWJvQm94LmhpZGVQb3B1cCgpO1xuICAgNzQ5XHQgICAgICAgIH1cbiAgIDc1MFx0XG4gICA3NTFcdCAgICAgICAgLy8gVOG6oW8gZGFuaCBzw6FjaCBjw6FjIG3hu6VjIHBow7kgaOG7o3BcbiAgIDc1Mlx0ICAgICAgICBMaXN0PFN0cmluZz4gbWF0Y2hpbmdJdGVtcyA9IG9yaWdpbmFsSXRlbXMuc3RyZWFtKClcbiAgIDc1M1x0ICAgICAgICAgICAgICAgIC5maWx0ZXIoaXRlbSAtPiBpdGVtLnRvTG93ZXJDYXNlKCkuY29udGFpbnModHlwZWRUZXh0KSB8fCBpdGVtLmVxdWFscyhcIlThuqV0IGPhuqNcIikpXG4gICA3NTRcdCAgICAgICAgICAgICAgICAuY29sbGVjdChDb2xsZWN0b3JzLnRvTGlzdCgpKTtcbiAgIDc1NVx0XG4gICA3NTZcdCAgICAgICAgLy8gTMOgbSBt4bubaSBtw7QgaMOsbmggY2jhu4kga2hpIGPhuqduIHRoaeG6v3RcbiAgIDc1N1x0ICAgICAgICBEZWZhdWx0Q29tYm9Cb3hNb2RlbDxTdHJpbmc+IG1vZGVsID0gKERlZmF1bHRDb21ib0JveE1vZGVsPFN0cmluZz4pIGNvbWJvQm94LmdldE1vZGVsKCk7XG4gICA3NThcdCAgICAgICAgbW9kZWwucmVtb3ZlQWxsRWxlbWVudHMoKTtcbiAgIDc1OVx0XG4gICA3NjBcdCAgICAgICAgLy8gTHXDtG4gdGjDqm0gXCJU4bqldCBj4bqjXCIgdHLGsOG7m2MgdGnDqm5cbiAgIDc2MVx0ICAgICAgICBtb2RlbC5hZGRFbGVtZW50KFwiVOG6pXQgY+G6o1wiKTtcbiAgIDc2Mlx0XG4gICA3NjNcdCAgICAgICAgLy8gVGjDqm0gY8OhYyBt4bulYyBwaMO5IGjhu6NwICh0cuG7qyBcIlThuqV0IGPhuqNcIiDEkcOjIHRow6ptKVxuICAgNzY0XHQgICAgICAgIG1hdGNoaW5nSXRlbXMuc3RyZWFtKClcbiAgIDc2NVx0ICAgICAgICAgICAgICAgIC5maWx0ZXIoaXRlbSAtPiAhaXRlbS5lcXVhbHMoXCJU4bqldCBj4bqjXCIpKVxuICAgNzY2XHQgICAgICAgICAgICAgICAgLmZvckVhY2gobW9kZWw6OmFkZEVsZW1lbnQpO1xuICAgNzY3XHRcbiAgIDc2OFx0ICAgICAgICAvLyDEkOG6t3QgbOG6oWkgdsSDbiBi4bqjbiBjaG8gZWRpdG9yXG4gICA3NjlcdCAgICAgICAgY29tYm9Cb3guZ2V0RWRpdG9yKCkuc2V0SXRlbSh0ZXh0KTtcbiAgIDc3MFx0XG4gICA3NzFcdCAgICAgICAgLy8gSGnhu4NuIHRo4buLIGzhuqFpIHBvcHVwIG7hur91IHRyxrDhu5tjIMSRw7MgxJHDoyBt4bufXG4gICA3NzJcdCAgICAgICAgaWYgKGlzUG9wdXBWaXNpYmxlICYmIG1vZGVsLmdldFNpemUoKSA+IDApIHtcbiAgIDc3M1x0ICAgICAgICAgICAgY29tYm9Cb3guc2hvd1BvcHVwKCk7XG4gICA3NzRcdCAgICAgICAgfVxuICAgNzc1XHQgICAgfVxuICAgNzc2XHQgICAgLyoqXG4gICA3NzdcdCAgICAgKiBU4bqjaSBkYW5oIHPDoWNoIGdhIHbDoG8gY8OhYyBKQ29tYm9Cb3hcbiAgIDc3OFx0ICAgICAqL1xuICAgNzc5XHQgICAgcHJpdmF0ZSB2b2lkIGxvYWRTdGF0aW9uTGlzdChKQ29tYm9Cb3g8U3RyaW5nPiBkZXBDb21ib0JveCwgSkNvbWJvQm94PFN0cmluZz4gYXJyQ29tYm9Cb3gpIHtcbiAgIDc4MFx0ICAgICAgICB0cnkge1xuICAgNzgxXHQgICAgICAgICAgICBpZiAoaXNDb25uZWN0ZWQgJiYgbGljaFRyaW5oVGF1REFPICE9IG51bGwpIHtcbiAgIDc4Mlx0ICAgICAgICAgICAgICAgIC8vIEzhuqV5IGRhbmggc8OhY2ggZ2EgdOG7qyBjxqEgc+G7nyBk4buvIGxp4buHdVxuICAgNzgzXHQgICAgICAgICAgICAgICAgTGlzdDxTdHJpbmc+IHN0YXRpb25zID0gbGljaFRyaW5oVGF1REFPLmdldEFsbFN0YXRpb25zKCk7XG4gICA3ODRcdFxuICAgNzg1XHQgICAgICAgICAgICAgICAgLy8gWMOzYSB04bqldCBj4bqjIGPDoWMgbeG7pWMgaGnhu4duIGPDs1xuICAgNzg2XHQgICAgICAgICAgICAgICAgZGVwQ29tYm9Cb3gucmVtb3ZlQWxsSXRlbXMoKTtcbiAgIDc4N1x0ICAgICAgICAgICAgICAgIGFyckNvbWJvQm94LnJlbW92ZUFsbEl0ZW1zKCk7XG4gICA3ODhcdFxuICAgNzg5XHQgICAgICAgICAgICAgICAgLy8gTHXDtG4gdGjDqm0gXCJU4bqldCBj4bqjXCIgdHLGsOG7m2MgdGnDqm5cbiAgIDc5MFx0ICAgICAgICAgICAgICAgIGRlcENvbWJvQm94LmFkZEl0ZW0oXCJU4bqldCBj4bqjXCIpO1xuICAgNzkxXHQgICAgICAgICAgICAgICAgYXJyQ29tYm9Cb3guYWRkSXRlbShcIlThuqV0IGPhuqNcIik7XG4gICA3OTJcdFxuICAgNzkzXHQgICAgICAgICAgICAgICAgaWYgKHN0YXRpb25zICE9IG51bGwgJiYgIXN0YXRpb25zLmlzRW1wdHkoKSkge1xuICAgNzk0XHQgICAgICAgICAgICAgICAgICAgIC8vIFRow6ptIGPDoWMgZ2EgdsOgbyBDb21ib0JveCBt4buZdCBjw6FjaCBhbiB0b8OgblxuICAgNzk1XHQgICAgICAgICAgICAgICAgICAgIGZvciAoU3RyaW5nIHN0YXRpb24gOiBzdGF0aW9ucykge1xuICAgNzk2XHQgICAgICAgICAgICAgICAgICAgICAgICBkZXBDb21ib0JveC5hZGRJdGVtKHN0YXRpb24pO1xuICAgNzk3XHQgICAgICAgICAgICAgICAgICAgICAgICBhcnJDb21ib0JveC5hZGRJdGVtKHN0YXRpb24pO1xuICAgNzk4XHQgICAgICAgICAgICAgICAgICAgIH1cbiAgIDc5OVx0XG4gICA4MDBcdCAgICAgICAgICAgICAgICAgICAgLy8gVGhp4bq/dCBs4bqtcCBBdXRvQ29tcGxldGUgY2hvIGPDoWMgQ29tYm9Cb3ggc2F1IGtoaSDEkcOjIHRow6ptIHThuqV0IGPhuqMgY8OhYyBt4bulY1xuICAgODAxXHQgICAgICAgICAgICAgICAgICAgIHNldHVwQ29tYm9Cb3hGaWx0ZXJpbmcoZGVwQ29tYm9Cb3gpO1xuICAgODAyXHQgICAgICAgICAgICAgICAgICAgIHNldHVwQ29tYm9Cb3hGaWx0ZXJpbmcoYXJyQ29tYm9Cb3gpO1xuICAgODAzXHRcbiAgIDgwNFx0ICAgICAgICAgICAgICAgICAgICBMT0dHRVIuaW5mbyhcIsSQw6MgdOG6o2kgdGjDoG5oIGPDtG5nIFwiICsgc3RhdGlvbnMuc2l6ZSgpICsgXCIgZ2EgdOG7qyBjxqEgc+G7nyBk4buvIGxp4buHdVwiKTtcbiAgIDgwNVx0ICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICA4MDZcdCAgICAgICAgICAgICAgICAgICAgTE9HR0VSLndhcm5pbmcoXCJLaMO0bmcgdMOsbSB0aOG6pXkgZ2EgbsOgbyB0cm9uZyBjxqEgc+G7nyBk4buvIGxp4buHdVwiKTtcbiAgIDgwN1x0ICAgICAgICAgICAgICAgIH1cbiAgIDgwOFx0ICAgICAgICAgICAgfVxuICAgODA5XHQgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICA4MTBcdCAgICAgICAgICAgIExPR0dFUi5sb2coTGV2ZWwuU0VWRVJFLCBcIkzhu5dpIGtoaSB04bqjaSBkYW5oIHPDoWNoIGdhOiBcIiArIGUuZ2V0TWVzc2FnZSgpLCBlKTtcbiAgIDgxMVx0ICAgICAgICB9XG4gICA4MTJcdCAgICB9XG4gICA4MTNcdCAgICBwcml2YXRlIHZvaWQgc2V0dXBDb21ib0JveEZpbHRlcmluZyhKQ29tYm9Cb3g8U3RyaW5nPiBjb21ib0JveCkge1xuICAgODE0XHQgICAgICAgIC8vIMSQ4bqjbSBi4bqjbyBDb21ib0JveCBjw7MgdGjhu4MgY2jhu4luaCBz4butYVxuICAgODE1XHQgICAgICAgIGNvbWJvQm94LnNldEVkaXRhYmxlKHRydWUpO1xuICAgODE2XHRcbiAgIDgxN1x0ICAgICAgICAvLyBM4bqleSB04bqldCBj4bqjIGPDoWMgbeG7pWMgaGnhu4duIHThuqFpXG4gICA4MThcdCAgICAgICAgTGlzdDxTdHJpbmc+IGFsbEl0ZW1zID0gbmV3IEFycmF5TGlzdDw+KCk7XG4gICA4MTlcdCAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjb21ib0JveC5nZXRJdGVtQ291bnQoKTsgaSsrKSB7XG4gICA4MjBcdCAgICAgICAgICAgIGFsbEl0ZW1zLmFkZChjb21ib0JveC5nZXRJdGVtQXQoaSkpO1xuICAgODIxXHQgICAgICAgIH1cbiAgIDgyMlx0XG4gICA4MjNcdCAgICAgICAgLy8gVGhp4bq/dCBs4bqtcCByZW5kZXJlciDEkeG6t2MgYmnhu4d0IMSR4buDIGhpZ2hsaWdodCB04burIGtow7NhIHTDrG0ga2nhur9tXG4gICA4MjRcdCAgICAgICAgY29tYm9Cb3guc2V0UmVuZGVyZXIobmV3IERlZmF1bHRMaXN0Q2VsbFJlbmRlcmVyKCkge1xuICAgODI1XHQgICAgICAgICAgICBAT3ZlcnJpZGVcbiAgIDgyNlx0ICAgICAgICAgICAgcHVibGljIENvbXBvbmVudCBnZXRMaXN0Q2VsbFJlbmRlcmVyQ29tcG9uZW50KEpMaXN0PD8+IGxpc3QsIE9iamVjdCB2YWx1ZSxcbiAgIDgyN1x0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBpbmRleCwgYm9vbGVhbiBpc1NlbGVjdGVkLCBib29sZWFuIGNlbGxIYXNGb2N1cykge1xuICAgODI4XHQgICAgICAgICAgICAgICAgQ29tcG9uZW50IGMgPSBzdXBlci5nZXRMaXN0Q2VsbFJlbmRlcmVyQ29tcG9uZW50KGxpc3QsIHZhbHVlLCBpbmRleCwgaXNTZWxlY3RlZCwgY2VsbEhhc0ZvY3VzKTtcbiAgIDgyOVx0XG4gICA4MzBcdCAgICAgICAgICAgICAgICBpZiAoYyBpbnN0YW5jZW9mIEpMYWJlbCAmJiB2YWx1ZSAhPSBudWxsKSB7XG4gICA4MzFcdCAgICAgICAgICAgICAgICAgICAgKChKTGFiZWwpIGMpLnNldFRleHQodmFsdWUudG9TdHJpbmcoKSk7XG4gICA4MzJcdCAgICAgICAgICAgICAgICB9XG4gICA4MzNcdFxuICAgODM0XHQgICAgICAgICAgICAgICAgcmV0dXJuIGM7XG4gICA4MzVcdCAgICAgICAgICAgIH1cbiAgIDgzNlx0ICAgICAgICB9KTtcbiAgIDgzN1x0XG4gICA4MzhcdCAgICAgICAgLy8gU+G7rSBk4bulbmcgS2V5QWRhcHRlciDEkeG7gyB44butIGzDvSBz4buxIGtp4buHbiBnw7UgcGjDrW1cbiAgIDgzOVx0ICAgICAgICBKVGV4dEZpZWxkIGVkaXRvciA9IChKVGV4dEZpZWxkKSBjb21ib0JveC5nZXRFZGl0b3IoKS5nZXRFZGl0b3JDb21wb25lbnQoKTtcbiAgIDg0MFx0ICAgICAgICBlZGl0b3IuYWRkS2V5TGlzdGVuZXIobmV3IEtleUFkYXB0ZXIoKSB7XG4gICA4NDFcdCAgICAgICAgICAgIEBPdmVycmlkZVxuICAgODQyXHQgICAgICAgICAgICBwdWJsaWMgdm9pZCBrZXlSZWxlYXNlZChLZXlFdmVudCBlKSB7XG4gICA4NDNcdCAgICAgICAgICAgICAgICAvLyBLaMO0bmcgeOG7rSBsw70gY8OhYyBwaMOtbSDEkeG6t2MgYmnhu4d0XG4gICA4NDRcdCAgICAgICAgICAgICAgICBpZiAoZS5nZXRLZXlDb2RlKCkgPT0gS2V5RXZlbnQuVktfRU5URVIgfHwgZS5nZXRLZXlDb2RlKCkgPT0gS2V5RXZlbnQuVktfVVAgfHxcbiAgIDg0NVx0ICAgICAgICAgICAgICAgICAgICAgICAgZS5nZXRLZXlDb2RlKCkgPT0gS2V5RXZlbnQuVktfRE9XTiB8fCBlLmdldEtleUNvZGUoKSA9PSBLZXlFdmVudC5WS19FU0NBUEUpIHtcbiAgIDg0Nlx0ICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICA4NDdcdCAgICAgICAgICAgICAgICB9XG4gICA4NDhcdFxuICAgODQ5XHQgICAgICAgICAgICAgICAgU3RyaW5nIHRleHQgPSBlZGl0b3IuZ2V0VGV4dCgpLnRvTG93ZXJDYXNlKCk7XG4gICA4NTBcdFxuICAgODUxXHQgICAgICAgICAgICAgICAgLy8gU+G7rSBk4bulbmcgU3dpbmdVdGlsaXRpZXMuaW52b2tlTGF0ZXIgxJHhu4MgdHLDoW5oIGzhu5dpIGtoaSB0aGF5IMSR4buVaSBtw7QgaMOsbmggdHJvbmcgc+G7sSBraeG7h25cbiAgIDg1Mlx0ICAgICAgICAgICAgICAgIFN3aW5nVXRpbGl0aWVzLmludm9rZUxhdGVyKCgpIC0+IHtcbiAgIDg1M1x0ICAgICAgICAgICAgICAgICAgICAvLyBMxrB1IGzhuqFpIHRy4bqhbmcgdGjDoWkgcG9wdXBcbiAgIDg1NFx0ICAgICAgICAgICAgICAgICAgICBib29sZWFuIHdhc1Zpc2libGUgPSBjb21ib0JveC5pc1BvcHVwVmlzaWJsZSgpO1xuICAgODU1XHQgICAgICAgICAgICAgICAgICAgIGNvbWJvQm94LmhpZGVQb3B1cCgpO1xuICAgODU2XHRcbiAgIDg1N1x0ICAgICAgICAgICAgICAgICAgICAvLyBU4bqhbyBtb2RlbCBt4bubaVxuICAgODU4XHQgICAgICAgICAgICAgICAgICAgIERlZmF1bHRDb21ib0JveE1vZGVsPFN0cmluZz4gbW9kZWwgPSBuZXcgRGVmYXVsdENvbWJvQm94TW9kZWw8PigpO1xuICAgODU5XHRcbiAgIDg2MFx0ICAgICAgICAgICAgICAgICAgICAvLyBMdcO0biB0aMOqbSBcIlThuqV0IGPhuqNcIiB2w6BvIMSR4bqndSB0acOqblxuICAgODYxXHQgICAgICAgICAgICAgICAgICAgIG1vZGVsLmFkZEVsZW1lbnQoXCJU4bqldCBj4bqjXCIpO1xuICAgODYyXHRcbiAgIDg2M1x0ICAgICAgICAgICAgICAgICAgICAvLyBUaMOqbSBjw6FjIG3hu6VjIHBow7kgaOG7o3BcbiAgIDg2NFx0ICAgICAgICAgICAgICAgICAgICBmb3IgKFN0cmluZyBpdGVtIDogYWxsSXRlbXMpIHtcbiAgIDg2NVx0ICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpdGVtLmVxdWFscyhcIlThuqV0IGPhuqNcIikgJiYgaXRlbS50b0xvd2VyQ2FzZSgpLmNvbnRhaW5zKHRleHQpKSB7XG4gICA4NjZcdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC5hZGRFbGVtZW50KGl0ZW0pO1xuICAgODY3XHQgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICA4NjhcdCAgICAgICAgICAgICAgICAgICAgfVxuICAgODY5XHRcbiAgIDg3MFx0ICAgICAgICAgICAgICAgICAgICAvLyDDgXAgZOG7pW5nIG1vZGVsIG3hu5tpXG4gICA4NzFcdCAgICAgICAgICAgICAgICAgICAgY29tYm9Cb3guc2V0TW9kZWwobW9kZWwpO1xuICAgODcyXHRcbiAgIDg3M1x0ICAgICAgICAgICAgICAgICAgICAvLyDEkOG6t3QgbOG6oWkgdsSDbiBi4bqjblxuICAgODc0XHQgICAgICAgICAgICAgICAgICAgIGNvbWJvQm94LmdldEVkaXRvcigpLnNldEl0ZW0odGV4dCk7XG4gICA4NzVcdCAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnNldENhcmV0UG9zaXRpb24odGV4dC5sZW5ndGgoKSk7XG4gICA4NzZcdFxuICAgODc3XHQgICAgICAgICAgICAgICAgICAgIC8vIEhp4buDbiB0aOG7iyBs4bqhaSBwb3B1cCBu4bq/dSB0csaw4bubYyDEkcOzIMSRw6MgbeG7nyB2w6AgY8OzIGvhur90IHF14bqjXG4gICA4NzhcdCAgICAgICAgICAgICAgICAgICAgaWYgKCh3YXNWaXNpYmxlIHx8ICF0ZXh0LmlzRW1wdHkoKSkgJiYgbW9kZWwuZ2V0U2l6ZSgpID4gMCkge1xuICAgODc5XHQgICAgICAgICAgICAgICAgICAgICAgICBjb21ib0JveC5zaG93UG9wdXAoKTtcbiAgIDg4MFx0ICAgICAgICAgICAgICAgICAgICB9XG4gICA4ODFcdCAgICAgICAgICAgICAgICB9KTtcbiAgIDg4Mlx0ICAgICAgICAgICAgfVxuICAgODgzXHQgICAgICAgIH0pO1xuICAgODg0XHQgICAgfVxuICAgODg1XHRcbiAgIDg4Nlx0ICAgIHByaXZhdGUgdm9pZCBzZWFyY2hTY2hlZHVsZXMoTG9jYWxEYXRlIGRhdGUsIFN0cmluZyBnYURpLCBTdHJpbmcgZ2FEZW4sIFN0cmluZyBnaW9EaSkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICA4ODdcdCAgICAgICAgaWYgKCFpc0Nvbm5lY3RlZCB8fCBsaWNoVHJpbmhUYXVEQU8gPT0gbnVsbCkge1xuICAgODg4XHQgICAgICAgICAgICByZWNvbm5lY3RBbmRMb2FkRGF0YShkYXRlKTtcbiAgIDg4OVx0ICAgICAgICAgICAgaWYgKCFpc0Nvbm5lY3RlZCkge1xuICAgODkwXHQgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFJlbW90ZUV4Y2VwdGlvbihcIktow7RuZyB0aOG7gyBr4bq/dCBu4buRaSDEkeG6v24gc2VydmVyXCIpO1xuICAgODkxXHQgICAgICAgICAgICB9XG4gICA4OTJcdCAgICAgICAgfVxuICAgODkzXHRcbiAgIDg5NFx0ICAgICAgICB0YWJsZU1vZGVsLnNldFJvd0NvdW50KDApO1xuICAgODk1XHQgICAgICAgIExpc3Q8TGljaFRyaW5oVGF1PiBzY2hlZHVsZXM7XG4gICA4OTZcdFxuICAgODk3XHQgICAgICAgIHRyeSB7XG4gICA4OThcdCAgICAgICAgICAgIC8vIFF1eeG6v3QgxJHhu4tuaCBwaMawxqFuZyB0aOG7qWMgdMOsbSBraeG6v20gZOG7sWEgdHLDqm4gY8OhYyB0aGFtIHPhu5FcbiAgIDg5OVx0ICAgICAgICAgICAgaWYgKGdhRGkgPT0gbnVsbCAmJiBnYURlbiA9PSBudWxsICYmIGdpb0RpID09IG51bGwpIHtcbiAgIDkwMFx0ICAgICAgICAgICAgICAgIC8vIENo4buJIHTDrG0gdGhlbyBuZ8OgeVxuICAgOTAxXHQgICAgICAgICAgICAgICAgc2NoZWR1bGVzID0gbGljaFRyaW5oVGF1REFPLmdldExpc3RMaWNoVHJpbmhUYXVCeURhdGUoZGF0ZSk7XG4gICA5MDJcdCAgICAgICAgICAgIH0gZWxzZSBpZiAoZ2FEaSAhPSBudWxsICYmIGdhRGVuID09IG51bGwgJiYgZ2lvRGkgPT0gbnVsbCkge1xuICAgOTAzXHQgICAgICAgICAgICAgICAgLy8gVMOsbSB0aGVvIG5nw6B5IHbDoCBnYSDEkWlcbiAgIDkwNFx0ICAgICAgICAgICAgICAgIHNjaGVkdWxlcyA9IGxpY2hUcmluaFRhdURBTy5nZXRMaXN0TGljaFRyaW5oVGF1QnlEYXRlQW5kR2FEaShkYXRlLCBnYURpKTtcbiAgIDkwNVx0ICAgICAgICAgICAgfSBlbHNlIGlmIChnYURpICE9IG51bGwgJiYgZ2FEZW4gIT0gbnVsbCAmJiBnaW9EaSA9PSBudWxsKSB7XG4gICA5MDZcdCAgICAgICAgICAgICAgICAvLyBUw6xtIHRoZW8gbmfDoHksIGdhIMSRaSB2w6AgZ2EgxJHhur9uXG4gICA5MDdcdCAgICAgICAgICAgICAgICBzY2hlZHVsZXMgPSBsaWNoVHJpbmhUYXVEQU8uZ2V0TGlzdExpY2hUcmluaFRhdUJ5RGF0ZUFuZEdhRGlHYURlbihkYXRlLCBnYURpLCBnYURlbik7XG4gICA5MDhcdCAgICAgICAgICAgIH0gZWxzZSBpZiAoZ2FEaSAhPSBudWxsICYmIGdhRGVuICE9IG51bGwgJiYgZ2lvRGkgIT0gbnVsbCkge1xuICAgOTA5XHQgICAgICAgICAgICAgICAgLy8gVMOsbSB0aGVvIHThuqV0IGPhuqMgY8OhYyB0csaw4budbmdcbiAgIDkxMFx0ICAgICAgICAgICAgICAgIHNjaGVkdWxlcyA9IGxpY2hUcmluaFRhdURBTy5nZXRMaXN0TGljaFRyaW5oVGF1QnlEYXRlQW5kR2FEaUdhRGVuQW5kR2lvRGkoZGF0ZSwgZ2FEaSwgZ2FEZW4sIGdpb0RpKTtcbiAgIDkxMVx0ICAgICAgICAgICAgfSBlbHNlIHtcbiAgIDkxMlx0ICAgICAgICAgICAgICAgIC8vIFRyxrDhu51uZyBo4bujcCBjw7JuIGzhuqFpOiBjw7MgZ2EgxJHhur9uIG5oxrBuZyBraMO0bmcgY8OzIGdhIMSRaSwgaG/hurdjIGPDsyBnaeG7nSDEkWkgbmjGsG5nIHRoaeG6v3UgZ2EgxJFpL8SR4bq/blxuICAgOTEzXHQgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2codGhpcyxcbiAgIDkxNFx0ICAgICAgICAgICAgICAgICAgICAgICAgXCLEkOG7gyB0w6xtIGtp4bq/bSB24bubaSBnYSDEkeG6v24sIGLhuqFuIGPhuqduIGNo4buNbiBnYSDEkWkgdHLGsOG7m2MuXFxuXCIgK1xuICAgOTE1XHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwixJDhu4MgdMOsbSBraeG6v20gduG7m2kgZ2nhu50gxJFpLCBi4bqhbiBj4bqnbiBjaOG7jW4gY+G6oyBnYSDEkWkgdsOgIGdhIMSR4bq/bi5cIixcbiAgIDkxNlx0ICAgICAgICAgICAgICAgICAgICAgICAgXCJUaMO0bmcgYsOhb1wiLCBKT3B0aW9uUGFuZS5JTkZPUk1BVElPTl9NRVNTQUdFKTtcbiAgIDkxN1x0ICAgICAgICAgICAgICAgIHJldHVybjtcbiAgIDkxOFx0ICAgICAgICAgICAgfVxuICAgOTE5XHRcbiAgIDkyMFx0ICAgICAgICAgICAgaWYgKHNjaGVkdWxlcyA9PSBudWxsIHx8IHNjaGVkdWxlcy5pc0VtcHR5KCkpIHtcbiAgIDkyMVx0ICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKHRoaXMsXG4gICA5MjJcdCAgICAgICAgICAgICAgICAgICAgICAgIFwiS2jDtG5nIHTDrG0gdGjhuqV5IGzhu4tjaCB0csOsbmggbsOgbyBwaMO5IGjhu6NwIHbhu5tpIHRpw6p1IGNow60gdMOsbSBraeG6v20uXCIsXG4gICA5MjNcdCAgICAgICAgICAgICAgICAgICAgICAgIFwiVGjDtG5nIGLDoW9cIixcbiAgIDkyNFx0ICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRSk7XG4gICA5MjVcdCAgICAgICAgICAgICAgICByZXR1cm47XG4gICA5MjZcdCAgICAgICAgICAgIH1cbiAgIDkyN1x0XG4gICA5MjhcdCAgICAgICAgICAgIC8vIMOBcCBk4bulbmcgYuG7mSBs4buNYyB0cuG6oW5nIHRow6FpIG7hur91IMSRxrDhu6NjIGNo4buNblxuICAgOTI5XHQgICAgICAgICAgICBPYmplY3Qgc2VsZWN0ZWRJdGVtID0gZmlsdGVyQ29tYm9Cb3guZ2V0U2VsZWN0ZWRJdGVtKCk7XG4gICA5MzBcdFxuICAgOTMxXHQgICAgICAgICAgICBmb3IgKExpY2hUcmluaFRhdSBzY2hlZHVsZSA6IHNjaGVkdWxlcykge1xuICAgOTMyXHQgICAgICAgICAgICAgICAgLy8gS2nhu4NtIHRyYSB4ZW0gbOG7i2NoIHRyw6xuaCBjw7MgcGjDuSBo4bujcCB24bubaSBi4buZIGzhu41jIHRy4bqhbmcgdGjDoWkgaGF5IGtow7RuZ1xuICAgOTMzXHQgICAgICAgICAgICAgICAgaWYgKG1hdGNoZXNTdGF0dXNGaWx0ZXIoc2NoZWR1bGUsIHNlbGVjdGVkSXRlbSkpIHtcbiAgIDkzNFx0ICAgICAgICAgICAgICAgICAgICB0YWJsZU1vZGVsLmFkZFJvdyhjcmVhdGVUYWJsZVJvdyhzY2hlZHVsZSkpO1xuICAgOTM1XHQgICAgICAgICAgICAgICAgfVxuICAgOTM2XHQgICAgICAgICAgICB9XG4gICA5MzdcdFxuICAgOTM4XHQgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICA5MzlcdCAgICAgICAgICAgIExPR0dFUi5sb2coTGV2ZWwuU0VWRVJFLCBcIkzhu5dpIGNoaSB0aeG6v3Qga2hpIHTDrG0ga2nhur9tOiBcIiArIGUuZ2V0TWVzc2FnZSgpLCBlKTtcbiAgIDk0MFx0ICAgICAgICAgICAgdGhyb3cgbmV3IFJlbW90ZUV4Y2VwdGlvbihcIkzhu5dpIGtoaSB0w6xtIGtp4bq/bTogXCIgKyBlLmdldE1lc3NhZ2UoKSwgZSk7XG4gICA5NDFcdCAgICAgICAgfVxuICAgOTQyXHQgICAgfVxuICAgOTQzXHRcbiAgIDk0NFx0ICAgIC8vIFBoxrDGoW5nIHRo4bupYyBt4bubaSDEkeG7gyBraeG7g20gdHJhIHRy4bqhbmcgdGjDoWlcbiAgIDk0NVx0ICAgIHByaXZhdGUgYm9vbGVhbiBtYXRjaGVzU3RhdHVzRmlsdGVyKExpY2hUcmluaFRhdSBzY2hlZHVsZSwgT2JqZWN0IGZpbHRlclZhbHVlKSB7XG4gICA5NDZcdCAgICAgICAgLy8gTuG6v3UgbMOgIFwiVOG6pXQgY+G6o1wiIGhv4bq3YyBudWxsLCBoaeG7g24gdGjhu4sgdOG6pXQgY+G6o1xuICAgOTQ3XHQgICAgICAgIGlmIChmaWx0ZXJWYWx1ZSA9PSBudWxsIHx8IFwiVOG6pXQgY+G6o1wiLmVxdWFscyhmaWx0ZXJWYWx1ZSkpIHtcbiAgIDk0OFx0ICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICA5NDlcdCAgICAgICAgfVxuICAgOTUwXHRcbiAgIDk1MVx0ICAgICAgICAvLyBO4bq/dSBs4buLY2ggdHLDrG5oIGtow7RuZyBjw7MgdHLhuqFuZyB0aMOhaSwga2jDtG5nIHBow7kgaOG7o3AgduG7m2kgYuG6pXQga+G7syBi4buZIGzhu41jIG7DoG8gbmdv4bqhaSB0cuG7qyBcIlThuqV0IGPhuqNcIlxuICAgOTUyXHQgICAgICAgIGlmIChzY2hlZHVsZS5nZXRUcmFuZ1RoYWkoKSA9PSBudWxsKSB7XG4gICA5NTNcdCAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgIDk1NFx0ICAgICAgICB9XG4gICA5NTVcdFxuICAgOTU2XHQgICAgICAgIC8vIE7hur91IGZpbHRlclZhbHVlIGzDoCBt4buZdCBUcmFuZ1RoYWkgZW51bVxuICAgOTU3XHQgICAgICAgIGlmIChmaWx0ZXJWYWx1ZSBpbnN0YW5jZW9mIFRyYW5nVGhhaSkge1xuICAgOTU4XHQgICAgICAgICAgICByZXR1cm4gc2NoZWR1bGUuZ2V0VHJhbmdUaGFpKCkgPT0gZmlsdGVyVmFsdWU7XG4gICA5NTlcdCAgICAgICAgfVxuICAgOTYwXHRcbiAgIDk2MVx0ICAgICAgICAvLyBO4bq/dSBmaWx0ZXJWYWx1ZSBsw6AgbeG7mXQgY2h14buXaSAoZ2nDoSB0cuG7iyBoaeG7g24gdGjhu4spXG4gICA5NjJcdCAgICAgICAgU3RyaW5nIGZpbHRlclN0cmluZyA9IGZpbHRlclZhbHVlLnRvU3RyaW5nKCk7XG4gICA5NjNcdFxuICAgOTY0XHQgICAgICAgIC8vIFNvIHPDoW5oIHbhu5tpIGdpw6EgdHLhu4sgaGnhu4NuIHRo4buLIGPhu6dhIHRy4bqhbmcgdGjDoWlcbiAgIDk2NVx0ICAgICAgICByZXR1cm4gc2NoZWR1bGUuZ2V0VHJhbmdUaGFpKCkuZ2V0VmFsdWUoKS5lcXVhbHMoZmlsdGVyU3RyaW5nKTtcbiAgIDk2Nlx0ICAgIH1cbiAgIDk2N1x0ICAgIHByaXZhdGUgSlBhbmVsIGNyZWF0ZVRhYmxlUGFuZWwoKSB7XG4gICA5NjhcdCAgICAgICAgSlBhbmVsIHBhbmVsID0gbmV3IEpQYW5lbChuZXcgQm9yZGVyTGF5b3V0KCkpO1xuICAgOTY5XHQgICAgICAgIHBhbmVsLnNldEJvcmRlcihCb3JkZXJGYWN0b3J5LmNyZWF0ZVRpdGxlZEJvcmRlcihcIkRhbmggU8OhY2ggTOG7i2NoIFRyw6xuaFwiKSk7XG4gICA5NzBcdFxuICAgOTcxXHQgICAgICAgIC8vIENyZWF0ZSB0YWJsZSBtb2RlbCB3aXRoIG5vbi1lZGl0YWJsZSBjZWxsc1xuICAgOTcyXHQgICAgICAgIFN0cmluZ1tdIGNvbHVtbnMgPSB7XCJJRFwiLCBcIk5nw6B5IMSQaVwiLCBcIk3DoyBUw6B1IC0gVMOqbiBUw6B1XCIsIFwiVHV54bq/biDEkMaw4budbmdcIiwgXCJHaeG7nSDEkGlcIiwgXCJHaeG7nSDEkOG6v25cIiwgXCJUcuG6oW5nIFRow6FpXCJ9O1xuICAgOTczXHQgICAgICAgIHRhYmxlTW9kZWwgPSBuZXcgRGVmYXVsdFRhYmxlTW9kZWwoY29sdW1ucywgMCkge1xuICAgOTc0XHQgICAgICAgICAgICBAT3ZlcnJpZGVcbiAgIDk3NVx0ICAgICAgICAgICAgcHVibGljIGJvb2xlYW4gaXNDZWxsRWRpdGFibGUoaW50IHJvdywgaW50IGNvbHVtbikge1xuICAgOTc2XHQgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgOTc3XHQgICAgICAgICAgICB9XG4gICA5NzhcdCAgICAgICAgfTtcbiAgIDk3OVx0XG4gICA5ODBcdCAgICAgICAgLy8gQ3JlYXRlIGFuZCBjb25maWd1cmUgdGFibGVcbiAgIDk4MVx0ICAgICAgICBzY2hlZHVsZVRhYmxlID0gbmV3IEpUYWJsZSh0YWJsZU1vZGVsKTtcbiAgIDk4Mlx0ICAgICAgICBzY2hlZHVsZVRhYmxlLnNldFJvd0hlaWdodCgyNSk7XG4gICA5ODNcdCAgICAgICAgc2NoZWR1bGVUYWJsZS5zZXRTZWxlY3Rpb25Nb2RlKExpc3RTZWxlY3Rpb25Nb2RlbC5TSU5HTEVfU0VMRUNUSU9OKTtcbiAgIDk4NFx0ICAgICAgICBzY2hlZHVsZVRhYmxlLnNldEF1dG9DcmVhdGVSb3dTb3J0ZXIodHJ1ZSk7XG4gICA5ODVcdFxuICAgOTg2XHQgICAgICAgIC8vIFRoaeG6v3QgbOG6rXAgbcOgdSBu4buBbiBjaG8gaMOgbmcgbOG6uyB2w6AgaMOgbmcgY2jhurVuXG4gICA5ODdcdCAgICAgICAgc2NoZWR1bGVUYWJsZS5zZXREZWZhdWx0UmVuZGVyZXIoT2JqZWN0LmNsYXNzLCBuZXcgQ3VzdG9tVGFibGVDZWxsUmVuZGVyZXIoKSk7XG4gICA5ODhcdFxuICAgOTg5XHQgICAgICAgIC8vIFN0eWxlIHRoZSB0YWJsZSBoZWFkZXJcbiAgIDk5MFx0ICAgICAgICBKVGFibGVIZWFkZXIgaGVhZGVyID0gc2NoZWR1bGVUYWJsZS5nZXRUYWJsZUhlYWRlcigpO1xuICAgOTkxXHQgICAgICAgIGhlYWRlci5zZXRGb250KG5ldyBGb250KFwiQXJpYWxcIiwgRm9udC5CT0xELCAxMikpO1xuICAgOTkyXHQgICAgICAgIGhlYWRlci5zZXRCYWNrZ3JvdW5kKG5ldyBDb2xvcig0MSwgMTI4LCAxODUpKTsgLy8gTcOgdSB4YW5oIGTGsMahbmcgY2hvIGhlYWRlclxuICAgOTkzXHQgICAgICAgIGhlYWRlci5zZXRGb3JlZ3JvdW5kKENvbG9yLldISVRFKTsgIC8vIE3DoHUgdHLhuq9uZyBjaG8gY2jhu69cbiAgIDk5NFx0XG4gICA5OTVcdCAgICAgICAgLy8gw4FwIGThu6VuZyBjdXN0b20gVUkgY2hvIGLhuqNuZyDEkeG7gyBjw7MgaGnhu4d1IOG7qW5nIGhvdmVyXG4gICA5OTZcdCAgICAgICAgc2V0dXBUYWJsZVVJKCk7XG4gICA5OTdcdFxuICAgOTk4XHQgICAgICAgIC8vIFRoaeG6v3QgbOG6rXAgcGjDrW0gdOG6r3QgdsOgIG1lbnUgbmfhu68gY+G6o25oXG4gICA5OTlcdCAgICAgICAgc2V0dXBLZXlCaW5kaW5ncygpO1xuICAxMDAwXHQgICAgICAgIHNldHVwQ29udGV4dE1lbnUoKTtcbiAgMTAwMVx0XG4gIDEwMDJcdCAgICAgICAgLy8gQWRkIHRhYmxlIHRvIHNjcm9sbCBwYW5lXG4gIDEwMDNcdCAgICAgICAgSlNjcm9sbFBhbmUgc2Nyb2xsUGFuZSA9IG5ldyBKU2Nyb2xsUGFuZShzY2hlZHVsZVRhYmxlKTtcbiAgMTAwNFx0ICAgICAgICBzY3JvbGxQYW5lLmdldFZpZXdwb3J0KCkuc2V0QmFja2dyb3VuZChDb2xvci5XSElURSk7XG4gIDEwMDVcdFxuICAxMDA2XHQgICAgICAgIC8vIMSQ4bqjbSBi4bqjbyBoaeG7g24gdGjhu4sgaGVhZGVyIMSRw7puZyBtw6B1IHPhuq9jXG4gIDEwMDdcdCAgICAgICAgc2Nyb2xsUGFuZS5zZXRDb2x1bW5IZWFkZXJWaWV3KGhlYWRlcik7XG4gIDEwMDhcdFxuICAxMDA5XHQgICAgICAgIHBhbmVsLmFkZChzY3JvbGxQYW5lLCBCb3JkZXJMYXlvdXQuQ0VOVEVSKTtcbiAgMTAxMFx0ICAgICAgICByZXR1cm4gcGFuZWw7XG4gIDEwMTFcdCAgICB9XG4gIDEwMTJcdFxuICAxMDEzXHQgICAgcHJpdmF0ZSB2b2lkIHNldHVwVGFibGVVSSgpIHtcbiAgMTAxNFx0ICAgICAgICAvLyDEkOG6t3QgbeG7mXQgc+G7kSB0aHXhu5ljIHTDrW5oIGNobyBi4bqjbmdcbiAgMTAxNVx0ICAgICAgICBzY2hlZHVsZVRhYmxlLnNldFNob3dIb3Jpem9udGFsTGluZXModHJ1ZSk7XG4gIDEwMTZcdCAgICAgICAgc2NoZWR1bGVUYWJsZS5zZXRTaG93VmVydGljYWxMaW5lcyh0cnVlKTtcbiAgMTAxN1x0ICAgICAgICBzY2hlZHVsZVRhYmxlLnNldEdyaWRDb2xvcihuZXcgQ29sb3IoMjMwLCAyMzAsIDIzMCkpO1xuICAxMDE4XHQgICAgICAgIHNjaGVkdWxlVGFibGUuc2V0QmFja2dyb3VuZChDb2xvci5XSElURSk7XG4gIDEwMTlcdCAgICAgICAgc2NoZWR1bGVUYWJsZS5zZXRGb3JlZ3JvdW5kKENvbG9yLkJMQUNLKTtcbiAgMTAyMFx0ICAgICAgICBzY2hlZHVsZVRhYmxlLnNldFNlbGVjdGlvbkJhY2tncm91bmQobmV3IENvbG9yKDY2LCAxMzksIDIwMikpOyAvLyBNw6B1IGtoaSBjaOG7jW4gY2jDrW5oIHRo4bupY1xuICAxMDIxXHQgICAgICAgIHNjaGVkdWxlVGFibGUuc2V0U2VsZWN0aW9uRm9yZWdyb3VuZChDb2xvci5XSElURSk7XG4gIDEwMjJcdFxuICAxMDIzXHQgICAgICAgIC8vIEJp4bq/biDEkeG7gyBsxrB1IHRy4bqhbmcgdGjDoWkgbOG7sWEgY2jhu41uIHbDoCBoaeG7h3Ug4bupbmcgaG92ZXJcbiAgMTAyNFx0ICAgICAgICBmaW5hbCBpbnRbXSBwZXJtYW5lbnRTZWxlY3RlZFJvdyA9IHstMX07IC8vIEzhu7FhIGNo4buNbiBjaMOtbmggdGjhu6ljXG4gIDEwMjVcdCAgICAgICAgZmluYWwgaW50W10gaG92ZXJSb3cgPSB7LTF9OyAvLyBEw7JuZyDEkWFuZyBob3ZlclxuICAxMDI2XHQgICAgICAgIGZpbmFsIGJvb2xlYW5bXSBpc1VzZXJTZWxlY3Rpb24gPSB7ZmFsc2V9OyAvLyBD4budIMSRw6FuaCBk4bqldSBuZ8aw4budaSBkw7luZyDEkcOjIGNo4buNbiBt4buZdCBkw7JuZ1xuICAxMDI3XHRcbiAgMTAyOFx0ICAgICAgICAvLyBUaMOqbSBoaeG7h3Ug4bupbmcgaG92ZXIgYuG6sW5nIGPDoWNoIHPhu60gZOG7pW5nIE1vdXNlTW90aW9uQWRhcHRlclxuICAxMDI5XHQgICAgICAgIHNjaGVkdWxlVGFibGUuYWRkTW91c2VNb3Rpb25MaXN0ZW5lcihuZXcgamF2YS5hd3QuZXZlbnQuTW91c2VNb3Rpb25BZGFwdGVyKCkge1xuICAxMDMwXHQgICAgICAgICAgICBAT3ZlcnJpZGVcbiAgMTAzMVx0ICAgICAgICAgICAgcHVibGljIHZvaWQgbW91c2VNb3ZlZChqYXZhLmF3dC5ldmVudC5Nb3VzZUV2ZW50IGUpIHtcbiAgMTAzMlx0ICAgICAgICAgICAgICAgIC8vIEzhuqV5IGTDsm5nIGhp4buHbiB04bqhaSDEkWFuZyBob3ZlclxuICAxMDMzXHQgICAgICAgICAgICAgICAgUG9pbnQgcG9pbnQgPSBlLmdldFBvaW50KCk7XG4gIDEwMzRcdCAgICAgICAgICAgICAgICBpbnQgY3VycmVudFJvdyA9IHNjaGVkdWxlVGFibGUucm93QXRQb2ludChwb2ludCk7XG4gIDEwMzVcdFxuICAxMDM2XHQgICAgICAgICAgICAgICAgLy8gTuG6v3UgZGkgY2h1eeG7g24gxJHhur9uIG3hu5l0IGTDsm5nIG3hu5tpXG4gIDEwMzdcdCAgICAgICAgICAgICAgICBpZiAoY3VycmVudFJvdyAhPSBob3ZlclJvd1swXSkge1xuICAxMDM4XHQgICAgICAgICAgICAgICAgICAgIC8vIEPhuq1wIG5o4bqtdCBkw7JuZyDEkWFuZyBob3ZlclxuICAxMDM5XHQgICAgICAgICAgICAgICAgICAgIGhvdmVyUm93WzBdID0gY3VycmVudFJvdztcbiAgMTA0MFx0XG4gIDEwNDFcdCAgICAgICAgICAgICAgICAgICAgLy8gS2nhu4NtIHRyYSB0w61uaCBo4bujcCBs4buHIGPhu6dhIGNo4buJIHPhu5EgaMOgbmdcbiAgMTA0Mlx0ICAgICAgICAgICAgICAgICAgICBib29sZWFuIGlzVmFsaWRSb3cgPSBjdXJyZW50Um93ID49IDAgJiYgY3VycmVudFJvdyA8IHNjaGVkdWxlVGFibGUuZ2V0Um93Q291bnQoKTtcbiAgMTA0M1x0ICAgICAgICAgICAgICAgICAgICBib29sZWFuIGlzUGVybWFuZW50U2VsZWN0aW9uVmFsaWQgPSBwZXJtYW5lbnRTZWxlY3RlZFJvd1swXSA+PSAwICYmIHBlcm1hbmVudFNlbGVjdGVkUm93WzBdIDwgc2NoZWR1bGVUYWJsZS5nZXRSb3dDb3VudCgpO1xuICAxMDQ0XHRcbiAgMTA0NVx0ICAgICAgICAgICAgICAgICAgICAvLyBO4bq/dSBuZ8aw4budaSBkw7luZyDEkcOjIGPDsyBs4buxYSBjaOG7jW4gY2jDrW5oIHRo4bupYywgY2jhu4kgaGnhu4NuIHRo4buLIGhp4buHdSDhu6luZyBob3ZlclxuICAxMDQ2XHQgICAgICAgICAgICAgICAgICAgIGlmIChpc1VzZXJTZWxlY3Rpb25bMF0gJiYgaXNQZXJtYW5lbnRTZWxlY3Rpb25WYWxpZCkge1xuICAxMDQ3XHQgICAgICAgICAgICAgICAgICAgICAgICAvLyBO4bqhcCBs4bqhaSBjaOG7jW4gY2jDrW5oIHRo4bupY1xuICAxMDQ4XHQgICAgICAgICAgICAgICAgICAgICAgICBzY2hlZHVsZVRhYmxlLnNldFNlbGVjdGlvbkJhY2tncm91bmQobmV3IENvbG9yKDY2LCAxMzksIDIwMikpO1xuICAxMDQ5XHQgICAgICAgICAgICAgICAgICAgICAgICBzY2hlZHVsZVRhYmxlLnNldFNlbGVjdGlvbkZvcmVncm91bmQoQ29sb3IuV0hJVEUpO1xuICAxMDUwXHQgICAgICAgICAgICAgICAgICAgICAgICBzY2hlZHVsZVRhYmxlLnNldFJvd1NlbGVjdGlvbkludGVydmFsKHBlcm1hbmVudFNlbGVjdGVkUm93WzBdLCBwZXJtYW5lbnRTZWxlY3RlZFJvd1swXSk7XG4gIDEwNTFcdFxuICAxMDUyXHQgICAgICAgICAgICAgICAgICAgICAgICAvLyBW4bq9IGhp4buHdSDhu6luZyBob3ZlciBjaG8gZMOybmcgaGnhu4duIHThuqFpXG4gIDEwNTNcdCAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVkdWxlVGFibGUucmVwYWludCgpO1xuICAxMDU0XHQgICAgICAgICAgICAgICAgICAgIH1cbiAgMTA1NVx0ICAgICAgICAgICAgICAgICAgICAvLyBO4bq/dSBraMO0bmcgY8OzIGzhu7FhIGNo4buNbiBjaMOtbmggdGjhu6ljIHbDoCBjw7MgaMOgbmcgaOG7o3AgbOG7hywgw6FwIGThu6VuZyBoaeG7h3Ug4bupbmcgaG92ZXJcbiAgMTA1Nlx0ICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChpc1ZhbGlkUm93KSB7XG4gIDEwNTdcdCAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVkdWxlVGFibGUuc2V0U2VsZWN0aW9uQmFja2dyb3VuZChuZXcgQ29sb3IoMTczLCAyMTYsIDIzMCkpOyAvLyBNw6B1IHhhbmggbmjhuqF0IGNobyBob3ZlclxuICAxMDU4XHQgICAgICAgICAgICAgICAgICAgICAgICBzY2hlZHVsZVRhYmxlLnNldFNlbGVjdGlvbkZvcmVncm91bmQoQ29sb3IuQkxBQ0spO1xuICAxMDU5XHQgICAgICAgICAgICAgICAgICAgICAgICBzY2hlZHVsZVRhYmxlLnNldFJvd1NlbGVjdGlvbkludGVydmFsKGN1cnJlbnRSb3csIGN1cnJlbnRSb3cpO1xuICAxMDYwXHQgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gIDEwNjFcdCAgICAgICAgICAgICAgICAgICAgICAgIC8vIEtow7RuZyBjw7MgaMOgbmcgaOG7o3AgbOG7hyDEkeG7gyBob3ZlciwgeMOzYSBs4buxYSBjaOG7jW5cbiAgMTA2Mlx0ICAgICAgICAgICAgICAgICAgICAgICAgc2NoZWR1bGVUYWJsZS5jbGVhclNlbGVjdGlvbigpO1xuICAxMDYzXHQgICAgICAgICAgICAgICAgICAgIH1cbiAgMTA2NFx0ICAgICAgICAgICAgICAgIH1cbiAgMTA2NVx0ICAgICAgICAgICAgfVxuICAxMDY2XHQgICAgICAgIH0pO1xuICAxMDY3XHRcbiAgMTA2OFx0ICAgICAgICAvLyBY4butIGzDvSBjw6FjIHPhu7Ega2nhu4duIGNodeG7mXQga2jDoWNcbiAgMTA2OVx0ICAgICAgICBzY2hlZHVsZVRhYmxlLmFkZE1vdXNlTGlzdGVuZXIobmV3IGphdmEuYXd0LmV2ZW50Lk1vdXNlQWRhcHRlcigpIHtcbiAgMTA3MFx0ICAgICAgICAgICAgQE92ZXJyaWRlXG4gIDEwNzFcdCAgICAgICAgICAgIHB1YmxpYyB2b2lkIG1vdXNlRXhpdGVkKGphdmEuYXd0LmV2ZW50Lk1vdXNlRXZlbnQgZSkge1xuICAxMDcyXHQgICAgICAgICAgICAgICAgaG92ZXJSb3dbMF0gPSAtMTsgLy8gWMOzYSB0cuG6oW5nIHRow6FpIGhvdmVyXG4gIDEwNzNcdFxuICAxMDc0XHQgICAgICAgICAgICAgICAgLy8gS2nhu4NtIHRyYSB0w61uaCBo4bujcCBs4buHIGPhu6dhIGzhu7FhIGNo4buNbiBjaMOtbmggdGjhu6ljXG4gIDEwNzVcdCAgICAgICAgICAgICAgICBib29sZWFuIGlzUGVybWFuZW50U2VsZWN0aW9uVmFsaWQgPSBwZXJtYW5lbnRTZWxlY3RlZFJvd1swXSA+PSAwICYmXG4gIDEwNzZcdCAgICAgICAgICAgICAgICAgICAgICAgIHBlcm1hbmVudFNlbGVjdGVkUm93WzBdIDwgc2NoZWR1bGVUYWJsZS5nZXRSb3dDb3VudCgpO1xuICAxMDc3XHRcbiAgMTA3OFx0ICAgICAgICAgICAgICAgIC8vIE7hur91IGPDsyBs4buxYSBjaOG7jW4gY2jDrW5oIHRo4bupYyB2w6AgaOG7o3AgbOG7hywgZ2nhu68gbmd1ecOqbiBs4buxYSBjaOG7jW4gxJHDs1xuICAxMDc5XHQgICAgICAgICAgICAgICAgaWYgKGlzVXNlclNlbGVjdGlvblswXSAmJiBpc1Blcm1hbmVudFNlbGVjdGlvblZhbGlkKSB7XG4gIDEwODBcdCAgICAgICAgICAgICAgICAgICAgc2NoZWR1bGVUYWJsZS5zZXRTZWxlY3Rpb25CYWNrZ3JvdW5kKG5ldyBDb2xvcig2NiwgMTM5LCAyMDIpKTtcbiAgMTA4MVx0ICAgICAgICAgICAgICAgICAgICBzY2hlZHVsZVRhYmxlLnNldFNlbGVjdGlvbkZvcmVncm91bmQoQ29sb3IuV0hJVEUpO1xuICAxMDgyXHQgICAgICAgICAgICAgICAgICAgIHNjaGVkdWxlVGFibGUuc2V0Um93U2VsZWN0aW9uSW50ZXJ2YWwocGVybWFuZW50U2VsZWN0ZWRSb3dbMF0sIHBlcm1hbmVudFNlbGVjdGVkUm93WzBdKTtcbiAgMTA4M1x0ICAgICAgICAgICAgICAgIH1cbiAgMTA4NFx0ICAgICAgICAgICAgICAgIC8vIE7hur91IGNo4buJIGzDoCBob3ZlciwgeMOzYSBs4buxYSBjaOG7jW4ga2hpIHLhu51pIGto4buPaSBi4bqjbmdcbiAgMTA4NVx0ICAgICAgICAgICAgICAgIGVsc2Uge1xuICAxMDg2XHQgICAgICAgICAgICAgICAgICAgIHNjaGVkdWxlVGFibGUuY2xlYXJTZWxlY3Rpb24oKTtcbiAgMTA4N1x0ICAgICAgICAgICAgICAgIH1cbiAgMTA4OFx0ICAgICAgICAgICAgfVxuICAxMDg5XHRcbiAgMTA5MFx0ICAgICAgICAgICAgQE92ZXJyaWRlXG4gIDEwOTFcdCAgICAgICAgICAgIHB1YmxpYyB2b2lkIG1vdXNlQ2xpY2tlZChqYXZhLmF3dC5ldmVudC5Nb3VzZUV2ZW50IGUpIHtcbiAgMTA5Mlx0ICAgICAgICAgICAgICAgIGludCByb3cgPSBzY2hlZHVsZVRhYmxlLmdldFNlbGVjdGVkUm93KCk7XG4gIDEwOTNcdCAgICAgICAgICAgICAgICBpZiAocm93ID49IDAgJiYgcm93IDwgc2NoZWR1bGVUYWJsZS5nZXRSb3dDb3VudCgpKSB7XG4gIDEwOTRcdCAgICAgICAgICAgICAgICAgICAgLy8gTMawdSBs4buxYSBjaOG7jW4gY2jDrW5oIHRo4bupY1xuICAxMDk1XHQgICAgICAgICAgICAgICAgICAgIHBlcm1hbmVudFNlbGVjdGVkUm93WzBdID0gcm93O1xuICAxMDk2XHQgICAgICAgICAgICAgICAgICAgIGlzVXNlclNlbGVjdGlvblswXSA9IHRydWU7XG4gIDEwOTdcdFxuICAxMDk4XHQgICAgICAgICAgICAgICAgICAgIC8vIMSQ4bq3dCBtw6B1IGNo4buNbiB0aMOgbmggbcOgdSB4YW5oIMSR4bqtbVxuICAxMDk5XHQgICAgICAgICAgICAgICAgICAgIHNjaGVkdWxlVGFibGUuc2V0U2VsZWN0aW9uQmFja2dyb3VuZChuZXcgQ29sb3IoNjYsIDEzOSwgMjAyKSk7XG4gIDExMDBcdCAgICAgICAgICAgICAgICAgICAgc2NoZWR1bGVUYWJsZS5zZXRTZWxlY3Rpb25Gb3JlZ3JvdW5kKENvbG9yLldISVRFKTtcbiAgMTEwMVx0ICAgICAgICAgICAgICAgIH1cbiAgMTEwMlx0ICAgICAgICAgICAgfVxuICAxMTAzXHQgICAgICAgIH0pO1xuICAxMTA0XHRcbiAgMTEwNVx0ICAgICAgICAvLyBUaGVvIGTDtWkgY8OhYyB0aGF5IMSR4buVaSB0cm9uZyBs4buxYSBjaOG7jW5cbiAgMTEwNlx0ICAgICAgICBzY2hlZHVsZVRhYmxlLmdldFNlbGVjdGlvbk1vZGVsKCkuYWRkTGlzdFNlbGVjdGlvbkxpc3RlbmVyKGUgLT4ge1xuICAxMTA3XHQgICAgICAgICAgICBpZiAoIWUuZ2V0VmFsdWVJc0FkanVzdGluZygpKSB7XG4gIDExMDhcdCAgICAgICAgICAgICAgICBpbnQgc2VsZWN0ZWRSb3cgPSBzY2hlZHVsZVRhYmxlLmdldFNlbGVjdGVkUm93KCk7XG4gIDExMDlcdFxuICAxMTEwXHQgICAgICAgICAgICAgICAgLy8gS2nhu4NtIHRyYSB0w61uaCBo4bujcCBs4buHIGPhu6dhIGzhu7FhIGNo4buNbiBjaMOtbmggdGjhu6ljXG4gIDExMTFcdCAgICAgICAgICAgICAgICBib29sZWFuIGlzUGVybWFuZW50U2VsZWN0aW9uVmFsaWQgPSBwZXJtYW5lbnRTZWxlY3RlZFJvd1swXSA+PSAwICYmXG4gIDExMTJcdCAgICAgICAgICAgICAgICAgICAgICAgIHBlcm1hbmVudFNlbGVjdGVkUm93WzBdIDwgc2NoZWR1bGVUYWJsZS5nZXRSb3dDb3VudCgpO1xuICAxMTEzXHRcbiAgMTExNFx0ICAgICAgICAgICAgICAgIC8vIE7hur91IG5nxrDhu51pIGTDuW5nIMSRw6MgY2jhu41uIG3hu5l0IGTDsm5nIG5oxrBuZyBiw6J5IGdp4budIGtow7RuZyBjw7MgZMOybmcgbsOgbyDEkcaw4bujYyBjaOG7jW4sXG4gIDExMTVcdCAgICAgICAgICAgICAgICAvLyB2w6AgY2jhu41uIGN14buRaSBjw7luZyB24bqrbiBo4bujcCBs4buHLCB0aMOsIGtow7RpIHBo4bulYyBs4buxYSBjaOG7jW4gxJHDs1xuICAxMTE2XHQgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkUm93ID09IC0xICYmIGlzVXNlclNlbGVjdGlvblswXSAmJiBpc1Blcm1hbmVudFNlbGVjdGlvblZhbGlkKSB7XG4gIDExMTdcdCAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgMTExOFx0ICAgICAgICAgICAgICAgICAgICAgICAgc2NoZWR1bGVUYWJsZS5zZXRSb3dTZWxlY3Rpb25JbnRlcnZhbChwZXJtYW5lbnRTZWxlY3RlZFJvd1swXSwgcGVybWFuZW50U2VsZWN0ZWRSb3dbMF0pO1xuICAxMTE5XHQgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBleCkge1xuICAxMTIwXHQgICAgICAgICAgICAgICAgICAgICAgICAvLyBY4butIGzDvSB0csaw4budbmcgaOG7o3AgY2jhu4kgc+G7kSBow6BuZyBraMO0bmcgaOG7o3AgbOG7h1xuICAxMTIxXHQgICAgICAgICAgICAgICAgICAgICAgICBMT0dHRVIud2FybmluZyhcIktow7RuZyB0aOG7gyBraMO0aSBwaOG7pWMgbOG7sWEgY2jhu41uIGjDoG5nOiBcIiArIGV4LmdldE1lc3NhZ2UoKSk7XG4gIDExMjJcdCAgICAgICAgICAgICAgICAgICAgICAgIC8vIMSQ4bq3dCBs4bqhaSBjw6FjIGJp4bq/biB0cuG6oW5nIHRow6FpXG4gIDExMjNcdCAgICAgICAgICAgICAgICAgICAgICAgIGlzVXNlclNlbGVjdGlvblswXSA9IGZhbHNlO1xuICAxMTI0XHQgICAgICAgICAgICAgICAgICAgICAgICBwZXJtYW5lbnRTZWxlY3RlZFJvd1swXSA9IC0xO1xuICAxMTI1XHQgICAgICAgICAgICAgICAgICAgIH1cbiAgMTEyNlx0ICAgICAgICAgICAgICAgIH1cbiAgMTEyN1x0ICAgICAgICAgICAgfVxuICAxMTI4XHQgICAgICAgIH0pO1xuICAxMTI5XHRcbiAgMTEzMFx0ICAgICAgICAvLyBT4butIGThu6VuZyBjdXN0b20gcmVuZGVyZXIgxJHhu4MgaGnhu4NuIHRo4buLIG3DoHUgaG92ZXJcbiAgMTEzMVx0ICAgICAgICBzY2hlZHVsZVRhYmxlLnNldERlZmF1bHRSZW5kZXJlcihPYmplY3QuY2xhc3MsIG5ldyBEZWZhdWx0VGFibGVDZWxsUmVuZGVyZXIoKSB7XG4gIDExMzJcdCAgICAgICAgICAgIEBPdmVycmlkZVxuICAxMTMzXHQgICAgICAgICAgICBwdWJsaWMgQ29tcG9uZW50IGdldFRhYmxlQ2VsbFJlbmRlcmVyQ29tcG9uZW50KEpUYWJsZSB0YWJsZSwgT2JqZWN0IHZhbHVlLFxuICAxMTM0XHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2xlYW4gaXNTZWxlY3RlZCwgYm9vbGVhbiBoYXNGb2N1cyxcbiAgMTEzNVx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgcm93LCBpbnQgY29sdW1uKSB7XG4gIDExMzZcdCAgICAgICAgICAgICAgICBDb21wb25lbnQgY29tcCA9IHN1cGVyLmdldFRhYmxlQ2VsbFJlbmRlcmVyQ29tcG9uZW50KFxuICAxMTM3XHQgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZSwgdmFsdWUsIGlzU2VsZWN0ZWQsIGhhc0ZvY3VzLCByb3csIGNvbHVtbik7XG4gIDExMzhcdFxuICAxMTM5XHQgICAgICAgICAgICAgICAgLy8gTuG6v3UgZMOybmcgbsOgeSBsw6AgbOG7sWEgY2jhu41uIGNow61uaCB0aOG7qWNcbiAgMTE0MFx0ICAgICAgICAgICAgICAgIGlmIChpc1NlbGVjdGVkICYmIHJvdyA9PSBwZXJtYW5lbnRTZWxlY3RlZFJvd1swXSAmJiBpc1VzZXJTZWxlY3Rpb25bMF0pIHtcbiAgMTE0MVx0ICAgICAgICAgICAgICAgICAgICBjb21wLnNldEJhY2tncm91bmQobmV3IENvbG9yKDY2LCAxMzksIDIwMikpOyAvLyBNw6B1IHhhbmggxJHhuq1tIGNobyBs4buxYSBjaOG7jW5cbiAgMTE0Mlx0ICAgICAgICAgICAgICAgICAgICBjb21wLnNldEZvcmVncm91bmQoQ29sb3IuV0hJVEUpO1xuICAxMTQzXHQgICAgICAgICAgICAgICAgfVxuICAxMTQ0XHQgICAgICAgICAgICAgICAgLy8gTuG6v3UgZMOybmcgbsOgeSDEkWFuZyDEkcaw4bujYyBob3ZlclxuICAxMTQ1XHQgICAgICAgICAgICAgICAgZWxzZSBpZiAoaXNTZWxlY3RlZCAmJiByb3cgPT0gaG92ZXJSb3dbMF0pIHtcbiAgMTE0Nlx0ICAgICAgICAgICAgICAgICAgICBjb21wLnNldEJhY2tncm91bmQobmV3IENvbG9yKDE3MywgMjE2LCAyMzApKTsgLy8gTcOgdSB4YW5oIG5o4bqhdCBjaG8gaG92ZXJcbiAgMTE0N1x0ICAgICAgICAgICAgICAgICAgICBjb21wLnNldEZvcmVncm91bmQoQ29sb3IuQkxBQ0spO1xuICAxMTQ4XHQgICAgICAgICAgICAgICAgfVxuICAxMTQ5XHQgICAgICAgICAgICAgICAgLy8gTcOgdSBz4bqvYyB0aMO0bmcgdGjGsOG7nW5nIGNobyBjw6FjIGTDsm5nIGzhursgY2jhurVuXG4gIDExNTBcdCAgICAgICAgICAgICAgICBlbHNlIHtcbiAgMTE1MVx0ICAgICAgICAgICAgICAgICAgICBpZiAocm93ICUgMiA9PSAwKSB7XG4gIDExNTJcdCAgICAgICAgICAgICAgICAgICAgICAgIGNvbXAuc2V0QmFja2dyb3VuZChDb2xvci5XSElURSk7XG4gIDExNTNcdCAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgMTE1NFx0ICAgICAgICAgICAgICAgICAgICAgICAgY29tcC5zZXRCYWNrZ3JvdW5kKG5ldyBDb2xvcigyNDUsIDI0NSwgMjQ1KSk7IC8vIE3DoHUgeMOhbSBuaOG6oXRcbiAgMTE1NVx0ICAgICAgICAgICAgICAgICAgICB9XG4gIDExNTZcdCAgICAgICAgICAgICAgICAgICAgY29tcC5zZXRGb3JlZ3JvdW5kKENvbG9yLkJMQUNLKTtcbiAgMTE1N1x0ICAgICAgICAgICAgICAgIH1cbiAgMTE1OFx0XG4gIDExNTlcdCAgICAgICAgICAgICAgICAvLyBDYW5oIGzhu4EgdsOgIGZvbnRcbiAgMTE2MFx0ICAgICAgICAgICAgICAgICgoSkxhYmVsKSBjb21wKS5zZXRIb3Jpem9udGFsQWxpZ25tZW50KFN3aW5nQ29uc3RhbnRzLkNFTlRFUik7XG4gIDExNjFcdCAgICAgICAgICAgICAgICBjb21wLnNldEZvbnQobmV3IEZvbnQoXCJBcmlhbFwiLCBGb250LlBMQUlOLCAxMikpO1xuICAxMTYyXHRcbiAgMTE2M1x0ICAgICAgICAgICAgICAgIHJldHVybiBjb21wO1xuICAxMTY0XHQgICAgICAgICAgICB9XG4gIDExNjVcdCAgICAgICAgfSk7XG4gIDExNjZcdFxuICAxMTY3XHQgICAgICAgIC8vIFRoaeG6v3QgbOG6rXAgVUkgY2hvIGhlYWRlciAoZ2nhu68gbmd1ecOqbilcbiAgMTE2OFx0ICAgICAgICBzY2hlZHVsZVRhYmxlLmdldFRhYmxlSGVhZGVyKCkuc2V0RGVmYXVsdFJlbmRlcmVyKG5ldyBEZWZhdWx0VGFibGVDZWxsUmVuZGVyZXIoKSB7XG4gIDExNjlcdCAgICAgICAgICAgIEBPdmVycmlkZVxuICAxMTcwXHQgICAgICAgICAgICBwdWJsaWMgQ29tcG9uZW50IGdldFRhYmxlQ2VsbFJlbmRlcmVyQ29tcG9uZW50KEpUYWJsZSB0YWJsZSwgT2JqZWN0IHZhbHVlLFxuICAxMTcxXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2xlYW4gaTxyZXNwb25zZSBjbGlwcGVkPjxOT1RFPlRvIHNhdmUgb24gY29udGV4dCBvbmx5IHBhcnQgb2YgdGhpcyBmaWxlIGhhcyBiZWVuIHNob3duIHRvIHlvdS48L05PVEU+XG5Ub3RhbCBsaW5lcyBpbiBmaWxlOiAzNzg0XG4iLCJpc19lcnJvciI6ZmFsc2UsInJlcXVlc3RfaWQiOiIiLCJ0b29sX3VzZV9pZCI6InRvb2x1XzAxTHlxS0VvWGthcXBOUU5uc1d3eGs4NyJ9fSx7ImlkIjoyLCJ0eXBlIjo0LCJpZGVfc3RhdGVfbm9kZSI6eyJ3b3Jrc3BhY2VGb2xkZXJzIjpbeyJyZXBvc2l0b3J5Um9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIiwiZm9sZGVyUm9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIn1dLCJ3b3Jrc3BhY2VGb2xkZXJzVW5jaGFuZ2VkIjpmYWxzZX19XSwicmVzcG9uc2VfdGV4dCI6IkxldCBtZSBleGFtaW5lIHRoZSBtb2RlbCBjbGFzc2VzIHRvIHVuZGVyc3RhbmQgdGhlIGRhdGEgc3RydWN0dXJlOlxuIiwid29ya3NwYWNlX2ZpbGVfY2h1bmtzIjpbXX0seyJzdGF0dXMiOiJzdWNjZXNzIiwicmVxdWVzdF9pZCI6ImZmMDQ3ZmYxLTE3OWEtNDQzNi05OTFiLTAyNmQxZmMyZmMxMiIsInJlcXVlc3RfbWVzc2FnZSI6IiIsInN0cnVjdHVyZWRfb3V0cHV0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6NSwiY29udGVudCI6IiIsInRvb2xfdXNlIjp7InRvb2xfdXNlX2lkIjoidG9vbHVfMDFHU21yVFNFU1lpalozU2VVUnVpZzY4IiwidG9vbF9uYW1lIjoiY29kZWJhc2UtcmV0cmlldmFsIiwiaW5wdXRfanNvbiI6IntcImluZm9ybWF0aW9uX3JlcXVlc3RcIjogXCJGaW5kIHRoZSBEb2lUdW9uZ0FwRHVuZyBlbnVtIGFuZCBhbnkgb3RoZXIgbW9kZWxzIG9yIERBT3MgcmVsYXRlZCB0byBLaHV5ZW5NYWkgKHByb21vdGlvbnMpXCJ9In19LHsiaWQiOjAsInR5cGUiOjAsImNvbnRlbnQiOiJMZXQgbWUgY2hlY2sgZm9yIHRoZSBEb2lUdW9uZ0FwRHVuZyBlbnVtIGFuZCBhbnkgb3RoZXIgcmVsZXZhbnQgbW9kZWxzOlxuIn0seyJpZCI6MiwidHlwZSI6MiwiY29udGVudCI6IiJ9LHsiaWQiOjMsInR5cGUiOjMsImNvbnRlbnQiOiIifV0sInNlZW5fc3RhdGUiOiJzZWVuIiwic3RydWN0dXJlZF9yZXF1ZXN0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6MSwidG9vbF9yZXN1bHRfbm9kZSI6eyJjb250ZW50IjoiVGhlIGZvbGxvd2luZyBjb2RlIHNlY3Rpb25zIHdlcmUgcmV0cmlldmVkOlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vcmVzb3VyY2VzL01FVEEtSU5GL3BlcnNpc3RlbmNlLnhtbFxuPD94bWwgdmVyc2lvbj1cIjEuMFwiIGVuY29kaW5nPVwiVVRGLThcIiBzdGFuZGFsb25lPVwieWVzXCI/PlxuPHBlcnNpc3RlbmNlIHhtbG5zPVwiaHR0cHM6Ly9qYWthcnRhLmVlL3htbC9ucy9wZXJzaXN0ZW5jZVwiXG4gICAgICAgICAgICAgeG1sbnM6eHNpPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEtaW5zdGFuY2VcIlxuICAgICAgICAgICAgIHhzaTpzY2hlbWFMb2NhdGlvbj1cImh0dHBzOi8vamFrYXJ0YS5lZS94bWwvbnMvcGVyc2lzdGVuY2UgaHR0cHM6Ly9qYWthcnRhLmVlL3htbC9ucy9wZXJzaXN0ZW5jZS9wZXJzaXN0ZW5jZV8zXzAueHNkXCJcbiAgICAgICAgICAgICB2ZXJzaW9uPVwiMy4wXCI+XG4gICAgPHBlcnNpc3RlbmNlLXVuaXQgbmFtZT1cIm1hcmlhZGJcIj5cbiAgICAgICAgPGNsYXNzPm1vZGVsLlRvYVRhdTwvY2xhc3M+XG4gICAgICAgIDxjbGFzcz5tb2RlbC5Mb2FpVG9hPC9jbGFzcz5cbiAgICAgICAgPGNsYXNzPm1vZGVsLlR1eWVuVGF1PC9jbGFzcz5cbiAgICAgICAgPGNsYXNzPm1vZGVsLlRhdTwvY2xhc3M+XG4gICAgICAgIDxjbGFzcz5tb2RlbC5OaGFuVmllbjwvY2xhc3M+XG4gICAgICAgIDxjbGFzcz5tb2RlbC5UYWlLaG9hbjwvY2xhc3M+XG4gICAgICAgIDxjbGFzcz5tb2RlbC5MaWNoTGFtVmllYzwvY2xhc3M+XG4gICAgICAgIDxjbGFzcz5tb2RlbC5WZVRhdTwvY2xhc3M+XG4gICAgICAgIDxjbGFzcz5tb2RlbC5LaGFjaEhhbmc8L2NsYXNzPlxuICAgICAgICA8Y2xhc3M+bW9kZWwuSG9hRG9uPC9jbGFzcz5cbiAgICAgICAgPGNsYXNzPm1vZGVsLktodXllbk1haTwvY2xhc3M+XG4gICAgICAgIDxjbGFzcz5tb2RlbC5Mb2FpQ2hvPC9jbGFzcz5cbiAgICAgICAgPGNsYXNzPm1vZGVsLkNob05nb2k8L2NsYXNzPlxuICAgICAgICA8Y2xhc3M+bW9kZWwuTG9haUhvYURvbjwvY2xhc3M+XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGFvL2ltcGwvTGljaFRyaW5oVGF1REFPSW1wbC5qYXZhXG5wYWNrYWdlIGRhby5pbXBsO1xuXG5pbXBvcnQgZGFvLkxpY2hUcmluaFRhdURBTztcbmltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXI7XG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS5FbnRpdHlUcmFuc2FjdGlvbjtcbmltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLlF1ZXJ5O1xuaW1wb3J0IG1vZGVsLkxpY2hUcmluaFRhdTtcbmltcG9ydCBtb2RlbC5UcmFuZ1RoYWk7XG5pbXBvcnQgbW9kZWwuVHJhbmdUaGFpVmVUYXU7XG5pbXBvcnQgdXRpbC5KUEFVdGlsO1xuXG5pbXBvcnQgamF2YS5ybWkuUmVtb3RlRXhjZXB0aW9uO1xuaW1wb3J0IGphdmEucm1pLnNlcnZlci5VbmljYXN0UmVtb3RlT2JqZWN0O1xuaW1wb3J0IGphdmEudGltZS5Mb2NhbERhdGU7XG5pbXBvcnQgamF2YS50aW1lLkxvY2FsVGltZTtcbmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0O1xuaW1wb3J0IGphdmEudXRpbC5MaXN0O1xuaW1wb3J0IGphdmEudXRpbC5NYXA7XG5cbnB1YmxpYyBjbGFzcyBMaWNoVHJpbmhUYXVEQU9JbXBsIGV4dGVuZHMgVW5pY2FzdFJlbW90ZU9iamVjdCBpbXBsZW1lbnRzIExpY2hUcmluaFRhdURBTyB7XG5cbiAgICBwdWJsaWMgTGljaFRyaW5oVGF1REFPSW1wbCgpIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xuICAgICAgICAvLyBLaMO0bmcga2jhu59pIHThuqFvIEVudGl0eU1hbmFnZXIgdHJvbmcgY29uc3RydWN0b3JcbiAgICB9XG4uLi5cblxuICAgIEBPdmVycmlkZVxuICAgIHB1YmxpYyBMaXN0PFRyYW5nVGhhaT4gZ2V0VHJhbmdUaGFpKCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcbiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHggPSBlbS5nZXRUcmFuc2FjdGlvbigpO1xuICAgICAgICBMaXN0PFRyYW5nVGhhaT4gdHJhbmdUaGFpTGlzdCA9IG5ldyBBcnJheUxpc3Q8PigpO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0eC5iZWdpbigpO1xuXG4gICAgICAgICAgICAvLyBT4butIGThu6VuZyBuYXRpdmUgcXVlcnkgxJHhu4MgbOG6pXkgY8OhYyBnacOhIHRy4buLIGNodeG7l2kgdOG7qyBEQlxuICAgICAgICAgICAgUXVlcnkgcXVlcnkgPSBlbS5jcmVhdGVOYXRpdmVRdWVyeShcIlNFTEVDVCBESVNUSU5DVCB0cmFuZ190aGFpIEZST00gbGljaHRyaW5odGF1IE9SREVSIEJZIHRyYW5nX3RoYWlcIik7XG4gICAgICAgICAgICBMaXN0PFN0cmluZz4gcmVzdWx0ID0gcXVlcnkuZ2V0UmVzdWx0TGlzdCgpO1xuXG4gICAgICAgICAgICAvLyBUaMOqbSBjw6FjIGdpw6EgdHLhu4sgbeG6t2MgxJHhu4tuaFxuICAgICAgICAgICAgdHJhbmdUaGFpTGlzdC5hZGQoVHJhbmdUaGFpLkRBX0tIT0lfSEFOSCk7XG4gICAgICAgICAgICB0cmFuZ1RoYWlMaXN0LmFkZChUcmFuZ1RoYWkuQ0hVQV9LSE9JX0hBTkgpO1xuICAgICAgICAgICAgdHJhbmdUaGFpTGlzdC5hZGQoVHJhbmdUaGFpLkRBX0hVWSk7XG4gICAgICAgICAgICB0cmFuZ1RoYWlMaXN0LmFkZChUcmFuZ1RoYWkuSE9BVF9ET05HKTsgLy8gVGjDqm0gZ2nDoSB0cuG7iyBuw6B5XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZ3VpQ2xpZW50L0xpY2hUcmluaFNlbGVjdG9yRGlhbG9nLmphdmFcbnBhY2thZ2UgZ3VpQ2xpZW50O1xuXG5pbXBvcnQgZGFvLkNob05nb2lDYWxsYmFjaztcbmltcG9ydCBkYW8uQ2hvTmdvaURvaVZlREFPO1xuaW1wb3J0IGRhby5MaWNoVHJpbmhUYXVEQU87XG5pbXBvcnQgZGFvLlRvYVRhdURvaVZlREFPO1xuaW1wb3J0IG1vZGVsLkNob05nb2k7XG5pbXBvcnQgbW9kZWwuS2h1eWVuTWFpO1xuaW1wb3J0IG1vZGVsLkxpY2hUcmluaFRhdTtcbmltcG9ydCBtb2RlbC5Ub2FUYXU7XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZ3VpQ2xpZW50L1RyYVZlUGFuZWwuamF2YVxucGFja2FnZSBndWlDbGllbnQ7XG5cbi8qKlxuICogQEThu7Egw6FuOiBQaGFuVGFuSmF2YU5ob21HUFRcbiAqIEBDbGFzczogVHJhVmVQYW5lbFxuICogQFThuqFvIHbDoG8gbmfDoHk6IDE5LzA0LzIwMjVcbiAqIEBUw6FjIGdp4bqjOiBOZ3V5ZW4gSHV1IFNhbmdcbiAqL1xuXG5pbXBvcnQgZGFvLkNoaVRpZXRIb2FEb25EQU87XG5pbXBvcnQgZGFvLkhvYURvbkRBTztcbmltcG9ydCBkYW8uTGljaFRyaW5oVGF1REFPO1xuaW1wb3J0IGRhby5WZVRhdURBTztcbmltcG9ydCBkYW8uaW1wbC5MaWNoTGFtVmllY0RBT0ltcGw7XG5pbXBvcnQgZGFvLmltcGwuTGljaFRyaW5oVGF1REFPSW1wbDtcbmltcG9ydCBtb2RlbC4qO1xuLy9pbXBvcnQgdXRpbHMuUHJpbnRQREY7XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZ3VpQ2xpZW50L0xpY2hUcmluaFRhdVBhbmVsLmphdmFcbnBhY2thZ2UgZ3VpQ2xpZW50O1xuXG5pbXBvcnQgY29tLnRvZWR0ZXIuY2FsZW5kYXIuSkRhdGVDaG9vc2VyO1xuaW1wb3J0IGRhby5MaWNoVHJpbmhUYXVEQU87XG5pbXBvcnQgZGFvLlRhdURBTztcbmltcG9ydCBtb2RlbC5MaWNoVHJpbmhUYXU7XG5pbXBvcnQgbW9kZWwuVGF1O1xuaW1wb3J0IG1vZGVsLlRyYW5nVGhhaTtcbmltcG9ydCBzZXJ2aWNlLkFJVHJhdmVsVGltZVByZWRpY3RvcjtcbmltcG9ydCBzZXJ2aWNlLlNjaGVkdWxlU3RhdHVzTWFuYWdlcjtcbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9kYW8vaW1wbC9Mb2FpQ2hvREFPSW1wbC5qYXZhXG5wYWNrYWdlIGRhby5pbXBsO1xuXG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS5FbnRpdHlNYW5hZ2VyO1xuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuRW50aXR5VHJhbnNhY3Rpb247XG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS5UeXBlZFF1ZXJ5O1xuaW1wb3J0IG1vZGVsLkxpY2hUcmluaFRhdTtcbmltcG9ydCBtb2RlbC5Mb2FpQ2hvO1xuaW1wb3J0IG1vZGVsLlRyYW5nVGhhaVZlVGF1O1xuaW1wb3J0IHV0aWwuSlBBVXRpbDtcblxuaW1wb3J0IGphdmEudXRpbC5MaXN0O1xuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL3Rlc3RDUlVEL1Rlc3RfSFYuamF2YVxucGFja2FnZSB0ZXN0Q1JVRDtcblxuaW1wb3J0IGRhby5MaWNoVHJpbmhUYXVEQU87XG5pbXBvcnQgZGFvLlRhdURBTztcbmltcG9ydCBkYW8uaW1wbC5MaWNoVHJpbmhUYXVEQU9JbXBsO1xuaW1wb3J0IGRhby5pbXBsLlRhdURBT0ltcGw7XG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS5FbnRpdHlNYW5hZ2VyO1xuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuUGVyc2lzdGVuY2U7XG5pbXBvcnQgbW9kZWwuTGljaFRyaW5oVGF1O1xuaW1wb3J0IG1vZGVsLlRhdTtcbmltcG9ydCBuZXQuZGF0YWZha2VyLkZha2VyO1xuXG5pbXBvcnQgamF2YS5ybWkuUmVtb3RlRXhjZXB0aW9uO1xuaW1wb3J0IGphdmEudGltZS5Mb2NhbERhdGU7XG5pbXBvcnQgamF2YS51dGlsLkxpc3Q7XG5cbnB1YmxpYyBjbGFzcyBUZXN0X0hWIHtcbiAgICBwdWJsaWMgc3RhdGljIHZvaWQgbWFpbihTdHJpbmdbXSBhcmdzKSB0aHJvd3MgRXhjZXB0aW9uIHtcbiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IFBlcnNpc3RlbmNlLmNyZWF0ZUVudGl0eU1hbmFnZXJGYWN0b3J5KFwibWFyaWFkYlwiKS5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7XG4gICAgICAgIFRhdURBTyB0YXVEQU8gPSBuZXcgVGF1REFPSW1wbCgpO1xuICAgICAgICBMaXN0PFRhdT4gdGF1cyA9IHRhdURBTy5nZXRBbGxMaXN0VCgpO1xuICAgICAgICB0YXVzLmZvckVhY2goU3lzdGVtLm91dDo6cHJpbnRsbik7XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZ3VpQ2xpZW50L0ZybURhbmdOaGFwLmphdmFcbnBhY2thZ2UgZ3VpQ2xpZW50O1xuXG5pbXBvcnQgZGFvLkxpY2hMYW1WaWVjREFPO1xuaW1wb3J0IGRhby5OaGFuVmllbkRBTztcbmltcG9ydCBkYW8uVGFpS2hvYW5EQU87XG5pbXBvcnQgZGFvLmltcGwuTGljaExhbVZpZWNEQU9JbXBsO1xuaW1wb3J0IGRhby5pbXBsLk5oYW5WaWVuREFPSW1wbDtcbmltcG9ydCBkYW8uaW1wbC5UYWlLaG9hbkRBT0ltcGw7XG4vL2ltcG9ydCBtb2RlbC5FbWFpbFNlbmRlcjtcbmltcG9ydCBtb2RlbC5MaWNoTGFtVmllYztcbmltcG9ydCBtb2RlbC5OaGFuVmllbjtcblxuaW1wb3J0IGphdmF4LnN3aW5nLio7XG5pbXBvcnQgamF2YS5hd3QuKjtcbmltcG9ydCBqYXZhLmF3dC5ldmVudC5BY3Rpb25FdmVudDtcbmltcG9ydCBqYXZhLmF3dC5ldmVudC5BY3Rpb25MaXN0ZW5lcjtcbmltcG9ydCBqYXZhLmF3dC5pbWFnZS5CdWZmZXJlZEltYWdlO1xuaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247XG5pbXBvcnQgamF2YS5ybWkuTm90Qm91bmRFeGNlcHRpb247XG5pbXBvcnQgamF2YS5ybWkuUmVtb3RlRXhjZXB0aW9uO1xuaW1wb3J0IGphdmEucm1pLnJlZ2lzdHJ5LkxvY2F0ZVJlZ2lzdHJ5O1xuaW1wb3J0IGphdmEucm1pLnJlZ2lzdHJ5LlJlZ2lzdHJ5O1xuaW1wb3J0IGphdmEudGltZS5Mb2NhbERhdGU7XG5pbXBvcnQgamF2YS50aW1lLkxvY2FsRGF0ZVRpbWU7XG5pbXBvcnQgamF2YS51dGlsLkxpc3Q7XG5pbXBvcnQgamF2YXguaW1hZ2Vpby5JbWFnZUlPO1xuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2Rhby9pbXBsL1RhdURBT0ltcGwuamF2YVxucGFja2FnZSBkYW8uaW1wbDtcblxuaW1wb3J0IGRhby5UYXVEQU87XG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS5FbnRpdHlNYW5hZ2VyO1xuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuRW50aXR5VHJhbnNhY3Rpb247XG5pbXBvcnQgbG9tYm9rLkFsbEFyZ3NDb25zdHJ1Y3RvcjtcbmltcG9ydCBtb2RlbC5UYXU7XG5pbXBvcnQgbW9kZWwuTGljaFRyaW5oVGF1O1xuaW1wb3J0IHV0aWwuSlBBVXRpbDtcblxuaW1wb3J0IGphdmEucm1pLlJlbW90ZUV4Y2VwdGlvbjtcbmltcG9ydCBqYXZhLnJtaS5zZXJ2ZXIuVW5pY2FzdFJlbW90ZU9iamVjdDtcbmltcG9ydCBqYXZhLnV0aWwuTGlzdDtcblxucHVibGljIGNsYXNzIFRhdURBT0ltcGwgZXh0ZW5kcyBVbmljYXN0UmVtb3RlT2JqZWN0IGltcGxlbWVudHMgVGF1REFPIHtcbi8vICAgIHByaXZhdGUgRW50aXR5TWFuYWdlciBlbTtcbiAgICBwdWJsaWMgVGF1REFPSW1wbCgpIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xuLy8gICAgICAgIHRoaXMuZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTs7XG4gICAgfVxuICAgIHB1YmxpYyBMaXN0PFRhdT4gZ2V0QWxsTGlzdFQoKSB7XG4gICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcbiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHggPSBlbS5nZXRUcmFuc2FjdGlvbigpO1xuICAgICAgICBMaXN0PFRhdT4gbGlzdCA9IG51bGw7XG4gICAgICAgIHR4LmJlZ2luKCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBT4butIGThu6VuZyBKT0lOIEZFVENIIMSR4buDIGzhuqV5IFR1eWVuVGF1IGPDuW5nIHbhu5tpIFRhdVxuICAgICAgICAgICAgbGlzdCA9IGVtLmNyZWF0ZVF1ZXJ5KFwic2VsZWN0IHQgZnJvbSBUYXUgdCBKT0lOIEZFVENIIHQudHV5ZW5UYXVcIiwgVGF1LmNsYXNzKS5nZXRSZXN1bHRMaXN0KCk7XG4gICAgICAgICAgICB0eC5jb21taXQoKTtcbiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgIHR4LnJvbGxiYWNrKCk7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAvLyDEkOG6o20gYuG6o28gxJHDs25nIEVudGl0eU1hbmFnZXJcbiAgICAgICAgICAgIGlmIChlbSAhPSBudWxsICYmIGVtLmlzT3BlbigpKSB7XG4gICAgICAgICAgICAgICAgZW0uY2xvc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbGlzdDtcbiAgICB9XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGFvL2ltcGwvVmVUYXVEQU9JbXBsLmphdmFcbnBhY2thZ2UgZGFvLmltcGw7XG5cbmltcG9ydCBkYW8uVmVUYXVEQU87XG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS5FbnRpdHlNYW5hZ2VyO1xuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuRW50aXR5VHJhbnNhY3Rpb247XG5pbXBvcnQgbW9kZWwuSG9hRG9uO1xuaW1wb3J0IG1vZGVsLktoYWNoSGFuZztcbmltcG9ydCBtb2RlbC5UcmFuZ1RoYWlWZVRhdTtcbmltcG9ydCBtb2RlbC5WZVRhdTtcbmltcG9ydCB1dGlsLkpQQVV0aWw7XG5cbmltcG9ydCBqYXZhLnJtaS5SZW1vdGVFeGNlcHRpb247XG5pbXBvcnQgamF2YS5ybWkuc2VydmVyLlVuaWNhc3RSZW1vdGVPYmplY3Q7XG5pbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7XG5pbXBvcnQgamF2YS51dGlsLkxpc3Q7XG5pbXBvcnQgamF2YS51dGlsLk1hcDtcbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9STUlTZXJ2ZXIuamF2YVxuLi4uXG5cbiAgICAgICAgICAgIEhvYURvbkRBTyBob2FEb25EQU8gPSBuZXcgSG9hRG9uREFPSW1wbCgpO1xuICAgICAgICAgICAgS2hhY2hIYW5nREFPIGtoYWNoSGFuZ0RBTyA9IG5ldyBLaGFjaEhhbmdEQU9JbXBsKCk7XG4gICAgICAgICAgICBMb2FpS2hhY2hIYW5nREFPIGxvYWlLaGFjaEhhbmdEQU8gPSBuZXcgTG9haUtoYWNoSGFuZ0RBT0ltcGwoKTtcbiAgICAgICAgICAgIFZlVGF1REFPIHZlVGF1REFPID0gbmV3IFZlVGF1REFPSW1wbCgpO1xuICAgICAgICAgICAgRG9pVmVEQU8gZG9pVmVEQU8gPSBuZXcgRG9pVmVEQU9JbXBsKCk7IC8vIFRow6ptIGTDsm5nIG7DoHlcbiAgICAgICAgICAgIFRvYVRhdURvaVZlREFPIHRvYVRhdURvaVZlREFPID0gbmV3IFRvYVRhdURvaVZlREFPSW1wbCgpO1xuICAgICAgICAgICAgQ2hvTmdvaURvaVZlREFPIGNob05nb2lEb2lWZURBTyA9IG5ldyBDaG9OZ29pRG9pVmVEQU9JbXBsKCk7XG4gICAgICAgICAgICBMb2FpSG9hRG9uREFPIGxvYWlIb2FEb25EQU8gPSBuZXcgTG9haUhvYURvbkRBT0ltcGwoKTtcbiAgICAgICAgICAgIENoaVRpZXRIb2FEb25EQU8gY2hpVGlldEhvYURvbkRBTyA9IG5ldyBDaGlUaWV0SG9hRG9uREFPSW1wbCgpO1xuICAgICAgICAgICAgTmhhblZpZW5EQU8gbmhhblZpZW5EQU8gPSBuZXcgTmhhblZpZW5EQU9JbXBsKCk7XG4gICAgICAgICAgICBUYWlLaG9hbkRBTyB0YWlLaG9hbkRBTyA9IG5ldyBUYWlLaG9hbkRBT0ltcGwoKTtcbiAgICAgICAgICAgIFRyYUN1dVZlREFPIHRyYUN1dVZlREFPID0gbmV3IFRyYUN1dVZlREFPSW1wbCgpO1xuICAgICAgICAgICAgVGhvbmdLZURBTyB0aG9uZ0tlREFPID0gbmV3IFRob25nS2VEQU9JbXBsKCk7XG4gICAgICAgICAgICAvLyBU4bqhbyByZWdpc3RyeVxuICAgICAgICAgICAgUmVnaXN0cnkgcmVnaXN0cnkgPSBMb2NhdGVSZWdpc3RyeS5jcmVhdGVSZWdpc3RyeSg5MDkwKTtcblxuICAgICAgICAgICAgLy8gxJDEg25nIGvDvSBjw6FjIMSR4buRaSB0xrDhu6NuZyBEQU9cbiAgICAgICAgICAgIHJlZ2lzdHJ5LnJlYmluZChcImxpY2hUcmluaFRhdURBT1wiLCBsaWNoVHJpbmhUYXVEQU8pO1xuICAgICAgICAgICAgcmVnaXN0cnkucmViaW5kKFwidGF1REFPXCIsIHRhdURBTyk7XG4gICAgICAgICAgICByZWdpc3RyeS5yZWJpbmQoXCJ0dXllblRhdURBT1wiLCB0dXllblRhdURBTyk7XG5cbiAgICAgICAgICAgIHJlZ2lzdHJ5LnJlYmluZChcImhvYURvbkRBT1wiLCBob2FEb25EQU8pO1xuICAgICAgICAgICAgcmVnaXN0cnkucmViaW5kKFwidmVUYXVEQU9cIiwgdmVUYXVEQU8pO1xuICAgICAgICAgICAgcmVnaXN0cnkucmViaW5kKFwia2hhY2hIYW5nREFPXCIsIGtoYWNoSGFuZ0RBTyk7XG4gICAgICAgICAgICByZWdpc3RyeS5yZWJpbmQoXCJsb2FpS2hhY2hIYW5nREFPXCIsIGxvYWlLaGFjaEhhbmdEQU8pO1xuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2Rhby9UYXVEQU8uamF2YVxucGFja2FnZSBkYW87XG5cbmltcG9ydCBtb2RlbC5MaWNoVHJpbmhUYXU7XG5pbXBvcnQgbW9kZWwuVGF1O1xuXG5pbXBvcnQgamF2YS5ybWkuUmVtb3RlO1xuaW1wb3J0IGphdmEucm1pLlJlbW90ZUV4Y2VwdGlvbjtcbmltcG9ydCBqYXZhLnV0aWwuTGlzdDtcblxucHVibGljIGludGVyZmFjZSBUYXVEQU8gZXh0ZW5kcyBSZW1vdGUge1xuICAgIExpc3Q8VGF1PiBnZXRBbGxMaXN0VCgpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG4gICAgTGlzdDxUYXU+IGdldEFsbFdpdGhSb3V0ZXMoKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuICAgIHB1YmxpYyBUYXUgZ2V0VGF1QnlMaWNoVHJpbmhUYXUoTGljaFRyaW5oVGF1IGxpY2hUcmluaCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcbn1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9ndWlDbGllbnQvUXVhbkx5S2hhY2hIYW5nUGFuZWwuamF2YVxucGFja2FnZSBndWlDbGllbnQ7XG5cbmltcG9ydCBkYW8uKjtcbmltcG9ydCBkYW8uaW1wbC5LaGFjaEhhbmdEQU9JbXBsO1xuaW1wb3J0IGRhby5pbXBsLkxvYWlLaGFjaEhhbmdEQU9JbXBsO1xuaW1wb3J0IGRhby5pbXBsLlZlVGF1REFPSW1wbDtcbmltcG9ydCBndWlDbGllbnQuZm9ybWF0LkRhdGVMYWJlbEZvcm1hdHRlcjtcbmltcG9ydCBtb2RlbC4qO1xuaW1wb3J0IG9yZy5qZGF0ZXBpY2tlci5pbXBsLkpEYXRlUGFuZWxJbXBsO1xuaW1wb3J0IG9yZy5qZGF0ZXBpY2tlci5pbXBsLkpEYXRlUGlja2VySW1wbDtcbmltcG9ydCBvcmcuamRhdGVwaWNrZXIuaW1wbC5VdGlsRGF0ZU1vZGVsO1xuaW1wb3J0IHNlcnZpY2UuQUlUcmF2ZWxUaW1lUHJlZGljdG9yO1xuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2RhdGFmYWtlci9MaWNoVHJpbmhUYXVERi5qYXZhXG4vL3BhY2thZ2UgZGF0YWZha2VyO1xuLy9cbi8vaW1wb3J0IGRhby5pbXBsLkxpY2hUcmluaFRhdURBT0ltcGw7XG4vL2ltcG9ydCBkYW8uaW1wbC5Mb2FpQ2hvREFPSW1wbDtcbi8vaW1wb3J0IGRhby5pbXBsLlRvYVRhdURBT0ltcGw7XG4vL2ltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXI7XG4vL2ltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLkVudGl0eVRyYW5zYWN0aW9uO1xuLy9pbXBvcnQgbW9kZWwuKjtcbi8vaW1wb3J0IG5ldC5kYXRhZmFrZXIuRmFrZXI7XG4vL2ltcG9ydCBvcmcuaGliZXJuYXRlLkhpYmVybmF0ZTtcbi8vXG4vL2ltcG9ydCBqYXZhLnJtaS5SZW1vdGVFeGNlcHRpb247XG4vL2ltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlO1xuLy9pbXBvcnQgamF2YS50aW1lLkxvY2FsRGF0ZVRpbWU7XG4vL2ltcG9ydCBqYXZhLnRpbWUuTG9jYWxUaW1lO1xuLy9pbXBvcnQgamF2YS50aW1lLmZvcm1hdC5EYXRlVGltZUZvcm1hdHRlcjtcbi8vaW1wb3J0IGphdmEudGltZS50ZW1wb3JhbC5DaHJvbm9Vbml0O1xuLy9pbXBvcnQgamF2YS51dGlsLkxpc3Q7XG4vL2ltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5UaHJlYWRMb2NhbFJhbmRvbTtcbi8vXG4vL3B1YmxpYyBjbGFzcyBMaWNoVHJpbmhUYXVERiB7XG4vLyAgICBwcml2YXRlIHN0YXRpYyBMb2NhbERhdGUgbGFzdERhdGUgPSBMb2NhbERhdGUubm93KCk7IC8vIE5nw6B5IGN14buRaSBjw7luZyDEkcOjIHThuqFvIHbDqVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL21vZGVsL0xpY2hUcmluaFRhdS5qYXZhXG5wYWNrYWdlIG1vZGVsO1xuXG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS4qO1xuaW1wb3J0IGxvbWJvay5EYXRhO1xuaW1wb3J0IGxvbWJvay5FcXVhbHNBbmRIYXNoQ29kZTtcbmltcG9ydCBsb21ib2suVG9TdHJpbmc7XG5cbmltcG9ydCBqYXZhLmlvLlNlcmlhbGl6YWJsZTtcbmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlO1xuaW1wb3J0IGphdmEudGltZS5Mb2NhbFRpbWU7XG5pbXBvcnQgamF2YS51dGlsLlNldDtcblxuQEVudGl0eVxuQERhdGFcbkBFcXVhbHNBbmRIYXNoQ29kZShvbmx5RXhwbGljaXRseUluY2x1ZGVkID0gdHJ1ZSlcbkBUYWJsZShuYW1lID0gXCJsaWNodHJpbmh0YXVcIilcbnB1YmxpYyBjbGFzcyBMaWNoVHJpbmhUYXUgaW1wbGVtZW50cyBTZXJpYWxpemFibGUge1xuICAgIEBJZFxuICAgIEBDb2x1bW4obmFtZSA9IFwibWFfbGljaFwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJWQVJDSEFSKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSwgdW5pcXVlID0gdHJ1ZSlcbiAgICBwcml2YXRlIFN0cmluZyBtYUxpY2g7XG5cbiAgICBAQ29sdW1uKG5hbWUgPSBcImdpb19kaVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJUSU1FXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBMb2NhbFRpbWUgZ2lvRGk7XG5cbiAgICBAQ29sdW1uKG5hbWUgPSBcIm5nYXlfZGlcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiREFURVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgTG9jYWxEYXRlIG5nYXlEaTtcblxuICAgIEBFbnVtZXJhdGVkKEVudW1UeXBlLlNUUklORylcbiAgICBAQ29sdW1uKG5hbWUgPSBcInRyYW5nX3RoYWlcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiTlZBUkNIQVIoNTApXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBUcmFuZ1RoYWkgdHJhbmdUaGFpO1xuXG4gICAgQE1hbnlUb09uZVxuICAgIEBKb2luQ29sdW1uKG5hbWUgPSBcInRhdV9tYV90YXVcIiwgcmVmZXJlbmNlZENvbHVtbk5hbWUgPSBcIm1hX3RhdVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgVGF1IHRhdTtcblxuICAgIEBPbmVUb01hbnkobWFwcGVkQnkgPSBcImxpY2hUcmluaFRhdVwiKVxuICAgIEBUb1N0cmluZy5FeGNsdWRlXG4gICAgcHJpdmF0ZSBTZXQ8VmVUYXU+IHZlX3RhdXM7XG59Li4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL21vZGVsL1RhdS5qYXZhXG5wYWNrYWdlIG1vZGVsO1xuXG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS4qO1xuaW1wb3J0IGxvbWJvay5EYXRhO1xuaW1wb3J0IGxvbWJvay5FcXVhbHNBbmRIYXNoQ29kZTtcbmltcG9ydCBsb21ib2suVG9TdHJpbmc7XG5cbmltcG9ydCBqYXZhLmlvLlNlcmlhbGl6YWJsZTtcbmltcG9ydCBqYXZhLnV0aWwuU2V0O1xuXG5ARGF0YVxuQEVudGl0eVxuQEVxdWFsc0FuZEhhc2hDb2RlKG9ubHlFeHBsaWNpdGx5SW5jbHVkZWQgPSB0cnVlKVxuQFRhYmxlKG5hbWUgPSBcInRhdVwiKVxucHVibGljIGNsYXNzIFRhdSBpbXBsZW1lbnRzIFNlcmlhbGl6YWJsZSB7XG4gICAgQElkXG4gICAgQEVxdWFsc0FuZEhhc2hDb2RlLkluY2x1ZGVcbiAgICBAQ29sdW1uKG5hbWUgPSBcIm1hX3RhdVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJ2YXJjaGFyKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSwgdW5pcXVlID0gdHJ1ZSlcbiAgICBwcml2YXRlIFN0cmluZyBtYVRhdTsgLy8gTcOjIHTDoHVcbiAgICBAQ29sdW1uKG5hbWUgPSBcInRlbl90YXVcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwidmFyY2hhcigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgQEVxdWFsc0FuZEhhc2hDb2RlLkV4Y2x1ZGVcbiAgICBwcml2YXRlIFN0cmluZyB0ZW5UYXU7XG4gICAgQENvbHVtbihuYW1lID0gXCJzb190b2FcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBARXF1YWxzQW5kSGFzaENvZGUuRXhjbHVkZS8vIFTDqm4gdMOgdVxuICAgIHByaXZhdGUgaW50IHNvVG9hO1xuICAgIC8vIFPhu5EgdG9hXG4gICAgQE1hbnlUb09uZShmZXRjaCA9IEZldGNoVHlwZS5MQVpZKVxuICAgIEBUb1N0cmluZy5FeGNsdWRlXG4gICAgQEpvaW5Db2x1bW4obmFtZSA9IFwibWFfdHV5ZW5cIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIFR1eWVuVGF1IHR1eWVuVGF1OyAvLyDEkOG7kWkgdMaw4bujbmcgVHV5ZW5UYXVcblxuICAgIEBPbmVUb01hbnkobWFwcGVkQnkgPSBcInRhdVwiLCBjYXNjYWRlID0gQ2FzY2FkZVR5cGUuQUxMLCBvcnBoYW5SZW1vdmFsID0gdHJ1ZSlcbiAgICBAVG9TdHJpbmcuRXhjbHVkZVxuICAgIHByaXZhdGUgU2V0PFRvYVRhdT4gZGFuaFNhY2hUb2FUYXU7XG5cbiAgICBAT25lVG9NYW55KG1hcHBlZEJ5ID0gXCJ0YXVcIiwgY2FzY2FkZSA9IENhc2NhZGVUeXBlLkFMTCwgb3JwaGFuUmVtb3ZhbCA9IHRydWUpXG4gICAgQFRvU3RyaW5nLkV4Y2x1ZGVcbiAgICBwcml2YXRlIFNldDxMaWNoVHJpbmhUYXU+IExpY2hUcmluaFRhdTtcbn1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9tb2RlbC9UcmFuZ1RoYWkuamF2YVxucGFja2FnZSBtb2RlbDtcblxucHVibGljIGVudW0gVHJhbmdUaGFpIHtcbiAgICBEQV9LSE9JX0hBTkgoXCLEkMOjIGto4bufaSBow6BuaFwiKSxcbiAgICBDSFVBX0tIT0lfSEFOSChcIkNoxrBhIGto4bufaSBow6BuaFwiKSxcbiAgICBEQV9IVVkoXCLEkMOjIGjhu6d5XCIpLFxuICAgIEhPQVRfRE9ORyhcIkhv4bqhdCDEkeG7mW5nXCIpO1xuXG4gICAgcHJpdmF0ZSBmaW5hbCBTdHJpbmcgdmFsdWU7XG5cbiAgICBUcmFuZ1RoYWkoU3RyaW5nIHZhbHVlKSB7XG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgU3RyaW5nIGdldFZhbHVlKCkge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBUcmFuZ1RoYWkgZnJvbVZhbHVlKFN0cmluZyB2YWx1ZSkge1xuICAgICAgICBmb3IgKFRyYW5nVGhhaSBzdGF0dXMgOiBUcmFuZ1RoYWkudmFsdWVzKCkpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMudmFsdWUuZXF1YWxzKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzdGF0dXM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbihcIk5vIGVudW0gY29uc3RhbnQgZm9yIHZhbHVlOiBcIiArIHZhbHVlKTtcbiAgICB9XG59Li4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL21vZGVsL0todXllbk1haS5qYXZhXG5wYWNrYWdlIG1vZGVsO1xuXG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS4qO1xuaW1wb3J0IGxvbWJvay5EYXRhO1xuXG5pbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7XG5pbXBvcnQgamF2YS50aW1lLkxvY2FsRGF0ZTtcbmltcG9ydCBqYXZhLnV0aWwuT2JqZWN0cztcbmltcG9ydCBqYXZhLnV0aWwuU2V0O1xuXG5ARGF0YVxuQEVudGl0eVxuQFRhYmxlKG5hbWUgPSBcImtodXllbm1haVwiKVxucHVibGljIGNsYXNzIEtodXllbk1haSBpbXBsZW1lbnRzIFNlcmlhbGl6YWJsZSB7XG4gICAgQElkXG4gICAgQENvbHVtbihuYW1lID0gXCJtYV9rbVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJWQVJDSEFSKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSx1bmlxdWUgPSB0cnVlKVxuICAgIHByaXZhdGUgU3RyaW5nIG1hS007XG4gICAgQENvbHVtbihuYW1lID0gXCJ0ZW5fa21cIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiTlZBUkNIQVIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgU3RyaW5nIHRlbktNO1xuICAgIEBDb2x1bW4obmFtZSA9IFwidGhvaV9naWFuX2JhdF9kYXVcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiREFURVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgTG9jYWxEYXRlIHRob2lHaWFuQmF0RGF1O1xuICAgIEBDb2x1bW4obmFtZSA9IFwidGhvaV9naWFuX2tldF90aHVjXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcIkRBVEVcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIExvY2FsRGF0ZSB0aG9pR2lhbktldFRodWM7XG4gICAgQENvbHVtbihuYW1lID0gXCJub2lfZHVuZ19rbVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJOVkFSQ0hBUigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBTdHJpbmcgbm9pRHVuZ0tNO1xuICAgIEBDb2x1bW4obmFtZSA9IFwiY2hpZXRfa2hhdVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJkb3VibGVcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIGRvdWJsZSBjaGlldEtoYXU7XG4gICAgQENvbHVtbihuYW1lID0gXCJkb2lfdHVvbmdfYXBfZHVuZ1wiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJOVkFSQ0hBUigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBEb2lUdW9uZ0FwRHVuZyBkb2lUdW9uZ0FwRHVuZztcbiAgICBAQ29sdW1uKG5hbWUgPSBcInRyYW5nX3RoYWlcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiTlZBUkNIQVIoNTApXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBTdHJpbmcgdHJhbmdUaGFpO1xuXG4gICAgQE9uZVRvTWFueShtYXBwZWRCeSA9IFwia2h1eWVuTWFpXCIpXG4gICAgcHJpdmF0ZSBTZXQ8VmVUYXU+IHZlX3RhdXM7XG5cblxufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2Rhby9Mb2FpS2hhY2hIYW5nREFPLmphdmFcbnBhY2thZ2UgZGFvO1xuXG5pbXBvcnQgbW9kZWwuTG9haUtoYWNoSGFuZztcblxuaW1wb3J0IGphdmEucm1pLlJlbW90ZTtcbmltcG9ydCBqYXZhLnJtaS5SZW1vdGVFeGNlcHRpb247XG5pbXBvcnQgamF2YS51dGlsLkxpc3Q7XG5cbi8qKlxuICogQEThu7Egw6FuOiBQaGFuVGFuSmF2YU5ob21HUFRcbiAqIEBDbGFzczogTG9haUtoYWNoSGFuZ0RBT1xuICogQFThuqFvIHbDoG8gbmfDoHk6IDE4LzA0LzIwMjVcbiAqIEBUw6FjIGdp4bqjOiBOZ3V5ZW4gSHV1IFNhbmdcbiAqL1xucHVibGljIGludGVyZmFjZSBMb2FpS2hhY2hIYW5nREFPIGV4dGVuZHMgUmVtb3RlIHtcbiAgICBMaXN0PExvYWlLaGFjaEhhbmc+IGdldEFsbCgpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG4gICAgTG9haUtoYWNoSGFuZyBmaW5kQnlJZChTdHJpbmcgaWQpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG4gICAgYm9vbGVhbiBzYXZlKExvYWlLaGFjaEhhbmcgbG9haUtoYWNoSGFuZykgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcbiAgICBib29sZWFuIHVwZGF0ZShMb2FpS2hhY2hIYW5nIGxvYWlLaGFjaEhhbmcpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG4gICAgYm9vbGVhbiBkZWxldGUoU3RyaW5nIGlkKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuXG4vLyAgICAgTGlzdDxMb2FpS2hhY2hIYW5nPiBnZXRBbGxMaXN0KCk7XG59Li4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2Rhby9pbXBsL0todXllbk1haURBT0ltcGwuamF2YVxucGFja2FnZSBkYW8uaW1wbDtcblxuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuRW50aXR5TWFuYWdlcjtcbmltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLkVudGl0eVRyYW5zYWN0aW9uO1xuaW1wb3J0IGxvbWJvay5BbGxBcmdzQ29uc3RydWN0b3I7XG5pbXBvcnQgbW9kZWwuS2h1eWVuTWFpO1xuaW1wb3J0IHV0aWwuSlBBVXRpbDtcblxuaW1wb3J0IGphdmEuc3FsLlByZXBhcmVkU3RhdGVtZW50O1xuaW1wb3J0IGphdmEuc3FsLlJlc3VsdFNldDtcbmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlO1xuaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7XG5pbXBvcnQgamF2YS51dGlsLkxpc3Q7XG5cbkBBbGxBcmdzQ29uc3RydWN0b3JcbnB1YmxpYyBjbGFzcyBLaHV5ZW5NYWlEQU9JbXBsIHtcblxuICAgIHByaXZhdGUgRW50aXR5TWFuYWdlciBlbTtcbiAgICBwdWJsaWMgS2h1eWVuTWFpREFPSW1wbCgpIHtcbiAgICAgICAgdGhpcy5lbSA9IEpQQVV0aWwuZ2V0RW50aXR5TWFuYWdlcigpOztcbiAgICB9XG4gICAgLy8gTOG6pXkgZGFuaCBzw6FjaCB04bqldCBj4bqjIGPDoWMga2h1eeG6v24gbcOjaVxuICAgIHB1YmxpYyBMaXN0PEtodXllbk1haT4gZmluZEFsbCgpIHtcbiAgICAgICAgU3RyaW5nIHF1ZXJ5ID0gXCJzZWxlY3Qga20gZnJvbSBLaHV5ZW5NYWkga21cIjtcbiAgICAgICAgcmV0dXJuIGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5LCBLaHV5ZW5NYWkuY2xhc3MpLmdldFJlc3VsdExpc3QoKTtcbiAgICB9XG5cbiAgICAvLyBM4bqleSBkYW5oIHPDoWNoIGtodXnhur9uIG3Do2kgdGhlbyB0w6puXG4gICAgcHVibGljIExpc3Q8S2h1eWVuTWFpPiBmaW5kQnlOYW1lKFN0cmluZyBuYW1lKSB7XG4gICAgICAgIFN0cmluZyBxdWVyeSA9IFwic2VsZWN0IGttIGZyb20gS2h1eWVuTWFpIGttIHdoZXJlIGttLnRlbktNIGxpa2UgOm5hbWVcIjtcbiAgICAgICAgcmV0dXJuIGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5LCBLaHV5ZW5NYWkuY2xhc3MpXG4gICAgICAgICAgICAgICAgLnNldFBhcmFtZXRlcihcIm5hbWVcIiwgXCIlXCIgKyBuYW1lICsgXCIlXCIpXG4gICAgICAgICAgICAgICAgLmdldFJlc3VsdExpc3QoKTtcbiAgICB9XG5cbiAgICAvLyBM4bqleSBraHV54bq/biBtw6NpIHRoZW8gbcOjXG4gICAgcHVibGljIEtodXllbk1haSBmaW5kQnlJZChTdHJpbmcgaWQpIHtcbiAgICAgICAgcmV0dXJuIGVtLmZpbmQoS2h1eWVuTWFpLmNsYXNzLCBpZCk7XG4gICAgfVxuXG4gICAgLy8gVGjDqm0gaG/hurdjIGPhuq1wIG5o4bqtdCBraHV54bq/biBtw6NpXG4gICAgcHVibGljIGJvb2xlYW4gc2F2ZShLaHV5ZW5NYWkga2h1eWVuTWFpKSB7XG4gICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRyLmJlZ2luKCk7XG4gICAgICAgICAgICBpZiAoZW0uZmluZChLaHV5ZW5NYWkuY2xhc3MsIGtodXllbk1haS5nZXRNYUtNKCkpID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBlbS5wZXJzaXN0KGtodXllbk1haSk7IC8vIFRow6ptIG3hu5tpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGVtLm1lcmdlKGtodXllbk1haSk7IC8vIEPhuq1wIG5o4bqtdFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdHIuY29tbWl0KCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGV4KSB7XG4gICAgICAgICAgICBleC5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgIHRyLnJvbGxiYWNrKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIFjDs2Ega2h1eeG6v24gbcOjaSB0aGVvIG3Do1xuICAgIHB1YmxpYyBib29sZWFuIGRlbGV0ZShTdHJpbmcgaWQpIHtcbiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHIgPSBlbS5nZXRUcmFuc2FjdGlvbigpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdHIuYmVnaW4oKTtcbiAgICAgICAgICAgIEtodXllbk1haSBrbSA9IGVtLmZpbmQoS2h1eWVuTWFpLmNsYXNzLCBpZCk7XG4gICAgICAgICAgICBpZiAoa20gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGVtLnJlbW92ZShrbSk7XG4gICAgICAgICAgICAgICAgdHIuY29tbWl0KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBleCkge1xuICAgICAgICAgICAgZXgucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgICAgICB0ci5yb2xsYmFjaygpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLy8gVMOsbSBjw6FjIGtodXnhur9uIG3Do2kgxJFhbmcgw6FwIGThu6VuZ1xuICAgIHB1YmxpYyBMaXN0PEtodXllbk1haT4gZmluZE9uZ29pbmdQcm9tb3Rpb25zKCkge1xuICAgICAgICBTdHJpbmcgcXVlcnkgPSBcInNlbGVjdCBrbSBmcm9tIEtodXllbk1haSBrbSBcIiArXG4gICAgICAgICAgICAgICAgXCJ3aGVyZSBrbS50cmFuZ1RoYWkgPSA6dHJhbmdUaGFpIFwiICtcbiAgICAgICAgICAgICAgICBcImFuZCBrbS50aG9pR2lhbkJhdERhdSA8PSA6dG9kYXkgXCIgK1xuICAgICAgICAgICAgICAgIFwiYW5kIGttLnRob2lHaWFuS2V0VGh1YyA+PSA6dG9kYXlcIjtcblxuICAgICAgICByZXR1cm4gZW0uY3JlYXRlUXVlcnkocXVlcnksIEtodXllbk1haS5jbGFzcylcbiAgICAgICAgICAgICAgICAuc2V0UGFyYW1ldGVyKFwidHJhbmdUaGFpXCIsIFwixJBhbmcgZGnhu4VuIHJhXCIpXG4gICAgICAgICAgICAgICAgLnNldFBhcmFtZXRlcihcInRvZGF5XCIsIExvY2FsRGF0ZS5ub3coKSlcbiAgICAgICAgICAgICAgICAuZ2V0UmVzdWx0TGlzdCgpO1xuICAgIH1cblxufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL21vZGVsL1RyYW5nVGhhaVZlVGF1LmphdmFcbnBhY2thZ2UgbW9kZWw7XG5cbnB1YmxpYyBlbnVtIFRyYW5nVGhhaVZlVGF1IHtcbiAgICBDSE9fWEFDX05IQU4oXCJDaOG7nSB4w6FjIG5o4bqtblwiKSxcbiAgICBEQV9USEFOSF9UT0FOKFwixJDDoyB0aGFuaCB0b8OhblwiKSxcbiAgICBEQV9ET0koXCLEkMOjIMSR4buVaVwiKSxcbiAgICBEQV9UUkEoXCLEkMOjIHRy4bqjXCIpO1xuXG4gICAgcHJpdmF0ZSBmaW5hbCBTdHJpbmcgdmFsdWU7XG5cbiAgICBUcmFuZ1RoYWlWZVRhdShTdHJpbmcgdmFsdWUpIHtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgIH1cblxuICAgIHB1YmxpYyBTdHJpbmcgZ2V0VmFsdWUoKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIFRyYW5nVGhhaVZlVGF1IGZyb21WYWx1ZShTdHJpbmcgdmFsdWUpIHtcbiAgICAgICAgZm9yIChUcmFuZ1RoYWlWZVRhdSBzdGF0dXMgOiBUcmFuZ1RoYWlWZVRhdS52YWx1ZXMoKSkge1xuICAgICAgICAgICAgaWYgKHN0YXR1cy52YWx1ZS5lcXVhbHModmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0YXR1cztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKFwiTm8gZW51bSBjb25zdGFudCBmb3IgdmFsdWU6IFwiICsgdmFsdWUpO1xuICAgIH1cbn0uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGFvL0xvYWlIb2FEb25EQU8uamF2YVxucGFja2FnZSBkYW87XG5cbmltcG9ydCBtb2RlbC5Mb2FpSG9hRG9uO1xuXG5pbXBvcnQgamF2YS5ybWkuUmVtb3RlO1xuXG5wdWJsaWMgaW50ZXJmYWNlIExvYWlIb2FEb25EQU8gZXh0ZW5kcyBSZW1vdGUge1xuICAgIExvYWlIb2FEb24gZmluZEJ5SWQoU3RyaW5nIGlkKSB0aHJvd3MgRXhjZXB0aW9uO1xufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL21vZGVsL0xvYWlDaG8uamF2YVxucGFja2FnZSBtb2RlbDtcblxuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuKjtcbmltcG9ydCBsb21ib2suRGF0YTtcbmltcG9ydCBsb21ib2suRXF1YWxzQW5kSGFzaENvZGU7XG5pbXBvcnQgbG9tYm9rLlRvU3RyaW5nO1xuXG5pbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7XG5pbXBvcnQgamF2YS51dGlsLlNldDtcblxuQEVudGl0eVxuQERhdGFcbkBFcXVhbHNBbmRIYXNoQ29kZShvbmx5RXhwbGljaXRseUluY2x1ZGVkID0gdHJ1ZSlcbkBUYWJsZShuYW1lID0gXCJsb2FpY2hvXCIpXG5wdWJsaWMgY2xhc3MgTG9haUNobyBpbXBsZW1lbnRzIFNlcmlhbGl6YWJsZSB7XG4gICAgQElkXG4gICAgQEVxdWFsc0FuZEhhc2hDb2RlLkluY2x1ZGVcbiAgICBAQ29sdW1uKG5hbWUgPSBcIm1hX2xvYWkuLi4iLCJpc19lcnJvciI6ZmFsc2UsInJlcXVlc3RfaWQiOiIiLCJ0b29sX3VzZV9pZCI6InRvb2x1XzAxRW1Qbm1uaU5uSFBDMkRDMUh5NXRwVyJ9fSx7ImlkIjoyLCJ0eXBlIjo0LCJpZGVfc3RhdGVfbm9kZSI6eyJ3b3Jrc3BhY2VGb2xkZXJzIjpbeyJyZXBvc2l0b3J5Um9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIiwiZm9sZGVyUm9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIn1dLCJ3b3Jrc3BhY2VGb2xkZXJzVW5jaGFuZ2VkIjpmYWxzZX19XSwicmVzcG9uc2VfdGV4dCI6IkxldCBtZSBjaGVjayBmb3IgdGhlIERvaVR1b25nQXBEdW5nIGVudW0gYW5kIGFueSBvdGhlciByZWxldmFudCBtb2RlbHM6XG4iLCJ3b3Jrc3BhY2VfZmlsZV9jaHVua3MiOltdfSx7InN0YXR1cyI6InN1Y2Nlc3MiLCJyZXF1ZXN0X2lkIjoiMjU1MjY3YzYtMjczMC00ZDNhLTk0NDctZmY5ZDNiMmZkYjIzIiwicmVxdWVzdF9tZXNzYWdlIjoiIiwic3RydWN0dXJlZF9vdXRwdXRfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjo1LCJjb250ZW50IjoiIiwidG9vbF91c2UiOnsidG9vbF91c2VfaWQiOiJ0b29sdV8wMUJqYVJFcnVYSjdRTFRTMkpQUnQ4alkiLCJ0b29sX25hbWUiOiJjb2RlYmFzZS1yZXRyaWV2YWwiLCJpbnB1dF9qc29uIjoie1wiaW5mb3JtYXRpb25fcmVxdWVzdFwiOiBcIkZpbmQgaWYgdGhlcmUncyBhIEtodXllbk1haURBTyBpbnRlcmZhY2UgYW5kIGFueSBvdGhlciByZWxldmFudCBmaWxlcyBmb3IgaW1wbGVtZW50aW5nIGEgcHJvbW90aW9uIG1hbmFnZW1lbnQgcGFuZWxcIn0ifX0seyJpZCI6MCwidHlwZSI6MCwiY29udGVudCI6Ik5vdyBJJ2xsIGNoZWNrIGlmIHRoZXJlJ3MgYSBLaHV5ZW5NYWlEQU8gaW50ZXJmYWNlOlxuIn0seyJpZCI6MiwidHlwZSI6MiwiY29udGVudCI6IiJ9LHsiaWQiOjMsInR5cGUiOjMsImNvbnRlbnQiOiIifV0sInNlZW5fc3RhdGUiOiJzZWVuIiwic3RydWN0dXJlZF9yZXF1ZXN0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6MSwidG9vbF9yZXN1bHRfbm9kZSI6eyJjb250ZW50IjoiVGhlIGZvbGxvd2luZyBjb2RlIHNlY3Rpb25zIHdlcmUgcmV0cmlldmVkOlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9kYXRhZmFrZXIvS2h1eWVuTWFpREYuamF2YVxuLi4uXG5cbnB1YmxpYyBjbGFzcyBLaHV5ZW5NYWlERiB7XG5cbiAgICAvLyBIw6BtIHThuqFvIG3DoyBraHV54bq/biBtw6NpIHThu7EgdMSDbmdcbiAgICBwcml2YXRlIHN0YXRpYyBTdHJpbmcgZ2VuZXJhdGVOZXh0TWFLTShFbnRpdHlNYW5hZ2VyIGVtKSB7XG4gICAgICAgIFN0cmluZyBwcmVmaXggPSBcIktNXCI7XG4gICAgICAgIFN0cmluZyBxdWVyeVN0ciA9IFwiU0VMRUNUIE1BWChrLm1hS00pIEZST00gS2h1eWVuTWFpIGsgV0hFUkUgay5tYUtNIExJS0UgOnByZWZpeFwiO1xuICAgICAgICBRdWVyeSBxdWVyeSA9IGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5U3RyKTtcbiAgICAgICAgcXVlcnkuc2V0UGFyYW1ldGVyKFwicHJlZml4XCIsIHByZWZpeCArIFwiJVwiKTtcblxuICAgICAgICBTdHJpbmcgbWF4TWFLTSA9IChTdHJpbmcpIHF1ZXJ5LmdldFNpbmdsZVJlc3VsdCgpO1xuICAgICAgICBpbnQgbmV4dE51bWJlciA9IDE7XG5cbiAgICAgICAgaWYgKG1heE1hS00gIT0gbnVsbCkge1xuICAgICAgICAgICAgLy8gTOG6pXkgcGjhuqduIHPhu5EgdOG7qyBtw6MgY3Xhu5FpIGPDuW5nIHbDoCB0xINuZyBsw6puIDFcbiAgICAgICAgICAgIFN0cmluZyBudW1iZXJQYXJ0ID0gbWF4TWFLTS5zdWJzdHJpbmcocHJlZml4Lmxlbmd0aCgpKTtcbiAgICAgICAgICAgIG5leHROdW1iZXIgPSBJbnRlZ2VyLnBhcnNlSW50KG51bWJlclBhcnQpICsgMTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRy4bqjIHbhu4EgbcOjIGtodXnhur9uIG3Do2kgduG7m2kgxJHhu4tuaCBk4bqhbmcgS01YWFhYWFhcbiAgICAgICAgcmV0dXJuIFN0cmluZy5mb3JtYXQoXCIlcyUwNmRcIiwgcHJlZml4LCBuZXh0TnVtYmVyKTtcbiAgICB9XG5cbiAgICAvLyBIw6BtIMSR4buDIGhp4buDbiB0aOG7iyBk4buvIGxp4buHdSBt4bqrdVxuICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBnZW5lcmF0ZUFuZFByaW50U2FtcGxlRGF0YShFbnRpdHlNYW5hZ2VyIGVtKSB7XG5cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpO1xuICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCAxNTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgS2h1eWVuTWFpIGtodXllbk1haSA9IG5ldyBLaHV5ZW5NYWkoKTtcbiAgICAgICAgICAgICAgICBraHV5ZW5NYWkuc2V0TWFLTShnZW5lcmF0ZU5leHRNYUtNKGVtKSk7IC8vIFNpbmggbcOjIHThu7EgxJHhu5luZ1xuICAgICAgICAgICAgICAgIGtodXllbk1haS5zZXRUZW5LTShcIktodXnhur9uIG3Do2kgc+G7kSBcIiArIChpICsgMSkpO1xuICAgICAgICAgICAgICAgIGtodXllbk1haS5zZXRUaG9pR2lhbkJhdERhdShMb2NhbERhdGUubm93KCkubWludXNEYXlzKGkpKTtcbiAgICAgICAgICAgICAgICBraHV5ZW5NYWkuc2V0VGhvaUdpYW5LZXRUaHVjKExvY2FsRGF0ZS5ub3coKS5wbHVzRGF5cyhpICsgMTApKTtcbiAgICAgICAgICAgICAgICBraHV5ZW5NYWkuc2V0Tm9pRHVuZ0tNKFwiR2nhuqNtIGdpw6EgXCIgKyAoMTAgKyBpKSArIFwiJSBjaG8ga2jDoWNoIGjDoG5nXCIpO1xuICAgICAgICAgICAgICAgIGtodXllbk1haS5zZXRDaGlldEtoYXUoMTAgKyBpKTtcbiAgICAgICAgICAgICAgICBraHV5ZW5NYWkuc2V0RG9pVHVvbmdBcER1bmcoXCJLaMOhY2ggaMOgbmcgbG/huqFpIFwiICsgKGkgJSAzICsgMSkpO1xuICAgICAgICAgICAgICAgIGtodXllbk1haS5zZXRUcmFuZ1RoYWkoaSAlIDIgPT0gMCA/IFwixJBhbmcgw6FwIGThu6VuZ1wiIDogXCJI4bq/dCBo4bqhblwiKTtcblxuICAgICAgICAgICAgICAgIGVtLnBlcnNpc3Qoa2h1eWVuTWFpKTsgLy8gTMawdSB2w6BvIGPGoSBz4bufIGThu68gbGnhu4d1XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1pdCgpO1xuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5yb2xsYmFjaygpO1xuICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgfVxuICAgIH1cblxuXG59XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvbW9kZWwvS2h1eWVuTWFpLmphdmFcbi4uLlxuXG5ARGF0YVxuQEVudGl0eVxuQFRhYmxlKG5hbWUgPSBcImtodXllbm1haVwiKVxucHVibGljIGNsYXNzIEtodXllbk1haSBpbXBsZW1lbnRzIFNlcmlhbGl6YWJsZSB7XG4gICAgQElkXG4gICAgQENvbHVtbihuYW1lID0gXCJtYV9rbVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJWQVJDSEFSKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSx1bmlxdWUgPSB0cnVlKVxuICAgIHByaXZhdGUgU3RyaW5nIG1hS007XG4gICAgQENvbHVtbihuYW1lID0gXCJ0ZW5fa21cIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiTlZBUkNIQVIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgU3RyaW5nIHRlbktNO1xuICAgIEBDb2x1bW4obmFtZSA9IFwidGhvaV9naWFuX2JhdF9kYXVcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiREFURVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgTG9jYWxEYXRlIHRob2lHaWFuQmF0RGF1O1xuICAgIEBDb2x1bW4obmFtZSA9IFwidGhvaV9naWFuX2tldF90aHVjXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcIkRBVEVcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIExvY2FsRGF0ZSB0aG9pR2lhbktldFRodWM7XG4gICAgQENvbHVtbihuYW1lID0gXCJub2lfZHVuZ19rbVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJOVkFSQ0hBUigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBTdHJpbmcgbm9pRHVuZ0tNO1xuICAgIEBDb2x1bW4obmFtZSA9IFwiY2hpZXRfa2hhdVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJkb3VibGVcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIGRvdWJsZSBjaGlldEtoYXU7XG4gICAgQENvbHVtbihuYW1lID0gXCJkb2lfdHVvbmdfYXBfZHVuZ1wiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJOVkFSQ0hBUigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBEb2lUdW9uZ0FwRHVuZyBkb2lUdW9uZ0FwRHVuZztcbiAgICBAQ29sdW1uKG5hbWUgPSBcInRyYW5nX3RoYWlcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiTlZBUkNIQVIoNTApXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBTdHJpbmcgdHJhbmdUaGFpO1xuXG4gICAgQE9uZVRvTWFueShtYXBwZWRCeSA9IFwia2h1eWVuTWFpXCIpXG4gICAgcHJpdmF0ZSBTZXQ8VmVUYXU+IHZlX3RhdXM7XG5cblxufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL3Rlc3RDUlVEL0todXllbk1haURBT1Rlc3QuamF2YVxucGFja2FnZSB0ZXN0Q1JVRDtcblxuaW1wb3J0IGRhby5pbXBsLktodXllbk1haURBT0ltcGw7XG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS5FbnRpdHlNYW5hZ2VyO1xuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuRW50aXR5TWFuYWdlckZhY3Rvcnk7XG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS5QZXJzaXN0ZW5jZTtcbmltcG9ydCBtb2RlbC5LaHV5ZW5NYWk7XG5cbmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlO1xuaW1wb3J0IGphdmEudXRpbC5MaXN0O1xuXG5wdWJsaWMgY2xhc3MgS2h1eWVuTWFpREFPVGVzdCB7XG5cbiAgICBwdWJsaWMgc3RhdGljIHZvaWQgbWFpbihTdHJpbmdbXSBhcmdzKSB7XG4gICAgICAgIC8vIFThuqFvIEVudGl0eU1hbmFnZXJGYWN0b3J5IHbDoCBFbnRpdHlNYW5hZ2VyXG4gICAgICAgIEVudGl0eU1hbmFnZXJGYWN0b3J5IGVtZiA9IFBlcnNpc3RlbmNlLmNyZWF0ZUVudGl0eU1hbmFnZXJGYWN0b3J5KFwibWFyaWFkYlwiKTtcbiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7XG5cbiAgICAgICAgLy8gVOG6oW8gaW5zdGFuY2UgY+G7p2EgS2h1eWVuTWFpREFPXG4gICAgICAgIEtodXllbk1haURBT0ltcGwga2h1eWVuTWFpREFPSW1wbCA9IG5ldyBLaHV5ZW5NYWlEQU9JbXBsKGVtKTtcblxuICAgICAgICAvLyAxLiBUaMOqbSBob+G6t2MgY+G6rXAgbmjhuq10IGtodXnhur9uIG3Do2lcbiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiPT09IFRow6ptIGhv4bq3YyBj4bqtcCBuaOG6rXQga2h1eeG6v24gbcOjaSA9PT1cIik7XG4gICAgICAgIEtodXllbk1haSBraHV5ZW5NYWkgPSBuZXcgS2h1eWVuTWFpKCk7XG4gICAgICAgIGtodXllbk1haS5zZXRNYUtNKFwiS00wMDAwMTZcIik7XG4gICAgICAgIGtodXllbk1haS5zZXRUZW5LTShcIktodXnhur9uIG3Do2kgVOG6v3RcIik7XG4gICAgICAgIGtodXllbk1haS5zZXRUcmFuZ1RoYWkoXCLEkGFuZyBkaeG7hW4gcmFcIik7XG4gICAgICAgIGtodXllbk1haS5zZXRUaG9pR2lhbkJhdERhdShMb2NhbERhdGUubm93KCkubWludXNEYXlzKDUpKTtcbiAgICAgICAga2h1eWVuTWFpLnNldFRob2lHaWFuS2V0VGh1YyhMb2NhbERhdGUubm93KCkucGx1c0RheXMoMTApKTtcbiAgICAgICAga2h1eWVuTWFpLnNldENoaWV0S2hhdSgwLjIpOyAvLyAyMCUgZ2nhuqNtIGdpw6FcbiAgICAgICAga2h1eWVuTWFpLnNldERvaVR1b25nQXBEdW5nKFwiVOG6pXQgY+G6oyBraMOhY2ggaMOgbmdcIik7XG4gICAgICAgIGtodXllbk1haS5zZXROb2lEdW5nS00oXCJHaeG6o20gZ2nDoSAyMCUgY2hvIHThuqV0IGPhuqMgc+G6o24gcGjhuqltXCIpO1xuICAgICAgICBib29sZWFuIGlzU2F2ZWQgPSBraHV5ZW5NYWlEQU9JbXBsLnNhdmUoa2h1eWVuTWFpKTtcbiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiVGjDqm0gaG/hurdjIGPhuq1wIG5o4bqtdCBraHV54bq/biBtw6NpOiBcIiArIChpc1NhdmVkID8gXCJUaMOgbmggY8O0bmdcIiA6IFwiVGjhuqV0IGLhuqFpXCIpKTtcblxuICAgICAgICAvLyAyLiBM4bqleSBkYW5oIHPDoWNoIHThuqV0IGPhuqMgY8OhYyBraHV54bq/biBtw6NpXG4gICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIlxcbj09PSBEYW5oIHPDoWNoIHThuqV0IGPhuqMgY8OhYyBraHV54bq/biBtw6NpID09PVwiKTtcbiAgICAgICAgTGlzdDxLaHV5ZW5NYWk+IGFsbFByb21vdGlvbnMgPSBraHV5ZW5NYWlEQU9JbXBsLmZpbmRBbGwoKTtcbiAgICAgICAgYWxsUHJvbW90aW9ucy5mb3JFYWNoKFN5c3RlbS5vdXQ6OnByaW50bG4pO1xuXG4gICAgICAgIC8vIDMuIFTDrG0ga2h1eeG6v24gbcOjaSB0aGVvIHTDqm5cbiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiXFxuPT09IFTDrG0ga2h1eeG6v24gbcOjaSB0aGVvIHTDqm4gPT09XCIpO1xuICAgICAgICBMaXN0PEtodXllbk1haT4gcHJvbW90aW9uc0J5TmFtZSA9IGtodXllbk1haURBT0ltcGwuZmluZEJ5TmFtZShcIlThur90XCIpO1xuICAgICAgICBwcm9tb3Rpb25zQnlOYW1lLmZvckVhY2goU3lzdGVtLm91dDo6cHJpbnRsbik7XG5cbiAgICAgICAgLy8gNC4gVMOsbSBraHV54bq/biBtw6NpIHRoZW8gbcOjXG4gICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIlxcbj09PSBUw6xtIGtodXnhur9uIG3Do2kgdGhlbyBtw6MgPT09XCIpO1xuICAgICAgICBLaHV5ZW5NYWkgZm91bmRQcm9tb3Rpb24gPSBraHV5ZW5NYWlEQU9JbXBsLmZpbmRCeUlkKFwiS00wMDFcIik7XG4gICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIkvhur90IHF14bqjOiBcIiArIChmb3VuZFByb21vdGlvbiAhPSBudWxsID8gZm91bmRQcm9tb3Rpb24gOiBcIktow7RuZyB0w6xtIHRo4bqleVwiKSk7XG5cbiAgICAgICAgLy8gNS4gVMOsbSBjw6FjIGtodXnhur9uIG3Do2kgxJFhbmcgw6FwIGThu6VuZ1xuICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJcXG49PT0gVMOsbSBjw6FjIGtodXnhur9uIG3Do2kgxJFhbmcgw6FwIGThu6VuZyA9PT1cIik7XG4gICAgICAgIExpc3Q8S2h1eWVuTWFpPiBvbmdvaW5nUHJvbW90aW9ucyA9IGtodXllbk1haURBT0ltcGwuZmluZE9uZ29pbmdQcm9tb3Rpb25zKCk7XG4gICAgICAgIG9uZ29pbmdQcm9tb3Rpb25zLmZvckVhY2goU3lzdGVtLm91dDo6cHJpbnRsbik7XG5cbiAgICAgICAgLy8gNi4gWMOzYSBraHV54bq/biBtw6NpIHRoZW8gbcOjXG4gICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIlxcbj09PSBYw7NhIGtodXnhur9uIG3Do2kgdGhlbyBtw6MgPT09XCIpO1xuICAgICAgICBib29sZWFuIGlzRGVsZXRlZCA9IGtodXllbk1haURBT0ltcGwuZGVsZXRlKFwiS00wMDAwMDFcIik7XG4gICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIljDs2Ega2h1eeG6v24gbcOjaTogXCIgKyAoaXNEZWxldGVkID8gXCJUaMOgbmggY8O0bmdcIiA6IFwiVGjhuqV0IGLhuqFpXCIpKTtcblxuICAgICAgICAvLyDEkMOzbmcgRW50aXR5TWFuYWdlciB2w6AgRW50aXR5TWFuYWdlckZhY3RvcnlcbiAgICAgICAgZW0uY2xvc2UoKTtcbiAgICAgICAgZW1mLmNsb3NlKCk7XG4gICAgfVxufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2Rhby9pbXBsL0todXllbk1haURBT0ltcGwuamF2YVxuLi4uXG5cbkBBbGxBcmdzQ29uc3RydWN0b3JcbnB1YmxpYyBjbGFzcyBLaHV5ZW5NYWlEQU9JbXBsIHtcblxuICAgIHByaXZhdGUgRW50aXR5TWFuYWdlciBlbTtcbiAgICBwdWJsaWMgS2h1eWVuTWFpREFPSW1wbCgpIHtcbiAgICAgICAgdGhpcy5lbSA9IEpQQVV0aWwuZ2V0RW50aXR5TWFuYWdlcigpOztcbiAgICB9XG4gICAgLy8gTOG6pXkgZGFuaCBzw6FjaCB04bqldCBj4bqjIGPDoWMga2h1eeG6v24gbcOjaVxuICAgIHB1YmxpYyBMaXN0PEtodXllbk1haT4gZmluZEFsbCgpIHtcbiAgICAgICAgU3RyaW5nIHF1ZXJ5ID0gXCJzZWxlY3Qga20gZnJvbSBLaHV5ZW5NYWkga21cIjtcbiAgICAgICAgcmV0dXJuIGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5LCBLaHV5ZW5NYWkuY2xhc3MpLmdldFJlc3VsdExpc3QoKTtcbiAgICB9XG5cbiAgICAvLyBM4bqleSBkYW5oIHPDoWNoIGtodXnhur9uIG3Do2kgdGhlbyB0w6puXG4gICAgcHVibGljIExpc3Q8S2h1eWVuTWFpPiBmaW5kQnlOYW1lKFN0cmluZyBuYW1lKSB7XG4gICAgICAgIFN0cmluZyBxdWVyeSA9IFwic2VsZWN0IGttIGZyb20gS2h1eWVuTWFpIGttIHdoZXJlIGttLnRlbktNIGxpa2UgOm5hbWVcIjtcbiAgICAgICAgcmV0dXJuIGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5LCBLaHV5ZW5NYWkuY2xhc3MpXG4gICAgICAgICAgICAgICAgLnNldFBhcmFtZXRlcihcIm5hbWVcIiwgXCIlXCIgKyBuYW1lICsgXCIlXCIpXG4gICAgICAgICAgICAgICAgLmdldFJlc3VsdExpc3QoKTtcbiAgICB9XG5cbiAgICAvLyBM4bqleSBraHV54bq/biBtw6NpIHRoZW8gbcOjXG4gICAgcHVibGljIEtodXllbk1haSBmaW5kQnlJZChTdHJpbmcgaWQpIHtcbiAgICAgICAgcmV0dXJuIGVtLmZpbmQoS2h1eWVuTWFpLmNsYXNzLCBpZCk7XG4gICAgfVxuXG4gICAgLy8gVGjDqm0gaG/hurdjIGPhuq1wIG5o4bqtdCBraHV54bq/biBtw6NpXG4gICAgcHVibGljIGJvb2xlYW4gc2F2ZShLaHV5ZW5NYWkga2h1eWVuTWFpKSB7XG4gICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRyLmJlZ2luKCk7XG4gICAgICAgICAgICBpZiAoZW0uZmluZChLaHV5ZW5NYWkuY2xhc3MsIGtodXllbk1haS5nZXRNYUtNKCkpID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBlbS5wZXJzaXN0KGtodXllbk1haSk7IC8vIFRow6ptIG3hu5tpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGVtLm1lcmdlKGtodXllbk1haSk7IC8vIEPhuq1wIG5o4bqtdFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdHIuY29tbWl0KCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGV4KSB7XG4gICAgICAgICAgICBleC5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgIHRyLnJvbGxiYWNrKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIFjDs2Ega2h1eeG6v24gbcOjaSB0aGVvIG3Do1xuICAgIHB1YmxpYyBib29sZWFuIGRlbGV0ZShTdHJpbmcgaWQpIHtcbiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHIgPSBlbS5nZXRUcmFuc2FjdGlvbigpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdHIuYmVnaW4oKTtcbiAgICAgICAgICAgIEtodXllbk1haSBrbSA9IGVtLmZpbmQoS2h1eWVuTWFpLmNsYXNzLCBpZCk7XG4gICAgICAgICAgICBpZiAoa20gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGVtLnJlbW92ZShrbSk7XG4gICAgICAgICAgICAgICAgdHIuY29tbWl0KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBleCkge1xuICAgICAgICAgICAgZXgucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgICAgICB0ci5yb2xsYmFjaygpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLy8gVMOsbSBjw6FjIGtodXnhur9uIG3Do2kgxJFhbmcgw6FwIGThu6VuZ1xuICAgIHB1YmxpYyBMaXN0PEtodXllbk1haT4gZmluZE9uZ29pbmdQcm9tb3Rpb25zKCkge1xuICAgICAgICBTdHJpbmcgcXVlcnkgPSBcInNlbGVjdCBrbSBmcm9tIEtodXllbk1haSBrbSBcIiArXG4gICAgICAgICAgICAgICAgXCJ3aGVyZSBrbS50cmFuZ1RoYWkgPSA6dHJhbmdUaGFpIFwiICtcbiAgICAgICAgICAgICAgICBcImFuZCBrbS50aG9pR2lhbkJhdERhdSA8PSA6dG9kYXkgXCIgK1xuICAgICAgICAgICAgICAgIFwiYW5kIGttLnRob2lHaWFuS2V0VGh1YyA+PSA6dG9kYXlcIjtcblxuICAgICAgICByZXR1cm4gZW0uY3JlYXRlUXVlcnkocXVlcnksIEtodXllbk1haS5jbGFzcylcbiAgICAgICAgICAgICAgICAuc2V0UGFyYW1ldGVyKFwidHJhbmdUaGFpXCIsIFwixJBhbmcgZGnhu4VuIHJhXCIpXG4gICAgICAgICAgICAgICAgLnNldFBhcmFtZXRlcihcInRvZGF5XCIsIExvY2FsRGF0ZS5ub3coKSlcbiAgICAgICAgICAgICAgICAuZ2V0UmVzdWx0TGlzdCgpO1xuICAgIH1cblxufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL1J1bm5lci5qYXZhXG4uLi5cblxucHVibGljIGNsYXNzIFJ1bm5lciB7XG4gICAgcHVibGljIHN0YXRpYyB2b2lkIG1haW4oU3RyaW5nW10gYXJncyl0aHJvd3MgUmVtb3RlRXhjZXB0aW9uIHtcblxuICAgICAgICAvLyBLaOG7n2kgdOG6oW8gRW50aXR5TWFuYWdlciB2w6AgRW50aXR5VHJhbnNhY3Rpb24gxJHhu4MgdMawxqFuZyB0w6FjIHbhu5tpIGPGoSBz4bufIGThu68gbGnhu4d1XG4gICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBQZXJzaXN0ZW5jZS5jcmVhdGVFbnRpdHlNYW5hZ2VyRmFjdG9yeShcIm1hcmlhZGJcIilcbiAgICAgICAgICAgICAgICAuY3JlYXRlRW50aXR5TWFuYWdlcigpO1xuICAgICAgICBLaHV5ZW5NYWlERi5nZW5lcmF0ZUFuZFByaW50U2FtcGxlRGF0YShlbSk7XG4gICAgICAgIExvYWlUb2FERi5nZW5lcmF0ZVNhbXBsZURhdGEoZW0pO1xuICAgICAgICBUdXllblRhdURGLmdlbmVyYXRlU2FtcGxlRGF0YShlbSk7XG4gICAgICAgIFRhdURGLmdlbmVyYXRlU2FtcGxlRGF0YShlbSk7XG4gICAgICAgIFRvYVRhdURGLmdlbmVyYXRlU2FtcGxlRGF0YShlbSk7XG4gICAgICAgIExvYWlDaG9ERi5nZW5lcmF0ZVNhbXBsZURhdGEoZW0pO1xuXG4gICAgICAgIEtoYWNoSGFuZ0RGIGtoYWNoSGFuZ0RGID0gbmV3IEtoYWNoSGFuZ0RGKCk7XG4gICAgICAgIGtoYWNoSGFuZ0RGLmdlbmVyYXRlQW5kUHJpbnRTYW1wbGVEYXRhKCk7XG5cbiAgICAgICAgTG9haUhvYURvbkRGIGZha2VyID0gbmV3IExvYWlIb2FEb25ERigpO1xuICAgICAgICBmYWtlci5nZW5lcmF0ZUFuZFNhdmVMb2FpSG9hRG9ucyhlbSk7XG5cbiAgICAgICAgSG9hRG9uREYgaG9hRG9uRmFrZXIgPSBuZXcgSG9hRG9uREYoZW0pO1xuICAgICAgICBob2FEb25GYWtlci5nZW5lcmF0ZUhvYURvbkRhdGEoNTApOyAvLyBU4bqhbyAyMCBow7NhIMSRxqFuXG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvbW9kZWwvRG9pVHVvbmdBcER1bmcuamF2YVxucGFja2FnZSBtb2RlbDtcblxucHVibGljIGVudW0gRG9pVHVvbmdBcER1bmcge1xufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL21vZGVsL0xvYWlIb2FEb24uamF2YVxucGFja2FnZSBtb2RlbDtcblxuXG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS4qO1xuaW1wb3J0IGxvbWJvay5EYXRhO1xuaW1wb3J0IGxvbWJvay5FcXVhbHNBbmRIYXNoQ29kZTtcbmltcG9ydCBsb21ib2suVG9TdHJpbmc7XG5cbmltcG9ydCBqYXZhLmlvLlNlcmlhbGl6YWJsZTtcbmltcG9ydCBqYXZhLnV0aWwuU2V0O1xuXG5ARGF0YVxuQEVxdWFsc0FuZEhhc2hDb2RlKG9ubHlFeHBsaWNpdGx5SW5jbHVkZWQgPSB0cnVlKVxuQEVudGl0eVxuQFRhYmxlKG5hbWUgPSBcImxvYWlob2Fkb25cIilcbkBUb1N0cmluZ1xucHVibGljIGNsYXNzIExvYWlIb2FEb24gaW1wbGVtZW50cyBTZXJpYWxpemFibGUge1xuICAgIEBJZFxuICAgIEBDb2x1bW4obmFtZSA9IFwibWFfbG9haV9oZFwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJ2YXJjaGFyKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSwgdW5pcXVlID0gdHJ1ZSlcbiAgICBARXF1YWxzQW5kSGFzaENvZGUuSW5jbHVkZVxuICAgIHByaXZhdGUgU3RyaW5nIG1hTG9haUhvYURvbjtcbiAgICBAQ29sdW1uKG5hbWUgPSBcInRlbl9sb2FpX2hkXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcIk5WQVJDSEFSKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIFN0cmluZyB0ZW5Mb2FpSG9hRG9uO1xuXG4gICAgQE9uZVRvTWFueShtYXBwZWRCeSA9IFwibG9haUhvYURvblwiKVxuICAgIEBUb1N0cmluZy5FeGNsdWRlXG4gICAgcHJpdmF0ZSBTZXQ8SG9hRG9uPiBob2FEb25zO1xuXG5cblxuXG59XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvbW9kZWwvVHJhbmdUaGFpS00uamF2YVxucGFja2FnZSBtb2RlbDtcblxucHVibGljIGVudW0gVHJhbmdUaGFpS00ge1xufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2Rhby9Mb2FpS2hhY2hIYW5nREFPLmphdmFcbnBhY2thZ2UgZGFvO1xuXG5pbXBvcnQgbW9kZWwuTG9haUtoYWNoSGFuZztcblxuaW1wb3J0IGphdmEucm1pLlJlbW90ZTtcbmltcG9ydCBqYXZhLnJtaS5SZW1vdGVFeGNlcHRpb247XG5pbXBvcnQgamF2YS51dGlsLkxpc3Q7XG5cbi8qKlxuICogQEThu7Egw6FuOiBQaGFuVGFuSmF2YU5ob21HUFRcbiAqIEBDbGFzczogTG9haUtoYWNoSGFuZ0RBT1xuICogQFThuqFvIHbDoG8gbmfDoHk6IDE4LzA0LzIwMjVcbiAqIEBUw6FjIGdp4bqjOiBOZ3V5ZW4gSHV1IFNhbmdcbiAqL1xucHVibGljIGludGVyZmFjZSBMb2FpS2hhY2hIYW5nREFPIGV4dGVuZHMgUmVtb3RlIHtcbiAgICBMaXN0PExvYWlLaGFjaEhhbmc+IGdldEFsbCgpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG4gICAgTG9haUtoYWNoSGFuZyBmaW5kQnlJZChTdHJpbmcgaWQpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG4gICAgYm9vbGVhbiBzYXZlKExvYWlLaGFjaEhhbmcgbG9haUtoYWNoSGFuZykgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcbiAgICBib29sZWFuIHVwZGF0ZShMb2FpS2hhY2hIYW5nIGxvYWlLaGFjaEhhbmcpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG4gICAgYm9vbGVhbiBkZWxldGUoU3RyaW5nIGlkKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuXG4vLyAgICAgTGlzdDxMb2FpS2hhY2hIYW5nPiBnZXRBbGxMaXN0KCk7XG59Li4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2RhdGFmYWtlci9Mb2FpQ2hvREYuamF2YVxuLi4uXG5cbnB1YmxpYyBjbGFzcyBMb2FpQ2hvREYge1xuICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBnZW5lcmF0ZVNhbXBsZURhdGEoRW50aXR5TWFuYWdlciBlbSkge1xuICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0eCA9IGVtLmdldFRyYW5zYWN0aW9uKCk7XG4gICAgICAgIEZha2VyIGZha2VyID0gbmV3IEZha2VyKCk7XG5cbiAgICAgICAgLy8gc2V0IGThu68gbGnhu4d1IGNobyBMb2FpQ2hvXG4gICAgICAgIExvYWlDaG8gbGMxID0gbmV3IExvYWlDaG8oKTtcbiAgICAgICAgbGMxLnNldE1hTG9haShcIkxDMDFcIik7XG4gICAgICAgIGxjMS5zZXRUZW5Mb2FpKFwiR2jhur8gbmfhu5NpIGPhu6luZ1wiKTtcblxuICAgICAgICBMb2FpQ2hvIGxjMiA9IG5ldyBMb2FpQ2hvKCk7XG4gICAgICAgIGxjMi5zZXRNYUxvYWkoXCJMQzAyXCIpO1xuICAgICAgICBsYzIuc2V0VGVuTG9haShcIkdo4bq/IG5n4buTaSBt4buBbVwiKTtcblxuICAgICAgICBMb2FpQ2hvIGxjMyA9IG5ldyBMb2FpQ2hvKCk7XG4gICAgICAgIGxjMy5zZXRNYUxvYWkoXCJMQzAzXCIpO1xuICAgICAgICBsYzMuc2V0VGVuTG9haShcIkdpxrDhu51uZyBu4bqxbSBt4buBbVwiKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHR4LmJlZ2luKCk7XG4gICAgICAgICAgICBlbS5wZXJzaXN0KGxjMSk7XG4gICAgICAgICAgICBlbS5wZXJzaXN0KGxjMik7XG4gICAgICAgICAgICBlbS5wZXJzaXN0KGxjMyk7XG4gICAgICAgICAgICB0eC5jb21taXQoKTtcbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIlBow6F0IHNpbmggZOG7ryBsaeG7h3UgdGjDoG5oIGPDtG5nIGNobyBMb2FpQ2hvXCIpO1xuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgdHgucm9sbGJhY2soKTtcbiAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihcIlBow6F0IHNpbmggZOG7ryBsaeG7h3UgdGjhuqV0IGLhuqFpIGNobyBMb2FpQ2hvXCIpO1xuXG4gICAgICAgIH1cbiAgICB9XG59XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvbW9kZWwvVHJhbmdUaGFpLmphdmFcbnBhY2thZ2UgbW9kZWw7XG5cbnB1YmxpYyBlbnVtIFRyYW5nVGhhaSB7XG4gICAgREFfS0hPSV9IQU5IKFwixJDDoyBraOG7n2kgaMOgbmhcIiksXG4gICAgQ0hVQV9LSE9JX0hBTkgoXCJDaMawYSBraOG7n2kgaMOgbmhcIiksXG4gICAgREFfSFVZKFwixJDDoyBo4buneVwiKSxcbiAgICBIT0FUX0RPTkcoXCJIb+G6oXQgxJHhu5luZ1wiKTtcblxuICAgIHByaXZhdGUgZmluYWwgU3RyaW5nIHZhbHVlO1xuXG4gICAgVHJhbmdUaGFpKFN0cmluZyB2YWx1ZSkge1xuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgfVxuXG4gICAgcHVibGljIFN0cmluZyBnZXRWYWx1ZSgpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgVHJhbmdUaGFpIGZyb21WYWx1ZShTdHJpbmcgdmFsdWUpIHtcbiAgICAgICAgZm9yIChUcmFuZ1RoYWkgc3RhdHVzIDogVHJhbmdUaGFpLnZhbHVlcygpKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzLnZhbHVlLmVxdWFscyh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RhdHVzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oXCJObyBlbnVtIGNvbnN0YW50IGZvciB2YWx1ZTogXCIgKyB2YWx1ZSk7XG4gICAgfVxufS4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9tb2RlbC9UcmFuZ1RoYWlWZVRhdS5qYXZhXG5wYWNrYWdlIG1vZGVsO1xuXG5wdWJsaWMgZW51bSBUcmFuZ1RoYWlWZVRhdSB7XG4gICAgQ0hPX1hBQ19OSEFOKFwiQ2jhu50geMOhYyBuaOG6rW5cIiksXG4gICAgREFfVEhBTkhfVE9BTihcIsSQw6MgdGhhbmggdG/DoW5cIiksXG4gICAgREFfRE9JKFwixJDDoyDEkeG7lWlcIiksXG4gICAgREFfVFJBKFwixJDDoyB0cuG6o1wiKTtcblxuICAgIHByaXZhdGUgZmluYWwgU3RyaW5nIHZhbHVlO1xuXG4gICAgVHJhbmdUaGFpVmVUYXUoU3RyaW5nIHZhbHVlKSB7XG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgU3RyaW5nIGdldFZhbHVlKCkge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBUcmFuZ1RoYWlWZVRhdSBmcm9tVmFsdWUoU3RyaW5nIHZhbHVlKSB7XG4gICAgICAgIGZvciAoVHJhbmdUaGFpVmVUYXUgc3RhdHVzIDogVHJhbmdUaGFpVmVUYXUudmFsdWVzKCkpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMudmFsdWUuZXF1YWxzKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzdGF0dXM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbihcIk5vIGVudW0gY29uc3RhbnQgZm9yIHZhbHVlOiBcIiArIHZhbHVlKTtcbiAgICB9XG59Li4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2Rhby9Mb2FpSG9hRG9uREFPLmphdmFcbnBhY2thZ2UgZGFvO1xuXG5pbXBvcnQgbW9kZWwuTG9haUhvYURvbjtcblxuaW1wb3J0IGphdmEucm1pLlJlbW90ZTtcblxucHVibGljIGludGVyZmFjZSBMb2FpSG9hRG9uREFPIGV4dGVuZHMgUmVtb3RlIHtcbiAgICBMb2FpSG9hRG9uIGZpbmRCeUlkKFN0cmluZyBpZCkgdGhyb3dzIEV4Y2VwdGlvbjtcbn1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9kYXRhZmFrZXIvTG9haUhvYURvbkRGLmphdmFcbi4uLlxuXG4gICAgcHVibGljIHZvaWQgZ2VuZXJhdGVBbmRTYXZlTG9haUhvYURvbnMoRW50aXR5TWFuYWdlciBlbSkge1xuICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0cmFuc2FjdGlvbiA9IGVtLmdldFRyYW5zYWN0aW9uKCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0cmFuc2FjdGlvbi5iZWdpbigpO1xuXG4gICAgICAgICAgICAvLyBUaMOqbSAzIGxv4bqhaSBow7NhIMSRxqFuOiBNdWEsIMSQ4buVaSwgVHLhuqNcbiAgICAgICAgICAgIGVtLnBlcnNpc3QoZ2VuZXJhdGVMb2FpSG9hRG9uKFwiTEhEMDAxXCIsIFwiTXVhXCIpKTtcbiAgICAgICAgICAgIGVtLnBlcnNpc3QoZ2VuZXJhdGVMb2FpSG9hRG9uKFwiTEhEMDAyXCIsIFwixJDhu5VpXCIpKTtcbiAgICAgICAgICAgIGVtLnBlcnNpc3QoZ2VuZXJhdGVMb2FpSG9hRG9uKFwiTEhEMDAzXCIsIFwiVHLhuqNcIikpO1xuXG4gICAgICAgICAgICB0cmFuc2FjdGlvbi5jb21taXQoKTtcbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIlRow6ptIGThu68gbGnhu4d1IG3huqt1IGNobyBMb2FpSG9hRG9uIHRow6BuaCBjw7RuZyFcIik7XG4gICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICB0cmFuc2FjdGlvbi5yb2xsYmFjaygpO1xuICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihcIkzhu5dpIGtoaSB0aMOqbSBk4buvIGxp4buHdSBt4bqrdSBjaG8gTG9haUhvYURvbiFcIik7XG4gICAgICAgIH1cbiAgICB9XG59XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGFvL2ltcGwvTGljaFRyaW5oVGF1REFPSW1wbC5qYXZhXG4uLi5cblxuICAgIEBPdmVycmlkZVxuICAgIHB1YmxpYyBMaXN0PFRyYW5nVGhhaT4gZ2V0VHJhbmdUaGFpKCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcbiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHggPSBlbS5nZXRUcmFuc2FjdGlvbigpO1xuICAgICAgICBMaXN0PFRyYW5nVGhhaT4gdHJhbmdUaGFpTGlzdCA9IG5ldyBBcnJheUxpc3Q8PigpO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0eC5iZWdpbigpO1xuXG4gICAgICAgICAgICAvLyBT4butIGThu6VuZyBuYXRpdmUgcXVlcnkgxJHhu4MgbOG6pXkgY8OhYyBnacOhIHRy4buLIGNodeG7l2kgdOG7qyBEQlxuICAgICAgICAgICAgUXVlcnkgcXVlcnkgPSBlbS5jcmVhdGVOYXRpdmVRdWVyeShcIlNFTEVDVCBESVNUSU5DVCB0cmFuZ190aGFpIEZST00gbGljaHRyaW5odGF1IE9SREVSIEJZIHRyYW5nX3RoYWlcIik7XG4gICAgICAgICAgICBMaXN0PFN0cmluZz4gcmVzdWx0ID0gcXVlcnkuZ2V0UmVzdWx0TGlzdCgpO1xuXG4gICAgICAgICAgICAvLyBUaMOqbSBjw6FjIGdpw6EgdHLhu4sgbeG6t2MgxJHhu4tuaFxuICAgICAgICAgICAgdHJhbmdUaGFpTGlzdC5hZGQoVHJhbmdUaGFpLkRBX0tIT0lfSEFOSCk7XG4gICAgICAgICAgICB0cmFuZ1RoYWlMaXN0LmFkZChUcmFuZ1RoYWkuQ0hVQV9LSE9JX0hBTkgpO1xuICAgICAgICAgICAgdHJhbmdUaGFpTGlzdC5hZGQoVHJhbmdUaGFpLkRBX0hVWSk7XG4gICAgICAgICAgICB0cmFuZ1RoYWlMaXN0LmFkZChUcmFuZ1RoYWkuSE9BVF9ET05HKTsgLy8gVGjDqm0gZ2nDoSB0cuG7iyBuw6B5XG4uLi5cbiAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihcIkzhu5dpIGtoaSBs4bqleSBkYW5oIHPDoWNoIHRy4bqhbmcgdGjDoWk6IFwiICsgZS5nZXRNZXNzYWdlKCkpO1xuICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcblxuICAgICAgICAgICAgLy8gxJDhuqNtIGLhuqNvIGx1w7RuIHRy4bqjIHbhu4Egw610IG5o4bqldCBt4buZdCBz4buRIHRy4bqhbmcgdGjDoWkgY8ahIGLhuqNuXG4gICAgICAgICAgICB0cmFuZ1RoYWlMaXN0LmNsZWFyKCk7XG4gICAgICAgICAgICB0cmFuZ1RoYWlMaXN0LmFkZChUcmFuZ1RoYWkuREFfS0hPSV9IQU5IKTtcbiAgICAgICAgICAgIHRyYW5nVGhhaUxpc3QuYWRkKFRyYW5nVGhhaS5DSFVBX0tIT0lfSEFOSCk7XG4gICAgICAgICAgICB0cmFuZ1RoYWlMaXN0LmFkZChUcmFuZ1RoYWkuREFfSFVZKTtcbiAgICAgICAgICAgIHRyYW5nVGhhaUxpc3QuYWRkKFRyYW5nVGhhaS5IT0FUX0RPTkcpO1xuICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgaWYgKGVtICE9IG51bGwgJiYgZW0uaXNPcGVuKCkpIHtcbiAgICAgICAgICAgICAgICBlbS5jbG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRyYW5nVGhhaUxpc3Q7XG4gICAgfVxuICAgIEBPdmVycmlkZVxuICAgIHB1YmxpYyBMaXN0PExpY2hUcmluaFRhdT4gZ2V0TGlzdExpY2hUcmluaFRhdUJ5RGF0ZVJhbmdlKExvY2FsRGF0ZSBzdGFydERhdGUsIExvY2FsRGF0ZSBlbmREYXRlKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uIHtcbiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IEpQQVV0aWwuZ2V0RW50aXR5TWFuYWdlcigpO1xuICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0eCA9IGVtLmdldFRyYW5zYWN0aW9uKCk7XG4gICAgICAgIExpc3Q8TGljaFRyaW5oVGF1PiByZXN1bHQgPSBuZXcgQXJyYXlMaXN0PD4oKTtcbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9kYW8vVHV5ZW5UYXVEQU8uamF2YVxucGFja2FnZSBkYW87XG5cbmltcG9ydCBtb2RlbC5UdXllblRhdTtcblxuaW1wb3J0IGphdmEucm1pLlJlbW90ZTtcbmltcG9ydCBqYXZhLnJtaS5SZW1vdGVFeGNlcHRpb247XG5pbXBvcnQgamF2YS51dGlsLkxpc3Q7XG5cbnB1YmxpYyBpbnRlcmZhY2UgVHV5ZW5UYXVEQU8gZXh0ZW5kcyBSZW1vdGUge1xuICAgIExpc3Q8VHV5ZW5UYXU+IGdldExpc3RUdXllblRhdUJ5R2FEaUdhRGVuKFN0cmluZyBnYURpLCBTdHJpbmcgZ2FEZW4pIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG4gICAgTGlzdDxUdXllblRhdT4gZ2V0TGlzdFR1eWVuVGF1KCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcbiAgICBUdXllblRhdSBnZXRUdXllblRhdUJ5SWQoU3RyaW5nIGlkKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuICAgIGJvb2xlYW4gc2F2ZShUdXllblRhdSB0dXllblRhdSkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcbiAgICBib29sZWFuIGRlbGV0ZShTdHJpbmcgaWQpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG4gICAgYm9vbGVhbiB1cGRhdGUoVHV5ZW5UYXUgdHV5ZW5UYXUpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG59XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGF0YWZha2VyL1R1eWVuVGF1REYuamF2YVxuLi4uXG5cbiAgICAgICAgICAgIC8vIFThuqFvIDEwIGThu68gbGnhu4d1IG3huqt1IGNobyBUdXllblRhdVxuICAgICAgICAgICAgZm9yIChpbnQgaSA9IDE7IGkgPD0gMTA7IGkrKykge1xuICAgICAgICAgICAgICAgIFR1eWVuVGF1IHR1eWVuVGF1ID0gbmV3IFR1eWVuVGF1KCk7XG4gICAgICAgICAgICAgICAgdHV5ZW5UYXUuc2V0TWFUdXllbihcIlRUXCIgKyBpKTsgLy8gTcOjIHR1eeG6v24gxJHhu4tuaCBk4bqhbmcgVFQxLCBUVDIsIC4uLlxuICAgICAgICAgICAgICAgIHR1eWVuVGF1LnNldFRlblR1eWVuKFwiVHV54bq/biBcIiArIGZha2VyLmFkZHJlc3MoKS5jaXR5TmFtZSgpICsgXCIgLSBcIiArIGZha2VyLmFkZHJlc3MoKS5jaXR5TmFtZSgpKTsgLy8gVMOqbiB0dXnhur9uIHbhu5tpIHRow6BuaCBwaOG7kSBuZ+G6q3Ugbmhpw6puXG4gICAgICAgICAgICAgICAgdHV5ZW5UYXUuc2V0R2FEaShmYWtlci5hZGRyZXNzKCkuc3RyZWV0TmFtZSgpKTsgLy8gR2EgxJFpIG5n4bqrdSBuaGnDqm5cbiAgICAgICAgICAgICAgICB0dXllblRhdS5zZXRHYURlbihmYWtlci5hZGRyZXNzKCkuc3RyZWV0TmFtZSgpKTsgLy8gR2EgxJHhur9uIG5n4bqrdSBuaGnDqm5cbiAgICAgICAgICAgICAgICB0dXllblRhdS5zZXREaWFEaWVtRGkoZmFrZXIuYWRkcmVzcygpLmNpdHlOYW1lKCkgKyBcIiwgXCIgKyBmYWtlci5hZGRyZXNzKCkuY291bnRyeSgpKTsgLy8gxJDhu4thIMSRaeG7g20gxJFpICh0aMOgbmggcGjhu5EsIHF14buRYyBnaWEpXG4gICAgICAgICAgICAgICAgdHV5ZW5UYXUuc2V0RGlhRGllbURlbihmYWtlci5hZGRyZXNzKCkuY2l0eU5hbWUoKSArIFwiLCBcIiArIGZha2VyLmFkZHJlc3MoKS5jb3VudHJ5KCkpOyAvLyDEkOG7i2EgxJFp4buDbSDEkeG6v24gKHRow6BuaCBwaOG7kSwgcXXhu5FjIGdpYSlcblxuICAgICAgICAgICAgICAgIC8vIEzGsHUgxJHhu5FpIHTGsOG7o25nIFR1eWVuVGF1IHbDoG8gY8ahIHPhu58gZOG7ryBsaeG7h3VcbiAgICAgICAgICAgICAgICBlbS5wZXJzaXN0KHR1eWVuVGF1KTtcbiAgICAgICAgICAgIH1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9kYW8vRG9pVmVEQU8uamF2YVxuLi4uXG5cbnB1YmxpYyBpbnRlcmZhY2UgRG9pVmVEQU8gZXh0ZW5kcyBSZW1vdGUge1xuICAgIFZlVGF1IGdldFZlVGF1KFN0cmluZyBpZCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcbiAgICBib29sZWFuIGRvaVZlKFZlVGF1IHZlVGF1KSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuICAgIExpc3Q8VmVUYXU+IGdldFZlVGF1QnlUcmFuZ1RoYWkoVHJhbmdUaGFpVmVUYXUgdHJhbmdUaGFpKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuICAgIGJvb2xlYW4gdGVzdENvbm5lY3Rpb24oKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuICAgIExpc3Q8VHJhbmdUaGFpVmVUYXU+IGdldEFsbFRyYW5nVGhhaVZlKCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcblxuICAgIC8vIFRow6ptIGNo4bupYyBuxINuZyBt4bubaVxuICAgIGJvb2xlYW4gZGF0VmUoVmVUYXUgdmVUYXUsIFN0cmluZyBjaG9OZ29pSWQpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG4gICAgYm9vbGVhbiBodXlWZShTdHJpbmcgbWFWZSkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcbiAgICBib29sZWFuIHRoYW5oVG9hblZlKFN0cmluZyBtYVZlKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuICAgIGJvb2xlYW4gY2FwTmhhdFRyYW5nVGhhaVZlKFN0cmluZyBtYVZlLCBUcmFuZ1RoYWlWZVRhdSB0cmFuZ1RoYWkpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG4gICAgS2hhY2hIYW5nIGdldEtoYWNoSGFuZ0J5TWFWZShTdHJpbmcgbWFWZSkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcbn0uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGF0YWZha2VyL0xvYWlUb2FERi5qYXZhXG4uLi5cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdHJhbnNhY3Rpb24uYmVnaW4oKTtcblxuICAgICAgICAgICAgLy8gVOG6oW8gMTAgZOG7ryBsaeG7h3UgbeG6q3UgY2hvIExvYWlUb2FcbiAgICAgICAgICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IDEwOyBpKyspIHtcbiAgICAgICAgICAgICAgICBMb2FpVG9hIGxvYWlUb2EgPSBuZXcgTG9haVRvYSgpO1xuICAgICAgICAgICAgICAgIGxvYWlUb2Euc2V0TWFMb2FpKFwiTFRcIiArIGkpOyAvLyDEkOG6t3QgbcOjIGxv4bqhaSDEkeG7i25oIGThuqFuZyBMVDEsIExUMiwgLi4uXG4gICAgICAgICAgICAgICAgbG9haVRvYS5zZXRUZW5Mb2FpKFwiTG/huqFpIHRvYSBcIiArIGZha2VyLmNvbW1lcmNlKCkucHJvZHVjdE5hbWUoKSk7IC8vIFTDqm4gbG/huqFpIHbhu5tpIG3DtCB04bqjIHThu6sgRmFrZXJcbiAgICAgICAgICAgICAgICAvLyBMxrB1IHbDoG8gY8ahIHPhu58gZOG7ryBsaeG7h3VcbiAgICAgICAgICAgICAgICBlbS5wZXJzaXN0KGxvYWlUb2EpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0cmFuc2FjdGlvbi5jb21taXQoKTtcbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIkThu68gbGnhu4d1IG3huqt1IGNobyBMb2FpVG9hIMSRw6MgxJHGsOG7o2MgdOG6oW8gdGjDoG5oIGPDtG5nLlwiKTtcbiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgIGlmICh0cmFuc2FjdGlvbi5pc0FjdGl2ZSgpKSB7XG4gICAgICAgICAgICAgICAgdHJhbnNhY3Rpb24ucm9sbGJhY2soKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCLEkMOjIHjhuqN5IHJhIGzhu5dpIGtoaSB04bqhbyBk4buvIGxp4buHdSBt4bqrdSBjaG8gTG9haVRvYS5cIik7XG4gICAgICAgIH1cbiAgICB9XG59XG4uLi5cblBhdGg6Li4uIiwiaXNfZXJyb3IiOmZhbHNlLCJyZXF1ZXN0X2lkIjoiIiwidG9vbF91c2VfaWQiOiJ0b29sdV8wMUdTbXJUU0VTWWlqWjNTZVVSdWlnNjgifX0seyJpZCI6MiwidHlwZSI6NCwiaWRlX3N0YXRlX25vZGUiOnsid29ya3NwYWNlRm9sZGVycyI6W3sicmVwb3NpdG9yeVJvb3QiOiJFOi9MVFBUSkFWQS9OaG9tL1BoYW5UYW5KYXZhTmhvbUdQVC9Qcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyIsImZvbGRlclJvb3QiOiJFOi9MVFBUSkFWQS9OaG9tL1BoYW5UYW5KYXZhTmhvbUdQVC9Qcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyJ9XSwid29ya3NwYWNlRm9sZGVyc1VuY2hhbmdlZCI6ZmFsc2V9fV0sInJlc3BvbnNlX3RleHQiOiJOb3cgSSdsbCBjaGVjayBpZiB0aGVyZSdzIGEgS2h1eWVuTWFpREFPIGludGVyZmFjZTpcbiIsIndvcmtzcGFjZV9maWxlX2NodW5rcyI6W119LHsic3RhdHVzIjoic3VjY2VzcyIsInJlcXVlc3RfaWQiOiIxNWIyMzdlNy1hZjEwLTRiZjEtOGZhYi1lZGU0Y2E1OThkNzEiLCJyZXF1ZXN0X21lc3NhZ2UiOiIiLCJzdHJ1Y3R1cmVkX291dHB1dF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjUsImNvbnRlbnQiOiIiLCJ0b29sX3VzZSI6eyJ0b29sX3VzZV9pZCI6InRvb2x1XzAxVFB6OFFCWTNvU2V0ZWJmOWJjalJvciIsInRvb2xfbmFtZSI6ImNvZGViYXNlLXJldHJpZXZhbCIsImlucHV0X2pzb24iOiJ7XCJpbmZvcm1hdGlvbl9yZXF1ZXN0XCI6IFwiRmluZCB0aGUgTWFpbkdVSSBjbGFzcyB0byB1bmRlcnN0YW5kIGhvdyBwYW5lbHMgYXJlIGludGVncmF0ZWQsIGFuZCBjaGVjayBpZiB0aGVyZSdzIGFueSBleGlzdGluZyBjb2RlIGZvciBEb2lUdW9uZ0FwRHVuZyBlbnVtXCJ9In19LHsiaWQiOjAsInR5cGUiOjAsImNvbnRlbnQiOiJCYXNlZCBvbiBteSBhbmFseXNpcywgSSBuZWVkIHRvIGNyZWF0ZSBhIEtodXllbk1haURBTyBpbnRlcmZhY2UgYW5kIHVwZGF0ZSB0aGUgS2h1eWVuTWFpREFPSW1wbCB0byBpbXBsZW1lbnQgaXQuIExldCdzIGFsc28gY2hlY2sgdGhlIE1haW5HVUkgdG8gc2VlIGhvdyB0byBpbnRlZ3JhdGUgb3VyIG5ldyBwYW5lbDpcbiJ9LHsiaWQiOjIsInR5cGUiOjIsImNvbnRlbnQiOiIifSx7ImlkIjozLCJ0eXBlIjozLCJjb250ZW50IjoiIn1dLCJzZWVuX3N0YXRlIjoic2VlbiIsInN0cnVjdHVyZWRfcmVxdWVzdF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjEsInRvb2xfcmVzdWx0X25vZGUiOnsiY29udGVudCI6IlRoZSBmb2xsb3dpbmcgY29kZSBzZWN0aW9ucyB3ZXJlIHJldHJpZXZlZDpcblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGFvL2ltcGwvS2h1eWVuTWFpREFPSW1wbC5qYXZhXG4uLi5cblxuQEFsbEFyZ3NDb25zdHJ1Y3RvclxucHVibGljIGNsYXNzIEtodXllbk1haURBT0ltcGwge1xuXG4gICAgcHJpdmF0ZSBFbnRpdHlNYW5hZ2VyIGVtO1xuICAgIHB1YmxpYyBLaHV5ZW5NYWlEQU9JbXBsKCkge1xuICAgICAgICB0aGlzLmVtID0gSlBBVXRpbC5nZXRFbnRpdHlNYW5hZ2VyKCk7O1xuICAgIH1cbiAgICAvLyBM4bqleSBkYW5oIHPDoWNoIHThuqV0IGPhuqMgY8OhYyBraHV54bq/biBtw6NpXG4gICAgcHVibGljIExpc3Q8S2h1eWVuTWFpPiBmaW5kQWxsKCkge1xuICAgICAgICBTdHJpbmcgcXVlcnkgPSBcInNlbGVjdCBrbSBmcm9tIEtodXllbk1haSBrbVwiO1xuICAgICAgICByZXR1cm4gZW0uY3JlYXRlUXVlcnkocXVlcnksIEtodXllbk1haS5jbGFzcykuZ2V0UmVzdWx0TGlzdCgpO1xuICAgIH1cblxuICAgIC8vIEzhuqV5IGRhbmggc8OhY2gga2h1eeG6v24gbcOjaSB0aGVvIHTDqm5cbiAgICBwdWJsaWMgTGlzdDxLaHV5ZW5NYWk+IGZpbmRCeU5hbWUoU3RyaW5nIG5hbWUpIHtcbiAgICAgICAgU3RyaW5nIHF1ZXJ5ID0gXCJzZWxlY3Qga20gZnJvbSBLaHV5ZW5NYWkga20gd2hlcmUga20udGVuS00gbGlrZSA6bmFtZVwiO1xuICAgICAgICByZXR1cm4gZW0uY3JlYXRlUXVlcnkocXVlcnksIEtodXllbk1haS5jbGFzcylcbiAgICAgICAgICAgICAgICAuc2V0UGFyYW1ldGVyKFwibmFtZVwiLCBcIiVcIiArIG5hbWUgKyBcIiVcIilcbiAgICAgICAgICAgICAgICAuZ2V0UmVzdWx0TGlzdCgpO1xuICAgIH1cblxuICAgIC8vIEzhuqV5IGtodXnhur9uIG3Do2kgdGhlbyBtw6NcbiAgICBwdWJsaWMgS2h1eWVuTWFpIGZpbmRCeUlkKFN0cmluZyBpZCkge1xuICAgICAgICByZXR1cm4gZW0uZmluZChLaHV5ZW5NYWkuY2xhc3MsIGlkKTtcbiAgICB9XG5cbiAgICAvLyBUaMOqbSBob+G6t2MgY+G6rXAgbmjhuq10IGtodXnhur9uIG3Do2lcbiAgICBwdWJsaWMgYm9vbGVhbiBzYXZlKEtodXllbk1haSBraHV5ZW5NYWkpIHtcbiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHIgPSBlbS5nZXRUcmFuc2FjdGlvbigpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdHIuYmVnaW4oKTtcbiAgICAgICAgICAgIGlmIChlbS5maW5kKEtodXllbk1haS5jbGFzcywga2h1eWVuTWFpLmdldE1hS00oKSkgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGVtLnBlcnNpc3Qoa2h1eWVuTWFpKTsgLy8gVGjDqm0gbeG7m2lcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZW0ubWVyZ2Uoa2h1eWVuTWFpKTsgLy8gQ+G6rXAgbmjhuq10XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0ci5jb21taXQoKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZXgpIHtcbiAgICAgICAgICAgIGV4LnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgdHIucm9sbGJhY2soKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gWMOzYSBraHV54bq/biBtw6NpIHRoZW8gbcOjXG4gICAgcHVibGljIGJvb2xlYW4gZGVsZXRlKFN0cmluZyBpZCkge1xuICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0ciA9IGVtLmdldFRyYW5zYWN0aW9uKCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0ci5iZWdpbigpO1xuICAgICAgICAgICAgS2h1eWVuTWFpIGttID0gZW0uZmluZChLaHV5ZW5NYWkuY2xhc3MsIGlkKTtcbiAgICAgICAgICAgIGlmIChrbSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgZW0ucmVtb3ZlKGttKTtcbiAgICAgICAgICAgICAgICB0ci5jb21taXQoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGV4KSB7XG4gICAgICAgICAgICBleC5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgIHRyLnJvbGxiYWNrKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICAvLyBUw6xtIGPDoWMga2h1eeG6v24gbcOjaSDEkWFuZyDDoXAgZOG7pW5nXG4gICAgcHVibGljIExpc3Q8S2h1eWVuTWFpPiBmaW5kT25nb2luZ1Byb21vdGlvbnMoKSB7XG4gICAgICAgIFN0cmluZyBxdWVyeSA9IFwic2VsZWN0IGttIGZyb20gS2h1eWVuTWFpIGttIFwiICtcbiAgICAgICAgICAgICAgICBcIndoZXJlIGttLnRyYW5nVGhhaSA9IDp0cmFuZ1RoYWkgXCIgK1xuICAgICAgICAgICAgICAgIFwiYW5kIGttLnRob2lHaWFuQmF0RGF1IDw9IDp0b2RheSBcIiArXG4gICAgICAgICAgICAgICAgXCJhbmQga20udGhvaUdpYW5LZXRUaHVjID49IDp0b2RheVwiO1xuXG4gICAgICAgIHJldHVybiBlbS5jcmVhdGVRdWVyeShxdWVyeSwgS2h1eWVuTWFpLmNsYXNzKVxuICAgICAgICAgICAgICAgIC5zZXRQYXJhbWV0ZXIoXCJ0cmFuZ1RoYWlcIiwgXCLEkGFuZyBkaeG7hW4gcmFcIilcbiAgICAgICAgICAgICAgICAuc2V0UGFyYW1ldGVyKFwidG9kYXlcIiwgTG9jYWxEYXRlLm5vdygpKVxuICAgICAgICAgICAgICAgIC5nZXRSZXN1bHRMaXN0KCk7XG4gICAgfVxuXG59XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvdGVzdENSVUQvS2h1eWVuTWFpREFPVGVzdC5qYXZhXG5wYWNrYWdlIHRlc3RDUlVEO1xuXG5pbXBvcnQgZGFvLmltcGwuS2h1eWVuTWFpREFPSW1wbDtcbmltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXI7XG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS5FbnRpdHlNYW5hZ2VyRmFjdG9yeTtcbmltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLlBlcnNpc3RlbmNlO1xuaW1wb3J0IG1vZGVsLktodXllbk1haTtcblxuaW1wb3J0IGphdmEudGltZS5Mb2NhbERhdGU7XG5pbXBvcnQgamF2YS51dGlsLkxpc3Q7XG5cbnB1YmxpYyBjbGFzcyBLaHV5ZW5NYWlEQU9UZXN0IHtcblxuICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpIHtcbiAgICAgICAgLy8gVOG6oW8gRW50aXR5TWFuYWdlckZhY3RvcnkgdsOgIEVudGl0eU1hbmFnZXJcbiAgICAgICAgRW50aXR5TWFuYWdlckZhY3RvcnkgZW1mID0gUGVyc2lzdGVuY2UuY3JlYXRlRW50aXR5TWFuYWdlckZhY3RvcnkoXCJtYXJpYWRiXCIpO1xuICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTtcblxuICAgICAgICAvLyBU4bqhbyBpbnN0YW5jZSBj4bunYSBLaHV5ZW5NYWlEQU9cbiAgICAgICAgS2h1eWVuTWFpREFPSW1wbCBraHV5ZW5NYWlEQU9JbXBsID0gbmV3IEtodXllbk1haURBT0ltcGwoZW0pO1xuLi4uXG5cbiAgICAgICAgLy8gMi4gTOG6pXkgZGFuaCBzw6FjaCB04bqldCBj4bqjIGPDoWMga2h1eeG6v24gbcOjaVxuICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJcXG49PT0gRGFuaCBzw6FjaCB04bqldCBj4bqjIGPDoWMga2h1eeG6v24gbcOjaSA9PT1cIik7XG4gICAgICAgIExpc3Q8S2h1eWVuTWFpPiBhbGxQcm9tb3Rpb25zID0ga2h1eWVuTWFpREFPSW1wbC5maW5kQWxsKCk7XG4gICAgICAgIGFsbFByb21vdGlvbnMuZm9yRWFjaChTeXN0ZW0ub3V0OjpwcmludGxuKTtcblxuICAgICAgICAvLyAzLiBUw6xtIGtodXnhur9uIG3Do2kgdGhlbyB0w6puXG4gICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIlxcbj09PSBUw6xtIGtodXnhur9uIG3Do2kgdGhlbyB0w6puID09PVwiKTtcbiAgICAgICAgTGlzdDxLaHV5ZW5NYWk+IHByb21vdGlvbnNCeU5hbWUgPSBraHV5ZW5NYWlEQU9JbXBsLmZpbmRCeU5hbWUoXCJU4bq/dFwiKTtcbiAgICAgICAgcHJvbW90aW9uc0J5TmFtZS5mb3JFYWNoKFN5c3RlbS5vdXQ6OnByaW50bG4pO1xuXG4gICAgICAgIC8vIDQuIFTDrG0ga2h1eeG6v24gbcOjaSB0aGVvIG3Do1xuICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJcXG49PT0gVMOsbSBraHV54bq/biBtw6NpIHRoZW8gbcOjID09PVwiKTtcbiAgICAgICAgS2h1eWVuTWFpIGZvdW5kUHJvbW90aW9uID0ga2h1eWVuTWFpREFPSW1wbC5maW5kQnlJZChcIktNMDAxXCIpO1xuICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJL4bq/dCBxdeG6ozogXCIgKyAoZm91bmRQcm9tb3Rpb24gIT0gbnVsbCA/IGZvdW5kUHJvbW90aW9uIDogXCJLaMO0bmcgdMOsbSB0aOG6pXlcIikpO1xuXG4gICAgICAgIC8vIDUuIFTDrG0gY8OhYyBraHV54bq/biBtw6NpIMSRYW5nIMOhcCBk4bulbmdcbiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiXFxuPT09IFTDrG0gY8OhYyBraHV54bq/biBtw6NpIMSRYW5nIMOhcCBk4bulbmcgPT09XCIpO1xuICAgICAgICBMaXN0PEtodXllbk1haT4gb25nb2luZ1Byb21vdGlvbnMgPSBraHV5ZW5NYWlEQU9JbXBsLmZpbmRPbmdvaW5nUHJvbW90aW9ucygpO1xuICAgICAgICBvbmdvaW5nUHJvbW90aW9ucy5mb3JFYWNoKFN5c3RlbS5vdXQ6OnByaW50bG4pO1xuXG4gICAgICAgIC8vIDYuIFjDs2Ega2h1eeG6v24gbcOjaSB0aGVvIG3Do1xuICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJcXG49PT0gWMOzYSBraHV54bq/biBtw6NpIHRoZW8gbcOjID09PVwiKTtcbiAgICAgICAgYm9vbGVhbiBpc0RlbGV0ZWQgPSBraHV5ZW5NYWlEQU9JbXBsLmRlbGV0ZShcIktNMDAwMDAxXCIpO1xuICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJYw7NhIGtodXnhur9uIG3Do2k6IFwiICsgKGlzRGVsZXRlZCA/IFwiVGjDoG5oIGPDtG5nXCIgOiBcIlRo4bqldCBi4bqhaVwiKSk7XG5cbiAgICAgICAgLy8gxJDDs25nIEVudGl0eU1hbmFnZXIgdsOgIEVudGl0eU1hbmFnZXJGYWN0b3J5XG4gICAgICAgIGVtLmNsb3NlKCk7XG4gICAgICAgIGVtZi5jbG9zZSgpO1xuICAgIH1cbn1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9ndWlDbGllbnQvRG9pVmVQYW5lbC5qYXZhXG4uLi5cblxuICAgICAgICAgICAgUmVnaXN0cnkgcmVnaXN0cnkgPSBMb2NhdGVSZWdpc3RyeS5nZXRSZWdpc3RyeShSTUlfU0VSVkVSX0lQLCBSTUlfU0VSVkVSX1BPUlQpO1xuICAgICAgICAgICAgZG9pVmVEQU8gPSAoRG9pVmVEQU8pIHJlZ2lzdHJ5Lmxvb2t1cChcImRvaVZlREFPXCIpO1xuICAgICAgICAgICAgbGljaFRyaW5oVGF1REFPID0gKExpY2hUcmluaFRhdURBTykgcmVnaXN0cnkubG9va3VwKFwibGljaFRyaW5oVGF1REFPXCIpO1xuLy8gICAgICAgICAgICBraHV5ZW5NYWlEQU8gPSAoS2h1eWVuTWFpREFPKSByZWdpc3RyeS5sb29rdXAoXCJraHV5ZW5NYWlEQU9cIik7XG4gICAgICAgICAgICB0b2FUYXVEQU8gPSAoVG9hVGF1RG9pVmVEQU8pIHJlZ2lzdHJ5Lmxvb2t1cChcInRvYVRhdURvaVZlREFPXCIpO1xuICAgICAgICAgICAgY2hvTmdvaURBTyA9IChDaG9OZ29pRG9pVmVEQU8pIHJlZ2lzdHJ5Lmxvb2t1cChcImNob05nb2lEb2lWZURBT1wiKTtcbiAgICAgICAgICAgIGxvYWlIb2FEb25EQU8gPSAoTG9haUhvYURvbkRBTykgcmVnaXN0cnkubG9va3VwKFwibG9haUhvYURvbkRBT1wiKTtcbiAgICAgICAgICAgIGhvYURvbkRBTyA9IChIb2FEb25EQU8pIHJlZ2lzdHJ5Lmxvb2t1cChcImhvYURvbkRBT1wiKTtcbiAgICAgICAgICAgIGNoaVRpZXRIb2FEb25EQU8gPSAoQ2hpVGlldEhvYURvbkRBTykgcmVnaXN0cnkubG9va3VwKFwiY2hpVGlldEhvYURvbkRBT1wiKTtcbiAgICAgICAgICAgIC8vIEtp4buDbSB0cmEga+G6v3QgbuG7kWlcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKGRvaVZlREFPLnRlc3RDb25uZWN0aW9uKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgU3dpbmdVdGlsaXRpZXMuaW52b2tlTGF0ZXIoKCkgLT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlU3RhdHVzKFJFQURZX1RFWFQsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0UHJlbG9hZGluZ0RhdGEoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZ3VpQ2xpZW50L1F1YW5MeUtoYWNoSGFuZ1BhbmVsLmphdmFcbnBhY2thZ2UgZ3VpQ2xpZW50O1xuXG5pbXBvcnQgZGFvLio7XG5pbXBvcnQgZGFvLmltcGwuS2hhY2hIYW5nREFPSW1wbDtcbmltcG9ydCBkYW8uaW1wbC5Mb2FpS2hhY2hIYW5nREFPSW1wbDtcbmltcG9ydCBkYW8uaW1wbC5WZVRhdURBT0ltcGw7XG5pbXBvcnQgZ3VpQ2xpZW50LmZvcm1hdC5EYXRlTGFiZWxGb3JtYXR0ZXI7XG5pbXBvcnQgbW9kZWwuKjtcbmltcG9ydCBvcmcuamRhdGVwaWNrZXIuaW1wbC5KRGF0ZVBhbmVsSW1wbDtcbmltcG9ydCBvcmcuamRhdGVwaWNrZXIuaW1wbC5KRGF0ZVBpY2tlckltcGw7XG5pbXBvcnQgb3JnLmpkYXRlcGlja2VyLmltcGwuVXRpbERhdGVNb2RlbDtcbmltcG9ydCBzZXJ2aWNlLkFJVHJhdmVsVGltZVByZWRpY3Rvcjtcbi4uLlxuXG5wdWJsaWMgY2xhc3MgUXVhbkx5S2hhY2hIYW5nUGFuZWwgZXh0ZW5kcyBKUGFuZWwge1xuICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvZ2dlciBMT0dHRVIgPSBMb2dnZXIuZ2V0TG9nZ2VyKFF1YW5MeUtoYWNoSGFuZ1BhbmVsLmNsYXNzLmdldE5hbWUoKSk7XG4gICAgcHJpdmF0ZSBmaW5hbCBKQnV0dG9uIGRlbGV0ZUJ1dHRvbiwgdXBkYXRlQnV0dG9uO1xuICAgIHByaXZhdGUgZmluYWwgSkJ1dHRvbiBhZGRCdXR0b247XG4gICAgcHJpdmF0ZSBBSVRyYXZlbFRpbWVQcmVkaWN0b3IgYWlQcmVkaWN0b3I7XG4gICAgcHJpdmF0ZSBKVGFibGUgY3VzdG9tZXJUYWJsZSwgaW52b2ljZVRhYmxlLCB0aWNrZXRUYWJsZTtcbiAgICBwcml2YXRlIERlZmF1bHRUYWJsZU1vZGVsIGN1c3RvbWVyVGFibGVNb2RlbCwgaW52b2ljZVRhYmxlTW9kZWwsIHRpY2tldFRhYmxlTW9kZWw7XG4gICAgcHJpdmF0ZSBKVGV4dEZpZWxkIHNlYXJjaEZpZWxkO1xuICAgIHByaXZhdGUgSkNvbWJvQm94PFN0cmluZz4gY3VzdG9tZXJUeXBlRmlsdGVyO1xuICAgIHByaXZhdGUgSkJ1dHRvbiBzZWFyY2hCdXR0b24sIHJlc2V0RmlsdGVyQnV0dG9uO1xuICAgIHByaXZhdGUgTGlzdDxLaGFjaEhhbmc+IGN1c3RvbWVyTGlzdDtcbiAgICBwcml2YXRlIExpc3Q8TG9haUtoYWNoSGFuZz4gY3VzdG9tZXJUeXBlTGlzdDtcbiAgICBwcml2YXRlIExvYWlLaGFjaEhhbmdEQU8gbG9haUtoYWNoSGFuZ0RBTztcbiAgICBwcml2YXRlIFZlVGF1REFPIHZlVGF1REFPO1xuICAgIHByaXZhdGUgS2hhY2hIYW5nREFPIGtoYWNoSGFuZ0RBTztcbiAgICBwcml2YXRlIExpc3Q8SG9hRG9uPiBpbnZvaWNlTGlzdDtcbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9ndWlDbGllbnQvVHJhVmVQYW5lbC5qYXZhXG5wYWNrYWdlIGd1aUNsaWVudDtcblxuLyoqXG4gKiBAROG7sSDDoW46IFBoYW5UYW5KYXZhTmhvbUdQVFxuICogQENsYXNzOiBUcmFWZVBhbmVsXG4gKiBAVOG6oW8gdsOgbyBuZ8OgeTogMTkvMDQvMjAyNVxuICogQFTDoWMgZ2nhuqM6IE5ndXllbiBIdXUgU2FuZ1xuICovXG5cbmltcG9ydCBkYW8uQ2hpVGlldEhvYURvbkRBTztcbmltcG9ydCBkYW8uSG9hRG9uREFPO1xuaW1wb3J0IGRhby5MaWNoVHJpbmhUYXVEQU87XG5pbXBvcnQgZGFvLlZlVGF1REFPO1xuaW1wb3J0IGRhby5pbXBsLkxpY2hMYW1WaWVjREFPSW1wbDtcbmltcG9ydCBkYW8uaW1wbC5MaWNoVHJpbmhUYXVEQU9JbXBsO1xuaW1wb3J0IG1vZGVsLio7XG4vL2ltcG9ydCB1dGlscy5QcmludFBERjtcbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9ndWlDbGllbnQvTWFpbkdVSS5qYXZhXG5wYWNrYWdlIGd1aUNsaWVudDtcblxuaW1wb3J0IGRhby5Eb2lWZURBTztcbmltcG9ydCBkYW8uaW1wbC5Eb2lWZURBT0ltcGw7XG5pbXBvcnQgZGFvLmltcGwuTmhhblZpZW5EQU9JbXBsO1xuaW1wb3J0IG1vZGVsLk5oYW5WaWVuO1xuXG5pbXBvcnQgamF2YXguc3dpbmcuKjtcbmltcG9ydCBqYXZhLmF3dC4qO1xuaW1wb3J0IGphdmEuYXd0LmV2ZW50Lk1vdXNlQWRhcHRlcjtcbmltcG9ydCBqYXZhLmF3dC5ldmVudC5Nb3VzZUV2ZW50O1xuaW1wb3J0IGphdmEuYXd0LmV2ZW50LldpbmRvd0FkYXB0ZXI7XG5pbXBvcnQgamF2YS5hd3QuZXZlbnQuV2luZG93RXZlbnQ7XG5pbXBvcnQgamF2YS5hd3QuaW1hZ2UuQnVmZmVyZWRJbWFnZTtcbmltcG9ydCBqYXZhLnJtaS5SZW1vdGVFeGNlcHRpb247XG5pbXBvcnQgamF2YS50aW1lLkxvY2FsRGF0ZTtcbmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDtcbmltcG9ydCBqYXZhLnV0aWwuTWFwO1xuXG5wdWJsaWMgY2xhc3MgTWFpbkdVSSBleHRlbmRzIEpGcmFtZSB7XG5cbiAgICBwcml2YXRlIEpQYW5lbCBjb250ZW50UGFuZWw7IC8vIENvbnRlbnQgcGFuZWwgbWFuYWdlZCBieSBDYXJkTGF5b3V0XG4gICAgcHJpdmF0ZSBDYXJkTGF5b3V0IGNhcmRMYXlvdXQ7IC8vIENhcmRMYXlvdXQgZm9yIHN3aXRjaGluZyBwYW5lbHNcbiAgICBwcml2YXRlIE1hcDxTdHJpbmcsIEpQYW5lbD4gcGFuZWxNYXA7IC8vIENhY2hlIGZvciBwYW5lbHNcbiAgICBwcml2YXRlIExpY2hUcmluaFRhdVBhbmVsIGxpY2hUcmluaFRhdVBhbmVsO1xuICAgIHByaXZhdGUgTmhhblZpZW4gbmhhblZpZW47XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGFvL0hvYURvbkRBTy5qYXZhXG4uLi5cblxuLyoqXG4gKiBAROG7sSDDoW46IFBoYW5UYW5KYXZhTmhvbUdQVFxuICogQEludGVyZmFjZTogSG9hRG9uREFPXG4gKiBAVOG6oW8gdsOgbyBuZ8OgeTogMTgvMDQvMjAyNVxuICogQFTDoWMgZ2nhuqM6IE5ndXllbiBIdXUgU2FuZ1xuICovXG5wdWJsaWMgaW50ZXJmYWNlIEhvYURvbkRBTyBleHRlbmRzIFJlbW90ZSB7XG4gICAgLy8gQ3JlYXRlOiBUaMOqbSBow7NhIMSRxqFuIG3hu5tpXG4gICAgYm9vbGVhbiBzYXZlSG9hRG9uKEhvYURvbiBob2FEb24pIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG5cbiAgICAvLyBSZWFkOiBM4bqleSBkYW5oIHPDoWNoIGjDs2EgxJHGoW5cbiAgICBMaXN0PEhvYURvbj4gZ2V0QWxsSG9hRG9ucygpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG5cbiAgICAvLyBSZWFkOiBUw6xtIGjDs2EgxJHGoW4gdGhlbyBtw6MgaMOzYSDEkcahblxuICAgIEhvYURvbiBnZXRIb2FEb25CeUlkKFN0cmluZyBtYUhEKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuXG4gICAgLy8gVXBkYXRlOiBD4bqtcCBuaOG6rXQgdGjDtG5nIHRpbiBow7NhIMSRxqFuXG4gICAgYm9vbGVhbiB1cGRhdGVIb2FEb24oSG9hRG9uIGhvYURvbikgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcblxuICAgIC8vIERlbGV0ZTogWMOzYSBow7NhIMSRxqFuIHRoZW8gbcOjIGjDs2EgxJHGoW5cbiAgICBib29sZWFuIGRlbGV0ZUhvYURvbihTdHJpbmcgbWFIRCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcblxuICAgIC8vIFJldHJpZXZlIGludm9pY2VzIGJ5IGN1c3RvbWVyIElEXG4gICAgTGlzdDxIb2FEb24+IGdldEJ5Q3VzdG9tZXJJZChTdHJpbmcgY3VzdG9tZXJJZCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9kYW8vQ2hvTmdvaURvaVZlREFPLmphdmFcbi4uLlxuXG5wdWJsaWMgaW50ZXJmYWNlIENob05nb2lEb2lWZURBTyBleHRlbmRzIFJlbW90ZSB7XG4gICAgLy8gTOG6pXkgZGFuaCBzw6FjaCBjaOG7lyBuZ+G7k2kgdGhlbyB0b2EgdMOgdVxuICAgIExpc3Q8Q2hvTmdvaT4gZ2V0Q2hvTmdvaUJ5VG9hVGF1KFN0cmluZyBtYVRvYVRhdSkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcblxuICAgIC8vIEtp4buDbSB0cmEgY2jhu5cgbmfhu5NpIGPDsyBraOG6oyBk4bulbmcga2jDtG5nICh0aW5oX3RyYW5nID0gdHJ1ZSlcbiAgICBib29sZWFuIGtpZW1UcmFDaG9OZ29pS2hhRHVuZyhTdHJpbmcgbWFDaG8pIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG5cbiAgICAvLyBLaeG7g20gdHJhIGNo4buXIG5n4buTaSDEkcOjIMSRxrDhu6NjIMSR4bq3dCB0cm9uZyBt4buZdCBs4buLY2ggdHLDrG5oIGPhu6UgdGjhu4MgY2jGsGFcbiAgICBib29sZWFuIGtpZW1UcmFDaG9OZ29pRGFEYXQoU3RyaW5nIG1hQ2hvLCBTdHJpbmcgbWFMaWNoVHJpbmgpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG5cbiAgICAvLyBLaMOzYSBjaOG7lyBuZ+G7k2kgdOG6oW0gdGjhu51pIChraGkga2jDoWNoIGjDoG5nIGNo4buNbilcbiAgICBib29sZWFuIGtob2FDaG9OZ29pKFN0cmluZyBtYUNobywgU3RyaW5nIG1hTGljaFRyaW5oLCBTdHJpbmcgc2Vzc2lvbklkLCBsb25nIHRob2lHaWFuS2hvYU1pbGxpcykgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcblxuICAgIC8vIEjhu6d5IGtow7NhIGNo4buXIG5n4buTaVxuICAgIGJvb2xlYW4gaHV5S2hvYUNob05nb2koU3RyaW5nIG1hQ2hvLCBTdHJpbmcgbWFMaWNoVHJpbmgsIFN0cmluZyBzZXNzaW9uSWQpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGFvL0xvYWlLaGFjaEhhbmdEQU8uamF2YVxucGFja2FnZSBkYW87XG5cbmltcG9ydCBtb2RlbC5Mb2FpS2hhY2hIYW5nO1xuXG5pbXBvcnQgamF2YS5ybWkuUmVtb3RlO1xuaW1wb3J0IGphdmEucm1pLlJlbW90ZUV4Y2VwdGlvbjtcbmltcG9ydCBqYXZhLnV0aWwuTGlzdDtcblxuLyoqXG4gKiBAROG7sSDDoW46IFBoYW5UYW5KYXZhTmhvbUdQVFxuICogQENsYXNzOiBMb2FpS2hhY2hIYW5nREFPXG4gKiBAVOG6oW8gdsOgbyBuZ8OgeTogMTgvMDQvMjAyNVxuICogQFTDoWMgZ2nhuqM6IE5ndXllbiBIdXUgU2FuZ1xuICovXG5wdWJsaWMgaW50ZXJmYWNlIExvYWlLaGFjaEhhbmdEQU8gZXh0ZW5kcyBSZW1vdGUge1xuICAgIExpc3Q8TG9haUtoYWNoSGFuZz4gZ2V0QWxsKCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcbiAgICBMb2FpS2hhY2hIYW5nIGZpbmRCeUlkKFN0cmluZyBpZCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcbiAgICBib29sZWFuIHNhdmUoTG9haUtoYWNoSGFuZyBsb2FpS2hhY2hIYW5nKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuICAgIGJvb2xlYW4gdXBkYXRlKExvYWlLaGFjaEhhbmcgbG9haUtoYWNoSGFuZykgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcbiAgICBib29sZWFuIGRlbGV0ZShTdHJpbmcgaWQpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG5cbi8vICAgICBMaXN0PExvYWlLaGFjaEhhbmc+IGdldEFsbExpc3QoKTtcbn0uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvbW9kZWwvS2h1eWVuTWFpLmphdmFcbnBhY2thZ2UgbW9kZWw7XG5cbmltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLio7XG5pbXBvcnQgbG9tYm9rLkRhdGE7XG5cbmltcG9ydCBqYXZhLmlvLlNlcmlhbGl6YWJsZTtcbmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlO1xuaW1wb3J0IGphdmEudXRpbC5PYmplY3RzO1xuaW1wb3J0IGphdmEudXRpbC5TZXQ7XG5cbkBEYXRhXG5ARW50aXR5XG5AVGFibGUobmFtZSA9IFwia2h1eWVubWFpXCIpXG5wdWJsaWMgY2xhc3MgS2h1eWVuTWFpIGltcGxlbWVudHMgU2VyaWFsaXphYmxlIHtcbiAgICBASWRcbiAgICBAQ29sdW1uKG5hbWUgPSBcIm1hX2ttXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcIlZBUkNIQVIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlLHVuaXF1ZSA9IHRydWUpXG4gICAgcHJpdmF0ZSBTdHJpbmcgbWFLTTtcbiAgICBAQ29sdW1uKG5hbWUgPSBcInRlbl9rbVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJOVkFSQ0hBUigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBTdHJpbmcgdGVuS007XG4gICAgQENvbHVtbihuYW1lID0gXCJ0aG9pX2dpYW5fYmF0X2RhdVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJEQVRFXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBMb2NhbERhdGUgdGhvaUdpYW5CYXREYXU7XG4gICAgQENvbHVtbihuYW1lID0gXCJ0aG9pX2dpYW5fa2V0X3RodWNcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiREFURVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgTG9jYWxEYXRlIHRob2lHaWFuS2V0VGh1YztcbiAgICBAQ29sdW1uKG5hbWUgPSBcIm5vaV9kdW5nX2ttXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcIk5WQVJDSEFSKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIFN0cmluZyBub2lEdW5nS007XG4gICAgQENvbHVtbihuYW1lID0gXCJjaGlldF9raGF1XCIsIGNvbHVtbkRlZmluaXRpb24gPSBcImRvdWJsZVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgZG91YmxlIGNoaWV0S2hhdTtcbiAgICBAQ29sdW1uKG5hbWUgPSBcImRvaV90dW9uZ19hcF9kdW5nXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcIk5WQVJDSEFSKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIERvaVR1b25nQXBEdW5nIGRvaVR1b25nQXBEdW5nO1xuICAgIEBDb2x1bW4obmFtZSA9IFwidHJhbmdfdGhhaVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJOVkFSQ0hBUig1MClcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIFN0cmluZyB0cmFuZ1RoYWk7XG5cbiAgICBAT25lVG9NYW55KG1hcHBlZEJ5ID0gXCJraHV5ZW5NYWlcIilcbiAgICBwcml2YXRlIFNldDxWZVRhdT4gdmVfdGF1cztcblxuXG59XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZ3VpQ2xpZW50L1RoYW5oVG9hbkdVSS5qYXZhXG4uLi5cblxuICAgICAgICAvLyBDZW50ZXIgLSBEaXNjb3VudCBjb2RlIGZpZWxkXG4gICAgICAgIEpQYW5lbCBwcm9tb3Rpb25QYW5lbCA9IG5ldyBKUGFuZWwobmV3IEJvcmRlckxheW91dCg1LCAwKSk7XG4gICAgICAgIHByb21vdGlvbkZpZWxkID0gbmV3IEpUZXh0RmllbGQoKTtcbiAgICAgICAgcHJvbW90aW9uRmllbGQuc2V0UHJlZmVycmVkU2l6ZShuZXcgRGltZW5zaW9uKDIwMCwgMzApKTtcbiAgICAgICAgSkxhYmVsIHByb21vTGFiZWwgPSBuZXcgSkxhYmVsKFwiTmjhuq1wIG3DoyBnaeG6o20gZ2nDoSB04bqhaSDEkcOieVwiKTtcbiAgICAgICAgcHJvbW9MYWJlbC5zZXRCb3JkZXIobmV3IEVtcHR5Qm9yZGVyKDAsIDAsIDAsIDUpKTtcbiAgICAgICAgcHJvbW90aW9uUGFuZWwuYWRkKHByb21vTGFiZWwsIEJvcmRlckxheW91dC5XRVNUKTtcbiAgICAgICAgcHJvbW90aW9uUGFuZWwuYWRkKHByb21vdGlvbkZpZWxkLCBCb3JkZXJMYXlvdXQuQ0VOVEVSKTtcblxuICAgICAgICAvLyBBcHBseSBidXR0b25cbiAgICAgICAgSkJ1dHRvbiBhcHBseUJ1dHRvbiA9IG5ldyBKQnV0dG9uKFwiw4FwIGThu6VuZ1wiKTtcbiAgICAgICAgYXBwbHlCdXR0b24uYWRkQWN0aW9uTGlzdGVuZXIoZSAtPiBhcHBseVByb21vdGlvbigpKTtcbiAgICAgICAgcHJvbW90aW9uUGFuZWwuYWRkKGFwcGx5QnV0dG9uLCBCb3JkZXJMYXlvdXQuRUFTVCk7XG4gICAgICAgIGJvdHRvbVBhbmVsLmFkZChwcm9tb3Rpb25QYW5lbCwgQm9yZGVyTGF5b3V0LkNFTlRFUik7XG4uLi5cblxuICAgIC8qKlxuICAgICAqIEFwcGx5IHByb21vdGlvbiBjb2RlXG4gICAgICovXG4gICAgcHJpdmF0ZSB2b2lkIGFwcGx5UHJvbW90aW9uKCkge1xuICAgICAgICBTdHJpbmcgY29kZSA9IHByb21vdGlvbkZpZWxkLmdldFRleHQoKS50cmltKCk7XG4gICAgICAgIGlmIChjb2RlLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIFwiVnVpIGzDsm5nIG5o4bqtcCBtw6Mga2h1eeG6v24gbcOjaVwiLFxuICAgICAgICAgICAgICAgICAgICBcIlRow7RuZyBiw6FvXCIsXG4gICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLklORk9STUFUSU9OX01FU1NBR0VcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJbiBhIHJlYWwgYXBwLCB5b3Ugd291bGQgdmFsaWRhdGUgdGhlIGNvZGUgYWdhaW5zdCBhIGRhdGFiYXNlXG4gICAgICAgIC8vIEZvciBub3csIGp1c3Qgc2hvdyBhIG1lc3NhZ2VcbiAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICBcIk3DoyBraHV54bq/biBtw6NpIGtow7RuZyBo4bujcCBs4buHIGhv4bq3YyDEkcOjIGjhur90IGjhuqFuXCIsXG4gICAgICAgICAgICAgICAgXCJUaMO0bmcgYsOhb1wiLFxuICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLklORk9STUFUSU9OX01FU1NBR0VcbiAgICAgICAgKTtcbiAgICB9XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGFvL0xvYWlIb2FEb25EQU8uamF2YVxucGFja2FnZSBkYW87XG5cbmltcG9ydCBtb2RlbC5Mb2FpSG9hRG9uO1xuXG5pbXBvcnQgamF2YS5ybWkuUmVtb3RlO1xuXG5wdWJsaWMgaW50ZXJmYWNlIExvYWlIb2FEb25EQU8gZXh0ZW5kcyBSZW1vdGUge1xuICAgIExvYWlIb2FEb24gZmluZEJ5SWQoU3RyaW5nIGlkKSB0aHJvd3MgRXhjZXB0aW9uO1xufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9RdWFuTHlOaGFuVmllblBhbmVsLmphdmFcbi4uLlxuXG5cblxuICAgIEBPdmVycmlkZVxuICAgIHB1YmxpYyB2b2lkIGFjdGlvblBlcmZvcm1lZChBY3Rpb25FdmVudCBlKSB7XG4gICAgICAgIE9iamVjdCBvID0gZS5nZXRTb3VyY2UoKTtcblxuICAgICAgICBpZiAobyA9PSBidG5UaGVtKSB7XG4gICAgICAgICAgICBTdHJpbmcgbWFOViA9IGdlbmVyYXRlTWFOVigpO1xuICAgICAgICAgICAgTG9jYWxEYXRlIG5nYXlWYW9MYW0gPSBMb2NhbERhdGUubm93KCk7XG4gICAgICAgICAgICB0eHRNYU5WLnNldFRleHQobWFOVik7XG4gICAgICAgICAgICB0eHRUZW5OVi5zZXRUZXh0KFwiXCIpO1xuICAgICAgICAgICAgdHh0U29EVC5zZXRUZXh0KFwiXCIpO1xuICAgICAgICAgICAgdHh0Q0NDRC5zZXRUZXh0KFwiXCIpO1xuICAgICAgICAgICAgdHh0RGlhQ2hpLnNldFRleHQoXCJcIik7XG4gICAgICAgICAgICBkYXRlQ2hvb3Nlck5nYXlWYW9MYW0uc2V0RGF0ZShqYXZhLnNxbC5EYXRlLnZhbHVlT2YobmdheVZhb0xhbSkpO1xuICAgICAgICAgICAgY21iQ2h1Y1Z1LnNldFNlbGVjdGVkSW5kZXgoMCk7XG4gICAgICAgICAgICBsYmxBbmguc2V0SWNvbihudWxsKTtcbiAgICAgICAgICAgIHNldEVkaXRhYmxlRmllbGRzKHRydWUpO1xuICAgICAgICAgICAgdHh0TWFOVi5zZXRFZGl0YWJsZShmYWxzZSk7XG4gICAgICAgIH0gZWxzZSBpZiAobyA9PSBidG5MYW1Nb2kpIHtcbiAgICAgICAgICAgIGNsZWFyVGhvbmdUaW5OaGFuVmllbigpO1xuICAgICAgICAgICAgdGFpTGFpRGFuaFNhY2hOaGFuVmllbigpO1xuICAgICAgICAgICAgdHh0TWFOVi5zZXRFbmFibGVkKHRydWUpO1xuICAgICAgICAgICAgc2V0RWRpdGFibGVGaWVsZHModHJ1ZSk7XG4gICAgICAgICAgICBpc0VkaXRNb2RlID0gZmFsc2U7XG4gICAgICAgIH1cbi4uLlxuXG4gICAgICAgICAgICAgICAgaWYgKGlzRWRpdE1vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IG5oYW5WaWVuREFPLnVwZGF0ZShudik7XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKFJlbW90ZUV4Y2VwdGlvbiBleCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFeGNlcHRpb24oZXgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKHRoaXMsIFwiQ+G6rXAgbmjhuq10IG5ow6JuIHZpw6puIHRow6BuaCBjw7RuZyFcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWlMYWlEYW5oU2FjaE5oYW5WaWVuKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc0VkaXRNb2RlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBuaGFuVmllbkRhbmdTdWEgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJUaG9uZ1Rpbk5oYW5WaWVuKCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyh0aGlzLCBcIkPhuq1wIG5o4bqtdCBuaMOibiB2acOqbiB0aOG6pXQgYuG6oWkhXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IG5oYW5WaWVuREFPLnNhdmUobnYpO1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChSZW1vdGVFeGNlcHRpb24gZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBSdW50aW1lRXhjZXB0aW9uKGV4KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyh0aGlzLCBcIkzGsHUgbmjDom4gdmnDqm4gdGjDoG5oIGPDtG5nIVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhbmhTYWNoTmhhblZpZW4uYWRkKG52KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhaUxhaURhbmhTYWNoTmhhblZpZW4oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyVGhvbmdUaW5OaGFuVmllbigpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2codGhpcywgXCJMxrB1IG5ow6JuIHZpw6puIGtow7RuZyB0aMOgbmggY8O0bmchXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2Rhby9UdXllblRhdURBTy5qYXZhXG5wYWNrYWdlIGRhbztcblxuaW1wb3J0IG1vZGVsLlR1eWVuVGF1O1xuXG5pbXBvcnQgamF2YS5ybWkuUmVtb3RlO1xuaW1wb3J0IGphdmEucm1pLlJlbW90ZUV4Y2VwdGlvbjtcbmltcG9ydCBqYXZhLnV0aWwuTGlzdDtcblxucHVibGljIGludGVyZmFjZSBUdXllblRhdURBTyBleHRlbmRzIFJlbW90ZSB7XG4gICAgTGlzdDxUdXllblRhdT4gZ2V0TGlzdFR1eWVuVGF1QnlHYURpR2FEZW4oU3RyaW5nIGdhRGksIFN0cmluZyBnYURlbikgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcbiAgICBMaXN0PFR1eWVuVGF1PiBnZXRMaXN0VHV5ZW5UYXUoKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuICAgIFR1eWVuVGF1IGdldFR1eWVuVGF1QnlJZChTdHJpbmcgaWQpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG4gICAgYm9vbGVhbiBzYXZlKFR1eWVuVGF1IHR1eWVuVGF1KSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuICAgIGJvb2xlYW4gZGVsZXRlKFN0cmluZyBpZCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcbiAgICBib29sZWFuIHVwZGF0ZShUdXllblRhdSB0dXllblRhdSkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcbn1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9tb2RlbC9Mb2FpQ2hvLmphdmFcbnBhY2thZ2UgbW9kZWw7XG5cbmltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLio7XG5pbXBvcnQgbG9tYm9rLkRhdGE7XG5pbXBvcnQgbG9tYm9rLkVxdWFsc0FuZEhhc2hDb2RlO1xuaW1wb3J0IGxvbWJvay5Ub1N0cmluZztcblxuaW1wb3J0IGphdmEuaW8uU2VyaWFsaXphYmxlO1xuaW1wb3J0IGphdmEudXRpbC5TZXQ7XG5cbkBFbnRpdHlcbkBEYXRhXG5ARXF1YWxzQW5kSGFzaENvZGUob25seUV4cGxpY2l0bHlJbmNsdWRlZCA9IHRydWUpXG5AVGFibGUobmFtZSA9IFwibG9haWNob1wiKVxucHVibGljIGNsYXNzIExvYWlDaG8gaW1wbGVtZW50cyBTZXJpYWxpemFibGUge1xuICAgIEBJZFxuICAgIEBFcXVhbHNBbmRIYXNoQ29kZS5JbmNsdWRlXG4gICAgQENvbHVtbihuYW1lID0gXCJtYV9sb2FpXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcIlZBUkNIQVIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlLHVuaXF1ZSA9IHRydWUpXG4gICAgcHJpdmF0ZSBTdHJpbmcgbWFMb2FpO1xuICAgIEBDb2x1bW4obmFtZSA9IFwidGVuX2xvYWlcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiTlZBUkNIQVIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgU3RyaW5nIHRlbkxvYWk7XG5cblxuICAgIEBPbmVUb01hbnkobWFwcGVkQnkgPSBcImxvYWlDaG9cIilcbiAgIEBUb1N0cmluZy5FeGNsdWRlXG4gICAgcHJpdmF0ZSBTZXQ8Q2hvTmdvaT4gY2hvX25nb2lzO1xufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9MaWNoVHJpbmhUYXVQYW5lbC5qYXZhXG4uLi5cblxuICAgIHByaXZhdGUgSlBhbmVsIGNyZWF0ZVRpdGxlUGFuZWwoKSB7XG4gICAgICAgIEpQYW5lbCBwYW5lbCA9IG5ldyBKUGFuZWwobmV3IEJvcmRlckxheW91dCgpKTtcblxuICAgICAgICBKTGFiZWwgdGl0bGVMYWJlbCA9IG5ldyBKTGFiZWwoXCJRVeG6ok4gTMOdIEzhu4pDSCBUUsOMTkggVMOAVVwiLCBKTGFiZWwuQ0VOVEVSKTtcbiAgICAgICAgdGl0bGVMYWJlbC5zZXRGb250KG5ldyBGb250KFwiQXJpYWxcIiwgRm9udC5CT0xELCAyMCkpO1xuICAgICAgICB0aXRsZUxhYmVsLnNldEZvcmVncm91bmQobmV3IENvbG9yKDQxLCAxMjgsIDE4NSkpO1xuICAgICAgICB0aXRsZUxhYmVsLnNldEJvcmRlcihCb3JkZXJGYWN0b3J5LmNyZWF0ZUVtcHR5Qm9yZGVyKDAsIDAsIDEwLCAwKSk7XG5cbiAgICAgICAgcGFuZWwuYWRkKHRpdGxlTGFiZWwsIEJvcmRlckxheW91dC5DRU5URVIpO1xuICAgICAgICByZXR1cm4gcGFuZWw7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBKUGFuZWwgY3JlYXRlQ2VudGVyUGFuZWwoKSB7XG4gICAgICAgIEpQYW5lbCBwYW5lbCA9IG5ldyBKUGFuZWwobmV3IEJvcmRlckxheW91dCgxMCwgMTApKTtcblxuICAgICAgICBwYW5lbC5hZGQoY3JlYXRlU2VhcmNoUGFuZWwoKSwgQm9yZGVyTGF5b3V0Lk5PUlRIKTtcblxuICAgICAgICAvLyBU4bqhbyBUYWJiZWRQYW5lIMSR4buDIGNo4bupYSBj4bqjIGNo4bq/IMSR4buZIHhlbSBi4bqjbmcgdsOgIGzhu4tjaFxuICAgICAgICB2aWV3VGFiYmVkUGFuZSA9IG5ldyBKVGFiYmVkUGFuZSgpO1xuLi4uXG5cbiAgICAgICAgLy8gVGjDqm0gY8OhYyB0YWIgdsOgbyBUYWJiZWRQYW5lXG4gICAgICAgIHZpZXdUYWJiZWRQYW5lLmFkZFRhYihcIkThuqFuZyBC4bqjbmdcIiwgbmV3IEltYWdlSWNvbigpLCB0YWJsZVZpZXdQYW5lbCwgXCJIaeG7g24gdGjhu4sgZOG6oW5nIGLhuqNuZ1wiKTtcbiAgICAgICAgdmlld1RhYmJlZFBhbmUuYWRkVGFiKFwiROG6oW5nIEzhu4tjaFwiLCBuZXcgSW1hZ2VJY29uKCksIGNhbGVuZGFyUGFuZWwsIFwiSGnhu4NuIHRo4buLIGThuqFuZyBs4buLY2hcIik7XG5cbiAgICAgICAgcGFuZWwuYWRkKHZpZXdUYWJiZWRQYW5lLCBCb3JkZXJMYXlvdXQuQ0VOVEVSKTtcbiAgICAgICAgcGFuZWwuYWRkKGNyZWF0ZUFjdGlvblBhbmVsKCksIEJvcmRlckxheW91dC5TT1VUSCk7XG5cbiAgICAgICAgcmV0dXJuIHBhbmVsO1xuICAgIH1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9tb2RlbC9Mb2FpS2hhY2hIYW5nLmphdmFcbi4uLlxuXG5ARGF0YVxuQEVudGl0eVxuQEVxdWFsc0FuZEhhc2hDb2RlKG9ubHlFeHBsaWNpdGx5SW5jbHVkZWQgPSB0cnVlKVxucHVibGljIGNsYXNzIExvYWlLaGFjaEhhbmcgaW1wbGVtZW50cyBTZXJpYWxpemFibGUge1xuICAgIEBJZFxuICAgIEBFcXVhbHNBbmRIYXNoQ29kZS5JbmNsdWRlXG4gICAgQENvbHVtbihuYW1lID0gXCJtYV9sb2FpX2toYWNoX2hhbmdcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwidmFyY2hhcigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UsIHVuaXF1ZSA9IHRydWUpXG4gICAgcHJpdmF0ZSBTdHJpbmcgbWFMb2FpS2hhY2hIYW5nO1xuICAgIEBDb2x1bW4obmFtZSA9IFwidGVuX2xvYWlfa2hhY2hfaGFuZ1wiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJ2YXJjaGFyKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIFN0cmluZyB0ZW5Mb2FpS2hhY2hIYW5nO1xuXG4gICAgQFRvU3RyaW5nLkV4Y2x1ZGVcbiAgICBAT25lVG9NYW55KG1hcHBlZEJ5ID0gXCJsb2FpS2hhY2hIYW5nXCIpXG4gICAgcHJpdmF0ZSBTZXQ8S2hhY2hIYW5nPiBraGFjaEhhbmdzO1xuXG59XG5cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9kYW8vRG9pVmVEQU8uamF2YVxuLi4uXG5cbnB1YmxpYyBpbnRlcmZhY2UgRG9pVmVEQU8gZXh0ZW5kcyBSZW1vdGUge1xuICAgIFZlVGF1IGdldFZlVGF1KFN0cmluZyBpZCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcbiAgICBib29sZWFuIGRvaVZlKFZlVGF1IHZlVGF1KSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuICAgIExpc3Q8VmVUYXU+IGdldFZlVGF1QnlUcmFuZ1RoYWkoVHJhbmdUaGFpVmVUYXUgdHJhbmdUaGFpKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuICAgIGJvb2xlYW4gdGVzdENvbm5lY3Rpb24oKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuICAgIExpc3Q8VHJhbmdUaGFpVmVUYXU+IGdldEFsbFRyYW5nVGhhaVZlKCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcblxuICAgIC8vIFRow6ptIGNo4bupYyBuxINuZyBt4bubaVxuICAgIGJvb2xlYW4gZGF0VmUoVmVUYXUgdmVUYXUsIFN0Li4uIiwiaXNfZXJyb3IiOmZhbHNlLCJyZXF1ZXN0X2lkIjoiIiwidG9vbF91c2VfaWQiOiJ0b29sdV8wMUJqYVJFcnVYSjdRTFRTMkpQUnQ4alkifX0seyJpZCI6MiwidHlwZSI6NCwiaWRlX3N0YXRlX25vZGUiOnsid29ya3NwYWNlRm9sZGVycyI6W3sicmVwb3NpdG9yeVJvb3QiOiJFOi9MVFBUSkFWQS9OaG9tL1BoYW5UYW5KYXZhTmhvbUdQVC9Qcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyIsImZvbGRlclJvb3QiOiJFOi9MVFBUSkFWQS9OaG9tL1BoYW5UYW5KYXZhTmhvbUdQVC9Qcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyJ9XSwid29ya3NwYWNlRm9sZGVyc1VuY2hhbmdlZCI6ZmFsc2V9fV0sInJlc3BvbnNlX3RleHQiOiJCYXNlZCBvbiBteSBhbmFseXNpcywgSSBuZWVkIHRvIGNyZWF0ZSBhIEtodXllbk1haURBTyBpbnRlcmZhY2UgYW5kIHVwZGF0ZSB0aGUgS2h1eWVuTWFpREFPSW1wbCB0byBpbXBsZW1lbnQgaXQuIExldCdzIGFsc28gY2hlY2sgdGhlIE1haW5HVUkgdG8gc2VlIGhvdyB0byBpbnRlZ3JhdGUgb3VyIG5ldyBwYW5lbDpcbiIsIndvcmtzcGFjZV9maWxlX2NodW5rcyI6W119LHsic3RhdHVzIjoic3VjY2VzcyIsInJlcXVlc3RfaWQiOiJkOTg4ZWUwOS03YzdkLTQ4MTEtOWFlMS0yYTk1ZDQwMzcxMjgiLCJyZXF1ZXN0X21lc3NhZ2UiOiIiLCJzdHJ1Y3R1cmVkX291dHB1dF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjUsImNvbnRlbnQiOiIiLCJ0b29sX3VzZSI6eyJ0b29sX3VzZV9pZCI6InRvb2x1XzAxVWtmMjRLTHpFdzJ1WjNpdnhkUzRFWSIsInRvb2xfbmFtZSI6InNhdmUtZmlsZSIsImlucHV0X2pzb24iOiJ7XCJmaWxlX3BhdGhcIjogXCJzcmMvbWFpbi9qYXZhL2Rhby9LaHV5ZW5NYWlEQU8uamF2YVwiLCBcImZpbGVfY29udGVudFwiOiBcInBhY2thZ2UgZGFvO1xcblxcbmltcG9ydCBtb2RlbC5LaHV5ZW5NYWk7XFxuXFxuaW1wb3J0IGphdmEucm1pLlJlbW90ZTtcXG5pbXBvcnQgamF2YS5ybWkuUmVtb3RlRXhjZXB0aW9uO1xcbmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlO1xcbmltcG9ydCBqYXZhLnV0aWwuTGlzdDtcXG5cXG5wdWJsaWMgaW50ZXJmYWNlIEtodXllbk1haURBTyBleHRlbmRzIFJlbW90ZSB7XFxuICAgIC8vIExcXHUxZWE1eSBkYW5oIHNcXHUwMGUxY2ggdFxcdTFlYTV0IGNcXHUxZWEzIGNcXHUwMGUxYyBraHV5XFx1MWViZm4gbVxcdTAwZTNpXFxuICAgIExpc3Q8S2h1eWVuTWFpPiBmaW5kQWxsKCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcXG4gICAgXFxuICAgIC8vIExcXHUxZWE1eSBkYW5oIHNcXHUwMGUxY2gga2h1eVxcdTFlYmZuIG1cXHUwMGUzaSB0aGVvIHRcXHUwMGVhblxcbiAgICBMaXN0PEtodXllbk1haT4gZmluZEJ5TmFtZShTdHJpbmcgbmFtZSkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcXG4gICAgXFxuICAgIC8vIExcXHUxZWE1eSBraHV5XFx1MWViZm4gbVxcdTAwZTNpIHRoZW8gbVxcdTAwZTNcXG4gICAgS2h1eWVuTWFpIGZpbmRCeUlkKFN0cmluZyBpZCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcXG4gICAgXFxuICAgIC8vIFRoXFx1MDBlYW0gaG9cXHUxZWI3YyBjXFx1MWVhZHAgbmhcXHUxZWFkdCBraHV5XFx1MWViZm4gbVxcdTAwZTNpXFxuICAgIGJvb2xlYW4gc2F2ZShLaHV5ZW5NYWkga2h1eWVuTWFpKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xcbiAgICBcXG4gICAgLy8gWFxcdTAwZjNhIGtodXlcXHUxZWJmbiBtXFx1MDBlM2kgdGhlbyBtXFx1MDBlM1xcbiAgICBib29sZWFuIGRlbGV0ZShTdHJpbmcgaWQpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XFxuICAgIFxcbiAgICAvLyBUXFx1MDBlY20gY1xcdTAwZTFjIGtodXlcXHUxZWJmbiBtXFx1MDBlM2kgXFx1MDExMWFuZyBcXHUwMGUxcCBkXFx1MWVlNW5nXFxuICAgIExpc3Q8S2h1eWVuTWFpPiBmaW5kT25nb2luZ1Byb21vdGlvbnMoKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xcbiAgICBcXG4gICAgLy8gS2lcXHUxZWMzbSB0cmEga1xcdTFlYmZ0IG5cXHUxZWQxaVxcbiAgICBib29sZWFuIHRlc3RDb25uZWN0aW9uKCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcXG59XCJ9In19LHsiaWQiOjAsInR5cGUiOjAsImNvbnRlbnQiOiJOb3cgSSBoYXZlIGFsbCB0aGUgaW5mb3JtYXRpb24gSSBuZWVkIHRvIGNyZWF0ZSB0aGUgcHJvbW90aW9uIG1hbmFnZW1lbnQgcGFuZWwuIExldCdzIHN0YXJ0IGJ5IGltcGxlbWVudGluZyB0aGUgbmVjZXNzYXJ5IGNvbXBvbmVudHM6XG5cbjEuIEZpcnN0LCBsZXQncyBjcmVhdGUgdGhlIEtodXllbk1haURBTyBpbnRlcmZhY2U6XG4ifSx7ImlkIjoyLCJ0eXBlIjoyLCJjb250ZW50IjoiIn0seyJpZCI6MywidHlwZSI6MywiY29udGVudCI6IiJ9XSwic2Vlbl9zdGF0ZSI6InNlZW4iLCJzdHJ1Y3R1cmVkX3JlcXVlc3Rfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjoxLCJ0b29sX3Jlc3VsdF9ub2RlIjp7ImNvbnRlbnQiOiJUaGUgZm9sbG93aW5nIGNvZGUgc2VjdGlvbnMgd2VyZSByZXRyaWV2ZWQ6XG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9NYWluR1VJLmphdmFcbnBhY2thZ2UgZ3VpQ2xpZW50O1xuXG5pbXBvcnQgZGFvLkRvaVZlREFPO1xuaW1wb3J0IGRhby5pbXBsLkRvaVZlREFPSW1wbDtcbmltcG9ydCBkYW8uaW1wbC5OaGFuVmllbkRBT0ltcGw7XG5pbXBvcnQgbW9kZWwuTmhhblZpZW47XG5cbmltcG9ydCBqYXZheC5zd2luZy4qO1xuaW1wb3J0IGphdmEuYXd0Lio7XG5pbXBvcnQgamF2YS5hd3QuZXZlbnQuTW91c2VBZGFwdGVyO1xuaW1wb3J0IGphdmEuYXd0LmV2ZW50Lk1vdXNlRXZlbnQ7XG5pbXBvcnQgamF2YS5hd3QuZXZlbnQuV2luZG93QWRhcHRlcjtcbmltcG9ydCBqYXZhLmF3dC5ldmVudC5XaW5kb3dFdmVudDtcbmltcG9ydCBqYXZhLmF3dC5pbWFnZS5CdWZmZXJlZEltYWdlO1xuaW1wb3J0IGphdmEucm1pLlJlbW90ZUV4Y2VwdGlvbjtcbmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlO1xuaW1wb3J0IGphdmEudXRpbC5IYXNoTWFwO1xuaW1wb3J0IGphdmEudXRpbC5NYXA7XG5cbnB1YmxpYyBjbGFzcyBNYWluR1VJIGV4dGVuZHMgSkZyYW1lIHtcblxuICAgIHByaXZhdGUgSlBhbmVsIGNvbnRlbnRQYW5lbDsgLy8gQ29udGVudCBwYW5lbCBtYW5hZ2VkIGJ5IENhcmRMYXlvdXRcbiAgICBwcml2YXRlIENhcmRMYXlvdXQgY2FyZExheW91dDsgLy8gQ2FyZExheW91dCBmb3Igc3dpdGNoaW5nIHBhbmVsc1xuICAgIHByaXZhdGUgTWFwPFN0cmluZywgSlBhbmVsPiBwYW5lbE1hcDsgLy8gQ2FjaGUgZm9yIHBhbmVsc1xuICAgIHByaXZhdGUgTGljaFRyaW5oVGF1UGFuZWwgbGljaFRyaW5oVGF1UGFuZWw7XG4gICAgcHJpdmF0ZSBOaGFuVmllbiBuaGFuVmllbjtcblxuICAgIHB1YmxpYyBNYWluR1VJKE5oYW5WaWVuIG52KSB7XG4gICAgICAgIG5oYW5WaWVuID0gbnY7XG4gICAgICAgIHNldFRpdGxlKFwiUXXhuqNuIGzDvSB0w6B1IGjhu49hXCIpO1xuICAgICAgICBzZXRTaXplKDEyMDAsIDgwMCk7XG4gICAgICAgIHNldERlZmF1bHRDbG9zZU9wZXJhdGlvbihKRnJhbWUuRVhJVF9PTl9DTE9TRSk7XG4gICAgICAgIHNldExvY2F0aW9uUmVsYXRpdmVUbyhudWxsKTtcblxuICAgICAgICAvLyBJbml0aWFsaXplIHBhbmVsIG1hcFxuICAgICAgICBwYW5lbE1hcCA9IG5ldyBIYXNoTWFwPD4oKTtcblxuICAgICAgICAvLyBDcmVhdGUgdGhlIG1haW4gbGF5b3V0XG4gICAgICAgIEpQYW5lbCBtYWluUGFuZWwgPSBuZXcgSlBhbmVsKG5ldyBCb3JkZXJMYXlvdXQoKSk7XG5cbiAgICAgICAgLy8gQ3JlYXRlIGhlYWRlclxuICAgICAgICBKUGFuZWwgaGVhZGVyUGFuZWwgPSBjcmVhdGVIZWFkZXJQYW5lbCgpO1xuICAgICAgICBtYWluUGFuZWwuYWRkKGhlYWRlclBhbmVsLCBCb3JkZXJMYXlvdXQuTk9SVEgpO1xuXG4gICAgICAgIC8vIENyZWF0ZSB2ZXJ0aWNhbCBtZW51XG4gICAgICAgIEpQYW5lbCB2ZXJ0aWNhbE1lbnUgPSBjcmVhdGVWZXJ0aWNhbE1lbnUoKTtcbiAgICAgICAgbWFpblBhbmVsLmFkZCh2ZXJ0aWNhbE1lbnUsIEJvcmRlckxheW91dC5XRVNUKTtcblxuICAgICAgICAvLyBDcmVhdGUgY29udGVudCBwYW5lbCB3aXRoIENhcmRMYXlvdXRcbiAgICAgICAgY2FyZExheW91dCA9IG5ldyBDYXJkTGF5b3V0KCk7XG4gICAgICAgIGNvbnRlbnRQYW5lbCA9IG5ldyBKUGFuZWwoY2FyZExheW91dCk7XG5cbiAgICAgICAgLy8gQWRkIGRlZmF1bHQgY29udGVudCBwYW5lbFxuICAgICAgICBKUGFuZWwgZGVmYXVsdFBhbmVsID0gY3JlYXRlRGVmYXVsdENvbnRlbnRQYW5lbCgpO1xuICAgICAgICBjb250ZW50UGFuZWwuYWRkKGRlZmF1bHRQYW5lbCwgXCJUcmFuZyBjaOG7p1wiKTtcbiAgICAgICAgcGFuZWxNYXAucHV0KFwiVHJhbmcgY2jhu6dcIiwgZGVmYXVsdFBhbmVsKTtcblxuICAgICAgICBtYWluUGFuZWwuYWRkKGNvbnRlbnRQYW5lbCwgQm9yZGVyTGF5b3V0LkNFTlRFUik7XG5cbiAgICAgICAgYWRkKG1haW5QYW5lbCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBKUGFuZWwgY3JlYXRlSGVhZGVyUGFuZWwoKSB7XG4gICAgICAgIEpQYW5lbCBoZWFkZXJQYW5lbCA9IG5ldyBKUGFuZWwobmV3IEJvcmRlckxheW91dCgpKTtcbiAgICAgICAgaGVhZGVyUGFuZWwuc2V0QmFja2dyb3VuZChuZXcgQ29sb3IoNDEsIDEyOCwgMTg1KSk7IC8vIEJsdWUgaGVhZGVyIGJhY2tncm91bmRcbiAgICAgICAgaGVhZGVyUGFuZWwuc2V0UHJlZmVycmVkU2l6ZShuZXcgRGltZW5zaW9uKDAsIDYwKSk7XG5cbiAgICAgICAgSkxhYmVsIHRpdGxlTGFiZWwgPSBuZXcgSkxhYmVsKFwiSOG7hyB0aOG7kW5nIHF14bqjbiBsw70gdMOgdSBo4buPYVwiLCBKTGFiZWwuQ0VOVEVSKTtcbiAgICAgICAgdGl0bGVMYWJlbC5zZXRGb250KG5ldyBGb250KFwiQXJpYWxcIiwgRm9udC5CT0xELCAyNCkpO1xuICAgICAgICB0aXRsZUxhYmVsLnNldEZvcmVncm91bmQoQ29sb3IuV0hJVEUpO1xuXG4gICAgICAgIGhlYWRlclBhbmVsLmFkZCh0aXRsZUxhYmVsLCBCb3JkZXJMYXlvdXQuQ0VOVEVSKTtcbiAgICAgICAgcmV0dXJuIGhlYWRlclBhbmVsO1xuICAgIH1cbi4uLlxuXG4gICAgcHJpdmF0ZSBKUGFuZWwgY3JlYXRlVmVydGljYWxNZW51KCkge1xuICAgICAgICBKUGFuZWwgbWVudVBhbmVsID0gbmV3IEpQYW5lbCgpO1xuICAgICAgICBtZW51UGFuZWwuc2V0TGF5b3V0KG5ldyBCb3hMYXlvdXQobWVudVBhbmVsLCBCb3hMYXlvdXQuWV9BWElTKSk7XG4gICAgICAgIG1lbnVQYW5lbC5zZXRCYWNrZ3JvdW5kKG5ldyBDb2xvcig1MiwgNzMsIDk0KSk7IC8vIERhcmsgZ3JheSBtZW51IGJhY2tncm91bmRcbiAgICAgICAgbWVudVBhbmVsLnNldFByZWZlcnJlZFNpemUobmV3IERpbWVuc2lvbigyNTAsIDApKTtcblxuICAgICAgICBTdHJpbmdbXSBtZW51SXRlbXMgPSB7XG4gICAgICAgICAgICAgICAgXCJUcmFuZyBjaOG7p1wiLCBcIlRow7RuZyB0aW4gaG/huqF0IMSR4buZbmdcIiwgXCJRdeG6o24gbMO9IGtow6FjaCBow6BuZ1wiLFxuICAgICAgICAgICAgICAgIFwiUXXhuqNuIGzDvSB2w6lcIiwgXCJRdeG6o24gbMO9IGzhu4tjaCB0csOsbmhcIiwgXCJCw6FvIGPDoW9cIiwgXCJUcmEgY+G7qXUgdsOpXCIsIFwixJDhu5VpIHbDqVwiLCBcIlRy4bqjIHbDqVwiLCBcIlF14bqjbiBsw70gbmjDom4gdmnDqm5cIixcbiAgICAgICAgICAgICAgICBcIlRo4buRbmcga8OqIHPhu5EgbMaw4bujbmcgdsOpIHRoZW8gdGjhu51pIGdpYW5cIlxuICAgICAgICB9O1xuLi4uXG5cbiAgICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlXG4gICAgICAgICAgICAgICAgICAgIHByb3RlY3RlZCB2b2lkIGRvbmUoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEdldCB0aGUgcGFuZWwgYWZ0ZXIgaXQncyBjcmVhdGVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgUXVhbkx5S2hhY2hIYW5nUGFuZWwgcGFuZWwgPSBnZXQoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFkZCB0byBjYWNoZSBhbmQgZGlzcGxheVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRQYW5lbC5hZGQocGFuZWwsIHBhbmVsTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFuZWxNYXAucHV0KHBhbmVsTmFtZSwgcGFuZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRMYXlvdXQuc2hvdyhjb250ZW50UGFuZWwsIHBhbmVsTmFtZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgbG9hZGluZyBwYW5lbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRQYW5lbC5yZW1vdmUobG9hZGluZ1BhbmVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhNYWluR1VJLnRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIktow7RuZyB0aOG7gyB04bqjaSBk4buvIGxp4buHdSBraMOhY2ggaMOgbmc6IFwiICsgZS5nZXRNZXNzYWdlKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpIGvhur90IG7hu5FpXCIsIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRMYXlvdXQuc2hvdyhjb250ZW50UGFuZWwsIFwiVHJhbmcgY2jhu6dcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuLi4uXG5cbiAgICAgICAgICAgICAgICAvLyBU4bqhbyBwYW5lbCBxdeG6o24gbMO9IGzhu4tjaCB0csOsbmggdHJvbmcgbHXhu5NuZyByacOqbmdcbiAgICAgICAgICAgICAgICBTd2luZ1dvcmtlcjxMaWNoVHJpbmhUYXVQYW5lbCwgVm9pZD4gd29ya2VyID0gbmV3IFN3aW5nV29ya2VyPD4oKSB7XG4gICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZVxuICAgICAgICAgICAgICAgICAgICBwcm90ZWN0ZWQgTGljaFRyaW5oVGF1UGFuZWwgZG9JbkJhY2tncm91bmQoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IExpY2hUcmluaFRhdVBhbmVsKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGVcbiAgICAgICAgICAgICAgICAgICAgcHJvdGVjdGVkIHZvaWQgZG9uZSgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTOG6pXkgcGFuZWwgc2F1IGtoaSDEkcOjIHThuqFvIHhvbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBMaWNoVHJpbmhUYXVQYW5lbCBwYW5lbCA9IGdldCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpY2hUcmluaFRhdVBhbmVsID0gcGFuZWw7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaMOqbSB2w6BvIGNhY2hlIHbDoCBoaeG7g24gdGjhu4tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50UGFuZWwuYWRkKHBhbmVsLCBwYW5lbE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhbmVsTWFwLnB1dChwYW5lbE5hbWUsIHBhbmVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkTGF5b3V0LnNob3coY29udGVudFBhbmVsLCBwYW5lbE5hbWUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gWMOzYSBwYW5lbCBsb2FkaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFBhbmVsLnJlbW92ZShsb2FkaW5nUGFuZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKE1haW5HVUkudGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiS2jDtG5nIHRo4buDIHThuqNpIGThu68gbGnhu4d1OiBcIiArIGUuZ2V0TWVzc2FnZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaSBr4bq/dCBu4buRaVwiLCBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkTGF5b3V0LnNob3coY29udGVudFBhbmVsLCBcIlRyYW5nIGNo4bunXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4uLi5cblxuICAgICAgICAgICAgICAgIC8vIFThuqFvIHBhbmVsIHF14bqjbiBsw70gdsOpIHRyb25nIGx14buTbmcgcmnDqm5nXG4gICAgICAgICAgICAgICAgU3dpbmdXb3JrZXI8RG9pVmVQYW5lbCwgVm9pZD4gd29ya2VyID0gbmV3IFN3aW5nV29ya2VyPD4oKSB7XG4gICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZVxuICAgICAgICAgICAgICAgICAgICBwcm90ZWN0ZWQgRG9pVmVQYW5lbCBkb0luQmFja2dyb3VuZCgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRG9pVmVQYW5lbChuaGFuVmllbik7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGVcbiAgICAgICAgICAgICAgICAgICAgcHJvdGVjdGVkIHZvaWQgZG9uZSgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTOG6pXkgcGFuZWwgc2F1IGtoaSDEkcOjIHThuqFvIHhvbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBEb2lWZVBhbmVsIHBhbmVsID0gZ2V0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaMOqbSB2w6BvIGNhY2hlIHbDoCBoaeG7g24gdGjhu4tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50UGFuZWwuYWRkKHBhbmVsLCBwYW5lbE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhbmVsTWFwLnB1dChwYW5lbE5hbWUsIHBhbmVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkTGF5b3V0LnNob3coY29udGVudFBhbmVsLCBwYW5lbE5hbWUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gWMOzYSBwYW5lbCBsb2FkaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFBhbmVsLnJlbW92ZShsb2FkaW5nUGFuZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKE1haW5HVUkudGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiS2jDtG5nIHRo4buDIHThuqNpIGThu68gbGnhu4d1OiBcIiArIGUuZ2V0TWVzc2FnZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaSBr4bq/dCBu4buRaVwiLCBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkTGF5b3V0LnNob3coY29udGVudFBhbmVsLCBcIlRyYW5nIGNo4bunXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbi4uLlxuXG4gICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZVxuICAgICAgICAgICAgICAgICAgICBwcm90ZWN0ZWQgdm9pZCBkb25lKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBM4bqleSBwYW5lbCBzYXUga2hpIMSRw6MgdOG6oW8geG9uZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRyYVZlUGFuZWwgcGFuZWwgPSBnZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaMOqbSB2w6BvIGNhY2hlIHbDoCBoaeG7g24gdGjhu4tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50UGFuZWwuYWRkKHBhbmVsLCBwYW5lbE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhbmVsTWFwLnB1dChwYW5lbE5hbWUsIHBhbmVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkTGF5b3V0LnNob3coY29udGVudFBhbmVsLCBwYW5lbE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFjDs2EgcGFuZWwgbG9hZGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRQYW5lbC5yZW1vdmUobG9hZGluZ1BhbmVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhNYWluR1VJLnRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIktow7RuZyB0aOG7gyB04bqjaSBk4buvIGxp4buHdSB0cuG6oyB2w6k6IFwiICsgZS5nZXRNZXNzYWdlKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpIGvhur90IG7hu5FpXCIsIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRMYXlvdXQuc2hvdyhjb250ZW50UGFuZWwsIFwiVHJhbmcgY2jhu6dcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuLi4uXG5cbiAgICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlXG4gICAgICAgICAgICAgICAgICAgIHByb3RlY3RlZCB2b2lkIGRvbmUoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEzhuqV5IHBhbmVsIHNhdSBraGkgxJHDoyB04bqhbyB4b25nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgUXVhbkx5TmhhblZpZW5QYW5lbCBwYW5lbCA9IGdldCgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGjDqm0gdsOgbyBjYWNoZSB2w6AgaGnhu4NuIHRo4buLXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFBhbmVsLmFkZChwYW5lbCwgcGFuZWxOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYW5lbE1hcC5wdXQocGFuZWxOYW1lLCBwYW5lbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyZExheW91dC5zaG93KGNvbnRlbnRQYW5lbCwgcGFuZWxOYW1lKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFjDs2EgcGFuZWwgbG9hZGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRQYW5lbC5yZW1vdmUobG9hZGluZ1BhbmVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhNYWluR1VJLnRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIktow7RuZyB0aOG7gyB04bqjaSBk4buvIGxp4buHdSBuaMOibiB2acOqbjogXCIgKyBlLmdldE1lc3NhZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2kga+G6v3QgbuG7kWlcIiwgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyZExheW91dC5zaG93KGNvbnRlbnRQYW5lbCwgXCJUcmFuZyBjaOG7p1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4uLi5cblxuICAgICAgICAgICAgICAgIC8vIFThuqFvIHBhbmVsIHF14bqjbiBsw70gdsOpIHRyb25nIGx14buTbmcgcmnDqm5nXG4gICAgICAgICAgICAgICAgU3dpbmdXb3JrZXI8VHJhQ3V1VmVQYW5lbCwgVm9pZD4gd29ya2VyID0gbmV3IFN3aW5nV29ya2VyPD4oKSB7XG4gICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZVxuICAgICAgICAgICAgICAgICAgICBwcm90ZWN0ZWQgVHJhQ3V1VmVQYW5lbCBkb0luQmFja2dyb3VuZCgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVHJhQ3V1VmVQYW5lbCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlXG4gICAgICAgICAgICAgICAgICAgIHByb3RlY3RlZCB2b2lkIGRvbmUoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEzhuqV5IHBhbmVsIHNhdSBraGkgxJHDoyB04bqhbyB4b25nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVHJhQ3V1VmVQYW5lbCBwYW5lbCA9IGdldCgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGjDqm0gdsOgbyBjYWNoZSB2w6AgaGnhu4NuIHRo4buLXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFBhbmVsLmFkZChwYW5lbCwgcGFuZWxOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYW5lbE1hcC5wdXQocGFuZWxOYW1lLCBwYW5lbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyZExheW91dC5zaG93KGNvbnRlbnRQYW5lbCwgcGFuZWxOYW1lKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFjDs2EgcGFuZWwgbG9hZGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRQYW5lbC5yZW1vdmUobG9hZGluZ1BhbmVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhNYWluR1VJLnRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIktow7RuZyB0aOG7gyB04bqjaSBk4buvIGxp4buHdTogXCIgKyBlLmdldE1lc3NhZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2kga+G6v3QgbuG7kWlcIiwgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyZExheW91dC5zaG93KGNvbnRlbnRQYW5lbCwgXCJUcmFuZyBjaOG7p1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4uLi5cblxuICAgICAgICAgICAgICAgIC8vIFThuqFvIHBhbmVsIHF14bqjbiBsw70gdsOpIHRyb25nIGx14buTbmcgcmnDqm5nXG4gICAgICAgICAgICAgICAgU3dpbmdXb3JrZXI8VGhvbmdLZVZlUGFuZWwsIFZvaWQ+IHdvcmtlciA9IG5ldyBTd2luZ1dvcmtlcjw+KCkge1xuICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGVcbiAgICAgICAgICAgICAgICAgICAgcHJvdGVjdGVkIFRob25nS2VWZVBhbmVsIGRvSW5CYWNrZ3JvdW5kKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBUaG9uZ0tlVmVQYW5lbCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlXG4gICAgICAgICAgICAgICAgICAgIHByb3RlY3RlZCB2b2lkIGRvbmUoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEzhuqV5IHBhbmVsIHNhdSBraGkgxJHDoyB04bqhbyB4b25nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVGhvbmdLZVZlUGFuZWwgcGFuZWwgPSBnZXQoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRow6ptIHbDoG8gY2FjaGUgdsOgIGhp4buDbiB0aOG7i1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRQYW5lbC5hZGQocGFuZWwsIHBhbmVsTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFuZWxNYXAucHV0KHBhbmVsTmFtZSwgcGFuZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRMYXlvdXQuc2hvdyhjb250ZW50UGFuZWwsIHBhbmVsTmFtZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBYw7NhIHBhbmVsIGxvYWRpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50UGFuZWwucmVtb3ZlKGxvYWRpbmdQYW5lbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coTWFpbkdVSS50aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJLaMO0bmcgdGjhu4MgdOG6o2kgZOG7ryBsaeG7h3U6IFwiICsgZS5nZXRNZXNzYWdlKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpIGvhur90IG7hu5FpXCIsIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRMYXlvdXQuc2hvdyhjb250ZW50UGFuZWwsIFwiVHJhbmcgY2jhu6dcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyLmV4ZWN1dGUoKTtcbiAgICAgICAgICAgICAgICByZXR1cm47IC8vIFRob8OhdCBz4bubbVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvbW9kZWwvRG9pVHVvbmdBcER1bmcuamF2YVxucGFja2FnZSBtb2RlbDtcblxucHVibGljIGVudW0gRG9pVHVvbmdBcER1bmcge1xufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2RhdGFmYWtlci9Mb2FpQ2hvREYuamF2YVxuLi4uXG5cbnB1YmxpYyBjbGFzcyBMb2FpQ2hvREYge1xuICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBnZW5lcmF0ZVNhbXBsZURhdGEoRW50aXR5TWFuYWdlciBlbSkge1xuICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0eCA9IGVtLmdldFRyYW5zYWN0aW9uKCk7XG4gICAgICAgIEZha2VyIGZha2VyID0gbmV3IEZha2VyKCk7XG5cbiAgICAgICAgLy8gc2V0IGThu68gbGnhu4d1IGNobyBMb2FpQ2hvXG4gICAgICAgIExvYWlDaG8gbGMxID0gbmV3IExvYWlDaG8oKTtcbiAgICAgICAgbGMxLnNldE1hTG9haShcIkxDMDFcIik7XG4gICAgICAgIGxjMS5zZXRUZW5Mb2FpKFwiR2jhur8gbmfhu5NpIGPhu6luZ1wiKTtcblxuICAgICAgICBMb2FpQ2hvIGxjMiA9IG5ldyBMb2FpQ2hvKCk7XG4gICAgICAgIGxjMi5zZXRNYUxvYWkoXCJMQzAyXCIpO1xuICAgICAgICBsYzIuc2V0VGVuTG9haShcIkdo4bq/IG5n4buTaSBt4buBbVwiKTtcblxuICAgICAgICBMb2FpQ2hvIGxjMyA9IG5ldyBMb2FpQ2hvKCk7XG4gICAgICAgIGxjMy5zZXRNYUxvYWkoXCJMQzAzXCIpO1xuICAgICAgICBsYzMuc2V0VGVuTG9haShcIkdpxrDhu51uZyBu4bqxbSBt4buBbVwiKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHR4LmJlZ2luKCk7XG4gICAgICAgICAgICBlbS5wZXJzaXN0KGxjMSk7XG4gICAgICAgICAgICBlbS5wZXJzaXN0KGxjMik7XG4gICAgICAgICAgICBlbS5wZXJzaXN0KGxjMyk7XG4gICAgICAgICAgICB0eC5jb21taXQoKTtcbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIlBow6F0IHNpbmggZOG7ryBsaeG7h3UgdGjDoG5oIGPDtG5nIGNobyBMb2FpQ2hvXCIpO1xuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgdHgucm9sbGJhY2soKTtcbiAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihcIlBow6F0IHNpbmggZOG7ryBsaeG7h3UgdGjhuqV0IGLhuqFpIGNobyBMb2FpQ2hvXCIpO1xuXG4gICAgICAgIH1cbiAgICB9XG59XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGF0YWZha2VyL0xvYWlIb2FEb25ERi5qYXZhXG5wYWNrYWdlIGRhdGFmYWtlcjtcblxuXG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS5FbnRpdHlNYW5hZ2VyO1xuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuRW50aXR5VHJhbnNhY3Rpb247XG5pbXBvcnQgbW9kZWwuTG9haUhvYURvbjtcbmltcG9ydCBuZXQuZGF0YWZha2VyLkZha2VyO1xuXG5pbXBvcnQgamF2YS51dGlsLkxvY2FsZTtcblxucHVibGljIGNsYXNzIExvYWlIb2FEb25ERiB7XG4gICAgcHJpdmF0ZSBGYWtlciBmYWtlcjtcblxuICAgIHB1YmxpYyBMb2FpSG9hRG9uREYoKSB7XG4gICAgICAgIHRoaXMuZmFrZXIgPSBuZXcgRmFrZXIobmV3IExvY2FsZShcInZpXCIpKTsgLy8gS2jhu59pIHThuqFvIERhdGFmYWtlciB24bubaSBuZ8O0biBuZ+G7ryB0aeG6v25nIFZp4buHdFxuICAgIH1cblxuICAgIHB1YmxpYyBMb2FpSG9hRG9uIGdlbmVyYXRlTG9haUhvYURvbihTdHJpbmcgbWFMb2FpSG9hRG9uLCBTdHJpbmcgdGVuTG9haUhvYURvbikge1xuICAgICAgICBMb2FpSG9hRG9uIGxvYWlIb2FEb24gPSBuZXcgTG9haUhvYURvbigpO1xuICAgICAgICBsb2FpSG9hRG9uLnNldE1hTG9haUhvYURvbihtYUxvYWlIb2FEb24pOyAvLyBNw6MgbG/huqFpIGjDs2EgxJHGoW4gKMSRxrDhu6NjIHRydXnhu4FuIHbDoG8pXG4gICAgICAgIGxvYWlIb2FEb24uc2V0VGVuTG9haUhvYURvbih0ZW5Mb2FpSG9hRG9uKTsgLy8gVMOqbiBsb+G6oWkgaMOzYSDEkcahbiAobXVhLCDEkeG7lWksIHRy4bqjKVxuICAgICAgICByZXR1cm4gbG9haUhvYURvbjtcbiAgICB9XG5cbiAgICBwdWJsaWMgdm9pZCBnZW5lcmF0ZUFuZFNhdmVMb2FpSG9hRG9ucyhFbnRpdHlNYW5hZ2VyIGVtKSB7XG4gICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyYW5zYWN0aW9uID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRyYW5zYWN0aW9uLmJlZ2luKCk7XG5cbiAgICAgICAgICAgIC8vIFRow6ptIDMgbG/huqFpIGjDs2EgxJHGoW46IE11YSwgxJDhu5VpLCBUcuG6o1xuICAgICAgICAgICAgZW0ucGVyc2lzdChnZW5lcmF0ZUxvYWlIb2FEb24oXCJMSEQwMDFcIiwgXCJNdWFcIikpO1xuICAgICAgICAgICAgZW0ucGVyc2lzdChnZW5lcmF0ZUxvYWlIb2FEb24oXCJMSEQwMDJcIiwgXCLEkOG7lWlcIikpO1xuICAgICAgICAgICAgZW0ucGVyc2lzdChnZW5lcmF0ZUxvYWlIb2FEb24oXCJMSEQwMDNcIiwgXCJUcuG6o1wiKSk7XG5cbiAgICAgICAgICAgIHRyYW5zYWN0aW9uLmNvbW1pdCgpO1xuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiVGjDqm0gZOG7ryBsaeG7h3UgbeG6q3UgY2hvIExvYWlIb2FEb24gdGjDoG5oIGPDtG5nIVwiKTtcbiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgIHRyYW5zYWN0aW9uLnJvbGxiYWNrKCk7XG4gICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFwiTOG7l2kga2hpIHRow6ptIGThu68gbGnhu4d1IG3huqt1IGNobyBMb2FpSG9hRG9uIVwiKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9kYXRhZmFrZXIvVGF1REYuamF2YVxuLi4uXG5cbiAgICAgICAgICAgIC8vIFThuqFvIDEwIGThu68gbGnhu4d1IG3huqt1IGNobyBUYXVcbiAgICAgICAgICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IDEwOyBpKyspIHtcbiAgICAgICAgICAgICAgICBUYXUgdGF1ID0gbmV3IFRhdSgpO1xuICAgICAgICAgICAgICAgIHRhdS5zZXRNYVRhdShcIlRcIiArIGkpOyAvLyBNw6MgdMOgdSDEkeG7i25oIGThuqFuZyBUMSwgVDIsIC4uLlxuICAgICAgICAgICAgICAgIHRhdS5zZXRUZW5UYXUoXCJUw6B1IFwiICsgZmFrZXIubmFtZSgpLmxhc3ROYW1lKCkpOyAvLyBUw6puIHTDoHUgduG7m2kgaOG7jSBuZ+G6q3Ugbmhpw6puXG4gICAgICAgICAgICAgICAgdGF1LnNldFNvVG9hKGZha2VyLm51bWJlcigpLm51bWJlckJldHdlZW4oNSwgMjApKTsgLy8gU+G7kSB0b2EgdOG7qyA1IMSR4bq/biAyMFxuXG4gICAgICAgICAgICAgICAgLy8gTGnDqm4ga+G6v3QgduG7m2kgbeG7mXQgVHV5ZW5UYXUgbmfhuqt1IG5oacOqblxuICAgICAgICAgICAgICAgIFR1eWVuVGF1IHJhbmRvbVR1eWVuVGF1ID0gdHV5ZW5UYXVMaXN0LmdldChmYWtlci5udW1iZXIoKS5udW1iZXJCZXR3ZWVuKDAsIHR1eWVuVGF1TGlzdC5zaXplKCkpKTtcbiAgICAgICAgICAgICAgICB0YXUuc2V0VHV5ZW5UYXUocmFuZG9tVHV5ZW5UYXUpO1xuXG4gICAgICAgICAgICAgICAgLy8gTMawdSDEkeG7kWkgdMaw4bujbmcgVGF1IHbDoG8gY8ahIHPhu58gZOG7ryBsaeG7h3VcbiAgICAgICAgICAgICAgICBlbS5wZXJzaXN0KHRhdSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRyYW5zYWN0aW9uLmNvbW1pdCgpO1xuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiROG7ryBsaeG7h3UgbeG6q3UgY2hvIFRhdSDEkcOjIMSRxrDhu6NjIHThuqFvIHRow6BuaCBjw7RuZy5cIik7XG4gICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICBpZiAodHJhbnNhY3Rpb24uaXNBY3RpdmUoKSkge1xuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uLnJvbGxiYWNrKCk7XG4gICAgICAgICAgICB9XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGF0YWZha2VyL0todXllbk1haURGLmphdmFcbi4uLlxuXG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTtcbiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgMTU7IGkrKykge1xuICAgICAgICAgICAgICAgIEtodXllbk1haSBraHV5ZW5NYWkgPSBuZXcgS2h1eWVuTWFpKCk7XG4gICAgICAgICAgICAgICAga2h1eWVuTWFpLnNldE1hS00oZ2VuZXJhdGVOZXh0TWFLTShlbSkpOyAvLyBTaW5oIG3DoyB04buxIMSR4buZbmdcbiAgICAgICAgICAgICAgICBraHV5ZW5NYWkuc2V0VGVuS00oXCJLaHV54bq/biBtw6NpIHPhu5EgXCIgKyAoaSArIDEpKTtcbiAgICAgICAgICAgICAgICBraHV5ZW5NYWkuc2V0VGhvaUdpYW5CYXREYXUoTG9jYWxEYXRlLm5vdygpLm1pbnVzRGF5cyhpKSk7XG4gICAgICAgICAgICAgICAga2h1eWVuTWFpLnNldFRob2lHaWFuS2V0VGh1YyhMb2NhbERhdGUubm93KCkucGx1c0RheXMoaSArIDEwKSk7XG4gICAgICAgICAgICAgICAga2h1eWVuTWFpLnNldE5vaUR1bmdLTShcIkdp4bqjbSBnacOhIFwiICsgKDEwICsgaSkgKyBcIiUgY2hvIGtow6FjaCBow6BuZ1wiKTtcbiAgICAgICAgICAgICAgICBraHV5ZW5NYWkuc2V0Q2hpZXRLaGF1KDEwICsgaSk7XG4gICAgICAgICAgICAgICAga2h1eWVuTWFpLnNldERvaVR1b25nQXBEdW5nKFwiS2jDoWNoIGjDoG5nIGxv4bqhaSBcIiArIChpICUgMyArIDEpKTtcbiAgICAgICAgICAgICAgICBraHV5ZW5NYWkuc2V0VHJhbmdUaGFpKGkgJSAyID09IDAgPyBcIsSQYW5nIMOhcCBk4bulbmdcIiA6IFwiSOG6v3QgaOG6oW5cIik7XG5cbiAgICAgICAgICAgICAgICBlbS5wZXJzaXN0KGtodXllbk1haSk7IC8vIEzGsHUgdsOgbyBjxqEgc+G7nyBk4buvIGxp4buHdVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTtcbiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkucm9sbGJhY2soKTtcbiAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cblxufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2RhdGFmYWtlci9Mb2FpVG9hREYuamF2YVxuLi4uXG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRyYW5zYWN0aW9uLmJlZ2luKCk7XG5cbiAgICAgICAgICAgIC8vIFThuqFvIDEwIGThu68gbGnhu4d1IG3huqt1IGNobyBMb2FpVG9hXG4gICAgICAgICAgICBmb3IgKGludCBpID0gMTsgaSA8PSAxMDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgTG9haVRvYSBsb2FpVG9hID0gbmV3IExvYWlUb2EoKTtcbiAgICAgICAgICAgICAgICBsb2FpVG9hLnNldE1hTG9haShcIkxUXCIgKyBpKTsgLy8gxJDhurd0IG3DoyBsb+G6oWkgxJHhu4tuaCBk4bqhbmcgTFQxLCBMVDIsIC4uLlxuICAgICAgICAgICAgICAgIGxvYWlUb2Euc2V0VGVuTG9haShcIkxv4bqhaSB0b2EgXCIgKyBmYWtlci5jb21tZXJjZSgpLnByb2R1Y3ROYW1lKCkpOyAvLyBUw6puIGxv4bqhaSB24bubaSBtw7QgdOG6oyB04burIEZha2VyXG4gICAgICAgICAgICAgICAgLy8gTMawdSB2w6BvIGPGoSBz4bufIGThu68gbGnhu4d1XG4gICAgICAgICAgICAgICAgZW0ucGVyc2lzdChsb2FpVG9hKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdHJhbnNhY3Rpb24uY29tbWl0KCk7XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJE4buvIGxp4buHdSBt4bqrdSBjaG8gTG9haVRvYSDEkcOjIMSRxrDhu6NjIHThuqFvIHRow6BuaCBjw7RuZy5cIik7XG4gICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICBpZiAodHJhbnNhY3Rpb24uaXNBY3RpdmUoKSkge1xuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uLnJvbGxiYWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFwixJDDoyB44bqjeSByYSBs4buXaSBraGkgdOG6oW8gZOG7ryBsaeG7h3UgbeG6q3UgY2hvIExvYWlUb2EuXCIpO1xuICAgICAgICB9XG4gICAgfVxufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2RhdGFmYWtlci9UdXllblRhdURGLmphdmFcbi4uLlxuXG4gICAgICAgICAgICAvLyBU4bqhbyAxMCBk4buvIGxp4buHdSBt4bqrdSBjaG8gVHV5ZW5UYXVcbiAgICAgICAgICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IDEwOyBpKyspIHtcbiAgICAgICAgICAgICAgICBUdXllblRhdSB0dXllblRhdSA9IG5ldyBUdXllblRhdSgpO1xuICAgICAgICAgICAgICAgIHR1eWVuVGF1LnNldE1hVHV5ZW4oXCJUVFwiICsgaSk7IC8vIE3DoyB0dXnhur9uIMSR4buLbmggZOG6oW5nIFRUMSwgVFQyLCAuLi5cbiAgICAgICAgICAgICAgICB0dXllblRhdS5zZXRUZW5UdXllbihcIlR1eeG6v24gXCIgKyBmYWtlci5hZGRyZXNzKCkuY2l0eU5hbWUoKSArIFwiIC0gXCIgKyBmYWtlci5hZGRyZXNzKCkuY2l0eU5hbWUoKSk7IC8vIFTDqm4gdHV54bq/biB24bubaSB0aMOgbmggcGjhu5Egbmfhuqt1IG5oacOqblxuICAgICAgICAgICAgICAgIHR1eWVuVGF1LnNldEdhRGkoZmFrZXIuYWRkcmVzcygpLnN0cmVldE5hbWUoKSk7IC8vIEdhIMSRaSBuZ+G6q3Ugbmhpw6puXG4gICAgICAgICAgICAgICAgdHV5ZW5UYXUuc2V0R2FEZW4oZmFrZXIuYWRkcmVzcygpLnN0cmVldE5hbWUoKSk7IC8vIEdhIMSR4bq/biBuZ+G6q3Ugbmhpw6puXG4gICAgICAgICAgICAgICAgdHV5ZW5UYXUuc2V0RGlhRGllbURpKGZha2VyLmFkZHJlc3MoKS5jaXR5TmFtZSgpICsgXCIsIFwiICsgZmFrZXIuYWRkcmVzcygpLmNvdW50cnkoKSk7IC8vIMSQ4buLYSDEkWnhu4NtIMSRaSAodGjDoG5oIHBo4buRLCBxdeG7kWMgZ2lhKVxuICAgICAgICAgICAgICAgIHR1eWVuVGF1LnNldERpYURpZW1EZW4oZmFrZXIuYWRkcmVzcygpLmNpdHlOYW1lKCkgKyBcIiwgXCIgKyBmYWtlci5hZGRyZXNzKCkuY291bnRyeSgpKTsgLy8gxJDhu4thIMSRaeG7g20gxJHhur9uICh0aMOgbmggcGjhu5EsIHF14buRYyBnaWEpXG5cbiAgICAgICAgICAgICAgICAvLyBMxrB1IMSR4buRaSB0xrDhu6NuZyBUdXllblRhdSB2w6BvIGPGoSBz4bufIGThu68gbGnhu4d1XG4gICAgICAgICAgICAgICAgZW0ucGVyc2lzdCh0dXllblRhdSk7XG4gICAgICAgICAgICB9XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGF0YWZha2VyL0toYWNoSGFuZ0RGLmphdmFcbi4uLlxuICAgICAgICBraGFjaEhhbmcuc2V0TmdheVRoYW1nR2lhKExvY2FsRGF0ZS5ub3coKS5taW51c0RheXMoZmFrZXIubnVtYmVyKCkubnVtYmVyQmV0d2VlbigxLCAzNjUpKSk7IC8vIE5nw6B5IHRoYW0gZ2lhXG4gICAgICAgIGtoYWNoSGFuZy5zZXRIYW5nVGhhbmhWaWVuKGZha2VyLm9wdGlvbnMoKS5vcHRpb24oXCJC4bqhY1wiLCBcIlbDoG5nXCIsIFwiS2ltIEPGsMahbmdcIikpOyAvLyBI4bqhbmcgdGjDoG5oIHZpw6puXG5cbiAgICAgICAgLy8gR8OhbiBuZ+G6q3Ugbmhpw6puIGxv4bqhaSBraMOhY2ggaMOgbmcgdOG7qyBkYW5oIHPDoWNoIMSRw6MgdOG6oW9cbiAgICAgICAga2hhY2hIYW5nLnNldExvYWlLaGFjaEhhbmcobG9haUtoYWNoSGFuZ0xpc3QuZ2V0KHJhbmRvbS5uZXh0SW50KGxvYWlLaGFjaEhhbmdMaXN0LnNpemUoKSkpKTtcblxuICAgICAgICByZXR1cm4ga2hhY2hIYW5nO1xuICAgIH1cblxuICAgIC8vIEjDoG0gbMawdSBk4buvIGxp4buHdSBnaeG6oyBs4bqtcCB2w6BvIERCXG4gICAgcHVibGljICB2b2lkIGdlbmVyYXRlQW5kUHJpbnRTYW1wbGVEYXRhKCkge1xuICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gUGVyc2lzdGVuY2VcbiAgICAgICAgICAgICAgICAuY3JlYXRlRW50aXR5TWFuYWdlckZhY3RvcnkoXCJtYXJpYWRiXCIpXG4gICAgICAgICAgICAgICAgLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTtcbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9tb2RlbC9UcmFuZ1RoYWkuamF2YVxucGFja2FnZSBtb2RlbDtcblxucHVibGljIGVudW0gVHJhbmdUaGFpIHtcbiAgICBEQV9LSE9JX0hBTkgoXCLEkMOjIGto4bufaSBow6BuaFwiKSxcbiAgICBDSFVBX0tIT0lfSEFOSChcIkNoxrBhIGto4bufaSBow6BuaFwiKSxcbiAgICBEQV9IVVkoXCLEkMOjIGjhu6d5XCIpLFxuICAgIEhPQVRfRE9ORyhcIkhv4bqhdCDEkeG7mW5nXCIpO1xuXG4gICAgcHJpdmF0ZSBmaW5hbCBTdHJpbmcgdmFsdWU7XG5cbiAgICBUcmFuZ1RoYWkoU3RyaW5nIHZhbHVlKSB7XG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgU3RyaW5nIGdldFZhbHVlKCkge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBUcmFuZ1RoYWkgZnJvbVZhbHVlKFN0cmluZyB2YWx1ZSkge1xuICAgICAgICBmb3IgKFRyYW5nVGhhaSBzdGF0dXMgOiBUcmFuZ1RoYWkudmFsdWVzKCkpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMudmFsdWUuZXF1YWxzKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzdGF0dXM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgLi4uIiwiaXNfZXJyb3IiOmZhbHNlLCJyZXF1ZXN0X2lkIjoiIiwidG9vbF91c2VfaWQiOiJ0b29sdV8wMVRQejhRQlkzb1NldGViZjliY2pSb3IifX0seyJpZCI6MiwidHlwZSI6NCwiaWRlX3N0YXRlX25vZGUiOnsid29ya3NwYWNlRm9sZGVycyI6W3sicmVwb3NpdG9yeVJvb3QiOiJFOi9MVFBUSkFWQS9OaG9tL1BoYW5UYW5KYXZhTmhvbUdQVC9Qcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyIsImZvbGRlclJvb3QiOiJFOi9MVFBUSkFWQS9OaG9tL1BoYW5UYW5KYXZhTmhvbUdQVC9Qcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyJ9XSwid29ya3NwYWNlRm9sZGVyc1VuY2hhbmdlZCI6ZmFsc2V9fV0sInJlc3BvbnNlX3RleHQiOiJOb3cgSSBoYXZlIGFsbCB0aGUgaW5mb3JtYXRpb24gSSBuZWVkIHRvIGNyZWF0ZSB0aGUgcHJvbW90aW9uIG1hbmFnZW1lbnQgcGFuZWwuIExldCdzIHN0YXJ0IGJ5IGltcGxlbWVudGluZyB0aGUgbmVjZXNzYXJ5IGNvbXBvbmVudHM6XG5cbjEuIEZpcnN0LCBsZXQncyBjcmVhdGUgdGhlIEtodXllbk1haURBTyBpbnRlcmZhY2U6XG4iLCJ3b3Jrc3BhY2VfZmlsZV9jaHVua3MiOltdfSx7InN0YXR1cyI6InN1Y2Nlc3MiLCJyZXF1ZXN0X2lkIjoiNGYwZDEzNWYtN2ZkNS00MGVlLTg5YmEtYjY4ZGNiNzI3N2NmIiwicmVxdWVzdF9tZXNzYWdlIjoiIiwic3RydWN0dXJlZF9vdXRwdXRfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjo1LCJjb250ZW50IjoiIiwidG9vbF91c2UiOnsidG9vbF91c2VfaWQiOiJ0b29sdV8wMUM0U2J5MldoUkF2S3dXR1kyRjNRTW4iLCJ0b29sX25hbWUiOiJzYXZlLWZpbGUiLCJpbnB1dF9qc29uIjoie1wiZmlsZV9wYXRoXCI6IFwic3JjL21haW4vamF2YS9kYW8vaW1wbC9LaHV5ZW5NYWlEQU9JbXBsLmphdmFcIiwgXCJmaWxlX2NvbnRlbnRcIjogXCJwYWNrYWdlIGRhby5pbXBsO1xcblxcbmltcG9ydCBkYW8uS2h1eWVuTWFpREFPO1xcbmltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXI7XFxuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuRW50aXR5VHJhbnNhY3Rpb247XFxuaW1wb3J0IGxvbWJvay5BbGxBcmdzQ29uc3RydWN0b3I7XFxuaW1wb3J0IG1vZGVsLktodXllbk1haTtcXG5pbXBvcnQgdXRpbC5KUEFVdGlsO1xcblxcbmltcG9ydCBqYXZhLnJtaS5SZW1vdGVFeGNlcHRpb247XFxuaW1wb3J0IGphdmEucm1pLnNlcnZlci5VbmljYXN0UmVtb3RlT2JqZWN0O1xcbmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlO1xcbmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0O1xcbmltcG9ydCBqYXZhLnV0aWwuTGlzdDtcXG5cXG5AQWxsQXJnc0NvbnN0cnVjdG9yXFxucHVibGljIGNsYXNzIEtodXllbk1haURBT0ltcGwgZXh0ZW5kcyBVbmljYXN0UmVtb3RlT2JqZWN0IGltcGxlbWVudHMgS2h1eWVuTWFpREFPIHtcXG5cXG4gICAgcHJpdmF0ZSBFbnRpdHlNYW5hZ2VyIGVtO1xcbiAgICBcXG4gICAgcHVibGljIEtodXllbk1haURBT0ltcGwoKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uIHtcXG4gICAgICAgIHRoaXMuZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcXG4gICAgfVxcbiAgICBcXG4gICAgLy8gTFxcdTFlYTV5IGRhbmggc1xcdTAwZTFjaCB0XFx1MWVhNXQgY1xcdTFlYTMgY1xcdTAwZTFjIGtodXlcXHUxZWJmbiBtXFx1MDBlM2lcXG4gICAgQE92ZXJyaWRlXFxuICAgIHB1YmxpYyBMaXN0PEtodXllbk1haT4gZmluZEFsbCgpIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xcbiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IEpQQVV0aWwuZ2V0RW50aXR5TWFuYWdlcigpO1xcbiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHggPSBlbS5nZXRUcmFuc2FjdGlvbigpO1xcbiAgICAgICAgTGlzdDxLaHV5ZW5NYWk+IHJlc3VsdCA9IG5ldyBBcnJheUxpc3Q8PigpO1xcbiAgICAgICAgXFxuICAgICAgICB0cnkge1xcbiAgICAgICAgICAgIHR4LmJlZ2luKCk7XFxuICAgICAgICAgICAgU3RyaW5nIHF1ZXJ5ID0gXFxcInNlbGVjdCBrbSBmcm9tIEtodXllbk1haSBrbVxcXCI7XFxuICAgICAgICAgICAgcmVzdWx0ID0gZW0uY3JlYXRlUXVlcnkocXVlcnksIEtodXllbk1haS5jbGFzcykuZ2V0UmVzdWx0TGlzdCgpO1xcbiAgICAgICAgICAgIHR4LmNvbW1pdCgpO1xcbiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcXG4gICAgICAgICAgICBpZiAodHguaXNBY3RpdmUoKSkge1xcbiAgICAgICAgICAgICAgICB0eC5yb2xsYmFjaygpO1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xcbiAgICAgICAgICAgIHRocm93IG5ldyBSZW1vdGVFeGNlcHRpb24oXFxcIkxcXHUxZWQ3aSBraGkgbFxcdTFlYTV5IGRhbmggc1xcdTAwZTFjaCBraHV5XFx1MWViZm4gbVxcdTAwZTNpXFxcIiwgZSk7XFxuICAgICAgICB9IGZpbmFsbHkge1xcbiAgICAgICAgICAgIGlmIChlbSAhPSBudWxsICYmIGVtLmlzT3BlbigpKSB7XFxuICAgICAgICAgICAgICAgIGVtLmNsb3NlKCk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgfVxcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcXG4gICAgfVxcblxcbiAgICAvLyBMXFx1MWVhNXkgZGFuaCBzXFx1MDBlMWNoIGtodXlcXHUxZWJmbiBtXFx1MDBlM2kgdGhlbyB0XFx1MDBlYW5cXG4gICAgQE92ZXJyaWRlXFxuICAgIHB1YmxpYyBMaXN0PEtodXllbk1haT4gZmluZEJ5TmFtZShTdHJpbmcgbmFtZSkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XFxuICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gSlBBVXRpbC5nZXRFbnRpdHlNYW5hZ2VyKCk7XFxuICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0eCA9IGVtLmdldFRyYW5zYWN0aW9uKCk7XFxuICAgICAgICBMaXN0PEtodXllbk1haT4gcmVzdWx0ID0gbmV3IEFycmF5TGlzdDw+KCk7XFxuICAgICAgICBcXG4gICAgICAgIHRyeSB7XFxuICAgICAgICAgICAgdHguYmVnaW4oKTtcXG4gICAgICAgICAgICBTdHJpbmcgcXVlcnkgPSBcXFwic2VsZWN0IGttIGZyb20gS2h1eWVuTWFpIGttIHdoZXJlIGttLnRlbktNIGxpa2UgOm5hbWVcXFwiO1xcbiAgICAgICAgICAgIHJlc3VsdCA9IGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5LCBLaHV5ZW5NYWkuY2xhc3MpXFxuICAgICAgICAgICAgICAgICAgICAuc2V0UGFyYW1ldGVyKFxcXCJuYW1lXFxcIiwgXFxcIiVcXFwiICsgbmFtZSArIFxcXCIlXFxcIilcXG4gICAgICAgICAgICAgICAgICAgIC5nZXRSZXN1bHRMaXN0KCk7XFxuICAgICAgICAgICAgdHguY29tbWl0KCk7XFxuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xcbiAgICAgICAgICAgIGlmICh0eC5pc0FjdGl2ZSgpKSB7XFxuICAgICAgICAgICAgICAgIHR4LnJvbGxiYWNrKCk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XFxuICAgICAgICAgICAgdGhyb3cgbmV3IFJlbW90ZUV4Y2VwdGlvbihcXFwiTFxcdTFlZDdpIGtoaSB0XFx1MDBlY20ga2h1eVxcdTFlYmZuIG1cXHUwMGUzaSB0aGVvIHRcXHUwMGVhblxcXCIsIGUpO1xcbiAgICAgICAgfSBmaW5hbGx5IHtcXG4gICAgICAgICAgICBpZiAoZW0gIT0gbnVsbCAmJiBlbS5pc09wZW4oKSkge1xcbiAgICAgICAgICAgICAgICBlbS5jbG9zZSgpO1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgIH1cXG4gICAgICAgIHJldHVybiByZXN1bHQ7XFxuICAgIH1cXG5cXG4gICAgLy8gTFxcdTFlYTV5IGtodXlcXHUxZWJmbiBtXFx1MDBlM2kgdGhlbyBtXFx1MDBlM1xcbiAgICBAT3ZlcnJpZGVcXG4gICAgcHVibGljIEtodXllbk1haSBmaW5kQnlJZChTdHJpbmcgaWQpIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xcbiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IEpQQVV0aWwuZ2V0RW50aXR5TWFuYWdlcigpO1xcbiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHggPSBlbS5nZXRUcmFuc2FjdGlvbigpO1xcbiAgICAgICAgS2h1eWVuTWFpIHJlc3VsdCA9IG51bGw7XFxuICAgICAgICBcXG4gICAgICAgIHRyeSB7XFxuICAgICAgICAgICAgdHguYmVnaW4oKTtcXG4gICAgICAgICAgICByZXN1bHQgPSBlbS5maW5kKEtodXllbk1haS5jbGFzcywgaWQpO1xcbiAgICAgICAgICAgIHR4LmNvbW1pdCgpO1xcbiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcXG4gICAgICAgICAgICBpZiAodHguaXNBY3RpdmUoKSkge1xcbiAgICAgICAgICAgICAgICB0eC5yb2xsYmFjaygpO1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xcbiAgICAgICAgICAgIHRocm93IG5ldyBSZW1vdGVFeGNlcHRpb24oXFxcIkxcXHUxZWQ3aSBraGkgdFxcdTAwZWNtIGtodXlcXHUxZWJmbiBtXFx1MDBlM2kgdGhlbyBtXFx1MDBlM1xcXCIsIGUpO1xcbiAgICAgICAgfSBmaW5hbGx5IHtcXG4gICAgICAgICAgICBpZiAoZW0gIT0gbnVsbCAmJiBlbS5pc09wZW4oKSkge1xcbiAgICAgICAgICAgICAgICBlbS5jbG9zZSgpO1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgIH1cXG4gICAgICAgIHJldHVybiByZXN1bHQ7XFxuICAgIH1cXG5cXG4gICAgLy8gVGhcXHUwMGVhbSBob1xcdTFlYjdjIGNcXHUxZWFkcCBuaFxcdTFlYWR0IGtodXlcXHUxZWJmbiBtXFx1MDBlM2lcXG4gICAgQE92ZXJyaWRlXFxuICAgIHB1YmxpYyBib29sZWFuIHNhdmUoS2h1eWVuTWFpIGtodXllbk1haSkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XFxuICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gSlBBVXRpbC5nZXRFbnRpdHlNYW5hZ2VyKCk7XFxuICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0eCA9IGVtLmdldFRyYW5zYWN0aW9uKCk7XFxuICAgICAgICBcXG4gICAgICAgIHRyeSB7XFxuICAgICAgICAgICAgdHguYmVnaW4oKTtcXG4gICAgICAgICAgICBpZiAoZW0uZmluZChLaHV5ZW5NYWkuY2xhc3MsIGtodXllbk1haS5nZXRNYUtNKCkpID09IG51bGwpIHtcXG4gICAgICAgICAgICAgICAgZW0ucGVyc2lzdChraHV5ZW5NYWkpOyAvLyBUaFxcdTAwZWFtIG1cXHUxZWRiaVxcbiAgICAgICAgICAgIH0gZWxzZSB7XFxuICAgICAgICAgICAgICAgIGVtLm1lcmdlKGtodXllbk1haSk7IC8vIENcXHUxZWFkcCBuaFxcdTFlYWR0XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIHR4LmNvbW1pdCgpO1xcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xcbiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcXG4gICAgICAgICAgICBpZiAodHguaXNBY3RpdmUoKSkge1xcbiAgICAgICAgICAgICAgICB0eC5yb2xsYmFjaygpO1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xcbiAgICAgICAgICAgIHRocm93IG5ldyBSZW1vdGVFeGNlcHRpb24oXFxcIkxcXHUxZWQ3aSBraGkgbFxcdTAxYjB1IGtodXlcXHUxZWJmbiBtXFx1MDBlM2lcXFwiLCBlKTtcXG4gICAgICAgIH0gZmluYWxseSB7XFxuICAgICAgICAgICAgaWYgKGVtICE9IG51bGwgJiYgZW0uaXNPcGVuKCkpIHtcXG4gICAgICAgICAgICAgICAgZW0uY2xvc2UoKTtcXG4gICAgICAgICAgICB9XFxuICAgICAgICB9XFxuICAgIH1cXG5cXG4gICAgLy8gWFxcdTAwZjNhIGtodXlcXHUxZWJmbiBtXFx1MDBlM2kgdGhlbyBtXFx1MDBlM1xcbiAgICBAT3ZlcnJpZGVcXG4gICAgcHVibGljIGJvb2xlYW4gZGVsZXRlKFN0cmluZyBpZCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XFxuICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gSlBBVXRpbC5nZXRFbnRpdHlNYW5hZ2VyKCk7XFxuICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0eCA9IGVtLmdldFRyYW5zYWN0aW9uKCk7XFxuICAgICAgICBcXG4gICAgICAgIHRyeSB7XFxuICAgICAgICAgICAgdHguYmVnaW4oKTtcXG4gICAgICAgICAgICBLaHV5ZW5NYWkga20gPSBlbS5maW5kKEtodXllbk1haS5jbGFzcywgaWQpO1xcbiAgICAgICAgICAgIGlmIChrbSAhPSBudWxsKSB7XFxuICAgICAgICAgICAgICAgIGVtLnJlbW92ZShrbSk7XFxuICAgICAgICAgICAgICAgIHR4LmNvbW1pdCgpO1xcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcXG4gICAgICAgICAgICB9XFxuICAgICAgICAgICAgdHguY29tbWl0KCk7XFxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xcbiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcXG4gICAgICAgICAgICBpZiAodHguaXNBY3RpdmUoKSkge1xcbiAgICAgICAgICAgICAgICB0eC5yb2xsYmFjaygpO1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xcbiAgICAgICAgICAgIHRocm93IG5ldyBSZW1vdGVFeGNlcHRpb24oXFxcIkxcXHUxZWQ3aSBraGkgeFxcdTAwZjNhIGtodXlcXHUxZWJmbiBtXFx1MDBlM2lcXFwiLCBlKTtcXG4gICAgICAgIH0gZmluYWxseSB7XFxuICAgICAgICAgICAgaWYgKGVtICE9IG51bGwgJiYgZW0uaXNPcGVuKCkpIHtcXG4gICAgICAgICAgICAgICAgZW0uY2xvc2UoKTtcXG4gICAgICAgICAgICB9XFxuICAgICAgICB9XFxuICAgIH1cXG4gICAgXFxuICAgIC8vIFRcXHUwMGVjbSBjXFx1MDBlMWMga2h1eVxcdTFlYmZuIG1cXHUwMGUzaSBcXHUwMTExYW5nIFxcdTAwZTFwIGRcXHUxZWU1bmdcXG4gICAgQE92ZXJyaWRlXFxuICAgIHB1YmxpYyBMaXN0PEtodXllbk1haT4gZmluZE9uZ29pbmdQcm9tb3Rpb25zKCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XFxuICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gSlBBVXRpbC5nZXRFbnRpdHlNYW5hZ2VyKCk7XFxuICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0eCA9IGVtLmdldFRyYW5zYWN0aW9uKCk7XFxuICAgICAgICBMaXN0PEtodXllbk1haT4gcmVzdWx0ID0gbmV3IEFycmF5TGlzdDw+KCk7XFxuICAgICAgICBcXG4gICAgICAgIHRyeSB7XFxuICAgICAgICAgICAgdHguYmVnaW4oKTtcXG4gICAgICAgICAgICBTdHJpbmcgcXVlcnkgPSBcXFwic2VsZWN0IGttIGZyb20gS2h1eWVuTWFpIGttIFxcXCIgK1xcbiAgICAgICAgICAgICAgICAgICAgXFxcIndoZXJlIGttLnRyYW5nVGhhaSA9IDp0cmFuZ1RoYWkgXFxcIiArXFxuICAgICAgICAgICAgICAgICAgICBcXFwiYW5kIGttLnRob2lHaWFuQmF0RGF1IDw9IDp0b2RheSBcXFwiICtcXG4gICAgICAgICAgICAgICAgICAgIFxcXCJhbmQga20udGhvaUdpYW5LZXRUaHVjID49IDp0b2RheVxcXCI7XFxuXFxuICAgICAgICAgICAgcmVzdWx0ID0gZW0uY3JlYXRlUXVlcnkocXVlcnksIEtodXllbk1haS5jbGFzcylcXG4gICAgICAgICAgICAgICAgICAgIC5zZXRQYXJhbWV0ZXIoXFxcInRyYW5nVGhhaVxcXCIsIFxcXCJcXHUwMTEwYW5nIGRpXFx1MWVjNW4gcmFcXFwiKVxcbiAgICAgICAgICAgICAgICAgICAgLnNldFBhcmFtZXRlcihcXFwidG9kYXlcXFwiLCBMb2NhbERhdGUubm93KCkpXFxuICAgICAgICAgICAgICAgICAgICAuZ2V0UmVzdWx0TGlzdCgpO1xcbiAgICAgICAgICAgIHR4LmNvbW1pdCgpO1xcbiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcXG4gICAgICAgICAgICBpZiAodHguaXNBY3RpdmUoKSkge1xcbiAgICAgICAgICAgICAgICB0eC5yb2xsYmFjaygpO1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xcbiAgICAgICAgICAgIHRocm93IG5ldyBSZW1vdGVFeGNlcHRpb24oXFxcIkxcXHUxZWQ3aSBraGkgdFxcdTAwZWNtIGtodXlcXHUxZWJmbiBtXFx1MDBlM2kgXFx1MDExMWFuZyBcXHUwMGUxcCBkXFx1MWVlNW5nXFxcIiwgZSk7XFxuICAgICAgICB9IGZpbmFsbHkge1xcbiAgICAgICAgICAgIGlmIChlbSAhPSBudWxsICYmIGVtLmlzT3BlbigpKSB7XFxuICAgICAgICAgICAgICAgIGVtLmNsb3NlKCk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgfVxcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcXG4gICAgfVxcbiAgICBcXG4gICAgQE92ZXJyaWRlXFxuICAgIHB1YmxpYyBib29sZWFuIHRlc3RDb25uZWN0aW9uKCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XFxuICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gSlBBVXRpbC5nZXRFbnRpdHlNYW5hZ2VyKCk7XFxuICAgICAgICB0cnkge1xcbiAgICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTtcXG4gICAgICAgICAgICBlbS5jcmVhdGVRdWVyeShcXFwiU0VMRUNUIDFcXFwiKS5nZXRSZXN1bHRMaXN0KCk7XFxuICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTtcXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcXG4gICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XFxuICAgICAgICAgICAgaWYgKGVtLmdldFRyYW5zYWN0aW9uKCkuaXNBY3RpdmUoKSkge1xcbiAgICAgICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLnJvbGxiYWNrKCk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XFxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xcbiAgICAgICAgfSBmaW5hbGx5IHtcXG4gICAgICAgICAgICBpZiAoZW0gIT0gbnVsbCAmJiBlbS5pc09wZW4oKSkge1xcbiAgICAgICAgICAgICAgICBlbS5jbG9zZSgpO1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgIH1cXG4gICAgfVxcbn1cIn0ifX0seyJpZCI6MCwidHlwZSI6MCwiY29udGVudCI6IjIuIE5vdywgbGV0J3MgdXBkYXRlIHRoZSBLaHV5ZW5NYWlEQU9JbXBsIHRvIGltcGxlbWVudCB0aGUgaW50ZXJmYWNlOlxuIn0seyJpZCI6MiwidHlwZSI6MiwiY29udGVudCI6IiJ9LHsiaWQiOjMsInR5cGUiOjMsImNvbnRlbnQiOiIifV0sInNlZW5fc3RhdGUiOiJzZWVuIiwic3RydWN0dXJlZF9yZXF1ZXN0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6MSwidG9vbF9yZXN1bHRfbm9kZSI6eyJjb250ZW50IjoiRmlsZSBzYXZlZCBzdWNjZXNzZnVsbHkuIiwiaXNfZXJyb3IiOmZhbHNlLCJyZXF1ZXN0X2lkIjoiIiwidG9vbF91c2VfaWQiOiJ0b29sdV8wMVVrZjI0S0x6RXcydVozaXZ4ZFM0RVkifX0seyJpZCI6MiwidHlwZSI6NCwiaWRlX3N0YXRlX25vZGUiOnsid29ya3NwYWNlRm9sZGVycyI6W3sicmVwb3NpdG9yeVJvb3QiOiJFOi9MVFBUSkFWQS9OaG9tL1BoYW5UYW5KYXZhTmhvbUdQVC9Qcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyIsImZvbGRlclJvb3QiOiJFOi9MVFBUSkFWQS9OaG9tL1BoYW5UYW5KYXZhTmhvbUdQVC9Qcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyJ9XSwid29ya3NwYWNlRm9sZGVyc1VuY2hhbmdlZCI6ZmFsc2V9fV0sInJlc3BvbnNlX3RleHQiOiIyLiBOb3csIGxldCdzIHVwZGF0ZSB0aGUgS2h1eWVuTWFpREFPSW1wbCB0byBpbXBsZW1lbnQgdGhlIGludGVyZmFjZTpcbiIsIndvcmtzcGFjZV9maWxlX2NodW5rcyI6W119LHsic3RhdHVzIjoic3VjY2VzcyIsInJlcXVlc3RfaWQiOiI0NmUzNWM2My1jZGZiLTRlY2YtODIyYS1iZWQ0YzhkNzQzNDUiLCJyZXF1ZXN0X21lc3NhZ2UiOiIiLCJzdHJ1Y3R1cmVkX291dHB1dF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjUsImNvbnRlbnQiOiIiLCJ0b29sX3VzZSI6eyJ0b29sX3VzZV9pZCI6InRvb2x1XzAxUlQ0VXhQdERXYkVZaURjcnZxR0JLOSIsInRvb2xfbmFtZSI6InN0ci1yZXBsYWNlLWVkaXRvciIsImlucHV0X2pzb24iOiJ7XCJjb21tYW5kXCI6IFwidmlld1wiLCBcInBhdGhcIjogXCJzcmMvbWFpbi9qYXZhL2Rhby9pbXBsL0todXllbk1haURBT0ltcGwuamF2YVwifSJ9fSx7ImlkIjowLCJ0eXBlIjowLCJjb250ZW50IjoiTGV0J3MgdXBkYXRlIHRoZSBleGlzdGluZyBLaHV5ZW5NYWlEQU9JbXBsIGZpbGU6XG4ifSx7ImlkIjoyLCJ0eXBlIjoyLCJjb250ZW50IjoiIn0seyJpZCI6MywidHlwZSI6MywiY29udGVudCI6IiJ9XSwic2Vlbl9zdGF0ZSI6InNlZW4iLCJzdHJ1Y3R1cmVkX3JlcXVlc3Rfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjoxLCJ0b29sX3Jlc3VsdF9ub2RlIjp7ImNvbnRlbnQiOiJGaWxlIGFscmVhZHkgZXhpc3RzOiBFOi9MVFBUSkFWQS9OaG9tL1BoYW5UYW5KYXZhTmhvbUdQVC9Qcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2Rhby9pbXBsL0todXllbk1haURBT0ltcGwuamF2YSIsImlzX2Vycm9yIjp0cnVlLCJyZXF1ZXN0X2lkIjoiIiwidG9vbF91c2VfaWQiOiJ0b29sdV8wMUM0U2J5MldoUkF2S3dXR1kyRjNRTW4ifX0seyJpZCI6MiwidHlwZSI6NCwiaWRlX3N0YXRlX25vZGUiOnsid29ya3NwYWNlRm9sZGVycyI6W3sicmVwb3NpdG9yeVJvb3QiOiJFOi9MVFBUSkFWQS9OaG9tL1BoYW5UYW5KYXZhTmhvbUdQVC9Qcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyIsImZvbGRlclJvb3QiOiJFOi9MVFBUSkFWQS9OaG9tL1BoYW5UYW5KYXZhTmhvbUdQVC9Qcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyJ9XSwid29ya3NwYWNlRm9sZGVyc1VuY2hhbmdlZCI6ZmFsc2V9fV0sInJlc3BvbnNlX3RleHQiOiJMZXQncyB1cGRhdGUgdGhlIGV4aXN0aW5nIEtodXllbk1haURBT0ltcGwgZmlsZTpcbiIsIndvcmtzcGFjZV9maWxlX2NodW5rcyI6W119LHsic3RhdHVzIjoic3VjY2VzcyIsInJlcXVlc3RfaWQiOiIzM2E0NGVjZi0zZGJhLTRjNzYtOTFkNy1kMDM0NDU1OGJjNDkiLCJyZXF1ZXN0X21lc3NhZ2UiOiIiLCJzdHJ1Y3R1cmVkX291dHB1dF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjUsImNvbnRlbnQiOiIiLCJ0b29sX3VzZSI6eyJ0b29sX3VzZV9pZCI6InRvb2x1XzAxQXZhb3dib3hVWGk2UTVlR0Jqbjg4OCIsInRvb2xfbmFtZSI6InN0ci1yZXBsYWNlLWVkaXRvciIsImlucHV0X2pzb24iOiJ7XCJjb21tYW5kXCI6IFwic3RyX3JlcGxhY2VcIiwgXCJwYXRoXCI6IFwic3JjL21haW4vamF2YS9kYW8vaW1wbC9LaHV5ZW5NYWlEQU9JbXBsLmphdmFcIiwgXCJzdHJfcmVwbGFjZV9lbnRyaWVzXCI6IFwiPHBhcmFtZXRlciBuYW1lPVxcXCJvbGRfc3RyXFxcIj5wYWNrYWdlIGRhby5pbXBsO1xcblxcbmltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXI7XFxuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuRW50aXR5VHJhbnNhY3Rpb247XFxuaW1wb3J0IGxvbWJvay5BbGxBcmdzQ29uc3RydWN0b3I7XFxuaW1wb3J0IG1vZGVsLktodXllbk1haTtcXG5pbXBvcnQgdXRpbC5KUEFVdGlsO1xcblxcbmltcG9ydCBqYXZhLnNxbC5QcmVwYXJlZFN0YXRlbWVudDtcXG5pbXBvcnQgamF2YS5zcWwuUmVzdWx0U2V0O1xcbmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlO1xcbmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0O1xcbmltcG9ydCBqYXZhLnV0aWwuTGlzdDtcXG5cXG5AQWxsQXJnc0NvbnN0cnVjdG9yXFxucHVibGljIGNsYXNzIEtodXllbk1haURBT0ltcGwge1xcblxcbiAgICBwcml2YXRlIEVudGl0eU1hbmFnZXIgZW07XFxuICAgIHB1YmxpYyBLaHV5ZW5NYWlEQU9JbXBsKCkge1xcbiAgICAgICAgdGhpcy5lbSA9IEpQQVV0aWwuZ2V0RW50aXR5TWFuYWdlcigpOztcXG4gICAgfVwiLCBcIm5ld19zdHJcIjogXCJwYWNrYWdlIGRhby5pbXBsO1xcblxcbmltcG9ydCBkYW8uS2h1eWVuTWFpREFPO1xcbmltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXI7XFxuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuRW50aXR5VHJhbnNhY3Rpb247XFxuaW1wb3J0IGxvbWJvay5BbGxBcmdzQ29uc3RydWN0b3I7XFxuaW1wb3J0IG1vZGVsLktodXllbk1haTtcXG5pbXBvcnQgdXRpbC5KUEFVdGlsO1xcblxcbmltcG9ydCBqYXZhLnJtaS5SZW1vdGVFeGNlcHRpb247XFxuaW1wb3J0IGphdmEucm1pLnNlcnZlci5VbmljYXN0UmVtb3RlT2JqZWN0O1xcbmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlO1xcbmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0O1xcbmltcG9ydCBqYXZhLnV0aWwuTGlzdDtcXG5cXG5AQWxsQXJnc0NvbnN0cnVjdG9yXFxucHVibGljIGNsYXNzIEtodXllbk1haURBT0ltcGwgZXh0ZW5kcyBVbmljYXN0UmVtb3RlT2JqZWN0IGltcGxlbWVudHMgS2h1eWVuTWFpREFPIHtcXG5cXG4gICAgcHJpdmF0ZSBFbnRpdHlNYW5hZ2VyIGVtO1xcbiAgICBcXG4gICAgcHVibGljIEtodXllbk1haURBT0ltcGwoKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uIHtcXG4gICAgICAgIHRoaXMuZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcXG4gICAgfVwiLCBcIm9sZF9zdHJfc3RhcnRfbGluZV9udW1iZXJcIjogMSwgXCJvbGRfc3RyX2VuZF9saW5lX251bWJlclwiOiAyMX0ifX0seyJpZCI6MCwidHlwZSI6MCwiY29udGVudCI6IiJ9LHsiaWQiOjIsInR5cGUiOjIsImNvbnRlbnQiOiIifSx7ImlkIjozLCJ0eXBlIjozLCJjb250ZW50IjoiIn1dLCJzZWVuX3N0YXRlIjoic2VlbiIsInN0cnVjdHVyZWRfcmVxdWVzdF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjEsInRvb2xfcmVzdWx0X25vZGUiOnsiY29udGVudCI6IkhlcmUncyB0aGUgcmVzdWx0IG9mIHJ1bm5pbmcgYGNhdCAtbmAgb24gc3JjL21haW4vamF2YS9kYW8vaW1wbC9LaHV5ZW5NYWlEQU9JbXBsLmphdmE6XG4gICAgIDFcdHBhY2thZ2UgZGFvLmltcGw7XG4gICAgIDJcdFxuICAgICAzXHRpbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS5FbnRpdHlNYW5hZ2VyO1xuICAgICA0XHRpbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS5FbnRpdHlUcmFuc2FjdGlvbjtcbiAgICAgNVx0aW1wb3J0IGxvbWJvay5BbGxBcmdzQ29uc3RydWN0b3I7XG4gICAgIDZcdGltcG9ydCBtb2RlbC5LaHV5ZW5NYWk7XG4gICAgIDdcdGltcG9ydCB1dGlsLkpQQVV0aWw7XG4gICAgIDhcdFxuICAgICA5XHRpbXBvcnQgamF2YS5zcWwuUHJlcGFyZWRTdGF0ZW1lbnQ7XG4gICAgMTBcdGltcG9ydCBqYXZhLnNxbC5SZXN1bHRTZXQ7XG4gICAgMTFcdGltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlO1xuICAgIDEyXHRpbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDtcbiAgICAxM1x0aW1wb3J0IGphdmEudXRpbC5MaXN0O1xuICAgIDE0XHRcbiAgICAxNVx0QEFsbEFyZ3NDb25zdHJ1Y3RvclxuICAgIDE2XHRwdWJsaWMgY2xhc3MgS2h1eWVuTWFpREFPSW1wbCB7XG4gICAgMTdcdFxuICAgIDE4XHQgICAgcHJpdmF0ZSBFbnRpdHlNYW5hZ2VyIGVtO1xuICAgIDE5XHQgICAgcHVibGljIEtodXllbk1haURBT0ltcGwoKSB7XG4gICAgMjBcdCAgICAgICAgdGhpcy5lbSA9IEpQQVV0aWwuZ2V0RW50aXR5TWFuYWdlcigpOztcbiAgICAyMVx0ICAgIH1cbiAgICAyMlx0ICAgIC8vIEzhuqV5IGRhbmggc8OhY2ggdOG6pXQgY+G6oyBjw6FjIGtodXnhur9uIG3Do2lcbiAgICAyM1x0ICAgIHB1YmxpYyBMaXN0PEtodXllbk1haT4gZmluZEFsbCgpIHtcbiAgICAyNFx0ICAgICAgICBTdHJpbmcgcXVlcnkgPSBcInNlbGVjdCBrbSBmcm9tIEtodXllbk1haSBrbVwiO1xuICAgIDI1XHQgICAgICAgIHJldHVybiBlbS5jcmVhdGVRdWVyeShxdWVyeSwgS2h1eWVuTWFpLmNsYXNzKS5nZXRSZXN1bHRMaXN0KCk7XG4gICAgMjZcdCAgICB9XG4gICAgMjdcdFxuICAgIDI4XHQgICAgLy8gTOG6pXkgZGFuaCBzw6FjaCBraHV54bq/biBtw6NpIHRoZW8gdMOqblxuICAgIDI5XHQgICAgcHVibGljIExpc3Q8S2h1eWVuTWFpPiBmaW5kQnlOYW1lKFN0cmluZyBuYW1lKSB7XG4gICAgMzBcdCAgICAgICAgU3RyaW5nIHF1ZXJ5ID0gXCJzZWxlY3Qga20gZnJvbSBLaHV5ZW5NYWkga20gd2hlcmUga20udGVuS00gbGlrZSA6bmFtZVwiO1xuICAgIDMxXHQgICAgICAgIHJldHVybiBlbS5jcmVhdGVRdWVyeShxdWVyeSwgS2h1eWVuTWFpLmNsYXNzKVxuICAgIDMyXHQgICAgICAgICAgICAgICAgLnNldFBhcmFtZXRlcihcIm5hbWVcIiwgXCIlXCIgKyBuYW1lICsgXCIlXCIpXG4gICAgMzNcdCAgICAgICAgICAgICAgICAuZ2V0UmVzdWx0TGlzdCgpO1xuICAgIDM0XHQgICAgfVxuICAgIDM1XHRcbiAgICAzNlx0ICAgIC8vIEzhuqV5IGtodXnhur9uIG3Do2kgdGhlbyBtw6NcbiAgICAzN1x0ICAgIHB1YmxpYyBLaHV5ZW5NYWkgZmluZEJ5SWQoU3RyaW5nIGlkKSB7XG4gICAgMzhcdCAgICAgICAgcmV0dXJuIGVtLmZpbmQoS2h1eWVuTWFpLmNsYXNzLCBpZCk7XG4gICAgMzlcdCAgICB9XG4gICAgNDBcdFxuICAgIDQxXHQgICAgLy8gVGjDqm0gaG/hurdjIGPhuq1wIG5o4bqtdCBraHV54bq/biBtw6NpXG4gICAgNDJcdCAgICBwdWJsaWMgYm9vbGVhbiBzYXZlKEtodXllbk1haSBraHV5ZW5NYWkpIHtcbiAgICA0M1x0ICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0ciA9IGVtLmdldFRyYW5zYWN0aW9uKCk7XG4gICAgNDRcdCAgICAgICAgdHJ5IHtcbiAgICA0NVx0ICAgICAgICAgICAgdHIuYmVnaW4oKTtcbiAgICA0Nlx0ICAgICAgICAgICAgaWYgKGVtLmZpbmQoS2h1eWVuTWFpLmNsYXNzLCBraHV5ZW5NYWkuZ2V0TWFLTSgpKSA9PSBudWxsKSB7XG4gICAgNDdcdCAgICAgICAgICAgICAgICBlbS5wZXJzaXN0KGtodXllbk1haSk7IC8vIFRow6ptIG3hu5tpXG4gICAgNDhcdCAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgNDlcdCAgICAgICAgICAgICAgICBlbS5tZXJnZShraHV5ZW5NYWkpOyAvLyBD4bqtcCBuaOG6rXRcbiAgICA1MFx0ICAgICAgICAgICAgfVxuICAgIDUxXHQgICAgICAgICAgICB0ci5jb21taXQoKTtcbiAgICA1Mlx0ICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgNTNcdCAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGV4KSB7XG4gICAgNTRcdCAgICAgICAgICAgIGV4LnByaW50U3RhY2tUcmFjZSgpO1xuICAgIDU1XHQgICAgICAgICAgICB0ci5yb2xsYmFjaygpO1xuICAgIDU2XHQgICAgICAgIH1cbiAgICA1N1x0ICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgNThcdCAgICB9XG4gICAgNTlcdFxuICAgIDYwXHQgICAgLy8gWMOzYSBraHV54bq/biBtw6NpIHRoZW8gbcOjXG4gICAgNjFcdCAgICBwdWJsaWMgYm9vbGVhbiBkZWxldGUoU3RyaW5nIGlkKSB7XG4gICAgNjJcdCAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHIgPSBlbS5nZXRUcmFuc2FjdGlvbigpO1xuICAgIDYzXHQgICAgICAgIHRyeSB7XG4gICAgNjRcdCAgICAgICAgICAgIHRyLmJlZ2luKCk7XG4gICAgNjVcdCAgICAgICAgICAgIEtodXllbk1haSBrbSA9IGVtLmZpbmQoS2h1eWVuTWFpLmNsYXNzLCBpZCk7XG4gICAgNjZcdCAgICAgICAgICAgIGlmIChrbSAhPSBudWxsKSB7XG4gICAgNjdcdCAgICAgICAgICAgICAgICBlbS5yZW1vdmUoa20pO1xuICAgIDY4XHQgICAgICAgICAgICAgICAgdHIuY29tbWl0KCk7XG4gICAgNjlcdCAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICA3MFx0ICAgICAgICAgICAgfVxuICAgIDcxXHQgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBleCkge1xuICAgIDcyXHQgICAgICAgICAgICBleC5wcmludFN0YWNrVHJhY2UoKTtcbiAgICA3M1x0ICAgICAgICAgICAgdHIucm9sbGJhY2soKTtcbiAgICA3NFx0ICAgICAgICB9XG4gICAgNzVcdCAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIDc2XHQgICAgfVxuICAgIDc3XHQgICAgLy8gVMOsbSBjw6FjIGtodXnhur9uIG3Do2kgxJFhbmcgw6FwIGThu6VuZ1xuICAgIDc4XHQgICAgcHVibGljIExpc3Q8S2h1eWVuTWFpPiBmaW5kT25nb2luZ1Byb21vdGlvbnMoKSB7XG4gICAgNzlcdCAgICAgICAgU3RyaW5nIHF1ZXJ5ID0gXCJzZWxlY3Qga20gZnJvbSBLaHV5ZW5NYWkga20gXCIgK1xuICAgIDgwXHQgICAgICAgICAgICAgICAgXCJ3aGVyZSBrbS50cmFuZ1RoYWkgPSA6dHJhbmdUaGFpIFwiICtcbiAgICA4MVx0ICAgICAgICAgICAgICAgIFwiYW5kIGttLnRob2lHaWFuQmF0RGF1IDw9IDp0b2RheSBcIiArXG4gICAgODJcdCAgICAgICAgICAgICAgICBcImFuZCBrbS50aG9pR2lhbktldFRodWMgPj0gOnRvZGF5XCI7XG4gICAgODNcdFxuICAgIDg0XHQgICAgICAgIHJldHVybiBlbS5jcmVhdGVRdWVyeShxdWVyeSwgS2h1eWVuTWFpLmNsYXNzKVxuICAgIDg1XHQgICAgICAgICAgICAgICAgLnNldFBhcmFtZXRlcihcInRyYW5nVGhhaVwiLCBcIsSQYW5nIGRp4buFbiByYVwiKVxuICAgIDg2XHQgICAgICAgICAgICAgICAgLnNldFBhcmFtZXRlcihcInRvZGF5XCIsIExvY2FsRGF0ZS5ub3coKSlcbiAgICA4N1x0ICAgICAgICAgICAgICAgIC5nZXRSZXN1bHRMaXN0KCk7XG4gICAgODhcdCAgICB9XG4gICAgODlcdFxuICAgIDkwXHR9XG4gICAgOTFcdFxuVG90YWwgbGluZXMgaW4gZmlsZTogOTFcbiIsImlzX2Vycm9yIjpmYWxzZSwicmVxdWVzdF9pZCI6IiIsInRvb2xfdXNlX2lkIjoidG9vbHVfMDFSVDRVeFB0RFdiRVlpRGNydnFHQks5In19LHsiaWQiOjIsInR5cGUiOjQsImlkZV9zdGF0ZV9ub2RlIjp7IndvcmtzcGFjZUZvbGRlcnMiOlt7InJlcG9zaXRvcnlSb290IjoiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmciLCJmb2xkZXJSb290IjoiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcifV0sIndvcmtzcGFjZUZvbGRlcnNVbmNoYW5nZWQiOmZhbHNlfX1dLCJyZXNwb25zZV90ZXh0IjoiIiwid29ya3NwYWNlX2ZpbGVfY2h1bmtzIjpbXX0seyJzdGF0dXMiOiJzdWNjZXNzIiwicmVxdWVzdF9pZCI6IjBmNTM5ZTAxLWUxOGItNDJhMi1iOTRkLTQ2NTYyYjMyNzEyMSIsInJlcXVlc3RfbWVzc2FnZSI6IiIsInN0cnVjdHVyZWRfb3V0cHV0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6NSwiY29udGVudCI6IiIsInRvb2xfdXNlIjp7InRvb2xfdXNlX2lkIjoidG9vbHVfMDFWQXJ0bXZ6THN4TXdIVjZyVW1MTkI5IiwidG9vbF9uYW1lIjoic3RyLXJlcGxhY2UtZWRpdG9yIiwiaW5wdXRfanNvbiI6IntcImNvbW1hbmRcIjogXCJzdHJfcmVwbGFjZVwiLCBcInBhdGhcIjogXCJzcmMvbWFpbi9qYXZhL2Rhby9pbXBsL0todXllbk1haURBT0ltcGwuamF2YVwiLCBcInN0cl9yZXBsYWNlX2VudHJpZXNcIjogW3tcIm9sZF9zdHJcIjogXCJwYWNrYWdlIGRhby5pbXBsO1xcblxcbmltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXI7XFxuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuRW50aXR5VHJhbnNhY3Rpb247XFxuaW1wb3J0IGxvbWJvay5BbGxBcmdzQ29uc3RydWN0b3I7XFxuaW1wb3J0IG1vZGVsLktodXllbk1haTtcXG5pbXBvcnQgdXRpbC5KUEFVdGlsO1xcblxcbmltcG9ydCBqYXZhLnNxbC5QcmVwYXJlZFN0YXRlbWVudDtcXG5pbXBvcnQgamF2YS5zcWwuUmVzdWx0U2V0O1xcbmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlO1xcbmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0O1xcbmltcG9ydCBqYXZhLnV0aWwuTGlzdDtcXG5cXG5AQWxsQXJnc0NvbnN0cnVjdG9yXFxucHVibGljIGNsYXNzIEtodXllbk1haURBT0ltcGwge1xcblxcbiAgICBwcml2YXRlIEVudGl0eU1hbmFnZXIgZW07XFxuICAgIHB1YmxpYyBLaHV5ZW5NYWlEQU9JbXBsKCkge1xcbiAgICAgICAgdGhpcy5lbSA9IEpQQVV0aWwuZ2V0RW50aXR5TWFuYWdlcigpOztcXG4gICAgfVwiLCBcIm5ld19zdHJcIjogXCJwYWNrYWdlIGRhby5pbXBsO1xcblxcbmltcG9ydCBkYW8uS2h1eWVuTWFpREFPO1xcbmltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXI7XFxuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuRW50aXR5VHJhbnNhY3Rpb247XFxuaW1wb3J0IGxvbWJvay5BbGxBcmdzQ29uc3RydWN0b3I7XFxuaW1wb3J0IG1vZGVsLktodXllbk1haTtcXG5pbXBvcnQgdXRpbC5KUEFVdGlsO1xcblxcbmltcG9ydCBqYXZhLnJtaS5SZW1vdGVFeGNlcHRpb247XFxuaW1wb3J0IGphdmEucm1pLnNlcnZlci5VbmljYXN0UmVtb3RlT2JqZWN0O1xcbmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlO1xcbmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0O1xcbmltcG9ydCBqYXZhLnV0aWwuTGlzdDtcXG5cXG5AQWxsQXJnc0NvbnN0cnVjdG9yXFxucHVibGljIGNsYXNzIEtodXllbk1haURBT0ltcGwgZXh0ZW5kcyBVbmljYXN0UmVtb3RlT2JqZWN0IGltcGxlbWVudHMgS2h1eWVuTWFpREFPIHtcXG5cXG4gICAgcHJpdmF0ZSBFbnRpdHlNYW5hZ2VyIGVtO1xcbiAgICBcXG4gICAgcHVibGljIEtodXllbk1haURBT0ltcGwoKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uIHtcXG4gICAgICAgIHRoaXMuZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcXG4gICAgfVwiLCBcIm9sZF9zdHJfc3RhcnRfbGluZV9udW1iZXJcIjogMSwgXCJvbGRfc3RyX2VuZF9saW5lX251bWJlclwiOiAyMX1dfSJ9fSx7ImlkIjowLCJ0eXBlIjowLCJjb250ZW50IjoiIn0seyJpZCI6MiwidHlwZSI6MiwiY29udGVudCI6IiJ9LHsiaWQiOjMsInR5cGUiOjMsImNvbnRlbnQiOiIifV0sInNlZW5fc3RhdGUiOiJzZWVuIiwic3RydWN0dXJlZF9yZXF1ZXN0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6MSwidG9vbF9yZXN1bHRfbm9kZSI6eyJjb250ZW50IjoiSW52YWxpZCBwYXJhbWV0ZXIgYHN0cl9yZXBsYWNlX2VudHJpZXNgIGZvciBgc3RyX3JlcGxhY2VgIGNvbW1hbmQuIEl0IG11c3QgYmUgYW4gYXJyYXkgb2Ygb2JqZWN0cy4iLCJpc19lcnJvciI6dHJ1ZSwicmVxdWVzdF9pZCI6IiIsInRvb2xfdXNlX2lkIjoidG9vbHVfMDFBdmFvd2JveFVYaTZRNWVHQmpuODg4In19LHsiaWQiOjIsInR5cGUiOjQsImlkZV9zdGF0ZV9ub2RlIjp7IndvcmtzcGFjZUZvbGRlcnMiOlt7InJlcG9zaXRvcnlSb290IjoiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmciLCJmb2xkZXJSb290IjoiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcifV0sIndvcmtzcGFjZUZvbGRlcnNVbmNoYW5nZWQiOmZhbHNlfX1dLCJyZXNwb25zZV90ZXh0IjoiIiwid29ya3NwYWNlX2ZpbGVfY2h1bmtzIjpbXX0seyJzdGF0dXMiOiJzdWNjZXNzIiwicmVxdWVzdF9pZCI6IjRmMzAwYTFjLTUwOTktNDg2Ny04ZjY1LTQ3OTQ3MWJjZjE3YSIsInJlcXVlc3RfbWVzc2FnZSI6IiIsInN0cnVjdHVyZWRfb3V0cHV0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6NSwiY29udGVudCI6IiIsInRvb2xfdXNlIjp7InRvb2xfdXNlX2lkIjoidG9vbHVfMDFFR2Z5UzNvYzdRenZmakRtVHFtQmIxIiwidG9vbF9uYW1lIjoic3RyLXJlcGxhY2UtZWRpdG9yIiwiaW5wdXRfanNvbiI6IntcImNvbW1hbmRcIjogXCJzdHJfcmVwbGFjZVwiLCBcInBhdGhcIjogXCJzcmMvbWFpbi9qYXZhL2Rhby9pbXBsL0todXllbk1haURBT0ltcGwuamF2YVwiLCBcInN0cl9yZXBsYWNlX2VudHJpZXNcIjogW3tcIm9sZF9zdHJcIjogXCIgICAgLy8gTFxcdTFlYTV5IGRhbmggc1xcdTAwZTFjaCB0XFx1MWVhNXQgY1xcdTFlYTMgY1xcdTAwZTFjIGtodXlcXHUxZWJmbiBtXFx1MDBlM2lcXG4gICAgcHVibGljIExpc3Q8S2h1eWVuTWFpPiBmaW5kQWxsKCkge1xcbiAgICAgICAgU3RyaW5nIHF1ZXJ5ID0gXFxcInNlbGVjdCBrbSBmcm9tIEtodXllbk1haSBrbVxcXCI7XFxuICAgICAgICByZXR1cm4gZW0uY3JlYXRlUXVlcnkocXVlcnksIEtodXllbk1haS5jbGFzcykuZ2V0UmVzdWx0TGlzdCgpO1xcbiAgICB9XCIsIFwibmV3X3N0clwiOiBcIiAgICAvLyBMXFx1MWVhNXkgZGFuaCBzXFx1MDBlMWNoIHRcXHUxZWE1dCBjXFx1MWVhMyBjXFx1MDBlMWMga2h1eVxcdTFlYmZuIG1cXHUwMGUzaVxcbiAgICBAT3ZlcnJpZGVcXG4gICAgcHVibGljIExpc3Q8S2h1eWVuTWFpPiBmaW5kQWxsKCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XFxuICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gSlBBVXRpbC5nZXRFbnRpdHlNYW5hZ2VyKCk7XFxuICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0eCA9IGVtLmdldFRyYW5zYWN0aW9uKCk7XFxuICAgICAgICBMaXN0PEtodXllbk1haT4gcmVzdWx0ID0gbmV3IEFycmF5TGlzdDw+KCk7XFxuICAgICAgICBcXG4gICAgICAgIHRyeSB7XFxuICAgICAgICAgICAgdHguYmVnaW4oKTtcXG4gICAgICAgICAgICBTdHJpbmcgcXVlcnkgPSBcXFwic2VsZWN0IGttIGZyb20gS2h1eWVuTWFpIGttXFxcIjtcXG4gICAgICAgICAgICByZXN1bHQgPSBlbS5jcmVhdGVRdWVyeShxdWVyeSwgS2h1eWVuTWFpLmNsYXNzKS5nZXRSZXN1bHRMaXN0KCk7XFxuICAgICAgICAgICAgdHguY29tbWl0KCk7XFxuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xcbiAgICAgICAgICAgIGlmICh0eC5pc0FjdGl2ZSgpKSB7XFxuICAgICAgICAgICAgICAgIHR4LnJvbGxiYWNrKCk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XFxuICAgICAgICAgICAgdGhyb3cgbmV3IFJlbW90ZUV4Y2VwdGlvbihcXFwiTFxcdTFlZDdpIGtoaSBsXFx1MWVhNXkgZGFuaCBzXFx1MDBlMWNoIGtodXlcXHUxZWJmbiBtXFx1MDBlM2lcXFwiLCBlKTtcXG4gICAgICAgIH0gZmluYWxseSB7XFxuICAgICAgICAgICAgaWYgKGVtICE9IG51bGwgJiYgZW0uaXNPcGVuKCkpIHtcXG4gICAgICAgICAgICAgICAgZW0uY2xvc2UoKTtcXG4gICAgICAgICAgICB9XFxuICAgICAgICB9XFxuICAgICAgICByZXR1cm4gcmVzdWx0O1xcbiAgICB9XCIsIFwib2xkX3N0cl9zdGFydF9saW5lX251bWJlclwiOiAyNCwgXCJvbGRfc3RyX2VuZF9saW5lX251bWJlclwiOiAyN31dfSJ9fSx7ImlkIjowLCJ0eXBlIjowLCJjb250ZW50IjoiTm93IGxldCdzIHVwZGF0ZSB0aGUgbWV0aG9kcyB0byBpbXBsZW1lbnQgdGhlIGludGVyZmFjZTpcbiJ9LHsiaWQiOjIsInR5cGUiOjIsImNvbnRlbnQiOiIifSx7ImlkIjozLCJ0eXBlIjozLCJjb250ZW50IjoiIn1dLCJzZWVuX3N0YXRlIjoic2VlbiIsInN0cnVjdHVyZWRfcmVxdWVzdF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjEsInRvb2xfcmVzdWx0X25vZGUiOnsiY29udGVudCI6IlN1Y2Nlc3NmdWxseSBlZGl0ZWQgdGhlIGZpbGUgc3JjL21haW4vamF2YS9kYW8vaW1wbC9LaHV5ZW5NYWlEQU9JbXBsLmphdmEuXG5SZXN1bHQgZm9yIHN0cl9yZXBsYWNlX2VudHJpZXNbMF06XG5SZXBsYWNlbWVudCBzdWNjZXNzZnVsLlxuRWRpdGVkIHNlY3Rpb24gYWZ0ZXIgSURFIGF1dG8tZm9ybWF0dGluZyB3YXMgYXBwbGllZDpcbiAgICAgMVx0cGFja2FnZSBkYW8uaW1wbDtcbiAgICAgMlx0XG4gICAgIDNcdGltcG9ydCBkYW8uS2h1eWVuTWFpREFPO1xuICAgICA0XHRpbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS5FbnRpdHlNYW5hZ2VyO1xuICAgICA1XHRpbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS5FbnRpdHlUcmFuc2FjdGlvbjtcbiAgICAgNlx0aW1wb3J0IGxvbWJvay5BbGxBcmdzQ29uc3RydWN0b3I7XG4gICAgIDdcdGltcG9ydCBtb2RlbC5LaHV5ZW5NYWk7XG4gICAgIDhcdGltcG9ydCB1dGlsLkpQQVV0aWw7XG4gICAgIDlcdFxuICAgIDEwXHRpbXBvcnQgamF2YS5ybWkuUmVtb3RlRXhjZXB0aW9uO1xuICAgIDExXHRpbXBvcnQgamF2YS5ybWkuc2VydmVyLlVuaWNhc3RSZW1vdGVPYmplY3Q7XG4gICAgMTJcdGltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlO1xuICAgIDEzXHRpbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDtcbiAgICAxNFx0aW1wb3J0IGphdmEudXRpbC5MaXN0O1xuICAgIDE1XHRcbiAgICAxNlx0QEFsbEFyZ3NDb25zdHJ1Y3RvclxuICAgIDE3XHRwdWJsaWMgY2xhc3MgS2h1eWVuTWFpREFPSW1wbCBleHRlbmRzIFVuaWNhc3RSZW1vdGVPYmplY3QgaW1wbGVtZW50cyBLaHV5ZW5NYWlEQU8ge1xuICAgIDE4XHRcbiAgICAxOVx0ICAgIHByaXZhdGUgRW50aXR5TWFuYWdlciBlbTtcbiAgICAyMFx0XG4gICAgMjFcdCAgICBwdWJsaWMgS2h1eWVuTWFpREFPSW1wbCgpIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xuICAgIDIyXHQgICAgICAgIHRoaXMuZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcbiAgICAyM1x0ICAgIH1cbiAgICAyNFx0ICAgIC8vIEzhuqV5IGRhbmggc8OhY2ggdOG6pXQgY+G6oyBjw6FjIGtodXnhur9uIG3Do2lcbiAgICAyNVx0ICAgIHB1YmxpYyBMaXN0PEtodXllbk1haT4gZmluZEFsbCgpIHtcbiAgICAyNlx0ICAgICAgICBTdHJpbmcgcXVlcnkgPSBcInNlbGVjdCBrbSBmcm9tIEtodXllbk1haSBrbVwiO1xuICAgIDI3XHQgICAgICAgIHJldHVybiBlbS5jcmVhdGVRdWVyeShxdWVyeSwgS2h1eWVuTWFpLmNsYXNzKS5nZXRSZXN1bHRMaXN0KCk7XG5cblJldmlldyB0aGUgY2hhbmdlcyBhbmQgbWFrZSBzdXJlIHRoZXkgYXJlIGFzIGV4cGVjdGVkIChjb3JyZWN0IGluZGVudGF0aW9uLCBubyBkdXBsaWNhdGUgbGluZXMsIGV0YykuXG5FZGl0IHRoZSBmaWxlIGFnYWluIGlmIG5lY2Vzc2FyeS5cbiIsImlzX2Vycm9yIjpmYWxzZSwicmVxdWVzdF9pZCI6IiIsInRvb2xfdXNlX2lkIjoidG9vbHVfMDFWQXJ0bXZ6THN4TXdIVjZyVW1MTkI5In19LHsiaWQiOjIsInR5cGUiOjQsImlkZV9zdGF0ZV9ub2RlIjp7IndvcmtzcGFjZUZvbGRlcnMiOlt7InJlcG9zaXRvcnlSb290IjoiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmciLCJmb2xkZXJSb290IjoiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcifV0sIndvcmtzcGFjZUZvbGRlcnNVbmNoYW5nZWQiOmZhbHNlfX1dLCJyZXNwb25zZV90ZXh0IjoiTm93IGxldCdzIHVwZGF0ZSB0aGUgbWV0aG9kcyB0byBpbXBsZW1lbnQgdGhlIGludGVyZmFjZTpcbiIsIndvcmtzcGFjZV9maWxlX2NodW5rcyI6W119LHsic3RhdHVzIjoic3VjY2VzcyIsInJlcXVlc3RfaWQiOiJhOWQxYjAxMy1lMjQwLTRhNjgtOTI4Zi1iNjNmYjVhMzUzYjkiLCJyZXF1ZXN0X21lc3NhZ2UiOiIiLCJzdHJ1Y3R1cmVkX291dHB1dF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjUsImNvbnRlbnQiOiIiLCJ0b29sX3VzZSI6eyJ0b29sX3VzZV9pZCI6InRvb2x1XzAxSFZjSFBkZHNzTlh5MTFTR21XdUVtQyIsInRvb2xfbmFtZSI6InN0ci1yZXBsYWNlLWVkaXRvciIsImlucHV0X2pzb24iOiJ7XCJjb21tYW5kXCI6IFwic3RyX3JlcGxhY2VcIiwgXCJwYXRoXCI6IFwic3JjL21haW4vamF2YS9kYW8vaW1wbC9LaHV5ZW5NYWlEQU9JbXBsLmphdmFcIiwgXCJzdHJfcmVwbGFjZV9lbnRyaWVzXCI6IFt7XCJvbGRfc3RyXCI6IFwiICAgIC8vIExcXHUxZWE1eSBkYW5oIHNcXHUwMGUxY2gga2h1eVxcdTFlYmZuIG1cXHUwMGUzaSB0aGVvIHRcXHUwMGVhblxcbiAgICBwdWJsaWMgTGlzdDxLaHV5ZW5NYWk+IGZpbmRCeU5hbWUoU3RyaW5nIG5hbWUpIHtcXG4gICAgICAgIFN0cmluZyBxdWVyeSA9IFxcXCJzZWxlY3Qga20gZnJvbSBLaHV5ZW5NYWkga20gd2hlcmUga20udGVuS00gbGlrZSA6bmFtZVxcXCI7XFxuICAgICAgICByZXR1cm4gZW0uY3JlYXRlUXVlcnkocXVlcnksIEtodXllbk1haS5jbGFzcylcXG4gICAgICAgICAgICAgICAgLnNldFBhcmFtZXRlcihcXFwibmFtZVxcXCIsIFxcXCIlXFxcIiArIG5hbWUgKyBcXFwiJVxcXCIpXFxuICAgICAgICAgICAgICAgIC5nZXRSZXN1bHRMaXN0KCk7XFxuICAgIH1cIiwgXCJuZXdfc3RyXCI6IFwiICAgIC8vIExcXHUxZWE1eSBkYW5oIHNcXHUwMGUxY2gga2h1eVxcdTFlYmZuIG1cXHUwMGUzaSB0aGVvIHRcXHUwMGVhblxcbiAgICBAT3ZlcnJpZGVcXG4gICAgcHVibGljIExpc3Q8S2h1eWVuTWFpPiBmaW5kQnlOYW1lKFN0cmluZyBuYW1lKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uIHtcXG4gICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcXG4gICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHR4ID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcXG4gICAgICAgIExpc3Q8S2h1eWVuTWFpPiByZXN1bHQgPSBuZXcgQXJyYXlMaXN0PD4oKTtcXG4gICAgICAgIFxcbiAgICAgICAgdHJ5IHtcXG4gICAgICAgICAgICB0eC5iZWdpbigpO1xcbiAgICAgICAgICAgIFN0cmluZyBxdWVyeSA9IFxcXCJzZWxlY3Qga20gZnJvbSBLaHV5ZW5NYWkga20gd2hlcmUga20udGVuS00gbGlrZSA6bmFtZVxcXCI7XFxuICAgICAgICAgICAgcmVzdWx0ID0gZW0uY3JlYXRlUXVlcnkocXVlcnksIEtodXllbk1haS5jbGFzcylcXG4gICAgICAgICAgICAgICAgICAgIC5zZXRQYXJhbWV0ZXIoXFxcIm5hbWVcXFwiLCBcXFwiJVxcXCIgKyBuYW1lICsgXFxcIiVcXFwiKVxcbiAgICAgICAgICAgICAgICAgICAgLmdldFJlc3VsdExpc3QoKTtcXG4gICAgICAgICAgICB0eC5jb21taXQoKTtcXG4gICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XFxuICAgICAgICAgICAgaWYgKHR4LmlzQWN0aXZlKCkpIHtcXG4gICAgICAgICAgICAgICAgdHgucm9sbGJhY2soKTtcXG4gICAgICAgICAgICB9XFxuICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcXG4gICAgICAgICAgICB0aHJvdyBuZXcgUmVtb3RlRXhjZXB0aW9uKFxcXCJMXFx1MWVkN2kga2hpIHRcXHUwMGVjbSBraHV5XFx1MWViZm4gbVxcdTAwZTNpIHRoZW8gdFxcdTAwZWFuXFxcIiwgZSk7XFxuICAgICAgICB9IGZpbmFsbHkge1xcbiAgICAgICAgICAgIGlmIChlbSAhPSBudWxsICYmIGVtLmlzT3BlbigpKSB7XFxuICAgICAgICAgICAgICAgIGVtLmNsb3NlKCk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgfVxcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcXG4gICAgfVwiLCBcIm9sZF9zdHJfc3RhcnRfbGluZV9udW1iZXJcIjogNTAsIFwib2xkX3N0cl9lbmRfbGluZV9udW1iZXJcIjogNTZ9XX0ifX0seyJpZCI6MCwidHlwZSI6MCwiY29udGVudCI6IiJ9LHsiaWQiOjIsInR5cGUiOjIsImNvbnRlbnQiOiIifSx7ImlkIjozLCJ0eXBlIjozLCJjb250ZW50IjoiIn1dLCJzZWVuX3N0YXRlIjoic2VlbiIsInN0cnVjdHVyZWRfcmVxdWVzdF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjEsInRvb2xfcmVzdWx0X25vZGUiOnsiY29udGVudCI6IlN1Y2Nlc3NmdWxseSBlZGl0ZWQgdGhlIGZpbGUgc3JjL21haW4vamF2YS9kYW8vaW1wbC9LaHV5ZW5NYWlEQU9JbXBsLmphdmEuXG5SZXN1bHQgZm9yIHN0cl9yZXBsYWNlX2VudHJpZXNbMF06XG5SZXBsYWNlbWVudCBzdWNjZXNzZnVsLlxuRWRpdGVkIHNlY3Rpb24gYWZ0ZXIgSURFIGF1dG8tZm9ybWF0dGluZyB3YXMgYXBwbGllZDpcbiAgICAyMFx0XG4gICAgMjFcdCAgICBwdWJsaWMgS2h1eWVuTWFpREFPSW1wbCgpIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xuICAgIDIyXHQgICAgICAgIHRoaXMuZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcbiAgICAyM1x0ICAgIH1cbiAgICAyNFx0ICAgIC8vIEzhuqV5IGRhbmggc8OhY2ggdOG6pXQgY+G6oyBjw6FjIGtodXnhur9uIG3Do2lcbiAgICAyNVx0ICAgIEBPdmVycmlkZVxuICAgIDI2XHQgICAgcHVibGljIExpc3Q8S2h1eWVuTWFpPiBmaW5kQWxsKCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgMjdcdCAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IEpQQVV0aWwuZ2V0RW50aXR5TWFuYWdlcigpO1xuICAgIDI4XHQgICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHR4ID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcbiAgICAyOVx0ICAgICAgICBMaXN0PEtodXllbk1haT4gcmVzdWx0ID0gbmV3IEFycmF5TGlzdDw+KCk7XG4gICAgMzBcdFxuICAgIDMxXHQgICAgICAgIHRyeSB7XG4gICAgMzJcdCAgICAgICAgICAgIHR4LmJlZ2luKCk7XG4gICAgMzNcdCAgICAgICAgICAgIFN0cmluZyBxdWVyeSA9IFwic2VsZWN0IGttIGZyb20gS2h1eWVuTWFpIGttXCI7XG4gICAgMzRcdCAgICAgICAgICAgIHJlc3VsdCA9IGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5LCBLaHV5ZW5NYWkuY2xhc3MpLmdldFJlc3VsdExpc3QoKTtcbiAgICAzNVx0ICAgICAgICAgICAgdHguY29tbWl0KCk7XG4gICAgMzZcdCAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAzN1x0ICAgICAgICAgICAgaWYgKHR4LmlzQWN0aXZlKCkpIHtcbiAgICAzOFx0ICAgICAgICAgICAgICAgIHR4LnJvbGxiYWNrKCk7XG4gICAgMzlcdCAgICAgICAgICAgIH1cbiAgICA0MFx0ICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICA0MVx0ICAgICAgICAgICAgdGhyb3cgbmV3IFJlbW90ZUV4Y2VwdGlvbihcIkzhu5dpIGtoaSBs4bqleSBkYW5oIHPDoWNoIGtodXnhur9uIG3Do2lcIiwgZSk7XG4gICAgNDJcdCAgICAgICAgfSBmaW5hbGx5IHtcbiAgICA0M1x0ICAgICAgICAgICAgaWYgKGVtICE9IG51bGwgJiYgZW0uaXNPcGVuKCkpIHtcbiAgICA0NFx0ICAgICAgICAgICAgICAgIGVtLmNsb3NlKCk7XG4gICAgNDVcdCAgICAgICAgICAgIH1cbiAgICA0Nlx0ICAgICAgICB9XG4gICAgNDdcdCAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICA0OFx0ICAgIH1cbiAgICA0OVx0XG4gICAgNTBcdCAgICAvLyBM4bqleSBkYW5oIHPDoWNoIGtodXnhur9uIG3Do2kgdGhlbyB0w6puXG4gICAgNTFcdCAgICBwdWJsaWMgTGlzdDxLaHV5ZW5NYWk+IGZpbmRCeU5hbWUoU3RyaW5nIG5hbWUpIHtcbiAgICA1Mlx0ICAgICAgICBTdHJpbmcgcXVlcnkgPSBcInNlbGVjdCBrbSBmcm9tIEtodXllbk1haSBrbSB3aGVyZSBrbS50ZW5LTSBsaWtlIDpuYW1lXCI7XG5cblJldmlldyB0aGUgY2hhbmdlcyBhbmQgbWFrZSBzdXJlIHRoZXkgYXJlIGFzIGV4cGVjdGVkIChjb3JyZWN0IGluZGVudGF0aW9uLCBubyBkdXBsaWNhdGUgbGluZXMsIGV0YykuXG5FZGl0IHRoZSBmaWxlIGFnYWluIGlmIG5lY2Vzc2FyeS5cbiIsImlzX2Vycm9yIjpmYWxzZSwicmVxdWVzdF9pZCI6IiIsInRvb2xfdXNlX2lkIjoidG9vbHVfMDFFR2Z5UzNvYzdRenZmakRtVHFtQmIxIn19LHsiaWQiOjIsInR5cGUiOjQsImlkZV9zdGF0ZV9ub2RlIjp7IndvcmtzcGFjZUZvbGRlcnMiOlt7InJlcG9zaXRvcnlSb290IjoiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmciLCJmb2xkZXJSb290IjoiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcifV0sIndvcmtzcGFjZUZvbGRlcnNVbmNoYW5nZWQiOmZhbHNlfX1dLCJyZXNwb25zZV90ZXh0IjoiIiwid29ya3NwYWNlX2ZpbGVfY2h1bmtzIjpbXX0seyJzdGF0dXMiOiJzdWNjZXNzIiwicmVxdWVzdF9pZCI6IjlmNDc3NTJjLTg1NzktNDkwMy04Y2Y4LWRhZmYwZDI3MjhhNiIsInJlcXVlc3RfbWVzc2FnZSI6IiIsInN0cnVjdHVyZWRfb3V0cHV0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6NSwiY29udGVudCI6IiIsInRvb2xfdXNlIjp7InRvb2xfdXNlX2lkIjoidG9vbHVfMDE5Sm1VOEtubVpydGhKWEZ1dGtHcDYxIiwidG9vbF9uYW1lIjoic3RyLXJlcGxhY2UtZWRpdG9yIiwiaW5wdXRfanNvbiI6IntcImNvbW1hbmRcIjogXCJzdHJfcmVwbGFjZVwiLCBcInBhdGhcIjogXCJzcmMvbWFpbi9qYXZhL2Rhby9pbXBsL0todXllbk1haURBT0ltcGwuamF2YVwiLCBcInN0cl9yZXBsYWNlX2VudHJpZXNcIjogW3tcIm9sZF9zdHJcIjogXCIgICAgLy8gTFxcdTFlYTV5IGtodXlcXHUxZWJmbiBtXFx1MDBlM2kgdGhlbyBtXFx1MDBlM1xcbiAgICBwdWJsaWMgS2h1eWVuTWFpIGZpbmRCeUlkKFN0cmluZyBpZCkge1xcbiAgICAgICAgcmV0dXJuIGVtLmZpbmQoS2h1eWVuTWFpLmNsYXNzLCBpZCk7XFxuICAgIH1cIiwgXCJuZXdfc3RyXCI6IFwiICAgIC8vIExcXHUxZWE1eSBraHV5XFx1MWViZm4gbVxcdTAwZTNpIHRoZW8gbVxcdTAwZTNcXG4gICAgQE92ZXJyaWRlXFxuICAgIHB1YmxpYyBLaHV5ZW5NYWkgZmluZEJ5SWQoU3RyaW5nIGlkKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uIHtcXG4gICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcXG4gICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHR4ID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcXG4gICAgICAgIEtodXllbk1haSByZXN1bHQgPSBudWxsO1xcbiAgICAgICAgXFxuICAgICAgICB0cnkge1xcbiAgICAgICAgICAgIHR4LmJlZ2luKCk7XFxuICAgICAgICAgICAgcmVzdWx0ID0gZW0uZmluZChLaHV5ZW5NYWkuY2xhc3MsIGlkKTtcXG4gICAgICAgICAgICB0eC5jb21taXQoKTtcXG4gICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XFxuICAgICAgICAgICAgaWYgKHR4LmlzQWN0aXZlKCkpIHtcXG4gICAgICAgICAgICAgICAgdHgucm9sbGJhY2soKTtcXG4gICAgICAgICAgICB9XFxuICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcXG4gICAgICAgICAgICB0aHJvdyBuZXcgUmVtb3RlRXhjZXB0aW9uKFxcXCJMXFx1MWVkN2kga2hpIHRcXHUwMGVjbSBraHV5XFx1MWViZm4gbVxcdTAwZTNpIHRoZW8gbVxcdTAwZTNcXFwiLCBlKTtcXG4gICAgICAgIH0gZmluYWxseSB7XFxuICAgICAgICAgICAgaWYgKGVtICE9IG51bGwgJiYgZW0uaXNPcGVuKCkpIHtcXG4gICAgICAgICAgICAgICAgZW0uY2xvc2UoKTtcXG4gICAgICAgICAgICB9XFxuICAgICAgICB9XFxuICAgICAgICByZXR1cm4gcmVzdWx0O1xcbiAgICB9XCIsIFwib2xkX3N0cl9zdGFydF9saW5lX251bWJlclwiOiA3OCwgXCJvbGRfc3RyX2VuZF9saW5lX251bWJlclwiOiA4MH1dfSJ9fSx7ImlkIjowLCJ0eXBlIjowLCJjb250ZW50IjoiIn0seyJpZCI6MiwidHlwZSI6MiwiY29udGVudCI6IiJ9LHsiaWQiOjMsInR5cGUiOjMsImNvbnRlbnQiOiIifV0sInNlZW5fc3RhdGUiOiJzZWVuIiwic3RydWN0dXJlZF9yZXF1ZXN0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6MSwidG9vbF9yZXN1bHRfbm9kZSI6eyJjb250ZW50IjoiU3VjY2Vzc2Z1bGx5IGVkaXRlZCB0aGUgZmlsZSBzcmMvbWFpbi9qYXZhL2Rhby9pbXBsL0todXllbk1haURBT0ltcGwuamF2YS5cblJlc3VsdCBmb3Igc3RyX3JlcGxhY2VfZW50cmllc1swXTpcblJlcGxhY2VtZW50IHN1Y2Nlc3NmdWwuXG5FZGl0ZWQgc2VjdGlvbiBhZnRlciBJREUgYXV0by1mb3JtYXR0aW5nIHdhcyBhcHBsaWVkOlxuICAgIDQ2XHQgICAgICAgIH1cbiAgICA0N1x0ICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIDQ4XHQgICAgfVxuICAgIDQ5XHRcbiAgICA1MFx0ICAgIC8vIEzhuqV5IGRhbmggc8OhY2gga2h1eeG6v24gbcOjaSB0aGVvIHTDqm5cbiAgICA1MVx0ICAgIEBPdmVycmlkZVxuICAgIDUyXHQgICAgcHVibGljIExpc3Q8S2h1eWVuTWFpPiBmaW5kQnlOYW1lKFN0cmluZyBuYW1lKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uIHtcbiAgICA1M1x0ICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gSlBBVXRpbC5nZXRFbnRpdHlNYW5hZ2VyKCk7XG4gICAgNTRcdCAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHggPSBlbS5nZXRUcmFuc2FjdGlvbigpO1xuICAgIDU1XHQgICAgICAgIExpc3Q8S2h1eWVuTWFpPiByZXN1bHQgPSBuZXcgQXJyYXlMaXN0PD4oKTtcbiAgICA1Nlx0XG4gICAgNTdcdCAgICAgICAgdHJ5IHtcbiAgICA1OFx0ICAgICAgICAgICAgdHguYmVnaW4oKTtcbiAgICA1OVx0ICAgICAgICAgICAgU3RyaW5nIHF1ZXJ5ID0gXCJzZWxlY3Qga20gZnJvbSBLaHV5ZW5NYWkga20gd2hlcmUga20udGVuS00gbGlrZSA6bmFtZVwiO1xuICAgIDYwXHQgICAgICAgICAgICByZXN1bHQgPSBlbS5jcmVhdGVRdWVyeShxdWVyeSwgS2h1eWVuTWFpLmNsYXNzKVxuICAgIDYxXHQgICAgICAgICAgICAgICAgICAgIC5zZXRQYXJhbWV0ZXIoXCJuYW1lXCIsIFwiJVwiICsgbmFtZSArIFwiJVwiKVxuICAgIDYyXHQgICAgICAgICAgICAgICAgICAgIC5nZXRSZXN1bHRMaXN0KCk7XG4gICAgNjNcdCAgICAgICAgICAgIHR4LmNvbW1pdCgpO1xuICAgIDY0XHQgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgNjVcdCAgICAgICAgICAgIGlmICh0eC5pc0FjdGl2ZSgpKSB7XG4gICAgNjZcdCAgICAgICAgICAgICAgICB0eC5yb2xsYmFjaygpO1xuICAgIDY3XHQgICAgICAgICAgICB9XG4gICAgNjhcdCAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgNjlcdCAgICAgICAgICAgIHRocm93IG5ldyBSZW1vdGVFeGNlcHRpb24oXCJM4buXaSBraGkgdMOsbSBraHV54bq/biBtw6NpIHRoZW8gdMOqblwiLCBlKTtcbiAgICA3MFx0ICAgICAgICB9IGZpbmFsbHkge1xuICAgIDcxXHQgICAgICAgICAgICBpZiAoZW0gIT0gbnVsbCAmJiBlbS5pc09wZW4oKSkge1xuICAgIDcyXHQgICAgICAgICAgICAgICAgZW0uY2xvc2UoKTtcbiAgICA3M1x0ICAgICAgICAgICAgfVxuICAgIDc0XHQgICAgICAgIH1cbiAgICA3NVx0ICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIDc2XHQgICAgfVxuICAgIDc3XHRcbiAgICA3OFx0ICAgIC8vIEzhuqV5IGtodXnhur9uIG3Do2kgdGhlbyBtw6NcbiAgICA3OVx0ICAgIHB1YmxpYyBLaHV5ZW5NYWkgZmluZEJ5SWQoU3RyaW5nIGlkKSB7XG4gICAgODBcdCAgICAgICAgcmV0dXJuIGVtLmZpbmQoS2h1eWVuTWFpLmNsYXNzLCBpZCk7XG5cblJldmlldyB0aGUgY2hhbmdlcyBhbmQgbWFrZSBzdXJlIHRoZXkgYXJlIGFzIGV4cGVjdGVkIChjb3JyZWN0IGluZGVudGF0aW9uLCBubyBkdXBsaWNhdGUgbGluZXMsIGV0YykuXG5FZGl0IHRoZSBmaWxlIGFnYWluIGlmIG5lY2Vzc2FyeS5cbiIsImlzX2Vycm9yIjpmYWxzZSwicmVxdWVzdF9pZCI6IiIsInRvb2xfdXNlX2lkIjoidG9vbHVfMDFIVmNIUGRkc3NOWHkxMVNHbVd1RW1DIn19LHsiaWQiOjIsInR5cGUiOjQsImlkZV9zdGF0ZV9ub2RlIjp7IndvcmtzcGFjZUZvbGRlcnMiOlt7InJlcG9zaXRvcnlSb290IjoiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmciLCJmb2xkZXJSb290IjoiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcifV0sIndvcmtzcGFjZUZvbGRlcnNVbmNoYW5nZWQiOmZhbHNlfX1dLCJyZXNwb25zZV90ZXh0IjoiIiwid29ya3NwYWNlX2ZpbGVfY2h1bmtzIjpbXX0seyJzdGF0dXMiOiJzdWNjZXNzIiwicmVxdWVzdF9pZCI6IjBhZjI0YTBlLTI1ZGYtNDJhOS04YzU4LTk0NWIyYWU4ZmMyOCIsInJlcXVlc3RfbWVzc2FnZSI6IiIsInN0cnVjdHVyZWRfb3V0cHV0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6NSwiY29udGVudCI6IiIsInRvb2xfdXNlIjp7InRvb2xfdXNlX2lkIjoidG9vbHVfMDFKRFI2QUE5blU1RVNOOVJrR2t5cHJ2IiwidG9vbF9uYW1lIjoic3RyLXJlcGxhY2UtZWRpdG9yIiwiaW5wdXRfanNvbiI6IntcImNvbW1hbmRcIjogXCJzdHJfcmVwbGFjZVwiLCBcInBhdGhcIjogXCJzcmMvbWFpbi9qYXZhL2Rhby9pbXBsL0todXllbk1haURBT0ltcGwuamF2YVwiLCBcInN0cl9yZXBsYWNlX2VudHJpZXNcIjogW3tcIm9sZF9zdHJcIjogXCIgICAgLy8gVGhcXHUwMGVhbSBob1xcdTFlYjdjIGNcXHUxZWFkcCBuaFxcdTFlYWR0IGtodXlcXHUxZWJmbiBtXFx1MDBlM2lcXG4gICAgcHVibGljIGJvb2xlYW4gc2F2ZShLaHV5ZW5NYWkga2h1eWVuTWFpKSB7XFxuICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0ciA9IGVtLmdldFRyYW5zYWN0aW9uKCk7XFxuICAgICAgICB0cnkge1xcbiAgICAgICAgICAgIHRyLmJlZ2luKCk7XFxuICAgICAgICAgICAgaWYgKGVtLmZpbmQoS2h1eWVuTWFpLmNsYXNzLCBraHV5ZW5NYWkuZ2V0TWFLTSgpKSA9PSBudWxsKSB7XFxuICAgICAgICAgICAgICAgIGVtLnBlcnNpc3Qoa2h1eWVuTWFpKTsgLy8gVGhcXHUwMGVhbSBtXFx1MWVkYmlcXG4gICAgICAgICAgICB9IGVsc2Uge1xcbiAgICAgICAgICAgICAgICBlbS5tZXJnZShraHV5ZW5NYWkpOyAvLyBDXFx1MWVhZHAgbmhcXHUxZWFkdFxcbiAgICAgICAgICAgIH1cXG4gICAgICAgICAgICB0ci5jb21taXQoKTtcXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcXG4gICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBleCkge1xcbiAgICAgICAgICAgIGV4LnByaW50U3RhY2tUcmFjZSgpO1xcbiAgICAgICAgICAgIHRyLnJvbGxiYWNrKCk7XFxuICAgICAgICB9XFxuICAgICAgICByZXR1cm4gZmFsc2U7XFxuICAgIH1cIiwgXCJuZXdfc3RyXCI6IFwiICAgIC8vIFRoXFx1MDBlYW0gaG9cXHUxZWI3YyBjXFx1MWVhZHAgbmhcXHUxZWFkdCBraHV5XFx1MWViZm4gbVxcdTAwZTNpXFxuICAgIEBPdmVycmlkZVxcbiAgICBwdWJsaWMgYm9vbGVhbiBzYXZlKEtodXllbk1haSBraHV5ZW5NYWkpIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xcbiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IEpQQVV0aWwuZ2V0RW50aXR5TWFuYWdlcigpO1xcbiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHggPSBlbS5nZXRUcmFuc2FjdGlvbigpO1xcbiAgICAgICAgXFxuICAgICAgICB0cnkge1xcbiAgICAgICAgICAgIHR4LmJlZ2luKCk7XFxuICAgICAgICAgICAgaWYgKGVtLmZpbmQoS2h1eWVuTWFpLmNsYXNzLCBraHV5ZW5NYWkuZ2V0TWFLTSgpKSA9PSBudWxsKSB7XFxuICAgICAgICAgICAgICAgIGVtLnBlcnNpc3Qoa2h1eWVuTWFpKTsgLy8gVGhcXHUwMGVhbSBtXFx1MWVkYmlcXG4gICAgICAgICAgICB9IGVsc2Uge1xcbiAgICAgICAgICAgICAgICBlbS5tZXJnZShraHV5ZW5NYWkpOyAvLyBDXFx1MWVhZHAgbmhcXHUxZWFkdFxcbiAgICAgICAgICAgIH1cXG4gICAgICAgICAgICB0eC5jb21taXQoKTtcXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcXG4gICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XFxuICAgICAgICAgICAgaWYgKHR4LmlzQWN0aXZlKCkpIHtcXG4gICAgICAgICAgICAgICAgdHgucm9sbGJhY2soKTtcXG4gICAgICAgICAgICB9XFxuICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcXG4gICAgICAgICAgICB0aHJvdyBuZXcgUmVtb3RlRXhjZXB0aW9uKFxcXCJMXFx1MWVkN2kga2hpIGxcXHUwMWIwdSBraHV5XFx1MWViZm4gbVxcdTAwZTNpXFxcIiwgZSk7XFxuICAgICAgICB9IGZpbmFsbHkge1xcbiAgICAgICAgICAgIGlmIChlbSAhPSBudWxsICYmIGVtLmlzT3BlbigpKSB7XFxuICAgICAgICAgICAgICAgIGVtLmNsb3NlKCk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgfVxcbiAgICB9XCIsIFwib2xkX3N0cl9zdGFydF9saW5lX251bWJlclwiOiAxMDMsIFwib2xkX3N0cl9lbmRfbGluZV9udW1iZXJcIjogMTIwfV19In19LHsiaWQiOjAsInR5cGUiOjAsImNvbnRlbnQiOiIifSx7ImlkIjoyLCJ0eXBlIjoyLCJjb250ZW50IjoiIn0seyJpZCI6MywidHlwZSI6MywiY29udGVudCI6IiJ9XSwic2Vlbl9zdGF0ZSI6InNlZW4iLCJzdHJ1Y3R1cmVkX3JlcXVlc3Rfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjoxLCJ0b29sX3Jlc3VsdF9ub2RlIjp7ImNvbnRlbnQiOiJTdWNjZXNzZnVsbHkgZWRpdGVkIHRoZSBmaWxlIHNyYy9tYWluL2phdmEvZGFvL2ltcGwvS2h1eWVuTWFpREFPSW1wbC5qYXZhLlxuUmVzdWx0IGZvciBzdHJfcmVwbGFjZV9lbnRyaWVzWzBdOlxuUmVwbGFjZW1lbnQgc3VjY2Vzc2Z1bC5cbkVkaXRlZCBzZWN0aW9uIGFmdGVyIElERSBhdXRvLWZvcm1hdHRpbmcgd2FzIGFwcGxpZWQ6XG4gICAgNzRcdCAgICAgICAgfVxuICAgIDc1XHQgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgNzZcdCAgICB9XG4gICAgNzdcdFxuICAgIDc4XHQgICAgLy8gTOG6pXkga2h1eeG6v24gbcOjaSB0aGVvIG3Do1xuICAgIDc5XHQgICAgQE92ZXJyaWRlXG4gICAgODBcdCAgICBwdWJsaWMgS2h1eWVuTWFpIGZpbmRCeUlkKFN0cmluZyBpZCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgODFcdCAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IEpQQVV0aWwuZ2V0RW50aXR5TWFuYWdlcigpO1xuICAgIDgyXHQgICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHR4ID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcbiAgICA4M1x0ICAgICAgICBLaHV5ZW5NYWkgcmVzdWx0ID0gbnVsbDtcbiAgICA4NFx0XG4gICAgODVcdCAgICAgICAgdHJ5IHtcbiAgICA4Nlx0ICAgICAgICAgICAgdHguYmVnaW4oKTtcbiAgICA4N1x0ICAgICAgICAgICAgcmVzdWx0ID0gZW0uZmluZChLaHV5ZW5NYWkuY2xhc3MsIGlkKTtcbiAgICA4OFx0ICAgICAgICAgICAgdHguY29tbWl0KCk7XG4gICAgODlcdCAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICA5MFx0ICAgICAgICAgICAgaWYgKHR4LmlzQWN0aXZlKCkpIHtcbiAgICA5MVx0ICAgICAgICAgICAgICAgIHR4LnJvbGxiYWNrKCk7XG4gICAgOTJcdCAgICAgICAgICAgIH1cbiAgICA5M1x0ICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICA5NFx0ICAgICAgICAgICAgdGhyb3cgbmV3IFJlbW90ZUV4Y2VwdGlvbihcIkzhu5dpIGtoaSB0w6xtIGtodXnhur9uIG3Do2kgdGhlbyBtw6NcIiwgZSk7XG4gICAgOTVcdCAgICAgICAgfSBmaW5hbGx5IHtcbiAgICA5Nlx0ICAgICAgICAgICAgaWYgKGVtICE9IG51bGwgJiYgZW0uaXNPcGVuKCkpIHtcbiAgICA5N1x0ICAgICAgICAgICAgICAgIGVtLmNsb3NlKCk7XG4gICAgOThcdCAgICAgICAgICAgIH1cbiAgICA5OVx0ICAgICAgICB9XG4gICAxMDBcdCAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgIDEwMVx0ICAgIH1cbiAgIDEwMlx0XG4gICAxMDNcdCAgICAvLyBUaMOqbSBob+G6t2MgY+G6rXAgbmjhuq10IGtodXnhur9uIG3Do2lcbiAgIDEwNFx0ICAgIHB1YmxpYyBib29sZWFuIHNhdmUoS2h1eWVuTWFpIGtodXllbk1haSkge1xuICAgMTA1XHQgICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcblxuUmV2aWV3IHRoZSBjaGFuZ2VzIGFuZCBtYWtlIHN1cmUgdGhleSBhcmUgYXMgZXhwZWN0ZWQgKGNvcnJlY3QgaW5kZW50YXRpb24sIG5vIGR1cGxpY2F0ZSBsaW5lcywgZXRjKS5cbkVkaXQgdGhlIGZpbGUgYWdhaW4gaWYgbmVjZXNzYXJ5LlxuIiwiaXNfZXJyb3IiOmZhbHNlLCJyZXF1ZXN0X2lkIjoiIiwidG9vbF91c2VfaWQiOiJ0b29sdV8wMTlKbVU4S25tWnJ0aEpYRnV0a0dwNjEifX0seyJpZCI6MiwidHlwZSI6NCwiaWRlX3N0YXRlX25vZGUiOnsid29ya3NwYWNlRm9sZGVycyI6W3sicmVwb3NpdG9yeVJvb3QiOiJFOi9MVFBUSkFWQS9OaG9tL1BoYW5UYW5KYXZhTmhvbUdQVC9Qcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyIsImZvbGRlclJvb3QiOiJFOi9MVFBUSkFWQS9OaG9tL1BoYW5UYW5KYXZhTmhvbUdQVC9Qcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyJ9XSwid29ya3NwYWNlRm9sZGVyc1VuY2hhbmdlZCI6ZmFsc2V9fV0sInJlc3BvbnNlX3RleHQiOiIiLCJ3b3Jrc3BhY2VfZmlsZV9jaHVua3MiOltdfSx7InN0YXR1cyI6InN1Y2Nlc3MiLCJyZXF1ZXN0X2lkIjoiMzUyZmY5MGItNzU1Yy00ZGExLTlkMzUtZDM2ZDZjYTQ2YTFjIiwicmVxdWVzdF9tZXNzYWdlIjoiIiwic3RydWN0dXJlZF9vdXRwdXRfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjo1LCJjb250ZW50IjoiIiwidG9vbF91c2UiOnsidG9vbF91c2VfaWQiOiJ0b29sdV8wMVBZWU1DM2laeUZzVWRnamppN2pMRW8iLCJ0b29sX25hbWUiOiJzdHItcmVwbGFjZS1lZGl0b3IiLCJpbnB1dF9qc29uIjoie1wiY29tbWFuZFwiOiBcInN0cl9yZXBsYWNlXCIsIFwicGF0aFwiOiBcInNyYy9tYWluL2phdmEvZGFvL2ltcGwvS2h1eWVuTWFpREFPSW1wbC5qYXZhXCIsIFwic3RyX3JlcGxhY2VfZW50cmllc1wiOiBbe1wib2xkX3N0clwiOiBcIiAgICAvLyBYXFx1MDBmM2Ega2h1eVxcdTFlYmZuIG1cXHUwMGUzaSB0aGVvIG1cXHUwMGUzXFxuICAgIHB1YmxpYyBib29sZWFuIGRlbGV0ZShTdHJpbmcgaWQpIHtcXG4gICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcXG4gICAgICAgIHRyeSB7XFxuICAgICAgICAgICAgdHIuYmVnaW4oKTtcXG4gICAgICAgICAgICBLaHV5ZW5NYWkga20gPSBlbS5maW5kKEtodXllbk1haS5jbGFzcywgaWQpO1xcbiAgICAgICAgICAgIGlmIChrbSAhPSBudWxsKSB7XFxuICAgICAgICAgICAgICAgIGVtLnJlbW92ZShrbSk7XFxuICAgICAgICAgICAgICAgIHRyLmNvbW1pdCgpO1xcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcXG4gICAgICAgICAgICB9XFxuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZXgpIHtcXG4gICAgICAgICAgICBleC5wcmludFN0YWNrVHJhY2UoKTtcXG4gICAgICAgICAgICB0ci5yb2xsYmFjaygpO1xcbiAgICAgICAgfVxcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xcbiAgICB9XCIsIFwibmV3X3N0clwiOiBcIiAgICAvLyBYXFx1MDBmM2Ega2h1eVxcdTFlYmZuIG1cXHUwMGUzaSB0aGVvIG1cXHUwMGUzXFxuICAgIEBPdmVycmlkZVxcbiAgICBwdWJsaWMgYm9vbGVhbiBkZWxldGUoU3RyaW5nIGlkKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uIHtcXG4gICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcXG4gICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHR4ID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcXG4gICAgICAgIFxcbiAgICAgICAgdHJ5IHtcXG4gICAgICAgICAgICB0eC5iZWdpbigpO1xcbiAgICAgICAgICAgIEtodXllbk1haSBrbSA9IGVtLmZpbmQoS2h1eWVuTWFpLmNsYXNzLCBpZCk7XFxuICAgICAgICAgICAgaWYgKGttICE9IG51bGwpIHtcXG4gICAgICAgICAgICAgICAgZW0ucmVtb3ZlKGttKTtcXG4gICAgICAgICAgICAgICAgdHguY29tbWl0KCk7XFxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgICAgICB0eC5jb21taXQoKTtcXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XFxuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xcbiAgICAgICAgICAgIGlmICh0eC5pc0FjdGl2ZSgpKSB7XFxuICAgICAgICAgICAgICAgIHR4LnJvbGxiYWNrKCk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XFxuICAgICAgICAgICAgdGhyb3cgbmV3IFJlbW90ZUV4Y2VwdGlvbihcXFwiTFxcdTFlZDdpIGtoaSB4XFx1MDBmM2Ega2h1eVxcdTFlYmZuIG1cXHUwMGUzaVxcXCIsIGUpO1xcbiAgICAgICAgfSBmaW5hbGx5IHtcXG4gICAgICAgICAgICBpZiAoZW0gIT0gbnVsbCAmJiBlbS5pc09wZW4oKSkge1xcbiAgICAgICAgICAgICAgICBlbS5jbG9zZSgpO1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgIH1cXG4gICAgfVwiLCBcIm9sZF9zdHJfc3RhcnRfbGluZV9udW1iZXJcIjogMTMxLCBcIm9sZF9zdHJfZW5kX2xpbmVfbnVtYmVyXCI6IDE0N31dfSJ9fSx7ImlkIjowLCJ0eXBlIjowLCJjb250ZW50IjoiIn0seyJpZCI6MiwidHlwZSI6MiwiY29udGVudCI6IiJ9LHsiaWQiOjMsInR5cGUiOjMsImNvbnRlbnQiOiIifV0sInNlZW5fc3RhdGUiOiJzZWVuIiwic3RydWN0dXJlZF9yZXF1ZXN0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6MSwidG9vbF9yZXN1bHRfbm9kZSI6eyJjb250ZW50IjoiU3VjY2Vzc2Z1bGx5IGVkaXRlZCB0aGUgZmlsZSBzcmMvbWFpbi9qYXZhL2Rhby9pbXBsL0todXllbk1haURBT0ltcGwuamF2YS5cblJlc3VsdCBmb3Igc3RyX3JlcGxhY2VfZW50cmllc1swXTpcblJlcGxhY2VtZW50IHN1Y2Nlc3NmdWwuXG5FZGl0ZWQgc2VjdGlvbiBhZnRlciBJREUgYXV0by1mb3JtYXR0aW5nIHdhcyBhcHBsaWVkOlxuICAgIDk5XHQgICAgICAgIH1cbiAgIDEwMFx0ICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgMTAxXHQgICAgfVxuICAgMTAyXHRcbiAgIDEwM1x0ICAgIC8vIFRow6ptIGhv4bq3YyBj4bqtcCBuaOG6rXQga2h1eeG6v24gbcOjaVxuICAgMTA0XHQgICAgQE92ZXJyaWRlXG4gICAxMDVcdCAgICBwdWJsaWMgYm9vbGVhbiBzYXZlKEtodXllbk1haSBraHV5ZW5NYWkpIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xuICAgMTA2XHQgICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcbiAgIDEwN1x0ICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0eCA9IGVtLmdldFRyYW5zYWN0aW9uKCk7XG4gICAxMDhcdFxuICAgMTA5XHQgICAgICAgIHRyeSB7XG4gICAxMTBcdCAgICAgICAgICAgIHR4LmJlZ2luKCk7XG4gICAxMTFcdCAgICAgICAgICAgIGlmIChlbS5maW5kKEtodXllbk1haS5jbGFzcywga2h1eWVuTWFpLmdldE1hS00oKSkgPT0gbnVsbCkge1xuICAgMTEyXHQgICAgICAgICAgICAgICAgZW0ucGVyc2lzdChraHV5ZW5NYWkpOyAvLyBUaMOqbSBt4bubaVxuICAgMTEzXHQgICAgICAgICAgICB9IGVsc2Uge1xuICAgMTE0XHQgICAgICAgICAgICAgICAgZW0ubWVyZ2Uoa2h1eWVuTWFpKTsgLy8gQ+G6rXAgbmjhuq10XG4gICAxMTVcdCAgICAgICAgICAgIH1cbiAgIDExNlx0ICAgICAgICAgICAgdHguY29tbWl0KCk7XG4gICAxMTdcdCAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgMTE4XHQgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAxMTlcdCAgICAgICAgICAgIGlmICh0eC5pc0FjdGl2ZSgpKSB7XG4gICAxMjBcdCAgICAgICAgICAgICAgICB0eC5yb2xsYmFjaygpO1xuICAgMTIxXHQgICAgICAgICAgICB9XG4gICAxMjJcdCAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAxMjNcdCAgICAgICAgICAgIHRocm93IG5ldyBSZW1vdGVFeGNlcHRpb24oXCJM4buXaSBraGkgbMawdSBraHV54bq/biBtw6NpXCIsIGUpO1xuICAgMTI0XHQgICAgICAgIH0gZmluYWxseSB7XG4gICAxMjVcdCAgICAgICAgICAgIGlmIChlbSAhPSBudWxsICYmIGVtLmlzT3BlbigpKSB7XG4gICAxMjZcdCAgICAgICAgICAgICAgICBlbS5jbG9zZSgpO1xuICAgMTI3XHQgICAgICAgICAgICB9XG4gICAxMjhcdCAgICAgICAgfVxuICAgMTI5XHQgICAgfVxuICAgMTMwXHRcbiAgIDEzMVx0ICAgIC8vIFjDs2Ega2h1eeG6v24gbcOjaSB0aGVvIG3Do1xuICAgMTMyXHQgICAgcHVibGljIGJvb2xlYW4gZGVsZXRlKFN0cmluZyBpZCkge1xuICAgMTMzXHQgICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcblxuUmV2aWV3IHRoZSBjaGFuZ2VzIGFuZCBtYWtlIHN1cmUgdGhleSBhcmUgYXMgZXhwZWN0ZWQgKGNvcnJlY3QgaW5kZW50YXRpb24sIG5vIGR1cGxpY2F0ZSBsaW5lcywgZXRjKS5cbkVkaXQgdGhlIGZpbGUgYWdhaW4gaWYgbmVjZXNzYXJ5LlxuIiwiaXNfZXJyb3IiOmZhbHNlLCJyZXF1ZXN0X2lkIjoiIiwidG9vbF91c2VfaWQiOiJ0b29sdV8wMUpEUjZBQTluVTVFU045UmtHa3lwcnYifX0seyJpZCI6MiwidHlwZSI6NCwiaWRlX3N0YXRlX25vZGUiOnsid29ya3NwYWNlRm9sZGVycyI6W3sicmVwb3NpdG9yeVJvb3QiOiJFOi9MVFBUSkFWQS9OaG9tL1BoYW5UYW5KYXZhTmhvbUdQVC9Qcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyIsImZvbGRlclJvb3QiOiJFOi9MVFBUSkFWQS9OaG9tL1BoYW5UYW5KYXZhTmhvbUdQVC9Qcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyJ9XSwid29ya3NwYWNlRm9sZGVyc1VuY2hhbmdlZCI6ZmFsc2V9fV0sInJlc3BvbnNlX3RleHQiOiIiLCJ3b3Jrc3BhY2VfZmlsZV9jaHVua3MiOltdfSx7InN0YXR1cyI6InN1Y2Nlc3MiLCJyZXF1ZXN0X2lkIjoiOTg0YzFkMjgtMjEzNS00MTkwLWJmNjQtZjc5OGFmOTVhZmQ3IiwicmVxdWVzdF9tZXNzYWdlIjoiIiwic3RydWN0dXJlZF9vdXRwdXRfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjo1LCJjb250ZW50IjoiIiwidG9vbF91c2UiOnsidG9vbF91c2VfaWQiOiJ0b29sdV8wMUZBNVdGZTVpRXExWEM1RTRnZ3JVTkYiLCJ0b29sX25hbWUiOiJzdHItcmVwbGFjZS1lZGl0b3IiLCJpbnB1dF9qc29uIjoie1wiY29tbWFuZFwiOiBcInN0cl9yZXBsYWNlXCIsIFwicGF0aFwiOiBcInNyYy9tYWluL2phdmEvZGFvL2ltcGwvS2h1eWVuTWFpREFPSW1wbC5qYXZhXCIsIFwic3RyX3JlcGxhY2VfZW50cmllc1wiOiBbe1wib2xkX3N0clwiOiBcIiAgICAvLyBUXFx1MDBlY20gY1xcdTAwZTFjIGtodXlcXHUxZWJmbiBtXFx1MDBlM2kgXFx1MDExMWFuZyBcXHUwMGUxcCBkXFx1MWVlNW5nXFxuICAgIHB1YmxpYyBMaXN0PEtodXllbk1haT4gZmluZE9uZ29pbmdQcm9tb3Rpb25zKCkge1xcbiAgICAgICAgU3RyaW5nIHF1ZXJ5ID0gXFxcInNlbGVjdCBrbSBmcm9tIEtodXllbk1haSBrbSBcXFwiICtcXG4gICAgICAgICAgICAgICAgXFxcIndoZXJlIGttLnRyYW5nVGhhaSA9IDp0cmFuZ1RoYWkgXFxcIiArXFxuICAgICAgICAgICAgICAgIFxcXCJhbmQga20udGhvaUdpYW5CYXREYXUgPD0gOnRvZGF5IFxcXCIgK1xcbiAgICAgICAgICAgICAgICBcXFwiYW5kIGttLnRob2lHaWFuS2V0VGh1YyA+PSA6dG9kYXlcXFwiO1xcblxcbiAgICAgICAgcmV0dXJuIGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5LCBLaHV5ZW5NYWkuY2xhc3MpXFxuICAgICAgICAgICAgICAgIC5zZXRQYXJhbWV0ZXIoXFxcInRyYW5nVGhhaVxcXCIsIFxcXCJcXHUwMTEwYW5nIGRpXFx1MWVjNW4gcmFcXFwiKVxcbiAgICAgICAgICAgICAgICAuc2V0UGFyYW1ldGVyKFxcXCJ0b2RheVxcXCIsIExvY2FsRGF0ZS5ub3coKSlcXG4gICAgICAgICAgICAgICAgLmdldFJlc3VsdExpc3QoKTtcXG4gICAgfVwiLCBcIm5ld19zdHJcIjogXCIgICAgLy8gVFxcdTAwZWNtIGNcXHUwMGUxYyBraHV5XFx1MWViZm4gbVxcdTAwZTNpIFxcdTAxMTFhbmcgXFx1MDBlMXAgZFxcdTFlZTVuZ1xcbiAgICBAT3ZlcnJpZGVcXG4gICAgcHVibGljIExpc3Q8S2h1eWVuTWFpPiBmaW5kT25nb2luZ1Byb21vdGlvbnMoKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uIHtcXG4gICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcXG4gICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHR4ID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcXG4gICAgICAgIExpc3Q8S2h1eWVuTWFpPiByZXN1bHQgPSBuZXcgQXJyYXlMaXN0PD4oKTtcXG4gICAgICAgIFxcbiAgICAgICAgdHJ5IHtcXG4gICAgICAgICAgICB0eC5iZWdpbigpO1xcbiAgICAgICAgICAgIFN0cmluZyBxdWVyeSA9IFxcXCJzZWxlY3Qga20gZnJvbSBLaHV5ZW5NYWkga20gXFxcIiArXFxuICAgICAgICAgICAgICAgICAgICBcXFwid2hlcmUga20udHJhbmdUaGFpID0gOnRyYW5nVGhhaSBcXFwiICtcXG4gICAgICAgICAgICAgICAgICAgIFxcXCJhbmQga20udGhvaUdpYW5CYXREYXUgPD0gOnRvZGF5IFxcXCIgK1xcbiAgICAgICAgICAgICAgICAgICAgXFxcImFuZCBrbS50aG9pR2lhbktldFRodWMgPj0gOnRvZGF5XFxcIjtcXG5cXG4gICAgICAgICAgICByZXN1bHQgPSBlbS5jcmVhdGVRdWVyeShxdWVyeSwgS2h1eWVuTWFpLmNsYXNzKVxcbiAgICAgICAgICAgICAgICAgICAgLnNldFBhcmFtZXRlcihcXFwidHJhbmdUaGFpXFxcIiwgXFxcIlxcdTAxMTBhbmcgZGlcXHUxZWM1biByYVxcXCIpXFxuICAgICAgICAgICAgICAgICAgICAuc2V0UGFyYW1ldGVyKFxcXCJ0b2RheVxcXCIsIExvY2FsRGF0ZS5ub3coKSlcXG4gICAgICAgICAgICAgICAgICAgIC5nZXRSZXN1bHRMaXN0KCk7XFxuICAgICAgICAgICAgdHguY29tbWl0KCk7XFxuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xcbiAgICAgICAgICAgIGlmICh0eC5pc0FjdGl2ZSgpKSB7XFxuICAgICAgICAgICAgICAgIHR4LnJvbGxiYWNrKCk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XFxuICAgICAgICAgICAgdGhyb3cgbmV3IFJlbW90ZUV4Y2VwdGlvbihcXFwiTFxcdTFlZDdpIGtoaSB0XFx1MDBlY20ga2h1eVxcdTFlYmZuIG1cXHUwMGUzaSBcXHUwMTExYW5nIFxcdTAwZTFwIGRcXHUxZWU1bmdcXFwiLCBlKTtcXG4gICAgICAgIH0gZmluYWxseSB7XFxuICAgICAgICAgICAgaWYgKGVtICE9IG51bGwgJiYgZW0uaXNPcGVuKCkpIHtcXG4gICAgICAgICAgICAgICAgZW0uY2xvc2UoKTtcXG4gICAgICAgICAgICB9XFxuICAgICAgICB9XFxuICAgICAgICByZXR1cm4gcmVzdWx0O1xcbiAgICB9XFxuICAgIFxcbiAgICBAT3ZlcnJpZGVcXG4gICAgcHVibGljIGJvb2xlYW4gdGVzdENvbm5lY3Rpb24oKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uIHtcXG4gICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcXG4gICAgICAgIHRyeSB7XFxuICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpO1xcbiAgICAgICAgICAgIGVtLmNyZWF0ZVF1ZXJ5KFxcXCJTRUxFQ1QgMVxcXCIpLmdldFJlc3VsdExpc3QoKTtcXG4gICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1pdCgpO1xcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xcbiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcXG4gICAgICAgICAgICBpZiAoZW0uZ2V0VHJhbnNhY3Rpb24oKS5pc0FjdGl2ZSgpKSB7XFxuICAgICAgICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkucm9sbGJhY2soKTtcXG4gICAgICAgICAgICB9XFxuICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XFxuICAgICAgICB9IGZpbmFsbHkge1xcbiAgICAgICAgICAgIGlmIChlbSAhPSBudWxsICYmIGVtLmlzT3BlbigpKSB7XFxuICAgICAgICAgICAgICAgIGVtLmNsb3NlKCk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgfVxcbiAgICB9XCIsIFwib2xkX3N0cl9zdGFydF9saW5lX251bWJlclwiOiAxNTksIFwib2xkX3N0cl9lbmRfbGluZV9udW1iZXJcIjogMTcwfV19In19LHsiaWQiOjAsInR5cGUiOjAsImNvbnRlbnQiOiIifSx7ImlkIjoyLCJ0eXBlIjoyLCJjb250ZW50IjoiIn0seyJpZCI6MywidHlwZSI6MywiY29udGVudCI6IiJ9XSwic2Vlbl9zdGF0ZSI6InNlZW4iLCJzdHJ1Y3R1cmVkX3JlcXVlc3Rfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjoxLCJ0b29sX3Jlc3VsdF9ub2RlIjp7ImNvbnRlbnQiOiJTdWNjZXNzZnVsbHkgZWRpdGVkIHRoZSBmaWxlIHNyYy9tYWluL2phdmEvZGFvL2ltcGwvS2h1eWVuTWFpREFPSW1wbC5qYXZhLlxuUmVzdWx0IGZvciBzdHJfcmVwbGFjZV9lbnRyaWVzWzBdOlxuUmVwbGFjZW1lbnQgc3VjY2Vzc2Z1bC5cbkVkaXRlZCBzZWN0aW9uIGFmdGVyIElERSBhdXRvLWZvcm1hdHRpbmcgd2FzIGFwcGxpZWQ6XG4gICAxMjdcdCAgICAgICAgICAgIH1cbiAgIDEyOFx0ICAgICAgICB9XG4gICAxMjlcdCAgICB9XG4gICAxMzBcdFxuICAgMTMxXHQgICAgLy8gWMOzYSBraHV54bq/biBtw6NpIHRoZW8gbcOjXG4gICAxMzJcdCAgICBAT3ZlcnJpZGVcbiAgIDEzM1x0ICAgIHB1YmxpYyBib29sZWFuIGRlbGV0ZShTdHJpbmcgaWQpIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xuICAgMTM0XHQgICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcbiAgIDEzNVx0ICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0eCA9IGVtLmdldFRyYW5zYWN0aW9uKCk7XG4gICAxMzZcdFxuICAgMTM3XHQgICAgICAgIHRyeSB7XG4gICAxMzhcdCAgICAgICAgICAgIHR4LmJlZ2luKCk7XG4gICAxMzlcdCAgICAgICAgICAgIEtodXllbk1haSBrbSA9IGVtLmZpbmQoS2h1eWVuTWFpLmNsYXNzLCBpZCk7XG4gICAxNDBcdCAgICAgICAgICAgIGlmIChrbSAhPSBudWxsKSB7XG4gICAxNDFcdCAgICAgICAgICAgICAgICBlbS5yZW1vdmUoa20pO1xuICAgMTQyXHQgICAgICAgICAgICAgICAgdHguY29tbWl0KCk7XG4gICAxNDNcdCAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgIDE0NFx0ICAgICAgICAgICAgfVxuICAgMTQ1XHQgICAgICAgICAgICB0eC5jb21taXQoKTtcbiAgIDE0Nlx0ICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgMTQ3XHQgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAxNDhcdCAgICAgICAgICAgIGlmICh0eC5pc0FjdGl2ZSgpKSB7XG4gICAxNDlcdCAgICAgICAgICAgICAgICB0eC5yb2xsYmFjaygpO1xuICAgMTUwXHQgICAgICAgICAgICB9XG4gICAxNTFcdCAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAxNTJcdCAgICAgICAgICAgIHRocm93IG5ldyBSZW1vdGVFeGNlcHRpb24oXCJM4buXaSBraGkgeMOzYSBraHV54bq/biBtw6NpXCIsIGUpO1xuICAgMTUzXHQgICAgICAgIH0gZmluYWxseSB7XG4gICAxNTRcdCAgICAgICAgICAgIGlmIChlbSAhPSBudWxsICYmIGVtLmlzT3BlbigpKSB7XG4gICAxNTVcdCAgICAgICAgICAgICAgICBlbS5jbG9zZSgpO1xuICAgMTU2XHQgICAgICAgICAgICB9XG4gICAxNTdcdCAgICAgICAgfVxuICAgMTU4XHQgICAgfVxuICAgMTU5XHQgICAgLy8gVMOsbSBjw6FjIGtodXnhur9uIG3Do2kgxJFhbmcgw6FwIGThu6VuZ1xuICAgMTYwXHQgICAgcHVibGljIExpc3Q8S2h1eWVuTWFpPiBmaW5kT25nb2luZ1Byb21vdGlvbnMoKSB7XG4gICAxNjFcdCAgICAgICAgU3RyaW5nIHF1ZXJ5ID0gXCJzZWxlY3Qga20gZnJvbSBLaHV5ZW5NYWkga20gXCIgK1xuICAgMTYyXHQgICAgICAgICAgICAgICAgXCJ3aGVyZSBrbS50cmFuZ1RoYWkgPSA6dHJhbmdUaGFpIFwiICtcblxuUmV2aWV3IHRoZSBjaGFuZ2VzIGFuZCBtYWtlIHN1cmUgdGhleSBhcmUgYXMgZXhwZWN0ZWQgKGNvcnJlY3QgaW5kZW50YXRpb24sIG5vIGR1cGxpY2F0ZSBsaW5lcywgZXRjKS5cbkVkaXQgdGhlIGZpbGUgYWdhaW4gaWYgbmVjZXNzYXJ5LlxuIiwiaXNfZXJyb3IiOmZhbHNlLCJyZXF1ZXN0X2lkIjoiIiwidG9vbF91c2VfaWQiOiJ0b29sdV8wMVBZWU1DM2laeUZzVWRnamppN2pMRW8ifX0seyJpZCI6MiwidHlwZSI6NCwiaWRlX3N0YXRlX25vZGUiOnsid29ya3NwYWNlRm9sZGVycyI6W3sicmVwb3NpdG9yeVJvb3QiOiJFOi9MVFBUSkFWQS9OaG9tL1BoYW5UYW5KYXZhTmhvbUdQVC9Qcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyIsImZvbGRlclJvb3QiOiJFOi9MVFBUSkFWQS9OaG9tL1BoYW5UYW5KYXZhTmhvbUdQVC9Qcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyJ9XSwid29ya3NwYWNlRm9sZGVyc1VuY2hhbmdlZCI6ZmFsc2V9fV0sInJlc3BvbnNlX3RleHQiOiIiLCJ3b3Jrc3BhY2VfZmlsZV9jaHVua3MiOltdfSx7InN0YXR1cyI6InN1Y2Nlc3MiLCJyZXF1ZXN0X2lkIjoiMjM1OWUxZTctNWQwOS00OWRjLWI3OWEtMDdiMmMzMzM1Y2U0IiwicmVxdWVzdF9tZXNzYWdlIjoiIiwic3RydWN0dXJlZF9vdXRwdXRfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjo1LCJjb250ZW50IjoiIiwidG9vbF91c2UiOnsidG9vbF91c2VfaWQiOiJ0b29sdV8wMUVrdkpIcUVwbnlYalE5V1BSQkY4MmYiLCJ0b29sX25hbWUiOiJzdHItcmVwbGFjZS1lZGl0b3IiLCJpbnB1dF9qc29uIjoie1wiY29tbWFuZFwiOiBcInN0cl9yZXBsYWNlXCIsIFwicGF0aFwiOiBcInNyYy9tYWluL2phdmEvbW9kZWwvRG9pVHVvbmdBcER1bmcuamF2YVwiLCBcInN0cl9yZXBsYWNlX2VudHJpZXNcIjogW3tcIm9sZF9zdHJcIjogXCJwYWNrYWdlIG1vZGVsO1xcblxcbnB1YmxpYyBlbnVtIERvaVR1b25nQXBEdW5nIHtcXG59XCIsIFwibmV3X3N0clwiOiBcInBhY2thZ2UgbW9kZWw7XFxuXFxucHVibGljIGVudW0gRG9pVHVvbmdBcER1bmcge1xcbiAgICBUQVRfQ0EoXFxcIlRcXHUxZWE1dCBjXFx1MWVhM1xcXCIpLFxcbiAgICBLSEFDSF9IQU5HX1RIVU9ORyhcXFwiS2hcXHUwMGUxY2ggaFxcdTAwZTBuZyB0aFxcdTAxYjBcXHUxZWRkbmdcXFwiKSxcXG4gICAgS0hBQ0hfSEFOR19WSVAoXFxcIktoXFx1MDBlMWNoIGhcXHUwMGUwbmcgVklQXFxcIiksXFxuICAgIEtIQUNIX0hBTkdfVEhBTl9USElFVChcXFwiS2hcXHUwMGUxY2ggaFxcdTAwZTBuZyB0aFxcdTAwZTJuIHRoaVxcdTFlYmZ0XFxcIik7XFxuICAgIFxcbiAgICBwcml2YXRlIGZpbmFsIFN0cmluZyB2YWx1ZTtcXG5cXG4gICAgRG9pVHVvbmdBcER1bmcoU3RyaW5nIHZhbHVlKSB7XFxuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XFxuICAgIH1cXG5cXG4gICAgcHVibGljIFN0cmluZyBnZXRWYWx1ZSgpIHtcXG4gICAgICAgIHJldHVybiB2YWx1ZTtcXG4gICAgfVxcblxcbiAgICBwdWJsaWMgc3RhdGljIERvaVR1b25nQXBEdW5nIGZyb21WYWx1ZShTdHJpbmcgdmFsdWUpIHtcXG4gICAgICAgIGZvciAoRG9pVHVvbmdBcER1bmcgZG9pVHVvbmcgOiBEb2lUdW9uZ0FwRHVuZy52YWx1ZXMoKSkge1xcbiAgICAgICAgICAgIGlmIChkb2lUdW9uZy52YWx1ZS5lcXVhbHModmFsdWUpKSB7XFxuICAgICAgICAgICAgICAgIHJldHVybiBkb2lUdW9uZztcXG4gICAgICAgICAgICB9XFxuICAgICAgICB9XFxuICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKFxcXCJObyBlbnVtIGNvbnN0YW50IGZvciB2YWx1ZTogXFxcIiArIHZhbHVlKTtcXG4gICAgfVxcbn1cIiwgXCJvbGRfc3RyX3N0YXJ0X2xpbmVfbnVtYmVyXCI6IDEsIFwib2xkX3N0cl9lbmRfbGluZV9udW1iZXJcIjogM31dfSJ9fSx7ImlkIjowLCJ0eXBlIjowLCJjb250ZW50IjoiMy4gTm93LCBsZXQncyB1cGRhdGUgdGhlIERvaVR1b25nQXBEdW5nIGVudW06XG4ifSx7ImlkIjoyLCJ0eXBlIjoyLCJjb250ZW50IjoiIn0seyJpZCI6MywidHlwZSI6MywiY29udGVudCI6IiJ9XSwic2Vlbl9zdGF0ZSI6InNlZW4iLCJzdHJ1Y3R1cmVkX3JlcXVlc3Rfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjoxLCJ0b29sX3Jlc3VsdF9ub2RlIjp7ImNvbnRlbnQiOiJTdWNjZXNzZnVsbHkgZWRpdGVkIHRoZSBmaWxlIHNyYy9tYWluL2phdmEvZGFvL2ltcGwvS2h1eWVuTWFpREFPSW1wbC5qYXZhLlxuUmVzdWx0IGZvciBzdHJfcmVwbGFjZV9lbnRyaWVzWzBdOlxuUmVwbGFjZW1lbnQgc3VjY2Vzc2Z1bC5cbkVkaXRlZCBzZWN0aW9uIGFmdGVyIElERSBhdXRvLWZvcm1hdHRpbmcgd2FzIGFwcGxpZWQ6XG4gICAxNTVcdCAgICAgICAgICAgICAgICBlbS5jbG9zZSgpO1xuICAgMTU2XHQgICAgICAgICAgICB9XG4gICAxNTdcdCAgICAgICAgfVxuICAgMTU4XHQgICAgfVxuICAgMTU5XHQgICAgLy8gVMOsbSBjw6FjIGtodXnhur9uIG3Do2kgxJFhbmcgw6FwIGThu6VuZ1xuICAgMTYwXHQgICAgQE92ZXJyaWRlXG4gICAxNjFcdCAgICBwdWJsaWMgTGlzdDxLaHV5ZW5NYWk+IGZpbmRPbmdvaW5nUHJvbW90aW9ucygpIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xuICAgMTYyXHQgICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcbiAgIDE2M1x0ICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0eCA9IGVtLmdldFRyYW5zYWN0aW9uKCk7XG4gICAxNjRcdCAgICAgICAgTGlzdDxLaHV5ZW5NYWk+IHJlc3VsdCA9IG5ldyBBcnJheUxpc3Q8PigpO1xuICAgMTY1XHRcbiAgIDE2Nlx0ICAgICAgICB0cnkge1xuICAgMTY3XHQgICAgICAgICAgICB0eC5iZWdpbigpO1xuICAgMTY4XHQgICAgICAgICAgICBTdHJpbmcgcXVlcnkgPSBcInNlbGVjdCBrbSBmcm9tIEtodXllbk1haSBrbSBcIiArXG4gICAxNjlcdCAgICAgICAgICAgICAgICAgICAgXCJ3aGVyZSBrbS50cmFuZ1RoYWkgPSA6dHJhbmdUaGFpIFwiICtcbiAgIDE3MFx0ICAgICAgICAgICAgICAgICAgICBcImFuZCBrbS50aG9pR2lhbkJhdERhdSA8PSA6dG9kYXkgXCIgK1xuICAgMTcxXHQgICAgICAgICAgICAgICAgICAgIFwiYW5kIGttLnRob2lHaWFuS2V0VGh1YyA+PSA6dG9kYXlcIjtcbiAgIDE3Mlx0XG4gICAxNzNcdCAgICAgICAgICAgIHJlc3VsdCA9IGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5LCBLaHV5ZW5NYWkuY2xhc3MpXG4gICAxNzRcdCAgICAgICAgICAgICAgICAgICAgLnNldFBhcmFtZXRlcihcInRyYW5nVGhhaVwiLCBcIsSQYW5nIGRp4buFbiByYVwiKVxuICAgMTc1XHQgICAgICAgICAgICAgICAgICAgIC5zZXRQYXJhbWV0ZXIoXCJ0b2RheVwiLCBMb2NhbERhdGUubm93KCkpXG4gICAxNzZcdCAgICAgICAgICAgICAgICAgICAgLmdldFJlc3VsdExpc3QoKTtcbiAgIDE3N1x0ICAgICAgICAgICAgdHguY29tbWl0KCk7XG4gICAxNzhcdCAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgIDE3OVx0ICAgICAgICAgICAgaWYgKHR4LmlzQWN0aXZlKCkpIHtcbiAgIDE4MFx0ICAgICAgICAgICAgICAgIHR4LnJvbGxiYWNrKCk7XG4gICAxODFcdCAgICAgICAgICAgIH1cbiAgIDE4Mlx0ICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgIDE4M1x0ICAgICAgICAgICAgdGhyb3cgbmV3IFJlbW90ZUV4Y2VwdGlvbihcIkzhu5dpIGtoaSB0w6xtIGtodXnhur9uIG3Do2kgxJFhbmcgw6FwIGThu6VuZ1wiLCBlKTtcbiAgIDE4NFx0ICAgICAgICB9IGZpbmFsbHkge1xuICAgMTg1XHQgICAgICAgICAgICBpZiAoZW0gIT0gbnVsbCAmJiBlbS5pc09wZW4oKSkge1xuICAgMTg2XHQgICAgICAgICAgICAgICAgZW0uY2xvc2UoKTtcbiAgIDE4N1x0ICAgICAgICAgICAgfVxuICAgMTg4XHQgICAgICAgIH1cbiAgIDE4OVx0ICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgMTkwXHQgICAgfVxuICAgMTkxXHRcbiAgIDE5Mlx0ICAgIEBPdmVycmlkZVxuICAgMTkzXHQgICAgcHVibGljIGJvb2xlYW4gdGVzdENvbm5lY3Rpb24oKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uIHtcbiAgIDE5NFx0ICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gSlBBVXRpbC5nZXRFbnRpdHlNYW5hZ2VyKCk7XG4gICAxOTVcdCAgICAgICAgdHJ5IHtcbiAgIDE5Nlx0ICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpO1xuICAgMTk3XHQgICAgICAgICAgICBlbS5jcmVhdGVRdWVyeShcIlNFTEVDVCAxXCIpLmdldFJlc3VsdExpc3QoKTtcbiAgIDE5OFx0ICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTtcbiAgIDE5OVx0ICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAyMDBcdCAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgIDIwMVx0ICAgICAgICAgICAgaWYgKGVtLmdldFRyYW5zYWN0aW9uKCkuaXNBY3RpdmUoKSkge1xuICAgMjAyXHQgICAgICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5yb2xsYmFjaygpO1xuICAgMjAzXHQgICAgICAgICAgICB9XG4gICAyMDRcdCAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAyMDVcdCAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgIDIwNlx0ICAgICAgICB9IGZpbmFsbHkge1xuICAgMjA3XHQgICAgICAgICAgICBpZiAoZW0gIT0gbnVsbCAmJiBlbS5pc09wZW4oKSkge1xuICAgMjA4XHQgICAgICAgICAgICAgICAgZW0uY2xvc2UoKTtcbiAgIDIwOVx0ICAgICAgICAgICAgfVxuICAgMjEwXHQgICAgICAgIH1cbiAgIDIxMVx0ICAgIH1cbiAgIDIxMlx0XG4gICAyMTNcdH1cbiAgIDIxNFx0XG5cblJldmlldyB0aGUgY2hhbmdlcyBhbmQgbWFrZSBzdXJlIHRoZXkgYXJlIGFzIGV4cGVjdGVkIChjb3JyZWN0IGluZGVudGF0aW9uLCBubyBkdXBsaWNhdGUgbGluZXMsIGV0YykuXG5FZGl0IHRoZSBmaWxlIGFnYWluIGlmIG5lY2Vzc2FyeS5cbiIsImlzX2Vycm9yIjpmYWxzZSwicmVxdWVzdF9pZCI6IiIsInRvb2xfdXNlX2lkIjoidG9vbHVfMDFGQTVXRmU1aUVxMVhDNUU0Z2dyVU5GIn19LHsiaWQiOjIsInR5cGUiOjQsImlkZV9zdGF0ZV9ub2RlIjp7IndvcmtzcGFjZUZvbGRlcnMiOlt7InJlcG9zaXRvcnlSb290IjoiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmciLCJmb2xkZXJSb290IjoiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcifV0sIndvcmtzcGFjZUZvbGRlcnNVbmNoYW5nZWQiOmZhbHNlfX1dLCJyZXNwb25zZV90ZXh0IjoiMy4gTm93LCBsZXQncyB1cGRhdGUgdGhlIERvaVR1b25nQXBEdW5nIGVudW06XG4iLCJ3b3Jrc3BhY2VfZmlsZV9jaHVua3MiOltdfSx7InN0YXR1cyI6InN1Y2Nlc3MiLCJyZXF1ZXN0X2lkIjoiMzNhMTAwNzYtYzRlOC00NzBkLWFmM2EtM2M4Y2I0ZDI5NTAyIiwicmVxdWVzdF9tZXNzYWdlIjoiIiwic3RydWN0dXJlZF9vdXRwdXRfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjo1LCJjb250ZW50IjoiIiwidG9vbF91c2UiOnsidG9vbF91c2VfaWQiOiJ0b29sdV8wMUZybzFiZnZaaUpHVFJ1VWE2RWF3U1QiLCJ0b29sX25hbWUiOiJzdHItcmVwbGFjZS1lZGl0b3IiLCJpbnB1dF9qc29uIjoie1wiY29tbWFuZFwiOiBcInZpZXdcIiwgXCJwYXRoXCI6IFwic3JjL21haW4vamF2YS9tb2RlbC9Eb2lUdW9uZ0FwRHVuZy5qYXZhXCJ9In19LHsiaWQiOjAsInR5cGUiOjAsImNvbnRlbnQiOiJMZXQncyB2aWV3IHRoZSBjdXJyZW50IERvaVR1b25nQXBEdW5nIGVudW0gYW5kIHRoZW4gdXBkYXRlIGl0OlxuIn0seyJpZCI6MiwidHlwZSI6MiwiY29udGVudCI6IiJ9LHsiaWQiOjMsInR5cGUiOjMsImNvbnRlbnQiOiIifV0sInNlZW5fc3RhdGUiOiJzZWVuIiwic3RydWN0dXJlZF9yZXF1ZXN0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6MSwidG9vbF9yZXN1bHRfbm9kZSI6eyJjb250ZW50IjoiRmFpbGVkIHRvIGVkaXQgdGhlIGZpbGUgc3JjL21haW4vamF2YS9tb2RlbC9Eb2lUdW9uZ0FwRHVuZy5qYXZhLiBTZWUgYmVsb3cgZm9yIGRldGFpbHMuXG5SZXN1bHQgZm9yIHN0cl9yZXBsYWNlX2VudHJpZXNbMF06XG5ObyByZXBsYWNlbWVudCB3YXMgcGVyZm9ybWVkLCBvbGRTdHIgZGlkIG5vdCBhcHBlYXIgdmVyYmF0aW0gaW4gc3JjL21haW4vamF2YS9tb2RlbC9Eb2lUdW9uZ0FwRHVuZy5qYXZhLlxuVGhlIGNvbnRlbnQgaW4gdGhlIHNwZWNpZmllZCByZWdpb24gaXM6XG4gICAgIDFcdHBhY2thZ2UgbW9kZWw7XG4gICAgIDJcdFxuICAgICAzXHRwdWJsaWMgZW51bSBEb2lUdW9uZ0FwRHVuZyB7XG4gICAgIDRcdCAgICBBTEwoXCJU4bqldCBj4bqjXCIpLFxuICAgICA1XHQgICAgQ09VUE9OKFwiY291cG9uXCIpO1xuICAgICA2XHRcbiAgICAgN1x0ICAgIHByaXZhdGUgZmluYWwgU3RyaW5nIHZhbHVlO1xuXG5EaWZmIGJldHdlZW4gb2xkU3RyIGFuZCB0aGUgc3BlY2lmaWVkIHJlZ2lvbiBpczpcbj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi0tLSBvbGRTdHJcbisrKyByZWdpb25Db250ZW50XG5AQCAtMSw0ICsxLDMgQEBcbiBwYWNrYWdlIG1vZGVsO1xuIFxuIHB1YmxpYyBlbnVtIERvaVR1b25nQXBEdW5nIHtcbi19XG5cblxuRml4IGZhaWxlZCBzdHJfcmVwbGFjZV9lbnRyaWVzIGFjY29yZGluZ2x5IGFuZCB0cnkgYWdhaW4uXG4iLCJpc19lcnJvciI6dHJ1ZSwicmVxdWVzdF9pZCI6IiIsInRvb2xfdXNlX2lkIjoidG9vbHVfMDFFa3ZKSHFFcG55WGpROVdQUkJGODJmIn19LHsiaWQiOjIsInR5cGUiOjQsImlkZV9zdGF0ZV9ub2RlIjp7IndvcmtzcGFjZUZvbGRlcnMiOlt7InJlcG9zaXRvcnlSb290IjoiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmciLCJmb2xkZXJSb290IjoiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcifV0sIndvcmtzcGFjZUZvbGRlcnNVbmNoYW5nZWQiOmZhbHNlfX1dLCJyZXNwb25zZV90ZXh0IjoiTGV0J3MgdmlldyB0aGUgY3VycmVudCBEb2lUdW9uZ0FwRHVuZyBlbnVtIGFuZCB0aGVuIHVwZGF0ZSBpdDpcbiIsIndvcmtzcGFjZV9maWxlX2NodW5rcyI6W119LHsic3RhdHVzIjoic3VjY2VzcyIsInJlcXVlc3RfaWQiOiJhODljOWE2Ny1mMzdmLTRmODEtOTRhOS1hOGYyYWJiYjY2NDAiLCJyZXF1ZXN0X21lc3NhZ2UiOiIiLCJzdHJ1Y3R1cmVkX291dHB1dF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjUsImNvbnRlbnQiOiIiLCJ0b29sX3VzZSI6eyJ0b29sX3VzZV9pZCI6InRvb2x1XzAxNUZydUJ2cDZRVnB4VG5xQWY5MTZNUCIsInRvb2xfbmFtZSI6InN0ci1yZXBsYWNlLWVkaXRvciIsImlucHV0X2pzb24iOiJ7XCJjb21tYW5kXCI6IFwic3RyX3JlcGxhY2VcIiwgXCJwYXRoXCI6IFwic3JjL21haW4vamF2YS9tb2RlbC9Eb2lUdW9uZ0FwRHVuZy5qYXZhXCIsIFwic3RyX3JlcGxhY2VfZW50cmllc1wiOiBbe1wib2xkX3N0clwiOiBcInB1YmxpYyBlbnVtIERvaVR1b25nQXBEdW5nIHtcXG4gICAgQUxMKFxcXCJUXFx1MWVhNXQgY1xcdTFlYTNcXFwiKSxcXG4gICAgQ09VUE9OKFxcXCJjb3Vwb25cXFwiKTtcXG5cXG4gICAgcHJpdmF0ZSBmaW5hbCBTdHJpbmcgdmFsdWU7XFxuXFxuICAgIERvaVR1b25nQXBEdW5nKFN0cmluZyB2YWx1ZSkge1xcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xcbiAgICB9XFxuXFxuICAgIHB1YmxpYyBTdHJpbmcgZ2V0VmFsdWUoKSB7XFxuICAgICAgICByZXR1cm4gdmFsdWU7XFxuICAgIH1cXG59XCIsIFwibmV3X3N0clwiOiBcInB1YmxpYyBlbnVtIERvaVR1b25nQXBEdW5nIHtcXG4gICAgQUxMKFxcXCJUXFx1MWVhNXQgY1xcdTFlYTNcXFwiKSxcXG4gICAgS0hBQ0hfSEFOR19USFVPTkcoXFxcIktoXFx1MDBlMWNoIGhcXHUwMGUwbmcgdGhcXHUwMWIwXFx1MWVkZG5nXFxcIiksXFxuICAgIEtIQUNIX0hBTkdfVklQKFxcXCJLaFxcdTAwZTFjaCBoXFx1MDBlMG5nIFZJUFxcXCIpLFxcbiAgICBLSEFDSF9IQU5HX1RIQU5fVEhJRVQoXFxcIktoXFx1MDBlMWNoIGhcXHUwMGUwbmcgdGhcXHUwMGUybiB0aGlcXHUxZWJmdFxcXCIpLFxcbiAgICBDT1VQT04oXFxcIkNvdXBvblxcXCIpO1xcblxcbiAgICBwcml2YXRlIGZpbmFsIFN0cmluZyB2YWx1ZTtcXG5cXG4gICAgRG9pVHVvbmdBcER1bmcoU3RyaW5nIHZhbHVlKSB7XFxuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XFxuICAgIH1cXG5cXG4gICAgcHVibGljIFN0cmluZyBnZXRWYWx1ZSgpIHtcXG4gICAgICAgIHJldHVybiB2YWx1ZTtcXG4gICAgfVxcbiAgICBcXG4gICAgcHVibGljIHN0YXRpYyBEb2lUdW9uZ0FwRHVuZyBmcm9tVmFsdWUoU3RyaW5nIHZhbHVlKSB7XFxuICAgICAgICBmb3IgKERvaVR1b25nQXBEdW5nIGRvaVR1b25nIDogRG9pVHVvbmdBcER1bmcudmFsdWVzKCkpIHtcXG4gICAgICAgICAgICBpZiAoZG9pVHVvbmcudmFsdWUuZXF1YWxzKHZhbHVlKSkge1xcbiAgICAgICAgICAgICAgICByZXR1cm4gZG9pVHVvbmc7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgfVxcbiAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbihcXFwiTm8gZW51bSBjb25zdGFudCBmb3IgdmFsdWU6IFxcXCIgKyB2YWx1ZSk7XFxuICAgIH1cXG59XCIsIFwib2xkX3N0cl9zdGFydF9saW5lX251bWJlclwiOiAzLCBcIm9sZF9zdHJfZW5kX2xpbmVfbnVtYmVyXCI6IDE2fV19In19LHsiaWQiOjAsInR5cGUiOjAsImNvbnRlbnQiOiIifSx7ImlkIjoyLCJ0eXBlIjoyLCJjb250ZW50IjoiIn0seyJpZCI6MywidHlwZSI6MywiY29udGVudCI6IiJ9XSwic2Vlbl9zdGF0ZSI6InNlZW4iLCJzdHJ1Y3R1cmVkX3JlcXVlc3Rfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjoxLCJ0b29sX3Jlc3VsdF9ub2RlIjp7ImNvbnRlbnQiOiJIZXJlJ3MgdGhlIHJlc3VsdCBvZiBydW5uaW5nIGBjYXQgLW5gIG9uIHNyYy9tYWluL2phdmEvbW9kZWwvRG9pVHVvbmdBcER1bmcuamF2YTpcbiAgICAgMVx0cGFja2FnZSBtb2RlbDtcbiAgICAgMlx0XG4gICAgIDNcdHB1YmxpYyBlbnVtIERvaVR1b25nQXBEdW5nIHtcbiAgICAgNFx0ICAgIEFMTChcIlThuqV0IGPhuqNcIiksXG4gICAgIDVcdCAgICBDT1VQT04oXCJjb3Vwb25cIik7XG4gICAgIDZcdFxuICAgICA3XHQgICAgcHJpdmF0ZSBmaW5hbCBTdHJpbmcgdmFsdWU7XG4gICAgIDhcdFxuICAgICA5XHQgICAgRG9pVHVvbmdBcER1bmcoU3RyaW5nIHZhbHVlKSB7XG4gICAgMTBcdCAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgIDExXHQgICAgfVxuICAgIDEyXHRcbiAgICAxM1x0ICAgIHB1YmxpYyBTdHJpbmcgZ2V0VmFsdWUoKSB7XG4gICAgMTRcdCAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIDE1XHQgICAgfVxuICAgIDE2XHR9XG4gICAgMTdcdFxuVG90YWwgbGluZXMgaW4gZmlsZTogMTdcbiIsImlzX2Vycm9yIjpmYWxzZSwicmVxdWVzdF9pZCI6IiIsInRvb2xfdXNlX2lkIjoidG9vbHVfMDFGcm8xYmZ2WmlKR1RSdVVhNkVhd1NUIn19LHsiaWQiOjIsInR5cGUiOjQsImlkZV9zdGF0ZV9ub2RlIjp7IndvcmtzcGFjZUZvbGRlcnMiOlt7InJlcG9zaXRvcnlSb290IjoiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmciLCJmb2xkZXJSb290IjoiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcifV0sIndvcmtzcGFjZUZvbGRlcnNVbmNoYW5nZWQiOmZhbHNlfX1dLCJyZXNwb25zZV90ZXh0IjoiIiwid29ya3NwYWNlX2ZpbGVfY2h1bmtzIjpbXX0seyJzdGF0dXMiOiJzdWNjZXNzIiwicmVxdWVzdF9pZCI6IjdiODcyMDgyLTQ1NDAtNGUwMC05OGZhLTRmZGNmNTBhYjM3ZCIsInJlcXVlc3RfbWVzc2FnZSI6IiIsInN0cnVjdHVyZWRfb3V0cHV0X25vZGVzIjpbeyJpZCI6MCwidHlwZSI6MCwiY29udGVudCI6IjQuIE5vdywgbGV0J3MgY3JlYXRlIHRoZSBLaHV5ZW5NYWlQYW5lbCBjbGFzczpcbiJ9LHsiaWQiOjIsInR5cGUiOjIsImNvbnRlbnQiOiIifSx7ImlkIjozLCJ0eXBlIjozLCJjb250ZW50IjoiIn1dLCJzZWVuX3N0YXRlIjoic2VlbiIsInN0cnVjdHVyZWRfcmVxdWVzdF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjEsInRvb2xfcmVzdWx0X25vZGUiOnsiY29udGVudCI6IlN1Y2Nlc3NmdWxseSBlZGl0ZWQgdGhlIGZpbGUgc3JjL21haW4vamF2YS9tb2RlbC9Eb2lUdW9uZ0FwRHVuZy5qYXZhLlxuUmVzdWx0IGZvciBzdHJfcmVwbGFjZV9lbnRyaWVzWzBdOlxuUmVwbGFjZW1lbnQgc3VjY2Vzc2Z1bC5cbkVkaXRlZCBzZWN0aW9uIGFmdGVyIElERSBhdXRvLWZvcm1hdHRpbmcgd2FzIGFwcGxpZWQ6XG4gICAgIDFcdHBhY2thZ2UgbW9kZWw7XG4gICAgIDJcdFxuICAgICAzXHRwdWJsaWMgZW51bSBEb2lUdW9uZ0FwRHVuZyB7XG4gICAgIDRcdCAgICBBTEwoXCJU4bqldCBj4bqjXCIpLFxuICAgICA1XHQgICAgS0hBQ0hfSEFOR19USFVPTkcoXCJLaMOhY2ggaMOgbmcgdGjGsOG7nW5nXCIpLFxuICAgICA2XHQgICAgS0hBQ0hfSEFOR19WSVAoXCJLaMOhY2ggaMOgbmcgVklQXCIpLFxuICAgICA3XHQgICAgS0hBQ0hfSEFOR19USEFOX1RISUVUKFwiS2jDoWNoIGjDoG5nIHRow6JuIHRoaeG6v3RcIiksXG4gICAgIDhcdCAgICBDT1VQT04oXCJDb3Vwb25cIik7XG4gICAgIDlcdFxuICAgIDEwXHQgICAgcHJpdmF0ZSBmaW5hbCBTdHJpbmcgdmFsdWU7XG4gICAgMTFcdFxuICAgIDEyXHQgICAgRG9pVHVvbmdBcER1bmcoU3RyaW5nIHZhbHVlKSB7XG4gICAgMTNcdCAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgIDE0XHQgICAgfVxuICAgIDE1XHRcbiAgICAxNlx0ICAgIHB1YmxpYyBTdHJpbmcgZ2V0VmFsdWUoKSB7XG4gICAgMTdcdCAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIDE4XHQgICAgfVxuICAgIDE5XHRcbiAgICAyMFx0ICAgIHB1YmxpYyBzdGF0aWMgRG9pVHVvbmdBcER1bmcgZnJvbVZhbHVlKFN0cmluZyB2YWx1ZSkge1xuICAgIDIxXHQgICAgICAgIGZvciAoRG9pVHVvbmdBcER1bmcgZG9pVHVvbmcgOiBEb2lUdW9uZ0FwRHVuZy52YWx1ZXMoKSkge1xuICAgIDIyXHQgICAgICAgICAgICBpZiAoZG9pVHVvbmcudmFsdWUuZXF1YWxzKHZhbHVlKSkge1xuICAgIDIzXHQgICAgICAgICAgICAgICAgcmV0dXJuIGRvaVR1b25nO1xuICAgIDI0XHQgICAgICAgICAgICB9XG4gICAgMjVcdCAgICAgICAgfVxuICAgIDI2XHQgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oXCJObyBlbnVtIGNvbnN0YW50IGZvciB2YWx1ZTogXCIgKyB2YWx1ZSk7XG4gICAgMjdcdCAgICB9XG4gICAgMjhcdH1cbiAgICAyOVx0XG5cblJldmlldyB0aGUgY2hhbmdlcyBhbmQgbWFrZSBzdXJlIHRoZXkgYXJlIGFzIGV4cGVjdGVkIChjb3JyZWN0IGluZGVudGF0aW9uLCBubyBkdXBsaWNhdGUgbGluZXMsIGV0YykuXG5FZGl0IHRoZSBmaWxlIGFnYWluIGlmIG5lY2Vzc2FyeS5cbiIsImlzX2Vycm9yIjpmYWxzZSwicmVxdWVzdF9pZCI6IiIsInRvb2xfdXNlX2lkIjoidG9vbHVfMDE1RnJ1QnZwNlFWcHhUbnFBZjkxNk1QIn19LHsiaWQiOjIsInR5cGUiOjQsImlkZV9zdGF0ZV9ub2RlIjp7IndvcmtzcGFjZUZvbGRlcnMiOlt7InJlcG9zaXRvcnlSb290IjoiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmciLCJmb2xkZXJSb290IjoiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcifV0sIndvcmtzcGFjZUZvbGRlcnNVbmNoYW5nZWQiOmZhbHNlfX1dLCJyZXNwb25zZV90ZXh0IjoiNC4gTm93LCBsZXQncyBjcmVhdGUgdGhlIEtodXllbk1haVBhbmVsIGNsYXNzOlxuXG5JJ20gc29ycnkuIEkgdHJpZWQgdG8gY2FsbCBhIHRvb2wsIGJ1dCBwcm92aWRlZCB0b28gbGFyZ2Ugb2YgYW4gaW5wdXQuIEhvdyB3b3VsZCB5b3UgbGlrZSB0byBwcm9jZWVkP1xuIiwid29ya3NwYWNlX2ZpbGVfY2h1bmtzIjpbXX0seyJyZXF1ZXN0X2lkIjoiMTliYmY3MzktMzQ3My00ZTc4LWIzMGMtODcxZTZlMGM2MzRlIiwidXVpZCI6ImNlNzM1MWU4LWEzM2QtNDVjZi1iZDlmLTMwNWMyNmU0MzNlZSIsImNoYXRJdGVtVHlwZSI6ImFnZW50aWMtY2hlY2twb2ludC1kZWxpbWl0ZXIiLCJzdGF0dXMiOiJzdWNjZXNzIiwiZnJvbVRpbWVzdGFtcCI6MTc0NTI1MTAyOTUxMywidG9UaW1lc3RhbXAiOjE3NDUyNTE0Nzc1NjgsInNlZW5fc3RhdGUiOiJzZWVuIn0seyJyZXF1ZXN0X2lkIjoiY2IyNGY0YzYtM2M2Yi00MTViLWE3NDEtNGQ1YmE2NWU1NjQyIiwic3RhdHVzIjoiY2FuY2VsbGVkIiwiY2hhdEl0ZW1UeXBlIjoiYWdlbnRpYy10dXJuLWRlbGltaXRlciJ9LHsic3RhdHVzIjoic3VjY2VzcyIsInJlcXVlc3RfaWQiOiIyY2UyMTdkYy0xZmY3LTRhOTEtYjVkZi00N2Q5OTczMjhiYmEiLCJyZXF1ZXN0X21lc3NhZ2UiOiJvayIsInJpY2hfdGV4dF9qc29uX3JlcHIiOnsidHlwZSI6ImRvYyIsImNvbnRlbnQiOlt7InR5cGUiOiJwYXJhZ3JhcGgiLCJjb250ZW50IjpbeyJ0eXBlIjoidGV4dCIsInRleHQiOiJvayJ9XX1dfSwibWVudGlvbmVkX2l0ZW1zIjpbXSwic3RydWN0dXJlZF9vdXRwdXRfbm9kZXMiOlt7ImlkIjowLCJ0eXBlIjowLCJjb250ZW50IjoiSSdsbCBub3cgY3JlYXRlIHRoZSBLaHV5ZW5NYWlQYW5lbCBjbGFzcyB0aGF0IHdpbGwgYmUgc2ltaWxhciB0byB0aGUgTGljaFRyaW5oVGF1UGFuZWwuIExldCdzIGltcGxlbWVudCBpdDpcbiJ9LHsiaWQiOjIsInR5cGUiOjIsImNvbnRlbnQiOiIifSx7ImlkIjozLCJ0eXBlIjozLCJjb250ZW50IjoiIn1dLCJzZWVuX3N0YXRlIjoic2VlbiIsInN0cnVjdHVyZWRfcmVxdWVzdF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjAsInRleHRfbm9kZSI6eyJjb250ZW50Ijoib2sifX0seyJpZCI6MiwidHlwZSI6NCwiaWRlX3N0YXRlX25vZGUiOnsid29ya3NwYWNlRm9sZGVycyI6W3sicmVwb3NpdG9yeVJvb3QiOiJFOi9MVFBUSkFWQS9OaG9tL1BoYW5UYW5KYXZhTmhvbUdQVC9Qcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyIsImZvbGRlclJvb3QiOiJFOi9MVFBUSkFWQS9OaG9tL1BoYW5UYW5KYXZhTmhvbUdQVC9Qcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyJ9XSwid29ya3NwYWNlRm9sZGVyc1VuY2hhbmdlZCI6ZmFsc2V9fV0sInJlc3BvbnNlX3RleHQiOiJJJ2xsIG5vdyBjcmVhdGUgdGhlIEtodXllbk1haVBhbmVsIGNsYXNzIHRoYXQgd2lsbCBiZSBzaW1pbGFyIHRvIHRoZSBMaWNoVHJpbmhUYXVQYW5lbC4gTGV0J3MgaW1wbGVtZW50IGl0OlxuXG5JJ20gc29ycnkuIEkgdHJpZWQgdG8gY2FsbCBhIHRvb2wsIGJ1dCBwcm92aWRlZCB0b28gbGFyZ2Ugb2YgYW4gaW5wdXQuIEhvdyB3b3VsZCB5b3UgbGlrZSB0byBwcm9jZWVkP1xuIiwid29ya3NwYWNlX2ZpbGVfY2h1bmtzIjpbXX0seyJyZXF1ZXN0X2lkIjoiNjZhZTZjMjUtYWVkYi00OWM2LWFhN2MtYzBiYWViYWM1MDYwIiwic3RhdHVzIjoiY2FuY2VsbGVkIiwiY2hhdEl0ZW1UeXBlIjoiYWdlbnRpYy10dXJuLWRlbGltaXRlciJ9LHsic3RhdHVzIjoic3VjY2VzcyIsInJlcXVlc3RfaWQiOiI2NmE1OTYzMS1iZjdmLTRkY2EtOGUwZC1kOTQ1NTNiOGI3MjQiLCJyZXF1ZXN0X21lc3NhZ2UiOiJ04bqhbyBo4bq/dCBjaG8gdMO0aSBsw6J1IGPFqW5nIMSRxrDhu6NjIiwicmljaF90ZXh0X2pzb25fcmVwciI6eyJ0eXBlIjoiZG9jIiwiY29udGVudCI6W3sidHlwZSI6InBhcmFncmFwaCIsImNvbnRlbnQiOlt7InR5cGUiOiJ0ZXh0IiwidGV4dCI6InThuqFvIGjhur90IGNobyB0w7RpIGzDonUgY8WpbmcgxJHGsOG7o2MifV19XX0sIm1lbnRpb25lZF9pdGVtcyI6W10sInN0cnVjdHVyZWRfb3V0cHV0X25vZGVzIjpbeyJpZCI6MCwidHlwZSI6MCwiY29udGVudCI6IlTDtGkgc+G6vSB04bqhbyDEkeG6p3kgxJHhu6cgdHJhbmcgcXXhuqNuIGzDvSBraHV54bq/biBtw6NpIGNobyBi4bqhbi4gVmnhu4djIG7DoHkgY8OzIHRo4buDIG3huqV0IG3hu5l0IGNow7p0IHRo4budaSBnaWFuLCBuaMawbmcgdMO0aSBz4bq9IHRo4buxYyBoaeG7h24gxJHhuqd5IMSR4bunLlxuXG4jIyBL4bq/IGhv4bqhY2ggdGjhu7FjIGhp4buHblxuXG4xLiBU4bqhbyBLaHV5ZW5NYWlQYW5lbC5qYXZhIC0gZ2lhbyBkaeG7h24gcXXhuqNuIGzDvSBraHV54bq/biBtw6NpXG4yLiBD4bqtcCBuaOG6rXQgUk1JU2VydmVyLmphdmEgxJHhu4MgxJHEg25nIGvDvSBLaHV5ZW5NYWlEQU9cbjMuIEPhuq1wIG5o4bqtdCBNYWluR1VJLmphdmEgxJHhu4MgdGjDqm0gbWVudSBraHV54bq/biBtw6NpXG5cbkLhuq90IMSR4bqndSB0aOG7sWMgaGnhu4duOlxuIn0seyJpZCI6MiwidHlwZSI6MiwiY29udGVudCI6IiJ9LHsiaWQiOjMsInR5cGUiOjMsImNvbnRlbnQiOiIifV0sInNlZW5fc3RhdGUiOiJzZWVuIiwic3RydWN0dXJlZF9yZXF1ZXN0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6MCwidGV4dF9ub2RlIjp7ImNvbnRlbnQiOiJ04bqhbyBo4bq/dCBjaG8gdMO0aSBsw6J1IGPFqW5nIMSRxrDhu6NjIn19LHsiaWQiOjIsInR5cGUiOjQsImlkZV9zdGF0ZV9ub2RlIjp7IndvcmtzcGFjZUZvbGRlcnMiOlt7InJlcG9zaXRvcnlSb290IjoiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmciLCJmb2xkZXJSb290IjoiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcifV0sIndvcmtzcGFjZUZvbGRlcnNVbmNoYW5nZWQiOmZhbHNlfX1dLCJyZXNwb25zZV90ZXh0IjoiVMO0aSBz4bq9IHThuqFvIMSR4bqneSDEkeG7pyB0cmFuZyBxdeG6o24gbMO9IGtodXnhur9uIG3Do2kgY2hvIGLhuqFuLiBWaeG7h2MgbsOgeSBjw7MgdGjhu4MgbeG6pXQgbeG7mXQgY2jDunQgdGjhu51pIGdpYW4sIG5oxrBuZyB0w7RpIHPhur0gdGjhu7FjIGhp4buHbiDEkeG6p3kgxJHhu6cuXG5cbiMjIEvhur8gaG/huqFjaCB0aOG7sWMgaGnhu4duXG5cbjEuIFThuqFvIEtodXllbk1haVBhbmVsLmphdmEgLSBnaWFvIGRp4buHbiBxdeG6o24gbMO9IGtodXnhur9uIG3Do2lcbjIuIEPhuq1wIG5o4bqtdCBSTUlTZXJ2ZXIuamF2YSDEkeG7gyDEkcSDbmcga8O9IEtodXllbk1haURBT1xuMy4gQ+G6rXAgbmjhuq10IE1haW5HVUkuamF2YSDEkeG7gyB0aMOqbSBtZW51IGtodXnhur9uIG3Do2lcblxuQuG6r3QgxJHhuqd1IHRo4buxYyBoaeG7h246XG5cbkknbSBzb3JyeS4gSSB0cmllZCB0byBjYWxsIGEgdG9vbCwgYnV0IHByb3ZpZGVkIHRvbyBsYXJnZSBvZiBhbiBpbnB1dC4gSG93IHdvdWxkIHlvdSBsaWtlIHRvIHByb2NlZWQ/XG4iLCJ3b3Jrc3BhY2VfZmlsZV9jaHVua3MiOltdfSx7InJlcXVlc3RfaWQiOiJhMThhMjc2My1mYTY2LTQ0OTctOTIxZS1hY2U5YzExM2NiNDYiLCJzdGF0dXMiOiJjYW5jZWxsZWQiLCJjaGF0SXRlbVR5cGUiOiJhZ2VudGljLXR1cm4tZGVsaW1pdGVyIn0seyJzdGF0dXMiOiJzdWNjZXNzIiwicmVxdWVzdF9pZCI6IjUzZTU1YTgxLThkMjQtNGJhNi04MzRkLWRhMjNjZjkyMTM5MSIsInJlcXVlc3RfbWVzc2FnZSI6IlThuqFvIEtodXllbk1haVBhbmVsLmphdmEiLCJyaWNoX3RleHRfanNvbl9yZXByIjp7InR5cGUiOiJkb2MiLCJjb250ZW50IjpbeyJ0eXBlIjoicGFyYWdyYXBoIiwiY29udGVudCI6W3sidHlwZSI6InRleHQiLCJ0ZXh0IjoiVOG6oW8gS2h1eWVuTWFpUGFuZWwuamF2YSJ9XX1dfSwibWVudGlvbmVkX2l0ZW1zIjpbXSwic3RydWN0dXJlZF9vdXRwdXRfbm9kZXMiOlt7ImlkIjowLCJ0eXBlIjowLCJjb250ZW50IjoiVMO0aSBz4bq9IHThuqFvIGZpbGUgS2h1eWVuTWFpUGFuZWwuamF2YSBjaG8gYuG6oW4uIMSQw6J5IHPhur0gbMOgIG3hu5l0IHBhbmVsIHF14bqjbiBsw70ga2h1eeG6v24gbcOjaSB0xrDGoW5nIHThu7EgbmjGsCBMaWNoVHJpbmhUYXVQYW5lbDpcbiJ9LHsiaWQiOjIsInR5cGUiOjIsImNvbnRlbnQiOiIifSx7ImlkIjozLCJ0eXBlIjozLCJjb250ZW50IjoiIn1dLCJzZWVuX3N0YXRlIjoic2VlbiIsInN0cnVjdHVyZWRfcmVxdWVzdF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjAsInRleHRfbm9kZSI6eyJjb250ZW50IjoiVOG6oW8gS2h1eWVuTWFpUGFuZWwuamF2YSJ9fSx7ImlkIjoyLCJ0eXBlIjo0LCJpZGVfc3RhdGVfbm9kZSI6eyJ3b3Jrc3BhY2VGb2xkZXJzIjpbeyJyZXBvc2l0b3J5Um9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIiwiZm9sZGVyUm9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIn1dLCJ3b3Jrc3BhY2VGb2xkZXJzVW5jaGFuZ2VkIjpmYWxzZX19XSwicmVzcG9uc2VfdGV4dCI6IlTDtGkgc+G6vSB04bqhbyBmaWxlIEtodXllbk1haVBhbmVsLmphdmEgY2hvIGLhuqFuLiDEkMOieSBz4bq9IGzDoCBt4buZdCBwYW5lbCBxdeG6o24gbMO9IGtodXnhur9uIG3Do2kgdMawxqFuZyB04buxIG5oxrAgTGljaFRyaW5oVGF1UGFuZWw6XG5cbkknbSBzb3JyeS4gSSB0cmllZCB0byBjYWxsIGEgdG9vbCwgYnV0IHByb3ZpZGVkIHRvbyBsYXJnZSBvZiBhbiBpbnB1dC4gSG93IHdvdWxkIHlvdSBsaWtlIHRvIHByb2NlZWQ/XG4iLCJ3b3Jrc3BhY2VfZmlsZV9jaHVua3MiOltdfSx7InJlcXVlc3RfaWQiOiJlZjZlZjQzZC1jOTM4LTQ1NDktYTQ1NC04OTkzNmU4NDZhNDciLCJzdGF0dXMiOiJjYW5jZWxsZWQiLCJjaGF0SXRlbVR5cGUiOiJhZ2VudGljLXR1cm4tZGVsaW1pdGVyIn0seyJzdGF0dXMiOiJzdWNjZXNzIiwicmVxdWVzdF9pZCI6IjhhOTkxZjhkLTQ0ZWMtNDRkMS04NmZjLTkzYmM5ODRlM2UwYyIsInJlcXVlc3RfbWVzc2FnZSI6Inbhuq15IGLhuqFuIHThuqFvIGNobyB0w7RpIDEgdHJhbmcgdMawxqFuZyB04buxIG5oxrAgduG6rXkgxJHGsOG7o2Mga2jDtG5nIiwicmljaF90ZXh0X2pzb25fcmVwciI6eyJ0eXBlIjoiZG9jIiwiY29udGVudCI6W3sidHlwZSI6InBhcmFncmFwaCIsImNvbnRlbnQiOlt7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Inbhuq15IGLhuqFuIHThuqFvIGNobyB0w7RpIDEgdHJhbmcgdMawxqFuZyB04buxIG5oxrAgduG6rXkgxJHGsOG7o2Mga2jDtG5nIn1dfV19LCJtZW50aW9uZWRfaXRlbXMiOltdLCJzdHJ1Y3R1cmVkX291dHB1dF9ub2RlcyI6W3siaWQiOjAsInR5cGUiOjAsImNvbnRlbnQiOiJWw6JuZywgdMO0aSBz4bq9IHThuqFvIGNobyBi4bqhbiBt4buZdCB0cmFuZyBxdeG6o24gbMO9IGtodXnhur9uIG3Do2kgdMawxqFuZyB04buxIG5oxrAgTGljaFRyaW5oVGF1UGFuZWwuIEjDo3kgYuG6r3QgxJHhuqd1OlxuIn0seyJpZCI6MiwidHlwZSI6MiwiY29udGVudCI6IiJ9LHsiaWQiOjMsInR5cGUiOjMsImNvbnRlbnQiOiIifV0sInNlZW5fc3RhdGUiOiJzZWVuIiwic3RydWN0dXJlZF9yZXF1ZXN0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6MCwidGV4dF9ub2RlIjp7ImNvbnRlbnQiOiJ24bqteSBi4bqhbiB04bqhbyBjaG8gdMO0aSAxIHRyYW5nIHTGsMahbmcgdOG7sSBuaMawIHbhuq15IMSRxrDhu6NjIGtow7RuZyJ9fSx7ImlkIjoyLCJ0eXBlIjo0LCJpZGVfc3RhdGVfbm9kZSI6eyJ3b3Jrc3BhY2VGb2xkZXJzIjpbeyJyZXBvc2l0b3J5Um9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIiwiZm9sZGVyUm9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIn1dLCJ3b3Jrc3BhY2VGb2xkZXJzVW5jaGFuZ2VkIjpmYWxzZX19XSwicmVzcG9uc2VfdGV4dCI6IlbDom5nLCB0w7RpIHPhur0gdOG6oW8gY2hvIGLhuqFuIG3hu5l0IHRyYW5nIHF14bqjbiBsw70ga2h1eeG6v24gbcOjaSB0xrDGoW5nIHThu7EgbmjGsCBMaWNoVHJpbmhUYXVQYW5lbC4gSMOjeSBi4bqvdCDEkeG6p3U6XG5cbkknbSBzb3JyeS4gSSB0cmllZCB0byBjYWxsIGEgdG9vbCwgYnV0IHByb3ZpZGVkIHRvbyBsYXJnZSBvZiBhbiBpbnB1dC4gSG93IHdvdWxkIHlvdSBsaWtlIHRvIHByb2NlZWQ/XG4iLCJ3b3Jrc3BhY2VfZmlsZV9jaHVua3MiOltdfSx7InJlcXVlc3RfaWQiOiI1YTFiOThmMy1kMzQ3LTQ5OWEtYjNmZC1jNzdmNzQzN2E4MTUiLCJ1dWlkIjoiZWFjNDA0MzktN2VkYy00NmFmLTk5YWUtY2FhZWFmZmEyNTIyIiwiY2hhdEl0ZW1UeXBlIjoiYWdlbnRpYy1jaGVja3BvaW50LWRlbGltaXRlciIsInN0YXR1cyI6InN1Y2Nlc3MiLCJmcm9tVGltZXN0YW1wIjoxNzQ1MjUxNDc3NTY4LCJ0b1RpbWVzdGFtcCI6MTc0NTI5NjczMjk0Niwic2Vlbl9zdGF0ZSI6InNlZW4ifSx7InJlcXVlc3RfaWQiOiI0ZGM2ZjcxOC1jZGM1LTQwYjQtYjI3MC03NjQ3ZjNjYTJkMDEiLCJzdGF0dXMiOiJjYW5jZWxsZWQiLCJjaGF0SXRlbVR5cGUiOiJhZ2VudGljLXR1cm4tZGVsaW1pdGVyIn0seyJzdGF0dXMiOiJmYWlsZWQiLCJyZXF1ZXN0X21lc3NhZ2UiOiJAUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmdcbmphdmEubGFuZy5JbGxlZ2FsU3RhdGVFeGNlcHRpb246IG9yZy5oaWJlcm5hdGUuVHJhbnNpZW50UHJvcGVydHlWYWx1ZUV4Y2VwdGlvbjogTm90LW51bGwgcHJvcGVydHkgcmVmZXJlbmNlcyBhIHRyYW5zaWVudCB2YWx1ZSAtIHRyYW5zaWVudCBpbnN0YW5jZSBtdXN0IGJlIHNhdmVkIGJlZm9yZSBjdXJyZW50IG9wZXJhdGlvbjogbW9kZWwuSG9hRG9uLm52IC0+IG1vZGVsLk5oYW5WaWVuXHJcblx0YXQgb3JnLmhpYmVybmF0ZS5pbnRlcm5hbC5FeGNlcHRpb25Db252ZXJ0ZXJJbXBsLmNvbnZlcnQoRXhjZXB0aW9uQ29udmVydGVySW1wbC5qYXZhOjE1NylcclxuXHRhdCBvcmcuaGliZXJuYXRlLmludGVybmFsLkV4Y2VwdGlvbkNvbnZlcnRlckltcGwuY29udmVydChFeGNlcHRpb25Db252ZXJ0ZXJJbXBsLmphdmE6MTY3KVxyXG5cdGF0IG9yZy5oaWJlcm5hdGUuaW50ZXJuYWwuRXhjZXB0aW9uQ29udmVydGVySW1wbC5jb252ZXJ0KEV4Y2VwdGlvbkNvbnZlcnRlckltcGwuamF2YToxNzMpXHJcblx0YXQgb3JnLmhpYmVybmF0ZS5pbnRlcm5hbC5TZXNzaW9uSW1wbC5maXJlUGVyc2lzdChTZXNzaW9uSW1wbC5qYXZhOjcyNSlcclxuXHRhdCBvcmcuaGliZXJuYXRlLmludGVybmFsLlNlc3Npb25JbXBsLnBlcnNpc3QoU2Vzc2lvbkltcGwuamF2YTo2OTIpXHJcblx0YXQgZGFvLmltcGwuSG9hRG9uREFPSW1wbC5zYXZlSG9hRG9uKEhvYURvbkRBT0ltcGwuamF2YTo1MylcclxuXHRhdCBndWlDbGllbnQuVGhhbmhUb2FuR1VJLnByb2Nlc3NQYXltZW50KFRoYW5oVG9hbkdVSS5qYXZhOjE1NDkpXHJcblx0YXQgZ3VpQ2xpZW50LlRoYW5oVG9hbkdVSS5sYW1iZGEkaW5pdENvbXBvbmVudHMkMihUaGFuaFRvYW5HVUkuamF2YToxODcpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmF4LnN3aW5nLkFic3RyYWN0QnV0dG9uLmZpcmVBY3Rpb25QZXJmb3JtZWQoQWJzdHJhY3RCdXR0b24uamF2YToxOTcyKVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZheC5zd2luZy5BYnN0cmFjdEJ1dHRvbiRIYW5kbGVyLmFjdGlvblBlcmZvcm1lZChBYnN0cmFjdEJ1dHRvbi5qYXZhOjIzMTQpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmF4LnN3aW5nLkRlZmF1bHRCdXR0b25Nb2RlbC5maXJlQWN0aW9uUGVyZm9ybWVkKERlZmF1bHRCdXR0b25Nb2RlbC5qYXZhOjQwNylcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YXguc3dpbmcuRGVmYXVsdEJ1dHRvbk1vZGVsLnNldFByZXNzZWQoRGVmYXVsdEJ1dHRvbk1vZGVsLmphdmE6MjYyKVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZheC5zd2luZy5wbGFmLmJhc2ljLkJhc2ljQnV0dG9uTGlzdGVuZXIubW91c2VSZWxlYXNlZChCYXNpY0J1dHRvbkxpc3RlbmVyLmphdmE6Mjc5KVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5Db21wb25lbnQucHJvY2Vzc01vdXNlRXZlbnQoQ29tcG9uZW50LmphdmE6NjYyMSlcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YXguc3dpbmcuSkNvbXBvbmVudC5wcm9jZXNzTW91c2VFdmVudChKQ29tcG9uZW50LmphdmE6MzM5OClcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuQ29tcG9uZW50LnByb2Nlc3NFdmVudChDb21wb25lbnQuamF2YTo2Mzg2KVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5Db250YWluZXIucHJvY2Vzc0V2ZW50KENvbnRhaW5lci5qYXZhOjIyNjYpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkNvbXBvbmVudC5kaXNwYXRjaEV2ZW50SW1wbChDb21wb25lbnQuamF2YTo0OTk2KVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5Db250YWluZXIuZGlzcGF0Y2hFdmVudEltcGwoQ29udGFpbmVyLmphdmE6MjMyNClcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuQ29tcG9uZW50LmRpc3BhdGNoRXZlbnQoQ29tcG9uZW50LmphdmE6NDgyOClcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuTGlnaHR3ZWlnaHREaXNwYXRjaGVyLnJldGFyZ2V0TW91c2VFdmVudChDb250YWluZXIuamF2YTo0OTQ4KVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5MaWdodHdlaWdodERpc3BhdGNoZXIucHJvY2Vzc01vdXNlRXZlbnQoQ29udGFpbmVyLmphdmE6NDU3NSlcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuTGlnaHR3ZWlnaHREaXNwYXRjaGVyLmRpc3BhdGNoRXZlbnQoQ29udGFpbmVyLmphdmE6NDUxNilcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuQ29udGFpbmVyLmRpc3BhdGNoRXZlbnRJbXBsKENvbnRhaW5lci5qYXZhOjIzMTApXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LldpbmRvdy5kaXNwYXRjaEV2ZW50SW1wbChXaW5kb3cuamF2YToyNzgwKVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5Db21wb25lbnQuZGlzcGF0Y2hFdmVudChDb21wb25lbnQuamF2YTo0ODI4KVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5FdmVudFF1ZXVlLmRpc3BhdGNoRXZlbnRJbXBsKEV2ZW50UXVldWUuamF2YTo3NzUpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkV2ZW50UXVldWUkNC5ydW4oRXZlbnRRdWV1ZS5qYXZhOjcyMClcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuRXZlbnRRdWV1ZSQ0LnJ1bihFdmVudFF1ZXVlLmphdmE6NzE0KVxyXG5cdGF0IGphdmEuYmFzZS9qYXZhLnNlY3VyaXR5LkFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKEFjY2Vzc0NvbnRyb2xsZXIuamF2YTo0MDApXHJcblx0YXQgamF2YS5iYXNlL2phdmEuc2VjdXJpdHkuUHJvdGVjdGlvbkRvbWFpbiRKYXZhU2VjdXJpdHlBY2Nlc3NJbXBsLmRvSW50ZXJzZWN0aW9uUHJpdmlsZWdlKFByb3RlY3Rpb25Eb21haW4uamF2YTo4NylcclxuXHRhdCBqYXZhLmJhc2UvamF2YS5zZWN1cml0eS5Qcm90ZWN0aW9uRG9tYWluJEphdmFTZWN1cml0eUFjY2Vzc0ltcGwuZG9JbnRlcnNlY3Rpb25Qcml2aWxlZ2UoUHJvdGVjdGlvbkRvbWFpbi5qYXZhOjk4KVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5FdmVudFF1ZXVlJDUucnVuKEV2ZW50UXVldWUuamF2YTo3NDcpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkV2ZW50UXVldWUkNS5ydW4oRXZlbnRRdWV1ZS5qYXZhOjc0NSlcclxuXHRhdCBqYXZhLmJhc2UvamF2YS5zZWN1cml0eS5BY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZChBY2Nlc3NDb250cm9sbGVyLmphdmE6NDAwKVxyXG5cdGF0IGphdmEuYmFzZS9qYXZhLnNlY3VyaXR5LlByb3RlY3Rpb25Eb21haW4kSmF2YVNlY3VyaXR5QWNjZXNzSW1wbC5kb0ludGVyc2VjdGlvblByaXZpbGVnZShQcm90ZWN0aW9uRG9tYWluLmphdmE6ODcpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkV2ZW50UXVldWUuZGlzcGF0Y2hFdmVudChFdmVudFF1ZXVlLmphdmE6NzQ0KVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5FdmVudERpc3BhdGNoVGhyZWFkLnB1bXBPbmVFdmVudEZvckZpbHRlcnMoRXZlbnREaXNwYXRjaFRocmVhZC5qYXZhOjIwMylcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuRXZlbnREaXNwYXRjaFRocmVhZC5wdW1wRXZlbnRzRm9yRmlsdGVyKEV2ZW50RGlzcGF0Y2hUaHJlYWQuamF2YToxMjQpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkV2ZW50RGlzcGF0Y2hUaHJlYWQucHVtcEV2ZW50c0ZvckhpZXJhcmNoeShFdmVudERpc3BhdGNoVGhyZWFkLmphdmE6MTEzKVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5FdmVudERpc3BhdGNoVGhyZWFkLnB1bXBFdmVudHMoRXZlbnREaXNwYXRjaFRocmVhZC5qYXZhOjEwOSlcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuRXZlbnREaXNwYXRjaFRocmVhZC5wdW1wRXZlbnRzKEV2ZW50RGlzcGF0Y2hUaHJlYWQuamF2YToxMDEpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkV2ZW50RGlzcGF0Y2hUaHJlYWQucnVuKEV2ZW50RGlzcGF0Y2hUaHJlYWQuamF2YTo5MClcclxuQ2F1c2VkIGJ5OiBvcmcuaGliZXJuYXRlLlRyYW5zaWVudFByb3BlcnR5VmFsdWVFeGNlcHRpb246IE5vdC1udWxsIHByb3BlcnR5IHJlZmVyZW5jZXMgYSB0cmFuc2llbnQgdmFsdWUgLSB0cmFuc2llbnQgaW5zdGFuY2UgbXVzdCBiZSBzYXZlZCBiZWZvcmUgY3VycmVudCBvcGVyYXRpb246IG1vZGVsLkhvYURvbi5udiAtPiBtb2RlbC5OaGFuVmllblxyXG5cdGF0IG9yZy5oaWJlcm5hdGUuYWN0aW9uLmludGVybmFsLlVucmVzb2x2ZWRFbnRpdHlJbnNlcnRBY3Rpb25zLmNoZWNrTm9VbnJlc29sdmVkQWN0aW9uc0FmdGVyT3BlcmF0aW9uKFVucmVzb2x2ZWRFbnRpdHlJbnNlcnRBY3Rpb25zLmphdmE6MTIzKVxyXG5cdGF0IG9yZy5oaWJlcm5hdGUuZW5naW5lLnNwaS5BY3Rpb25RdWV1ZS5jaGVja05vVW5yZXNvbHZlZEFjdGlvbnNBZnRlck9wZXJhdGlvbihBY3Rpb25RdWV1ZS5qYXZhOjQ2MSlcclxuXHRhdCBvcmcuaGliZXJuYXRlLmludGVybmFsLlNlc3Npb25JbXBsLmNoZWNrTm9VbnJlc29sdmVkQWN0aW9uc0FmdGVyT3BlcmF0aW9uKFNlc3Npb25JbXBsLmphdmE6NjE0KVxyXG5cdGF0IG9yZy5oaWJlcm5hdGUuaW50ZXJuYWwuU2Vzc2lvbkltcGwuZmlyZVBlcnNpc3QoU2Vzc2lvbkltcGwuamF2YTo3MjIpXHJcblx0Li4uIDM5IG1vcmUiLCJyaWNoX3RleHRfanNvbl9yZXByIjp7InR5cGUiOiJkb2MiLCJjb250ZW50IjpbeyJ0eXBlIjoicGFyYWdyYXBoIiwiY29udGVudCI6W3sidHlwZSI6Im1lbnRpb24iLCJhdHRycyI6eyJpZCI6Ii9Qcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyIsImxhYmVsIjoiUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmciLCJkYXRhIjp7ImxhYmVsIjoiUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmciLCJuYW1lIjoiUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmciLCJpZCI6Ii9Qcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyIsImZvbGRlciI6eyJyZXBvUm9vdCI6IiIsInBhdGhOYW1lIjoiUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcifSwidHlwZSI6Iml0ZW0ifX19LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiamF2YS5sYW5nLklsbGVnYWxTdGF0ZUV4Y2VwdGlvbjogb3JnLmhpYmVybmF0ZS5UcmFuc2llbnRQcm9wZXJ0eVZhbHVlRXhjZXB0aW9uOiBOb3QtbnVsbCBwcm9wZXJ0eSByZWZlcmVuY2VzIGEgdHJhbnNpZW50IHZhbHVlIC0gdHJhbnNpZW50IGluc3RhbmNlIG11c3QgYmUgc2F2ZWQgYmVmb3JlIGN1cnJlbnQgb3BlcmF0aW9uOiBtb2RlbC5Ib2FEb24ubnYgLT4gbW9kZWwuTmhhblZpZW5cciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHRhdCBvcmcuaGliZXJuYXRlLmludGVybmFsLkV4Y2VwdGlvbkNvbnZlcnRlckltcGwuY29udmVydChFeGNlcHRpb25Db252ZXJ0ZXJJbXBsLmphdmE6MTU3KVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IG9yZy5oaWJlcm5hdGUuaW50ZXJuYWwuRXhjZXB0aW9uQ29udmVydGVySW1wbC5jb252ZXJ0KEV4Y2VwdGlvbkNvbnZlcnRlckltcGwuamF2YToxNjcpXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgb3JnLmhpYmVybmF0ZS5pbnRlcm5hbC5FeGNlcHRpb25Db252ZXJ0ZXJJbXBsLmNvbnZlcnQoRXhjZXB0aW9uQ29udmVydGVySW1wbC5qYXZhOjE3MylcciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHRhdCBvcmcuaGliZXJuYXRlLmludGVybmFsLlNlc3Npb25JbXBsLmZpcmVQZXJzaXN0KFNlc3Npb25JbXBsLmphdmE6NzI1KVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IG9yZy5oaWJlcm5hdGUuaW50ZXJuYWwuU2Vzc2lvbkltcGwucGVyc2lzdChTZXNzaW9uSW1wbC5qYXZhOjY5MilcciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHRhdCBkYW8uaW1wbC5Ib2FEb25EQU9JbXBsLnNhdmVIb2FEb24oSG9hRG9uREFPSW1wbC5qYXZhOjUzKVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IGd1aUNsaWVudC5UaGFuaFRvYW5HVUkucHJvY2Vzc1BheW1lbnQoVGhhbmhUb2FuR1VJLmphdmE6MTU0OSlcciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHRhdCBndWlDbGllbnQuVGhhbmhUb2FuR1VJLmxhbWJkYSRpbml0Q29tcG9uZW50cyQyKFRoYW5oVG9hbkdVSS5qYXZhOjE4NylcciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHRhdCBqYXZhLmRlc2t0b3AvamF2YXguc3dpbmcuQWJzdHJhY3RCdXR0b24uZmlyZUFjdGlvblBlcmZvcm1lZChBYnN0cmFjdEJ1dHRvbi5qYXZhOjE5NzIpXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgamF2YS5kZXNrdG9wL2phdmF4LnN3aW5nLkFic3RyYWN0QnV0dG9uJEhhbmRsZXIuYWN0aW9uUGVyZm9ybWVkKEFic3RyYWN0QnV0dG9uLmphdmE6MjMxNClcciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHRhdCBqYXZhLmRlc2t0b3AvamF2YXguc3dpbmcuRGVmYXVsdEJ1dHRvbk1vZGVsLmZpcmVBY3Rpb25QZXJmb3JtZWQoRGVmYXVsdEJ1dHRvbk1vZGVsLmphdmE6NDA3KVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IGphdmEuZGVza3RvcC9qYXZheC5zd2luZy5EZWZhdWx0QnV0dG9uTW9kZWwuc2V0UHJlc3NlZChEZWZhdWx0QnV0dG9uTW9kZWwuamF2YToyNjIpXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgamF2YS5kZXNrdG9wL2phdmF4LnN3aW5nLnBsYWYuYmFzaWMuQmFzaWNCdXR0b25MaXN0ZW5lci5tb3VzZVJlbGVhc2VkKEJhc2ljQnV0dG9uTGlzdGVuZXIuamF2YToyNzkpXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkNvbXBvbmVudC5wcm9jZXNzTW91c2VFdmVudChDb21wb25lbnQuamF2YTo2NjIxKVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IGphdmEuZGVza3RvcC9qYXZheC5zd2luZy5KQ29tcG9uZW50LnByb2Nlc3NNb3VzZUV2ZW50KEpDb21wb25lbnQuamF2YTozMzk4KVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5Db21wb25lbnQucHJvY2Vzc0V2ZW50KENvbXBvbmVudC5qYXZhOjYzODYpXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkNvbnRhaW5lci5wcm9jZXNzRXZlbnQoQ29udGFpbmVyLmphdmE6MjI2NilcciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuQ29tcG9uZW50LmRpc3BhdGNoRXZlbnRJbXBsKENvbXBvbmVudC5qYXZhOjQ5OTYpXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkNvbnRhaW5lci5kaXNwYXRjaEV2ZW50SW1wbChDb250YWluZXIuamF2YToyMzI0KVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5Db21wb25lbnQuZGlzcGF0Y2hFdmVudChDb21wb25lbnQuamF2YTo0ODI4KVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5MaWdodHdlaWdodERpc3BhdGNoZXIucmV0YXJnZXRNb3VzZUV2ZW50KENvbnRhaW5lci5qYXZhOjQ5NDgpXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkxpZ2h0d2VpZ2h0RGlzcGF0Y2hlci5wcm9jZXNzTW91c2VFdmVudChDb250YWluZXIuamF2YTo0NTc1KVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5MaWdodHdlaWdodERpc3BhdGNoZXIuZGlzcGF0Y2hFdmVudChDb250YWluZXIuamF2YTo0NTE2KVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5Db250YWluZXIuZGlzcGF0Y2hFdmVudEltcGwoQ29udGFpbmVyLmphdmE6MjMxMClcciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuV2luZG93LmRpc3BhdGNoRXZlbnRJbXBsKFdpbmRvdy5qYXZhOjI3ODApXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkNvbXBvbmVudC5kaXNwYXRjaEV2ZW50KENvbXBvbmVudC5qYXZhOjQ4MjgpXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkV2ZW50UXVldWUuZGlzcGF0Y2hFdmVudEltcGwoRXZlbnRRdWV1ZS5qYXZhOjc3NSlcciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuRXZlbnRRdWV1ZSQ0LnJ1bihFdmVudFF1ZXVlLmphdmE6NzIwKVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5FdmVudFF1ZXVlJDQucnVuKEV2ZW50UXVldWUuamF2YTo3MTQpXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgamF2YS5iYXNlL2phdmEuc2VjdXJpdHkuQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoQWNjZXNzQ29udHJvbGxlci5qYXZhOjQwMClcciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHRhdCBqYXZhLmJhc2UvamF2YS5zZWN1cml0eS5Qcm90ZWN0aW9uRG9tYWluJEphdmFTZWN1cml0eUFjY2Vzc0ltcGwuZG9JbnRlcnNlY3Rpb25Qcml2aWxlZ2UoUHJvdGVjdGlvbkRvbWFpbi5qYXZhOjg3KVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IGphdmEuYmFzZS9qYXZhLnNlY3VyaXR5LlByb3RlY3Rpb25Eb21haW4kSmF2YVNlY3VyaXR5QWNjZXNzSW1wbC5kb0ludGVyc2VjdGlvblByaXZpbGVnZShQcm90ZWN0aW9uRG9tYWluLmphdmE6OTgpXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkV2ZW50UXVldWUkNS5ydW4oRXZlbnRRdWV1ZS5qYXZhOjc0NylcciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuRXZlbnRRdWV1ZSQ1LnJ1bihFdmVudFF1ZXVlLmphdmE6NzQ1KVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IGphdmEuYmFzZS9qYXZhLnNlY3VyaXR5LkFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKEFjY2Vzc0NvbnRyb2xsZXIuamF2YTo0MDApXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgamF2YS5iYXNlL2phdmEuc2VjdXJpdHkuUHJvdGVjdGlvbkRvbWFpbiRKYXZhU2VjdXJpdHlBY2Nlc3NJbXBsLmRvSW50ZXJzZWN0aW9uUHJpdmlsZWdlKFByb3RlY3Rpb25Eb21haW4uamF2YTo4NylcciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuRXZlbnRRdWV1ZS5kaXNwYXRjaEV2ZW50KEV2ZW50UXVldWUuamF2YTo3NDQpXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkV2ZW50RGlzcGF0Y2hUaHJlYWQucHVtcE9uZUV2ZW50Rm9yRmlsdGVycyhFdmVudERpc3BhdGNoVGhyZWFkLmphdmE6MjAzKVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5FdmVudERpc3BhdGNoVGhyZWFkLnB1bXBFdmVudHNGb3JGaWx0ZXIoRXZlbnREaXNwYXRjaFRocmVhZC5qYXZhOjEyNClcciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuRXZlbnREaXNwYXRjaFRocmVhZC5wdW1wRXZlbnRzRm9ySGllcmFyY2h5KEV2ZW50RGlzcGF0Y2hUaHJlYWQuamF2YToxMTMpXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkV2ZW50RGlzcGF0Y2hUaHJlYWQucHVtcEV2ZW50cyhFdmVudERpc3BhdGNoVGhyZWFkLmphdmE6MTA5KVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5FdmVudERpc3BhdGNoVGhyZWFkLnB1bXBFdmVudHMoRXZlbnREaXNwYXRjaFRocmVhZC5qYXZhOjEwMSlcciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuRXZlbnREaXNwYXRjaFRocmVhZC5ydW4oRXZlbnREaXNwYXRjaFRocmVhZC5qYXZhOjkwKVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJDYXVzZWQgYnk6IG9yZy5oaWJlcm5hdGUuVHJhbnNpZW50UHJvcGVydHlWYWx1ZUV4Y2VwdGlvbjogTm90LW51bGwgcHJvcGVydHkgcmVmZXJlbmNlcyBhIHRyYW5zaWVudCB2YWx1ZSAtIHRyYW5zaWVudCBpbnN0YW5jZSBtdXN0IGJlIHNhdmVkIGJlZm9yZSBjdXJyZW50IG9wZXJhdGlvbjogbW9kZWwuSG9hRG9uLm52IC0+IG1vZGVsLk5oYW5WaWVuXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgb3JnLmhpYmVybmF0ZS5hY3Rpb24uaW50ZXJuYWwuVW5yZXNvbHZlZEVudGl0eUluc2VydEFjdGlvbnMuY2hlY2tOb1VucmVzb2x2ZWRBY3Rpb25zQWZ0ZXJPcGVyYXRpb24oVW5yZXNvbHZlZEVudGl0eUluc2VydEFjdGlvbnMuamF2YToxMjMpXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgb3JnLmhpYmVybmF0ZS5lbmdpbmUuc3BpLkFjdGlvblF1ZXVlLmNoZWNrTm9VbnJlc29sdmVkQWN0aW9uc0FmdGVyT3BlcmF0aW9uKEFjdGlvblF1ZXVlLmphdmE6NDYxKVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IG9yZy5oaWJlcm5hdGUuaW50ZXJuYWwuU2Vzc2lvbkltcGwuY2hlY2tOb1VucmVzb2x2ZWRBY3Rpb25zQWZ0ZXJPcGVyYXRpb24oU2Vzc2lvbkltcGwuamF2YTo2MTQpXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgb3JnLmhpYmVybmF0ZS5pbnRlcm5hbC5TZXNzaW9uSW1wbC5maXJlUGVyc2lzdChTZXNzaW9uSW1wbC5qYXZhOjcyMilcciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHQuLi4gMzkgbW9yZSJ9XX1dfSwibWVudGlvbmVkX2l0ZW1zIjpbeyJsYWJlbCI6IlByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIiwibmFtZSI6IlByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIiwiaWQiOiIvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmciLCJmb2xkZXIiOnsicmVwb1Jvb3QiOiIiLCJwYXRoTmFtZSI6IlByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIn0sInR5cGUiOiJpdGVtIn1dLCJzdHJ1Y3R1cmVkX291dHB1dF9ub2RlcyI6W10sInNlZW5fc3RhdGUiOiJ1bnNlZW4iLCJzdHJ1Y3R1cmVkX3JlcXVlc3Rfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjowLCJ0ZXh0X25vZGUiOnsiY29udGVudCI6IkBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZ1xuamF2YS5sYW5nLklsbGVnYWxTdGF0ZUV4Y2VwdGlvbjogb3JnLmhpYmVybmF0ZS5UcmFuc2llbnRQcm9wZXJ0eVZhbHVlRXhjZXB0aW9uOiBOb3QtbnVsbCBwcm9wZXJ0eSByZWZlcmVuY2VzIGEgdHJhbnNpZW50IHZhbHVlIC0gdHJhbnNpZW50IGluc3RhbmNlIG11c3QgYmUgc2F2ZWQgYmVmb3JlIGN1cnJlbnQgb3BlcmF0aW9uOiBtb2RlbC5Ib2FEb24ubnYgLT4gbW9kZWwuTmhhblZpZW5cclxuXHRhdCBvcmcuaGliZXJuYXRlLmludGVybmFsLkV4Y2VwdGlvbkNvbnZlcnRlckltcGwuY29udmVydChFeGNlcHRpb25Db252ZXJ0ZXJJbXBsLmphdmE6MTU3KVxyXG5cdGF0IG9yZy5oaWJlcm5hdGUuaW50ZXJuYWwuRXhjZXB0aW9uQ29udmVydGVySW1wbC5jb252ZXJ0KEV4Y2VwdGlvbkNvbnZlcnRlckltcGwuamF2YToxNjcpXHJcblx0YXQgb3JnLmhpYmVybmF0ZS5pbnRlcm5hbC5FeGNlcHRpb25Db252ZXJ0ZXJJbXBsLmNvbnZlcnQoRXhjZXB0aW9uQ29udmVydGVySW1wbC5qYXZhOjE3MylcclxuXHRhdCBvcmcuaGliZXJuYXRlLmludGVybmFsLlNlc3Npb25JbXBsLmZpcmVQZXJzaXN0KFNlc3Npb25JbXBsLmphdmE6NzI1KVxyXG5cdGF0IG9yZy5oaWJlcm5hdGUuaW50ZXJuYWwuU2Vzc2lvbkltcGwucGVyc2lzdChTZXNzaW9uSW1wbC5qYXZhOjY5MilcclxuXHRhdCBkYW8uaW1wbC5Ib2FEb25EQU9JbXBsLnNhdmVIb2FEb24oSG9hRG9uREFPSW1wbC5qYXZhOjUzKVxyXG5cdGF0IGd1aUNsaWVudC5UaGFuaFRvYW5HVUkucHJvY2Vzc1BheW1lbnQoVGhhbmhUb2FuR1VJLmphdmE6MTU0OSlcclxuXHRhdCBndWlDbGllbnQuVGhhbmhUb2FuR1VJLmxhbWJkYSRpbml0Q29tcG9uZW50cyQyKFRoYW5oVG9hbkdVSS5qYXZhOjE4NylcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YXguc3dpbmcuQWJzdHJhY3RCdXR0b24uZmlyZUFjdGlvblBlcmZvcm1lZChBYnN0cmFjdEJ1dHRvbi5qYXZhOjE5NzIpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmF4LnN3aW5nLkFic3RyYWN0QnV0dG9uJEhhbmRsZXIuYWN0aW9uUGVyZm9ybWVkKEFic3RyYWN0QnV0dG9uLmphdmE6MjMxNClcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YXguc3dpbmcuRGVmYXVsdEJ1dHRvbk1vZGVsLmZpcmVBY3Rpb25QZXJmb3JtZWQoRGVmYXVsdEJ1dHRvbk1vZGVsLmphdmE6NDA3KVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZheC5zd2luZy5EZWZhdWx0QnV0dG9uTW9kZWwuc2V0UHJlc3NlZChEZWZhdWx0QnV0dG9uTW9kZWwuamF2YToyNjIpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmF4LnN3aW5nLnBsYWYuYmFzaWMuQmFzaWNCdXR0b25MaXN0ZW5lci5tb3VzZVJlbGVhc2VkKEJhc2ljQnV0dG9uTGlzdGVuZXIuamF2YToyNzkpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkNvbXBvbmVudC5wcm9jZXNzTW91c2VFdmVudChDb21wb25lbnQuamF2YTo2NjIxKVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZheC5zd2luZy5KQ29tcG9uZW50LnByb2Nlc3NNb3VzZUV2ZW50KEpDb21wb25lbnQuamF2YTozMzk4KVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5Db21wb25lbnQucHJvY2Vzc0V2ZW50KENvbXBvbmVudC5qYXZhOjYzODYpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkNvbnRhaW5lci5wcm9jZXNzRXZlbnQoQ29udGFpbmVyLmphdmE6MjI2NilcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuQ29tcG9uZW50LmRpc3BhdGNoRXZlbnRJbXBsKENvbXBvbmVudC5qYXZhOjQ5OTYpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkNvbnRhaW5lci5kaXNwYXRjaEV2ZW50SW1wbChDb250YWluZXIuamF2YToyMzI0KVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5Db21wb25lbnQuZGlzcGF0Y2hFdmVudChDb21wb25lbnQuamF2YTo0ODI4KVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5MaWdodHdlaWdodERpc3BhdGNoZXIucmV0YXJnZXRNb3VzZUV2ZW50KENvbnRhaW5lci5qYXZhOjQ5NDgpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkxpZ2h0d2VpZ2h0RGlzcGF0Y2hlci5wcm9jZXNzTW91c2VFdmVudChDb250YWluZXIuamF2YTo0NTc1KVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5MaWdodHdlaWdodERpc3BhdGNoZXIuZGlzcGF0Y2hFdmVudChDb250YWluZXIuamF2YTo0NTE2KVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5Db250YWluZXIuZGlzcGF0Y2hFdmVudEltcGwoQ29udGFpbmVyLmphdmE6MjMxMClcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuV2luZG93LmRpc3BhdGNoRXZlbnRJbXBsKFdpbmRvdy5qYXZhOjI3ODApXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkNvbXBvbmVudC5kaXNwYXRjaEV2ZW50KENvbXBvbmVudC5qYXZhOjQ4MjgpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkV2ZW50UXVldWUuZGlzcGF0Y2hFdmVudEltcGwoRXZlbnRRdWV1ZS5qYXZhOjc3NSlcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuRXZlbnRRdWV1ZSQ0LnJ1bihFdmVudFF1ZXVlLmphdmE6NzIwKVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5FdmVudFF1ZXVlJDQucnVuKEV2ZW50UXVldWUuamF2YTo3MTQpXHJcblx0YXQgamF2YS5iYXNlL2phdmEuc2VjdXJpdHkuQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoQWNjZXNzQ29udHJvbGxlci5qYXZhOjQwMClcclxuXHRhdCBqYXZhLmJhc2UvamF2YS5zZWN1cml0eS5Qcm90ZWN0aW9uRG9tYWluJEphdmFTZWN1cml0eUFjY2Vzc0ltcGwuZG9JbnRlcnNlY3Rpb25Qcml2aWxlZ2UoUHJvdGVjdGlvbkRvbWFpbi5qYXZhOjg3KVxyXG5cdGF0IGphdmEuYmFzZS9qYXZhLnNlY3VyaXR5LlByb3RlY3Rpb25Eb21haW4kSmF2YVNlY3VyaXR5QWNjZXNzSW1wbC5kb0ludGVyc2VjdGlvblByaXZpbGVnZShQcm90ZWN0aW9uRG9tYWluLmphdmE6OTgpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkV2ZW50UXVldWUkNS5ydW4oRXZlbnRRdWV1ZS5qYXZhOjc0NylcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuRXZlbnRRdWV1ZSQ1LnJ1bihFdmVudFF1ZXVlLmphdmE6NzQ1KVxyXG5cdGF0IGphdmEuYmFzZS9qYXZhLnNlY3VyaXR5LkFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKEFjY2Vzc0NvbnRyb2xsZXIuamF2YTo0MDApXHJcblx0YXQgamF2YS5iYXNlL2phdmEuc2VjdXJpdHkuUHJvdGVjdGlvbkRvbWFpbiRKYXZhU2VjdXJpdHlBY2Nlc3NJbXBsLmRvSW50ZXJzZWN0aW9uUHJpdmlsZWdlKFByb3RlY3Rpb25Eb21haW4uamF2YTo4NylcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuRXZlbnRRdWV1ZS5kaXNwYXRjaEV2ZW50KEV2ZW50UXVldWUuamF2YTo3NDQpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkV2ZW50RGlzcGF0Y2hUaHJlYWQucHVtcE9uZUV2ZW50Rm9yRmlsdGVycyhFdmVudERpc3BhdGNoVGhyZWFkLmphdmE6MjAzKVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5FdmVudERpc3BhdGNoVGhyZWFkLnB1bXBFdmVudHNGb3JGaWx0ZXIoRXZlbnREaXNwYXRjaFRocmVhZC5qYXZhOjEyNClcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuRXZlbnREaXNwYXRjaFRocmVhZC5wdW1wRXZlbnRzRm9ySGllcmFyY2h5KEV2ZW50RGlzcGF0Y2hUaHJlYWQuamF2YToxMTMpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkV2ZW50RGlzcGF0Y2hUaHJlYWQucHVtcEV2ZW50cyhFdmVudERpc3BhdGNoVGhyZWFkLmphdmE6MTA5KVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5FdmVudERpc3BhdGNoVGhyZWFkLnB1bXBFdmVudHMoRXZlbnREaXNwYXRjaFRocmVhZC5qYXZhOjEwMSlcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuRXZlbnREaXNwYXRjaFRocmVhZC5ydW4oRXZlbnREaXNwYXRjaFRocmVhZC5qYXZhOjkwKVxyXG5DYXVzZWQgYnk6IG9yZy5oaWJlcm5hdGUuVHJhbnNpZW50UHJvcGVydHlWYWx1ZUV4Y2VwdGlvbjogTm90LW51bGwgcHJvcGVydHkgcmVmZXJlbmNlcyBhIHRyYW5zaWVudCB2YWx1ZSAtIHRyYW5zaWVudCBpbnN0YW5jZSBtdXN0IGJlIHNhdmVkIGJlZm9yZSBjdXJyZW50IG9wZXJhdGlvbjogbW9kZWwuSG9hRG9uLm52IC0+IG1vZGVsLk5oYW5WaWVuXHJcblx0YXQgb3JnLmhpYmVybmF0ZS5hY3Rpb24uaW50ZXJuYWwuVW5yZXNvbHZlZEVudGl0eUluc2VydEFjdGlvbnMuY2hlY2tOb1VucmVzb2x2ZWRBY3Rpb25zQWZ0ZXJPcGVyYXRpb24oVW5yZXNvbHZlZEVudGl0eUluc2VydEFjdGlvbnMuamF2YToxMjMpXHJcblx0YXQgb3JnLmhpYmVybmF0ZS5lbmdpbmUuc3BpLkFjdGlvblF1ZXVlLmNoZWNrTm9VbnJlc29sdmVkQWN0aW9uc0FmdGVyT3BlcmF0aW9uKEFjdGlvblF1ZXVlLmphdmE6NDYxKVxyXG5cdGF0IG9yZy5oaWJlcm5hdGUuaW50ZXJuYWwuU2Vzc2lvbkltcGwuY2hlY2tOb1VucmVzb2x2ZWRBY3Rpb25zQWZ0ZXJPcGVyYXRpb24oU2Vzc2lvbkltcGwuamF2YTo2MTQpXHJcblx0YXQgb3JnLmhpYmVybmF0ZS5pbnRlcm5hbC5TZXNzaW9uSW1wbC5maXJlUGVyc2lzdChTZXNzaW9uSW1wbC5qYXZhOjcyMilcclxuXHQuLi4gMzkgbW9yZSJ9fSx7ImlkIjoyLCJ0eXBlIjo0LCJpZGVfc3RhdGVfbm9kZSI6eyJ3b3Jrc3BhY2VGb2xkZXJzIjpbeyJyZXBvc2l0b3J5Um9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIiwiZm9sZGVyUm9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIn1dLCJ3b3Jrc3BhY2VGb2xkZXJzVW5jaGFuZ2VkIjpmYWxzZX19XSwicmVzcG9uc2VfdGV4dCI6IiIsIndvcmtzcGFjZV9maWxlX2NodW5rcyI6W119LHsicmVxdWVzdF9pZCI6ImEwYThkYzRlLWI0MDItNDI2YS1hOWFlLWJhZjJlYmRmMzg5YyIsInV1aWQiOiJhOTE3ZTViMC02ZmVmLTQ5MGItYTA1NS1kODNhM2VmMDFhOGEiLCJjaGF0SXRlbVR5cGUiOiJhZ2VudGljLWNoZWNrcG9pbnQtZGVsaW1pdGVyIiwic3RhdHVzIjoic3VjY2VzcyIsImZyb21UaW1lc3RhbXAiOjE3NDUyOTY3MzI5NDYsInRvVGltZXN0YW1wIjoxNzQ1Mjk2NzY2OTIwLCJyZXZlcnRUYXJnZXQiOnsiZmlsZVBhdGgiOnsicm9vdFBhdGgiOiJFOi9MVFBUSkFWQS9OaG9tL1BoYW5UYW5KYXZhTmhvbUdQVCIsInJlbFBhdGgiOiJQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2Rhby9pbXBsL0todXllbk1haURBT0ltcGwuamF2YSJ9fSwic2Vlbl9zdGF0ZSI6InNlZW4ifSx7InJlcXVlc3RfaWQiOiJjNTU0NGQ2NS04OWEyLTRhMGUtODNjYi04ZTQwNTM3NDU5YWMiLCJ1dWlkIjoiZTczY2EzMjEtN2QzNS00NDAyLWI1MzctNGY4NTliYmY1ODQ1IiwiY2hhdEl0ZW1UeXBlIjoiYWdlbnRpYy1jaGVja3BvaW50LWRlbGltaXRlciIsInN0YXR1cyI6InN1Y2Nlc3MiLCJmcm9tVGltZXN0YW1wIjoxNzQ1Mjk2NzY2OTIwLCJ0b1RpbWVzdGFtcCI6MTc0NTI5Njc2ODI1NiwicmV2ZXJ0VGFyZ2V0Ijp7ImZpbGVQYXRoIjp7InJvb3RQYXRoIjoiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQiLCJyZWxQYXRoIjoiUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9tb2RlbC9Eb2lUdW9uZ0FwRHVuZy5qYXZhIn19LCJzZWVuX3N0YXRlIjoic2VlbiJ9LHsicmVxdWVzdF9pZCI6ImY4Y2VhOGZlLTk4MDctNGNjMi04YzcwLWE4YWNhNzc3ZDcyMSIsInV1aWQiOiJhM2RiNzY3NC01NDZmLTQ4NmMtYjRjNi02ZDczNzk3ZjMwNDIiLCJjaGF0SXRlbVR5cGUiOiJhZ2VudGljLWNoZWNrcG9pbnQtZGVsaW1pdGVyIiwic3RhdHVzIjoic3VjY2VzcyIsImZyb21UaW1lc3RhbXAiOjE3NDUyOTY3NjgyNTYsInRvVGltZXN0YW1wIjoxNzQ1Mjk2Nzk4NDU4LCJyZXZlcnRUYXJnZXQiOnsidXVpZCI6ImE5MTdlNWIwLTZmZWYtNDkwYi1hMDU1LWQ4M2EzZWYwMWE4YSJ9LCJzZWVuX3N0YXRlIjoic2VlbiJ9LHsicmVxdWVzdF9pZCI6IjE5ODI3NWYxLThlYWItNGZiZi04YzVkLWU4YTJkMDQxMzBhNSIsInV1aWQiOiI0ZDc0YTkzZi1hNDQ4LTRmMWQtYTk5ZS0wNGIwNzdiODU2MmEiLCJjaGF0SXRlbVR5cGUiOiJhZ2VudGljLWNoZWNrcG9pbnQtZGVsaW1pdGVyIiwic3RhdHVzIjoic3VjY2VzcyIsImZyb21UaW1lc3RhbXAiOjE3NDUyOTY3OTg0NTgsInRvVGltZXN0YW1wIjoxNzQ1Mjk3MDg5NTc1LCJyZXZlcnRUYXJnZXQiOnsidXVpZCI6ImE5MTdlNWIwLTZmZWYtNDkwYi1hMDU1LWQ4M2EzZWYwMWE4YSJ9fV0sImZlZWRiYWNrU3RhdGVzIjp7InRlbXAtZmUtNTZmYjUyNDYtYzZiZC00ZjY2LWI2MjQtYWRiN2JlMGZhOGU3Ijp7InNlbGVjdGVkUmF0aW5nIjowLCJmZWVkYmFja05vdGUiOiIifSwidGVtcC1mZS04N2FiNTRiMy0yYzMxLTRkZmItODY4NC0xZjFlNjQ5NjU2Y2EiOnsic2VsZWN0ZWRSYXRpbmciOjAsImZlZWRiYWNrTm90ZSI6IiJ9LCJ0ZW1wLWZlLWUwNzMyMmU2LTgxZDEtNDE0Ni04Yzg2LTNmMjlhNGY1MjA4MCI6eyJzZWxlY3RlZFJhdGluZyI6MCwiZmVlZGJhY2tOb3RlIjoiIn0sInRlbXAtZmUtZTg2MWE4NjYtNDk4MS00ZmNiLTk5YzMtZTNhYjA4YmU2MzJmIjp7InNlbGVjdGVkUmF0aW5nIjowLCJmZWVkYmFja05vdGUiOiIifSwidGVtcC1mZS05M2MwNTYwYi01ODE2LTQyYjgtYjJmZC02NTJlMjFhMWYzMzMiOnsic2VsZWN0ZWRSYXRpbmciOjAsImZlZWRiYWNrTm90ZSI6IiJ9LCJ0ZW1wLWZlLTg1MTY4ZTc3LWQyMGUtNDY4NS04M2UyLWQ2MjEzODEwOTViZSI6eyJzZWxlY3RlZFJhdGluZyI6MCwiZmVlZGJhY2tOb3RlIjoiIn0sInRlbXAtZmUtMzJkYjc5YTAtOGNhZS00MjI0LTk4ZTctYWI3ODcxMDg3NGFiIjp7InNlbGVjdGVkUmF0aW5nIjowLCJmZWVkYmFja05vdGUiOiIifSwidGVtcC1mZS05MmI2ZWY3OS02MDM2LTRmNjUtYjQ0ZS05NWNhZjY2ZTEzMzQiOnsic2VsZWN0ZWRSYXRpbmciOjAsImZlZWRiYWNrTm90ZSI6IiJ9LCJ0ZW1wLWZlLTM0MTI4MWIzLWFiMjEtNGI5MS1iNmRiLWI1NGMwMzFkZDViYyI6eyJzZWxlY3RlZFJhdGluZyI6MCwiZmVlZGJhY2tOb3RlIjoiIn0sInRlbXAtZmUtMDJkMmExZjYtNzNlZC00OGEwLWI5ODYtYTQwOTRkYjk3OTQxIjp7InNlbGVjdGVkUmF0aW5nIjowLCJmZWVkYmFja05vdGUiOiIifSwidGVtcC1mZS1jN2EzYTdjOC1lYmMwLTRlMTYtYTkyZC05YjJjZWM0NDlhNzkiOnsic2VsZWN0ZWRSYXRpbmciOjAsImZlZWRiYWNrTm90ZSI6IiJ9LCJ0ZW1wLWZlLTQ1NWY0NmM4LWRlZjQtNDllNS05ZTIyLWVmNDIyNmM4MzMzNiI6eyJzZWxlY3RlZFJhdGluZyI6MCwiZmVlZGJhY2tOb3RlIjoiIn0sInRlbXAtZmUtM2FlNWVhNDQtNWJiMC00MjlkLWFiMjQtNmI4MzEwZTYxMjZiIjp7InNlbGVjdGVkUmF0aW5nIjowLCJmZWVkYmFja05vdGUiOiIifSwidGVtcC1mZS01MTZlMjgyNC0zNzExLTQxYzUtYTEzMC05NWM3ZTFjZGI0MDYiOnsic2VsZWN0ZWRSYXRpbmciOjAsImZlZWRiYWNrTm90ZSI6IiJ9LCJ0ZW1wLWZlLTliNjQ4NTIzLTY5N2ItNDRiMS1hZjZmLWZmZTZlZGEzODJmZSI6eyJzZWxlY3RlZFJhdGluZyI6MCwiZmVlZGJhY2tOb3RlIjoiIn0sInRlbXAtZmUtZTdjNDM5NWItYzA5Ni00YTRjLWI0YzQtYmMwNzBlYTQ1NWRhIjp7InNlbGVjdGVkUmF0aW5nIjowLCJmZWVkYmFja05vdGUiOiIifSwidGVtcC1mZS1kZDQ0OWU3YS01YjQxLTQ3MjctODA5NC0zZGY2ODY4NzNlOTUiOnsic2VsZWN0ZWRSYXRpbmciOjAsImZlZWRiYWNrTm90ZSI6IiJ9LCJ0ZW1wLWZlLTcxYjA4NzliLWEwYWUtNDY1ZS1iZjQ4LTAxZjJlYmZjNzZjNSI6eyJzZWxlY3RlZFJhdGluZyI6MCwiZmVlZGJhY2tOb3RlIjoiIn0sInRlbXAtZmUtNWUxOTU4MzgtZjBjNC00NmFhLThlYmYtNTg1MWVhOTZhOTViIjp7InNlbGVjdGVkUmF0aW5nIjowLCJmZWVkYmFja05vdGUiOiIifSwidGVtcC1mZS04ZWMyYWY3MS0yMzRkLTRjZDctYWNjZS03NjQ3ODg1YWI2NjgiOnsic2VsZWN0ZWRSYXRpbmciOjAsImZlZWRiYWNrTm90ZSI6IiJ9LCJ0ZW1wLWZlLTkyNDVjNWI1LTc0MWYtNGNhMy1iNGQzLWUyMDczYWEyYzY3NiI6eyJzZWxlY3RlZFJhdGluZyI6MCwiZmVlZGJhY2tOb3RlIjoiIn0sInRlbXAtZmUtZGNiN2I0OTYtYTI3Ny00YjA2LThlOTMtM2IyYzc5NzExY2VkIjp7InNlbGVjdGVkUmF0aW5nIjowLCJmZWVkYmFja05vdGUiOiIifSwidGVtcC1mZS1hOTIyMWU0Yi0zN2Q5LTQ1OGMtODIzOS0wODUzZTliNjM5ZjQiOnsic2VsZWN0ZWRSYXRpbmciOjAsImZlZWRiYWNrTm90ZSI6IiJ9LCJ0ZW1wLWZlLWUyZWUyNDZlLTUyMzYtNDAzMC05YjIzLWVjOGVmZTgzM2ExNiI6eyJzZWxlY3RlZFJhdGluZyI6MCwiZmVlZGJhY2tOb3RlIjoiIn0sInRlbXAtZmUtODI1ZTdmNmQtMmUzZi00ZmNhLTk1MTktZTkwZmFhYmYzM2M2Ijp7InNlbGVjdGVkUmF0aW5nIjowLCJmZWVkYmFja05vdGUiOiIifX0sInRvb2xVc2VTdGF0ZXMiOnsiZGRmYWRhOGYtNzAxYy00Yjc3LThmZmUtNjBjYzAwNDFiZDlhO3Rvb2x1XzAxTHlxS0VvWGthcXBOUU5uc1d3eGs4NyI6eyJwaGFzZSI6NSwicmVzdWx0Ijp7InRleHQiOiJIZXJlJ3MgdGhlIHJlc3VsdCBvZiBydW5uaW5nIGBjYXQgLW5gIG9uIHNyYy9tYWluL2phdmEvZ3VpQ2xpZW50L0xpY2hUcmluaFRhdVBhbmVsLmphdmE6XG4gICAgIDFcdHBhY2thZ2UgZ3VpQ2xpZW50O1xuICAgICAyXHRcbiAgICAgM1x0aW1wb3J0IGNvbS50b2VkdGVyLmNhbGVuZGFyLkpEYXRlQ2hvb3NlcjtcbiAgICAgNFx0aW1wb3J0IGRhby5MaWNoVHJpbmhUYXVEQU87XG4gICAgIDVcdGltcG9ydCBkYW8uVGF1REFPO1xuICAgICA2XHRpbXBvcnQgbW9kZWwuTGljaFRyaW5oVGF1O1xuICAgICA3XHRpbXBvcnQgbW9kZWwuVGF1O1xuICAgICA4XHRpbXBvcnQgbW9kZWwuVHJhbmdUaGFpO1xuICAgICA5XHRpbXBvcnQgc2VydmljZS5BSVRyYXZlbFRpbWVQcmVkaWN0b3I7XG4gICAgMTBcdGltcG9ydCBzZXJ2aWNlLlNjaGVkdWxlU3RhdHVzTWFuYWdlcjtcbiAgICAxMVx0XG4gICAgMTJcdGltcG9ydCBqYXZheC5zd2luZy5ldmVudC5Eb2N1bWVudExpc3RlbmVyO1xuICAgIDEzXHRpbXBvcnQgamF2YXguc3dpbmcuZXZlbnQuRG9jdW1lbnRFdmVudDtcbiAgICAxNFx0aW1wb3J0IGphdmEuYXd0LmV2ZW50LktleUFkYXB0ZXI7XG4gICAgMTVcdGltcG9ydCBqYXZhLmF3dC5ldmVudC5LZXlFdmVudDtcbiAgICAxNlx0aW1wb3J0IGphdmEuYmVhbnMuUHJvcGVydHlDaGFuZ2VMaXN0ZW5lcjtcbiAgICAxN1x0aW1wb3J0IGphdmEudGltZS5mb3JtYXQuRGF0ZVRpbWVQYXJzZUV4Y2VwdGlvbjtcbiAgICAxOFx0aW1wb3J0IGphdmEudXRpbC4qO1xuICAgIDE5XHRpbXBvcnQgamF2YXgubmFtaW5nLkNvbnRleHQ7XG4gICAgMjBcdGltcG9ydCBqYXZheC5uYW1pbmcuSW5pdGlhbENvbnRleHQ7XG4gICAgMjFcdGltcG9ydCBqYXZheC5zd2luZy4qO1xuICAgIDIyXHRpbXBvcnQgamF2YXguc3dpbmcudGFibGUuRGVmYXVsdFRhYmxlQ2VsbFJlbmRlcmVyO1xuICAgIDIzXHRpbXBvcnQgamF2YXguc3dpbmcudGFibGUuRGVmYXVsdFRhYmxlTW9kZWw7XG4gICAgMjRcdGltcG9ydCBqYXZheC5zd2luZy50YWJsZS5KVGFibGVIZWFkZXI7XG4gICAgMjVcdGltcG9ydCBqYXZhLmF3dC4qO1xuICAgIDI2XHRpbXBvcnQgamF2YS5hd3QuZXZlbnQuQWN0aW9uRXZlbnQ7XG4gICAgMjdcdGltcG9ydCBqYXZhLmF3dC5ldmVudC5LZXlBZGFwdGVyO1xuICAgIDI4XHRpbXBvcnQgamF2YS5hd3QuZXZlbnQuS2V5RXZlbnQ7XG4gICAgMjlcdGltcG9ydCBqYXZhLmF3dC5pbWFnZS5CdWZmZXJlZEltYWdlO1xuICAgIDMwXHRpbXBvcnQgamF2YS5ybWkuUmVtb3RlRXhjZXB0aW9uO1xuICAgIDMxXHRpbXBvcnQgamF2YS5ybWkucmVnaXN0cnkuTG9jYXRlUmVnaXN0cnk7XG4gICAgMzJcdGltcG9ydCBqYXZhLnJtaS5yZWdpc3RyeS5SZWdpc3RyeTtcbiAgICAzM1x0aW1wb3J0IGphdmEudGltZS5Mb2NhbERhdGU7XG4gICAgMzRcdGltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlVGltZTtcbiAgICAzNVx0aW1wb3J0IGphdmEudGltZS5Mb2NhbFRpbWU7XG4gICAgMzZcdGltcG9ydCBqYXZhLnRpbWUuWm9uZUlkO1xuICAgIDM3XHRpbXBvcnQgamF2YS50aW1lLmZvcm1hdC5EYXRlVGltZUZvcm1hdHRlcjtcbiAgICAzOFx0aW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7XG4gICAgMzlcdGltcG9ydCBqYXZhLnV0aWwuTGlzdDtcbiAgICA0MFx0aW1wb3J0IGphdmEudXRpbC5sb2dnaW5nLkxldmVsO1xuICAgIDQxXHRpbXBvcnQgamF2YS51dGlsLmxvZ2dpbmcuTG9nZ2VyO1xuICAgIDQyXHRpbXBvcnQgamF2YS51dGlsLnN0cmVhbS5Db2xsZWN0b3JzO1xuICAgIDQzXHRcbiAgICA0NFx0cHVibGljIGNsYXNzIExpY2hUcmluaFRhdVBhbmVsIGV4dGVuZHMgSlBhbmVsIHtcbiAgICA0NVx0XG4gICAgNDZcdCAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2dnZXIgTE9HR0VSID0gTG9nZ2VyLmdldExvZ2dlcihMaWNoVHJpbmhUYXVQYW5lbC5jbGFzcy5nZXROYW1lKCkpO1xuICAgIDQ3XHQgICAgLy8gxJDhu4thIGNo4buJIElQIHbDoCBwb3J0IGPhu6dhIFJNSSBzZXJ2ZXJcbiAgICA0OFx0ICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyBSTUlfU0VSVkVSX0lQID0gXCIxMjcuMC4wLjFcIjtcbiAgICA0OVx0ICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIGludCBSTUlfU0VSVkVSX1BPUlQgPSA5MDkwO1xuICAgIDUwXHQgICAgcHJpdmF0ZSBKVGFibGUgc2NoZWR1bGVUYWJsZTtcbiAgICA1MVx0ICAgIHByaXZhdGUgRGVmYXVsdFRhYmxlTW9kZWwgdGFibGVNb2RlbDtcbiAgICA1Mlx0ICAgIHByaXZhdGUgSkRhdGVDaG9vc2VyIGRhdGVDaG9vc2VyO1xuICAgIDUzXHQgICAgcHJpdmF0ZSBKQnV0dG9uIHNlYXJjaEJ1dHRvbjtcbiAgICA1NFx0ICAgIHByaXZhdGUgSkJ1dHRvbiByZWZyZXNoQnV0dG9uO1xuICAgIDU1XHQgICAgcHJpdmF0ZSBKQnV0dG9uIGFkZEJ1dHRvbjtcbiAgICA1Nlx0ICAgIHByaXZhdGUgSkJ1dHRvbiBlZGl0QnV0dG9uO1xuICAgIDU3XHQgICAgcHJpdmF0ZSBKQnV0dG9uIGRlbGV0ZUJ1dHRvbjtcbiAgICA1OFx0ICAgIHByaXZhdGUgSkNvbWJvQm94PE9iamVjdD4gZmlsdGVyQ29tYm9Cb3g7XG4gICAgNTlcdCAgICBwcml2YXRlIEpUYWJiZWRQYW5lIHZpZXdUYWJiZWRQYW5lOyAvLyBUYWIgxJHhu4MgY2h1eeG7g24gxJHhu5VpIGdp4buvYSBk4bqhbmcgYuG6o25nIHbDoCBs4buLY2hcbiAgICA2MFx0ICAgIHByaXZhdGUgVHJhaW5TY2hlZHVsZUNhbGVuZGFyUGFuZWwgY2FsZW5kYXJQYW5lbDsgLy8gUGFuZWwgZOG6oW5nIGzhu4tjaFxuICAgIDYxXHQgICAgcHJpdmF0ZSBKUGFuZWwgdGFibGVWaWV3UGFuZWw7IC8vIFBhbmVsIGNo4bupYSBi4bqjbmdcbiAgICA2Mlx0XG4gICAgNjNcdCAgICBwcml2YXRlIExpY2hUcmluaFRhdURBTyBsaWNoVHJpbmhUYXVEQU87XG4gICAgNjRcdCAgICBwcml2YXRlIGJvb2xlYW4gaXNDb25uZWN0ZWQgPSBmYWxzZTtcbiAgICA2NVx0ICAgIHByaXZhdGUgc3RhdGljIExvY2FsRGF0ZSBsYXN0R2VuZXJhdGVkRGF0ZSA9IExvY2FsRGF0ZS5ub3coKTtcbiAgICA2Nlx0ICAgIHByaXZhdGUgc3RhdGljIGludCBjb3VudCA9IDA7XG4gICAgNjdcdCAgICBwcml2YXRlIFNjaGVkdWxlU3RhdHVzTWFuYWdlciBzdGF0dXNNYW5hZ2VyO1xuICAgIDY4XHQgICAgcHJpdmF0ZSBBSVRyYXZlbFRpbWVQcmVkaWN0b3IgYWlQcmVkaWN0b3I7XG4gICAgNjlcdCAgICBwcml2YXRlIENoYXRib3REaWFsb2cgY2hhdGJvdERpYWxvZztcbiAgICA3MFx0XG4gICAgNzFcdCAgICBwdWJsaWMgTGljaFRyaW5oVGF1UGFuZWwoKSB7XG4gICAgNzJcdCAgICAgICAgc2V0TGF5b3V0KG5ldyBCb3JkZXJMYXlvdXQoMTAsIDEwKSk7XG4gICAgNzNcdCAgICAgICAgc2V0Qm9yZGVyKEJvcmRlckZhY3RvcnkuY3JlYXRlRW1wdHlCb3JkZXIoMTAsIDEwLCAxMCwgMTApKTtcbiAgICA3NFx0XG4gICAgNzVcdCAgICAgICAgLy8gQ29ubmVjdCB0byBSTUkgc2VydmVyXG4gICAgNzZcdCAgICAgICAgY29ubmVjdFRvUk1JU2VydmVyKCk7XG4gICAgNzdcdFxuICAgIDc4XHQgICAgICAgIC8vIEFkZCBjb21wb25lbnRzIHRvIHRoZSBwYW5lbFxuICAgIDc5XHQgICAgICAgIGFkZChjcmVhdGVUaXRsZVBhbmVsKCksIEJvcmRlckxheW91dC5OT1JUSCk7XG4gICAgODBcdCAgICAgICAgYWRkKGNyZWF0ZUNlbnRlclBhbmVsKCksIEJvcmRlckxheW91dC5DRU5URVIpO1xuICAgIDgxXHRcbiAgICA4Mlx0ICAgICAgICAvLyBMb2FkIGluaXRpYWwgZGF0YVxuICAgIDgzXHQgICAgICAgIGlmIChpc0Nvbm5lY3RlZCkge1xuICAgIDg0XHQgICAgICAgICAgICB0cnkge1xuICAgIDg1XHQgICAgICAgICAgICAgICAgaW5pdFN0YXR1c01hbmFnZXIoKTtcbiAgICA4Nlx0ICAgICAgICAgICAgICAgIGxvYWRBbGxTY2hlZHVsZURhdGEoKTtcbiAgICA4N1x0ICAgICAgICAgICAgICAgIHRoaXMuYWlQcmVkaWN0b3IgPSBBSVRyYXZlbFRpbWVQcmVkaWN0b3IuZ2V0SW5zdGFuY2UoKTtcbiAgICA4OFx0ICAgICAgICAgICAgfSBjYXRjaCAoUmVtb3RlRXhjZXB0aW9uIGV4KSB7XG4gICAgODlcdCAgICAgICAgICAgICAgICBMT0dHRVIubG9nKExldmVsLlNFVkVSRSwgXCJFcnJvciBsb2FkaW5nIHNjaGVkdWxlIGRhdGFcIiwgZXgpO1xuICAgIDkwXHQgICAgICAgICAgICAgICAgc2hvd0Vycm9yTWVzc2FnZShcIktow7RuZyB0aOG7gyB04bqjaSBk4buvIGxp4buHdSBs4buLY2ggdHLDrG5oXCIsIGV4KTtcbiAgICA5MVx0ICAgICAgICAgICAgfVxuICAgIDkyXHQgICAgICAgIH0gZWxzZSB7XG4gICAgOTNcdCAgICAgICAgICAgIHNob3dFcnJvck1lc3NhZ2UoXCJLaMO0bmcgdGjhu4Mga+G6v3QgbuG7kWkgxJHhur9uIG3DoXkgY2jhu6dcIiwgbnVsbCk7XG4gICAgOTRcdCAgICAgICAgfVxuICAgIDk1XHQgICAgICAgIGxvYWREYXRhSW5CYWNrZ3JvdW5kKCk7XG4gICAgOTZcdCAgICB9XG4gICAgOTdcdFxuICAgIDk4XHQgICAgcHJpdmF0ZSB2b2lkIGxvYWREYXRhSW5CYWNrZ3JvdW5kKCkge1xuICAgIDk5XHQgICAgICAgIFN3aW5nV29ya2VyPEJvb2xlYW4sIFZvaWQ+IHdvcmtlciA9IG5ldyBTd2luZ1dvcmtlcjw+KCkge1xuICAgMTAwXHQgICAgICAgICAgICBAT3ZlcnJpZGVcbiAgIDEwMVx0ICAgICAgICAgICAgcHJvdGVjdGVkIEJvb2xlYW4gZG9JbkJhY2tncm91bmQoKSB0aHJvd3MgRXhjZXB0aW9uIHtcbiAgIDEwMlx0ICAgICAgICAgICAgICAgIC8vIEvhur90IG7hu5FpIMSR4bq/biBSTUkgc2VydmVyXG4gICAxMDNcdCAgICAgICAgICAgICAgICBjb25uZWN0VG9STUlTZXJ2ZXIoKTtcbiAgIDEwNFx0ICAgICAgICAgICAgICAgIHJldHVybiBpc0Nvbm5lY3RlZDtcbiAgIDEwNVx0ICAgICAgICAgICAgfVxuICAgMTA2XHRcbiAgIDEwN1x0ICAgICAgICAgICAgQE92ZXJyaWRlXG4gICAxMDhcdCAgICAgICAgICAgIHByb3RlY3RlZCB2b2lkIGRvbmUoKSB7XG4gICAxMDlcdCAgICAgICAgICAgICAgICB0cnkge1xuICAgMTEwXHQgICAgICAgICAgICAgICAgICAgIGJvb2xlYW4gY29ubmVjdGVkID0gZ2V0KCk7XG4gICAxMTFcdCAgICAgICAgICAgICAgICAgICAgaWYgKGNvbm5lY3RlZCkge1xuICAgMTEyXHQgICAgICAgICAgICAgICAgICAgICAgICAvLyBYw7NhIHRow7RuZyBiw6FvIFwixJFhbmcgdOG6o2lcIlxuICAgMTEzXHQgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZU1vZGVsLnNldFJvd0NvdW50KDApO1xuICAgMTE0XHQgICAgICAgICAgICAgICAgICAgICAgICAvLyBU4bqjaSBk4buvIGxp4buHdSBs4buLY2ggdHLDrG5oXG4gICAxMTVcdCAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRBbGxTY2hlZHVsZURhdGEoKTtcbiAgIDExNlx0XG4gICAxMTdcdCAgICAgICAgICAgICAgICAgICAgICAgIC8vIEto4bufaSB04bqhbyB0csOsbmggcXXhuqNuIGzDvSB0cuG6oW5nIHRow6FpXG4gICAxMThcdCAgICAgICAgICAgICAgICAgICAgICAgIGluaXRTdGF0dXNNYW5hZ2VyKCk7XG4gICAxMTlcdCAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgIDEyMFx0ICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVNb2RlbC5zZXRSb3dDb3VudCgwKTtcbiAgIDEyMVx0ICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVNb2RlbC5hZGRSb3cobmV3IE9iamVjdFtde1wiS2jDtG5nIHRo4buDIGvhur90IG7hu5FpIMSR4bq/biBtw6F5IGNo4bunXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCJ9KTtcbiAgIDEyMlx0ICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0Vycm9yTWVzc2FnZShcIktow7RuZyB0aOG7gyBr4bq/dCBu4buRaSDEkeG6v24gbcOheSBjaOG7p1wiLCBudWxsKTtcbiAgIDEyM1x0ICAgICAgICAgICAgICAgICAgICB9XG4gICAxMjRcdCAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgMTI1XHQgICAgICAgICAgICAgICAgICAgIExPR0dFUi5sb2coTGV2ZWwuU0VWRVJFLCBcIkVycm9yIGxvYWRpbmcgc2NoZWR1bGUgZGF0YVwiLCBlKTtcbiAgIDEyNlx0ICAgICAgICAgICAgICAgICAgICB0YWJsZU1vZGVsLnNldFJvd0NvdW50KDApO1xuICAgMTI3XHQgICAgICAgICAgICAgICAgICAgIHRhYmxlTW9kZWwuYWRkUm93KG5ldyBPYmplY3RbXXtcIkzhu5dpOiBcIiArIGUuZ2V0TWVzc2FnZSgpLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwifSk7XG4gICAxMjhcdCAgICAgICAgICAgICAgICAgICAgc2hvd0Vycm9yTWVzc2FnZShcIktow7RuZyB0aOG7gyB04bqjaSBk4buvIGxp4buHdSBs4buLY2ggdHLDrG5oXCIsIGUpO1xuICAgMTI5XHQgICAgICAgICAgICAgICAgfVxuICAgMTMwXHQgICAgICAgICAgICB9XG4gICAxMzFcdCAgICAgICAgfTtcbiAgIDEzMlx0XG4gICAxMzNcdCAgICAgICAgd29ya2VyLmV4ZWN1dGUoKTtcbiAgIDEzNFx0ICAgIH1cbiAgIDEzNVx0XG4gICAxMzZcdCAgICBwcml2YXRlIHZvaWQgaW5pdFN0YXR1c01hbmFnZXIoKSB7XG4gICAxMzdcdCAgICAgICAgaWYgKGlzQ29ubmVjdGVkICYmIGxpY2hUcmluaFRhdURBTyAhPSBudWxsKSB7XG4gICAxMzhcdCAgICAgICAgICAgIC8vIFThuqFvIGNhbGxiYWNrIGzDoG0gbeG7m2kgZOG7ryBsaeG7h3VcbiAgIDEzOVx0ICAgICAgICAgICAgUnVubmFibGUgcmVmcmVzaENhbGxiYWNrID0gdGhpczo6cmVmcmVzaERhdGFBZnRlclVwZGF0ZTtcbiAgIDE0MFx0XG4gICAxNDFcdCAgICAgICAgICAgIC8vIEto4bufaSB04bqhbyB0csOsbmggcXXhuqNuIGzDvSB0cuG6oW5nIHRow6FpXG4gICAxNDJcdCAgICAgICAgICAgIHN0YXR1c01hbmFnZXIgPSBuZXcgU2NoZWR1bGVTdGF0dXNNYW5hZ2VyKGxpY2hUcmluaFRhdURBTywgcmVmcmVzaENhbGxiYWNrKTtcbiAgIDE0M1x0XG4gICAxNDRcdCAgICAgICAgICAgIExPR0dFUi5pbmZvKFwixJDDoyBraOG7n2kgdOG6oW8gdHLDrG5oIHF14bqjbiBsw70gY+G6rXAgbmjhuq10IHRy4bqhbmcgdGjDoWkgdOG7sSDEkeG7mW5nXCIpO1xuICAgMTQ1XHQgICAgICAgIH1cbiAgIDE0Nlx0ICAgIH1cbiAgIDE0N1x0ICAgIHByaXZhdGUgdm9pZCByZWZyZXNoRGF0YUFmdGVyVXBkYXRlKCkge1xuICAgMTQ4XHQgICAgICAgIHRyeSB7XG4gICAxNDlcdCAgICAgICAgICAgIC8vIEzDoG0gbeG7m2kgZOG7ryBsaeG7h3UgdHLDqm4gZ2lhbyBkaeG7h24gbcOgIGtow7RuZyBn4buNaSBj4bqtcCBuaOG6rXQgdHLhuqFuZyB0aMOhaSBs4bqhaVxuICAgMTUwXHQgICAgICAgICAgICBsb2FkRGF0YVdpdGhvdXRTdGF0dXNDaGVjaygpO1xuICAgMTUxXHRcbiAgIDE1Mlx0ICAgICAgICAgICAgLy8gSGnhu4NuIHRo4buLIHRow7RuZyBiw6FvIG5o4buPICh0w7l5IGNo4buNbilcbiAgIDE1M1x0ICAgICAgICAgICAgc2hvd05vdGlmaWNhdGlvbihcIsSQw6MgY+G6rXAgbmjhuq10IHRy4bqhbmcgdGjDoWkgY8OhYyBs4buLY2ggdHLDrG5oIHTDoHVcIik7XG4gICAxNTRcdFxuICAgMTU1XHQgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBleCkge1xuICAgMTU2XHQgICAgICAgICAgICBMT0dHRVIubG9nKExldmVsLlNFVkVSRSwgXCJM4buXaSBraGkgbMOgbSBt4bubaSBk4buvIGxp4buHdSBzYXUga2hpIGPhuq1wIG5o4bqtdCB0cuG6oW5nIHRow6FpXCIsIGV4KTtcbiAgIDE1N1x0ICAgICAgICB9XG4gICAxNThcdCAgICB9XG4gICAxNTlcdFxuICAgMTYwXHQgICAgcHJpdmF0ZSB2b2lkIGxvYWREYXRhV2l0aG91dFN0YXR1c0NoZWNrKCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAxNjFcdCAgICAgICAgaWYgKCFpc0Nvbm5lY3RlZCB8fCBsaWNoVHJpbmhUYXVEQU8gPT0gbnVsbCkge1xuICAgMTYyXHQgICAgICAgICAgICBjb25uZWN0VG9STUlTZXJ2ZXIoKTtcbiAgIDE2M1x0ICAgICAgICAgICAgaWYgKCFpc0Nvbm5lY3RlZCkge1xuICAgMTY0XHQgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFJlbW90ZUV4Y2VwdGlvbihcIk5vdCBjb25uZWN0ZWQgdG8gUk1JIHNlcnZlclwiKTtcbiAgIDE2NVx0ICAgICAgICAgICAgfVxuICAgMTY2XHQgICAgICAgIH1cbiAgIDE2N1x0XG4gICAxNjhcdCAgICAgICAgdGFibGVNb2RlbC5zZXRSb3dDb3VudCgwKTtcbiAgIDE2OVx0XG4gICAxNzBcdCAgICAgICAgdHJ5IHtcbiAgIDE3MVx0ICAgICAgICAgICAgTGlzdDxMaWNoVHJpbmhUYXU+IHNjaGVkdWxlcyA9IGxpY2hUcmluaFRhdURBTy5nZXRBbGxMaXN0KCk7XG4gICAxNzJcdFxuICAgMTczXHQgICAgICAgICAgICBpZiAoc2NoZWR1bGVzID09IG51bGwgfHwgc2NoZWR1bGVzLmlzRW1wdHkoKSkge1xuICAgMTc0XHQgICAgICAgICAgICAgICAgTE9HR0VSLmluZm8oXCJLaMO0bmcgY8OzIGzhu4tjaCB0csOsbmggbsOgbyDEkeG7gyBoaeG7g24gdGjhu4suXCIpO1xuICAgMTc1XHQgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgMTc2XHQgICAgICAgICAgICB9XG4gICAxNzdcdFxuICAgMTc4XHQgICAgICAgICAgICAvLyBM4buNYyB2w6AgaGnhu4NuIHRo4buLIGThu68gbGnhu4d1IHRoZW8gYuG7mSBs4buNYyBoaeG7h24gdOG6oWlcbiAgIDE3OVx0ICAgICAgICAgICAgU3RyaW5nIGZpbHRlck9wdGlvbiA9IGZpbHRlckNvbWJvQm94LmdldFNlbGVjdGVkSXRlbSgpLnRvU3RyaW5nKCk7XG4gICAxODBcdCAgICAgICAgICAgIGZvciAoTGljaFRyaW5oVGF1IHNjaGVkdWxlIDogc2NoZWR1bGVzKSB7XG4gICAxODFcdCAgICAgICAgICAgICAgICBpZiAobWF0Y2hlc0ZpbHRlcihzY2hlZHVsZSwgZmlsdGVyT3B0aW9uKSkge1xuICAgMTgyXHQgICAgICAgICAgICAgICAgICAgIHRhYmxlTW9kZWwuYWRkUm93KGNyZWF0ZVRhYmxlUm93KHNjaGVkdWxlKSk7XG4gICAxODNcdCAgICAgICAgICAgICAgICB9XG4gICAxODRcdCAgICAgICAgICAgIH1cbiAgIDE4NVx0XG4gICAxODZcdCAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgIDE4N1x0ICAgICAgICAgICAgTE9HR0VSLmxvZyhMZXZlbC5TRVZFUkUsIFwiTOG7l2kgY2hpIHRp4bq/dCBraGkgdOG6o2kgZOG7ryBsaeG7h3U6IFwiICsgZS5nZXRNZXNzYWdlKCksIGUpO1xuICAgMTg4XHQgICAgICAgICAgICB0aHJvdyBuZXcgUmVtb3RlRXhjZXB0aW9uKFwiTOG7l2kga2hpIHThuqNpIGThu68gbGnhu4d1OiBcIiArIGUuZ2V0TWVzc2FnZSgpLCBlKTtcbiAgIDE4OVx0ICAgICAgICB9XG4gICAxOTBcdCAgICB9XG4gICAxOTFcdFxuICAgMTkyXHQgICAgLyoqXG4gICAxOTNcdCAgICAgKiBIaeG7g24gdGjhu4sgdGjDtG5nIGLDoW8gbmjhu48g4bufIGfDs2MgbcOgbiBow6xuaFxuICAgMTk0XHQgICAgICovXG4gICAxOTVcdCAgICBwcml2YXRlIHZvaWQgc2hvd05vdGlmaWNhdGlvbihTdHJpbmcgbWVzc2FnZSkge1xuICAgMTk2XHQgICAgICAgIC8vIELhuqFuIGPDsyB0aOG7gyB0cmnhu4NuIGtoYWkgbeG7mXQgdGjDtG5nIGLDoW8gbmjhu48g4bufIGfDs2MgbcOgbiBow6xuaFxuICAgMTk3XHQgICAgICAgIC8vIGhv4bq3YyBj4bqtcCBuaOG6rXQgbeG7mXQgbGFiZWwgdHLhuqFuZyB0aMOhaSB0csOqbiBnaWFvIGRp4buHblxuICAgMTk4XHQgICAgfVxuICAgMTk5XHRcbiAgIDIwMFx0ICAgIHByaXZhdGUgSlBhbmVsIGNyZWF0ZVRpdGxlUGFuZWwoKSB7XG4gICAyMDFcdCAgICAgICAgSlBhbmVsIHBhbmVsID0gbmV3IEpQYW5lbChuZXcgQm9yZGVyTGF5b3V0KCkpO1xuICAgMjAyXHRcbiAgIDIwM1x0ICAgICAgICBKTGFiZWwgdGl0bGVMYWJlbCA9IG5ldyBKTGFiZWwoXCJRVeG6ok4gTMOdIEzhu4pDSCBUUsOMTkggVMOAVVwiLCBKTGFiZWwuQ0VOVEVSKTtcbiAgIDIwNFx0ICAgICAgICB0aXRsZUxhYmVsLnNldEZvbnQobmV3IEZvbnQoXCJBcmlhbFwiLCBGb250LkJPTEQsIDIwKSk7XG4gICAyMDVcdCAgICAgICAgdGl0bGVMYWJlbC5zZXRGb3JlZ3JvdW5kKG5ldyBDb2xvcig0MSwgMTI4LCAxODUpKTtcbiAgIDIwNlx0ICAgICAgICB0aXRsZUxhYmVsLnNldEJvcmRlcihCb3JkZXJGYWN0b3J5LmNyZWF0ZUVtcHR5Qm9yZGVyKDAsIDAsIDEwLCAwKSk7XG4gICAyMDdcdFxuICAgMjA4XHQgICAgICAgIHBhbmVsLmFkZCh0aXRsZUxhYmVsLCBCb3JkZXJMYXlvdXQuQ0VOVEVSKTtcbiAgIDIwOVx0ICAgICAgICByZXR1cm4gcGFuZWw7XG4gICAyMTBcdCAgICB9XG4gICAyMTFcdFxuICAgMjEyXHQgICAgcHJpdmF0ZSBKUGFuZWwgY3JlYXRlQ2VudGVyUGFuZWwoKSB7XG4gICAyMTNcdCAgICAgICAgSlBhbmVsIHBhbmVsID0gbmV3IEpQYW5lbChuZXcgQm9yZGVyTGF5b3V0KDEwLCAxMCkpO1xuICAgMjE0XHRcbiAgIDIxNVx0ICAgICAgICBwYW5lbC5hZGQoY3JlYXRlU2VhcmNoUGFuZWwoKSwgQm9yZGVyTGF5b3V0Lk5PUlRIKTtcbiAgIDIxNlx0XG4gICAyMTdcdCAgICAgICAgLy8gVOG6oW8gVGFiYmVkUGFuZSDEkeG7gyBjaOG7qWEgY+G6oyBjaOG6vyDEkeG7mSB4ZW0gYuG6o25nIHbDoCBs4buLY2hcbiAgIDIxOFx0ICAgICAgICB2aWV3VGFiYmVkUGFuZSA9IG5ldyBKVGFiYmVkUGFuZSgpO1xuICAgMjE5XHRcbiAgIDIyMFx0ICAgICAgICAvLyBU4bqhbyBwYW5lbCBjaOG6vyDEkeG7mSB4ZW0gYuG6o25nXG4gICAyMjFcdCAgICAgICAgdGFibGVWaWV3UGFuZWwgPSBuZXcgSlBhbmVsKG5ldyBCb3JkZXJMYXlvdXQoKSk7XG4gICAyMjJcdCAgICAgICAgdGFibGVWaWV3UGFuZWwuYWRkKGNyZWF0ZVRhYmxlUGFuZWwoKSwgQm9yZGVyTGF5b3V0LkNFTlRFUik7XG4gICAyMjNcdCAgICAgICAgY2FsZW5kYXJQYW5lbCA9IG5ldyBUcmFpblNjaGVkdWxlQ2FsZW5kYXJQYW5lbChpc0Nvbm5lY3RlZCA/IGxpY2hUcmluaFRhdURBTyA6IG51bGwpO1xuICAgMjI0XHQgICAgICAgIC8vIE7hur91IMSRw6Mga+G6v3QgbuG7kWksIHThuqFvIHBhbmVsIGzhu4tjaFxuICAgMjI1XHQgICAgICAgIGlmIChpc0Nvbm5lY3RlZCAmJiBsaWNoVHJpbmhUYXVEQU8gIT0gbnVsbCkge1xuICAgMjI2XHQgICAgICAgICAgICAvLyBUaGnhur90IGzhuq1wIGxpc3RlbmVyIGNobyBz4buxIGtp4buHbiBjbGljayBuZ8OgeVxuICAgMjI3XHQgICAgICAgICAgICBjYWxlbmRhclBhbmVsLnNldERheVBhbmVsQ2xpY2tMaXN0ZW5lcigoZGF0ZSwgc2NoZWR1bGVzKSAtPiB7XG4gICAyMjhcdCAgICAgICAgICAgICAgICAvLyBIaeG7g24gdGjhu4sgZGFuaCBzw6FjaCBs4buLY2ggdHLDrG5oIGPhu6dhIG5nw6B5IMSRxrDhu6NjIGNo4buNblxuICAgMjI5XHQgICAgICAgICAgICAgICAgaWYgKCFzY2hlZHVsZXMuaXNFbXB0eSgpKSB7XG4gICAyMzBcdCAgICAgICAgICAgICAgICAgICAgc2hvd1NjaGVkdWxlRGV0YWlsc0RpYWxvZyhkYXRlLCBzY2hlZHVsZXMpO1xuICAgMjMxXHQgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgIDIzMlx0ICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyh0aGlzLFxuICAgMjMzXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJLaMO0bmcgY8OzIGzhu4tjaCB0csOsbmggbsOgbyBjaG8gbmfDoHkgXCIgKyBkYXRlLFxuICAgMjM0XHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJUaMO0bmcgdGluXCIsXG4gICAyMzVcdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5JTkZPUk1BVElPTl9NRVNTQUdFKTtcbiAgIDIzNlx0ICAgICAgICAgICAgICAgIH1cbiAgIDIzN1x0ICAgICAgICAgICAgfSk7XG4gICAyMzhcdCAgICAgICAgfSBlbHNlIHtcbiAgIDIzOVx0ICAgICAgICAgICAgLy8gU+G7rSBk4bulbmcgVHJhaW5TY2hlZHVsZUNhbGVuZGFyUGFuZWwgdGhheSB2w6wgSlBhbmVsXG4gICAyNDBcdCAgICAgICAgICAgIGNhbGVuZGFyUGFuZWwgPSBuZXcgVHJhaW5TY2hlZHVsZUNhbGVuZGFyUGFuZWwobnVsbCk7XG4gICAyNDFcdFxuICAgMjQyXHQgICAgICAgICAgICAvLyBUaMOqbSBuaMOjbiBs4buXaSB2w6BvIHBhbmVsXG4gICAyNDNcdCAgICAgICAgICAgIEpMYWJlbCBlcnJvckxhYmVsID0gbmV3IEpMYWJlbChcIktow7RuZyB0aOG7gyBr4bq/dCBu4buRaSDEkeG6v24gc2VydmVyIMSR4buDIGhp4buDbiB0aOG7iyBs4buLY2hcIik7XG4gICAyNDRcdCAgICAgICAgICAgIGVycm9yTGFiZWwuc2V0SG9yaXpvbnRhbEFsaWdubWVudChKTGFiZWwuQ0VOVEVSKTtcbiAgIDI0NVx0ICAgICAgICAgICAgZXJyb3JMYWJlbC5zZXRGb3JlZ3JvdW5kKENvbG9yLlJFRCk7XG4gICAyNDZcdCAgICAgICAgICAgIGNhbGVuZGFyUGFuZWwucmVtb3ZlQWxsKCk7IC8vIFjDs2EgdOG6pXQgY+G6oyB0aMOgbmggcGjhuqduIGtow6FjXG4gICAyNDdcdCAgICAgICAgICAgIGNhbGVuZGFyUGFuZWwuc2V0TGF5b3V0KG5ldyBCb3JkZXJMYXlvdXQoKSk7XG4gICAyNDhcdCAgICAgICAgICAgIGNhbGVuZGFyUGFuZWwuYWRkKGVycm9yTGFiZWwsIEJvcmRlckxheW91dC5DRU5URVIpO1xuICAgMjQ5XHQgICAgICAgIH1cbiAgIDI1MFx0XG4gICAyNTFcdCAgICAgICAgLy8gVGjDqm0gY8OhYyB0YWIgdsOgbyBUYWJiZWRQYW5lXG4gICAyNTJcdCAgICAgICAgdmlld1RhYmJlZFBhbmUuYWRkVGFiKFwiROG6oW5nIELhuqNuZ1wiLCBuZXcgSW1hZ2VJY29uKCksIHRhYmxlVmlld1BhbmVsLCBcIkhp4buDbiB0aOG7iyBk4bqhbmcgYuG6o25nXCIpO1xuICAgMjUzXHQgICAgICAgIHZpZXdUYWJiZWRQYW5lLmFkZFRhYihcIkThuqFuZyBM4buLY2hcIiwgbmV3IEltYWdlSWNvbigpLCBjYWxlbmRhclBhbmVsLCBcIkhp4buDbiB0aOG7iyBk4bqhbmcgbOG7i2NoXCIpO1xuICAgMjU0XHRcbiAgIDI1NVx0ICAgICAgICBwYW5lbC5hZGQodmlld1RhYmJlZFBhbmUsIEJvcmRlckxheW91dC5DRU5URVIpO1xuICAgMjU2XHQgICAgICAgIHBhbmVsLmFkZChjcmVhdGVBY3Rpb25QYW5lbCgpLCBCb3JkZXJMYXlvdXQuU09VVEgpO1xuICAgMjU3XHRcbiAgIDI1OFx0ICAgICAgICByZXR1cm4gcGFuZWw7XG4gICAyNTlcdCAgICB9XG4gICAyNjBcdCAgICAvLyBIaeG7h24gaOG7mXAgdGhv4bqhaSBjaGkgdGnhur90IGzhu4tjaCB0csOsbmgga2hpIGNsaWNrIHbDoG8gbeG7mXQgbmfDoHkgdHJvbmcgbOG7i2NoXG4gICAyNjFcdCAgICBwcml2YXRlIHZvaWQgc2hvd1NjaGVkdWxlRGV0YWlsc0RpYWxvZyhMb2NhbERhdGUgZGF0ZSwgTGlzdDxMaWNoVHJpbmhUYXU+IHNjaGVkdWxlcykge1xuICAgMjYyXHQgICAgICAgIEpEaWFsb2cgZGlhbG9nID0gbmV3IEpEaWFsb2coKTtcbiAgIDI2M1x0ICAgICAgICBkaWFsb2cuc2V0VGl0bGUoXCJM4buLY2ggdHLDrG5oIG5nw6B5IFwiICsgZGF0ZSk7XG4gICAyNjRcdCAgICAgICAgZGlhbG9nLnNldFNpemUoODAwLCA0MDApO1xuICAgMjY1XHQgICAgICAgIGRpYWxvZy5zZXRMb2NhdGlvblJlbGF0aXZlVG8odGhpcyk7XG4gICAyNjZcdCAgICAgICAgZGlhbG9nLnNldE1vZGFsKHRydWUpO1xuICAgMjY3XHQgICAgICAgIGRpYWxvZy5zZXRMYXlvdXQobmV3IEJvcmRlckxheW91dCgpKTtcbiAgIDI2OFx0XG4gICAyNjlcdCAgICAgICAgLy8gVOG6oW8gcGFuZWwgY2jhu6lhIGLhuqNuZyBs4buLY2ggdHLDrG5oXG4gICAyNzBcdCAgICAgICAgSlBhbmVsIGNvbnRlbnRQYW5lbCA9IG5ldyBKUGFuZWwobmV3IEJvcmRlckxheW91dCgpKTtcbiAgIDI3MVx0ICAgICAgICBjb250ZW50UGFuZWwuc2V0Qm9yZGVyKEJvcmRlckZhY3RvcnkuY3JlYXRlRW1wdHlCb3JkZXIoMTAsIDEwLCAxMCwgMTApKTtcbiAgIDI3Mlx0XG4gICAyNzNcdCAgICAgICAgLy8gVOG6oW8gbW9kZWwgY2hvIGLhuqNuZyBs4buLY2ggdHLDrG5oXG4gICAyNzRcdCAgICAgICAgRGVmYXVsdFRhYmxlTW9kZWwgbW9kZWwgPSBuZXcgRGVmYXVsdFRhYmxlTW9kZWwoKTtcbiAgIDI3NVx0ICAgICAgICBtb2RlbC5hZGRDb2x1bW4oXCJNw6MgbOG7i2NoIHRyw6xuaFwiKTtcbiAgIDI3Nlx0ICAgICAgICBtb2RlbC5hZGRDb2x1bW4oXCJUw6B1XCIpO1xuICAgMjc3XHQgICAgICAgIG1vZGVsLmFkZENvbHVtbihcIlR1eeG6v24gxJHGsOG7nW5nXCIpO1xuICAgMjc4XHQgICAgICAgIG1vZGVsLmFkZENvbHVtbihcIkdp4budIMSRaVwiKTtcbiAgIDI3OVx0ICAgICAgICBtb2RlbC5hZGRDb2x1bW4oXCJHaeG7nSDEkeG6v24gKGThu7Ega2nhur9uKVwiKTtcbiAgIDI4MFx0ICAgICAgICBtb2RlbC5hZGRDb2x1bW4oXCJUcuG6oW5nIHRow6FpXCIpO1xuICAgMjgxXHRcbiAgIDI4Mlx0ICAgICAgICAvLyBUaMOqbSBk4buvIGxp4buHdSB2w6BvIGLhuqNuZ1xuICAgMjgzXHQgICAgICAgIGZvciAoTGljaFRyaW5oVGF1IGxpY2hUcmluaCA6IHNjaGVkdWxlcykge1xuICAgMjg0XHQgICAgICAgICAgICBtb2RlbC5hZGRSb3cobmV3IE9iamVjdFtde1xuICAgMjg1XHQgICAgICAgICAgICAgICAgICAgIGxpY2hUcmluaC5nZXRNYUxpY2goKSxcbiAgIDI4Nlx0ICAgICAgICAgICAgICAgICAgICBsaWNoVHJpbmguZ2V0VGF1KCkuZ2V0TWFUYXUoKSArIFwiIC0gXCIgKyBsaWNoVHJpbmguZ2V0VGF1KCkuZ2V0VGVuVGF1KCksXG4gICAyODdcdCAgICAgICAgICAgICAgICAgICAgbGljaFRyaW5oLmdldFRhdSgpLmdldFR1eWVuVGF1KCkuZ2V0R2FEaSgpICsgXCIgLSBcIiArIGxpY2hUcmluaC5nZXRUYXUoKS5nZXRUdXllblRhdSgpLmdldEdhRGVuKCksXG4gICAyODhcdCAgICAgICAgICAgICAgICAgICAgbGljaFRyaW5oLmdldEdpb0RpKCkudG9TdHJpbmcoKSxcbiAgIDI4OVx0ICAgICAgICAgICAgICAgICAgICBsaWNoVHJpbmguZ2V0R2lvRGkoKS5wbHVzSG91cnMoZXN0aW1hdGVUcmF2ZWxUaW1lKGxpY2hUcmluaCkpLnRvU3RyaW5nKCksXG4gICAyOTBcdCAgICAgICAgICAgICAgICAgICAgbGljaFRyaW5oLmdldFRyYW5nVGhhaSgpXG4gICAyOTFcdCAgICAgICAgICAgIH0pO1xuICAgMjkyXHQgICAgICAgIH1cbiAgIDI5M1x0XG4gICAyOTRcdCAgICAgICAgLy8gVOG6oW8gYuG6o25nIGhp4buDbiB0aOG7iyBs4buLY2ggdHLDrG5oXG4gICAyOTVcdCAgICAgICAgSlRhYmxlIHNjaGVkdWxlVGFibGUgPSBuZXcgSlRhYmxlKG1vZGVsKTtcbiAgIDI5Nlx0ICAgICAgICBzY2hlZHVsZVRhYmxlLnNldFJvd0hlaWdodCgyNSk7XG4gICAyOTdcdCAgICAgICAgc2NoZWR1bGVUYWJsZS5zZXRTZWxlY3Rpb25Nb2RlKExpc3RTZWxlY3Rpb25Nb2RlbC5TSU5HTEVfU0VMRUNUSU9OKTtcbiAgIDI5OFx0ICAgICAgICBzY2hlZHVsZVRhYmxlLmdldFRhYmxlSGVhZGVyKCkuc2V0Rm9udChuZXcgRm9udChcIkFyaWFsXCIsIEZvbnQuQk9MRCwgMTIpKTtcbiAgIDI5OVx0XG4gICAzMDBcdCAgICAgICAgLy8gU2V0IHJlbmRlcmVyIGNobyBj4buZdCB0cuG6oW5nIHRow6FpIMSR4buDIGhp4buDbiB0aOG7iyBtw6B1IHTGsMahbmcg4bupbmdcbiAgIDMwMVx0ICAgICAgICBzY2hlZHVsZVRhYmxlLmdldENvbHVtbk1vZGVsKCkuZ2V0Q29sdW1uKDUpLnNldENlbGxSZW5kZXJlcihuZXcgRGVmYXVsdFRhYmxlQ2VsbFJlbmRlcmVyKCkge1xuICAgMzAyXHQgICAgICAgICAgICBAT3ZlcnJpZGVcbiAgIDMwM1x0ICAgICAgICAgICAgcHVibGljIENvbXBvbmVudCBnZXRUYWJsZUNlbGxSZW5kZXJlckNvbXBvbmVudChKVGFibGUgdGFibGUsIE9iamVjdCB2YWx1ZSxcbiAgIDMwNFx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib29sZWFuIGlzU2VsZWN0ZWQsIGJvb2xlYW4gaGFzRm9jdXMsXG4gICAzMDVcdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IHJvdywgaW50IGNvbHVtbikge1xuICAgMzA2XHQgICAgICAgICAgICAgICAgQ29tcG9uZW50IGNvbXAgPSBzdXBlci5nZXRUYWJsZUNlbGxSZW5kZXJlckNvbXBvbmVudCh0YWJsZSwgdmFsdWUsIGlzU2VsZWN0ZWQsIGhhc0ZvY3VzLCByb3csIGNvbHVtbik7XG4gICAzMDdcdFxuICAgMzA4XHQgICAgICAgICAgICAgICAgU3RyaW5nIHN0YXR1cyA9IHZhbHVlLnRvU3RyaW5nKCk7XG4gICAzMDlcdFxuICAgMzEwXHQgICAgICAgICAgICAgICAgLy8gVGhp4bq/dCBs4bqtcCBtw6B1IG7hu4FuIHTGsMahbmcg4bupbmcgduG7m2kgdHLhuqFuZyB0aMOhaVxuICAgMzExXHQgICAgICAgICAgICAgICAgaWYgKFwixJDDoyBraOG7n2kgaMOgbmhcIi5lcXVhbHMoc3RhdHVzKSkge1xuICAgMzEyXHQgICAgICAgICAgICAgICAgICAgIGNvbXAuc2V0QmFja2dyb3VuZChuZXcgQ29sb3IoNDYsIDIwNCwgMTEzKSk7IC8vIFhhbmggbMOhXG4gICAzMTNcdCAgICAgICAgICAgICAgICAgICAgY29tcC5zZXRGb3JlZ3JvdW5kKENvbG9yLldISVRFKTtcbiAgIDMxNFx0ICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXCLEkMOjIGjhu6d5XCIuZXF1YWxzKHN0YXR1cykpIHtcbiAgIDMxNVx0ICAgICAgICAgICAgICAgICAgICBjb21wLnNldEJhY2tncm91bmQobmV3IENvbG9yKDIzMSwgNzYsIDYwKSk7IC8vIMSQ4buPXG4gICAzMTZcdCAgICAgICAgICAgICAgICAgICAgY29tcC5zZXRGb3JlZ3JvdW5kKENvbG9yLldISVRFKTtcbiAgIDMxN1x0ICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXCJC4buLIHRy4buFXCIuZXF1YWxzKHN0YXR1cykpIHtcbiAgIDMxOFx0ICAgICAgICAgICAgICAgICAgICBjb21wLnNldEJhY2tncm91bmQobmV3IENvbG9yKDI0MywgMTU2LCAxOCkpOyAvLyBDYW1cbiAgIDMxOVx0ICAgICAgICAgICAgICAgICAgICBjb21wLnNldEZvcmVncm91bmQoQ29sb3IuV0hJVEUpO1xuICAgMzIwXHQgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChcIkNoxrBhIGto4bufaSBow6BuaFwiLmVxdWFscyhzdGF0dXMpKSB7XG4gICAzMjFcdCAgICAgICAgICAgICAgICAgICAgY29tcC5zZXRCYWNrZ3JvdW5kKG5ldyBDb2xvcig1MiwgMTUyLCAyMTkpKTsgLy8gWGFuaCBkxrDGoW5nXG4gICAzMjJcdCAgICAgICAgICAgICAgICAgICAgY29tcC5zZXRGb3JlZ3JvdW5kKENvbG9yLldISVRFKTtcbiAgIDMyM1x0ICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAzMjRcdCAgICAgICAgICAgICAgICAgICAgaWYgKGlzU2VsZWN0ZWQpIHtcbiAgIDMyNVx0ICAgICAgICAgICAgICAgICAgICAgICAgY29tcC5zZXRCYWNrZ3JvdW5kKHRhYmxlLmdldFNlbGVjdGlvbkJhY2tncm91bmQoKSk7XG4gICAzMjZcdCAgICAgICAgICAgICAgICAgICAgICAgIGNvbXAuc2V0Rm9yZWdyb3VuZCh0YWJsZS5nZXRTZWxlY3Rpb25Gb3JlZ3JvdW5kKCkpO1xuICAgMzI3XHQgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAzMjhcdCAgICAgICAgICAgICAgICAgICAgICAgIGNvbXAuc2V0QmFja2dyb3VuZCh0YWJsZS5nZXRCYWNrZ3JvdW5kKCkpO1xuICAgMzI5XHQgICAgICAgICAgICAgICAgICAgICAgICBjb21wLnNldEZvcmVncm91bmQodGFibGUuZ2V0Rm9yZWdyb3VuZCgpKTtcbiAgIDMzMFx0ICAgICAgICAgICAgICAgICAgICB9XG4gICAzMzFcdCAgICAgICAgICAgICAgICB9XG4gICAzMzJcdFxuICAgMzMzXHQgICAgICAgICAgICAgICAgcmV0dXJuIGNvbXA7XG4gICAzMzRcdCAgICAgICAgICAgIH1cbiAgIDMzNVx0ICAgICAgICB9KTtcbiAgIDMzNlx0XG4gICAzMzdcdCAgICAgICAgLy8gVGjDqm0gYuG6o25nIHbDoG8gc2Nyb2xsIHBhbmVcbiAgIDMzOFx0ICAgICAgICBKU2Nyb2xsUGFuZSBzY3JvbGxQYW5lID0gbmV3IEpTY3JvbGxQYW5lKHNjaGVkdWxlVGFibGUpO1xuICAgMzM5XHQgICAgICAgIGNvbnRlbnRQYW5lbC5hZGQoc2Nyb2xsUGFuZSwgQm9yZGVyTGF5b3V0LkNFTlRFUik7XG4gICAzNDBcdFxuICAgMzQxXHQgICAgICAgIC8vIFRow6ptIGPDoWMgbsO6dCB0aGFvIHTDoWNcbiAgIDM0Mlx0ICAgICAgICBKUGFuZWwgYnV0dG9uUGFuZWwgPSBuZXcgSlBhbmVsKG5ldyBGbG93TGF5b3V0KEZsb3dMYXlvdXQuUklHSFQpKTtcbiAgIDM0M1x0ICAgICAgICBKQnV0dG9uIGVkaXRCdXR0b24gPSBuZXcgSkJ1dHRvbihcIkNo4buJbmggc+G7rWFcIiwgY3JlYXRlRWRpdEljb24oMTYsIDE2KSk7XG4gICAzNDRcdCAgICAgICAgSkJ1dHRvbiBkZWxldGVCdXR0b24gPSBuZXcgSkJ1dHRvbihcIljDs2FcIiwgY3JlYXRlRGVsZXRlSWNvbigxNiwgMTYpKTtcbiAgIDM0NVx0ICAgICAgICBKQnV0dG9uIGNsb3NlQnV0dG9uID0gbmV3IEpCdXR0b24oXCLEkMOzbmdcIik7XG4gICAzNDZcdFxuICAgMzQ3XHQgICAgICAgIC8vIFPhu7Ega2nhu4duIGNobyBuw7p0IGNo4buJbmggc+G7rWFcbiAgIDM0OFx0ICAgICAgICBlZGl0QnV0dG9uLmFkZEFjdGlvbkxpc3RlbmVyKGUgLT4ge1xuICAgMzQ5XHQgICAgICAgICAgICBpbnQgcm93ID0gc2NoZWR1bGVUYWJsZS5nZXRTZWxlY3RlZFJvdygpO1xuICAgMzUwXHQgICAgICAgICAgICBpZiAocm93ID09IC0xKSB7XG4gICAzNTFcdCAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhkaWFsb2csXG4gICAzNTJcdCAgICAgICAgICAgICAgICAgICAgICAgIFwiVnVpIGzDsm5nIGNo4buNbiBt4buZdCBs4buLY2ggdHLDrG5oIMSR4buDIGNo4buJbmggc+G7rWFcIixcbiAgIDM1M1x0ICAgICAgICAgICAgICAgICAgICAgICAgXCJUaMO0bmcgYsOhb1wiLFxuICAgMzU0XHQgICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5JTkZPUk1BVElPTl9NRVNTQUdFKTtcbiAgIDM1NVx0ICAgICAgICAgICAgICAgIHJldHVybjtcbiAgIDM1Nlx0ICAgICAgICAgICAgfVxuICAgMzU3XHRcbiAgIDM1OFx0ICAgICAgICAgICAgLy8gTOG6pXkgbcOjIGzhu4tjaCB0csOsbmggxJHDoyBjaOG7jW5cbiAgIDM1OVx0ICAgICAgICAgICAgU3RyaW5nIG1hTGljaCA9IChTdHJpbmcpIHNjaGVkdWxlVGFibGUuZ2V0VmFsdWVBdChyb3csIDApO1xuICAgMzYwXHRcbiAgIDM2MVx0ICAgICAgICAgICAgLy8gxJDDs25nIGRpYWxvZyBoaeG7h24gdOG6oWlcbiAgIDM2Mlx0ICAgICAgICAgICAgZGlhbG9nLmRpc3Bvc2UoKTtcbiAgIDM2M1x0XG4gICAzNjRcdCAgICAgICAgICAgIC8vIEfhu41pIGjDoG0gY2jhu4luaCBz4butYSB24bubaSBtw6MgbOG7i2NoIHRyw6xuaFxuICAgMzY1XHQgICAgICAgICAgICBlZGl0U2NoZWR1bGVCeUlkKG1hTGljaCk7XG4gICAzNjZcdCAgICAgICAgfSk7XG4gICAzNjdcdFxuICAgMzY4XHQgICAgICAgIC8vIFPhu7Ega2nhu4duIGNobyBuw7p0IHjDs2FcbiAgIDM2OVx0ICAgICAgICBkZWxldGVCdXR0b24uYWRkQWN0aW9uTGlzdGVuZXIoZSAtPiB7XG4gICAzNzBcdCAgICAgICAgICAgIGludCByb3cgPSBzY2hlZHVsZVRhYmxlLmdldFNlbGVjdGVkUm93KCk7XG4gICAzNzFcdCAgICAgICAgICAgIGlmIChyb3cgPT0gLTEpIHtcbiAgIDM3Mlx0ICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKGRpYWxvZyxcbiAgIDM3M1x0ICAgICAgICAgICAgICAgICAgICAgICAgXCJWdWkgbMOybmcgY2jhu41uIG3hu5l0IGzhu4tjaCB0csOsbmggxJHhu4MgeMOzYVwiLFxuICAgMzc0XHQgICAgICAgICAgICAgICAgICAgICAgICBcIlRow7RuZyBiw6FvXCIsXG4gICAzNzVcdCAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLklORk9STUFUSU9OX01FU1NBR0UpO1xuICAgMzc2XHQgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgMzc3XHQgICAgICAgICAgICB9XG4gICAzNzhcdFxuICAgMzc5XHQgICAgICAgICAgICAvLyBM4bqleSBtw6MgbOG7i2NoIHRyw6xuaCDEkcOjIGNo4buNblxuICAgMzgwXHQgICAgICAgICAgICBTdHJpbmcgbWFMaWNoID0gKFN0cmluZykgc2NoZWR1bGVUYWJsZS5nZXRWYWx1ZUF0KHJvdywgMCk7XG4gICAzODFcdFxuICAgMzgyXHQgICAgICAgICAgICAvLyBYw6FjIG5o4bqtbiB4w7NhXG4gICAzODNcdCAgICAgICAgICAgIGludCBvcHRpb24gPSBKT3B0aW9uUGFuZS5zaG93Q29uZmlybURpYWxvZyhkaWFsb2csXG4gICAzODRcdCAgICAgICAgICAgICAgICAgICAgXCJC4bqhbiBjw7MgY2jhuq9jIGNo4bqvbiBtdeG7kW4geMOzYSBs4buLY2ggdHLDrG5oIFwiICsgbWFMaWNoICsgXCI/XCIsXG4gICAzODVcdCAgICAgICAgICAgICAgICAgICAgXCJYw6FjIG5o4bqtbiB4w7NhXCIsXG4gICAzODZcdCAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuWUVTX05PX09QVElPTixcbiAgIDM4N1x0ICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5XQVJOSU5HX01FU1NBR0UpO1xuICAgMzg4XHRcbiAgIDM4OVx0ICAgICAgICAgICAgaWYgKG9wdGlvbiA9PSBKT3B0aW9uUGFuZS5ZRVNfT1BUSU9OKSB7XG4gICAzOTBcdCAgICAgICAgICAgICAgICB0cnkge1xuICAgMzkxXHQgICAgICAgICAgICAgICAgICAgIC8vIFRo4buxYyBoaeG7h24geMOzYVxuICAgMzkyXHQgICAgICAgICAgICAgICAgICAgIGJvb2xlYW4gZGVsZXRlZCA9IGxpY2hUcmluaFRhdURBTy5kZWxldGUobWFMaWNoKTtcbiAgIDM5M1x0XG4gICAzOTRcdCAgICAgICAgICAgICAgICAgICAgaWYgKGRlbGV0ZWQpIHtcbiAgIDM5NVx0ICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coZGlhbG9nLFxuICAgMzk2XHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwixJDDoyB4w7NhIHRow6BuaCBjw7RuZyBs4buLY2ggdHLDrG5oIFwiICsgbWFMaWNoLFxuICAgMzk3XHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiVGjDoG5oIGPDtG5nXCIsXG4gICAzOThcdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRSk7XG4gICAzOTlcdFxuICAgNDAwXHQgICAgICAgICAgICAgICAgICAgICAgICAvLyBD4bqtcCBuaOG6rXQgbOG6oWkgZOG7ryBsaeG7h3VcbiAgIDQwMVx0ICAgICAgICAgICAgICAgICAgICAgICAgcmVmcmVzaERhdGEoKTtcbiAgIDQwMlx0XG4gICA0MDNcdCAgICAgICAgICAgICAgICAgICAgICAgIC8vIMSQw7NuZyBkaWFsb2dcbiAgIDQwNFx0ICAgICAgICAgICAgICAgICAgICAgICAgZGlhbG9nLmRpc3Bvc2UoKTtcbiAgIDQwNVx0ICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgNDA2XHQgICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhkaWFsb2csXG4gICA0MDdcdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJLaMO0bmcgdGjhu4MgeMOzYSBs4buLY2ggdHLDrG5oIFwiICsgbWFMaWNoLFxuICAgNDA4XHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2lcIixcbiAgIDQwOVx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFKTtcbiAgIDQxMFx0ICAgICAgICAgICAgICAgICAgICB9XG4gICA0MTFcdCAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZXgpIHtcbiAgIDQxMlx0ICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhkaWFsb2csXG4gICA0MTNcdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpIGtoaSB4w7NhIGzhu4tjaCB0csOsbmg6IFwiICsgZXguZ2V0TWVzc2FnZSgpLFxuICAgNDE0XHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaVwiLFxuICAgNDE1XHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRSk7XG4gICA0MTZcdCAgICAgICAgICAgICAgICB9XG4gICA0MTdcdCAgICAgICAgICAgIH1cbiAgIDQxOFx0ICAgICAgICB9KTtcbiAgIDQxOVx0XG4gICA0MjBcdCAgICAgICAgLy8gU+G7sSBraeG7h24gY2hvIG7DunQgxJHDs25nXG4gICA0MjFcdCAgICAgICAgY2xvc2VCdXR0b24uYWRkQWN0aW9uTGlzdGVuZXIoZSAtPiBkaWFsb2cuZGlzcG9zZSgpKTtcbiAgIDQyMlx0XG4gICA0MjNcdCAgICAgICAgYnV0dG9uUGFuZWwuYWRkKGVkaXRCdXR0b24pO1xuICAgNDI0XHQgICAgICAgIGJ1dHRvblBhbmVsLmFkZChkZWxldGVCdXR0b24pO1xuICAgNDI1XHQgICAgICAgIGJ1dHRvblBhbmVsLmFkZChjbG9zZUJ1dHRvbik7XG4gICA0MjZcdFxuICAgNDI3XHQgICAgICAgIGRpYWxvZy5hZGQoY29udGVudFBhbmVsLCBCb3JkZXJMYXlvdXQuQ0VOVEVSKTtcbiAgIDQyOFx0ICAgICAgICBkaWFsb2cuYWRkKGJ1dHRvblBhbmVsLCBCb3JkZXJMYXlvdXQuU09VVEgpO1xuICAgNDI5XHRcbiAgIDQzMFx0ICAgICAgICBkaWFsb2cuc2V0VmlzaWJsZSh0cnVlKTtcbiAgIDQzMVx0ICAgIH1cbiAgIDQzMlx0ICAgIHByaXZhdGUgdm9pZCBlZGl0U2NoZWR1bGVCeUlkKFN0cmluZyBtYUxpY2gpIHtcbiAgIDQzM1x0ICAgICAgICAvLyBUT0RPOiBUcmnhu4NuIGtoYWkgY2jhu6ljIG7Eg25nIGNo4buJbmggc+G7rWEgbOG7i2NoIHRyw6xuaCB0aGVvIG3Do1xuICAgNDM0XHQgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKHRoaXMsXG4gICA0MzVcdCAgICAgICAgICAgICAgICBcIkNo4bupYyBuxINuZyBjaOG7iW5oIHPhu61hIGzhu4tjaCB0csOsbmggc+G6vSDEkcaw4bujYyB0cmnhu4NuIGtoYWkgdHJvbmcgcGhpw6puIGLhuqNuIHRp4bq/cCB0aGVvLlwiLFxuICAgNDM2XHQgICAgICAgICAgICAgICAgXCJUaMO0bmcgYsOhb1wiLFxuICAgNDM3XHQgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRSk7XG4gICA0MzhcdCAgICB9XG4gICA0MzlcdFxuICAgNDQwXHQgICAgcHJpdmF0ZSB2b2lkIGNvbm5lY3RUb1JNSVNlcnZlcigpIHtcbiAgIDQ0MVx0ICAgICAgICB0cnkge1xuICAgNDQyXHQgICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCLEkGFuZyBr4bq/dCBu4buRaSDEkeG6v24gUk1JIHNlcnZlci4uLlwiKTtcbiAgIDQ0M1x0XG4gICA0NDRcdCAgICAgICAgICAgIC8vIFPhu60gZOG7pW5nIHRy4buxYyB0aeG6v3AgUk1JIHJlZ2lzdHJ5IHRoYXkgdsOsIEpORElcbiAgIDQ0NVx0ICAgICAgICAgICAgUmVnaXN0cnkgcmVnaXN0cnkgPSBMb2NhdGVSZWdpc3RyeS5nZXRSZWdpc3RyeShSTUlfU0VSVkVSX0lQLCBSTUlfU0VSVkVSX1BPUlQpO1xuICAgNDQ2XHQgICAgICAgICAgICBsaWNoVHJpbmhUYXVEQU8gPSAoTGljaFRyaW5oVGF1REFPKSByZWdpc3RyeS5sb29rdXAoXCJsaWNoVHJpbmhUYXVEQU9cIik7XG4gICA0NDdcdFxuICAgNDQ4XHQgICAgICAgICAgICAvLyBLaeG7g20gdHJhIGvhur90IG7hu5FpIMSR4bq/biBjxqEgc+G7nyBk4buvIGxp4buHdVxuICAgNDQ5XHQgICAgICAgICAgICB0cnkge1xuICAgNDUwXHQgICAgICAgICAgICAgICAgYm9vbGVhbiBkYkNvbm5lY3RlZCA9IGxpY2hUcmluaFRhdURBTy50ZXN0Q29ubmVjdGlvbigpO1xuICAgNDUxXHQgICAgICAgICAgICAgICAgaWYgKGRiQ29ubmVjdGVkKSB7XG4gICA0NTJcdCAgICAgICAgICAgICAgICAgICAgaXNDb25uZWN0ZWQgPSB0cnVlO1xuICAgNDUzXHQgICAgICAgICAgICAgICAgICAgIExPR0dFUi5pbmZvKFwiS+G6v3QgbuG7kWkgdGjDoG5oIGPDtG5nIMSR4bq/biBSTUkgc2VydmVyIHbDoCBjxqEgc+G7nyBk4buvIGxp4buHdVwiKTtcbiAgIDQ1NFx0XG4gICA0NTVcdCAgICAgICAgICAgICAgICAgICAgLy8gS2nhu4NtIHRyYSB2w6AgZ2hpIGxvZyBkYW5oIHPDoWNoIHRy4bqhbmcgdGjDoWlcbiAgIDQ1Nlx0ICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgNDU3XHQgICAgICAgICAgICAgICAgICAgICAgICBMaXN0PFRyYW5nVGhhaT4gc3RhdHVzZXMgPSBsaWNoVHJpbmhUYXVEQU8uZ2V0VHJhbmdUaGFpKCk7XG4gICA0NThcdCAgICAgICAgICAgICAgICAgICAgICAgIExPR0dFUi5pbmZvKFwixJDDoyB04bqjaSBcIiArIChzdGF0dXNlcyAhPSBudWxsID8gc3RhdHVzZXMuc2l6ZSgpIDogMCkgKyBcIiB0cuG6oW5nIHRow6FpIHThu6sgY8ahIHPhu58gZOG7ryBsaeG7h3VcIik7XG4gICA0NTlcdCAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgIDQ2MFx0ICAgICAgICAgICAgICAgICAgICAgICAgTE9HR0VSLmxvZyhMZXZlbC5XQVJOSU5HLCBcIkzhu5dpIGtoaSB04bqjaSBkYW5oIHPDoWNoIHRy4bqhbmcgdGjDoWkgdHJvbmcgcXXDoSB0csOsbmgga+G6v3QgbuG7kWlcIiwgZSk7XG4gICA0NjFcdCAgICAgICAgICAgICAgICAgICAgfVxuICAgNDYyXHQgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgIDQ2M1x0ICAgICAgICAgICAgICAgICAgICBpc0Nvbm5lY3RlZCA9IGZhbHNlO1xuICAgNDY0XHQgICAgICAgICAgICAgICAgICAgIExPR0dFUi53YXJuaW5nKFwiS+G6v3QgbuG7kWkgdGjDoG5oIGPDtG5nIMSR4bq/biBSTUkgc2VydmVyIG5oxrBuZyBraMO0bmcgdGjhu4Mga+G6v3QgbuG7kWkgxJHhur9uIGPGoSBz4bufIGThu68gbGnhu4d1XCIpO1xuICAgNDY1XHQgICAgICAgICAgICAgICAgICAgIHNob3dFcnJvck1lc3NhZ2UoXCJL4bq/dCBu4buRaSDEkeG6v24gUk1JIHNlcnZlciB0aMOgbmggY8O0bmcgbmjGsG5nIGtow7RuZyB0aOG7gyBr4bq/dCBu4buRaSDEkeG6v24gY8ahIHPhu58gZOG7ryBsaeG7h3VcIiwgbnVsbCk7XG4gICA0NjZcdCAgICAgICAgICAgICAgICB9XG4gICA0NjdcdCAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICA0NjhcdCAgICAgICAgICAgICAgICBpc0Nvbm5lY3RlZCA9IGZhbHNlO1xuICAgNDY5XHQgICAgICAgICAgICAgICAgTE9HR0VSLmxvZyhMZXZlbC5TRVZFUkUsIFwiS2nhu4NtIHRyYSBr4bq/dCBu4buRaSBjxqEgc+G7nyBk4buvIGxp4buHdSB0aOG6pXQgYuG6oWlcIiwgZSk7XG4gICA0NzBcdCAgICAgICAgICAgICAgICBzaG93RXJyb3JNZXNzYWdlKFwiS2nhu4NtIHRyYSBr4bq/dCBu4buRaSBjxqEgc+G7nyBk4buvIGxp4buHdSB0aOG6pXQgYuG6oWlcIiwgZSk7XG4gICA0NzFcdCAgICAgICAgICAgIH1cbiAgIDQ3Mlx0ICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZXgpIHtcbiAgIDQ3M1x0ICAgICAgICAgICAgTE9HR0VSLmxvZyhMZXZlbC5TRVZFUkUsIFwiS2jDtG5nIHRo4buDIGvhur90IG7hu5FpIMSR4bq/biBSTUkgc2VydmVyXCIsIGV4KTtcbiAgIDQ3NFx0ICAgICAgICAgICAgaXNDb25uZWN0ZWQgPSBmYWxzZTtcbiAgIDQ3NVx0ICAgICAgICAgICAgc2hvd0Vycm9yTWVzc2FnZShcIktow7RuZyB0aOG7gyBr4bq/dCBu4buRaSDEkeG6v24gUk1JIHNlcnZlcjogXCIgKyBleC5nZXRNZXNzYWdlKCksIGV4KTtcbiAgIDQ3Nlx0ICAgICAgICB9XG4gICA0NzdcdCAgICB9XG4gICA0NzhcdFxuICAgNDc5XHQgICAgcHJpdmF0ZSBKUGFuZWwgY3JlYXRlU2VhcmNoUGFuZWwoKSB7XG4gICA0ODBcdCAgICAgICAgSlBhbmVsIG91dGVyUGFuZWwgPSBuZXcgSlBhbmVsKG5ldyBCb3JkZXJMYXlvdXQoKSk7XG4gICA0ODFcdCAgICAgICAgb3V0ZXJQYW5lbC5zZXRCb3JkZXIoQm9yZGVyRmFjdG9yeS5jcmVhdGVUaXRsZWRCb3JkZXIoXCJUw6xtIEtp4bq/bSBM4buLY2ggVHLDrG5oXCIpKTtcbiAgIDQ4Mlx0XG4gICA0ODNcdCAgICAgICAgLy8gUGFuZWwgY2jhu6lhIHThuqV0IGPhuqMgY8OhYyDEkWnhu4F1IGtoaeG7g24gdMOsbSBraeG6v21cbiAgIDQ4NFx0ICAgICAgICBKUGFuZWwgbWFpblNlYXJjaFBhbmVsID0gbmV3IEpQYW5lbChuZXcgQm9yZGVyTGF5b3V0KDAsIDEwKSk7XG4gICA0ODVcdFxuICAgNDg2XHQgICAgICAgIC8vIFBhbmVsIGNobyBow6BuZyDEkeG6p3UgdGnDqm4gKG5nw6B5IMSRaSB2w6AgdHLhuqFuZyB0aMOhaSlcbiAgIDQ4N1x0ICAgICAgICBKUGFuZWwgZmlyc3RSb3dQYW5lbCA9IG5ldyBKUGFuZWwobmV3IEZsb3dMYXlvdXQoRmxvd0xheW91dC5MRUZULCAxMCwgNSkpO1xuICAgNDg4XHRcbiAgIDQ4OVx0ICAgICAgICAvLyBUaMOgbmggcGjhuqduIHTDrG0ga2nhur9tIHRoZW8gbmfDoHlcbiAgIDQ5MFx0ICAgICAgICBKTGFiZWwgZGF0ZUxhYmVsID0gbmV3IEpMYWJlbChcIk5nw6B5IMSRaTpcIik7XG4gICA0OTFcdCAgICAgICAgZGF0ZUNob29zZXIgPSBuZXcgSkRhdGVDaG9vc2VyKCk7XG4gICA0OTJcdCAgICAgICAgZGF0ZUNob29zZXIuc2V0RGF0ZUZvcm1hdFN0cmluZyhcInl5eXktTU0tZGRcIik7XG4gICA0OTNcdCAgICAgICAgZGF0ZUNob29zZXIuc2V0RGF0ZShuZXcgRGF0ZSgpKTtcbiAgIDQ5NFx0ICAgICAgICBkYXRlQ2hvb3Nlci5zZXRQcmVmZXJyZWRTaXplKG5ldyBEaW1lbnNpb24oMTUwLCAyOCkpO1xuICAgNDk1XHRcbiAgIDQ5Nlx0ICAgICAgICAvLyBUaMOgbmggcGjhuqduIGzhu41jIHRoZW8gdHLhuqFuZyB0aMOhaVxuICAgNDk3XHQgICAgICAgIEpMYWJlbCBmaWx0ZXJMYWJlbCA9IG5ldyBKTGFiZWwoXCJM4buNYyB0aGVvIHRy4bqhbmcgdGjDoWk6XCIpO1xuICAgNDk4XHQgICAgICAgIERlZmF1bHRDb21ib0JveE1vZGVsPE9iamVjdD4gZmlsdGVyTW9kZWwgPSBuZXcgRGVmYXVsdENvbWJvQm94TW9kZWw8PigpO1xuICAgNDk5XHQgICAgICAgIGZpbHRlck1vZGVsLmFkZEVsZW1lbnQoXCJU4bqldCBj4bqjXCIpO1xuICAgNTAwXHRcbiAgIDUwMVx0ICAgICAgICB0cnkge1xuICAgNTAyXHQgICAgICAgICAgICBpZiAoaXNDb25uZWN0ZWQgJiYgbGljaFRyaW5oVGF1REFPICE9IG51bGwpIHtcbiAgIDUwM1x0ICAgICAgICAgICAgICAgIExpc3Q8VHJhbmdUaGFpPiBkYlN0YXR1c2VzID0gbGljaFRyaW5oVGF1REFPLmdldFRyYW5nVGhhaSgpO1xuICAgNTA0XHQgICAgICAgICAgICAgICAgaWYgKGRiU3RhdHVzZXMgIT0gbnVsbCAmJiAhZGJTdGF0dXNlcy5pc0VtcHR5KCkpIHtcbiAgIDUwNVx0ICAgICAgICAgICAgICAgICAgICBmb3IgKFRyYW5nVGhhaSBzdGF0dXMgOiBkYlN0YXR1c2VzKSB7XG4gICA1MDZcdCAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlck1vZGVsLmFkZEVsZW1lbnQoc3RhdHVzKTtcbiAgIDUwN1x0ICAgICAgICAgICAgICAgICAgICB9XG4gICA1MDhcdCAgICAgICAgICAgICAgICAgICAgTE9HR0VSLmluZm8oXCLEkMOjIHThuqNpIHRow6BuaCBjw7RuZyBcIiArIGRiU3RhdHVzZXMuc2l6ZSgpICsgXCIgdHLhuqFuZyB0aMOhaSB04burIGPGoSBz4bufIGThu68gbGnhu4d1XCIpO1xuICAgNTA5XHQgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgIDUxMFx0ICAgICAgICAgICAgICAgICAgICBMT0dHRVIud2FybmluZyhcIktow7RuZyB0w6xtIHRo4bqleSB0cuG6oW5nIHRow6FpIG7DoG8gdHJvbmcgY8ahIHPhu58gZOG7ryBsaeG7h3VcIik7XG4gICA1MTFcdCAgICAgICAgICAgICAgICB9XG4gICA1MTJcdCAgICAgICAgICAgIH1cbiAgIDUxM1x0ICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgNTE0XHQgICAgICAgICAgICBMT0dHRVIubG9nKExldmVsLlNFVkVSRSwgXCJM4buXaSBraGkgdOG6o2kgZGFuaCBzw6FjaCB0cuG6oW5nIHRow6FpOiBcIiArIGUuZ2V0TWVzc2FnZSgpLCBlKTtcbiAgIDUxNVx0ICAgICAgICB9XG4gICA1MTZcdFxuICAgNTE3XHQgICAgICAgIGZpbHRlckNvbWJvQm94ID0gbmV3IEpDb21ib0JveDw+KGZpbHRlck1vZGVsKTtcbiAgIDUxOFx0ICAgICAgICBmaWx0ZXJDb21ib0JveC5zZXRQcmVmZXJyZWRTaXplKG5ldyBEaW1lbnNpb24oMTUwLCAyOCkpO1xuICAgNTE5XHRcbiAgIDUyMFx0ICAgICAgICAvLyBDdXN0b20gcmVuZGVyZXIgxJHhu4MgaGnhu4NuIHRo4buLIG3DtCB04bqjIGPhu6dhIGVudW1cbiAgIDUyMVx0ICAgICAgICBmaWx0ZXJDb21ib0JveC5zZXRSZW5kZXJlcihuZXcgRGVmYXVsdExpc3RDZWxsUmVuZGVyZXIoKSB7XG4gICA1MjJcdCAgICAgICAgICAgIEBPdmVycmlkZVxuICAgNTIzXHQgICAgICAgICAgICBwdWJsaWMgQ29tcG9uZW50IGdldExpc3RDZWxsUmVuZGVyZXJDb21wb25lbnQoSkxpc3Q8Pz4gbGlzdCwgT2JqZWN0IHZhbHVlLCBpbnQgaW5kZXgsXG4gICA1MjRcdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib29sZWFuIGlzU2VsZWN0ZWQsIGJvb2xlYW4gY2VsbEhhc0ZvY3VzKSB7XG4gICA1MjVcdCAgICAgICAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBUcmFuZ1RoYWkpIHtcbiAgIDUyNlx0ICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9ICgoVHJhbmdUaGFpKSB2YWx1ZSkuZ2V0VmFsdWUoKTtcbiAgIDUyN1x0ICAgICAgICAgICAgICAgIH1cbiAgIDUyOFx0ICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5nZXRMaXN0Q2VsbFJlbmRlcmVyQ29tcG9uZW50KGxpc3QsIHZhbHVlLCBpbmRleCwgaXNTZWxlY3RlZCwgY2VsbEhhc0ZvY3VzKTtcbiAgIDUyOVx0ICAgICAgICAgICAgfVxuICAgNTMwXHQgICAgICAgIH0pO1xuICAgNTMxXHRcbiAgIDUzMlx0ICAgICAgICAvLyBUaMOqbSBjw6FjIHRow6BuaCBwaOG6p24gdsOgbyBwYW5lbCBow6BuZyDEkeG6p3VcbiAgIDUzM1x0ICAgICAgICBmaXJzdFJvd1BhbmVsLmFkZChkYXRlTGFiZWwpO1xuICAgNTM0XHQgICAgICAgIGZpcnN0Um93UGFuZWwuYWRkKGRhdGVDaG9vc2VyKTtcbiAgIDUzNVx0ICAgICAgICBmaXJzdFJvd1BhbmVsLmFkZChmaWx0ZXJMYWJlbCk7XG4gICA1MzZcdCAgICAgICAgZmlyc3RSb3dQYW5lbC5hZGQoZmlsdGVyQ29tYm9Cb3gpO1xuICAgNTM3XHRcbiAgIDUzOFx0ICAgICAgICAvLyBQYW5lbCBjaG8gaMOgbmcgdGjhu6kgaGFpIChnYSDEkWksIGdhIMSR4bq/biwgZ2nhu50gxJFpKVxuICAgNTM5XHQgICAgICAgIEpQYW5lbCBzZWNvbmRSb3dQYW5lbCA9IG5ldyBKUGFuZWwobmV3IEZsb3dMYXlvdXQoRmxvd0xheW91dC5MRUZULCAxMCwgNSkpO1xuICAgNTQwXHRcbiAgIDU0MVx0ICAgICAgICAvLyBUaMOgbmggcGjhuqduIHTDrG0ga2nhur9tIHRoZW8gZ2EgxJFpXG4gICA1NDJcdCAgICAgICAgSkxhYmVsIGRlcFN0YXRpb25MYWJlbCA9IG5ldyBKTGFiZWwoXCJHYSDEkWk6XCIpO1xuICAgNTQzXHRcbiAgIDU0NFx0ICAgICAgICAvLyBT4butIGThu6VuZyBtb2RlbCBjaG8gYXV0b2NvbXBsZXRlIENvbWJvQm94XG4gICA1NDVcdCAgICAgICAgRGVmYXVsdENvbWJvQm94TW9kZWw8U3RyaW5nPiBkZXBTdGF0aW9uTW9kZWwgPSBuZXcgRGVmYXVsdENvbWJvQm94TW9kZWw8PigpO1xuICAgNTQ2XHQgICAgICAgIGRlcFN0YXRpb25Nb2RlbC5hZGRFbGVtZW50KFwiVOG6pXQgY+G6o1wiKTtcbiAgIDU0N1x0XG4gICA1NDhcdCAgICAgICAgLy8gVOG6oW8gQ29tYm9Cb3ggY2hvIGdhIMSRaSB24bubaSBBdXRvQ29tcGxldGVcbiAgIDU0OVx0ICAgICAgICBKQ29tYm9Cb3g8U3RyaW5nPiBkZXBTdGF0aW9uQ29tYm9Cb3ggPSBuZXcgSkNvbWJvQm94PD4oZGVwU3RhdGlvbk1vZGVsKTtcbiAgIDU1MFx0ICAgICAgICBkZXBTdGF0aW9uQ29tYm9Cb3guc2V0UHJlZmVycmVkU2l6ZShuZXcgRGltZW5zaW9uKDE1MCwgMjgpKTtcbiAgIDU1MVx0ICAgICAgICBkZXBTdGF0aW9uQ29tYm9Cb3guc2V0RWRpdGFibGUodHJ1ZSk7XG4gICA1NTJcdFxuICAgNTUzXHQgICAgICAgIC8vIFRow6ptIEF1dG9Db21wbGV0ZSBjaG8gQ29tYm9Cb3ggZ2EgxJFpXG4gICA1NTRcdCAgICAgICAgc2V0dXBBdXRvQ29tcGxldGUoZGVwU3RhdGlvbkNvbWJvQm94KTtcbiAgIDU1NVx0XG4gICA1NTZcdCAgICAgICAgLy8gVGjDoG5oIHBo4bqnbiB0w6xtIGtp4bq/bSB0aGVvIGdhIMSR4bq/blxuICAgNTU3XHQgICAgICAgIEpMYWJlbCBhcnJTdGF0aW9uTGFiZWwgPSBuZXcgSkxhYmVsKFwiR2EgxJHhur9uOlwiKTtcbiAgIDU1OFx0XG4gICA1NTlcdCAgICAgICAgLy8gU+G7rSBk4bulbmcgbW9kZWwgY2hvIGF1dG9jb21wbGV0ZSBDb21ib0JveFxuICAgNTYwXHQgICAgICAgIERlZmF1bHRDb21ib0JveE1vZGVsPFN0cmluZz4gYXJyU3RhdGlvbk1vZGVsID0gbmV3IERlZmF1bHRDb21ib0JveE1vZGVsPD4oKTtcbiAgIDU2MVx0ICAgICAgICBhcnJTdGF0aW9uTW9kZWwuYWRkRWxlbWVudChcIlThuqV0IGPhuqNcIik7XG4gICA1NjJcdFxuICAgNTYzXHQgICAgICAgIC8vIFThuqFvIENvbWJvQm94IGNobyBnYSDEkeG6v24gduG7m2kgQXV0b0NvbXBsZXRlXG4gICA1NjRcdCAgICAgICAgSkNvbWJvQm94PFN0cmluZz4gYXJyU3RhdGlvbkNvbWJvQm94ID0gbmV3IEpDb21ib0JveDw+KGFyclN0YXRpb25Nb2RlbCk7XG4gICA1NjVcdCAgICAgICAgYXJyU3RhdGlvbkNvbWJvQm94LnNldFByZWZlcnJlZFNpemUobmV3IERpbWVuc2lvbigxNTAsIDI4KSk7XG4gICA1NjZcdCAgICAgICAgYXJyU3RhdGlvbkNvbWJvQm94LnNldEVkaXRhYmxlKHRydWUpO1xuICAgNTY3XHRcbiAgIDU2OFx0ICAgICAgICAvLyBUaMOqbSBBdXRvQ29tcGxldGUgY2hvIENvbWJvQm94IGdhIMSR4bq/blxuICAgNTY5XHQgICAgICAgIHNldHVwQXV0b0NvbXBsZXRlKGFyclN0YXRpb25Db21ib0JveCk7XG4gICA1NzBcdFxuICAgNTcxXHQgICAgICAgIC8vIFThuqNpIGRhbmggc8OhY2ggZ2EgdOG7qyBjxqEgc+G7nyBk4buvIGxp4buHdSB2w6AgdGjDqm0gdsOgbyBDb21ib0JveFxuICAgNTcyXHQgICAgICAgIGxvYWRTdGF0aW9uTGlzdChkZXBTdGF0aW9uQ29tYm9Cb3gsIGFyclN0YXRpb25Db21ib0JveCk7XG4gICA1NzNcdFxuICAgNTc0XHQgICAgICAgIC8vIFRow6BuaCBwaOG6p24gdMOsbSBraeG6v20gdGhlbyBnaeG7nSDEkWkgLSBUSEFZIMSQ4buUSTogRMO5bmcgc3Bpbm5lciB0aGF5IGNobyBUZXh0RmllbGRcbiAgIDU3NVx0ICAgICAgICBKTGFiZWwgZGVwVGltZUxhYmVsID0gbmV3IEpMYWJlbChcIkdp4budIMSRaTpcIik7XG4gICA1NzZcdFxuICAgNTc3XHQgICAgICAgIC8vIFThuqFvIG3DtCBow6xuaCBjaG8gZ2nhu50gKDAtMjMpIHbDoCBwaMO6dCAoMC01OSlcbiAgIDU3OFx0ICAgICAgICBTcGlubmVyTnVtYmVyTW9kZWwgaG91ck1vZGVsID0gbmV3IFNwaW5uZXJOdW1iZXJNb2RlbCgwLCAwLCAyMywgMSk7XG4gICA1NzlcdCAgICAgICAgU3Bpbm5lck51bWJlck1vZGVsIG1pbnV0ZU1vZGVsID0gbmV3IFNwaW5uZXJOdW1iZXJNb2RlbCgwLCAwLCA1OSwgMSk7XG4gICA1ODBcdFxuICAgNTgxXHQgICAgICAgIEpTcGlubmVyIGhvdXJTcGlubmVyID0gbmV3IEpTcGlubmVyKGhvdXJNb2RlbCk7XG4gICA1ODJcdCAgICAgICAgSlNwaW5uZXIgbWludXRlU3Bpbm5lciA9IG5ldyBKU3Bpbm5lcihtaW51dGVNb2RlbCk7XG4gICA1ODNcdFxuICAgNTg0XHQgICAgICAgIC8vIFRoaeG6v3QgbOG6rXAgZWRpdG9yIMSR4buDIGhp4buDbiB0aOG7iyDEkcO6bmcgxJHhu4tuaCBk4bqhbmdcbiAgIDU4NVx0ICAgICAgICBKU3Bpbm5lci5OdW1iZXJFZGl0b3IgaG91ckVkaXRvciA9IG5ldyBKU3Bpbm5lci5OdW1iZXJFZGl0b3IoaG91clNwaW5uZXIsIFwiMDBcIik7XG4gICA1ODZcdCAgICAgICAgaG91clNwaW5uZXIuc2V0RWRpdG9yKGhvdXJFZGl0b3IpO1xuICAgNTg3XHQgICAgICAgIEpTcGlubmVyLk51bWJlckVkaXRvciBtaW51dGVFZGl0b3IgPSBuZXcgSlNwaW5uZXIuTnVtYmVyRWRpdG9yKG1pbnV0ZVNwaW5uZXIsIFwiMDBcIik7XG4gICA1ODhcdCAgICAgICAgbWludXRlU3Bpbm5lci5zZXRFZGl0b3IobWludXRlRWRpdG9yKTtcbiAgIDU4OVx0XG4gICA1OTBcdCAgICAgICAgLy8gUGFuZWwgY2jhu6lhIGPDoWMgc3Bpbm5lciBnaeG7nSB2w6AgcGjDunRcbiAgIDU5MVx0ICAgICAgICBKUGFuZWwgdGltZVNwaW5uZXJQYW5lbCA9IG5ldyBKUGFuZWwobmV3IEZsb3dMYXlvdXQoRmxvd0xheW91dC5MRUZULCAwLCAwKSk7XG4gICA1OTJcdFxuICAgNTkzXHQgICAgICAgIC8vIFRow6ptIG5ow6NuIFwiOlwiIGdp4buvYSBnaeG7nSB2w6AgcGjDunRcbiAgIDU5NFx0ICAgICAgICBKTGFiZWwgc2VwYXJhdG9yID0gbmV3IEpMYWJlbChcIiA6IFwiKTtcbiAgIDU5NVx0ICAgICAgICBzZXBhcmF0b3Iuc2V0Rm9udChuZXcgRm9udChcIlNhbnNTZXJpZlwiLCBGb250LkJPTEQsIDE0KSk7XG4gICA1OTZcdFxuICAgNTk3XHQgICAgICAgIHRpbWVTcGlubmVyUGFuZWwuYWRkKGhvdXJTcGlubmVyKTtcbiAgIDU5OFx0ICAgICAgICB0aW1lU3Bpbm5lclBhbmVsLmFkZChzZXBhcmF0b3IpO1xuICAgNTk5XHQgICAgICAgIHRpbWVTcGlubmVyUGFuZWwuYWRkKG1pbnV0ZVNwaW5uZXIpO1xuICAgNjAwXHRcbiAgIDYwMVx0ICAgICAgICAvLyBDaGVja2JveCDEkeG7gyBuZ8aw4budaSBkw7luZyBjw7MgdGjhu4MgY2jhu41uIHTDrG0gdGhlbyBnaeG7nSBoYXkga2jDtG5nXG4gICA2MDJcdCAgICAgICAgSkNoZWNrQm94IHVzZVRpbWVDaGVja0JveCA9IG5ldyBKQ2hlY2tCb3goXCJUw6xtIHRoZW8gZ2nhu51cIik7XG4gICA2MDNcdCAgICAgICAgdXNlVGltZUNoZWNrQm94LmFkZEFjdGlvbkxpc3RlbmVyKGUgLT4ge1xuICAgNjA0XHQgICAgICAgICAgICBib29sZWFuIHNlbGVjdGVkID0gdXNlVGltZUNoZWNrQm94LmlzU2VsZWN0ZWQoKTtcbiAgIDYwNVx0ICAgICAgICAgICAgaG91clNwaW5uZXIuc2V0RW5hYmxlZChzZWxlY3RlZCk7XG4gICA2MDZcdCAgICAgICAgICAgIG1pbnV0ZVNwaW5uZXIuc2V0RW5hYmxlZChzZWxlY3RlZCk7XG4gICA2MDdcdCAgICAgICAgfSk7XG4gICA2MDhcdFxuICAgNjA5XHQgICAgICAgIC8vIE3hurdjIMSR4buLbmgga2jDtG5nIHTDrG0ga2nhur9tIHRoZW8gZ2nhu51cbiAgIDYxMFx0ICAgICAgICB1c2VUaW1lQ2hlY2tCb3guc2V0U2VsZWN0ZWQoZmFsc2UpO1xuICAgNjExXHQgICAgICAgIGhvdXJTcGlubmVyLnNldEVuYWJsZWQoZmFsc2UpO1xuICAgNjEyXHQgICAgICAgIG1pbnV0ZVNwaW5uZXIuc2V0RW5hYmxlZChmYWxzZSk7XG4gICA2MTNcdFxuICAgNjE0XHQgICAgICAgIC8vIFRow6ptIGPDoWMgdGjDoG5oIHBo4bqnbiB2w6BvIHBhbmVsIGjDoG5nIHRo4bupIGhhaVxuICAgNjE1XHQgICAgICAgIHNlY29uZFJvd1BhbmVsLmFkZChkZXBTdGF0aW9uTGFiZWwpO1xuICAgNjE2XHQgICAgICAgIHNlY29uZFJvd1BhbmVsLmFkZChkZXBTdGF0aW9uQ29tYm9Cb3gpO1xuICAgNjE3XHQgICAgICAgIHNlY29uZFJvd1BhbmVsLmFkZChhcnJTdGF0aW9uTGFiZWwpO1xuICAgNjE4XHQgICAgICAgIHNlY29uZFJvd1BhbmVsLmFkZChhcnJTdGF0aW9uQ29tYm9Cb3gpO1xuICAgNjE5XHQgICAgICAgIHNlY29uZFJvd1BhbmVsLmFkZChkZXBUaW1lTGFiZWwpO1xuICAgNjIwXHQgICAgICAgIHNlY29uZFJvd1BhbmVsLmFkZCh0aW1lU3Bpbm5lclBhbmVsKTtcbiAgIDYyMVx0ICAgICAgICBzZWNvbmRSb3dQYW5lbC5hZGQodXNlVGltZUNoZWNrQm94KTtcbiAgIDYyMlx0XG4gICA2MjNcdCAgICAgICAgLy8gUGFuZWwgY2hvIGPDoWMgbsO6dCB0w6xtIGtp4bq/bSB2w6AgbMOgbSBt4bubaVxuICAgNjI0XHQgICAgICAgIEpQYW5lbCBidXR0b25QYW5lbCA9IG5ldyBKUGFuZWwobmV3IEZsb3dMYXlvdXQoRmxvd0xheW91dC5MRUZULCAxMCwgNSkpO1xuICAgNjI1XHRcbiAgIDYyNlx0ICAgICAgICAvLyBOw7p0IHTDrG0ga2nhur9tIHbhu5tpIGJp4buDdSB0xrDhu6NuZyB0w7l5IGNo4buJbmhcbiAgIDYyN1x0ICAgICAgICBzZWFyY2hCdXR0b24gPSBuZXcgSkJ1dHRvbihcIlTDrG0gS2nhur9tXCIpO1xuICAgNjI4XHQgICAgICAgIHNlYXJjaEJ1dHRvbi5zZXRJY29uKGNyZWF0ZVNlYXJjaEljb24oMTYsIDE2KSk7XG4gICA2MjlcdCAgICAgICAgc2VhcmNoQnV0dG9uLmFkZEFjdGlvbkxpc3RlbmVyKGUgLT4ge1xuICAgNjMwXHQgICAgICAgICAgICB0cnkge1xuICAgNjMxXHQgICAgICAgICAgICAgICAgLy8gTOG6pXkgY8OhYyBnacOhIHRy4buLIHTDrG0ga2nhur9tXG4gICA2MzJcdCAgICAgICAgICAgICAgICBEYXRlIHNlbGVjdGVkRGF0ZSA9IGRhdGVDaG9vc2VyLmdldERhdGUoKTtcbiAgIDYzM1x0ICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZERhdGUgPT0gbnVsbCkge1xuICAgNjM0XHQgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oXCJWdWkgbMOybmcgY2jhu41uIG5nw6B5IGjhu6NwIGzhu4cuXCIpO1xuICAgNjM1XHQgICAgICAgICAgICAgICAgfVxuICAgNjM2XHRcbiAgIDYzN1x0ICAgICAgICAgICAgICAgIExvY2FsRGF0ZSBsb2NhbERhdGUgPSBzZWxlY3RlZERhdGUudG9JbnN0YW50KClcbiAgIDYzOFx0ICAgICAgICAgICAgICAgICAgICAgICAgLmF0Wm9uZShab25lSWQuc3lzdGVtRGVmYXVsdCgpKVxuICAgNjM5XHQgICAgICAgICAgICAgICAgICAgICAgICAudG9Mb2NhbERhdGUoKTtcbiAgIDY0MFx0XG4gICA2NDFcdCAgICAgICAgICAgICAgICBTdHJpbmcgZ2FEaSA9IGRlcFN0YXRpb25Db21ib0JveC5nZXRTZWxlY3RlZEl0ZW0oKS50b1N0cmluZygpO1xuICAgNjQyXHQgICAgICAgICAgICAgICAgaWYgKGdhRGkuZXF1YWxzKFwiVOG6pXQgY+G6o1wiKSkgZ2FEaSA9IG51bGw7XG4gICA2NDNcdFxuICAgNjQ0XHQgICAgICAgICAgICAgICAgU3RyaW5nIGdhRGVuID0gYXJyU3RhdGlvbkNvbWJvQm94LmdldFNlbGVjdGVkSXRlbSgpLnRvU3RyaW5nKCk7XG4gICA2NDVcdCAgICAgICAgICAgICAgICBpZiAoZ2FEZW4uZXF1YWxzKFwiVOG6pXQgY+G6o1wiKSkgZ2FEZW4gPSBudWxsO1xuICAgNjQ2XHRcbiAgIDY0N1x0ICAgICAgICAgICAgICAgIC8vIEzhuqV5IGdpw6EgdHLhu4sgZ2nhu50gbuG6v3UgY2hlY2tib3ggxJHGsOG7o2MgY2jhu41uXG4gICA2NDhcdCAgICAgICAgICAgICAgICBTdHJpbmcgZ2lvRGkgPSBudWxsO1xuICAgNjQ5XHQgICAgICAgICAgICAgICAgaWYgKHVzZVRpbWVDaGVja0JveC5pc1NlbGVjdGVkKCkpIHtcbiAgIDY1MFx0ICAgICAgICAgICAgICAgICAgICBpbnQgaG91ciA9IChpbnQpIGhvdXJTcGlubmVyLmdldFZhbHVlKCk7XG4gICA2NTFcdCAgICAgICAgICAgICAgICAgICAgaW50IG1pbnV0ZSA9IChpbnQpIG1pbnV0ZVNwaW5uZXIuZ2V0VmFsdWUoKTtcbiAgIDY1Mlx0ICAgICAgICAgICAgICAgICAgICBnaW9EaSA9IFN0cmluZy5mb3JtYXQoXCIlMDJkOiUwMmRcIiwgaG91ciwgbWludXRlKTtcbiAgIDY1M1x0ICAgICAgICAgICAgICAgIH1cbiAgIDY1NFx0XG4gICA2NTVcdCAgICAgICAgICAgICAgICAvLyBUaOG7sWMgaGnhu4duIHTDrG0ga2nhur9tIGThu7FhIHRyw6puIGPDoWMgdHLGsOG7nW5nIMSRw6Mgbmjhuq1wXG4gICA2NTZcdCAgICAgICAgICAgICAgICBzZWFyY2hTY2hlZHVsZXMobG9jYWxEYXRlLCBnYURpLCBnYURlbiwgZ2lvRGkpO1xuICAgNjU3XHRcbiAgIDY1OFx0ICAgICAgICAgICAgfSBjYXRjaCAoSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGV4KSB7XG4gICA2NTlcdCAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhMaWNoVHJpbmhUYXVQYW5lbC50aGlzLFxuICAgNjYwXHQgICAgICAgICAgICAgICAgICAgICAgICBleC5nZXRNZXNzYWdlKCksIFwiTOG7l2kgdMOsbSBraeG6v21cIiwgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRSk7XG4gICA2NjFcdCAgICAgICAgICAgIH0gY2F0Y2ggKFJlbW90ZUV4Y2VwdGlvbiBleCkge1xuICAgNjYyXHQgICAgICAgICAgICAgICAgTE9HR0VSLmxvZyhMZXZlbC5TRVZFUkUsIFwiTOG7l2kga2hpIHTDrG0ga2nhur9tIGzhu4tjaCB0csOsbmhcIiwgZXgpO1xuICAgNjYzXHQgICAgICAgICAgICAgICAgc2hvd0Vycm9yTWVzc2FnZShcIkzhu5dpIGtoaSB0w6xtIGtp4bq/bSBs4buLY2ggdHLDrG5oXCIsIGV4KTtcbiAgIDY2NFx0ICAgICAgICAgICAgfVxuICAgNjY1XHQgICAgICAgIH0pO1xuICAgNjY2XHRcbiAgIDY2N1x0ICAgICAgICAvLyBOw7p0IGzDoG0gbeG7m2kgduG7m2kgYmnhu4N1IHTGsOG7o25nIHTDuXkgY2jhu4luaFxuICAgNjY4XHQgICAgICAgIHJlZnJlc2hCdXR0b24gPSBuZXcgSkJ1dHRvbihcIkzDoG0gTeG7m2lcIik7XG4gICA2NjlcdCAgICAgICAgcmVmcmVzaEJ1dHRvbi5zZXRJY29uKGNyZWF0ZVJlZnJlc2hJY29uKDE2LCAxNikpO1xuICAgNjcwXHQgICAgICAgIHJlZnJlc2hCdXR0b24uYWRkQWN0aW9uTGlzdGVuZXIoZSAtPiB7XG4gICA2NzFcdCAgICAgICAgICAgIC8vIMSQ4bq3dCBs4bqhaSBjw6FjIHRyxrDhu51uZyB0w6xtIGtp4bq/bSB24buBIGdpw6EgdHLhu4sgbeG6t2MgxJHhu4tuaFxuICAgNjcyXHQgICAgICAgICAgICBkYXRlQ2hvb3Nlci5zZXREYXRlKG5ldyBEYXRlKCkpO1xuICAgNjczXHQgICAgICAgICAgICBmaWx0ZXJDb21ib0JveC5zZXRTZWxlY3RlZEl0ZW0oXCJU4bqldCBj4bqjXCIpO1xuICAgNjc0XHQgICAgICAgICAgICBkZXBTdGF0aW9uQ29tYm9Cb3guc2V0U2VsZWN0ZWRJdGVtKFwiVOG6pXQgY+G6o1wiKTtcbiAgIDY3NVx0ICAgICAgICAgICAgYXJyU3RhdGlvbkNvbWJvQm94LnNldFNlbGVjdGVkSXRlbShcIlThuqV0IGPhuqNcIik7XG4gICA2NzZcdCAgICAgICAgICAgIHVzZVRpbWVDaGVja0JveC5zZXRTZWxlY3RlZChmYWxzZSk7XG4gICA2NzdcdCAgICAgICAgICAgIGhvdXJTcGlubmVyLnNldFZhbHVlKDApO1xuICAgNjc4XHQgICAgICAgICAgICBtaW51dGVTcGlubmVyLnNldFZhbHVlKDApO1xuICAgNjc5XHQgICAgICAgICAgICBob3VyU3Bpbm5lci5zZXRFbmFibGVkKGZhbHNlKTtcbiAgIDY4MFx0ICAgICAgICAgICAgbWludXRlU3Bpbm5lci5zZXRFbmFibGVkKGZhbHNlKTtcbiAgIDY4MVx0XG4gICA2ODJcdCAgICAgICAgICAgIC8vIEzDoG0gbeG7m2kgZOG7ryBsaeG7h3VcbiAgIDY4M1x0ICAgICAgICAgICAgcmVmcmVzaERhdGEoKTtcbiAgIDY4NFx0ICAgICAgICB9KTtcbiAgIDY4NVx0XG4gICA2ODZcdCAgICAgICAgLy8gVGjDqm0gY8OhYyBuw7p0IHbDoG8gcGFuZWwgbsO6dFxuICAgNjg3XHQgICAgICAgIGJ1dHRvblBhbmVsLmFkZChzZWFyY2hCdXR0b24pO1xuICAgNjg4XHQgICAgICAgIGJ1dHRvblBhbmVsLmFkZChyZWZyZXNoQnV0dG9uKTtcbiAgIDY4OVx0XG4gICA2OTBcdCAgICAgICAgLy8gVOG7lW5nIGjhu6NwIHThuqV0IGPhuqMgY8OhYyBwYW5lbCB2w6BvIHBhbmVsIGNow61uaFxuICAgNjkxXHQgICAgICAgIG1haW5TZWFyY2hQYW5lbC5hZGQoZmlyc3RSb3dQYW5lbCwgQm9yZGVyTGF5b3V0Lk5PUlRIKTtcbiAgIDY5Mlx0ICAgICAgICBtYWluU2VhcmNoUGFuZWwuYWRkKHNlY29uZFJvd1BhbmVsLCBCb3JkZXJMYXlvdXQuQ0VOVEVSKTtcbiAgIDY5M1x0ICAgICAgICBtYWluU2VhcmNoUGFuZWwuYWRkKGJ1dHRvblBhbmVsLCBCb3JkZXJMYXlvdXQuU09VVEgpO1xuICAgNjk0XHRcbiAgIDY5NVx0ICAgICAgICBvdXRlclBhbmVsLmFkZChtYWluU2VhcmNoUGFuZWwsIEJvcmRlckxheW91dC5DRU5URVIpO1xuICAgNjk2XHQgICAgICAgIHJldHVybiBvdXRlclBhbmVsO1xuICAgNjk3XHQgICAgfVxuICAgNjk4XHRcbiAgIDY5OVx0ICAgIC8qKlxuICAgNzAwXHQgICAgICogVGhp4bq/dCBs4bqtcCBjaOG7qWMgbsSDbmcgQXV0b0NvbXBsZXRlIGNobyBKQ29tYm9Cb3hcbiAgIDcwMVx0ICAgICAqIEBwYXJhbSBjb21ib0JveCBKQ29tYm9Cb3ggY+G6p24gdGjDqm0gY2jhu6ljIG7Eg25nIEF1dG9Db21wbGV0ZVxuICAgNzAyXHQgICAgICovXG4gICA3MDNcdCAgICBwcml2YXRlIHZvaWQgc2V0dXBBdXRvQ29tcGxldGUoSkNvbWJvQm94PFN0cmluZz4gY29tYm9Cb3gpIHtcbiAgIDcwNFx0ICAgICAgICBmaW5hbCBKVGV4dEZpZWxkIGVkaXRvciA9IChKVGV4dEZpZWxkKSBjb21ib0JveC5nZXRFZGl0b3IoKS5nZXRFZGl0b3JDb21wb25lbnQoKTtcbiAgIDcwNVx0XG4gICA3MDZcdCAgICAgICAgLy8gVOG6oW8gbeG7mXQgQXJyYXlMaXN0IMSR4buDIGzGsHUgY8OhYyBt4bulYyBiYW4gxJHhuqd1XG4gICA3MDdcdCAgICAgICAgZmluYWwgTGlzdDxTdHJpbmc+IG9yaWdpbmFsSXRlbXMgPSBuZXcgQXJyYXlMaXN0PD4oKTtcbiAgIDcwOFx0XG4gICA3MDlcdCAgICAgICAgLy8gxJDhuqNtIGLhuqNvIGNvbWJvQm94IGx1w7RuIGPDsyBcIlThuqV0IGPhuqNcIiBsw6AgbOG7sWEgY2jhu41uIG3hurdjIMSR4buLbmggxJHhuqd1IHRpw6puXG4gICA3MTBcdCAgICAgICAgY29tYm9Cb3guYWRkSXRlbShcIlThuqV0IGPhuqNcIik7XG4gICA3MTFcdCAgICAgICAgb3JpZ2luYWxJdGVtcy5hZGQoXCJU4bqldCBj4bqjXCIpO1xuICAgNzEyXHRcbiAgIDcxM1x0ICAgICAgICAvLyBU4bqhbyBt4buZdCBs4buNYyB2xINuIGLhuqNuIMSR4buDIHjhu60gbMO9IHPhu7Ega2nhu4duIGLDoG4gcGjDrW0gdGhheSB2w6wgZMO5bmcgRG9jdW1lbnRMaXN0ZW5lclxuICAgNzE0XHQgICAgICAgIGVkaXRvci5hZGRLZXlMaXN0ZW5lcihuZXcgS2V5QWRhcHRlcigpIHtcbiAgIDcxNVx0ICAgICAgICAgICAgQE92ZXJyaWRlXG4gICA3MTZcdCAgICAgICAgICAgIHB1YmxpYyB2b2lkIGtleVJlbGVhc2VkKEtleUV2ZW50IGUpIHtcbiAgIDcxN1x0ICAgICAgICAgICAgICAgIC8vIELhu48gcXVhIGPDoWMgcGjDrW0gxJHhurdjIGJp4buHdFxuICAgNzE4XHQgICAgICAgICAgICAgICAgaWYgKGUuZ2V0S2V5Q29kZSgpID09IEtleUV2ZW50LlZLX0VOVEVSIHx8XG4gICA3MTlcdCAgICAgICAgICAgICAgICAgICAgICAgIGUuZ2V0S2V5Q29kZSgpID09IEtleUV2ZW50LlZLX0VTQ0FQRSB8fFxuICAgNzIwXHQgICAgICAgICAgICAgICAgICAgICAgICBlLmdldEtleUNvZGUoKSA9PSBLZXlFdmVudC5WS19VUCB8fFxuICAgNzIxXHQgICAgICAgICAgICAgICAgICAgICAgICBlLmdldEtleUNvZGUoKSA9PSBLZXlFdmVudC5WS19ET1dOKSB7XG4gICA3MjJcdCAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgNzIzXHQgICAgICAgICAgICAgICAgfVxuICAgNzI0XHRcbiAgIDcyNVx0ICAgICAgICAgICAgICAgIC8vIEzhuqV5IHbEg24gYuG6o24gaGnhu4duIHThuqFpIHRyb25nIGVkaXRvclxuICAgNzI2XHQgICAgICAgICAgICAgICAgU3RyaW5nIHRleHQgPSBlZGl0b3IuZ2V0VGV4dCgpO1xuICAgNzI3XHRcbiAgIDcyOFx0ICAgICAgICAgICAgICAgIC8vIEtow7RuZyB0aOG7sWMgaGnhu4duIGzhu41jIG7hur91IHbEg24gYuG6o24gcXXDoSBuZ+G6r25cbiAgIDcyOVx0ICAgICAgICAgICAgICAgIGlmICh0ZXh0Lmxlbmd0aCgpIDwgMSkge1xuICAgNzMwXHQgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgIDczMVx0ICAgICAgICAgICAgICAgIH1cbiAgIDczMlx0XG4gICA3MzNcdCAgICAgICAgICAgICAgICAvLyBT4butIGThu6VuZyBTd2luZ1V0aWxpdGllcy5pbnZva2VMYXRlciDEkeG7gyB0csOhbmggbOG7l2kga2hpIHPhu61hIMSR4buVaSBtw7QgaMOsbmggdHJvbmcgbMO6YyB44butIGzDvSBz4buxIGtp4buHblxuICAgNzM0XHQgICAgICAgICAgICAgICAgU3dpbmdVdGlsaXRpZXMuaW52b2tlTGF0ZXIoKCkgLT4ge1xuICAgNzM1XHQgICAgICAgICAgICAgICAgICAgIGZpbHRlckl0ZW1zKGNvbWJvQm94LCB0ZXh0LCBvcmlnaW5hbEl0ZW1zKTtcbiAgIDczNlx0ICAgICAgICAgICAgICAgIH0pO1xuICAgNzM3XHQgICAgICAgICAgICB9XG4gICA3MzhcdCAgICAgICAgfSk7XG4gICA3MzlcdCAgICB9XG4gICA3NDBcdCAgICBwcml2YXRlIHZvaWQgZmlsdGVySXRlbXMoSkNvbWJvQm94PFN0cmluZz4gY29tYm9Cb3gsIFN0cmluZyB0ZXh0LCBMaXN0PFN0cmluZz4gb3JpZ2luYWxJdGVtcykge1xuICAgNzQxXHQgICAgICAgIC8vIEzGsHUgbOG6oWkgY8OhYyBs4buxYSBjaOG7jW4gaGnhu4duIHThuqFpXG4gICA3NDJcdCAgICAgICAgT2JqZWN0IHNlbGVjdGVkSXRlbSA9IGNvbWJvQm94LmdldFNlbGVjdGVkSXRlbSgpO1xuICAgNzQzXHQgICAgICAgIFN0cmluZyB0eXBlZFRleHQgPSB0ZXh0LnRvTG93ZXJDYXNlKCk7XG4gICA3NDRcdFxuICAgNzQ1XHQgICAgICAgIC8vIMSQw7NuZyBwb3B1cCB0cm9uZyBraGkgdGhheSDEkeG7lWkgbeG7pWNcbiAgIDc0Nlx0ICAgICAgICBib29sZWFuIGlzUG9wdXBWaXNpYmxlID0gY29tYm9Cb3guaXNQb3B1cFZpc2libGUoKTtcbiAgIDc0N1x0ICAgICAgICBpZiAoaXNQb3B1cFZpc2libGUpIHtcbiAgIDc0OFx0ICAgICAgICAgICAgY29tYm9Cb3guaGlkZVBvcHVwKCk7XG4gICA3NDlcdCAgICAgICAgfVxuICAgNzUwXHRcbiAgIDc1MVx0ICAgICAgICAvLyBU4bqhbyBkYW5oIHPDoWNoIGPDoWMgbeG7pWMgcGjDuSBo4bujcFxuICAgNzUyXHQgICAgICAgIExpc3Q8U3RyaW5nPiBtYXRjaGluZ0l0ZW1zID0gb3JpZ2luYWxJdGVtcy5zdHJlYW0oKVxuICAgNzUzXHQgICAgICAgICAgICAgICAgLmZpbHRlcihpdGVtIC0+IGl0ZW0udG9Mb3dlckNhc2UoKS5jb250YWlucyh0eXBlZFRleHQpIHx8IGl0ZW0uZXF1YWxzKFwiVOG6pXQgY+G6o1wiKSlcbiAgIDc1NFx0ICAgICAgICAgICAgICAgIC5jb2xsZWN0KENvbGxlY3RvcnMudG9MaXN0KCkpO1xuICAgNzU1XHRcbiAgIDc1Nlx0ICAgICAgICAvLyBMw6BtIG3hu5tpIG3DtCBow6xuaCBjaOG7iSBraGkgY+G6p24gdGhp4bq/dFxuICAgNzU3XHQgICAgICAgIERlZmF1bHRDb21ib0JveE1vZGVsPFN0cmluZz4gbW9kZWwgPSAoRGVmYXVsdENvbWJvQm94TW9kZWw8U3RyaW5nPikgY29tYm9Cb3guZ2V0TW9kZWwoKTtcbiAgIDc1OFx0ICAgICAgICBtb2RlbC5yZW1vdmVBbGxFbGVtZW50cygpO1xuICAgNzU5XHRcbiAgIDc2MFx0ICAgICAgICAvLyBMdcO0biB0aMOqbSBcIlThuqV0IGPhuqNcIiB0csaw4bubYyB0acOqblxuICAgNzYxXHQgICAgICAgIG1vZGVsLmFkZEVsZW1lbnQoXCJU4bqldCBj4bqjXCIpO1xuICAgNzYyXHRcbiAgIDc2M1x0ICAgICAgICAvLyBUaMOqbSBjw6FjIG3hu6VjIHBow7kgaOG7o3AgKHRy4burIFwiVOG6pXQgY+G6o1wiIMSRw6MgdGjDqm0pXG4gICA3NjRcdCAgICAgICAgbWF0Y2hpbmdJdGVtcy5zdHJlYW0oKVxuICAgNzY1XHQgICAgICAgICAgICAgICAgLmZpbHRlcihpdGVtIC0+ICFpdGVtLmVxdWFscyhcIlThuqV0IGPhuqNcIikpXG4gICA3NjZcdCAgICAgICAgICAgICAgICAuZm9yRWFjaChtb2RlbDo6YWRkRWxlbWVudCk7XG4gICA3NjdcdFxuICAgNzY4XHQgICAgICAgIC8vIMSQ4bq3dCBs4bqhaSB2xINuIGLhuqNuIGNobyBlZGl0b3JcbiAgIDc2OVx0ICAgICAgICBjb21ib0JveC5nZXRFZGl0b3IoKS5zZXRJdGVtKHRleHQpO1xuICAgNzcwXHRcbiAgIDc3MVx0ICAgICAgICAvLyBIaeG7g24gdGjhu4sgbOG6oWkgcG9wdXAgbuG6v3UgdHLGsOG7m2MgxJHDsyDEkcOjIG3hu59cbiAgIDc3Mlx0ICAgICAgICBpZiAoaXNQb3B1cFZpc2libGUgJiYgbW9kZWwuZ2V0U2l6ZSgpID4gMCkge1xuICAgNzczXHQgICAgICAgICAgICBjb21ib0JveC5zaG93UG9wdXAoKTtcbiAgIDc3NFx0ICAgICAgICB9XG4gICA3NzVcdCAgICB9XG4gICA3NzZcdCAgICAvKipcbiAgIDc3N1x0ICAgICAqIFThuqNpIGRhbmggc8OhY2ggZ2EgdsOgbyBjw6FjIEpDb21ib0JveFxuICAgNzc4XHQgICAgICovXG4gICA3NzlcdCAgICBwcml2YXRlIHZvaWQgbG9hZFN0YXRpb25MaXN0KEpDb21ib0JveDxTdHJpbmc+IGRlcENvbWJvQm94LCBKQ29tYm9Cb3g8U3RyaW5nPiBhcnJDb21ib0JveCkge1xuICAgNzgwXHQgICAgICAgIHRyeSB7XG4gICA3ODFcdCAgICAgICAgICAgIGlmIChpc0Nvbm5lY3RlZCAmJiBsaWNoVHJpbmhUYXVEQU8gIT0gbnVsbCkge1xuICAgNzgyXHQgICAgICAgICAgICAgICAgLy8gTOG6pXkgZGFuaCBzw6FjaCBnYSB04burIGPGoSBz4bufIGThu68gbGnhu4d1XG4gICA3ODNcdCAgICAgICAgICAgICAgICBMaXN0PFN0cmluZz4gc3RhdGlvbnMgPSBsaWNoVHJpbmhUYXVEQU8uZ2V0QWxsU3RhdGlvbnMoKTtcbiAgIDc4NFx0XG4gICA3ODVcdCAgICAgICAgICAgICAgICAvLyBYw7NhIHThuqV0IGPhuqMgY8OhYyBt4bulYyBoaeG7h24gY8OzXG4gICA3ODZcdCAgICAgICAgICAgICAgICBkZXBDb21ib0JveC5yZW1vdmVBbGxJdGVtcygpO1xuICAgNzg3XHQgICAgICAgICAgICAgICAgYXJyQ29tYm9Cb3gucmVtb3ZlQWxsSXRlbXMoKTtcbiAgIDc4OFx0XG4gICA3ODlcdCAgICAgICAgICAgICAgICAvLyBMdcO0biB0aMOqbSBcIlThuqV0IGPhuqNcIiB0csaw4bubYyB0acOqblxuICAgNzkwXHQgICAgICAgICAgICAgICAgZGVwQ29tYm9Cb3guYWRkSXRlbShcIlThuqV0IGPhuqNcIik7XG4gICA3OTFcdCAgICAgICAgICAgICAgICBhcnJDb21ib0JveC5hZGRJdGVtKFwiVOG6pXQgY+G6o1wiKTtcbiAgIDc5Mlx0XG4gICA3OTNcdCAgICAgICAgICAgICAgICBpZiAoc3RhdGlvbnMgIT0gbnVsbCAmJiAhc3RhdGlvbnMuaXNFbXB0eSgpKSB7XG4gICA3OTRcdCAgICAgICAgICAgICAgICAgICAgLy8gVGjDqm0gY8OhYyBnYSB2w6BvIENvbWJvQm94IG3hu5l0IGPDoWNoIGFuIHRvw6BuXG4gICA3OTVcdCAgICAgICAgICAgICAgICAgICAgZm9yIChTdHJpbmcgc3RhdGlvbiA6IHN0YXRpb25zKSB7XG4gICA3OTZcdCAgICAgICAgICAgICAgICAgICAgICAgIGRlcENvbWJvQm94LmFkZEl0ZW0oc3RhdGlvbik7XG4gICA3OTdcdCAgICAgICAgICAgICAgICAgICAgICAgIGFyckNvbWJvQm94LmFkZEl0ZW0oc3RhdGlvbik7XG4gICA3OThcdCAgICAgICAgICAgICAgICAgICAgfVxuICAgNzk5XHRcbiAgIDgwMFx0ICAgICAgICAgICAgICAgICAgICAvLyBUaGnhur90IGzhuq1wIEF1dG9Db21wbGV0ZSBjaG8gY8OhYyBDb21ib0JveCBzYXUga2hpIMSRw6MgdGjDqm0gdOG6pXQgY+G6oyBjw6FjIG3hu6VjXG4gICA4MDFcdCAgICAgICAgICAgICAgICAgICAgc2V0dXBDb21ib0JveEZpbHRlcmluZyhkZXBDb21ib0JveCk7XG4gICA4MDJcdCAgICAgICAgICAgICAgICAgICAgc2V0dXBDb21ib0JveEZpbHRlcmluZyhhcnJDb21ib0JveCk7XG4gICA4MDNcdFxuICAgODA0XHQgICAgICAgICAgICAgICAgICAgIExPR0dFUi5pbmZvKFwixJDDoyB04bqjaSB0aMOgbmggY8O0bmcgXCIgKyBzdGF0aW9ucy5zaXplKCkgKyBcIiBnYSB04burIGPGoSBz4bufIGThu68gbGnhu4d1XCIpO1xuICAgODA1XHQgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgIDgwNlx0ICAgICAgICAgICAgICAgICAgICBMT0dHRVIud2FybmluZyhcIktow7RuZyB0w6xtIHRo4bqleSBnYSBuw6BvIHRyb25nIGPGoSBz4bufIGThu68gbGnhu4d1XCIpO1xuICAgODA3XHQgICAgICAgICAgICAgICAgfVxuICAgODA4XHQgICAgICAgICAgICB9XG4gICA4MDlcdCAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgIDgxMFx0ICAgICAgICAgICAgTE9HR0VSLmxvZyhMZXZlbC5TRVZFUkUsIFwiTOG7l2kga2hpIHThuqNpIGRhbmggc8OhY2ggZ2E6IFwiICsgZS5nZXRNZXNzYWdlKCksIGUpO1xuICAgODExXHQgICAgICAgIH1cbiAgIDgxMlx0ICAgIH1cbiAgIDgxM1x0ICAgIHByaXZhdGUgdm9pZCBzZXR1cENvbWJvQm94RmlsdGVyaW5nKEpDb21ib0JveDxTdHJpbmc+IGNvbWJvQm94KSB7XG4gICA4MTRcdCAgICAgICAgLy8gxJDhuqNtIGLhuqNvIENvbWJvQm94IGPDsyB0aOG7gyBjaOG7iW5oIHPhu61hXG4gICA4MTVcdCAgICAgICAgY29tYm9Cb3guc2V0RWRpdGFibGUodHJ1ZSk7XG4gICA4MTZcdFxuICAgODE3XHQgICAgICAgIC8vIEzhuqV5IHThuqV0IGPhuqMgY8OhYyBt4bulYyBoaeG7h24gdOG6oWlcbiAgIDgxOFx0ICAgICAgICBMaXN0PFN0cmluZz4gYWxsSXRlbXMgPSBuZXcgQXJyYXlMaXN0PD4oKTtcbiAgIDgxOVx0ICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNvbWJvQm94LmdldEl0ZW1Db3VudCgpOyBpKyspIHtcbiAgIDgyMFx0ICAgICAgICAgICAgYWxsSXRlbXMuYWRkKGNvbWJvQm94LmdldEl0ZW1BdChpKSk7XG4gICA4MjFcdCAgICAgICAgfVxuICAgODIyXHRcbiAgIDgyM1x0ICAgICAgICAvLyBUaGnhur90IGzhuq1wIHJlbmRlcmVyIMSR4bq3YyBiaeG7h3QgxJHhu4MgaGlnaGxpZ2h0IHThu6sga2jDs2EgdMOsbSBraeG6v21cbiAgIDgyNFx0ICAgICAgICBjb21ib0JveC5zZXRSZW5kZXJlcihuZXcgRGVmYXVsdExpc3RDZWxsUmVuZGVyZXIoKSB7XG4gICA4MjVcdCAgICAgICAgICAgIEBPdmVycmlkZVxuICAgODI2XHQgICAgICAgICAgICBwdWJsaWMgQ29tcG9uZW50IGdldExpc3RDZWxsUmVuZGVyZXJDb21wb25lbnQoSkxpc3Q8Pz4gbGlzdCwgT2JqZWN0IHZhbHVlLFxuICAgODI3XHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGluZGV4LCBib29sZWFuIGlzU2VsZWN0ZWQsIGJvb2xlYW4gY2VsbEhhc0ZvY3VzKSB7XG4gICA4MjhcdCAgICAgICAgICAgICAgICBDb21wb25lbnQgYyA9IHN1cGVyLmdldExpc3RDZWxsUmVuZGVyZXJDb21wb25lbnQobGlzdCwgdmFsdWUsIGluZGV4LCBpc1NlbGVjdGVkLCBjZWxsSGFzRm9jdXMpO1xuICAgODI5XHRcbiAgIDgzMFx0ICAgICAgICAgICAgICAgIGlmIChjIGluc3RhbmNlb2YgSkxhYmVsICYmIHZhbHVlICE9IG51bGwpIHtcbiAgIDgzMVx0ICAgICAgICAgICAgICAgICAgICAoKEpMYWJlbCkgYykuc2V0VGV4dCh2YWx1ZS50b1N0cmluZygpKTtcbiAgIDgzMlx0ICAgICAgICAgICAgICAgIH1cbiAgIDgzM1x0XG4gICA4MzRcdCAgICAgICAgICAgICAgICByZXR1cm4gYztcbiAgIDgzNVx0ICAgICAgICAgICAgfVxuICAgODM2XHQgICAgICAgIH0pO1xuICAgODM3XHRcbiAgIDgzOFx0ICAgICAgICAvLyBT4butIGThu6VuZyBLZXlBZGFwdGVyIMSR4buDIHjhu60gbMO9IHPhu7Ega2nhu4duIGfDtSBwaMOtbVxuICAgODM5XHQgICAgICAgIEpUZXh0RmllbGQgZWRpdG9yID0gKEpUZXh0RmllbGQpIGNvbWJvQm94LmdldEVkaXRvcigpLmdldEVkaXRvckNvbXBvbmVudCgpO1xuICAgODQwXHQgICAgICAgIGVkaXRvci5hZGRLZXlMaXN0ZW5lcihuZXcgS2V5QWRhcHRlcigpIHtcbiAgIDg0MVx0ICAgICAgICAgICAgQE92ZXJyaWRlXG4gICA4NDJcdCAgICAgICAgICAgIHB1YmxpYyB2b2lkIGtleVJlbGVhc2VkKEtleUV2ZW50IGUpIHtcbiAgIDg0M1x0ICAgICAgICAgICAgICAgIC8vIEtow7RuZyB44butIGzDvSBjw6FjIHBow61tIMSR4bq3YyBiaeG7h3RcbiAgIDg0NFx0ICAgICAgICAgICAgICAgIGlmIChlLmdldEtleUNvZGUoKSA9PSBLZXlFdmVudC5WS19FTlRFUiB8fCBlLmdldEtleUNvZGUoKSA9PSBLZXlFdmVudC5WS19VUCB8fFxuICAgODQ1XHQgICAgICAgICAgICAgICAgICAgICAgICBlLmdldEtleUNvZGUoKSA9PSBLZXlFdmVudC5WS19ET1dOIHx8IGUuZ2V0S2V5Q29kZSgpID09IEtleUV2ZW50LlZLX0VTQ0FQRSkge1xuICAgODQ2XHQgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgIDg0N1x0ICAgICAgICAgICAgICAgIH1cbiAgIDg0OFx0XG4gICA4NDlcdCAgICAgICAgICAgICAgICBTdHJpbmcgdGV4dCA9IGVkaXRvci5nZXRUZXh0KCkudG9Mb3dlckNhc2UoKTtcbiAgIDg1MFx0XG4gICA4NTFcdCAgICAgICAgICAgICAgICAvLyBT4butIGThu6VuZyBTd2luZ1V0aWxpdGllcy5pbnZva2VMYXRlciDEkeG7gyB0csOhbmggbOG7l2kga2hpIHRoYXkgxJHhu5VpIG3DtCBow6xuaCB0cm9uZyBz4buxIGtp4buHblxuICAgODUyXHQgICAgICAgICAgICAgICAgU3dpbmdVdGlsaXRpZXMuaW52b2tlTGF0ZXIoKCkgLT4ge1xuICAgODUzXHQgICAgICAgICAgICAgICAgICAgIC8vIEzGsHUgbOG6oWkgdHLhuqFuZyB0aMOhaSBwb3B1cFxuICAgODU0XHQgICAgICAgICAgICAgICAgICAgIGJvb2xlYW4gd2FzVmlzaWJsZSA9IGNvbWJvQm94LmlzUG9wdXBWaXNpYmxlKCk7XG4gICA4NTVcdCAgICAgICAgICAgICAgICAgICAgY29tYm9Cb3guaGlkZVBvcHVwKCk7XG4gICA4NTZcdFxuICAgODU3XHQgICAgICAgICAgICAgICAgICAgIC8vIFThuqFvIG1vZGVsIG3hu5tpXG4gICA4NThcdCAgICAgICAgICAgICAgICAgICAgRGVmYXVsdENvbWJvQm94TW9kZWw8U3RyaW5nPiBtb2RlbCA9IG5ldyBEZWZhdWx0Q29tYm9Cb3hNb2RlbDw+KCk7XG4gICA4NTlcdFxuICAgODYwXHQgICAgICAgICAgICAgICAgICAgIC8vIEx1w7RuIHRow6ptIFwiVOG6pXQgY+G6o1wiIHbDoG8gxJHhuqd1IHRpw6puXG4gICA4NjFcdCAgICAgICAgICAgICAgICAgICAgbW9kZWwuYWRkRWxlbWVudChcIlThuqV0IGPhuqNcIik7XG4gICA4NjJcdFxuICAgODYzXHQgICAgICAgICAgICAgICAgICAgIC8vIFRow6ptIGPDoWMgbeG7pWMgcGjDuSBo4bujcFxuICAgODY0XHQgICAgICAgICAgICAgICAgICAgIGZvciAoU3RyaW5nIGl0ZW0gOiBhbGxJdGVtcykge1xuICAgODY1XHQgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWl0ZW0uZXF1YWxzKFwiVOG6pXQgY+G6o1wiKSAmJiBpdGVtLnRvTG93ZXJDYXNlKCkuY29udGFpbnModGV4dCkpIHtcbiAgIDg2Nlx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLmFkZEVsZW1lbnQoaXRlbSk7XG4gICA4NjdcdCAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgIDg2OFx0ICAgICAgICAgICAgICAgICAgICB9XG4gICA4NjlcdFxuICAgODcwXHQgICAgICAgICAgICAgICAgICAgIC8vIMOBcCBk4bulbmcgbW9kZWwgbeG7m2lcbiAgIDg3MVx0ICAgICAgICAgICAgICAgICAgICBjb21ib0JveC5zZXRNb2RlbChtb2RlbCk7XG4gICA4NzJcdFxuICAgODczXHQgICAgICAgICAgICAgICAgICAgIC8vIMSQ4bq3dCBs4bqhaSB2xINuIGLhuqNuXG4gICA4NzRcdCAgICAgICAgICAgICAgICAgICAgY29tYm9Cb3guZ2V0RWRpdG9yKCkuc2V0SXRlbSh0ZXh0KTtcbiAgIDg3NVx0ICAgICAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0Q2FyZXRQb3NpdGlvbih0ZXh0Lmxlbmd0aCgpKTtcbiAgIDg3Nlx0XG4gICA4NzdcdCAgICAgICAgICAgICAgICAgICAgLy8gSGnhu4NuIHRo4buLIGzhuqFpIHBvcHVwIG7hur91IHRyxrDhu5tjIMSRw7MgxJHDoyBt4bufIHbDoCBjw7Mga+G6v3QgcXXhuqNcbiAgIDg3OFx0ICAgICAgICAgICAgICAgICAgICBpZiAoKHdhc1Zpc2libGUgfHwgIXRleHQuaXNFbXB0eSgpKSAmJiBtb2RlbC5nZXRTaXplKCkgPiAwKSB7XG4gICA4NzlcdCAgICAgICAgICAgICAgICAgICAgICAgIGNvbWJvQm94LnNob3dQb3B1cCgpO1xuICAgODgwXHQgICAgICAgICAgICAgICAgICAgIH1cbiAgIDg4MVx0ICAgICAgICAgICAgICAgIH0pO1xuICAgODgyXHQgICAgICAgICAgICB9XG4gICA4ODNcdCAgICAgICAgfSk7XG4gICA4ODRcdCAgICB9XG4gICA4ODVcdFxuICAgODg2XHQgICAgcHJpdmF0ZSB2b2lkIHNlYXJjaFNjaGVkdWxlcyhMb2NhbERhdGUgZGF0ZSwgU3RyaW5nIGdhRGksIFN0cmluZyBnYURlbiwgU3RyaW5nIGdpb0RpKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uIHtcbiAgIDg4N1x0ICAgICAgICBpZiAoIWlzQ29ubmVjdGVkIHx8IGxpY2hUcmluaFRhdURBTyA9PSBudWxsKSB7XG4gICA4ODhcdCAgICAgICAgICAgIHJlY29ubmVjdEFuZExvYWREYXRhKGRhdGUpO1xuICAgODg5XHQgICAgICAgICAgICBpZiAoIWlzQ29ubmVjdGVkKSB7XG4gICA4OTBcdCAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUmVtb3RlRXhjZXB0aW9uKFwiS2jDtG5nIHRo4buDIGvhur90IG7hu5FpIMSR4bq/biBzZXJ2ZXJcIik7XG4gICA4OTFcdCAgICAgICAgICAgIH1cbiAgIDg5Mlx0ICAgICAgICB9XG4gICA4OTNcdFxuICAgODk0XHQgICAgICAgIHRhYmxlTW9kZWwuc2V0Um93Q291bnQoMCk7XG4gICA4OTVcdCAgICAgICAgTGlzdDxMaWNoVHJpbmhUYXU+IHNjaGVkdWxlcztcbiAgIDg5Nlx0XG4gICA4OTdcdCAgICAgICAgdHJ5IHtcbiAgIDg5OFx0ICAgICAgICAgICAgLy8gUXV54bq/dCDEkeG7i25oIHBoxrDGoW5nIHRo4bupYyB0w6xtIGtp4bq/bSBk4buxYSB0csOqbiBjw6FjIHRoYW0gc+G7kVxuICAgODk5XHQgICAgICAgICAgICBpZiAoZ2FEaSA9PSBudWxsICYmIGdhRGVuID09IG51bGwgJiYgZ2lvRGkgPT0gbnVsbCkge1xuICAgOTAwXHQgICAgICAgICAgICAgICAgLy8gQ2jhu4kgdMOsbSB0aGVvIG5nw6B5XG4gICA5MDFcdCAgICAgICAgICAgICAgICBzY2hlZHVsZXMgPSBsaWNoVHJpbmhUYXVEQU8uZ2V0TGlzdExpY2hUcmluaFRhdUJ5RGF0ZShkYXRlKTtcbiAgIDkwMlx0ICAgICAgICAgICAgfSBlbHNlIGlmIChnYURpICE9IG51bGwgJiYgZ2FEZW4gPT0gbnVsbCAmJiBnaW9EaSA9PSBudWxsKSB7XG4gICA5MDNcdCAgICAgICAgICAgICAgICAvLyBUw6xtIHRoZW8gbmfDoHkgdsOgIGdhIMSRaVxuICAgOTA0XHQgICAgICAgICAgICAgICAgc2NoZWR1bGVzID0gbGljaFRyaW5oVGF1REFPLmdldExpc3RMaWNoVHJpbmhUYXVCeURhdGVBbmRHYURpKGRhdGUsIGdhRGkpO1xuICAgOTA1XHQgICAgICAgICAgICB9IGVsc2UgaWYgKGdhRGkgIT0gbnVsbCAmJiBnYURlbiAhPSBudWxsICYmIGdpb0RpID09IG51bGwpIHtcbiAgIDkwNlx0ICAgICAgICAgICAgICAgIC8vIFTDrG0gdGhlbyBuZ8OgeSwgZ2EgxJFpIHbDoCBnYSDEkeG6v25cbiAgIDkwN1x0ICAgICAgICAgICAgICAgIHNjaGVkdWxlcyA9IGxpY2hUcmluaFRhdURBTy5nZXRMaXN0TGljaFRyaW5oVGF1QnlEYXRlQW5kR2FEaUdhRGVuKGRhdGUsIGdhRGksIGdhRGVuKTtcbiAgIDkwOFx0ICAgICAgICAgICAgfSBlbHNlIGlmIChnYURpICE9IG51bGwgJiYgZ2FEZW4gIT0gbnVsbCAmJiBnaW9EaSAhPSBudWxsKSB7XG4gICA5MDlcdCAgICAgICAgICAgICAgICAvLyBUw6xtIHRoZW8gdOG6pXQgY+G6oyBjw6FjIHRyxrDhu51uZ1xuICAgOTEwXHQgICAgICAgICAgICAgICAgc2NoZWR1bGVzID0gbGljaFRyaW5oVGF1REFPLmdldExpc3RMaWNoVHJpbmhUYXVCeURhdGVBbmRHYURpR2FEZW5BbmRHaW9EaShkYXRlLCBnYURpLCBnYURlbiwgZ2lvRGkpO1xuICAgOTExXHQgICAgICAgICAgICB9IGVsc2Uge1xuICAgOTEyXHQgICAgICAgICAgICAgICAgLy8gVHLGsOG7nW5nIGjhu6NwIGPDsm4gbOG6oWk6IGPDsyBnYSDEkeG6v24gbmjGsG5nIGtow7RuZyBjw7MgZ2EgxJFpLCBob+G6t2MgY8OzIGdp4budIMSRaSBuaMawbmcgdGhp4bq/dSBnYSDEkWkvxJHhur9uXG4gICA5MTNcdCAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyh0aGlzLFxuICAgOTE0XHQgICAgICAgICAgICAgICAgICAgICAgICBcIsSQ4buDIHTDrG0ga2nhur9tIHbhu5tpIGdhIMSR4bq/biwgYuG6oW4gY+G6p24gY2jhu41uIGdhIMSRaSB0csaw4bubYy5cXG5cIiArXG4gICA5MTVcdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCLEkOG7gyB0w6xtIGtp4bq/bSB24bubaSBnaeG7nSDEkWksIGLhuqFuIGPhuqduIGNo4buNbiBj4bqjIGdhIMSRaSB2w6AgZ2EgxJHhur9uLlwiLFxuICAgOTE2XHQgICAgICAgICAgICAgICAgICAgICAgICBcIlRow7RuZyBiw6FvXCIsIEpPcHRpb25QYW5lLklORk9STUFUSU9OX01FU1NBR0UpO1xuICAgOTE3XHQgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgOTE4XHQgICAgICAgICAgICB9XG4gICA5MTlcdFxuICAgOTIwXHQgICAgICAgICAgICBpZiAoc2NoZWR1bGVzID09IG51bGwgfHwgc2NoZWR1bGVzLmlzRW1wdHkoKSkge1xuICAgOTIxXHQgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2codGhpcyxcbiAgIDkyMlx0ICAgICAgICAgICAgICAgICAgICAgICAgXCJLaMO0bmcgdMOsbSB0aOG6pXkgbOG7i2NoIHRyw6xuaCBuw6BvIHBow7kgaOG7o3AgduG7m2kgdGnDqnUgY2jDrSB0w6xtIGtp4bq/bS5cIixcbiAgIDkyM1x0ICAgICAgICAgICAgICAgICAgICAgICAgXCJUaMO0bmcgYsOhb1wiLFxuICAgOTI0XHQgICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5JTkZPUk1BVElPTl9NRVNTQUdFKTtcbiAgIDkyNVx0ICAgICAgICAgICAgICAgIHJldHVybjtcbiAgIDkyNlx0ICAgICAgICAgICAgfVxuICAgOTI3XHRcbiAgIDkyOFx0ICAgICAgICAgICAgLy8gw4FwIGThu6VuZyBi4buZIGzhu41jIHRy4bqhbmcgdGjDoWkgbuG6v3UgxJHGsOG7o2MgY2jhu41uXG4gICA5MjlcdCAgICAgICAgICAgIE9iamVjdCBzZWxlY3RlZEl0ZW0gPSBmaWx0ZXJDb21ib0JveC5nZXRTZWxlY3RlZEl0ZW0oKTtcbiAgIDkzMFx0XG4gICA5MzFcdCAgICAgICAgICAgIGZvciAoTGljaFRyaW5oVGF1IHNjaGVkdWxlIDogc2NoZWR1bGVzKSB7XG4gICA5MzJcdCAgICAgICAgICAgICAgICAvLyBLaeG7g20gdHJhIHhlbSBs4buLY2ggdHLDrG5oIGPDsyBwaMO5IGjhu6NwIHbhu5tpIGLhu5kgbOG7jWMgdHLhuqFuZyB0aMOhaSBoYXkga2jDtG5nXG4gICA5MzNcdCAgICAgICAgICAgICAgICBpZiAobWF0Y2hlc1N0YXR1c0ZpbHRlcihzY2hlZHVsZSwgc2VsZWN0ZWRJdGVtKSkge1xuICAgOTM0XHQgICAgICAgICAgICAgICAgICAgIHRhYmxlTW9kZWwuYWRkUm93KGNyZWF0ZVRhYmxlUm93KHNjaGVkdWxlKSk7XG4gICA5MzVcdCAgICAgICAgICAgICAgICB9XG4gICA5MzZcdCAgICAgICAgICAgIH1cbiAgIDkzN1x0XG4gICA5MzhcdCAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgIDkzOVx0ICAgICAgICAgICAgTE9HR0VSLmxvZyhMZXZlbC5TRVZFUkUsIFwiTOG7l2kgY2hpIHRp4bq/dCBraGkgdMOsbSBraeG6v206IFwiICsgZS5nZXRNZXNzYWdlKCksIGUpO1xuICAgOTQwXHQgICAgICAgICAgICB0aHJvdyBuZXcgUmVtb3RlRXhjZXB0aW9uKFwiTOG7l2kga2hpIHTDrG0ga2nhur9tOiBcIiArIGUuZ2V0TWVzc2FnZSgpLCBlKTtcbiAgIDk0MVx0ICAgICAgICB9XG4gICA5NDJcdCAgICB9XG4gICA5NDNcdFxuICAgOTQ0XHQgICAgLy8gUGjGsMahbmcgdGjhu6ljIG3hu5tpIMSR4buDIGtp4buDbSB0cmEgdHLhuqFuZyB0aMOhaVxuICAgOTQ1XHQgICAgcHJpdmF0ZSBib29sZWFuIG1hdGNoZXNTdGF0dXNGaWx0ZXIoTGljaFRyaW5oVGF1IHNjaGVkdWxlLCBPYmplY3QgZmlsdGVyVmFsdWUpIHtcbiAgIDk0Nlx0ICAgICAgICAvLyBO4bq/dSBsw6AgXCJU4bqldCBj4bqjXCIgaG/hurdjIG51bGwsIGhp4buDbiB0aOG7iyB04bqldCBj4bqjXG4gICA5NDdcdCAgICAgICAgaWYgKGZpbHRlclZhbHVlID09IG51bGwgfHwgXCJU4bqldCBj4bqjXCIuZXF1YWxzKGZpbHRlclZhbHVlKSkge1xuICAgOTQ4XHQgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgIDk0OVx0ICAgICAgICB9XG4gICA5NTBcdFxuICAgOTUxXHQgICAgICAgIC8vIE7hur91IGzhu4tjaCB0csOsbmgga2jDtG5nIGPDsyB0cuG6oW5nIHRow6FpLCBraMO0bmcgcGjDuSBo4bujcCB24bubaSBi4bqldCBr4buzIGLhu5kgbOG7jWMgbsOgbyBuZ2/huqFpIHRy4burIFwiVOG6pXQgY+G6o1wiXG4gICA5NTJcdCAgICAgICAgaWYgKHNjaGVkdWxlLmdldFRyYW5nVGhhaSgpID09IG51bGwpIHtcbiAgIDk1M1x0ICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgOTU0XHQgICAgICAgIH1cbiAgIDk1NVx0XG4gICA5NTZcdCAgICAgICAgLy8gTuG6v3UgZmlsdGVyVmFsdWUgbMOgIG3hu5l0IFRyYW5nVGhhaSBlbnVtXG4gICA5NTdcdCAgICAgICAgaWYgKGZpbHRlclZhbHVlIGluc3RhbmNlb2YgVHJhbmdUaGFpKSB7XG4gICA5NThcdCAgICAgICAgICAgIHJldHVybiBzY2hlZHVsZS5nZXRUcmFuZ1RoYWkoKSA9PSBmaWx0ZXJWYWx1ZTtcbiAgIDk1OVx0ICAgICAgICB9XG4gICA5NjBcdFxuICAgOTYxXHQgICAgICAgIC8vIE7hur91IGZpbHRlclZhbHVlIGzDoCBt4buZdCBjaHXhu5dpIChnacOhIHRy4buLIGhp4buDbiB0aOG7iylcbiAgIDk2Mlx0ICAgICAgICBTdHJpbmcgZmlsdGVyU3RyaW5nID0gZmlsdGVyVmFsdWUudG9TdHJpbmcoKTtcbiAgIDk2M1x0XG4gICA5NjRcdCAgICAgICAgLy8gU28gc8OhbmggduG7m2kgZ2nDoSB0cuG7iyBoaeG7g24gdGjhu4sgY+G7p2EgdHLhuqFuZyB0aMOhaVxuICAgOTY1XHQgICAgICAgIHJldHVybiBzY2hlZHVsZS5nZXRUcmFuZ1RoYWkoKS5nZXRWYWx1ZSgpLmVxdWFscyhmaWx0ZXJTdHJpbmcpO1xuICAgOTY2XHQgICAgfVxuICAgOTY3XHQgICAgcHJpdmF0ZSBKUGFuZWwgY3JlYXRlVGFibGVQYW5lbCgpIHtcbiAgIDk2OFx0ICAgICAgICBKUGFuZWwgcGFuZWwgPSBuZXcgSlBhbmVsKG5ldyBCb3JkZXJMYXlvdXQoKSk7XG4gICA5NjlcdCAgICAgICAgcGFuZWwuc2V0Qm9yZGVyKEJvcmRlckZhY3RvcnkuY3JlYXRlVGl0bGVkQm9yZGVyKFwiRGFuaCBTw6FjaCBM4buLY2ggVHLDrG5oXCIpKTtcbiAgIDk3MFx0XG4gICA5NzFcdCAgICAgICAgLy8gQ3JlYXRlIHRhYmxlIG1vZGVsIHdpdGggbm9uLWVkaXRhYmxlIGNlbGxzXG4gICA5NzJcdCAgICAgICAgU3RyaW5nW10gY29sdW1ucyA9IHtcIklEXCIsIFwiTmfDoHkgxJBpXCIsIFwiTcOjIFTDoHUgLSBUw6puIFTDoHVcIiwgXCJUdXnhur9uIMSQxrDhu51uZ1wiLCBcIkdp4budIMSQaVwiLCBcIkdp4budIMSQ4bq/blwiLCBcIlRy4bqhbmcgVGjDoWlcIn07XG4gICA5NzNcdCAgICAgICAgdGFibGVNb2RlbCA9IG5ldyBEZWZhdWx0VGFibGVNb2RlbChjb2x1bW5zLCAwKSB7XG4gICA5NzRcdCAgICAgICAgICAgIEBPdmVycmlkZVxuICAgOTc1XHQgICAgICAgICAgICBwdWJsaWMgYm9vbGVhbiBpc0NlbGxFZGl0YWJsZShpbnQgcm93LCBpbnQgY29sdW1uKSB7XG4gICA5NzZcdCAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICA5NzdcdCAgICAgICAgICAgIH1cbiAgIDk3OFx0ICAgICAgICB9O1xuICAgOTc5XHRcbiAgIDk4MFx0ICAgICAgICAvLyBDcmVhdGUgYW5kIGNvbmZpZ3VyZSB0YWJsZVxuICAgOTgxXHQgICAgICAgIHNjaGVkdWxlVGFibGUgPSBuZXcgSlRhYmxlKHRhYmxlTW9kZWwpO1xuICAgOTgyXHQgICAgICAgIHNjaGVkdWxlVGFibGUuc2V0Um93SGVpZ2h0KDI1KTtcbiAgIDk4M1x0ICAgICAgICBzY2hlZHVsZVRhYmxlLnNldFNlbGVjdGlvbk1vZGUoTGlzdFNlbGVjdGlvbk1vZGVsLlNJTkdMRV9TRUxFQ1RJT04pO1xuICAgOTg0XHQgICAgICAgIHNjaGVkdWxlVGFibGUuc2V0QXV0b0NyZWF0ZVJvd1NvcnRlcih0cnVlKTtcbiAgIDk4NVx0XG4gICA5ODZcdCAgICAgICAgLy8gVGhp4bq/dCBs4bqtcCBtw6B1IG7hu4FuIGNobyBow6BuZyBs4bq7IHbDoCBow6BuZyBjaOG6tW5cbiAgIDk4N1x0ICAgICAgICBzY2hlZHVsZVRhYmxlLnNldERlZmF1bHRSZW5kZXJlcihPYmplY3QuY2xhc3MsIG5ldyBDdXN0b21UYWJsZUNlbGxSZW5kZXJlcigpKTtcbiAgIDk4OFx0XG4gICA5ODlcdCAgICAgICAgLy8gU3R5bGUgdGhlIHRhYmxlIGhlYWRlclxuICAgOTkwXHQgICAgICAgIEpUYWJsZUhlYWRlciBoZWFkZXIgPSBzY2hlZHVsZVRhYmxlLmdldFRhYmxlSGVhZGVyKCk7XG4gICA5OTFcdCAgICAgICAgaGVhZGVyLnNldEZvbnQobmV3IEZvbnQoXCJBcmlhbFwiLCBGb250LkJPTEQsIDEyKSk7XG4gICA5OTJcdCAgICAgICAgaGVhZGVyLnNldEJhY2tncm91bmQobmV3IENvbG9yKDQxLCAxMjgsIDE4NSkpOyAvLyBNw6B1IHhhbmggZMawxqFuZyBjaG8gaGVhZGVyXG4gICA5OTNcdCAgICAgICAgaGVhZGVyLnNldEZvcmVncm91bmQoQ29sb3IuV0hJVEUpOyAgLy8gTcOgdSB0cuG6r25nIGNobyBjaOG7r1xuICAgOTk0XHRcbiAgIDk5NVx0ICAgICAgICAvLyDDgXAgZOG7pW5nIGN1c3RvbSBVSSBjaG8gYuG6o25nIMSR4buDIGPDsyBoaeG7h3Ug4bupbmcgaG92ZXJcbiAgIDk5Nlx0ICAgICAgICBzZXR1cFRhYmxlVUkoKTtcbiAgIDk5N1x0XG4gICA5OThcdCAgICAgICAgLy8gVGhp4bq/dCBs4bqtcCBwaMOtbSB04bqvdCB2w6AgbWVudSBuZ+G7ryBj4bqjbmhcbiAgIDk5OVx0ICAgICAgICBzZXR1cEtleUJpbmRpbmdzKCk7XG4gIDEwMDBcdCAgICAgICAgc2V0dXBDb250ZXh0TWVudSgpO1xuICAxMDAxXHRcbiAgMTAwMlx0ICAgICAgICAvLyBBZGQgdGFibGUgdG8gc2Nyb2xsIHBhbmVcbiAgMTAwM1x0ICAgICAgICBKU2Nyb2xsUGFuZSBzY3JvbGxQYW5lID0gbmV3IEpTY3JvbGxQYW5lKHNjaGVkdWxlVGFibGUpO1xuICAxMDA0XHQgICAgICAgIHNjcm9sbFBhbmUuZ2V0Vmlld3BvcnQoKS5zZXRCYWNrZ3JvdW5kKENvbG9yLldISVRFKTtcbiAgMTAwNVx0XG4gIDEwMDZcdCAgICAgICAgLy8gxJDhuqNtIGLhuqNvIGhp4buDbiB0aOG7iyBoZWFkZXIgxJHDum5nIG3DoHUgc+G6r2NcbiAgMTAwN1x0ICAgICAgICBzY3JvbGxQYW5lLnNldENvbHVtbkhlYWRlclZpZXcoaGVhZGVyKTtcbiAgMTAwOFx0XG4gIDEwMDlcdCAgICAgICAgcGFuZWwuYWRkKHNjcm9sbFBhbmUsIEJvcmRlckxheW91dC5DRU5URVIpO1xuICAxMDEwXHQgICAgICAgIHJldHVybiBwYW5lbDtcbiAgMTAxMVx0ICAgIH1cbiAgMTAxMlx0XG4gIDEwMTNcdCAgICBwcml2YXRlIHZvaWQgc2V0dXBUYWJsZVVJKCkge1xuICAxMDE0XHQgICAgICAgIC8vIMSQ4bq3dCBt4buZdCBz4buRIHRodeG7mWMgdMOtbmggY2hvIGLhuqNuZ1xuICAxMDE1XHQgICAgICAgIHNjaGVkdWxlVGFibGUuc2V0U2hvd0hvcml6b250YWxMaW5lcyh0cnVlKTtcbiAgMTAxNlx0ICAgICAgICBzY2hlZHVsZVRhYmxlLnNldFNob3dWZXJ0aWNhbExpbmVzKHRydWUpO1xuICAxMDE3XHQgICAgICAgIHNjaGVkdWxlVGFibGUuc2V0R3JpZENvbG9yKG5ldyBDb2xvcigyMzAsIDIzMCwgMjMwKSk7XG4gIDEwMThcdCAgICAgICAgc2NoZWR1bGVUYWJsZS5zZXRCYWNrZ3JvdW5kKENvbG9yLldISVRFKTtcbiAgMTAxOVx0ICAgICAgICBzY2hlZHVsZVRhYmxlLnNldEZvcmVncm91bmQoQ29sb3IuQkxBQ0spO1xuICAxMDIwXHQgICAgICAgIHNjaGVkdWxlVGFibGUuc2V0U2VsZWN0aW9uQmFja2dyb3VuZChuZXcgQ29sb3IoNjYsIDEzOSwgMjAyKSk7IC8vIE3DoHUga2hpIGNo4buNbiBjaMOtbmggdGjhu6ljXG4gIDEwMjFcdCAgICAgICAgc2NoZWR1bGVUYWJsZS5zZXRTZWxlY3Rpb25Gb3JlZ3JvdW5kKENvbG9yLldISVRFKTtcbiAgMTAyMlx0XG4gIDEwMjNcdCAgICAgICAgLy8gQmnhur9uIMSR4buDIGzGsHUgdHLhuqFuZyB0aMOhaSBs4buxYSBjaOG7jW4gdsOgIGhp4buHdSDhu6luZyBob3ZlclxuICAxMDI0XHQgICAgICAgIGZpbmFsIGludFtdIHBlcm1hbmVudFNlbGVjdGVkUm93ID0gey0xfTsgLy8gTOG7sWEgY2jhu41uIGNow61uaCB0aOG7qWNcbiAgMTAyNVx0ICAgICAgICBmaW5hbCBpbnRbXSBob3ZlclJvdyA9IHstMX07IC8vIETDsm5nIMSRYW5nIGhvdmVyXG4gIDEwMjZcdCAgICAgICAgZmluYWwgYm9vbGVhbltdIGlzVXNlclNlbGVjdGlvbiA9IHtmYWxzZX07IC8vIEPhu50gxJHDoW5oIGThuqV1IG5nxrDhu51pIGTDuW5nIMSRw6MgY2jhu41uIG3hu5l0IGTDsm5nXG4gIDEwMjdcdFxuICAxMDI4XHQgICAgICAgIC8vIFRow6ptIGhp4buHdSDhu6luZyBob3ZlciBi4bqxbmcgY8OhY2ggc+G7rSBk4bulbmcgTW91c2VNb3Rpb25BZGFwdGVyXG4gIDEwMjlcdCAgICAgICAgc2NoZWR1bGVUYWJsZS5hZGRNb3VzZU1vdGlvbkxpc3RlbmVyKG5ldyBqYXZhLmF3dC5ldmVudC5Nb3VzZU1vdGlvbkFkYXB0ZXIoKSB7XG4gIDEwMzBcdCAgICAgICAgICAgIEBPdmVycmlkZVxuICAxMDMxXHQgICAgICAgICAgICBwdWJsaWMgdm9pZCBtb3VzZU1vdmVkKGphdmEuYXd0LmV2ZW50Lk1vdXNlRXZlbnQgZSkge1xuICAxMDMyXHQgICAgICAgICAgICAgICAgLy8gTOG6pXkgZMOybmcgaGnhu4duIHThuqFpIMSRYW5nIGhvdmVyXG4gIDEwMzNcdCAgICAgICAgICAgICAgICBQb2ludCBwb2ludCA9IGUuZ2V0UG9pbnQoKTtcbiAgMTAzNFx0ICAgICAgICAgICAgICAgIGludCBjdXJyZW50Um93ID0gc2NoZWR1bGVUYWJsZS5yb3dBdFBvaW50KHBvaW50KTtcbiAgMTAzNVx0XG4gIDEwMzZcdCAgICAgICAgICAgICAgICAvLyBO4bq/dSBkaSBjaHV54buDbiDEkeG6v24gbeG7mXQgZMOybmcgbeG7m2lcbiAgMTAzN1x0ICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Um93ICE9IGhvdmVyUm93WzBdKSB7XG4gIDEwMzhcdCAgICAgICAgICAgICAgICAgICAgLy8gQ+G6rXAgbmjhuq10IGTDsm5nIMSRYW5nIGhvdmVyXG4gIDEwMzlcdCAgICAgICAgICAgICAgICAgICAgaG92ZXJSb3dbMF0gPSBjdXJyZW50Um93O1xuICAxMDQwXHRcbiAgMTA0MVx0ICAgICAgICAgICAgICAgICAgICAvLyBLaeG7g20gdHJhIHTDrW5oIGjhu6NwIGzhu4cgY+G7p2EgY2jhu4kgc+G7kSBow6BuZ1xuICAxMDQyXHQgICAgICAgICAgICAgICAgICAgIGJvb2xlYW4gaXNWYWxpZFJvdyA9IGN1cnJlbnRSb3cgPj0gMCAmJiBjdXJyZW50Um93IDwgc2NoZWR1bGVUYWJsZS5nZXRSb3dDb3VudCgpO1xuICAxMDQzXHQgICAgICAgICAgICAgICAgICAgIGJvb2xlYW4gaXNQZXJtYW5lbnRTZWxlY3Rpb25WYWxpZCA9IHBlcm1hbmVudFNlbGVjdGVkUm93WzBdID49IDAgJiYgcGVybWFuZW50U2VsZWN0ZWRSb3dbMF0gPCBzY2hlZHVsZVRhYmxlLmdldFJvd0NvdW50KCk7XG4gIDEwNDRcdFxuICAxMDQ1XHQgICAgICAgICAgICAgICAgICAgIC8vIE7hur91IG5nxrDhu51pIGTDuW5nIMSRw6MgY8OzIGzhu7FhIGNo4buNbiBjaMOtbmggdGjhu6ljLCBjaOG7iSBoaeG7g24gdGjhu4sgaGnhu4d1IOG7qW5nIGhvdmVyXG4gIDEwNDZcdCAgICAgICAgICAgICAgICAgICAgaWYgKGlzVXNlclNlbGVjdGlvblswXSAmJiBpc1Blcm1hbmVudFNlbGVjdGlvblZhbGlkKSB7XG4gIDEwNDdcdCAgICAgICAgICAgICAgICAgICAgICAgIC8vIE7huqFwIGzhuqFpIGNo4buNbiBjaMOtbmggdGjhu6ljXG4gIDEwNDhcdCAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVkdWxlVGFibGUuc2V0U2VsZWN0aW9uQmFja2dyb3VuZChuZXcgQ29sb3IoNjYsIDEzOSwgMjAyKSk7XG4gIDEwNDlcdCAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVkdWxlVGFibGUuc2V0U2VsZWN0aW9uRm9yZWdyb3VuZChDb2xvci5XSElURSk7XG4gIDEwNTBcdCAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVkdWxlVGFibGUuc2V0Um93U2VsZWN0aW9uSW50ZXJ2YWwocGVybWFuZW50U2VsZWN0ZWRSb3dbMF0sIHBlcm1hbmVudFNlbGVjdGVkUm93WzBdKTtcbiAgMTA1MVx0XG4gIDEwNTJcdCAgICAgICAgICAgICAgICAgICAgICAgIC8vIFbhur0gaGnhu4d1IOG7qW5nIGhvdmVyIGNobyBkw7JuZyBoaeG7h24gdOG6oWlcbiAgMTA1M1x0ICAgICAgICAgICAgICAgICAgICAgICAgc2NoZWR1bGVUYWJsZS5yZXBhaW50KCk7XG4gIDEwNTRcdCAgICAgICAgICAgICAgICAgICAgfVxuICAxMDU1XHQgICAgICAgICAgICAgICAgICAgIC8vIE7hur91IGtow7RuZyBjw7MgbOG7sWEgY2jhu41uIGNow61uaCB0aOG7qWMgdsOgIGPDsyBow6BuZyBo4bujcCBs4buHLCDDoXAgZOG7pW5nIGhp4buHdSDhu6luZyBob3ZlclxuICAxMDU2XHQgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGlzVmFsaWRSb3cpIHtcbiAgMTA1N1x0ICAgICAgICAgICAgICAgICAgICAgICAgc2NoZWR1bGVUYWJsZS5zZXRTZWxlY3Rpb25CYWNrZ3JvdW5kKG5ldyBDb2xvcigxNzMsIDIxNiwgMjMwKSk7IC8vIE3DoHUgeGFuaCBuaOG6oXQgY2hvIGhvdmVyXG4gIDEwNThcdCAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVkdWxlVGFibGUuc2V0U2VsZWN0aW9uRm9yZWdyb3VuZChDb2xvci5CTEFDSyk7XG4gIDEwNTlcdCAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVkdWxlVGFibGUuc2V0Um93U2VsZWN0aW9uSW50ZXJ2YWwoY3VycmVudFJvdywgY3VycmVudFJvdyk7XG4gIDEwNjBcdCAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgMTA2MVx0ICAgICAgICAgICAgICAgICAgICAgICAgLy8gS2jDtG5nIGPDsyBow6BuZyBo4bujcCBs4buHIMSR4buDIGhvdmVyLCB4w7NhIGzhu7FhIGNo4buNblxuICAxMDYyXHQgICAgICAgICAgICAgICAgICAgICAgICBzY2hlZHVsZVRhYmxlLmNsZWFyU2VsZWN0aW9uKCk7XG4gIDEwNjNcdCAgICAgICAgICAgICAgICAgICAgfVxuICAxMDY0XHQgICAgICAgICAgICAgICAgfVxuICAxMDY1XHQgICAgICAgICAgICB9XG4gIDEwNjZcdCAgICAgICAgfSk7XG4gIDEwNjdcdFxuICAxMDY4XHQgICAgICAgIC8vIFjhu60gbMO9IGPDoWMgc+G7sSBraeG7h24gY2h14buZdCBraMOhY1xuICAxMDY5XHQgICAgICAgIHNjaGVkdWxlVGFibGUuYWRkTW91c2VMaXN0ZW5lcihuZXcgamF2YS5hd3QuZXZlbnQuTW91c2VBZGFwdGVyKCkge1xuICAxMDcwXHQgICAgICAgICAgICBAT3ZlcnJpZGVcbiAgMTA3MVx0ICAgICAgICAgICAgcHVibGljIHZvaWQgbW91c2VFeGl0ZWQoamF2YS5hd3QuZXZlbnQuTW91c2VFdmVudCBlKSB7XG4gIDEwNzJcdCAgICAgICAgICAgICAgICBob3ZlclJvd1swXSA9IC0xOyAvLyBYw7NhIHRy4bqhbmcgdGjDoWkgaG92ZXJcbiAgMTA3M1x0XG4gIDEwNzRcdCAgICAgICAgICAgICAgICAvLyBLaeG7g20gdHJhIHTDrW5oIGjhu6NwIGzhu4cgY+G7p2EgbOG7sWEgY2jhu41uIGNow61uaCB0aOG7qWNcbiAgMTA3NVx0ICAgICAgICAgICAgICAgIGJvb2xlYW4gaXNQZXJtYW5lbnRTZWxlY3Rpb25WYWxpZCA9IHBlcm1hbmVudFNlbGVjdGVkUm93WzBdID49IDAgJiZcbiAgMTA3Nlx0ICAgICAgICAgICAgICAgICAgICAgICAgcGVybWFuZW50U2VsZWN0ZWRSb3dbMF0gPCBzY2hlZHVsZVRhYmxlLmdldFJvd0NvdW50KCk7XG4gIDEwNzdcdFxuICAxMDc4XHQgICAgICAgICAgICAgICAgLy8gTuG6v3UgY8OzIGzhu7FhIGNo4buNbiBjaMOtbmggdGjhu6ljIHbDoCBo4bujcCBs4buHLCBnaeG7ryBuZ3V5w6puIGzhu7FhIGNo4buNbiDEkcOzXG4gIDEwNzlcdCAgICAgICAgICAgICAgICBpZiAoaXNVc2VyU2VsZWN0aW9uWzBdICYmIGlzUGVybWFuZW50U2VsZWN0aW9uVmFsaWQpIHtcbiAgMTA4MFx0ICAgICAgICAgICAgICAgICAgICBzY2hlZHVsZVRhYmxlLnNldFNlbGVjdGlvbkJhY2tncm91bmQobmV3IENvbG9yKDY2LCAxMzksIDIwMikpO1xuICAxMDgxXHQgICAgICAgICAgICAgICAgICAgIHNjaGVkdWxlVGFibGUuc2V0U2VsZWN0aW9uRm9yZWdyb3VuZChDb2xvci5XSElURSk7XG4gIDEwODJcdCAgICAgICAgICAgICAgICAgICAgc2NoZWR1bGVUYWJsZS5zZXRSb3dTZWxlY3Rpb25JbnRlcnZhbChwZXJtYW5lbnRTZWxlY3RlZFJvd1swXSwgcGVybWFuZW50U2VsZWN0ZWRSb3dbMF0pO1xuICAxMDgzXHQgICAgICAgICAgICAgICAgfVxuICAxMDg0XHQgICAgICAgICAgICAgICAgLy8gTuG6v3UgY2jhu4kgbMOgIGhvdmVyLCB4w7NhIGzhu7FhIGNo4buNbiBraGkgcuG7nWkga2jhu49pIGLhuqNuZ1xuICAxMDg1XHQgICAgICAgICAgICAgICAgZWxzZSB7XG4gIDEwODZcdCAgICAgICAgICAgICAgICAgICAgc2NoZWR1bGVUYWJsZS5jbGVhclNlbGVjdGlvbigpO1xuICAxMDg3XHQgICAgICAgICAgICAgICAgfVxuICAxMDg4XHQgICAgICAgICAgICB9XG4gIDEwODlcdFxuICAxMDkwXHQgICAgICAgICAgICBAT3ZlcnJpZGVcbiAgMTA5MVx0ICAgICAgICAgICAgcHVibGljIHZvaWQgbW91c2VDbGlja2VkKGphdmEuYXd0LmV2ZW50Lk1vdXNlRXZlbnQgZSkge1xuICAxMDkyXHQgICAgICAgICAgICAgICAgaW50IHJvdyA9IHNjaGVkdWxlVGFibGUuZ2V0U2VsZWN0ZWRSb3coKTtcbiAgMTA5M1x0ICAgICAgICAgICAgICAgIGlmIChyb3cgPj0gMCAmJiByb3cgPCBzY2hlZHVsZVRhYmxlLmdldFJvd0NvdW50KCkpIHtcbiAgMTA5NFx0ICAgICAgICAgICAgICAgICAgICAvLyBMxrB1IGzhu7FhIGNo4buNbiBjaMOtbmggdGjhu6ljXG4gIDEwOTVcdCAgICAgICAgICAgICAgICAgICAgcGVybWFuZW50U2VsZWN0ZWRSb3dbMF0gPSByb3c7XG4gIDEwOTZcdCAgICAgICAgICAgICAgICAgICAgaXNVc2VyU2VsZWN0aW9uWzBdID0gdHJ1ZTtcbiAgMTA5N1x0XG4gIDEwOThcdCAgICAgICAgICAgICAgICAgICAgLy8gxJDhurd0IG3DoHUgY2jhu41uIHRow6BuaCBtw6B1IHhhbmggxJHhuq1tXG4gIDEwOTlcdCAgICAgICAgICAgICAgICAgICAgc2NoZWR1bGVUYWJsZS5zZXRTZWxlY3Rpb25CYWNrZ3JvdW5kKG5ldyBDb2xvcig2NiwgMTM5LCAyMDIpKTtcbiAgMTEwMFx0ICAgICAgICAgICAgICAgICAgICBzY2hlZHVsZVRhYmxlLnNldFNlbGVjdGlvbkZvcmVncm91bmQoQ29sb3IuV0hJVEUpO1xuICAxMTAxXHQgICAgICAgICAgICAgICAgfVxuICAxMTAyXHQgICAgICAgICAgICB9XG4gIDExMDNcdCAgICAgICAgfSk7XG4gIDExMDRcdFxuICAxMTA1XHQgICAgICAgIC8vIFRoZW8gZMO1aSBjw6FjIHRoYXkgxJHhu5VpIHRyb25nIGzhu7FhIGNo4buNblxuICAxMTA2XHQgICAgICAgIHNjaGVkdWxlVGFibGUuZ2V0U2VsZWN0aW9uTW9kZWwoKS5hZGRMaXN0U2VsZWN0aW9uTGlzdGVuZXIoZSAtPiB7XG4gIDExMDdcdCAgICAgICAgICAgIGlmICghZS5nZXRWYWx1ZUlzQWRqdXN0aW5nKCkpIHtcbiAgMTEwOFx0ICAgICAgICAgICAgICAgIGludCBzZWxlY3RlZFJvdyA9IHNjaGVkdWxlVGFibGUuZ2V0U2VsZWN0ZWRSb3coKTtcbiAgMTEwOVx0XG4gIDExMTBcdCAgICAgICAgICAgICAgICAvLyBLaeG7g20gdHJhIHTDrW5oIGjhu6NwIGzhu4cgY+G7p2EgbOG7sWEgY2jhu41uIGNow61uaCB0aOG7qWNcbiAgMTExMVx0ICAgICAgICAgICAgICAgIGJvb2xlYW4gaXNQZXJtYW5lbnRTZWxlY3Rpb25WYWxpZCA9IHBlcm1hbmVudFNlbGVjdGVkUm93WzBdID49IDAgJiZcbiAgMTExMlx0ICAgICAgICAgICAgICAgICAgICAgICAgcGVybWFuZW50U2VsZWN0ZWRSb3dbMF0gPCBzY2hlZHVsZVRhYmxlLmdldFJvd0NvdW50KCk7XG4gIDExMTNcdFxuICAxMTE0XHQgICAgICAgICAgICAgICAgLy8gTuG6v3UgbmfGsOG7nWkgZMO5bmcgxJHDoyBjaOG7jW4gbeG7mXQgZMOybmcgbmjGsG5nIGLDonkgZ2nhu50ga2jDtG5nIGPDsyBkw7JuZyBuw6BvIMSRxrDhu6NjIGNo4buNbixcbiAgMTExNVx0ICAgICAgICAgICAgICAgIC8vIHbDoCBjaOG7jW4gY3Xhu5FpIGPDuW5nIHbhuqtuIGjhu6NwIGzhu4csIHRow6wga2jDtGkgcGjhu6VjIGzhu7FhIGNo4buNbiDEkcOzXG4gIDExMTZcdCAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWRSb3cgPT0gLTEgJiYgaXNVc2VyU2VsZWN0aW9uWzBdICYmIGlzUGVybWFuZW50U2VsZWN0aW9uVmFsaWQpIHtcbiAgMTExN1x0ICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAxMTE4XHQgICAgICAgICAgICAgICAgICAgICAgICBzY2hlZHVsZVRhYmxlLnNldFJvd1NlbGVjdGlvbkludGVydmFsKHBlcm1hbmVudFNlbGVjdGVkUm93WzBdLCBwZXJtYW5lbnRTZWxlY3RlZFJvd1swXSk7XG4gIDExMTlcdCAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGV4KSB7XG4gIDExMjBcdCAgICAgICAgICAgICAgICAgICAgICAgIC8vIFjhu60gbMO9IHRyxrDhu51uZyBo4bujcCBjaOG7iSBz4buRIGjDoG5nIGtow7RuZyBo4bujcCBs4buHXG4gIDExMjFcdCAgICAgICAgICAgICAgICAgICAgICAgIExPR0dFUi53YXJuaW5nKFwiS2jDtG5nIHRo4buDIGtow7RpIHBo4bulYyBs4buxYSBjaOG7jW4gaMOgbmc6IFwiICsgZXguZ2V0TWVzc2FnZSgpKTtcbiAgMTEyMlx0ICAgICAgICAgICAgICAgICAgICAgICAgLy8gxJDhurd0IGzhuqFpIGPDoWMgYmnhur9uIHRy4bqhbmcgdGjDoWlcbiAgMTEyM1x0ICAgICAgICAgICAgICAgICAgICAgICAgaXNVc2VyU2VsZWN0aW9uWzBdID0gZmFsc2U7XG4gIDExMjRcdCAgICAgICAgICAgICAgICAgICAgICAgIHBlcm1hbmVudFNlbGVjdGVkUm93WzBdID0gLTE7XG4gIDExMjVcdCAgICAgICAgICAgICAgICAgICAgfVxuICAxMTI2XHQgICAgICAgICAgICAgICAgfVxuICAxMTI3XHQgICAgICAgICAgICB9XG4gIDExMjhcdCAgICAgICAgfSk7XG4gIDExMjlcdFxuICAxMTMwXHQgICAgICAgIC8vIFPhu60gZOG7pW5nIGN1c3RvbSByZW5kZXJlciDEkeG7gyBoaeG7g24gdGjhu4sgbcOgdSBob3ZlclxuICAxMTMxXHQgICAgICAgIHNjaGVkdWxlVGFibGUuc2V0RGVmYXVsdFJlbmRlcmVyKE9iamVjdC5jbGFzcywgbmV3IERlZmF1bHRUYWJsZUNlbGxSZW5kZXJlcigpIHtcbiAgMTEzMlx0ICAgICAgICAgICAgQE92ZXJyaWRlXG4gIDExMzNcdCAgICAgICAgICAgIHB1YmxpYyBDb21wb25lbnQgZ2V0VGFibGVDZWxsUmVuZGVyZXJDb21wb25lbnQoSlRhYmxlIHRhYmxlLCBPYmplY3QgdmFsdWUsXG4gIDExMzRcdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbGVhbiBpc1NlbGVjdGVkLCBib29sZWFuIGhhc0ZvY3VzLFxuICAxMTM1XHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCByb3csIGludCBjb2x1bW4pIHtcbiAgMTEzNlx0ICAgICAgICAgICAgICAgIENvbXBvbmVudCBjb21wID0gc3VwZXIuZ2V0VGFibGVDZWxsUmVuZGVyZXJDb21wb25lbnQoXG4gIDExMzdcdCAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlLCB2YWx1ZSwgaXNTZWxlY3RlZCwgaGFzRm9jdXMsIHJvdywgY29sdW1uKTtcbiAgMTEzOFx0XG4gIDExMzlcdCAgICAgICAgICAgICAgICAvLyBO4bq/dSBkw7JuZyBuw6B5IGzDoCBs4buxYSBjaOG7jW4gY2jDrW5oIHRo4bupY1xuICAxMTQwXHQgICAgICAgICAgICAgICAgaWYgKGlzU2VsZWN0ZWQgJiYgcm93ID09IHBlcm1hbmVudFNlbGVjdGVkUm93WzBdICYmIGlzVXNlclNlbGVjdGlvblswXSkge1xuICAxMTQxXHQgICAgICAgICAgICAgICAgICAgIGNvbXAuc2V0QmFja2dyb3VuZChuZXcgQ29sb3IoNjYsIDEzOSwgMjAyKSk7IC8vIE3DoHUgeGFuaCDEkeG6rW0gY2hvIGzhu7FhIGNo4buNblxuICAxMTQyXHQgICAgICAgICAgICAgICAgICAgIGNvbXAuc2V0Rm9yZWdyb3VuZChDb2xvci5XSElURSk7XG4gIDExNDNcdCAgICAgICAgICAgICAgICB9XG4gIDExNDRcdCAgICAgICAgICAgICAgICAvLyBO4bq/dSBkw7JuZyBuw6B5IMSRYW5nIMSRxrDhu6NjIGhvdmVyXG4gIDExNDVcdCAgICAgICAgICAgICAgICBlbHNlIGlmIChpc1NlbGVjdGVkICYmIHJvdyA9PSBob3ZlclJvd1swXSkge1xuICAxMTQ2XHQgICAgICAgICAgICAgICAgICAgIGNvbXAuc2V0QmFja2dyb3VuZChuZXcgQ29sb3IoMTczLCAyMTYsIDIzMCkpOyAvLyBNw6B1IHhhbmggbmjhuqF0IGNobyBob3ZlclxuICAxMTQ3XHQgICAgICAgICAgICAgICAgICAgIGNvbXAuc2V0Rm9yZWdyb3VuZChDb2xvci5CTEFDSyk7XG4gIDExNDhcdCAgICAgICAgICAgICAgICB9XG4gIDExNDlcdCAgICAgICAgICAgICAgICAvLyBNw6B1IHPhuq9jIHRow7RuZyB0aMaw4budbmcgY2hvIGPDoWMgZMOybmcgbOG6uyBjaOG6tW5cbiAgMTE1MFx0ICAgICAgICAgICAgICAgIGVsc2Uge1xuICAxMTUxXHQgICAgICAgICAgICAgICAgICAgIGlmIChyb3cgJSAyID09IDApIHtcbiAgMTE1Mlx0ICAgICAgICAgICAgICAgICAgICAgICAgY29tcC5zZXRCYWNrZ3JvdW5kKENvbG9yLldISVRFKTtcbiAgMTE1M1x0ICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAxMTU0XHQgICAgICAgICAgICAgICAgICAgICAgICBjb21wLnNldEJhY2tncm91bmQobmV3IENvbG9yKDI0NSwgMjQ1LCAyNDUpKTsgLy8gTcOgdSB4w6FtIG5o4bqhdFxuICAxMTU1XHQgICAgICAgICAgICAgICAgICAgIH1cbiAgMTE1Nlx0ICAgICAgICAgICAgICAgICAgICBjb21wLnNldEZvcmVncm91bmQoQ29sb3IuQkxBQ0spO1xuICAxMTU3XHQgICAgICAgICAgICAgICAgfVxuICAxMTU4XHRcbiAgMTE1OVx0ICAgICAgICAgICAgICAgIC8vIENhbmggbOG7gSB2w6AgZm9udFxuICAxMTYwXHQgICAgICAgICAgICAgICAgKChKTGFiZWwpIGNvbXApLnNldEhvcml6b250YWxBbGlnbm1lbnQoU3dpbmdDb25zdGFudHMuQ0VOVEVSKTtcbiAgMTE2MVx0ICAgICAgICAgICAgICAgIGNvbXAuc2V0Rm9udChuZXcgRm9udChcIkFyaWFsXCIsIEZvbnQuUExBSU4sIDEyKSk7XG4gIDExNjJcdFxuICAxMTYzXHQgICAgICAgICAgICAgICAgcmV0dXJuIGNvbXA7XG4gIDExNjRcdCAgICAgICAgICAgIH1cbiAgMTE2NVx0ICAgICAgICB9KTtcbiAgMTE2Nlx0XG4gIDExNjdcdCAgICAgICAgLy8gVGhp4bq/dCBs4bqtcCBVSSBjaG8gaGVhZGVyIChnaeG7ryBuZ3V5w6puKVxuICAxMTY4XHQgICAgICAgIHNjaGVkdWxlVGFibGUuZ2V0VGFibGVIZWFkZXIoKS5zZXREZWZhdWx0UmVuZGVyZXIobmV3IERlZmF1bHRUYWJsZUNlbGxSZW5kZXJlcigpIHtcbiAgMTE2OVx0ICAgICAgICAgICAgQE92ZXJyaWRlXG4gIDExNzBcdCAgICAgICAgICAgIHB1YmxpYyBDb21wb25lbnQgZ2V0VGFibGVDZWxsUmVuZGVyZXJDb21wb25lbnQoSlRhYmxlIHRhYmxlLCBPYmplY3QgdmFsdWUsXG4gIDExNzFcdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbGVhbiBpPHJlc3BvbnNlIGNsaXBwZWQ+PE5PVEU+VG8gc2F2ZSBvbiBjb250ZXh0IG9ubHkgcGFydCBvZiB0aGlzIGZpbGUgaGFzIGJlZW4gc2hvd24gdG8geW91LjwvTk9URT5cblRvdGFsIGxpbmVzIGluIGZpbGU6IDM3ODRcbiIsImlzRXJyb3IiOmZhbHNlLCJyZXF1ZXN0SWQiOiIifX0sImY4ZDVmMTgzLWZkYzEtNDM5YS1hNWM1LWMyNzg4NmM1OTMyODt0b29sdV8wMUVtUG5tbmlObkhQQzJEQzFIeTV0cFciOnsicGhhc2UiOjUsInJlc3VsdCI6eyJ0ZXh0IjoiVGhlIGZvbGxvd2luZyBjb2RlIHNlY3Rpb25zIHdlcmUgcmV0cmlldmVkOlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vcmVzb3VyY2VzL01FVEEtSU5GL3BlcnNpc3RlbmNlLnhtbFxuPD94bWwgdmVyc2lvbj1cIjEuMFwiIGVuY29kaW5nPVwiVVRGLThcIiBzdGFuZGFsb25lPVwieWVzXCI/PlxuPHBlcnNpc3RlbmNlIHhtbG5zPVwiaHR0cHM6Ly9qYWthcnRhLmVlL3htbC9ucy9wZXJzaXN0ZW5jZVwiXG4gICAgICAgICAgICAgeG1sbnM6eHNpPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEtaW5zdGFuY2VcIlxuICAgICAgICAgICAgIHhzaTpzY2hlbWFMb2NhdGlvbj1cImh0dHBzOi8vamFrYXJ0YS5lZS94bWwvbnMvcGVyc2lzdGVuY2UgaHR0cHM6Ly9qYWthcnRhLmVlL3htbC9ucy9wZXJzaXN0ZW5jZS9wZXJzaXN0ZW5jZV8zXzAueHNkXCJcbiAgICAgICAgICAgICB2ZXJzaW9uPVwiMy4wXCI+XG4gICAgPHBlcnNpc3RlbmNlLXVuaXQgbmFtZT1cIm1hcmlhZGJcIj5cbiAgICAgICAgPGNsYXNzPm1vZGVsLlRvYVRhdTwvY2xhc3M+XG4gICAgICAgIDxjbGFzcz5tb2RlbC5Mb2FpVG9hPC9jbGFzcz5cbiAgICAgICAgPGNsYXNzPm1vZGVsLlR1eWVuVGF1PC9jbGFzcz5cbiAgICAgICAgPGNsYXNzPm1vZGVsLlRhdTwvY2xhc3M+XG4gICAgICAgIDxjbGFzcz5tb2RlbC5OaGFuVmllbjwvY2xhc3M+XG4gICAgICAgIDxjbGFzcz5tb2RlbC5UYWlLaG9hbjwvY2xhc3M+XG4gICAgICAgIDxjbGFzcz5tb2RlbC5MaWNoTGFtVmllYzwvY2xhc3M+XG4gICAgICAgIDxjbGFzcz5tb2RlbC5WZVRhdTwvY2xhc3M+XG4gICAgICAgIDxjbGFzcz5tb2RlbC5LaGFjaEhhbmc8L2NsYXNzPlxuICAgICAgICA8Y2xhc3M+bW9kZWwuSG9hRG9uPC9jbGFzcz5cbiAgICAgICAgPGNsYXNzPm1vZGVsLktodXllbk1haTwvY2xhc3M+XG4gICAgICAgIDxjbGFzcz5tb2RlbC5Mb2FpQ2hvPC9jbGFzcz5cbiAgICAgICAgPGNsYXNzPm1vZGVsLkNob05nb2k8L2NsYXNzPlxuICAgICAgICA8Y2xhc3M+bW9kZWwuTG9haUhvYURvbjwvY2xhc3M+XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGFvL2ltcGwvTGljaFRyaW5oVGF1REFPSW1wbC5qYXZhXG5wYWNrYWdlIGRhby5pbXBsO1xuXG5pbXBvcnQgZGFvLkxpY2hUcmluaFRhdURBTztcbmltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXI7XG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS5FbnRpdHlUcmFuc2FjdGlvbjtcbmltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLlF1ZXJ5O1xuaW1wb3J0IG1vZGVsLkxpY2hUcmluaFRhdTtcbmltcG9ydCBtb2RlbC5UcmFuZ1RoYWk7XG5pbXBvcnQgbW9kZWwuVHJhbmdUaGFpVmVUYXU7XG5pbXBvcnQgdXRpbC5KUEFVdGlsO1xuXG5pbXBvcnQgamF2YS5ybWkuUmVtb3RlRXhjZXB0aW9uO1xuaW1wb3J0IGphdmEucm1pLnNlcnZlci5VbmljYXN0UmVtb3RlT2JqZWN0O1xuaW1wb3J0IGphdmEudGltZS5Mb2NhbERhdGU7XG5pbXBvcnQgamF2YS50aW1lLkxvY2FsVGltZTtcbmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0O1xuaW1wb3J0IGphdmEudXRpbC5MaXN0O1xuaW1wb3J0IGphdmEudXRpbC5NYXA7XG5cbnB1YmxpYyBjbGFzcyBMaWNoVHJpbmhUYXVEQU9JbXBsIGV4dGVuZHMgVW5pY2FzdFJlbW90ZU9iamVjdCBpbXBsZW1lbnRzIExpY2hUcmluaFRhdURBTyB7XG5cbiAgICBwdWJsaWMgTGljaFRyaW5oVGF1REFPSW1wbCgpIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xuICAgICAgICAvLyBLaMO0bmcga2jhu59pIHThuqFvIEVudGl0eU1hbmFnZXIgdHJvbmcgY29uc3RydWN0b3JcbiAgICB9XG4uLi5cblxuICAgIEBPdmVycmlkZVxuICAgIHB1YmxpYyBMaXN0PFRyYW5nVGhhaT4gZ2V0VHJhbmdUaGFpKCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcbiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHggPSBlbS5nZXRUcmFuc2FjdGlvbigpO1xuICAgICAgICBMaXN0PFRyYW5nVGhhaT4gdHJhbmdUaGFpTGlzdCA9IG5ldyBBcnJheUxpc3Q8PigpO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0eC5iZWdpbigpO1xuXG4gICAgICAgICAgICAvLyBT4butIGThu6VuZyBuYXRpdmUgcXVlcnkgxJHhu4MgbOG6pXkgY8OhYyBnacOhIHRy4buLIGNodeG7l2kgdOG7qyBEQlxuICAgICAgICAgICAgUXVlcnkgcXVlcnkgPSBlbS5jcmVhdGVOYXRpdmVRdWVyeShcIlNFTEVDVCBESVNUSU5DVCB0cmFuZ190aGFpIEZST00gbGljaHRyaW5odGF1IE9SREVSIEJZIHRyYW5nX3RoYWlcIik7XG4gICAgICAgICAgICBMaXN0PFN0cmluZz4gcmVzdWx0ID0gcXVlcnkuZ2V0UmVzdWx0TGlzdCgpO1xuXG4gICAgICAgICAgICAvLyBUaMOqbSBjw6FjIGdpw6EgdHLhu4sgbeG6t2MgxJHhu4tuaFxuICAgICAgICAgICAgdHJhbmdUaGFpTGlzdC5hZGQoVHJhbmdUaGFpLkRBX0tIT0lfSEFOSCk7XG4gICAgICAgICAgICB0cmFuZ1RoYWlMaXN0LmFkZChUcmFuZ1RoYWkuQ0hVQV9LSE9JX0hBTkgpO1xuICAgICAgICAgICAgdHJhbmdUaGFpTGlzdC5hZGQoVHJhbmdUaGFpLkRBX0hVWSk7XG4gICAgICAgICAgICB0cmFuZ1RoYWlMaXN0LmFkZChUcmFuZ1RoYWkuSE9BVF9ET05HKTsgLy8gVGjDqm0gZ2nDoSB0cuG7iyBuw6B5XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZ3VpQ2xpZW50L0xpY2hUcmluaFNlbGVjdG9yRGlhbG9nLmphdmFcbnBhY2thZ2UgZ3VpQ2xpZW50O1xuXG5pbXBvcnQgZGFvLkNob05nb2lDYWxsYmFjaztcbmltcG9ydCBkYW8uQ2hvTmdvaURvaVZlREFPO1xuaW1wb3J0IGRhby5MaWNoVHJpbmhUYXVEQU87XG5pbXBvcnQgZGFvLlRvYVRhdURvaVZlREFPO1xuaW1wb3J0IG1vZGVsLkNob05nb2k7XG5pbXBvcnQgbW9kZWwuS2h1eWVuTWFpO1xuaW1wb3J0IG1vZGVsLkxpY2hUcmluaFRhdTtcbmltcG9ydCBtb2RlbC5Ub2FUYXU7XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZ3VpQ2xpZW50L1RyYVZlUGFuZWwuamF2YVxucGFja2FnZSBndWlDbGllbnQ7XG5cbi8qKlxuICogQEThu7Egw6FuOiBQaGFuVGFuSmF2YU5ob21HUFRcbiAqIEBDbGFzczogVHJhVmVQYW5lbFxuICogQFThuqFvIHbDoG8gbmfDoHk6IDE5LzA0LzIwMjVcbiAqIEBUw6FjIGdp4bqjOiBOZ3V5ZW4gSHV1IFNhbmdcbiAqL1xuXG5pbXBvcnQgZGFvLkNoaVRpZXRIb2FEb25EQU87XG5pbXBvcnQgZGFvLkhvYURvbkRBTztcbmltcG9ydCBkYW8uTGljaFRyaW5oVGF1REFPO1xuaW1wb3J0IGRhby5WZVRhdURBTztcbmltcG9ydCBkYW8uaW1wbC5MaWNoTGFtVmllY0RBT0ltcGw7XG5pbXBvcnQgZGFvLmltcGwuTGljaFRyaW5oVGF1REFPSW1wbDtcbmltcG9ydCBtb2RlbC4qO1xuLy9pbXBvcnQgdXRpbHMuUHJpbnRQREY7XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZ3VpQ2xpZW50L0xpY2hUcmluaFRhdVBhbmVsLmphdmFcbnBhY2thZ2UgZ3VpQ2xpZW50O1xuXG5pbXBvcnQgY29tLnRvZWR0ZXIuY2FsZW5kYXIuSkRhdGVDaG9vc2VyO1xuaW1wb3J0IGRhby5MaWNoVHJpbmhUYXVEQU87XG5pbXBvcnQgZGFvLlRhdURBTztcbmltcG9ydCBtb2RlbC5MaWNoVHJpbmhUYXU7XG5pbXBvcnQgbW9kZWwuVGF1O1xuaW1wb3J0IG1vZGVsLlRyYW5nVGhhaTtcbmltcG9ydCBzZXJ2aWNlLkFJVHJhdmVsVGltZVByZWRpY3RvcjtcbmltcG9ydCBzZXJ2aWNlLlNjaGVkdWxlU3RhdHVzTWFuYWdlcjtcbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9kYW8vaW1wbC9Mb2FpQ2hvREFPSW1wbC5qYXZhXG5wYWNrYWdlIGRhby5pbXBsO1xuXG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS5FbnRpdHlNYW5hZ2VyO1xuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuRW50aXR5VHJhbnNhY3Rpb247XG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS5UeXBlZFF1ZXJ5O1xuaW1wb3J0IG1vZGVsLkxpY2hUcmluaFRhdTtcbmltcG9ydCBtb2RlbC5Mb2FpQ2hvO1xuaW1wb3J0IG1vZGVsLlRyYW5nVGhhaVZlVGF1O1xuaW1wb3J0IHV0aWwuSlBBVXRpbDtcblxuaW1wb3J0IGphdmEudXRpbC5MaXN0O1xuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL3Rlc3RDUlVEL1Rlc3RfSFYuamF2YVxucGFja2FnZSB0ZXN0Q1JVRDtcblxuaW1wb3J0IGRhby5MaWNoVHJpbmhUYXVEQU87XG5pbXBvcnQgZGFvLlRhdURBTztcbmltcG9ydCBkYW8uaW1wbC5MaWNoVHJpbmhUYXVEQU9JbXBsO1xuaW1wb3J0IGRhby5pbXBsLlRhdURBT0ltcGw7XG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS5FbnRpdHlNYW5hZ2VyO1xuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuUGVyc2lzdGVuY2U7XG5pbXBvcnQgbW9kZWwuTGljaFRyaW5oVGF1O1xuaW1wb3J0IG1vZGVsLlRhdTtcbmltcG9ydCBuZXQuZGF0YWZha2VyLkZha2VyO1xuXG5pbXBvcnQgamF2YS5ybWkuUmVtb3RlRXhjZXB0aW9uO1xuaW1wb3J0IGphdmEudGltZS5Mb2NhbERhdGU7XG5pbXBvcnQgamF2YS51dGlsLkxpc3Q7XG5cbnB1YmxpYyBjbGFzcyBUZXN0X0hWIHtcbiAgICBwdWJsaWMgc3RhdGljIHZvaWQgbWFpbihTdHJpbmdbXSBhcmdzKSB0aHJvd3MgRXhjZXB0aW9uIHtcbiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IFBlcnNpc3RlbmNlLmNyZWF0ZUVudGl0eU1hbmFnZXJGYWN0b3J5KFwibWFyaWFkYlwiKS5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7XG4gICAgICAgIFRhdURBTyB0YXVEQU8gPSBuZXcgVGF1REFPSW1wbCgpO1xuICAgICAgICBMaXN0PFRhdT4gdGF1cyA9IHRhdURBTy5nZXRBbGxMaXN0VCgpO1xuICAgICAgICB0YXVzLmZvckVhY2goU3lzdGVtLm91dDo6cHJpbnRsbik7XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZ3VpQ2xpZW50L0ZybURhbmdOaGFwLmphdmFcbnBhY2thZ2UgZ3VpQ2xpZW50O1xuXG5pbXBvcnQgZGFvLkxpY2hMYW1WaWVjREFPO1xuaW1wb3J0IGRhby5OaGFuVmllbkRBTztcbmltcG9ydCBkYW8uVGFpS2hvYW5EQU87XG5pbXBvcnQgZGFvLmltcGwuTGljaExhbVZpZWNEQU9JbXBsO1xuaW1wb3J0IGRhby5pbXBsLk5oYW5WaWVuREFPSW1wbDtcbmltcG9ydCBkYW8uaW1wbC5UYWlLaG9hbkRBT0ltcGw7XG4vL2ltcG9ydCBtb2RlbC5FbWFpbFNlbmRlcjtcbmltcG9ydCBtb2RlbC5MaWNoTGFtVmllYztcbmltcG9ydCBtb2RlbC5OaGFuVmllbjtcblxuaW1wb3J0IGphdmF4LnN3aW5nLio7XG5pbXBvcnQgamF2YS5hd3QuKjtcbmltcG9ydCBqYXZhLmF3dC5ldmVudC5BY3Rpb25FdmVudDtcbmltcG9ydCBqYXZhLmF3dC5ldmVudC5BY3Rpb25MaXN0ZW5lcjtcbmltcG9ydCBqYXZhLmF3dC5pbWFnZS5CdWZmZXJlZEltYWdlO1xuaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247XG5pbXBvcnQgamF2YS5ybWkuTm90Qm91bmRFeGNlcHRpb247XG5pbXBvcnQgamF2YS5ybWkuUmVtb3RlRXhjZXB0aW9uO1xuaW1wb3J0IGphdmEucm1pLnJlZ2lzdHJ5LkxvY2F0ZVJlZ2lzdHJ5O1xuaW1wb3J0IGphdmEucm1pLnJlZ2lzdHJ5LlJlZ2lzdHJ5O1xuaW1wb3J0IGphdmEudGltZS5Mb2NhbERhdGU7XG5pbXBvcnQgamF2YS50aW1lLkxvY2FsRGF0ZVRpbWU7XG5pbXBvcnQgamF2YS51dGlsLkxpc3Q7XG5pbXBvcnQgamF2YXguaW1hZ2Vpby5JbWFnZUlPO1xuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2Rhby9pbXBsL1RhdURBT0ltcGwuamF2YVxucGFja2FnZSBkYW8uaW1wbDtcblxuaW1wb3J0IGRhby5UYXVEQU87XG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS5FbnRpdHlNYW5hZ2VyO1xuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuRW50aXR5VHJhbnNhY3Rpb247XG5pbXBvcnQgbG9tYm9rLkFsbEFyZ3NDb25zdHJ1Y3RvcjtcbmltcG9ydCBtb2RlbC5UYXU7XG5pbXBvcnQgbW9kZWwuTGljaFRyaW5oVGF1O1xuaW1wb3J0IHV0aWwuSlBBVXRpbDtcblxuaW1wb3J0IGphdmEucm1pLlJlbW90ZUV4Y2VwdGlvbjtcbmltcG9ydCBqYXZhLnJtaS5zZXJ2ZXIuVW5pY2FzdFJlbW90ZU9iamVjdDtcbmltcG9ydCBqYXZhLnV0aWwuTGlzdDtcblxucHVibGljIGNsYXNzIFRhdURBT0ltcGwgZXh0ZW5kcyBVbmljYXN0UmVtb3RlT2JqZWN0IGltcGxlbWVudHMgVGF1REFPIHtcbi8vICAgIHByaXZhdGUgRW50aXR5TWFuYWdlciBlbTtcbiAgICBwdWJsaWMgVGF1REFPSW1wbCgpIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xuLy8gICAgICAgIHRoaXMuZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTs7XG4gICAgfVxuICAgIHB1YmxpYyBMaXN0PFRhdT4gZ2V0QWxsTGlzdFQoKSB7XG4gICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcbiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHggPSBlbS5nZXRUcmFuc2FjdGlvbigpO1xuICAgICAgICBMaXN0PFRhdT4gbGlzdCA9IG51bGw7XG4gICAgICAgIHR4LmJlZ2luKCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBT4butIGThu6VuZyBKT0lOIEZFVENIIMSR4buDIGzhuqV5IFR1eWVuVGF1IGPDuW5nIHbhu5tpIFRhdVxuICAgICAgICAgICAgbGlzdCA9IGVtLmNyZWF0ZVF1ZXJ5KFwic2VsZWN0IHQgZnJvbSBUYXUgdCBKT0lOIEZFVENIIHQudHV5ZW5UYXVcIiwgVGF1LmNsYXNzKS5nZXRSZXN1bHRMaXN0KCk7XG4gICAgICAgICAgICB0eC5jb21taXQoKTtcbiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgIHR4LnJvbGxiYWNrKCk7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAvLyDEkOG6o20gYuG6o28gxJHDs25nIEVudGl0eU1hbmFnZXJcbiAgICAgICAgICAgIGlmIChlbSAhPSBudWxsICYmIGVtLmlzT3BlbigpKSB7XG4gICAgICAgICAgICAgICAgZW0uY2xvc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbGlzdDtcbiAgICB9XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGFvL2ltcGwvVmVUYXVEQU9JbXBsLmphdmFcbnBhY2thZ2UgZGFvLmltcGw7XG5cbmltcG9ydCBkYW8uVmVUYXVEQU87XG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS5FbnRpdHlNYW5hZ2VyO1xuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuRW50aXR5VHJhbnNhY3Rpb247XG5pbXBvcnQgbW9kZWwuSG9hRG9uO1xuaW1wb3J0IG1vZGVsLktoYWNoSGFuZztcbmltcG9ydCBtb2RlbC5UcmFuZ1RoYWlWZVRhdTtcbmltcG9ydCBtb2RlbC5WZVRhdTtcbmltcG9ydCB1dGlsLkpQQVV0aWw7XG5cbmltcG9ydCBqYXZhLnJtaS5SZW1vdGVFeGNlcHRpb247XG5pbXBvcnQgamF2YS5ybWkuc2VydmVyLlVuaWNhc3RSZW1vdGVPYmplY3Q7XG5pbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7XG5pbXBvcnQgamF2YS51dGlsLkxpc3Q7XG5pbXBvcnQgamF2YS51dGlsLk1hcDtcbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9STUlTZXJ2ZXIuamF2YVxuLi4uXG5cbiAgICAgICAgICAgIEhvYURvbkRBTyBob2FEb25EQU8gPSBuZXcgSG9hRG9uREFPSW1wbCgpO1xuICAgICAgICAgICAgS2hhY2hIYW5nREFPIGtoYWNoSGFuZ0RBTyA9IG5ldyBLaGFjaEhhbmdEQU9JbXBsKCk7XG4gICAgICAgICAgICBMb2FpS2hhY2hIYW5nREFPIGxvYWlLaGFjaEhhbmdEQU8gPSBuZXcgTG9haUtoYWNoSGFuZ0RBT0ltcGwoKTtcbiAgICAgICAgICAgIFZlVGF1REFPIHZlVGF1REFPID0gbmV3IFZlVGF1REFPSW1wbCgpO1xuICAgICAgICAgICAgRG9pVmVEQU8gZG9pVmVEQU8gPSBuZXcgRG9pVmVEQU9JbXBsKCk7IC8vIFRow6ptIGTDsm5nIG7DoHlcbiAgICAgICAgICAgIFRvYVRhdURvaVZlREFPIHRvYVRhdURvaVZlREFPID0gbmV3IFRvYVRhdURvaVZlREFPSW1wbCgpO1xuICAgICAgICAgICAgQ2hvTmdvaURvaVZlREFPIGNob05nb2lEb2lWZURBTyA9IG5ldyBDaG9OZ29pRG9pVmVEQU9JbXBsKCk7XG4gICAgICAgICAgICBMb2FpSG9hRG9uREFPIGxvYWlIb2FEb25EQU8gPSBuZXcgTG9haUhvYURvbkRBT0ltcGwoKTtcbiAgICAgICAgICAgIENoaVRpZXRIb2FEb25EQU8gY2hpVGlldEhvYURvbkRBTyA9IG5ldyBDaGlUaWV0SG9hRG9uREFPSW1wbCgpO1xuICAgICAgICAgICAgTmhhblZpZW5EQU8gbmhhblZpZW5EQU8gPSBuZXcgTmhhblZpZW5EQU9JbXBsKCk7XG4gICAgICAgICAgICBUYWlLaG9hbkRBTyB0YWlLaG9hbkRBTyA9IG5ldyBUYWlLaG9hbkRBT0ltcGwoKTtcbiAgICAgICAgICAgIFRyYUN1dVZlREFPIHRyYUN1dVZlREFPID0gbmV3IFRyYUN1dVZlREFPSW1wbCgpO1xuICAgICAgICAgICAgVGhvbmdLZURBTyB0aG9uZ0tlREFPID0gbmV3IFRob25nS2VEQU9JbXBsKCk7XG4gICAgICAgICAgICAvLyBU4bqhbyByZWdpc3RyeVxuICAgICAgICAgICAgUmVnaXN0cnkgcmVnaXN0cnkgPSBMb2NhdGVSZWdpc3RyeS5jcmVhdGVSZWdpc3RyeSg5MDkwKTtcblxuICAgICAgICAgICAgLy8gxJDEg25nIGvDvSBjw6FjIMSR4buRaSB0xrDhu6NuZyBEQU9cbiAgICAgICAgICAgIHJlZ2lzdHJ5LnJlYmluZChcImxpY2hUcmluaFRhdURBT1wiLCBsaWNoVHJpbmhUYXVEQU8pO1xuICAgICAgICAgICAgcmVnaXN0cnkucmViaW5kKFwidGF1REFPXCIsIHRhdURBTyk7XG4gICAgICAgICAgICByZWdpc3RyeS5yZWJpbmQoXCJ0dXllblRhdURBT1wiLCB0dXllblRhdURBTyk7XG5cbiAgICAgICAgICAgIHJlZ2lzdHJ5LnJlYmluZChcImhvYURvbkRBT1wiLCBob2FEb25EQU8pO1xuICAgICAgICAgICAgcmVnaXN0cnkucmViaW5kKFwidmVUYXVEQU9cIiwgdmVUYXVEQU8pO1xuICAgICAgICAgICAgcmVnaXN0cnkucmViaW5kKFwia2hhY2hIYW5nREFPXCIsIGtoYWNoSGFuZ0RBTyk7XG4gICAgICAgICAgICByZWdpc3RyeS5yZWJpbmQoXCJsb2FpS2hhY2hIYW5nREFPXCIsIGxvYWlLaGFjaEhhbmdEQU8pO1xuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2Rhby9UYXVEQU8uamF2YVxucGFja2FnZSBkYW87XG5cbmltcG9ydCBtb2RlbC5MaWNoVHJpbmhUYXU7XG5pbXBvcnQgbW9kZWwuVGF1O1xuXG5pbXBvcnQgamF2YS5ybWkuUmVtb3RlO1xuaW1wb3J0IGphdmEucm1pLlJlbW90ZUV4Y2VwdGlvbjtcbmltcG9ydCBqYXZhLnV0aWwuTGlzdDtcblxucHVibGljIGludGVyZmFjZSBUYXVEQU8gZXh0ZW5kcyBSZW1vdGUge1xuICAgIExpc3Q8VGF1PiBnZXRBbGxMaXN0VCgpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG4gICAgTGlzdDxUYXU+IGdldEFsbFdpdGhSb3V0ZXMoKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuICAgIHB1YmxpYyBUYXUgZ2V0VGF1QnlMaWNoVHJpbmhUYXUoTGljaFRyaW5oVGF1IGxpY2hUcmluaCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcbn1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9ndWlDbGllbnQvUXVhbkx5S2hhY2hIYW5nUGFuZWwuamF2YVxucGFja2FnZSBndWlDbGllbnQ7XG5cbmltcG9ydCBkYW8uKjtcbmltcG9ydCBkYW8uaW1wbC5LaGFjaEhhbmdEQU9JbXBsO1xuaW1wb3J0IGRhby5pbXBsLkxvYWlLaGFjaEhhbmdEQU9JbXBsO1xuaW1wb3J0IGRhby5pbXBsLlZlVGF1REFPSW1wbDtcbmltcG9ydCBndWlDbGllbnQuZm9ybWF0LkRhdGVMYWJlbEZvcm1hdHRlcjtcbmltcG9ydCBtb2RlbC4qO1xuaW1wb3J0IG9yZy5qZGF0ZXBpY2tlci5pbXBsLkpEYXRlUGFuZWxJbXBsO1xuaW1wb3J0IG9yZy5qZGF0ZXBpY2tlci5pbXBsLkpEYXRlUGlja2VySW1wbDtcbmltcG9ydCBvcmcuamRhdGVwaWNrZXIuaW1wbC5VdGlsRGF0ZU1vZGVsO1xuaW1wb3J0IHNlcnZpY2UuQUlUcmF2ZWxUaW1lUHJlZGljdG9yO1xuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2RhdGFmYWtlci9MaWNoVHJpbmhUYXVERi5qYXZhXG4vL3BhY2thZ2UgZGF0YWZha2VyO1xuLy9cbi8vaW1wb3J0IGRhby5pbXBsLkxpY2hUcmluaFRhdURBT0ltcGw7XG4vL2ltcG9ydCBkYW8uaW1wbC5Mb2FpQ2hvREFPSW1wbDtcbi8vaW1wb3J0IGRhby5pbXBsLlRvYVRhdURBT0ltcGw7XG4vL2ltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXI7XG4vL2ltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLkVudGl0eVRyYW5zYWN0aW9uO1xuLy9pbXBvcnQgbW9kZWwuKjtcbi8vaW1wb3J0IG5ldC5kYXRhZmFrZXIuRmFrZXI7XG4vL2ltcG9ydCBvcmcuaGliZXJuYXRlLkhpYmVybmF0ZTtcbi8vXG4vL2ltcG9ydCBqYXZhLnJtaS5SZW1vdGVFeGNlcHRpb247XG4vL2ltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlO1xuLy9pbXBvcnQgamF2YS50aW1lLkxvY2FsRGF0ZVRpbWU7XG4vL2ltcG9ydCBqYXZhLnRpbWUuTG9jYWxUaW1lO1xuLy9pbXBvcnQgamF2YS50aW1lLmZvcm1hdC5EYXRlVGltZUZvcm1hdHRlcjtcbi8vaW1wb3J0IGphdmEudGltZS50ZW1wb3JhbC5DaHJvbm9Vbml0O1xuLy9pbXBvcnQgamF2YS51dGlsLkxpc3Q7XG4vL2ltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5UaHJlYWRMb2NhbFJhbmRvbTtcbi8vXG4vL3B1YmxpYyBjbGFzcyBMaWNoVHJpbmhUYXVERiB7XG4vLyAgICBwcml2YXRlIHN0YXRpYyBMb2NhbERhdGUgbGFzdERhdGUgPSBMb2NhbERhdGUubm93KCk7IC8vIE5nw6B5IGN14buRaSBjw7luZyDEkcOjIHThuqFvIHbDqVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL21vZGVsL0xpY2hUcmluaFRhdS5qYXZhXG5wYWNrYWdlIG1vZGVsO1xuXG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS4qO1xuaW1wb3J0IGxvbWJvay5EYXRhO1xuaW1wb3J0IGxvbWJvay5FcXVhbHNBbmRIYXNoQ29kZTtcbmltcG9ydCBsb21ib2suVG9TdHJpbmc7XG5cbmltcG9ydCBqYXZhLmlvLlNlcmlhbGl6YWJsZTtcbmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlO1xuaW1wb3J0IGphdmEudGltZS5Mb2NhbFRpbWU7XG5pbXBvcnQgamF2YS51dGlsLlNldDtcblxuQEVudGl0eVxuQERhdGFcbkBFcXVhbHNBbmRIYXNoQ29kZShvbmx5RXhwbGljaXRseUluY2x1ZGVkID0gdHJ1ZSlcbkBUYWJsZShuYW1lID0gXCJsaWNodHJpbmh0YXVcIilcbnB1YmxpYyBjbGFzcyBMaWNoVHJpbmhUYXUgaW1wbGVtZW50cyBTZXJpYWxpemFibGUge1xuICAgIEBJZFxuICAgIEBDb2x1bW4obmFtZSA9IFwibWFfbGljaFwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJWQVJDSEFSKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSwgdW5pcXVlID0gdHJ1ZSlcbiAgICBwcml2YXRlIFN0cmluZyBtYUxpY2g7XG5cbiAgICBAQ29sdW1uKG5hbWUgPSBcImdpb19kaVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJUSU1FXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBMb2NhbFRpbWUgZ2lvRGk7XG5cbiAgICBAQ29sdW1uKG5hbWUgPSBcIm5nYXlfZGlcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiREFURVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgTG9jYWxEYXRlIG5nYXlEaTtcblxuICAgIEBFbnVtZXJhdGVkKEVudW1UeXBlLlNUUklORylcbiAgICBAQ29sdW1uKG5hbWUgPSBcInRyYW5nX3RoYWlcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiTlZBUkNIQVIoNTApXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBUcmFuZ1RoYWkgdHJhbmdUaGFpO1xuXG4gICAgQE1hbnlUb09uZVxuICAgIEBKb2luQ29sdW1uKG5hbWUgPSBcInRhdV9tYV90YXVcIiwgcmVmZXJlbmNlZENvbHVtbk5hbWUgPSBcIm1hX3RhdVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgVGF1IHRhdTtcblxuICAgIEBPbmVUb01hbnkobWFwcGVkQnkgPSBcImxpY2hUcmluaFRhdVwiKVxuICAgIEBUb1N0cmluZy5FeGNsdWRlXG4gICAgcHJpdmF0ZSBTZXQ8VmVUYXU+IHZlX3RhdXM7XG59Li4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL21vZGVsL1RhdS5qYXZhXG5wYWNrYWdlIG1vZGVsO1xuXG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS4qO1xuaW1wb3J0IGxvbWJvay5EYXRhO1xuaW1wb3J0IGxvbWJvay5FcXVhbHNBbmRIYXNoQ29kZTtcbmltcG9ydCBsb21ib2suVG9TdHJpbmc7XG5cbmltcG9ydCBqYXZhLmlvLlNlcmlhbGl6YWJsZTtcbmltcG9ydCBqYXZhLnV0aWwuU2V0O1xuXG5ARGF0YVxuQEVudGl0eVxuQEVxdWFsc0FuZEhhc2hDb2RlKG9ubHlFeHBsaWNpdGx5SW5jbHVkZWQgPSB0cnVlKVxuQFRhYmxlKG5hbWUgPSBcInRhdVwiKVxucHVibGljIGNsYXNzIFRhdSBpbXBsZW1lbnRzIFNlcmlhbGl6YWJsZSB7XG4gICAgQElkXG4gICAgQEVxdWFsc0FuZEhhc2hDb2RlLkluY2x1ZGVcbiAgICBAQ29sdW1uKG5hbWUgPSBcIm1hX3RhdVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJ2YXJjaGFyKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSwgdW5pcXVlID0gdHJ1ZSlcbiAgICBwcml2YXRlIFN0cmluZyBtYVRhdTsgLy8gTcOjIHTDoHVcbiAgICBAQ29sdW1uKG5hbWUgPSBcInRlbl90YXVcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwidmFyY2hhcigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgQEVxdWFsc0FuZEhhc2hDb2RlLkV4Y2x1ZGVcbiAgICBwcml2YXRlIFN0cmluZyB0ZW5UYXU7XG4gICAgQENvbHVtbihuYW1lID0gXCJzb190b2FcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBARXF1YWxzQW5kSGFzaENvZGUuRXhjbHVkZS8vIFTDqm4gdMOgdVxuICAgIHByaXZhdGUgaW50IHNvVG9hO1xuICAgIC8vIFPhu5EgdG9hXG4gICAgQE1hbnlUb09uZShmZXRjaCA9IEZldGNoVHlwZS5MQVpZKVxuICAgIEBUb1N0cmluZy5FeGNsdWRlXG4gICAgQEpvaW5Db2x1bW4obmFtZSA9IFwibWFfdHV5ZW5cIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIFR1eWVuVGF1IHR1eWVuVGF1OyAvLyDEkOG7kWkgdMaw4bujbmcgVHV5ZW5UYXVcblxuICAgIEBPbmVUb01hbnkobWFwcGVkQnkgPSBcInRhdVwiLCBjYXNjYWRlID0gQ2FzY2FkZVR5cGUuQUxMLCBvcnBoYW5SZW1vdmFsID0gdHJ1ZSlcbiAgICBAVG9TdHJpbmcuRXhjbHVkZVxuICAgIHByaXZhdGUgU2V0PFRvYVRhdT4gZGFuaFNhY2hUb2FUYXU7XG5cbiAgICBAT25lVG9NYW55KG1hcHBlZEJ5ID0gXCJ0YXVcIiwgY2FzY2FkZSA9IENhc2NhZGVUeXBlLkFMTCwgb3JwaGFuUmVtb3ZhbCA9IHRydWUpXG4gICAgQFRvU3RyaW5nLkV4Y2x1ZGVcbiAgICBwcml2YXRlIFNldDxMaWNoVHJpbmhUYXU+IExpY2hUcmluaFRhdTtcbn1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9tb2RlbC9UcmFuZ1RoYWkuamF2YVxucGFja2FnZSBtb2RlbDtcblxucHVibGljIGVudW0gVHJhbmdUaGFpIHtcbiAgICBEQV9LSE9JX0hBTkgoXCLEkMOjIGto4bufaSBow6BuaFwiKSxcbiAgICBDSFVBX0tIT0lfSEFOSChcIkNoxrBhIGto4bufaSBow6BuaFwiKSxcbiAgICBEQV9IVVkoXCLEkMOjIGjhu6d5XCIpLFxuICAgIEhPQVRfRE9ORyhcIkhv4bqhdCDEkeG7mW5nXCIpO1xuXG4gICAgcHJpdmF0ZSBmaW5hbCBTdHJpbmcgdmFsdWU7XG5cbiAgICBUcmFuZ1RoYWkoU3RyaW5nIHZhbHVlKSB7XG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgU3RyaW5nIGdldFZhbHVlKCkge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBUcmFuZ1RoYWkgZnJvbVZhbHVlKFN0cmluZyB2YWx1ZSkge1xuICAgICAgICBmb3IgKFRyYW5nVGhhaSBzdGF0dXMgOiBUcmFuZ1RoYWkudmFsdWVzKCkpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMudmFsdWUuZXF1YWxzKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzdGF0dXM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbihcIk5vIGVudW0gY29uc3RhbnQgZm9yIHZhbHVlOiBcIiArIHZhbHVlKTtcbiAgICB9XG59Li4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL21vZGVsL0todXllbk1haS5qYXZhXG5wYWNrYWdlIG1vZGVsO1xuXG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS4qO1xuaW1wb3J0IGxvbWJvay5EYXRhO1xuXG5pbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7XG5pbXBvcnQgamF2YS50aW1lLkxvY2FsRGF0ZTtcbmltcG9ydCBqYXZhLnV0aWwuT2JqZWN0cztcbmltcG9ydCBqYXZhLnV0aWwuU2V0O1xuXG5ARGF0YVxuQEVudGl0eVxuQFRhYmxlKG5hbWUgPSBcImtodXllbm1haVwiKVxucHVibGljIGNsYXNzIEtodXllbk1haSBpbXBsZW1lbnRzIFNlcmlhbGl6YWJsZSB7XG4gICAgQElkXG4gICAgQENvbHVtbihuYW1lID0gXCJtYV9rbVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJWQVJDSEFSKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSx1bmlxdWUgPSB0cnVlKVxuICAgIHByaXZhdGUgU3RyaW5nIG1hS007XG4gICAgQENvbHVtbihuYW1lID0gXCJ0ZW5fa21cIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiTlZBUkNIQVIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgU3RyaW5nIHRlbktNO1xuICAgIEBDb2x1bW4obmFtZSA9IFwidGhvaV9naWFuX2JhdF9kYXVcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiREFURVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgTG9jYWxEYXRlIHRob2lHaWFuQmF0RGF1O1xuICAgIEBDb2x1bW4obmFtZSA9IFwidGhvaV9naWFuX2tldF90aHVjXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcIkRBVEVcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIExvY2FsRGF0ZSB0aG9pR2lhbktldFRodWM7XG4gICAgQENvbHVtbihuYW1lID0gXCJub2lfZHVuZ19rbVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJOVkFSQ0hBUigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBTdHJpbmcgbm9pRHVuZ0tNO1xuICAgIEBDb2x1bW4obmFtZSA9IFwiY2hpZXRfa2hhdVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJkb3VibGVcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIGRvdWJsZSBjaGlldEtoYXU7XG4gICAgQENvbHVtbihuYW1lID0gXCJkb2lfdHVvbmdfYXBfZHVuZ1wiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJOVkFSQ0hBUigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBEb2lUdW9uZ0FwRHVuZyBkb2lUdW9uZ0FwRHVuZztcbiAgICBAQ29sdW1uKG5hbWUgPSBcInRyYW5nX3RoYWlcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiTlZBUkNIQVIoNTApXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBTdHJpbmcgdHJhbmdUaGFpO1xuXG4gICAgQE9uZVRvTWFueShtYXBwZWRCeSA9IFwia2h1eWVuTWFpXCIpXG4gICAgcHJpdmF0ZSBTZXQ8VmVUYXU+IHZlX3RhdXM7XG5cblxufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2Rhby9Mb2FpS2hhY2hIYW5nREFPLmphdmFcbnBhY2thZ2UgZGFvO1xuXG5pbXBvcnQgbW9kZWwuTG9haUtoYWNoSGFuZztcblxuaW1wb3J0IGphdmEucm1pLlJlbW90ZTtcbmltcG9ydCBqYXZhLnJtaS5SZW1vdGVFeGNlcHRpb247XG5pbXBvcnQgamF2YS51dGlsLkxpc3Q7XG5cbi8qKlxuICogQEThu7Egw6FuOiBQaGFuVGFuSmF2YU5ob21HUFRcbiAqIEBDbGFzczogTG9haUtoYWNoSGFuZ0RBT1xuICogQFThuqFvIHbDoG8gbmfDoHk6IDE4LzA0LzIwMjVcbiAqIEBUw6FjIGdp4bqjOiBOZ3V5ZW4gSHV1IFNhbmdcbiAqL1xucHVibGljIGludGVyZmFjZSBMb2FpS2hhY2hIYW5nREFPIGV4dGVuZHMgUmVtb3RlIHtcbiAgICBMaXN0PExvYWlLaGFjaEhhbmc+IGdldEFsbCgpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG4gICAgTG9haUtoYWNoSGFuZyBmaW5kQnlJZChTdHJpbmcgaWQpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG4gICAgYm9vbGVhbiBzYXZlKExvYWlLaGFjaEhhbmcgbG9haUtoYWNoSGFuZykgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcbiAgICBib29sZWFuIHVwZGF0ZShMb2FpS2hhY2hIYW5nIGxvYWlLaGFjaEhhbmcpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG4gICAgYm9vbGVhbiBkZWxldGUoU3RyaW5nIGlkKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuXG4vLyAgICAgTGlzdDxMb2FpS2hhY2hIYW5nPiBnZXRBbGxMaXN0KCk7XG59Li4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2Rhby9pbXBsL0todXllbk1haURBT0ltcGwuamF2YVxucGFja2FnZSBkYW8uaW1wbDtcblxuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuRW50aXR5TWFuYWdlcjtcbmltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLkVudGl0eVRyYW5zYWN0aW9uO1xuaW1wb3J0IGxvbWJvay5BbGxBcmdzQ29uc3RydWN0b3I7XG5pbXBvcnQgbW9kZWwuS2h1eWVuTWFpO1xuaW1wb3J0IHV0aWwuSlBBVXRpbDtcblxuaW1wb3J0IGphdmEuc3FsLlByZXBhcmVkU3RhdGVtZW50O1xuaW1wb3J0IGphdmEuc3FsLlJlc3VsdFNldDtcbmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlO1xuaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7XG5pbXBvcnQgamF2YS51dGlsLkxpc3Q7XG5cbkBBbGxBcmdzQ29uc3RydWN0b3JcbnB1YmxpYyBjbGFzcyBLaHV5ZW5NYWlEQU9JbXBsIHtcblxuICAgIHByaXZhdGUgRW50aXR5TWFuYWdlciBlbTtcbiAgICBwdWJsaWMgS2h1eWVuTWFpREFPSW1wbCgpIHtcbiAgICAgICAgdGhpcy5lbSA9IEpQQVV0aWwuZ2V0RW50aXR5TWFuYWdlcigpOztcbiAgICB9XG4gICAgLy8gTOG6pXkgZGFuaCBzw6FjaCB04bqldCBj4bqjIGPDoWMga2h1eeG6v24gbcOjaVxuICAgIHB1YmxpYyBMaXN0PEtodXllbk1haT4gZmluZEFsbCgpIHtcbiAgICAgICAgU3RyaW5nIHF1ZXJ5ID0gXCJzZWxlY3Qga20gZnJvbSBLaHV5ZW5NYWkga21cIjtcbiAgICAgICAgcmV0dXJuIGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5LCBLaHV5ZW5NYWkuY2xhc3MpLmdldFJlc3VsdExpc3QoKTtcbiAgICB9XG5cbiAgICAvLyBM4bqleSBkYW5oIHPDoWNoIGtodXnhur9uIG3Do2kgdGhlbyB0w6puXG4gICAgcHVibGljIExpc3Q8S2h1eWVuTWFpPiBmaW5kQnlOYW1lKFN0cmluZyBuYW1lKSB7XG4gICAgICAgIFN0cmluZyBxdWVyeSA9IFwic2VsZWN0IGttIGZyb20gS2h1eWVuTWFpIGttIHdoZXJlIGttLnRlbktNIGxpa2UgOm5hbWVcIjtcbiAgICAgICAgcmV0dXJuIGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5LCBLaHV5ZW5NYWkuY2xhc3MpXG4gICAgICAgICAgICAgICAgLnNldFBhcmFtZXRlcihcIm5hbWVcIiwgXCIlXCIgKyBuYW1lICsgXCIlXCIpXG4gICAgICAgICAgICAgICAgLmdldFJlc3VsdExpc3QoKTtcbiAgICB9XG5cbiAgICAvLyBM4bqleSBraHV54bq/biBtw6NpIHRoZW8gbcOjXG4gICAgcHVibGljIEtodXllbk1haSBmaW5kQnlJZChTdHJpbmcgaWQpIHtcbiAgICAgICAgcmV0dXJuIGVtLmZpbmQoS2h1eWVuTWFpLmNsYXNzLCBpZCk7XG4gICAgfVxuXG4gICAgLy8gVGjDqm0gaG/hurdjIGPhuq1wIG5o4bqtdCBraHV54bq/biBtw6NpXG4gICAgcHVibGljIGJvb2xlYW4gc2F2ZShLaHV5ZW5NYWkga2h1eWVuTWFpKSB7XG4gICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRyLmJlZ2luKCk7XG4gICAgICAgICAgICBpZiAoZW0uZmluZChLaHV5ZW5NYWkuY2xhc3MsIGtodXllbk1haS5nZXRNYUtNKCkpID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBlbS5wZXJzaXN0KGtodXllbk1haSk7IC8vIFRow6ptIG3hu5tpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGVtLm1lcmdlKGtodXllbk1haSk7IC8vIEPhuq1wIG5o4bqtdFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdHIuY29tbWl0KCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGV4KSB7XG4gICAgICAgICAgICBleC5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgIHRyLnJvbGxiYWNrKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIFjDs2Ega2h1eeG6v24gbcOjaSB0aGVvIG3Do1xuICAgIHB1YmxpYyBib29sZWFuIGRlbGV0ZShTdHJpbmcgaWQpIHtcbiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHIgPSBlbS5nZXRUcmFuc2FjdGlvbigpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdHIuYmVnaW4oKTtcbiAgICAgICAgICAgIEtodXllbk1haSBrbSA9IGVtLmZpbmQoS2h1eWVuTWFpLmNsYXNzLCBpZCk7XG4gICAgICAgICAgICBpZiAoa20gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGVtLnJlbW92ZShrbSk7XG4gICAgICAgICAgICAgICAgdHIuY29tbWl0KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBleCkge1xuICAgICAgICAgICAgZXgucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgICAgICB0ci5yb2xsYmFjaygpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLy8gVMOsbSBjw6FjIGtodXnhur9uIG3Do2kgxJFhbmcgw6FwIGThu6VuZ1xuICAgIHB1YmxpYyBMaXN0PEtodXllbk1haT4gZmluZE9uZ29pbmdQcm9tb3Rpb25zKCkge1xuICAgICAgICBTdHJpbmcgcXVlcnkgPSBcInNlbGVjdCBrbSBmcm9tIEtodXllbk1haSBrbSBcIiArXG4gICAgICAgICAgICAgICAgXCJ3aGVyZSBrbS50cmFuZ1RoYWkgPSA6dHJhbmdUaGFpIFwiICtcbiAgICAgICAgICAgICAgICBcImFuZCBrbS50aG9pR2lhbkJhdERhdSA8PSA6dG9kYXkgXCIgK1xuICAgICAgICAgICAgICAgIFwiYW5kIGttLnRob2lHaWFuS2V0VGh1YyA+PSA6dG9kYXlcIjtcblxuICAgICAgICByZXR1cm4gZW0uY3JlYXRlUXVlcnkocXVlcnksIEtodXllbk1haS5jbGFzcylcbiAgICAgICAgICAgICAgICAuc2V0UGFyYW1ldGVyKFwidHJhbmdUaGFpXCIsIFwixJBhbmcgZGnhu4VuIHJhXCIpXG4gICAgICAgICAgICAgICAgLnNldFBhcmFtZXRlcihcInRvZGF5XCIsIExvY2FsRGF0ZS5ub3coKSlcbiAgICAgICAgICAgICAgICAuZ2V0UmVzdWx0TGlzdCgpO1xuICAgIH1cblxufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL21vZGVsL1RyYW5nVGhhaVZlVGF1LmphdmFcbnBhY2thZ2UgbW9kZWw7XG5cbnB1YmxpYyBlbnVtIFRyYW5nVGhhaVZlVGF1IHtcbiAgICBDSE9fWEFDX05IQU4oXCJDaOG7nSB4w6FjIG5o4bqtblwiKSxcbiAgICBEQV9USEFOSF9UT0FOKFwixJDDoyB0aGFuaCB0b8OhblwiKSxcbiAgICBEQV9ET0koXCLEkMOjIMSR4buVaVwiKSxcbiAgICBEQV9UUkEoXCLEkMOjIHRy4bqjXCIpO1xuXG4gICAgcHJpdmF0ZSBmaW5hbCBTdHJpbmcgdmFsdWU7XG5cbiAgICBUcmFuZ1RoYWlWZVRhdShTdHJpbmcgdmFsdWUpIHtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgIH1cblxuICAgIHB1YmxpYyBTdHJpbmcgZ2V0VmFsdWUoKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIFRyYW5nVGhhaVZlVGF1IGZyb21WYWx1ZShTdHJpbmcgdmFsdWUpIHtcbiAgICAgICAgZm9yIChUcmFuZ1RoYWlWZVRhdSBzdGF0dXMgOiBUcmFuZ1RoYWlWZVRhdS52YWx1ZXMoKSkge1xuICAgICAgICAgICAgaWYgKHN0YXR1cy52YWx1ZS5lcXVhbHModmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0YXR1cztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKFwiTm8gZW51bSBjb25zdGFudCBmb3IgdmFsdWU6IFwiICsgdmFsdWUpO1xuICAgIH1cbn0uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGFvL0xvYWlIb2FEb25EQU8uamF2YVxucGFja2FnZSBkYW87XG5cbmltcG9ydCBtb2RlbC5Mb2FpSG9hRG9uO1xuXG5pbXBvcnQgamF2YS5ybWkuUmVtb3RlO1xuXG5wdWJsaWMgaW50ZXJmYWNlIExvYWlIb2FEb25EQU8gZXh0ZW5kcyBSZW1vdGUge1xuICAgIExvYWlIb2FEb24gZmluZEJ5SWQoU3RyaW5nIGlkKSB0aHJvd3MgRXhjZXB0aW9uO1xufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL21vZGVsL0xvYWlDaG8uamF2YVxucGFja2FnZSBtb2RlbDtcblxuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuKjtcbmltcG9ydCBsb21ib2suRGF0YTtcbmltcG9ydCBsb21ib2suRXF1YWxzQW5kSGFzaENvZGU7XG5pbXBvcnQgbG9tYm9rLlRvU3RyaW5nO1xuXG5pbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7XG5pbXBvcnQgamF2YS51dGlsLlNldDtcblxuQEVudGl0eVxuQERhdGFcbkBFcXVhbHNBbmRIYXNoQ29kZShvbmx5RXhwbGljaXRseUluY2x1ZGVkID0gdHJ1ZSlcbkBUYWJsZShuYW1lID0gXCJsb2FpY2hvXCIpXG5wdWJsaWMgY2xhc3MgTG9haUNobyBpbXBsZW1lbnRzIFNlcmlhbGl6YWJsZSB7XG4gICAgQElkXG4gICAgQEVxdWFsc0FuZEhhc2hDb2RlLkluY2x1ZGVcbiAgICBAQ29sdW1uKG5hbWUgPSBcIm1hX2xvYWkuLi4iLCJpc0Vycm9yIjpmYWxzZSwicmVxdWVzdElkIjoiIn19LCJmZjA0N2ZmMS0xNzlhLTQ0MzYtOTkxYi0wMjZkMWZjMmZjMTI7dG9vbHVfMDFHU21yVFNFU1lpalozU2VVUnVpZzY4Ijp7InBoYXNlIjo1LCJyZXN1bHQiOnsidGV4dCI6IlRoZSBmb2xsb3dpbmcgY29kZSBzZWN0aW9ucyB3ZXJlIHJldHJpZXZlZDpcblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGF0YWZha2VyL0todXllbk1haURGLmphdmFcbi4uLlxuXG5wdWJsaWMgY2xhc3MgS2h1eWVuTWFpREYge1xuXG4gICAgLy8gSMOgbSB04bqhbyBtw6Mga2h1eeG6v24gbcOjaSB04buxIHTEg25nXG4gICAgcHJpdmF0ZSBzdGF0aWMgU3RyaW5nIGdlbmVyYXRlTmV4dE1hS00oRW50aXR5TWFuYWdlciBlbSkge1xuICAgICAgICBTdHJpbmcgcHJlZml4ID0gXCJLTVwiO1xuICAgICAgICBTdHJpbmcgcXVlcnlTdHIgPSBcIlNFTEVDVCBNQVgoay5tYUtNKSBGUk9NIEtodXllbk1haSBrIFdIRVJFIGsubWFLTSBMSUtFIDpwcmVmaXhcIjtcbiAgICAgICAgUXVlcnkgcXVlcnkgPSBlbS5jcmVhdGVRdWVyeShxdWVyeVN0cik7XG4gICAgICAgIHF1ZXJ5LnNldFBhcmFtZXRlcihcInByZWZpeFwiLCBwcmVmaXggKyBcIiVcIik7XG5cbiAgICAgICAgU3RyaW5nIG1heE1hS00gPSAoU3RyaW5nKSBxdWVyeS5nZXRTaW5nbGVSZXN1bHQoKTtcbiAgICAgICAgaW50IG5leHROdW1iZXIgPSAxO1xuXG4gICAgICAgIGlmIChtYXhNYUtNICE9IG51bGwpIHtcbiAgICAgICAgICAgIC8vIEzhuqV5IHBo4bqnbiBz4buRIHThu6sgbcOjIGN14buRaSBjw7luZyB2w6AgdMSDbmcgbMOqbiAxXG4gICAgICAgICAgICBTdHJpbmcgbnVtYmVyUGFydCA9IG1heE1hS00uc3Vic3RyaW5nKHByZWZpeC5sZW5ndGgoKSk7XG4gICAgICAgICAgICBuZXh0TnVtYmVyID0gSW50ZWdlci5wYXJzZUludChudW1iZXJQYXJ0KSArIDE7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBUcuG6oyB24buBIG3DoyBraHV54bq/biBtw6NpIHbhu5tpIMSR4buLbmggZOG6oW5nIEtNWFhYWFhYXG4gICAgICAgIHJldHVybiBTdHJpbmcuZm9ybWF0KFwiJXMlMDZkXCIsIHByZWZpeCwgbmV4dE51bWJlcik7XG4gICAgfVxuXG4gICAgLy8gSMOgbSDEkeG7gyBoaeG7g24gdGjhu4sgZOG7ryBsaeG7h3UgbeG6q3VcbiAgICBwdWJsaWMgc3RhdGljIHZvaWQgZ2VuZXJhdGVBbmRQcmludFNhbXBsZURhdGEoRW50aXR5TWFuYWdlciBlbSkge1xuXG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTtcbiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgMTU7IGkrKykge1xuICAgICAgICAgICAgICAgIEtodXllbk1haSBraHV5ZW5NYWkgPSBuZXcgS2h1eWVuTWFpKCk7XG4gICAgICAgICAgICAgICAga2h1eWVuTWFpLnNldE1hS00oZ2VuZXJhdGVOZXh0TWFLTShlbSkpOyAvLyBTaW5oIG3DoyB04buxIMSR4buZbmdcbiAgICAgICAgICAgICAgICBraHV5ZW5NYWkuc2V0VGVuS00oXCJLaHV54bq/biBtw6NpIHPhu5EgXCIgKyAoaSArIDEpKTtcbiAgICAgICAgICAgICAgICBraHV5ZW5NYWkuc2V0VGhvaUdpYW5CYXREYXUoTG9jYWxEYXRlLm5vdygpLm1pbnVzRGF5cyhpKSk7XG4gICAgICAgICAgICAgICAga2h1eWVuTWFpLnNldFRob2lHaWFuS2V0VGh1YyhMb2NhbERhdGUubm93KCkucGx1c0RheXMoaSArIDEwKSk7XG4gICAgICAgICAgICAgICAga2h1eWVuTWFpLnNldE5vaUR1bmdLTShcIkdp4bqjbSBnacOhIFwiICsgKDEwICsgaSkgKyBcIiUgY2hvIGtow6FjaCBow6BuZ1wiKTtcbiAgICAgICAgICAgICAgICBraHV5ZW5NYWkuc2V0Q2hpZXRLaGF1KDEwICsgaSk7XG4gICAgICAgICAgICAgICAga2h1eWVuTWFpLnNldERvaVR1b25nQXBEdW5nKFwiS2jDoWNoIGjDoG5nIGxv4bqhaSBcIiArIChpICUgMyArIDEpKTtcbiAgICAgICAgICAgICAgICBraHV5ZW5NYWkuc2V0VHJhbmdUaGFpKGkgJSAyID09IDAgPyBcIsSQYW5nIMOhcCBk4bulbmdcIiA6IFwiSOG6v3QgaOG6oW5cIik7XG5cbiAgICAgICAgICAgICAgICBlbS5wZXJzaXN0KGtodXllbk1haSk7IC8vIEzGsHUgdsOgbyBjxqEgc+G7nyBk4buvIGxp4buHdVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTtcbiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkucm9sbGJhY2soKTtcbiAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cblxufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL21vZGVsL0todXllbk1haS5qYXZhXG4uLi5cblxuQERhdGFcbkBFbnRpdHlcbkBUYWJsZShuYW1lID0gXCJraHV5ZW5tYWlcIilcbnB1YmxpYyBjbGFzcyBLaHV5ZW5NYWkgaW1wbGVtZW50cyBTZXJpYWxpemFibGUge1xuICAgIEBJZFxuICAgIEBDb2x1bW4obmFtZSA9IFwibWFfa21cIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiVkFSQ0hBUigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UsdW5pcXVlID0gdHJ1ZSlcbiAgICBwcml2YXRlIFN0cmluZyBtYUtNO1xuICAgIEBDb2x1bW4obmFtZSA9IFwidGVuX2ttXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcIk5WQVJDSEFSKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIFN0cmluZyB0ZW5LTTtcbiAgICBAQ29sdW1uKG5hbWUgPSBcInRob2lfZ2lhbl9iYXRfZGF1XCIsIGNvbHVtbkRlZmluaXRpb24gPSBcIkRBVEVcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIExvY2FsRGF0ZSB0aG9pR2lhbkJhdERhdTtcbiAgICBAQ29sdW1uKG5hbWUgPSBcInRob2lfZ2lhbl9rZXRfdGh1Y1wiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJEQVRFXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBMb2NhbERhdGUgdGhvaUdpYW5LZXRUaHVjO1xuICAgIEBDb2x1bW4obmFtZSA9IFwibm9pX2R1bmdfa21cIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiTlZBUkNIQVIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgU3RyaW5nIG5vaUR1bmdLTTtcbiAgICBAQ29sdW1uKG5hbWUgPSBcImNoaWV0X2toYXVcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiZG91YmxlXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBkb3VibGUgY2hpZXRLaGF1O1xuICAgIEBDb2x1bW4obmFtZSA9IFwiZG9pX3R1b25nX2FwX2R1bmdcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiTlZBUkNIQVIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgRG9pVHVvbmdBcER1bmcgZG9pVHVvbmdBcER1bmc7XG4gICAgQENvbHVtbihuYW1lID0gXCJ0cmFuZ190aGFpXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcIk5WQVJDSEFSKDUwKVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgU3RyaW5nIHRyYW5nVGhhaTtcblxuICAgIEBPbmVUb01hbnkobWFwcGVkQnkgPSBcImtodXllbk1haVwiKVxuICAgIHByaXZhdGUgU2V0PFZlVGF1PiB2ZV90YXVzO1xuXG5cbn1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS90ZXN0Q1JVRC9LaHV5ZW5NYWlEQU9UZXN0LmphdmFcbnBhY2thZ2UgdGVzdENSVUQ7XG5cbmltcG9ydCBkYW8uaW1wbC5LaHV5ZW5NYWlEQU9JbXBsO1xuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuRW50aXR5TWFuYWdlcjtcbmltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXJGYWN0b3J5O1xuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuUGVyc2lzdGVuY2U7XG5pbXBvcnQgbW9kZWwuS2h1eWVuTWFpO1xuXG5pbXBvcnQgamF2YS50aW1lLkxvY2FsRGF0ZTtcbmltcG9ydCBqYXZhLnV0aWwuTGlzdDtcblxucHVibGljIGNsYXNzIEtodXllbk1haURBT1Rlc3Qge1xuXG4gICAgcHVibGljIHN0YXRpYyB2b2lkIG1haW4oU3RyaW5nW10gYXJncykge1xuICAgICAgICAvLyBU4bqhbyBFbnRpdHlNYW5hZ2VyRmFjdG9yeSB2w6AgRW50aXR5TWFuYWdlclxuICAgICAgICBFbnRpdHlNYW5hZ2VyRmFjdG9yeSBlbWYgPSBQZXJzaXN0ZW5jZS5jcmVhdGVFbnRpdHlNYW5hZ2VyRmFjdG9yeShcIm1hcmlhZGJcIik7XG4gICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpO1xuXG4gICAgICAgIC8vIFThuqFvIGluc3RhbmNlIGPhu6dhIEtodXllbk1haURBT1xuICAgICAgICBLaHV5ZW5NYWlEQU9JbXBsIGtodXllbk1haURBT0ltcGwgPSBuZXcgS2h1eWVuTWFpREFPSW1wbChlbSk7XG5cbiAgICAgICAgLy8gMS4gVGjDqm0gaG/hurdjIGPhuq1wIG5o4bqtdCBraHV54bq/biBtw6NpXG4gICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIj09PSBUaMOqbSBob+G6t2MgY+G6rXAgbmjhuq10IGtodXnhur9uIG3Do2kgPT09XCIpO1xuICAgICAgICBLaHV5ZW5NYWkga2h1eWVuTWFpID0gbmV3IEtodXllbk1haSgpO1xuICAgICAgICBraHV5ZW5NYWkuc2V0TWFLTShcIktNMDAwMDE2XCIpO1xuICAgICAgICBraHV5ZW5NYWkuc2V0VGVuS00oXCJLaHV54bq/biBtw6NpIFThur90XCIpO1xuICAgICAgICBraHV5ZW5NYWkuc2V0VHJhbmdUaGFpKFwixJBhbmcgZGnhu4VuIHJhXCIpO1xuICAgICAgICBraHV5ZW5NYWkuc2V0VGhvaUdpYW5CYXREYXUoTG9jYWxEYXRlLm5vdygpLm1pbnVzRGF5cyg1KSk7XG4gICAgICAgIGtodXllbk1haS5zZXRUaG9pR2lhbktldFRodWMoTG9jYWxEYXRlLm5vdygpLnBsdXNEYXlzKDEwKSk7XG4gICAgICAgIGtodXllbk1haS5zZXRDaGlldEtoYXUoMC4yKTsgLy8gMjAlIGdp4bqjbSBnacOhXG4gICAgICAgIGtodXllbk1haS5zZXREb2lUdW9uZ0FwRHVuZyhcIlThuqV0IGPhuqMga2jDoWNoIGjDoG5nXCIpO1xuICAgICAgICBraHV5ZW5NYWkuc2V0Tm9pRHVuZ0tNKFwiR2nhuqNtIGdpw6EgMjAlIGNobyB04bqldCBj4bqjIHPhuqNuIHBo4bqpbVwiKTtcbiAgICAgICAgYm9vbGVhbiBpc1NhdmVkID0ga2h1eWVuTWFpREFPSW1wbC5zYXZlKGtodXllbk1haSk7XG4gICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIlRow6ptIGhv4bq3YyBj4bqtcCBuaOG6rXQga2h1eeG6v24gbcOjaTogXCIgKyAoaXNTYXZlZCA/IFwiVGjDoG5oIGPDtG5nXCIgOiBcIlRo4bqldCBi4bqhaVwiKSk7XG5cbiAgICAgICAgLy8gMi4gTOG6pXkgZGFuaCBzw6FjaCB04bqldCBj4bqjIGPDoWMga2h1eeG6v24gbcOjaVxuICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJcXG49PT0gRGFuaCBzw6FjaCB04bqldCBj4bqjIGPDoWMga2h1eeG6v24gbcOjaSA9PT1cIik7XG4gICAgICAgIExpc3Q8S2h1eWVuTWFpPiBhbGxQcm9tb3Rpb25zID0ga2h1eWVuTWFpREFPSW1wbC5maW5kQWxsKCk7XG4gICAgICAgIGFsbFByb21vdGlvbnMuZm9yRWFjaChTeXN0ZW0ub3V0OjpwcmludGxuKTtcblxuICAgICAgICAvLyAzLiBUw6xtIGtodXnhur9uIG3Do2kgdGhlbyB0w6puXG4gICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIlxcbj09PSBUw6xtIGtodXnhur9uIG3Do2kgdGhlbyB0w6puID09PVwiKTtcbiAgICAgICAgTGlzdDxLaHV5ZW5NYWk+IHByb21vdGlvbnNCeU5hbWUgPSBraHV5ZW5NYWlEQU9JbXBsLmZpbmRCeU5hbWUoXCJU4bq/dFwiKTtcbiAgICAgICAgcHJvbW90aW9uc0J5TmFtZS5mb3JFYWNoKFN5c3RlbS5vdXQ6OnByaW50bG4pO1xuXG4gICAgICAgIC8vIDQuIFTDrG0ga2h1eeG6v24gbcOjaSB0aGVvIG3Do1xuICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJcXG49PT0gVMOsbSBraHV54bq/biBtw6NpIHRoZW8gbcOjID09PVwiKTtcbiAgICAgICAgS2h1eWVuTWFpIGZvdW5kUHJvbW90aW9uID0ga2h1eWVuTWFpREFPSW1wbC5maW5kQnlJZChcIktNMDAxXCIpO1xuICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJL4bq/dCBxdeG6ozogXCIgKyAoZm91bmRQcm9tb3Rpb24gIT0gbnVsbCA/IGZvdW5kUHJvbW90aW9uIDogXCJLaMO0bmcgdMOsbSB0aOG6pXlcIikpO1xuXG4gICAgICAgIC8vIDUuIFTDrG0gY8OhYyBraHV54bq/biBtw6NpIMSRYW5nIMOhcCBk4bulbmdcbiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiXFxuPT09IFTDrG0gY8OhYyBraHV54bq/biBtw6NpIMSRYW5nIMOhcCBk4bulbmcgPT09XCIpO1xuICAgICAgICBMaXN0PEtodXllbk1haT4gb25nb2luZ1Byb21vdGlvbnMgPSBraHV5ZW5NYWlEQU9JbXBsLmZpbmRPbmdvaW5nUHJvbW90aW9ucygpO1xuICAgICAgICBvbmdvaW5nUHJvbW90aW9ucy5mb3JFYWNoKFN5c3RlbS5vdXQ6OnByaW50bG4pO1xuXG4gICAgICAgIC8vIDYuIFjDs2Ega2h1eeG6v24gbcOjaSB0aGVvIG3Do1xuICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJcXG49PT0gWMOzYSBraHV54bq/biBtw6NpIHRoZW8gbcOjID09PVwiKTtcbiAgICAgICAgYm9vbGVhbiBpc0RlbGV0ZWQgPSBraHV5ZW5NYWlEQU9JbXBsLmRlbGV0ZShcIktNMDAwMDAxXCIpO1xuICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJYw7NhIGtodXnhur9uIG3Do2k6IFwiICsgKGlzRGVsZXRlZCA/IFwiVGjDoG5oIGPDtG5nXCIgOiBcIlRo4bqldCBi4bqhaVwiKSk7XG5cbiAgICAgICAgLy8gxJDDs25nIEVudGl0eU1hbmFnZXIgdsOgIEVudGl0eU1hbmFnZXJGYWN0b3J5XG4gICAgICAgIGVtLmNsb3NlKCk7XG4gICAgICAgIGVtZi5jbG9zZSgpO1xuICAgIH1cbn1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9kYW8vaW1wbC9LaHV5ZW5NYWlEQU9JbXBsLmphdmFcbi4uLlxuXG5AQWxsQXJnc0NvbnN0cnVjdG9yXG5wdWJsaWMgY2xhc3MgS2h1eWVuTWFpREFPSW1wbCB7XG5cbiAgICBwcml2YXRlIEVudGl0eU1hbmFnZXIgZW07XG4gICAgcHVibGljIEtodXllbk1haURBT0ltcGwoKSB7XG4gICAgICAgIHRoaXMuZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTs7XG4gICAgfVxuICAgIC8vIEzhuqV5IGRhbmggc8OhY2ggdOG6pXQgY+G6oyBjw6FjIGtodXnhur9uIG3Do2lcbiAgICBwdWJsaWMgTGlzdDxLaHV5ZW5NYWk+IGZpbmRBbGwoKSB7XG4gICAgICAgIFN0cmluZyBxdWVyeSA9IFwic2VsZWN0IGttIGZyb20gS2h1eWVuTWFpIGttXCI7XG4gICAgICAgIHJldHVybiBlbS5jcmVhdGVRdWVyeShxdWVyeSwgS2h1eWVuTWFpLmNsYXNzKS5nZXRSZXN1bHRMaXN0KCk7XG4gICAgfVxuXG4gICAgLy8gTOG6pXkgZGFuaCBzw6FjaCBraHV54bq/biBtw6NpIHRoZW8gdMOqblxuICAgIHB1YmxpYyBMaXN0PEtodXllbk1haT4gZmluZEJ5TmFtZShTdHJpbmcgbmFtZSkge1xuICAgICAgICBTdHJpbmcgcXVlcnkgPSBcInNlbGVjdCBrbSBmcm9tIEtodXllbk1haSBrbSB3aGVyZSBrbS50ZW5LTSBsaWtlIDpuYW1lXCI7XG4gICAgICAgIHJldHVybiBlbS5jcmVhdGVRdWVyeShxdWVyeSwgS2h1eWVuTWFpLmNsYXNzKVxuICAgICAgICAgICAgICAgIC5zZXRQYXJhbWV0ZXIoXCJuYW1lXCIsIFwiJVwiICsgbmFtZSArIFwiJVwiKVxuICAgICAgICAgICAgICAgIC5nZXRSZXN1bHRMaXN0KCk7XG4gICAgfVxuXG4gICAgLy8gTOG6pXkga2h1eeG6v24gbcOjaSB0aGVvIG3Do1xuICAgIHB1YmxpYyBLaHV5ZW5NYWkgZmluZEJ5SWQoU3RyaW5nIGlkKSB7XG4gICAgICAgIHJldHVybiBlbS5maW5kKEtodXllbk1haS5jbGFzcywgaWQpO1xuICAgIH1cblxuICAgIC8vIFRow6ptIGhv4bq3YyBj4bqtcCBuaOG6rXQga2h1eeG6v24gbcOjaVxuICAgIHB1YmxpYyBib29sZWFuIHNhdmUoS2h1eWVuTWFpIGtodXllbk1haSkge1xuICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0ciA9IGVtLmdldFRyYW5zYWN0aW9uKCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0ci5iZWdpbigpO1xuICAgICAgICAgICAgaWYgKGVtLmZpbmQoS2h1eWVuTWFpLmNsYXNzLCBraHV5ZW5NYWkuZ2V0TWFLTSgpKSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgZW0ucGVyc2lzdChraHV5ZW5NYWkpOyAvLyBUaMOqbSBt4bubaVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBlbS5tZXJnZShraHV5ZW5NYWkpOyAvLyBD4bqtcCBuaOG6rXRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRyLmNvbW1pdCgpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBleCkge1xuICAgICAgICAgICAgZXgucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgICAgICB0ci5yb2xsYmFjaygpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBYw7NhIGtodXnhur9uIG3Do2kgdGhlbyBtw6NcbiAgICBwdWJsaWMgYm9vbGVhbiBkZWxldGUoU3RyaW5nIGlkKSB7XG4gICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRyLmJlZ2luKCk7XG4gICAgICAgICAgICBLaHV5ZW5NYWkga20gPSBlbS5maW5kKEtodXllbk1haS5jbGFzcywgaWQpO1xuICAgICAgICAgICAgaWYgKGttICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBlbS5yZW1vdmUoa20pO1xuICAgICAgICAgICAgICAgIHRyLmNvbW1pdCgpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZXgpIHtcbiAgICAgICAgICAgIGV4LnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgdHIucm9sbGJhY2soKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIC8vIFTDrG0gY8OhYyBraHV54bq/biBtw6NpIMSRYW5nIMOhcCBk4bulbmdcbiAgICBwdWJsaWMgTGlzdDxLaHV5ZW5NYWk+IGZpbmRPbmdvaW5nUHJvbW90aW9ucygpIHtcbiAgICAgICAgU3RyaW5nIHF1ZXJ5ID0gXCJzZWxlY3Qga20gZnJvbSBLaHV5ZW5NYWkga20gXCIgK1xuICAgICAgICAgICAgICAgIFwid2hlcmUga20udHJhbmdUaGFpID0gOnRyYW5nVGhhaSBcIiArXG4gICAgICAgICAgICAgICAgXCJhbmQga20udGhvaUdpYW5CYXREYXUgPD0gOnRvZGF5IFwiICtcbiAgICAgICAgICAgICAgICBcImFuZCBrbS50aG9pR2lhbktldFRodWMgPj0gOnRvZGF5XCI7XG5cbiAgICAgICAgcmV0dXJuIGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5LCBLaHV5ZW5NYWkuY2xhc3MpXG4gICAgICAgICAgICAgICAgLnNldFBhcmFtZXRlcihcInRyYW5nVGhhaVwiLCBcIsSQYW5nIGRp4buFbiByYVwiKVxuICAgICAgICAgICAgICAgIC5zZXRQYXJhbWV0ZXIoXCJ0b2RheVwiLCBMb2NhbERhdGUubm93KCkpXG4gICAgICAgICAgICAgICAgLmdldFJlc3VsdExpc3QoKTtcbiAgICB9XG5cbn1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9SdW5uZXIuamF2YVxuLi4uXG5cbnB1YmxpYyBjbGFzcyBSdW5uZXIge1xuICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG5cbiAgICAgICAgLy8gS2jhu59pIHThuqFvIEVudGl0eU1hbmFnZXIgdsOgIEVudGl0eVRyYW5zYWN0aW9uIMSR4buDIHTGsMahbmcgdMOhYyB24bubaSBjxqEgc+G7nyBk4buvIGxp4buHdVxuICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gUGVyc2lzdGVuY2UuY3JlYXRlRW50aXR5TWFuYWdlckZhY3RvcnkoXCJtYXJpYWRiXCIpXG4gICAgICAgICAgICAgICAgLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTtcbiAgICAgICAgS2h1eWVuTWFpREYuZ2VuZXJhdGVBbmRQcmludFNhbXBsZURhdGEoZW0pO1xuICAgICAgICBMb2FpVG9hREYuZ2VuZXJhdGVTYW1wbGVEYXRhKGVtKTtcbiAgICAgICAgVHV5ZW5UYXVERi5nZW5lcmF0ZVNhbXBsZURhdGEoZW0pO1xuICAgICAgICBUYXVERi5nZW5lcmF0ZVNhbXBsZURhdGEoZW0pO1xuICAgICAgICBUb2FUYXVERi5nZW5lcmF0ZVNhbXBsZURhdGEoZW0pO1xuICAgICAgICBMb2FpQ2hvREYuZ2VuZXJhdGVTYW1wbGVEYXRhKGVtKTtcblxuICAgICAgICBLaGFjaEhhbmdERiBraGFjaEhhbmdERiA9IG5ldyBLaGFjaEhhbmdERigpO1xuICAgICAgICBraGFjaEhhbmdERi5nZW5lcmF0ZUFuZFByaW50U2FtcGxlRGF0YSgpO1xuXG4gICAgICAgIExvYWlIb2FEb25ERiBmYWtlciA9IG5ldyBMb2FpSG9hRG9uREYoKTtcbiAgICAgICAgZmFrZXIuZ2VuZXJhdGVBbmRTYXZlTG9haUhvYURvbnMoZW0pO1xuXG4gICAgICAgIEhvYURvbkRGIGhvYURvbkZha2VyID0gbmV3IEhvYURvbkRGKGVtKTtcbiAgICAgICAgaG9hRG9uRmFrZXIuZ2VuZXJhdGVIb2FEb25EYXRhKDUwKTsgLy8gVOG6oW8gMjAgaMOzYSDEkcahblxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL21vZGVsL0RvaVR1b25nQXBEdW5nLmphdmFcbnBhY2thZ2UgbW9kZWw7XG5cbnB1YmxpYyBlbnVtIERvaVR1b25nQXBEdW5nIHtcbn1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9tb2RlbC9Mb2FpSG9hRG9uLmphdmFcbnBhY2thZ2UgbW9kZWw7XG5cblxuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuKjtcbmltcG9ydCBsb21ib2suRGF0YTtcbmltcG9ydCBsb21ib2suRXF1YWxzQW5kSGFzaENvZGU7XG5pbXBvcnQgbG9tYm9rLlRvU3RyaW5nO1xuXG5pbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7XG5pbXBvcnQgamF2YS51dGlsLlNldDtcblxuQERhdGFcbkBFcXVhbHNBbmRIYXNoQ29kZShvbmx5RXhwbGljaXRseUluY2x1ZGVkID0gdHJ1ZSlcbkBFbnRpdHlcbkBUYWJsZShuYW1lID0gXCJsb2FpaG9hZG9uXCIpXG5AVG9TdHJpbmdcbnB1YmxpYyBjbGFzcyBMb2FpSG9hRG9uIGltcGxlbWVudHMgU2VyaWFsaXphYmxlIHtcbiAgICBASWRcbiAgICBAQ29sdW1uKG5hbWUgPSBcIm1hX2xvYWlfaGRcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwidmFyY2hhcigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UsIHVuaXF1ZSA9IHRydWUpXG4gICAgQEVxdWFsc0FuZEhhc2hDb2RlLkluY2x1ZGVcbiAgICBwcml2YXRlIFN0cmluZyBtYUxvYWlIb2FEb247XG4gICAgQENvbHVtbihuYW1lID0gXCJ0ZW5fbG9haV9oZFwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJOVkFSQ0hBUigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBTdHJpbmcgdGVuTG9haUhvYURvbjtcblxuICAgIEBPbmVUb01hbnkobWFwcGVkQnkgPSBcImxvYWlIb2FEb25cIilcbiAgICBAVG9TdHJpbmcuRXhjbHVkZVxuICAgIHByaXZhdGUgU2V0PEhvYURvbj4gaG9hRG9ucztcblxuXG5cblxufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL21vZGVsL1RyYW5nVGhhaUtNLmphdmFcbnBhY2thZ2UgbW9kZWw7XG5cbnB1YmxpYyBlbnVtIFRyYW5nVGhhaUtNIHtcbn1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9kYW8vTG9haUtoYWNoSGFuZ0RBTy5qYXZhXG5wYWNrYWdlIGRhbztcblxuaW1wb3J0IG1vZGVsLkxvYWlLaGFjaEhhbmc7XG5cbmltcG9ydCBqYXZhLnJtaS5SZW1vdGU7XG5pbXBvcnQgamF2YS5ybWkuUmVtb3RlRXhjZXB0aW9uO1xuaW1wb3J0IGphdmEudXRpbC5MaXN0O1xuXG4vKipcbiAqIEBE4buxIMOhbjogUGhhblRhbkphdmFOaG9tR1BUXG4gKiBAQ2xhc3M6IExvYWlLaGFjaEhhbmdEQU9cbiAqIEBU4bqhbyB2w6BvIG5nw6B5OiAxOC8wNC8yMDI1XG4gKiBAVMOhYyBnaeG6ozogTmd1eWVuIEh1dSBTYW5nXG4gKi9cbnB1YmxpYyBpbnRlcmZhY2UgTG9haUtoYWNoSGFuZ0RBTyBleHRlbmRzIFJlbW90ZSB7XG4gICAgTGlzdDxMb2FpS2hhY2hIYW5nPiBnZXRBbGwoKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuICAgIExvYWlLaGFjaEhhbmcgZmluZEJ5SWQoU3RyaW5nIGlkKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuICAgIGJvb2xlYW4gc2F2ZShMb2FpS2hhY2hIYW5nIGxvYWlLaGFjaEhhbmcpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG4gICAgYm9vbGVhbiB1cGRhdGUoTG9haUtoYWNoSGFuZyBsb2FpS2hhY2hIYW5nKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuICAgIGJvb2xlYW4gZGVsZXRlKFN0cmluZyBpZCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcblxuLy8gICAgIExpc3Q8TG9haUtoYWNoSGFuZz4gZ2V0QWxsTGlzdCgpO1xufS4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9kYXRhZmFrZXIvTG9haUNob0RGLmphdmFcbi4uLlxuXG5wdWJsaWMgY2xhc3MgTG9haUNob0RGIHtcbiAgICBwdWJsaWMgc3RhdGljIHZvaWQgZ2VuZXJhdGVTYW1wbGVEYXRhKEVudGl0eU1hbmFnZXIgZW0pIHtcbiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHggPSBlbS5nZXRUcmFuc2FjdGlvbigpO1xuICAgICAgICBGYWtlciBmYWtlciA9IG5ldyBGYWtlcigpO1xuXG4gICAgICAgIC8vIHNldCBk4buvIGxp4buHdSBjaG8gTG9haUNob1xuICAgICAgICBMb2FpQ2hvIGxjMSA9IG5ldyBMb2FpQ2hvKCk7XG4gICAgICAgIGxjMS5zZXRNYUxvYWkoXCJMQzAxXCIpO1xuICAgICAgICBsYzEuc2V0VGVuTG9haShcIkdo4bq/IG5n4buTaSBj4bupbmdcIik7XG5cbiAgICAgICAgTG9haUNobyBsYzIgPSBuZXcgTG9haUNobygpO1xuICAgICAgICBsYzIuc2V0TWFMb2FpKFwiTEMwMlwiKTtcbiAgICAgICAgbGMyLnNldFRlbkxvYWkoXCJHaOG6vyBuZ+G7k2kgbeG7gW1cIik7XG5cbiAgICAgICAgTG9haUNobyBsYzMgPSBuZXcgTG9haUNobygpO1xuICAgICAgICBsYzMuc2V0TWFMb2FpKFwiTEMwM1wiKTtcbiAgICAgICAgbGMzLnNldFRlbkxvYWkoXCJHacaw4budbmcgbuG6sW0gbeG7gW1cIik7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0eC5iZWdpbigpO1xuICAgICAgICAgICAgZW0ucGVyc2lzdChsYzEpO1xuICAgICAgICAgICAgZW0ucGVyc2lzdChsYzIpO1xuICAgICAgICAgICAgZW0ucGVyc2lzdChsYzMpO1xuICAgICAgICAgICAgdHguY29tbWl0KCk7XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJQaMOhdCBzaW5oIGThu68gbGnhu4d1IHRow6BuaCBjw7RuZyBjaG8gTG9haUNob1wiKTtcbiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgIHR4LnJvbGxiYWNrKCk7XG4gICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCJQaMOhdCBzaW5oIGThu68gbGnhu4d1IHRo4bqldCBi4bqhaSBjaG8gTG9haUNob1wiKTtcblxuICAgICAgICB9XG4gICAgfVxufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL21vZGVsL1RyYW5nVGhhaS5qYXZhXG5wYWNrYWdlIG1vZGVsO1xuXG5wdWJsaWMgZW51bSBUcmFuZ1RoYWkge1xuICAgIERBX0tIT0lfSEFOSChcIsSQw6Mga2jhu59pIGjDoG5oXCIpLFxuICAgIENIVUFfS0hPSV9IQU5IKFwiQ2jGsGEga2jhu59pIGjDoG5oXCIpLFxuICAgIERBX0hVWShcIsSQw6MgaOG7p3lcIiksXG4gICAgSE9BVF9ET05HKFwiSG/huqF0IMSR4buZbmdcIik7XG5cbiAgICBwcml2YXRlIGZpbmFsIFN0cmluZyB2YWx1ZTtcblxuICAgIFRyYW5nVGhhaShTdHJpbmcgdmFsdWUpIHtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgIH1cblxuICAgIHB1YmxpYyBTdHJpbmcgZ2V0VmFsdWUoKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIFRyYW5nVGhhaSBmcm9tVmFsdWUoU3RyaW5nIHZhbHVlKSB7XG4gICAgICAgIGZvciAoVHJhbmdUaGFpIHN0YXR1cyA6IFRyYW5nVGhhaS52YWx1ZXMoKSkge1xuICAgICAgICAgICAgaWYgKHN0YXR1cy52YWx1ZS5lcXVhbHModmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0YXR1cztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKFwiTm8gZW51bSBjb25zdGFudCBmb3IgdmFsdWU6IFwiICsgdmFsdWUpO1xuICAgIH1cbn0uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvbW9kZWwvVHJhbmdUaGFpVmVUYXUuamF2YVxucGFja2FnZSBtb2RlbDtcblxucHVibGljIGVudW0gVHJhbmdUaGFpVmVUYXUge1xuICAgIENIT19YQUNfTkhBTihcIkNo4budIHjDoWMgbmjhuq1uXCIpLFxuICAgIERBX1RIQU5IX1RPQU4oXCLEkMOjIHRoYW5oIHRvw6FuXCIpLFxuICAgIERBX0RPSShcIsSQw6MgxJHhu5VpXCIpLFxuICAgIERBX1RSQShcIsSQw6MgdHLhuqNcIik7XG5cbiAgICBwcml2YXRlIGZpbmFsIFN0cmluZyB2YWx1ZTtcblxuICAgIFRyYW5nVGhhaVZlVGF1KFN0cmluZyB2YWx1ZSkge1xuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgfVxuXG4gICAgcHVibGljIFN0cmluZyBnZXRWYWx1ZSgpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgVHJhbmdUaGFpVmVUYXUgZnJvbVZhbHVlKFN0cmluZyB2YWx1ZSkge1xuICAgICAgICBmb3IgKFRyYW5nVGhhaVZlVGF1IHN0YXR1cyA6IFRyYW5nVGhhaVZlVGF1LnZhbHVlcygpKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzLnZhbHVlLmVxdWFscyh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RhdHVzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oXCJObyBlbnVtIGNvbnN0YW50IGZvciB2YWx1ZTogXCIgKyB2YWx1ZSk7XG4gICAgfVxufS4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9kYW8vTG9haUhvYURvbkRBTy5qYXZhXG5wYWNrYWdlIGRhbztcblxuaW1wb3J0IG1vZGVsLkxvYWlIb2FEb247XG5cbmltcG9ydCBqYXZhLnJtaS5SZW1vdGU7XG5cbnB1YmxpYyBpbnRlcmZhY2UgTG9haUhvYURvbkRBTyBleHRlbmRzIFJlbW90ZSB7XG4gICAgTG9haUhvYURvbiBmaW5kQnlJZChTdHJpbmcgaWQpIHRocm93cyBFeGNlcHRpb247XG59XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGF0YWZha2VyL0xvYWlIb2FEb25ERi5qYXZhXG4uLi5cblxuICAgIHB1YmxpYyB2b2lkIGdlbmVyYXRlQW5kU2F2ZUxvYWlIb2FEb25zKEVudGl0eU1hbmFnZXIgZW0pIHtcbiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHJhbnNhY3Rpb24gPSBlbS5nZXRUcmFuc2FjdGlvbigpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdHJhbnNhY3Rpb24uYmVnaW4oKTtcblxuICAgICAgICAgICAgLy8gVGjDqm0gMyBsb+G6oWkgaMOzYSDEkcahbjogTXVhLCDEkOG7lWksIFRy4bqjXG4gICAgICAgICAgICBlbS5wZXJzaXN0KGdlbmVyYXRlTG9haUhvYURvbihcIkxIRDAwMVwiLCBcIk11YVwiKSk7XG4gICAgICAgICAgICBlbS5wZXJzaXN0KGdlbmVyYXRlTG9haUhvYURvbihcIkxIRDAwMlwiLCBcIsSQ4buVaVwiKSk7XG4gICAgICAgICAgICBlbS5wZXJzaXN0KGdlbmVyYXRlTG9haUhvYURvbihcIkxIRDAwM1wiLCBcIlRy4bqjXCIpKTtcblxuICAgICAgICAgICAgdHJhbnNhY3Rpb24uY29tbWl0KCk7XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJUaMOqbSBk4buvIGxp4buHdSBt4bqrdSBjaG8gTG9haUhvYURvbiB0aMOgbmggY8O0bmchXCIpO1xuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgdHJhbnNhY3Rpb24ucm9sbGJhY2soKTtcbiAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCJM4buXaSBraGkgdGjDqm0gZOG7ryBsaeG7h3UgbeG6q3UgY2hvIExvYWlIb2FEb24hXCIpO1xuICAgICAgICB9XG4gICAgfVxufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2Rhby9pbXBsL0xpY2hUcmluaFRhdURBT0ltcGwuamF2YVxuLi4uXG5cbiAgICBAT3ZlcnJpZGVcbiAgICBwdWJsaWMgTGlzdDxUcmFuZ1RoYWk+IGdldFRyYW5nVGhhaSgpIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xuICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gSlBBVXRpbC5nZXRFbnRpdHlNYW5hZ2VyKCk7XG4gICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHR4ID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcbiAgICAgICAgTGlzdDxUcmFuZ1RoYWk+IHRyYW5nVGhhaUxpc3QgPSBuZXcgQXJyYXlMaXN0PD4oKTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdHguYmVnaW4oKTtcblxuICAgICAgICAgICAgLy8gU+G7rSBk4bulbmcgbmF0aXZlIHF1ZXJ5IMSR4buDIGzhuqV5IGPDoWMgZ2nDoSB0cuG7iyBjaHXhu5dpIHThu6sgREJcbiAgICAgICAgICAgIFF1ZXJ5IHF1ZXJ5ID0gZW0uY3JlYXRlTmF0aXZlUXVlcnkoXCJTRUxFQ1QgRElTVElOQ1QgdHJhbmdfdGhhaSBGUk9NIGxpY2h0cmluaHRhdSBPUkRFUiBCWSB0cmFuZ190aGFpXCIpO1xuICAgICAgICAgICAgTGlzdDxTdHJpbmc+IHJlc3VsdCA9IHF1ZXJ5LmdldFJlc3VsdExpc3QoKTtcblxuICAgICAgICAgICAgLy8gVGjDqm0gY8OhYyBnacOhIHRy4buLIG3hurdjIMSR4buLbmhcbiAgICAgICAgICAgIHRyYW5nVGhhaUxpc3QuYWRkKFRyYW5nVGhhaS5EQV9LSE9JX0hBTkgpO1xuICAgICAgICAgICAgdHJhbmdUaGFpTGlzdC5hZGQoVHJhbmdUaGFpLkNIVUFfS0hPSV9IQU5IKTtcbiAgICAgICAgICAgIHRyYW5nVGhhaUxpc3QuYWRkKFRyYW5nVGhhaS5EQV9IVVkpO1xuICAgICAgICAgICAgdHJhbmdUaGFpTGlzdC5hZGQoVHJhbmdUaGFpLkhPQVRfRE9ORyk7IC8vIFRow6ptIGdpw6EgdHLhu4sgbsOgeVxuLi4uXG4gICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCJM4buXaSBraGkgbOG6pXkgZGFuaCBzw6FjaCB0cuG6oW5nIHRow6FpOiBcIiArIGUuZ2V0TWVzc2FnZSgpKTtcbiAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG5cbiAgICAgICAgICAgIC8vIMSQ4bqjbSBi4bqjbyBsdcO0biB0cuG6oyB24buBIMOtdCBuaOG6pXQgbeG7mXQgc+G7kSB0cuG6oW5nIHRow6FpIGPGoSBi4bqjblxuICAgICAgICAgICAgdHJhbmdUaGFpTGlzdC5jbGVhcigpO1xuICAgICAgICAgICAgdHJhbmdUaGFpTGlzdC5hZGQoVHJhbmdUaGFpLkRBX0tIT0lfSEFOSCk7XG4gICAgICAgICAgICB0cmFuZ1RoYWlMaXN0LmFkZChUcmFuZ1RoYWkuQ0hVQV9LSE9JX0hBTkgpO1xuICAgICAgICAgICAgdHJhbmdUaGFpTGlzdC5hZGQoVHJhbmdUaGFpLkRBX0hVWSk7XG4gICAgICAgICAgICB0cmFuZ1RoYWlMaXN0LmFkZChUcmFuZ1RoYWkuSE9BVF9ET05HKTtcbiAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgIGlmIChlbSAhPSBudWxsICYmIGVtLmlzT3BlbigpKSB7XG4gICAgICAgICAgICAgICAgZW0uY2xvc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0cmFuZ1RoYWlMaXN0O1xuICAgIH1cbiAgICBAT3ZlcnJpZGVcbiAgICBwdWJsaWMgTGlzdDxMaWNoVHJpbmhUYXU+IGdldExpc3RMaWNoVHJpbmhUYXVCeURhdGVSYW5nZShMb2NhbERhdGUgc3RhcnREYXRlLCBMb2NhbERhdGUgZW5kRGF0ZSkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcbiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHggPSBlbS5nZXRUcmFuc2FjdGlvbigpO1xuICAgICAgICBMaXN0PExpY2hUcmluaFRhdT4gcmVzdWx0ID0gbmV3IEFycmF5TGlzdDw+KCk7XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGFvL1R1eWVuVGF1REFPLmphdmFcbnBhY2thZ2UgZGFvO1xuXG5pbXBvcnQgbW9kZWwuVHV5ZW5UYXU7XG5cbmltcG9ydCBqYXZhLnJtaS5SZW1vdGU7XG5pbXBvcnQgamF2YS5ybWkuUmVtb3RlRXhjZXB0aW9uO1xuaW1wb3J0IGphdmEudXRpbC5MaXN0O1xuXG5wdWJsaWMgaW50ZXJmYWNlIFR1eWVuVGF1REFPIGV4dGVuZHMgUmVtb3RlIHtcbiAgICBMaXN0PFR1eWVuVGF1PiBnZXRMaXN0VHV5ZW5UYXVCeUdhRGlHYURlbihTdHJpbmcgZ2FEaSwgU3RyaW5nIGdhRGVuKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuICAgIExpc3Q8VHV5ZW5UYXU+IGdldExpc3RUdXllblRhdSgpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG4gICAgVHV5ZW5UYXUgZ2V0VHV5ZW5UYXVCeUlkKFN0cmluZyBpZCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcbiAgICBib29sZWFuIHNhdmUoVHV5ZW5UYXUgdHV5ZW5UYXUpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG4gICAgYm9vbGVhbiBkZWxldGUoU3RyaW5nIGlkKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuICAgIGJvb2xlYW4gdXBkYXRlKFR1eWVuVGF1IHR1eWVuVGF1KSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2RhdGFmYWtlci9UdXllblRhdURGLmphdmFcbi4uLlxuXG4gICAgICAgICAgICAvLyBU4bqhbyAxMCBk4buvIGxp4buHdSBt4bqrdSBjaG8gVHV5ZW5UYXVcbiAgICAgICAgICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IDEwOyBpKyspIHtcbiAgICAgICAgICAgICAgICBUdXllblRhdSB0dXllblRhdSA9IG5ldyBUdXllblRhdSgpO1xuICAgICAgICAgICAgICAgIHR1eWVuVGF1LnNldE1hVHV5ZW4oXCJUVFwiICsgaSk7IC8vIE3DoyB0dXnhur9uIMSR4buLbmggZOG6oW5nIFRUMSwgVFQyLCAuLi5cbiAgICAgICAgICAgICAgICB0dXllblRhdS5zZXRUZW5UdXllbihcIlR1eeG6v24gXCIgKyBmYWtlci5hZGRyZXNzKCkuY2l0eU5hbWUoKSArIFwiIC0gXCIgKyBmYWtlci5hZGRyZXNzKCkuY2l0eU5hbWUoKSk7IC8vIFTDqm4gdHV54bq/biB24bubaSB0aMOgbmggcGjhu5Egbmfhuqt1IG5oacOqblxuICAgICAgICAgICAgICAgIHR1eWVuVGF1LnNldEdhRGkoZmFrZXIuYWRkcmVzcygpLnN0cmVldE5hbWUoKSk7IC8vIEdhIMSRaSBuZ+G6q3Ugbmhpw6puXG4gICAgICAgICAgICAgICAgdHV5ZW5UYXUuc2V0R2FEZW4oZmFrZXIuYWRkcmVzcygpLnN0cmVldE5hbWUoKSk7IC8vIEdhIMSR4bq/biBuZ+G6q3Ugbmhpw6puXG4gICAgICAgICAgICAgICAgdHV5ZW5UYXUuc2V0RGlhRGllbURpKGZha2VyLmFkZHJlc3MoKS5jaXR5TmFtZSgpICsgXCIsIFwiICsgZmFrZXIuYWRkcmVzcygpLmNvdW50cnkoKSk7IC8vIMSQ4buLYSDEkWnhu4NtIMSRaSAodGjDoG5oIHBo4buRLCBxdeG7kWMgZ2lhKVxuICAgICAgICAgICAgICAgIHR1eWVuVGF1LnNldERpYURpZW1EZW4oZmFrZXIuYWRkcmVzcygpLmNpdHlOYW1lKCkgKyBcIiwgXCIgKyBmYWtlci5hZGRyZXNzKCkuY291bnRyeSgpKTsgLy8gxJDhu4thIMSRaeG7g20gxJHhur9uICh0aMOgbmggcGjhu5EsIHF14buRYyBnaWEpXG5cbiAgICAgICAgICAgICAgICAvLyBMxrB1IMSR4buRaSB0xrDhu6NuZyBUdXllblRhdSB2w6BvIGPGoSBz4bufIGThu68gbGnhu4d1XG4gICAgICAgICAgICAgICAgZW0ucGVyc2lzdCh0dXllblRhdSk7XG4gICAgICAgICAgICB9XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGFvL0RvaVZlREFPLmphdmFcbi4uLlxuXG5wdWJsaWMgaW50ZXJmYWNlIERvaVZlREFPIGV4dGVuZHMgUmVtb3RlIHtcbiAgICBWZVRhdSBnZXRWZVRhdShTdHJpbmcgaWQpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG4gICAgYm9vbGVhbiBkb2lWZShWZVRhdSB2ZVRhdSkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcbiAgICBMaXN0PFZlVGF1PiBnZXRWZVRhdUJ5VHJhbmdUaGFpKFRyYW5nVGhhaVZlVGF1IHRyYW5nVGhhaSkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcbiAgICBib29sZWFuIHRlc3RDb25uZWN0aW9uKCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcbiAgICBMaXN0PFRyYW5nVGhhaVZlVGF1PiBnZXRBbGxUcmFuZ1RoYWlWZSgpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG5cbiAgICAvLyBUaMOqbSBjaOG7qWMgbsSDbmcgbeG7m2lcbiAgICBib29sZWFuIGRhdFZlKFZlVGF1IHZlVGF1LCBTdHJpbmcgY2hvTmdvaUlkKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuICAgIGJvb2xlYW4gaHV5VmUoU3RyaW5nIG1hVmUpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG4gICAgYm9vbGVhbiB0aGFuaFRvYW5WZShTdHJpbmcgbWFWZSkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcbiAgICBib29sZWFuIGNhcE5oYXRUcmFuZ1RoYWlWZShTdHJpbmcgbWFWZSwgVHJhbmdUaGFpVmVUYXUgdHJhbmdUaGFpKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuICAgIEtoYWNoSGFuZyBnZXRLaGFjaEhhbmdCeU1hVmUoU3RyaW5nIG1hVmUpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG59Li4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2RhdGFmYWtlci9Mb2FpVG9hREYuamF2YVxuLi4uXG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRyYW5zYWN0aW9uLmJlZ2luKCk7XG5cbiAgICAgICAgICAgIC8vIFThuqFvIDEwIGThu68gbGnhu4d1IG3huqt1IGNobyBMb2FpVG9hXG4gICAgICAgICAgICBmb3IgKGludCBpID0gMTsgaSA8PSAxMDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgTG9haVRvYSBsb2FpVG9hID0gbmV3IExvYWlUb2EoKTtcbiAgICAgICAgICAgICAgICBsb2FpVG9hLnNldE1hTG9haShcIkxUXCIgKyBpKTsgLy8gxJDhurd0IG3DoyBsb+G6oWkgxJHhu4tuaCBk4bqhbmcgTFQxLCBMVDIsIC4uLlxuICAgICAgICAgICAgICAgIGxvYWlUb2Euc2V0VGVuTG9haShcIkxv4bqhaSB0b2EgXCIgKyBmYWtlci5jb21tZXJjZSgpLnByb2R1Y3ROYW1lKCkpOyAvLyBUw6puIGxv4bqhaSB24bubaSBtw7QgdOG6oyB04burIEZha2VyXG4gICAgICAgICAgICAgICAgLy8gTMawdSB2w6BvIGPGoSBz4bufIGThu68gbGnhu4d1XG4gICAgICAgICAgICAgICAgZW0ucGVyc2lzdChsb2FpVG9hKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdHJhbnNhY3Rpb24uY29tbWl0KCk7XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJE4buvIGxp4buHdSBt4bqrdSBjaG8gTG9haVRvYSDEkcOjIMSRxrDhu6NjIHThuqFvIHRow6BuaCBjw7RuZy5cIik7XG4gICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICBpZiAodHJhbnNhY3Rpb24uaXNBY3RpdmUoKSkge1xuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uLnJvbGxiYWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFwixJDDoyB44bqjeSByYSBs4buXaSBraGkgdOG6oW8gZOG7ryBsaeG7h3UgbeG6q3UgY2hvIExvYWlUb2EuXCIpO1xuICAgICAgICB9XG4gICAgfVxufVxuLi4uXG5QYXRoOi4uLiIsImlzRXJyb3IiOmZhbHNlLCJyZXF1ZXN0SWQiOiIifX0sIjI1NTI2N2M2LTI3MzAtNGQzYS05NDQ3LWZmOWQzYjJmZGIyMzt0b29sdV8wMUJqYVJFcnVYSjdRTFRTMkpQUnQ4alkiOnsicGhhc2UiOjUsInJlc3VsdCI6eyJ0ZXh0IjoiVGhlIGZvbGxvd2luZyBjb2RlIHNlY3Rpb25zIHdlcmUgcmV0cmlldmVkOlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9kYW8vaW1wbC9LaHV5ZW5NYWlEQU9JbXBsLmphdmFcbi4uLlxuXG5AQWxsQXJnc0NvbnN0cnVjdG9yXG5wdWJsaWMgY2xhc3MgS2h1eWVuTWFpREFPSW1wbCB7XG5cbiAgICBwcml2YXRlIEVudGl0eU1hbmFnZXIgZW07XG4gICAgcHVibGljIEtodXllbk1haURBT0ltcGwoKSB7XG4gICAgICAgIHRoaXMuZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTs7XG4gICAgfVxuICAgIC8vIEzhuqV5IGRhbmggc8OhY2ggdOG6pXQgY+G6oyBjw6FjIGtodXnhur9uIG3Do2lcbiAgICBwdWJsaWMgTGlzdDxLaHV5ZW5NYWk+IGZpbmRBbGwoKSB7XG4gICAgICAgIFN0cmluZyBxdWVyeSA9IFwic2VsZWN0IGttIGZyb20gS2h1eWVuTWFpIGttXCI7XG4gICAgICAgIHJldHVybiBlbS5jcmVhdGVRdWVyeShxdWVyeSwgS2h1eWVuTWFpLmNsYXNzKS5nZXRSZXN1bHRMaXN0KCk7XG4gICAgfVxuXG4gICAgLy8gTOG6pXkgZGFuaCBzw6FjaCBraHV54bq/biBtw6NpIHRoZW8gdMOqblxuICAgIHB1YmxpYyBMaXN0PEtodXllbk1haT4gZmluZEJ5TmFtZShTdHJpbmcgbmFtZSkge1xuICAgICAgICBTdHJpbmcgcXVlcnkgPSBcInNlbGVjdCBrbSBmcm9tIEtodXllbk1haSBrbSB3aGVyZSBrbS50ZW5LTSBsaWtlIDpuYW1lXCI7XG4gICAgICAgIHJldHVybiBlbS5jcmVhdGVRdWVyeShxdWVyeSwgS2h1eWVuTWFpLmNsYXNzKVxuICAgICAgICAgICAgICAgIC5zZXRQYXJhbWV0ZXIoXCJuYW1lXCIsIFwiJVwiICsgbmFtZSArIFwiJVwiKVxuICAgICAgICAgICAgICAgIC5nZXRSZXN1bHRMaXN0KCk7XG4gICAgfVxuXG4gICAgLy8gTOG6pXkga2h1eeG6v24gbcOjaSB0aGVvIG3Do1xuICAgIHB1YmxpYyBLaHV5ZW5NYWkgZmluZEJ5SWQoU3RyaW5nIGlkKSB7XG4gICAgICAgIHJldHVybiBlbS5maW5kKEtodXllbk1haS5jbGFzcywgaWQpO1xuICAgIH1cblxuICAgIC8vIFRow6ptIGhv4bq3YyBj4bqtcCBuaOG6rXQga2h1eeG6v24gbcOjaVxuICAgIHB1YmxpYyBib29sZWFuIHNhdmUoS2h1eWVuTWFpIGtodXllbk1haSkge1xuICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0ciA9IGVtLmdldFRyYW5zYWN0aW9uKCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0ci5iZWdpbigpO1xuICAgICAgICAgICAgaWYgKGVtLmZpbmQoS2h1eWVuTWFpLmNsYXNzLCBraHV5ZW5NYWkuZ2V0TWFLTSgpKSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgZW0ucGVyc2lzdChraHV5ZW5NYWkpOyAvLyBUaMOqbSBt4bubaVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBlbS5tZXJnZShraHV5ZW5NYWkpOyAvLyBD4bqtcCBuaOG6rXRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRyLmNvbW1pdCgpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBleCkge1xuICAgICAgICAgICAgZXgucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgICAgICB0ci5yb2xsYmFjaygpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBYw7NhIGtodXnhur9uIG3Do2kgdGhlbyBtw6NcbiAgICBwdWJsaWMgYm9vbGVhbiBkZWxldGUoU3RyaW5nIGlkKSB7XG4gICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRyLmJlZ2luKCk7XG4gICAgICAgICAgICBLaHV5ZW5NYWkga20gPSBlbS5maW5kKEtodXllbk1haS5jbGFzcywgaWQpO1xuICAgICAgICAgICAgaWYgKGttICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBlbS5yZW1vdmUoa20pO1xuICAgICAgICAgICAgICAgIHRyLmNvbW1pdCgpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZXgpIHtcbiAgICAgICAgICAgIGV4LnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgdHIucm9sbGJhY2soKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIC8vIFTDrG0gY8OhYyBraHV54bq/biBtw6NpIMSRYW5nIMOhcCBk4bulbmdcbiAgICBwdWJsaWMgTGlzdDxLaHV5ZW5NYWk+IGZpbmRPbmdvaW5nUHJvbW90aW9ucygpIHtcbiAgICAgICAgU3RyaW5nIHF1ZXJ5ID0gXCJzZWxlY3Qga20gZnJvbSBLaHV5ZW5NYWkga20gXCIgK1xuICAgICAgICAgICAgICAgIFwid2hlcmUga20udHJhbmdUaGFpID0gOnRyYW5nVGhhaSBcIiArXG4gICAgICAgICAgICAgICAgXCJhbmQga20udGhvaUdpYW5CYXREYXUgPD0gOnRvZGF5IFwiICtcbiAgICAgICAgICAgICAgICBcImFuZCBrbS50aG9pR2lhbktldFRodWMgPj0gOnRvZGF5XCI7XG5cbiAgICAgICAgcmV0dXJuIGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5LCBLaHV5ZW5NYWkuY2xhc3MpXG4gICAgICAgICAgICAgICAgLnNldFBhcmFtZXRlcihcInRyYW5nVGhhaVwiLCBcIsSQYW5nIGRp4buFbiByYVwiKVxuICAgICAgICAgICAgICAgIC5zZXRQYXJhbWV0ZXIoXCJ0b2RheVwiLCBMb2NhbERhdGUubm93KCkpXG4gICAgICAgICAgICAgICAgLmdldFJlc3VsdExpc3QoKTtcbiAgICB9XG5cbn1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS90ZXN0Q1JVRC9LaHV5ZW5NYWlEQU9UZXN0LmphdmFcbnBhY2thZ2UgdGVzdENSVUQ7XG5cbmltcG9ydCBkYW8uaW1wbC5LaHV5ZW5NYWlEQU9JbXBsO1xuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuRW50aXR5TWFuYWdlcjtcbmltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXJGYWN0b3J5O1xuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuUGVyc2lzdGVuY2U7XG5pbXBvcnQgbW9kZWwuS2h1eWVuTWFpO1xuXG5pbXBvcnQgamF2YS50aW1lLkxvY2FsRGF0ZTtcbmltcG9ydCBqYXZhLnV0aWwuTGlzdDtcblxucHVibGljIGNsYXNzIEtodXllbk1haURBT1Rlc3Qge1xuXG4gICAgcHVibGljIHN0YXRpYyB2b2lkIG1haW4oU3RyaW5nW10gYXJncykge1xuICAgICAgICAvLyBU4bqhbyBFbnRpdHlNYW5hZ2VyRmFjdG9yeSB2w6AgRW50aXR5TWFuYWdlclxuICAgICAgICBFbnRpdHlNYW5hZ2VyRmFjdG9yeSBlbWYgPSBQZXJzaXN0ZW5jZS5jcmVhdGVFbnRpdHlNYW5hZ2VyRmFjdG9yeShcIm1hcmlhZGJcIik7XG4gICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpO1xuXG4gICAgICAgIC8vIFThuqFvIGluc3RhbmNlIGPhu6dhIEtodXllbk1haURBT1xuICAgICAgICBLaHV5ZW5NYWlEQU9JbXBsIGtodXllbk1haURBT0ltcGwgPSBuZXcgS2h1eWVuTWFpREFPSW1wbChlbSk7XG4uLi5cblxuICAgICAgICAvLyAyLiBM4bqleSBkYW5oIHPDoWNoIHThuqV0IGPhuqMgY8OhYyBraHV54bq/biBtw6NpXG4gICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIlxcbj09PSBEYW5oIHPDoWNoIHThuqV0IGPhuqMgY8OhYyBraHV54bq/biBtw6NpID09PVwiKTtcbiAgICAgICAgTGlzdDxLaHV5ZW5NYWk+IGFsbFByb21vdGlvbnMgPSBraHV5ZW5NYWlEQU9JbXBsLmZpbmRBbGwoKTtcbiAgICAgICAgYWxsUHJvbW90aW9ucy5mb3JFYWNoKFN5c3RlbS5vdXQ6OnByaW50bG4pO1xuXG4gICAgICAgIC8vIDMuIFTDrG0ga2h1eeG6v24gbcOjaSB0aGVvIHTDqm5cbiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiXFxuPT09IFTDrG0ga2h1eeG6v24gbcOjaSB0aGVvIHTDqm4gPT09XCIpO1xuICAgICAgICBMaXN0PEtodXllbk1haT4gcHJvbW90aW9uc0J5TmFtZSA9IGtodXllbk1haURBT0ltcGwuZmluZEJ5TmFtZShcIlThur90XCIpO1xuICAgICAgICBwcm9tb3Rpb25zQnlOYW1lLmZvckVhY2goU3lzdGVtLm91dDo6cHJpbnRsbik7XG5cbiAgICAgICAgLy8gNC4gVMOsbSBraHV54bq/biBtw6NpIHRoZW8gbcOjXG4gICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIlxcbj09PSBUw6xtIGtodXnhur9uIG3Do2kgdGhlbyBtw6MgPT09XCIpO1xuICAgICAgICBLaHV5ZW5NYWkgZm91bmRQcm9tb3Rpb24gPSBraHV5ZW5NYWlEQU9JbXBsLmZpbmRCeUlkKFwiS00wMDFcIik7XG4gICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIkvhur90IHF14bqjOiBcIiArIChmb3VuZFByb21vdGlvbiAhPSBudWxsID8gZm91bmRQcm9tb3Rpb24gOiBcIktow7RuZyB0w6xtIHRo4bqleVwiKSk7XG5cbiAgICAgICAgLy8gNS4gVMOsbSBjw6FjIGtodXnhur9uIG3Do2kgxJFhbmcgw6FwIGThu6VuZ1xuICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJcXG49PT0gVMOsbSBjw6FjIGtodXnhur9uIG3Do2kgxJFhbmcgw6FwIGThu6VuZyA9PT1cIik7XG4gICAgICAgIExpc3Q8S2h1eWVuTWFpPiBvbmdvaW5nUHJvbW90aW9ucyA9IGtodXllbk1haURBT0ltcGwuZmluZE9uZ29pbmdQcm9tb3Rpb25zKCk7XG4gICAgICAgIG9uZ29pbmdQcm9tb3Rpb25zLmZvckVhY2goU3lzdGVtLm91dDo6cHJpbnRsbik7XG5cbiAgICAgICAgLy8gNi4gWMOzYSBraHV54bq/biBtw6NpIHRoZW8gbcOjXG4gICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIlxcbj09PSBYw7NhIGtodXnhur9uIG3Do2kgdGhlbyBtw6MgPT09XCIpO1xuICAgICAgICBib29sZWFuIGlzRGVsZXRlZCA9IGtodXllbk1haURBT0ltcGwuZGVsZXRlKFwiS00wMDAwMDFcIik7XG4gICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIljDs2Ega2h1eeG6v24gbcOjaTogXCIgKyAoaXNEZWxldGVkID8gXCJUaMOgbmggY8O0bmdcIiA6IFwiVGjhuqV0IGLhuqFpXCIpKTtcblxuICAgICAgICAvLyDEkMOzbmcgRW50aXR5TWFuYWdlciB2w6AgRW50aXR5TWFuYWdlckZhY3RvcnlcbiAgICAgICAgZW0uY2xvc2UoKTtcbiAgICAgICAgZW1mLmNsb3NlKCk7XG4gICAgfVxufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9Eb2lWZVBhbmVsLmphdmFcbi4uLlxuXG4gICAgICAgICAgICBSZWdpc3RyeSByZWdpc3RyeSA9IExvY2F0ZVJlZ2lzdHJ5LmdldFJlZ2lzdHJ5KFJNSV9TRVJWRVJfSVAsIFJNSV9TRVJWRVJfUE9SVCk7XG4gICAgICAgICAgICBkb2lWZURBTyA9IChEb2lWZURBTykgcmVnaXN0cnkubG9va3VwKFwiZG9pVmVEQU9cIik7XG4gICAgICAgICAgICBsaWNoVHJpbmhUYXVEQU8gPSAoTGljaFRyaW5oVGF1REFPKSByZWdpc3RyeS5sb29rdXAoXCJsaWNoVHJpbmhUYXVEQU9cIik7XG4vLyAgICAgICAgICAgIGtodXllbk1haURBTyA9IChLaHV5ZW5NYWlEQU8pIHJlZ2lzdHJ5Lmxvb2t1cChcImtodXllbk1haURBT1wiKTtcbiAgICAgICAgICAgIHRvYVRhdURBTyA9IChUb2FUYXVEb2lWZURBTykgcmVnaXN0cnkubG9va3VwKFwidG9hVGF1RG9pVmVEQU9cIik7XG4gICAgICAgICAgICBjaG9OZ29pREFPID0gKENob05nb2lEb2lWZURBTykgcmVnaXN0cnkubG9va3VwKFwiY2hvTmdvaURvaVZlREFPXCIpO1xuICAgICAgICAgICAgbG9haUhvYURvbkRBTyA9IChMb2FpSG9hRG9uREFPKSByZWdpc3RyeS5sb29rdXAoXCJsb2FpSG9hRG9uREFPXCIpO1xuICAgICAgICAgICAgaG9hRG9uREFPID0gKEhvYURvbkRBTykgcmVnaXN0cnkubG9va3VwKFwiaG9hRG9uREFPXCIpO1xuICAgICAgICAgICAgY2hpVGlldEhvYURvbkRBTyA9IChDaGlUaWV0SG9hRG9uREFPKSByZWdpc3RyeS5sb29rdXAoXCJjaGlUaWV0SG9hRG9uREFPXCIpO1xuICAgICAgICAgICAgLy8gS2nhu4NtIHRyYSBr4bq/dCBu4buRaVxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpZiAoZG9pVmVEQU8udGVzdENvbm5lY3Rpb24oKSkge1xuICAgICAgICAgICAgICAgICAgICBTd2luZ1V0aWxpdGllcy5pbnZva2VMYXRlcigoKSAtPiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVTdGF0dXMoUkVBRFlfVEVYVCwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRQcmVsb2FkaW5nRGF0YSgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9ndWlDbGllbnQvUXVhbkx5S2hhY2hIYW5nUGFuZWwuamF2YVxucGFja2FnZSBndWlDbGllbnQ7XG5cbmltcG9ydCBkYW8uKjtcbmltcG9ydCBkYW8uaW1wbC5LaGFjaEhhbmdEQU9JbXBsO1xuaW1wb3J0IGRhby5pbXBsLkxvYWlLaGFjaEhhbmdEQU9JbXBsO1xuaW1wb3J0IGRhby5pbXBsLlZlVGF1REFPSW1wbDtcbmltcG9ydCBndWlDbGllbnQuZm9ybWF0LkRhdGVMYWJlbEZvcm1hdHRlcjtcbmltcG9ydCBtb2RlbC4qO1xuaW1wb3J0IG9yZy5qZGF0ZXBpY2tlci5pbXBsLkpEYXRlUGFuZWxJbXBsO1xuaW1wb3J0IG9yZy5qZGF0ZXBpY2tlci5pbXBsLkpEYXRlUGlja2VySW1wbDtcbmltcG9ydCBvcmcuamRhdGVwaWNrZXIuaW1wbC5VdGlsRGF0ZU1vZGVsO1xuaW1wb3J0IHNlcnZpY2UuQUlUcmF2ZWxUaW1lUHJlZGljdG9yO1xuLi4uXG5cbnB1YmxpYyBjbGFzcyBRdWFuTHlLaGFjaEhhbmdQYW5lbCBleHRlbmRzIEpQYW5lbCB7XG4gICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9nZ2VyIExPR0dFUiA9IExvZ2dlci5nZXRMb2dnZXIoUXVhbkx5S2hhY2hIYW5nUGFuZWwuY2xhc3MuZ2V0TmFtZSgpKTtcbiAgICBwcml2YXRlIGZpbmFsIEpCdXR0b24gZGVsZXRlQnV0dG9uLCB1cGRhdGVCdXR0b247XG4gICAgcHJpdmF0ZSBmaW5hbCBKQnV0dG9uIGFkZEJ1dHRvbjtcbiAgICBwcml2YXRlIEFJVHJhdmVsVGltZVByZWRpY3RvciBhaVByZWRpY3RvcjtcbiAgICBwcml2YXRlIEpUYWJsZSBjdXN0b21lclRhYmxlLCBpbnZvaWNlVGFibGUsIHRpY2tldFRhYmxlO1xuICAgIHByaXZhdGUgRGVmYXVsdFRhYmxlTW9kZWwgY3VzdG9tZXJUYWJsZU1vZGVsLCBpbnZvaWNlVGFibGVNb2RlbCwgdGlja2V0VGFibGVNb2RlbDtcbiAgICBwcml2YXRlIEpUZXh0RmllbGQgc2VhcmNoRmllbGQ7XG4gICAgcHJpdmF0ZSBKQ29tYm9Cb3g8U3RyaW5nPiBjdXN0b21lclR5cGVGaWx0ZXI7XG4gICAgcHJpdmF0ZSBKQnV0dG9uIHNlYXJjaEJ1dHRvbiwgcmVzZXRGaWx0ZXJCdXR0b247XG4gICAgcHJpdmF0ZSBMaXN0PEtoYWNoSGFuZz4gY3VzdG9tZXJMaXN0O1xuICAgIHByaXZhdGUgTGlzdDxMb2FpS2hhY2hIYW5nPiBjdXN0b21lclR5cGVMaXN0O1xuICAgIHByaXZhdGUgTG9haUtoYWNoSGFuZ0RBTyBsb2FpS2hhY2hIYW5nREFPO1xuICAgIHByaXZhdGUgVmVUYXVEQU8gdmVUYXVEQU87XG4gICAgcHJpdmF0ZSBLaGFjaEhhbmdEQU8ga2hhY2hIYW5nREFPO1xuICAgIHByaXZhdGUgTGlzdDxIb2FEb24+IGludm9pY2VMaXN0O1xuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9UcmFWZVBhbmVsLmphdmFcbnBhY2thZ2UgZ3VpQ2xpZW50O1xuXG4vKipcbiAqIEBE4buxIMOhbjogUGhhblRhbkphdmFOaG9tR1BUXG4gKiBAQ2xhc3M6IFRyYVZlUGFuZWxcbiAqIEBU4bqhbyB2w6BvIG5nw6B5OiAxOS8wNC8yMDI1XG4gKiBAVMOhYyBnaeG6ozogTmd1eWVuIEh1dSBTYW5nXG4gKi9cblxuaW1wb3J0IGRhby5DaGlUaWV0SG9hRG9uREFPO1xuaW1wb3J0IGRhby5Ib2FEb25EQU87XG5pbXBvcnQgZGFvLkxpY2hUcmluaFRhdURBTztcbmltcG9ydCBkYW8uVmVUYXVEQU87XG5pbXBvcnQgZGFvLmltcGwuTGljaExhbVZpZWNEQU9JbXBsO1xuaW1wb3J0IGRhby5pbXBsLkxpY2hUcmluaFRhdURBT0ltcGw7XG5pbXBvcnQgbW9kZWwuKjtcbi8vaW1wb3J0IHV0aWxzLlByaW50UERGO1xuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9NYWluR1VJLmphdmFcbnBhY2thZ2UgZ3VpQ2xpZW50O1xuXG5pbXBvcnQgZGFvLkRvaVZlREFPO1xuaW1wb3J0IGRhby5pbXBsLkRvaVZlREFPSW1wbDtcbmltcG9ydCBkYW8uaW1wbC5OaGFuVmllbkRBT0ltcGw7XG5pbXBvcnQgbW9kZWwuTmhhblZpZW47XG5cbmltcG9ydCBqYXZheC5zd2luZy4qO1xuaW1wb3J0IGphdmEuYXd0Lio7XG5pbXBvcnQgamF2YS5hd3QuZXZlbnQuTW91c2VBZGFwdGVyO1xuaW1wb3J0IGphdmEuYXd0LmV2ZW50Lk1vdXNlRXZlbnQ7XG5pbXBvcnQgamF2YS5hd3QuZXZlbnQuV2luZG93QWRhcHRlcjtcbmltcG9ydCBqYXZhLmF3dC5ldmVudC5XaW5kb3dFdmVudDtcbmltcG9ydCBqYXZhLmF3dC5pbWFnZS5CdWZmZXJlZEltYWdlO1xuaW1wb3J0IGphdmEucm1pLlJlbW90ZUV4Y2VwdGlvbjtcbmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlO1xuaW1wb3J0IGphdmEudXRpbC5IYXNoTWFwO1xuaW1wb3J0IGphdmEudXRpbC5NYXA7XG5cbnB1YmxpYyBjbGFzcyBNYWluR1VJIGV4dGVuZHMgSkZyYW1lIHtcblxuICAgIHByaXZhdGUgSlBhbmVsIGNvbnRlbnRQYW5lbDsgLy8gQ29udGVudCBwYW5lbCBtYW5hZ2VkIGJ5IENhcmRMYXlvdXRcbiAgICBwcml2YXRlIENhcmRMYXlvdXQgY2FyZExheW91dDsgLy8gQ2FyZExheW91dCBmb3Igc3dpdGNoaW5nIHBhbmVsc1xuICAgIHByaXZhdGUgTWFwPFN0cmluZywgSlBhbmVsPiBwYW5lbE1hcDsgLy8gQ2FjaGUgZm9yIHBhbmVsc1xuICAgIHByaXZhdGUgTGljaFRyaW5oVGF1UGFuZWwgbGljaFRyaW5oVGF1UGFuZWw7XG4gICAgcHJpdmF0ZSBOaGFuVmllbiBuaGFuVmllbjtcbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9kYW8vSG9hRG9uREFPLmphdmFcbi4uLlxuXG4vKipcbiAqIEBE4buxIMOhbjogUGhhblRhbkphdmFOaG9tR1BUXG4gKiBASW50ZXJmYWNlOiBIb2FEb25EQU9cbiAqIEBU4bqhbyB2w6BvIG5nw6B5OiAxOC8wNC8yMDI1XG4gKiBAVMOhYyBnaeG6ozogTmd1eWVuIEh1dSBTYW5nXG4gKi9cbnB1YmxpYyBpbnRlcmZhY2UgSG9hRG9uREFPIGV4dGVuZHMgUmVtb3RlIHtcbiAgICAvLyBDcmVhdGU6IFRow6ptIGjDs2EgxJHGoW4gbeG7m2lcbiAgICBib29sZWFuIHNhdmVIb2FEb24oSG9hRG9uIGhvYURvbikgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcblxuICAgIC8vIFJlYWQ6IEzhuqV5IGRhbmggc8OhY2ggaMOzYSDEkcahblxuICAgIExpc3Q8SG9hRG9uPiBnZXRBbGxIb2FEb25zKCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcblxuICAgIC8vIFJlYWQ6IFTDrG0gaMOzYSDEkcahbiB0aGVvIG3DoyBow7NhIMSRxqFuXG4gICAgSG9hRG9uIGdldEhvYURvbkJ5SWQoU3RyaW5nIG1hSEQpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG5cbiAgICAvLyBVcGRhdGU6IEPhuq1wIG5o4bqtdCB0aMO0bmcgdGluIGjDs2EgxJHGoW5cbiAgICBib29sZWFuIHVwZGF0ZUhvYURvbihIb2FEb24gaG9hRG9uKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuXG4gICAgLy8gRGVsZXRlOiBYw7NhIGjDs2EgxJHGoW4gdGhlbyBtw6MgaMOzYSDEkcahblxuICAgIGJvb2xlYW4gZGVsZXRlSG9hRG9uKFN0cmluZyBtYUhEKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuXG4gICAgLy8gUmV0cmlldmUgaW52b2ljZXMgYnkgY3VzdG9tZXIgSURcbiAgICBMaXN0PEhvYURvbj4gZ2V0QnlDdXN0b21lcklkKFN0cmluZyBjdXN0b21lcklkKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2Rhby9DaG9OZ29pRG9pVmVEQU8uamF2YVxuLi4uXG5cbnB1YmxpYyBpbnRlcmZhY2UgQ2hvTmdvaURvaVZlREFPIGV4dGVuZHMgUmVtb3RlIHtcbiAgICAvLyBM4bqleSBkYW5oIHPDoWNoIGNo4buXIG5n4buTaSB0aGVvIHRvYSB0w6B1XG4gICAgTGlzdDxDaG9OZ29pPiBnZXRDaG9OZ29pQnlUb2FUYXUoU3RyaW5nIG1hVG9hVGF1KSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuXG4gICAgLy8gS2nhu4NtIHRyYSBjaOG7lyBuZ+G7k2kgY8OzIGto4bqjIGThu6VuZyBraMO0bmcgKHRpbmhfdHJhbmcgPSB0cnVlKVxuICAgIGJvb2xlYW4ga2llbVRyYUNob05nb2lLaGFEdW5nKFN0cmluZyBtYUNobykgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcblxuICAgIC8vIEtp4buDbSB0cmEgY2jhu5cgbmfhu5NpIMSRw6MgxJHGsOG7o2MgxJHhurd0IHRyb25nIG3hu5l0IGzhu4tjaCB0csOsbmggY+G7pSB0aOG7gyBjaMawYVxuICAgIGJvb2xlYW4ga2llbVRyYUNob05nb2lEYURhdChTdHJpbmcgbWFDaG8sIFN0cmluZyBtYUxpY2hUcmluaCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcblxuICAgIC8vIEtow7NhIGNo4buXIG5n4buTaSB04bqhbSB0aOG7nWkgKGtoaSBraMOhY2ggaMOgbmcgY2jhu41uKVxuICAgIGJvb2xlYW4ga2hvYUNob05nb2koU3RyaW5nIG1hQ2hvLCBTdHJpbmcgbWFMaWNoVHJpbmgsIFN0cmluZyBzZXNzaW9uSWQsIGxvbmcgdGhvaUdpYW5LaG9hTWlsbGlzKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuXG4gICAgLy8gSOG7p3kga2jDs2EgY2jhu5cgbmfhu5NpXG4gICAgYm9vbGVhbiBodXlLaG9hQ2hvTmdvaShTdHJpbmcgbWFDaG8sIFN0cmluZyBtYUxpY2hUcmluaCwgU3RyaW5nIHNlc3Npb25JZCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9kYW8vTG9haUtoYWNoSGFuZ0RBTy5qYXZhXG5wYWNrYWdlIGRhbztcblxuaW1wb3J0IG1vZGVsLkxvYWlLaGFjaEhhbmc7XG5cbmltcG9ydCBqYXZhLnJtaS5SZW1vdGU7XG5pbXBvcnQgamF2YS5ybWkuUmVtb3RlRXhjZXB0aW9uO1xuaW1wb3J0IGphdmEudXRpbC5MaXN0O1xuXG4vKipcbiAqIEBE4buxIMOhbjogUGhhblRhbkphdmFOaG9tR1BUXG4gKiBAQ2xhc3M6IExvYWlLaGFjaEhhbmdEQU9cbiAqIEBU4bqhbyB2w6BvIG5nw6B5OiAxOC8wNC8yMDI1XG4gKiBAVMOhYyBnaeG6ozogTmd1eWVuIEh1dSBTYW5nXG4gKi9cbnB1YmxpYyBpbnRlcmZhY2UgTG9haUtoYWNoSGFuZ0RBTyBleHRlbmRzIFJlbW90ZSB7XG4gICAgTGlzdDxMb2FpS2hhY2hIYW5nPiBnZXRBbGwoKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuICAgIExvYWlLaGFjaEhhbmcgZmluZEJ5SWQoU3RyaW5nIGlkKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuICAgIGJvb2xlYW4gc2F2ZShMb2FpS2hhY2hIYW5nIGxvYWlLaGFjaEhhbmcpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG4gICAgYm9vbGVhbiB1cGRhdGUoTG9haUtoYWNoSGFuZyBsb2FpS2hhY2hIYW5nKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuICAgIGJvb2xlYW4gZGVsZXRlKFN0cmluZyBpZCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcblxuLy8gICAgIExpc3Q8TG9haUtoYWNoSGFuZz4gZ2V0QWxsTGlzdCgpO1xufS4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9tb2RlbC9LaHV5ZW5NYWkuamF2YVxucGFja2FnZSBtb2RlbDtcblxuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuKjtcbmltcG9ydCBsb21ib2suRGF0YTtcblxuaW1wb3J0IGphdmEuaW8uU2VyaWFsaXphYmxlO1xuaW1wb3J0IGphdmEudGltZS5Mb2NhbERhdGU7XG5pbXBvcnQgamF2YS51dGlsLk9iamVjdHM7XG5pbXBvcnQgamF2YS51dGlsLlNldDtcblxuQERhdGFcbkBFbnRpdHlcbkBUYWJsZShuYW1lID0gXCJraHV5ZW5tYWlcIilcbnB1YmxpYyBjbGFzcyBLaHV5ZW5NYWkgaW1wbGVtZW50cyBTZXJpYWxpemFibGUge1xuICAgIEBJZFxuICAgIEBDb2x1bW4obmFtZSA9IFwibWFfa21cIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiVkFSQ0hBUigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UsdW5pcXVlID0gdHJ1ZSlcbiAgICBwcml2YXRlIFN0cmluZyBtYUtNO1xuICAgIEBDb2x1bW4obmFtZSA9IFwidGVuX2ttXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcIk5WQVJDSEFSKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIFN0cmluZyB0ZW5LTTtcbiAgICBAQ29sdW1uKG5hbWUgPSBcInRob2lfZ2lhbl9iYXRfZGF1XCIsIGNvbHVtbkRlZmluaXRpb24gPSBcIkRBVEVcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIExvY2FsRGF0ZSB0aG9pR2lhbkJhdERhdTtcbiAgICBAQ29sdW1uKG5hbWUgPSBcInRob2lfZ2lhbl9rZXRfdGh1Y1wiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJEQVRFXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBMb2NhbERhdGUgdGhvaUdpYW5LZXRUaHVjO1xuICAgIEBDb2x1bW4obmFtZSA9IFwibm9pX2R1bmdfa21cIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiTlZBUkNIQVIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgU3RyaW5nIG5vaUR1bmdLTTtcbiAgICBAQ29sdW1uKG5hbWUgPSBcImNoaWV0X2toYXVcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiZG91YmxlXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBkb3VibGUgY2hpZXRLaGF1O1xuICAgIEBDb2x1bW4obmFtZSA9IFwiZG9pX3R1b25nX2FwX2R1bmdcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiTlZBUkNIQVIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgRG9pVHVvbmdBcER1bmcgZG9pVHVvbmdBcER1bmc7XG4gICAgQENvbHVtbihuYW1lID0gXCJ0cmFuZ190aGFpXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcIk5WQVJDSEFSKDUwKVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgU3RyaW5nIHRyYW5nVGhhaTtcblxuICAgIEBPbmVUb01hbnkobWFwcGVkQnkgPSBcImtodXllbk1haVwiKVxuICAgIHByaXZhdGUgU2V0PFZlVGF1PiB2ZV90YXVzO1xuXG5cbn1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9ndWlDbGllbnQvVGhhbmhUb2FuR1VJLmphdmFcbi4uLlxuXG4gICAgICAgIC8vIENlbnRlciAtIERpc2NvdW50IGNvZGUgZmllbGRcbiAgICAgICAgSlBhbmVsIHByb21vdGlvblBhbmVsID0gbmV3IEpQYW5lbChuZXcgQm9yZGVyTGF5b3V0KDUsIDApKTtcbiAgICAgICAgcHJvbW90aW9uRmllbGQgPSBuZXcgSlRleHRGaWVsZCgpO1xuICAgICAgICBwcm9tb3Rpb25GaWVsZC5zZXRQcmVmZXJyZWRTaXplKG5ldyBEaW1lbnNpb24oMjAwLCAzMCkpO1xuICAgICAgICBKTGFiZWwgcHJvbW9MYWJlbCA9IG5ldyBKTGFiZWwoXCJOaOG6rXAgbcOjIGdp4bqjbSBnacOhIHThuqFpIMSRw6J5XCIpO1xuICAgICAgICBwcm9tb0xhYmVsLnNldEJvcmRlcihuZXcgRW1wdHlCb3JkZXIoMCwgMCwgMCwgNSkpO1xuICAgICAgICBwcm9tb3Rpb25QYW5lbC5hZGQocHJvbW9MYWJlbCwgQm9yZGVyTGF5b3V0LldFU1QpO1xuICAgICAgICBwcm9tb3Rpb25QYW5lbC5hZGQocHJvbW90aW9uRmllbGQsIEJvcmRlckxheW91dC5DRU5URVIpO1xuXG4gICAgICAgIC8vIEFwcGx5IGJ1dHRvblxuICAgICAgICBKQnV0dG9uIGFwcGx5QnV0dG9uID0gbmV3IEpCdXR0b24oXCLDgXAgZOG7pW5nXCIpO1xuICAgICAgICBhcHBseUJ1dHRvbi5hZGRBY3Rpb25MaXN0ZW5lcihlIC0+IGFwcGx5UHJvbW90aW9uKCkpO1xuICAgICAgICBwcm9tb3Rpb25QYW5lbC5hZGQoYXBwbHlCdXR0b24sIEJvcmRlckxheW91dC5FQVNUKTtcbiAgICAgICAgYm90dG9tUGFuZWwuYWRkKHByb21vdGlvblBhbmVsLCBCb3JkZXJMYXlvdXQuQ0VOVEVSKTtcbi4uLlxuXG4gICAgLyoqXG4gICAgICogQXBwbHkgcHJvbW90aW9uIGNvZGVcbiAgICAgKi9cbiAgICBwcml2YXRlIHZvaWQgYXBwbHlQcm9tb3Rpb24oKSB7XG4gICAgICAgIFN0cmluZyBjb2RlID0gcHJvbW90aW9uRmllbGQuZ2V0VGV4dCgpLnRyaW0oKTtcbiAgICAgICAgaWYgKGNvZGUuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgXCJWdWkgbMOybmcgbmjhuq1wIG3DoyBraHV54bq/biBtw6NpXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiVGjDtG5nIGLDoW9cIixcbiAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEluIGEgcmVhbCBhcHAsIHlvdSB3b3VsZCB2YWxpZGF0ZSB0aGUgY29kZSBhZ2FpbnN0IGEgZGF0YWJhc2VcbiAgICAgICAgLy8gRm9yIG5vdywganVzdCBzaG93IGEgbWVzc2FnZVxuICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgIFwiTcOjIGtodXnhur9uIG3Do2kga2jDtG5nIGjhu6NwIGzhu4cgaG/hurdjIMSRw6MgaOG6v3QgaOG6oW5cIixcbiAgICAgICAgICAgICAgICBcIlRow7RuZyBiw6FvXCIsXG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRVxuICAgICAgICApO1xuICAgIH1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9kYW8vTG9haUhvYURvbkRBTy5qYXZhXG5wYWNrYWdlIGRhbztcblxuaW1wb3J0IG1vZGVsLkxvYWlIb2FEb247XG5cbmltcG9ydCBqYXZhLnJtaS5SZW1vdGU7XG5cbnB1YmxpYyBpbnRlcmZhY2UgTG9haUhvYURvbkRBTyBleHRlbmRzIFJlbW90ZSB7XG4gICAgTG9haUhvYURvbiBmaW5kQnlJZChTdHJpbmcgaWQpIHRocm93cyBFeGNlcHRpb247XG59XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZ3VpQ2xpZW50L1F1YW5MeU5oYW5WaWVuUGFuZWwuamF2YVxuLi4uXG5cblxuXG4gICAgQE92ZXJyaWRlXG4gICAgcHVibGljIHZvaWQgYWN0aW9uUGVyZm9ybWVkKEFjdGlvbkV2ZW50IGUpIHtcbiAgICAgICAgT2JqZWN0IG8gPSBlLmdldFNvdXJjZSgpO1xuXG4gICAgICAgIGlmIChvID09IGJ0blRoZW0pIHtcbiAgICAgICAgICAgIFN0cmluZyBtYU5WID0gZ2VuZXJhdGVNYU5WKCk7XG4gICAgICAgICAgICBMb2NhbERhdGUgbmdheVZhb0xhbSA9IExvY2FsRGF0ZS5ub3coKTtcbiAgICAgICAgICAgIHR4dE1hTlYuc2V0VGV4dChtYU5WKTtcbiAgICAgICAgICAgIHR4dFRlbk5WLnNldFRleHQoXCJcIik7XG4gICAgICAgICAgICB0eHRTb0RULnNldFRleHQoXCJcIik7XG4gICAgICAgICAgICB0eHRDQ0NELnNldFRleHQoXCJcIik7XG4gICAgICAgICAgICB0eHREaWFDaGkuc2V0VGV4dChcIlwiKTtcbiAgICAgICAgICAgIGRhdGVDaG9vc2VyTmdheVZhb0xhbS5zZXREYXRlKGphdmEuc3FsLkRhdGUudmFsdWVPZihuZ2F5VmFvTGFtKSk7XG4gICAgICAgICAgICBjbWJDaHVjVnUuc2V0U2VsZWN0ZWRJbmRleCgwKTtcbiAgICAgICAgICAgIGxibEFuaC5zZXRJY29uKG51bGwpO1xuICAgICAgICAgICAgc2V0RWRpdGFibGVGaWVsZHModHJ1ZSk7XG4gICAgICAgICAgICB0eHRNYU5WLnNldEVkaXRhYmxlKGZhbHNlKTtcbiAgICAgICAgfSBlbHNlIGlmIChvID09IGJ0bkxhbU1vaSkge1xuICAgICAgICAgICAgY2xlYXJUaG9uZ1Rpbk5oYW5WaWVuKCk7XG4gICAgICAgICAgICB0YWlMYWlEYW5oU2FjaE5oYW5WaWVuKCk7XG4gICAgICAgICAgICB0eHRNYU5WLnNldEVuYWJsZWQodHJ1ZSk7XG4gICAgICAgICAgICBzZXRFZGl0YWJsZUZpZWxkcyh0cnVlKTtcbiAgICAgICAgICAgIGlzRWRpdE1vZGUgPSBmYWxzZTtcbiAgICAgICAgfVxuLi4uXG5cbiAgICAgICAgICAgICAgICBpZiAoaXNFZGl0TW9kZSkge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gbmhhblZpZW5EQU8udXBkYXRlKG52KTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoUmVtb3RlRXhjZXB0aW9uIGV4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUnVudGltZUV4Y2VwdGlvbihleCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2codGhpcywgXCJD4bqtcCBuaOG6rXQgbmjDom4gdmnDqm4gdGjDoG5oIGPDtG5nIVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhaUxhaURhbmhTYWNoTmhhblZpZW4oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzRWRpdE1vZGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5oYW5WaWVuRGFuZ1N1YSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbGVhclRob25nVGluTmhhblZpZW4oKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKHRoaXMsIFwiQ+G6rXAgbmjhuq10IG5ow6JuIHZpw6puIHRo4bqldCBi4bqhaSFcIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gbmhhblZpZW5EQU8uc2F2ZShudik7XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKFJlbW90ZUV4Y2VwdGlvbiBleCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFeGNlcHRpb24oZXgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKHRoaXMsIFwiTMawdSBuaMOibiB2acOqbiB0aMOgbmggY8O0bmchXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGFuaFNhY2hOaGFuVmllbi5hZGQobnYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFpTGFpRGFuaFNhY2hOaGFuVmllbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJUaG9uZ1Rpbk5oYW5WaWVuKCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyh0aGlzLCBcIkzGsHUgbmjDom4gdmnDqm4ga2jDtG5nIHRow6BuaCBjw7RuZyFcIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGFvL1R1eWVuVGF1REFPLmphdmFcbnBhY2thZ2UgZGFvO1xuXG5pbXBvcnQgbW9kZWwuVHV5ZW5UYXU7XG5cbmltcG9ydCBqYXZhLnJtaS5SZW1vdGU7XG5pbXBvcnQgamF2YS5ybWkuUmVtb3RlRXhjZXB0aW9uO1xuaW1wb3J0IGphdmEudXRpbC5MaXN0O1xuXG5wdWJsaWMgaW50ZXJmYWNlIFR1eWVuVGF1REFPIGV4dGVuZHMgUmVtb3RlIHtcbiAgICBMaXN0PFR1eWVuVGF1PiBnZXRMaXN0VHV5ZW5UYXVCeUdhRGlHYURlbihTdHJpbmcgZ2FEaSwgU3RyaW5nIGdhRGVuKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuICAgIExpc3Q8VHV5ZW5UYXU+IGdldExpc3RUdXllblRhdSgpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG4gICAgVHV5ZW5UYXUgZ2V0VHV5ZW5UYXVCeUlkKFN0cmluZyBpZCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbjtcbiAgICBib29sZWFuIHNhdmUoVHV5ZW5UYXUgdHV5ZW5UYXUpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG4gICAgYm9vbGVhbiBkZWxldGUoU3RyaW5nIGlkKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuICAgIGJvb2xlYW4gdXBkYXRlKFR1eWVuVGF1IHR1eWVuVGF1KSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL21vZGVsL0xvYWlDaG8uamF2YVxucGFja2FnZSBtb2RlbDtcblxuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuKjtcbmltcG9ydCBsb21ib2suRGF0YTtcbmltcG9ydCBsb21ib2suRXF1YWxzQW5kSGFzaENvZGU7XG5pbXBvcnQgbG9tYm9rLlRvU3RyaW5nO1xuXG5pbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7XG5pbXBvcnQgamF2YS51dGlsLlNldDtcblxuQEVudGl0eVxuQERhdGFcbkBFcXVhbHNBbmRIYXNoQ29kZShvbmx5RXhwbGljaXRseUluY2x1ZGVkID0gdHJ1ZSlcbkBUYWJsZShuYW1lID0gXCJsb2FpY2hvXCIpXG5wdWJsaWMgY2xhc3MgTG9haUNobyBpbXBsZW1lbnRzIFNlcmlhbGl6YWJsZSB7XG4gICAgQElkXG4gICAgQEVxdWFsc0FuZEhhc2hDb2RlLkluY2x1ZGVcbiAgICBAQ29sdW1uKG5hbWUgPSBcIm1hX2xvYWlcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiVkFSQ0hBUigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UsdW5pcXVlID0gdHJ1ZSlcbiAgICBwcml2YXRlIFN0cmluZyBtYUxvYWk7XG4gICAgQENvbHVtbihuYW1lID0gXCJ0ZW5fbG9haVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJOVkFSQ0hBUigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBTdHJpbmcgdGVuTG9haTtcblxuXG4gICAgQE9uZVRvTWFueShtYXBwZWRCeSA9IFwibG9haUNob1wiKVxuICAgQFRvU3RyaW5nLkV4Y2x1ZGVcbiAgICBwcml2YXRlIFNldDxDaG9OZ29pPiBjaG9fbmdvaXM7XG59XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZ3VpQ2xpZW50L0xpY2hUcmluaFRhdVBhbmVsLmphdmFcbi4uLlxuXG4gICAgcHJpdmF0ZSBKUGFuZWwgY3JlYXRlVGl0bGVQYW5lbCgpIHtcbiAgICAgICAgSlBhbmVsIHBhbmVsID0gbmV3IEpQYW5lbChuZXcgQm9yZGVyTGF5b3V0KCkpO1xuXG4gICAgICAgIEpMYWJlbCB0aXRsZUxhYmVsID0gbmV3IEpMYWJlbChcIlFV4bqiTiBMw50gTOG7ikNIIFRSw4xOSCBUw4BVXCIsIEpMYWJlbC5DRU5URVIpO1xuICAgICAgICB0aXRsZUxhYmVsLnNldEZvbnQobmV3IEZvbnQoXCJBcmlhbFwiLCBGb250LkJPTEQsIDIwKSk7XG4gICAgICAgIHRpdGxlTGFiZWwuc2V0Rm9yZWdyb3VuZChuZXcgQ29sb3IoNDEsIDEyOCwgMTg1KSk7XG4gICAgICAgIHRpdGxlTGFiZWwuc2V0Qm9yZGVyKEJvcmRlckZhY3RvcnkuY3JlYXRlRW1wdHlCb3JkZXIoMCwgMCwgMTAsIDApKTtcblxuICAgICAgICBwYW5lbC5hZGQodGl0bGVMYWJlbCwgQm9yZGVyTGF5b3V0LkNFTlRFUik7XG4gICAgICAgIHJldHVybiBwYW5lbDtcbiAgICB9XG5cbiAgICBwcml2YXRlIEpQYW5lbCBjcmVhdGVDZW50ZXJQYW5lbCgpIHtcbiAgICAgICAgSlBhbmVsIHBhbmVsID0gbmV3IEpQYW5lbChuZXcgQm9yZGVyTGF5b3V0KDEwLCAxMCkpO1xuXG4gICAgICAgIHBhbmVsLmFkZChjcmVhdGVTZWFyY2hQYW5lbCgpLCBCb3JkZXJMYXlvdXQuTk9SVEgpO1xuXG4gICAgICAgIC8vIFThuqFvIFRhYmJlZFBhbmUgxJHhu4MgY2jhu6lhIGPhuqMgY2jhur8gxJHhu5kgeGVtIGLhuqNuZyB2w6AgbOG7i2NoXG4gICAgICAgIHZpZXdUYWJiZWRQYW5lID0gbmV3IEpUYWJiZWRQYW5lKCk7XG4uLi5cblxuICAgICAgICAvLyBUaMOqbSBjw6FjIHRhYiB2w6BvIFRhYmJlZFBhbmVcbiAgICAgICAgdmlld1RhYmJlZFBhbmUuYWRkVGFiKFwiROG6oW5nIELhuqNuZ1wiLCBuZXcgSW1hZ2VJY29uKCksIHRhYmxlVmlld1BhbmVsLCBcIkhp4buDbiB0aOG7iyBk4bqhbmcgYuG6o25nXCIpO1xuICAgICAgICB2aWV3VGFiYmVkUGFuZS5hZGRUYWIoXCJE4bqhbmcgTOG7i2NoXCIsIG5ldyBJbWFnZUljb24oKSwgY2FsZW5kYXJQYW5lbCwgXCJIaeG7g24gdGjhu4sgZOG6oW5nIGzhu4tjaFwiKTtcblxuICAgICAgICBwYW5lbC5hZGQodmlld1RhYmJlZFBhbmUsIEJvcmRlckxheW91dC5DRU5URVIpO1xuICAgICAgICBwYW5lbC5hZGQoY3JlYXRlQWN0aW9uUGFuZWwoKSwgQm9yZGVyTGF5b3V0LlNPVVRIKTtcblxuICAgICAgICByZXR1cm4gcGFuZWw7XG4gICAgfVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL21vZGVsL0xvYWlLaGFjaEhhbmcuamF2YVxuLi4uXG5cbkBEYXRhXG5ARW50aXR5XG5ARXF1YWxzQW5kSGFzaENvZGUob25seUV4cGxpY2l0bHlJbmNsdWRlZCA9IHRydWUpXG5wdWJsaWMgY2xhc3MgTG9haUtoYWNoSGFuZyBpbXBsZW1lbnRzIFNlcmlhbGl6YWJsZSB7XG4gICAgQElkXG4gICAgQEVxdWFsc0FuZEhhc2hDb2RlLkluY2x1ZGVcbiAgICBAQ29sdW1uKG5hbWUgPSBcIm1hX2xvYWlfa2hhY2hfaGFuZ1wiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJ2YXJjaGFyKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSwgdW5pcXVlID0gdHJ1ZSlcbiAgICBwcml2YXRlIFN0cmluZyBtYUxvYWlLaGFjaEhhbmc7XG4gICAgQENvbHVtbihuYW1lID0gXCJ0ZW5fbG9haV9raGFjaF9oYW5nXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcInZhcmNoYXIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgU3RyaW5nIHRlbkxvYWlLaGFjaEhhbmc7XG5cbiAgICBAVG9TdHJpbmcuRXhjbHVkZVxuICAgIEBPbmVUb01hbnkobWFwcGVkQnkgPSBcImxvYWlLaGFjaEhhbmdcIilcbiAgICBwcml2YXRlIFNldDxLaGFjaEhhbmc+IGtoYWNoSGFuZ3M7XG5cbn1cblxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2Rhby9Eb2lWZURBTy5qYXZhXG4uLi5cblxucHVibGljIGludGVyZmFjZSBEb2lWZURBTyBleHRlbmRzIFJlbW90ZSB7XG4gICAgVmVUYXUgZ2V0VmVUYXUoU3RyaW5nIGlkKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuICAgIGJvb2xlYW4gZG9pVmUoVmVUYXUgdmVUYXUpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG4gICAgTGlzdDxWZVRhdT4gZ2V0VmVUYXVCeVRyYW5nVGhhaShUcmFuZ1RoYWlWZVRhdSB0cmFuZ1RoYWkpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG4gICAgYm9vbGVhbiB0ZXN0Q29ubmVjdGlvbigpIHRocm93cyBSZW1vdGVFeGNlcHRpb247XG4gICAgTGlzdDxUcmFuZ1RoYWlWZVRhdT4gZ2V0QWxsVHJhbmdUaGFpVmUoKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uO1xuXG4gICAgLy8gVGjDqm0gY2jhu6ljIG7Eg25nIG3hu5tpXG4gICAgYm9vbGVhbiBkYXRWZShWZVRhdSB2ZVRhdSwgU3QuLi4iLCJpc0Vycm9yIjpmYWxzZSwicmVxdWVzdElkIjoiIn19LCIxNWIyMzdlNy1hZjEwLTRiZjEtOGZhYi1lZGU0Y2E1OThkNzE7dG9vbHVfMDFUUHo4UUJZM29TZXRlYmY5YmNqUm9yIjp7InBoYXNlIjo1LCJyZXN1bHQiOnsidGV4dCI6IlRoZSBmb2xsb3dpbmcgY29kZSBzZWN0aW9ucyB3ZXJlIHJldHJpZXZlZDpcblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZ3VpQ2xpZW50L01haW5HVUkuamF2YVxucGFja2FnZSBndWlDbGllbnQ7XG5cbmltcG9ydCBkYW8uRG9pVmVEQU87XG5pbXBvcnQgZGFvLmltcGwuRG9pVmVEQU9JbXBsO1xuaW1wb3J0IGRhby5pbXBsLk5oYW5WaWVuREFPSW1wbDtcbmltcG9ydCBtb2RlbC5OaGFuVmllbjtcblxuaW1wb3J0IGphdmF4LnN3aW5nLio7XG5pbXBvcnQgamF2YS5hd3QuKjtcbmltcG9ydCBqYXZhLmF3dC5ldmVudC5Nb3VzZUFkYXB0ZXI7XG5pbXBvcnQgamF2YS5hd3QuZXZlbnQuTW91c2VFdmVudDtcbmltcG9ydCBqYXZhLmF3dC5ldmVudC5XaW5kb3dBZGFwdGVyO1xuaW1wb3J0IGphdmEuYXd0LmV2ZW50LldpbmRvd0V2ZW50O1xuaW1wb3J0IGphdmEuYXd0LmltYWdlLkJ1ZmZlcmVkSW1hZ2U7XG5pbXBvcnQgamF2YS5ybWkuUmVtb3RlRXhjZXB0aW9uO1xuaW1wb3J0IGphdmEudGltZS5Mb2NhbERhdGU7XG5pbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7XG5pbXBvcnQgamF2YS51dGlsLk1hcDtcblxucHVibGljIGNsYXNzIE1haW5HVUkgZXh0ZW5kcyBKRnJhbWUge1xuXG4gICAgcHJpdmF0ZSBKUGFuZWwgY29udGVudFBhbmVsOyAvLyBDb250ZW50IHBhbmVsIG1hbmFnZWQgYnkgQ2FyZExheW91dFxuICAgIHByaXZhdGUgQ2FyZExheW91dCBjYXJkTGF5b3V0OyAvLyBDYXJkTGF5b3V0IGZvciBzd2l0Y2hpbmcgcGFuZWxzXG4gICAgcHJpdmF0ZSBNYXA8U3RyaW5nLCBKUGFuZWw+IHBhbmVsTWFwOyAvLyBDYWNoZSBmb3IgcGFuZWxzXG4gICAgcHJpdmF0ZSBMaWNoVHJpbmhUYXVQYW5lbCBsaWNoVHJpbmhUYXVQYW5lbDtcbiAgICBwcml2YXRlIE5oYW5WaWVuIG5oYW5WaWVuO1xuXG4gICAgcHVibGljIE1haW5HVUkoTmhhblZpZW4gbnYpIHtcbiAgICAgICAgbmhhblZpZW4gPSBudjtcbiAgICAgICAgc2V0VGl0bGUoXCJRdeG6o24gbMO9IHTDoHUgaOG7j2FcIik7XG4gICAgICAgIHNldFNpemUoMTIwMCwgODAwKTtcbiAgICAgICAgc2V0RGVmYXVsdENsb3NlT3BlcmF0aW9uKEpGcmFtZS5FWElUX09OX0NMT1NFKTtcbiAgICAgICAgc2V0TG9jYXRpb25SZWxhdGl2ZVRvKG51bGwpO1xuXG4gICAgICAgIC8vIEluaXRpYWxpemUgcGFuZWwgbWFwXG4gICAgICAgIHBhbmVsTWFwID0gbmV3IEhhc2hNYXA8PigpO1xuXG4gICAgICAgIC8vIENyZWF0ZSB0aGUgbWFpbiBsYXlvdXRcbiAgICAgICAgSlBhbmVsIG1haW5QYW5lbCA9IG5ldyBKUGFuZWwobmV3IEJvcmRlckxheW91dCgpKTtcblxuICAgICAgICAvLyBDcmVhdGUgaGVhZGVyXG4gICAgICAgIEpQYW5lbCBoZWFkZXJQYW5lbCA9IGNyZWF0ZUhlYWRlclBhbmVsKCk7XG4gICAgICAgIG1haW5QYW5lbC5hZGQoaGVhZGVyUGFuZWwsIEJvcmRlckxheW91dC5OT1JUSCk7XG5cbiAgICAgICAgLy8gQ3JlYXRlIHZlcnRpY2FsIG1lbnVcbiAgICAgICAgSlBhbmVsIHZlcnRpY2FsTWVudSA9IGNyZWF0ZVZlcnRpY2FsTWVudSgpO1xuICAgICAgICBtYWluUGFuZWwuYWRkKHZlcnRpY2FsTWVudSwgQm9yZGVyTGF5b3V0LldFU1QpO1xuXG4gICAgICAgIC8vIENyZWF0ZSBjb250ZW50IHBhbmVsIHdpdGggQ2FyZExheW91dFxuICAgICAgICBjYXJkTGF5b3V0ID0gbmV3IENhcmRMYXlvdXQoKTtcbiAgICAgICAgY29udGVudFBhbmVsID0gbmV3IEpQYW5lbChjYXJkTGF5b3V0KTtcblxuICAgICAgICAvLyBBZGQgZGVmYXVsdCBjb250ZW50IHBhbmVsXG4gICAgICAgIEpQYW5lbCBkZWZhdWx0UGFuZWwgPSBjcmVhdGVEZWZhdWx0Q29udGVudFBhbmVsKCk7XG4gICAgICAgIGNvbnRlbnRQYW5lbC5hZGQoZGVmYXVsdFBhbmVsLCBcIlRyYW5nIGNo4bunXCIpO1xuICAgICAgICBwYW5lbE1hcC5wdXQoXCJUcmFuZyBjaOG7p1wiLCBkZWZhdWx0UGFuZWwpO1xuXG4gICAgICAgIG1haW5QYW5lbC5hZGQoY29udGVudFBhbmVsLCBCb3JkZXJMYXlvdXQuQ0VOVEVSKTtcblxuICAgICAgICBhZGQobWFpblBhbmVsKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIEpQYW5lbCBjcmVhdGVIZWFkZXJQYW5lbCgpIHtcbiAgICAgICAgSlBhbmVsIGhlYWRlclBhbmVsID0gbmV3IEpQYW5lbChuZXcgQm9yZGVyTGF5b3V0KCkpO1xuICAgICAgICBoZWFkZXJQYW5lbC5zZXRCYWNrZ3JvdW5kKG5ldyBDb2xvcig0MSwgMTI4LCAxODUpKTsgLy8gQmx1ZSBoZWFkZXIgYmFja2dyb3VuZFxuICAgICAgICBoZWFkZXJQYW5lbC5zZXRQcmVmZXJyZWRTaXplKG5ldyBEaW1lbnNpb24oMCwgNjApKTtcblxuICAgICAgICBKTGFiZWwgdGl0bGVMYWJlbCA9IG5ldyBKTGFiZWwoXCJI4buHIHRo4buRbmcgcXXhuqNuIGzDvSB0w6B1IGjhu49hXCIsIEpMYWJlbC5DRU5URVIpO1xuICAgICAgICB0aXRsZUxhYmVsLnNldEZvbnQobmV3IEZvbnQoXCJBcmlhbFwiLCBGb250LkJPTEQsIDI0KSk7XG4gICAgICAgIHRpdGxlTGFiZWwuc2V0Rm9yZWdyb3VuZChDb2xvci5XSElURSk7XG5cbiAgICAgICAgaGVhZGVyUGFuZWwuYWRkKHRpdGxlTGFiZWwsIEJvcmRlckxheW91dC5DRU5URVIpO1xuICAgICAgICByZXR1cm4gaGVhZGVyUGFuZWw7XG4gICAgfVxuLi4uXG5cbiAgICBwcml2YXRlIEpQYW5lbCBjcmVhdGVWZXJ0aWNhbE1lbnUoKSB7XG4gICAgICAgIEpQYW5lbCBtZW51UGFuZWwgPSBuZXcgSlBhbmVsKCk7XG4gICAgICAgIG1lbnVQYW5lbC5zZXRMYXlvdXQobmV3IEJveExheW91dChtZW51UGFuZWwsIEJveExheW91dC5ZX0FYSVMpKTtcbiAgICAgICAgbWVudVBhbmVsLnNldEJhY2tncm91bmQobmV3IENvbG9yKDUyLCA3MywgOTQpKTsgLy8gRGFyayBncmF5IG1lbnUgYmFja2dyb3VuZFxuICAgICAgICBtZW51UGFuZWwuc2V0UHJlZmVycmVkU2l6ZShuZXcgRGltZW5zaW9uKDI1MCwgMCkpO1xuXG4gICAgICAgIFN0cmluZ1tdIG1lbnVJdGVtcyA9IHtcbiAgICAgICAgICAgICAgICBcIlRyYW5nIGNo4bunXCIsIFwiVGjDtG5nIHRpbiBob+G6oXQgxJHhu5luZ1wiLCBcIlF14bqjbiBsw70ga2jDoWNoIGjDoG5nXCIsXG4gICAgICAgICAgICAgICAgXCJRdeG6o24gbMO9IHbDqVwiLCBcIlF14bqjbiBsw70gbOG7i2NoIHRyw6xuaFwiLCBcIkLDoW8gY8Ohb1wiLCBcIlRyYSBj4bupdSB2w6lcIiwgXCLEkOG7lWkgdsOpXCIsIFwiVHLhuqMgdsOpXCIsIFwiUXXhuqNuIGzDvSBuaMOibiB2acOqblwiLFxuICAgICAgICAgICAgICAgIFwiVGjhu5FuZyBrw6ogc+G7kSBsxrDhu6NuZyB2w6kgdGhlbyB0aOG7nWkgZ2lhblwiXG4gICAgICAgIH07XG4uLi5cblxuICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGVcbiAgICAgICAgICAgICAgICAgICAgcHJvdGVjdGVkIHZvaWQgZG9uZSgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gR2V0IHRoZSBwYW5lbCBhZnRlciBpdCdzIGNyZWF0ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBRdWFuTHlLaGFjaEhhbmdQYW5lbCBwYW5lbCA9IGdldCgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkIHRvIGNhY2hlIGFuZCBkaXNwbGF5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFBhbmVsLmFkZChwYW5lbCwgcGFuZWxOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYW5lbE1hcC5wdXQocGFuZWxOYW1lLCBwYW5lbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyZExheW91dC5zaG93KGNvbnRlbnRQYW5lbCwgcGFuZWxOYW1lKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBsb2FkaW5nIHBhbmVsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFBhbmVsLnJlbW92ZShsb2FkaW5nUGFuZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKE1haW5HVUkudGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiS2jDtG5nIHRo4buDIHThuqNpIGThu68gbGnhu4d1IGtow6FjaCBow6BuZzogXCIgKyBlLmdldE1lc3NhZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2kga+G6v3QgbuG7kWlcIiwgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyZExheW91dC5zaG93KGNvbnRlbnRQYW5lbCwgXCJUcmFuZyBjaOG7p1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4uLi5cblxuICAgICAgICAgICAgICAgIC8vIFThuqFvIHBhbmVsIHF14bqjbiBsw70gbOG7i2NoIHRyw6xuaCB0cm9uZyBsdeG7k25nIHJpw6puZ1xuICAgICAgICAgICAgICAgIFN3aW5nV29ya2VyPExpY2hUcmluaFRhdVBhbmVsLCBWb2lkPiB3b3JrZXIgPSBuZXcgU3dpbmdXb3JrZXI8PigpIHtcbiAgICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlXG4gICAgICAgICAgICAgICAgICAgIHByb3RlY3RlZCBMaWNoVHJpbmhUYXVQYW5lbCBkb0luQmFja2dyb3VuZCgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgTGljaFRyaW5oVGF1UGFuZWwoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZVxuICAgICAgICAgICAgICAgICAgICBwcm90ZWN0ZWQgdm9pZCBkb25lKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBM4bqleSBwYW5lbCBzYXUga2hpIMSRw6MgdOG6oW8geG9uZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIExpY2hUcmluaFRhdVBhbmVsIHBhbmVsID0gZ2V0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGljaFRyaW5oVGF1UGFuZWwgPSBwYW5lbDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRow6ptIHbDoG8gY2FjaGUgdsOgIGhp4buDbiB0aOG7i1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRQYW5lbC5hZGQocGFuZWwsIHBhbmVsTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFuZWxNYXAucHV0KHBhbmVsTmFtZSwgcGFuZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRMYXlvdXQuc2hvdyhjb250ZW50UGFuZWwsIHBhbmVsTmFtZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBYw7NhIHBhbmVsIGxvYWRpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50UGFuZWwucmVtb3ZlKGxvYWRpbmdQYW5lbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coTWFpbkdVSS50aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJLaMO0bmcgdGjhu4MgdOG6o2kgZOG7ryBsaeG7h3U6IFwiICsgZS5nZXRNZXNzYWdlKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpIGvhur90IG7hu5FpXCIsIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRMYXlvdXQuc2hvdyhjb250ZW50UGFuZWwsIFwiVHJhbmcgY2jhu6dcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbi4uLlxuXG4gICAgICAgICAgICAgICAgLy8gVOG6oW8gcGFuZWwgcXXhuqNuIGzDvSB2w6kgdHJvbmcgbHXhu5NuZyByacOqbmdcbiAgICAgICAgICAgICAgICBTd2luZ1dvcmtlcjxEb2lWZVBhbmVsLCBWb2lkPiB3b3JrZXIgPSBuZXcgU3dpbmdXb3JrZXI8PigpIHtcbiAgICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlXG4gICAgICAgICAgICAgICAgICAgIHByb3RlY3RlZCBEb2lWZVBhbmVsIGRvSW5CYWNrZ3JvdW5kKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEb2lWZVBhbmVsKG5oYW5WaWVuKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZVxuICAgICAgICAgICAgICAgICAgICBwcm90ZWN0ZWQgdm9pZCBkb25lKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBM4bqleSBwYW5lbCBzYXUga2hpIMSRw6MgdOG6oW8geG9uZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIERvaVZlUGFuZWwgcGFuZWwgPSBnZXQoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRow6ptIHbDoG8gY2FjaGUgdsOgIGhp4buDbiB0aOG7i1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRQYW5lbC5hZGQocGFuZWwsIHBhbmVsTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFuZWxNYXAucHV0KHBhbmVsTmFtZSwgcGFuZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRMYXlvdXQuc2hvdyhjb250ZW50UGFuZWwsIHBhbmVsTmFtZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBYw7NhIHBhbmVsIGxvYWRpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50UGFuZWwucmVtb3ZlKGxvYWRpbmdQYW5lbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coTWFpbkdVSS50aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJLaMO0bmcgdGjhu4MgdOG6o2kgZOG7ryBsaeG7h3U6IFwiICsgZS5nZXRNZXNzYWdlKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpIGvhur90IG7hu5FpXCIsIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRMYXlvdXQuc2hvdyhjb250ZW50UGFuZWwsIFwiVHJhbmcgY2jhu6dcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuLi4uXG5cbiAgICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlXG4gICAgICAgICAgICAgICAgICAgIHByb3RlY3RlZCB2b2lkIGRvbmUoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEzhuqV5IHBhbmVsIHNhdSBraGkgxJHDoyB04bqhbyB4b25nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVHJhVmVQYW5lbCBwYW5lbCA9IGdldCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRow6ptIHbDoG8gY2FjaGUgdsOgIGhp4buDbiB0aOG7i1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRQYW5lbC5hZGQocGFuZWwsIHBhbmVsTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFuZWxNYXAucHV0KHBhbmVsTmFtZSwgcGFuZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRMYXlvdXQuc2hvdyhjb250ZW50UGFuZWwsIHBhbmVsTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gWMOzYSBwYW5lbCBsb2FkaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFBhbmVsLnJlbW92ZShsb2FkaW5nUGFuZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKE1haW5HVUkudGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiS2jDtG5nIHRo4buDIHThuqNpIGThu68gbGnhu4d1IHRy4bqjIHbDqTogXCIgKyBlLmdldE1lc3NhZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2kga+G6v3QgbuG7kWlcIiwgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyZExheW91dC5zaG93KGNvbnRlbnRQYW5lbCwgXCJUcmFuZyBjaOG7p1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4uLi5cblxuICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGVcbiAgICAgICAgICAgICAgICAgICAgcHJvdGVjdGVkIHZvaWQgZG9uZSgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTOG6pXkgcGFuZWwgc2F1IGtoaSDEkcOjIHThuqFvIHhvbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBRdWFuTHlOaGFuVmllblBhbmVsIHBhbmVsID0gZ2V0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaMOqbSB2w6BvIGNhY2hlIHbDoCBoaeG7g24gdGjhu4tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50UGFuZWwuYWRkKHBhbmVsLCBwYW5lbE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhbmVsTWFwLnB1dChwYW5lbE5hbWUsIHBhbmVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkTGF5b3V0LnNob3coY29udGVudFBhbmVsLCBwYW5lbE5hbWUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gWMOzYSBwYW5lbCBsb2FkaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFBhbmVsLnJlbW92ZShsb2FkaW5nUGFuZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKE1haW5HVUkudGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiS2jDtG5nIHRo4buDIHThuqNpIGThu68gbGnhu4d1IG5ow6JuIHZpw6puOiBcIiArIGUuZ2V0TWVzc2FnZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaSBr4bq/dCBu4buRaVwiLCBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkTGF5b3V0LnNob3coY29udGVudFBhbmVsLCBcIlRyYW5nIGNo4bunXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbi4uLlxuXG4gICAgICAgICAgICAgICAgLy8gVOG6oW8gcGFuZWwgcXXhuqNuIGzDvSB2w6kgdHJvbmcgbHXhu5NuZyByacOqbmdcbiAgICAgICAgICAgICAgICBTd2luZ1dvcmtlcjxUcmFDdXVWZVBhbmVsLCBWb2lkPiB3b3JrZXIgPSBuZXcgU3dpbmdXb3JrZXI8PigpIHtcbiAgICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlXG4gICAgICAgICAgICAgICAgICAgIHByb3RlY3RlZCBUcmFDdXVWZVBhbmVsIGRvSW5CYWNrZ3JvdW5kKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBUcmFDdXVWZVBhbmVsKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGVcbiAgICAgICAgICAgICAgICAgICAgcHJvdGVjdGVkIHZvaWQgZG9uZSgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTOG6pXkgcGFuZWwgc2F1IGtoaSDEkcOjIHThuqFvIHhvbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUcmFDdXVWZVBhbmVsIHBhbmVsID0gZ2V0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaMOqbSB2w6BvIGNhY2hlIHbDoCBoaeG7g24gdGjhu4tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50UGFuZWwuYWRkKHBhbmVsLCBwYW5lbE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhbmVsTWFwLnB1dChwYW5lbE5hbWUsIHBhbmVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkTGF5b3V0LnNob3coY29udGVudFBhbmVsLCBwYW5lbE5hbWUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gWMOzYSBwYW5lbCBsb2FkaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFBhbmVsLnJlbW92ZShsb2FkaW5nUGFuZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKE1haW5HVUkudGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiS2jDtG5nIHRo4buDIHThuqNpIGThu68gbGnhu4d1OiBcIiArIGUuZ2V0TWVzc2FnZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaSBr4bq/dCBu4buRaVwiLCBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkTGF5b3V0LnNob3coY29udGVudFBhbmVsLCBcIlRyYW5nIGNo4bunXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbi4uLlxuXG4gICAgICAgICAgICAgICAgLy8gVOG6oW8gcGFuZWwgcXXhuqNuIGzDvSB2w6kgdHJvbmcgbHXhu5NuZyByacOqbmdcbiAgICAgICAgICAgICAgICBTd2luZ1dvcmtlcjxUaG9uZ0tlVmVQYW5lbCwgVm9pZD4gd29ya2VyID0gbmV3IFN3aW5nV29ya2VyPD4oKSB7XG4gICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZVxuICAgICAgICAgICAgICAgICAgICBwcm90ZWN0ZWQgVGhvbmdLZVZlUGFuZWwgZG9JbkJhY2tncm91bmQoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFRob25nS2VWZVBhbmVsKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGVcbiAgICAgICAgICAgICAgICAgICAgcHJvdGVjdGVkIHZvaWQgZG9uZSgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTOG6pXkgcGFuZWwgc2F1IGtoaSDEkcOjIHThuqFvIHhvbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUaG9uZ0tlVmVQYW5lbCBwYW5lbCA9IGdldCgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGjDqm0gdsOgbyBjYWNoZSB2w6AgaGnhu4NuIHRo4buLXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFBhbmVsLmFkZChwYW5lbCwgcGFuZWxOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYW5lbE1hcC5wdXQocGFuZWxOYW1lLCBwYW5lbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyZExheW91dC5zaG93KGNvbnRlbnRQYW5lbCwgcGFuZWxOYW1lKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFjDs2EgcGFuZWwgbG9hZGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRQYW5lbC5yZW1vdmUobG9hZGluZ1BhbmVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhNYWluR1VJLnRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIktow7RuZyB0aOG7gyB04bqjaSBk4buvIGxp4buHdTogXCIgKyBlLmdldE1lc3NhZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2kga+G6v3QgbuG7kWlcIiwgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyZExheW91dC5zaG93KGNvbnRlbnRQYW5lbCwgXCJUcmFuZyBjaOG7p1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB3b3JrZXIuZXhlY3V0ZSgpO1xuICAgICAgICAgICAgICAgIHJldHVybjsgLy8gVGhvw6F0IHPhu5ttXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9tb2RlbC9Eb2lUdW9uZ0FwRHVuZy5qYXZhXG5wYWNrYWdlIG1vZGVsO1xuXG5wdWJsaWMgZW51bSBEb2lUdW9uZ0FwRHVuZyB7XG59XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGF0YWZha2VyL0xvYWlDaG9ERi5qYXZhXG4uLi5cblxucHVibGljIGNsYXNzIExvYWlDaG9ERiB7XG4gICAgcHVibGljIHN0YXRpYyB2b2lkIGdlbmVyYXRlU2FtcGxlRGF0YShFbnRpdHlNYW5hZ2VyIGVtKSB7XG4gICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHR4ID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcbiAgICAgICAgRmFrZXIgZmFrZXIgPSBuZXcgRmFrZXIoKTtcblxuICAgICAgICAvLyBzZXQgZOG7ryBsaeG7h3UgY2hvIExvYWlDaG9cbiAgICAgICAgTG9haUNobyBsYzEgPSBuZXcgTG9haUNobygpO1xuICAgICAgICBsYzEuc2V0TWFMb2FpKFwiTEMwMVwiKTtcbiAgICAgICAgbGMxLnNldFRlbkxvYWkoXCJHaOG6vyBuZ+G7k2kgY+G7qW5nXCIpO1xuXG4gICAgICAgIExvYWlDaG8gbGMyID0gbmV3IExvYWlDaG8oKTtcbiAgICAgICAgbGMyLnNldE1hTG9haShcIkxDMDJcIik7XG4gICAgICAgIGxjMi5zZXRUZW5Mb2FpKFwiR2jhur8gbmfhu5NpIG3hu4FtXCIpO1xuXG4gICAgICAgIExvYWlDaG8gbGMzID0gbmV3IExvYWlDaG8oKTtcbiAgICAgICAgbGMzLnNldE1hTG9haShcIkxDMDNcIik7XG4gICAgICAgIGxjMy5zZXRUZW5Mb2FpKFwiR2nGsOG7nW5nIG7hurFtIG3hu4FtXCIpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdHguYmVnaW4oKTtcbiAgICAgICAgICAgIGVtLnBlcnNpc3QobGMxKTtcbiAgICAgICAgICAgIGVtLnBlcnNpc3QobGMyKTtcbiAgICAgICAgICAgIGVtLnBlcnNpc3QobGMzKTtcbiAgICAgICAgICAgIHR4LmNvbW1pdCgpO1xuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiUGjDoXQgc2luaCBk4buvIGxp4buHdSB0aMOgbmggY8O0bmcgY2hvIExvYWlDaG9cIik7XG4gICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICB0eC5yb2xsYmFjaygpO1xuICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFwiUGjDoXQgc2luaCBk4buvIGxp4buHdSB0aOG6pXQgYuG6oWkgY2hvIExvYWlDaG9cIik7XG5cbiAgICAgICAgfVxuICAgIH1cbn1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9kYXRhZmFrZXIvTG9haUhvYURvbkRGLmphdmFcbnBhY2thZ2UgZGF0YWZha2VyO1xuXG5cbmltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXI7XG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS5FbnRpdHlUcmFuc2FjdGlvbjtcbmltcG9ydCBtb2RlbC5Mb2FpSG9hRG9uO1xuaW1wb3J0IG5ldC5kYXRhZmFrZXIuRmFrZXI7XG5cbmltcG9ydCBqYXZhLnV0aWwuTG9jYWxlO1xuXG5wdWJsaWMgY2xhc3MgTG9haUhvYURvbkRGIHtcbiAgICBwcml2YXRlIEZha2VyIGZha2VyO1xuXG4gICAgcHVibGljIExvYWlIb2FEb25ERigpIHtcbiAgICAgICAgdGhpcy5mYWtlciA9IG5ldyBGYWtlcihuZXcgTG9jYWxlKFwidmlcIikpOyAvLyBLaOG7n2kgdOG6oW8gRGF0YWZha2VyIHbhu5tpIG5nw7RuIG5n4buvIHRp4bq/bmcgVmnhu4d0XG4gICAgfVxuXG4gICAgcHVibGljIExvYWlIb2FEb24gZ2VuZXJhdGVMb2FpSG9hRG9uKFN0cmluZyBtYUxvYWlIb2FEb24sIFN0cmluZyB0ZW5Mb2FpSG9hRG9uKSB7XG4gICAgICAgIExvYWlIb2FEb24gbG9haUhvYURvbiA9IG5ldyBMb2FpSG9hRG9uKCk7XG4gICAgICAgIGxvYWlIb2FEb24uc2V0TWFMb2FpSG9hRG9uKG1hTG9haUhvYURvbik7IC8vIE3DoyBsb+G6oWkgaMOzYSDEkcahbiAoxJHGsOG7o2MgdHJ1eeG7gW4gdsOgbylcbiAgICAgICAgbG9haUhvYURvbi5zZXRUZW5Mb2FpSG9hRG9uKHRlbkxvYWlIb2FEb24pOyAvLyBUw6puIGxv4bqhaSBow7NhIMSRxqFuIChtdWEsIMSR4buVaSwgdHLhuqMpXG4gICAgICAgIHJldHVybiBsb2FpSG9hRG9uO1xuICAgIH1cblxuICAgIHB1YmxpYyB2b2lkIGdlbmVyYXRlQW5kU2F2ZUxvYWlIb2FEb25zKEVudGl0eU1hbmFnZXIgZW0pIHtcbiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHJhbnNhY3Rpb24gPSBlbS5nZXRUcmFuc2FjdGlvbigpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdHJhbnNhY3Rpb24uYmVnaW4oKTtcblxuICAgICAgICAgICAgLy8gVGjDqm0gMyBsb+G6oWkgaMOzYSDEkcahbjogTXVhLCDEkOG7lWksIFRy4bqjXG4gICAgICAgICAgICBlbS5wZXJzaXN0KGdlbmVyYXRlTG9haUhvYURvbihcIkxIRDAwMVwiLCBcIk11YVwiKSk7XG4gICAgICAgICAgICBlbS5wZXJzaXN0KGdlbmVyYXRlTG9haUhvYURvbihcIkxIRDAwMlwiLCBcIsSQ4buVaVwiKSk7XG4gICAgICAgICAgICBlbS5wZXJzaXN0KGdlbmVyYXRlTG9haUhvYURvbihcIkxIRDAwM1wiLCBcIlRy4bqjXCIpKTtcblxuICAgICAgICAgICAgdHJhbnNhY3Rpb24uY29tbWl0KCk7XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJUaMOqbSBk4buvIGxp4buHdSBt4bqrdSBjaG8gTG9haUhvYURvbiB0aMOgbmggY8O0bmchXCIpO1xuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgdHJhbnNhY3Rpb24ucm9sbGJhY2soKTtcbiAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCJM4buXaSBraGkgdGjDqm0gZOG7ryBsaeG7h3UgbeG6q3UgY2hvIExvYWlIb2FEb24hXCIpO1xuICAgICAgICB9XG4gICAgfVxufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2RhdGFmYWtlci9UYXVERi5qYXZhXG4uLi5cblxuICAgICAgICAgICAgLy8gVOG6oW8gMTAgZOG7ryBsaeG7h3UgbeG6q3UgY2hvIFRhdVxuICAgICAgICAgICAgZm9yIChpbnQgaSA9IDE7IGkgPD0gMTA7IGkrKykge1xuICAgICAgICAgICAgICAgIFRhdSB0YXUgPSBuZXcgVGF1KCk7XG4gICAgICAgICAgICAgICAgdGF1LnNldE1hVGF1KFwiVFwiICsgaSk7IC8vIE3DoyB0w6B1IMSR4buLbmggZOG6oW5nIFQxLCBUMiwgLi4uXG4gICAgICAgICAgICAgICAgdGF1LnNldFRlblRhdShcIlTDoHUgXCIgKyBmYWtlci5uYW1lKCkubGFzdE5hbWUoKSk7IC8vIFTDqm4gdMOgdSB24bubaSBo4buNIG5n4bqrdSBuaGnDqm5cbiAgICAgICAgICAgICAgICB0YXUuc2V0U29Ub2EoZmFrZXIubnVtYmVyKCkubnVtYmVyQmV0d2Vlbig1LCAyMCkpOyAvLyBT4buRIHRvYSB04burIDUgxJHhur9uIDIwXG5cbiAgICAgICAgICAgICAgICAvLyBMacOqbiBr4bq/dCB24bubaSBt4buZdCBUdXllblRhdSBuZ+G6q3Ugbmhpw6puXG4gICAgICAgICAgICAgICAgVHV5ZW5UYXUgcmFuZG9tVHV5ZW5UYXUgPSB0dXllblRhdUxpc3QuZ2V0KGZha2VyLm51bWJlcigpLm51bWJlckJldHdlZW4oMCwgdHV5ZW5UYXVMaXN0LnNpemUoKSkpO1xuICAgICAgICAgICAgICAgIHRhdS5zZXRUdXllblRhdShyYW5kb21UdXllblRhdSk7XG5cbiAgICAgICAgICAgICAgICAvLyBMxrB1IMSR4buRaSB0xrDhu6NuZyBUYXUgdsOgbyBjxqEgc+G7nyBk4buvIGxp4buHdVxuICAgICAgICAgICAgICAgIGVtLnBlcnNpc3QodGF1KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdHJhbnNhY3Rpb24uY29tbWl0KCk7XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJE4buvIGxp4buHdSBt4bqrdSBjaG8gVGF1IMSRw6MgxJHGsOG7o2MgdOG6oW8gdGjDoG5oIGPDtG5nLlwiKTtcbiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgIGlmICh0cmFuc2FjdGlvbi5pc0FjdGl2ZSgpKSB7XG4gICAgICAgICAgICAgICAgdHJhbnNhY3Rpb24ucm9sbGJhY2soKTtcbiAgICAgICAgICAgIH1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9kYXRhZmFrZXIvS2h1eWVuTWFpREYuamF2YVxuLi4uXG5cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpO1xuICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCAxNTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgS2h1eWVuTWFpIGtodXllbk1haSA9IG5ldyBLaHV5ZW5NYWkoKTtcbiAgICAgICAgICAgICAgICBraHV5ZW5NYWkuc2V0TWFLTShnZW5lcmF0ZU5leHRNYUtNKGVtKSk7IC8vIFNpbmggbcOjIHThu7EgxJHhu5luZ1xuICAgICAgICAgICAgICAgIGtodXllbk1haS5zZXRUZW5LTShcIktodXnhur9uIG3Do2kgc+G7kSBcIiArIChpICsgMSkpO1xuICAgICAgICAgICAgICAgIGtodXllbk1haS5zZXRUaG9pR2lhbkJhdERhdShMb2NhbERhdGUubm93KCkubWludXNEYXlzKGkpKTtcbiAgICAgICAgICAgICAgICBraHV5ZW5NYWkuc2V0VGhvaUdpYW5LZXRUaHVjKExvY2FsRGF0ZS5ub3coKS5wbHVzRGF5cyhpICsgMTApKTtcbiAgICAgICAgICAgICAgICBraHV5ZW5NYWkuc2V0Tm9pRHVuZ0tNKFwiR2nhuqNtIGdpw6EgXCIgKyAoMTAgKyBpKSArIFwiJSBjaG8ga2jDoWNoIGjDoG5nXCIpO1xuICAgICAgICAgICAgICAgIGtodXllbk1haS5zZXRDaGlldEtoYXUoMTAgKyBpKTtcbiAgICAgICAgICAgICAgICBraHV5ZW5NYWkuc2V0RG9pVHVvbmdBcER1bmcoXCJLaMOhY2ggaMOgbmcgbG/huqFpIFwiICsgKGkgJSAzICsgMSkpO1xuICAgICAgICAgICAgICAgIGtodXllbk1haS5zZXRUcmFuZ1RoYWkoaSAlIDIgPT0gMCA/IFwixJBhbmcgw6FwIGThu6VuZ1wiIDogXCJI4bq/dCBo4bqhblwiKTtcblxuICAgICAgICAgICAgICAgIGVtLnBlcnNpc3Qoa2h1eWVuTWFpKTsgLy8gTMawdSB2w6BvIGPGoSBz4bufIGThu68gbGnhu4d1XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1pdCgpO1xuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5yb2xsYmFjaygpO1xuICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgfVxuICAgIH1cblxuXG59XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGF0YWZha2VyL0xvYWlUb2FERi5qYXZhXG4uLi5cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdHJhbnNhY3Rpb24uYmVnaW4oKTtcblxuICAgICAgICAgICAgLy8gVOG6oW8gMTAgZOG7ryBsaeG7h3UgbeG6q3UgY2hvIExvYWlUb2FcbiAgICAgICAgICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IDEwOyBpKyspIHtcbiAgICAgICAgICAgICAgICBMb2FpVG9hIGxvYWlUb2EgPSBuZXcgTG9haVRvYSgpO1xuICAgICAgICAgICAgICAgIGxvYWlUb2Euc2V0TWFMb2FpKFwiTFRcIiArIGkpOyAvLyDEkOG6t3QgbcOjIGxv4bqhaSDEkeG7i25oIGThuqFuZyBMVDEsIExUMiwgLi4uXG4gICAgICAgICAgICAgICAgbG9haVRvYS5zZXRUZW5Mb2FpKFwiTG/huqFpIHRvYSBcIiArIGZha2VyLmNvbW1lcmNlKCkucHJvZHVjdE5hbWUoKSk7IC8vIFTDqm4gbG/huqFpIHbhu5tpIG3DtCB04bqjIHThu6sgRmFrZXJcbiAgICAgICAgICAgICAgICAvLyBMxrB1IHbDoG8gY8ahIHPhu58gZOG7ryBsaeG7h3VcbiAgICAgICAgICAgICAgICBlbS5wZXJzaXN0KGxvYWlUb2EpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0cmFuc2FjdGlvbi5jb21taXQoKTtcbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIkThu68gbGnhu4d1IG3huqt1IGNobyBMb2FpVG9hIMSRw6MgxJHGsOG7o2MgdOG6oW8gdGjDoG5oIGPDtG5nLlwiKTtcbiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgIGlmICh0cmFuc2FjdGlvbi5pc0FjdGl2ZSgpKSB7XG4gICAgICAgICAgICAgICAgdHJhbnNhY3Rpb24ucm9sbGJhY2soKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCLEkMOjIHjhuqN5IHJhIGzhu5dpIGtoaSB04bqhbyBk4buvIGxp4buHdSBt4bqrdSBjaG8gTG9haVRvYS5cIik7XG4gICAgICAgIH1cbiAgICB9XG59XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGF0YWZha2VyL1R1eWVuVGF1REYuamF2YVxuLi4uXG5cbiAgICAgICAgICAgIC8vIFThuqFvIDEwIGThu68gbGnhu4d1IG3huqt1IGNobyBUdXllblRhdVxuICAgICAgICAgICAgZm9yIChpbnQgaSA9IDE7IGkgPD0gMTA7IGkrKykge1xuICAgICAgICAgICAgICAgIFR1eWVuVGF1IHR1eWVuVGF1ID0gbmV3IFR1eWVuVGF1KCk7XG4gICAgICAgICAgICAgICAgdHV5ZW5UYXUuc2V0TWFUdXllbihcIlRUXCIgKyBpKTsgLy8gTcOjIHR1eeG6v24gxJHhu4tuaCBk4bqhbmcgVFQxLCBUVDIsIC4uLlxuICAgICAgICAgICAgICAgIHR1eWVuVGF1LnNldFRlblR1eWVuKFwiVHV54bq/biBcIiArIGZha2VyLmFkZHJlc3MoKS5jaXR5TmFtZSgpICsgXCIgLSBcIiArIGZha2VyLmFkZHJlc3MoKS5jaXR5TmFtZSgpKTsgLy8gVMOqbiB0dXnhur9uIHbhu5tpIHRow6BuaCBwaOG7kSBuZ+G6q3Ugbmhpw6puXG4gICAgICAgICAgICAgICAgdHV5ZW5UYXUuc2V0R2FEaShmYWtlci5hZGRyZXNzKCkuc3RyZWV0TmFtZSgpKTsgLy8gR2EgxJFpIG5n4bqrdSBuaGnDqm5cbiAgICAgICAgICAgICAgICB0dXllblRhdS5zZXRHYURlbihmYWtlci5hZGRyZXNzKCkuc3RyZWV0TmFtZSgpKTsgLy8gR2EgxJHhur9uIG5n4bqrdSBuaGnDqm5cbiAgICAgICAgICAgICAgICB0dXllblRhdS5zZXREaWFEaWVtRGkoZmFrZXIuYWRkcmVzcygpLmNpdHlOYW1lKCkgKyBcIiwgXCIgKyBmYWtlci5hZGRyZXNzKCkuY291bnRyeSgpKTsgLy8gxJDhu4thIMSRaeG7g20gxJFpICh0aMOgbmggcGjhu5EsIHF14buRYyBnaWEpXG4gICAgICAgICAgICAgICAgdHV5ZW5UYXUuc2V0RGlhRGllbURlbihmYWtlci5hZGRyZXNzKCkuY2l0eU5hbWUoKSArIFwiLCBcIiArIGZha2VyLmFkZHJlc3MoKS5jb3VudHJ5KCkpOyAvLyDEkOG7i2EgxJFp4buDbSDEkeG6v24gKHRow6BuaCBwaOG7kSwgcXXhu5FjIGdpYSlcblxuICAgICAgICAgICAgICAgIC8vIEzGsHUgxJHhu5FpIHTGsOG7o25nIFR1eWVuVGF1IHbDoG8gY8ahIHPhu58gZOG7ryBsaeG7h3VcbiAgICAgICAgICAgICAgICBlbS5wZXJzaXN0KHR1eWVuVGF1KTtcbiAgICAgICAgICAgIH1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9kYXRhZmFrZXIvS2hhY2hIYW5nREYuamF2YVxuLi4uXG4gICAgICAgIGtoYWNoSGFuZy5zZXROZ2F5VGhhbWdHaWEoTG9jYWxEYXRlLm5vdygpLm1pbnVzRGF5cyhmYWtlci5udW1iZXIoKS5udW1iZXJCZXR3ZWVuKDEsIDM2NSkpKTsgLy8gTmfDoHkgdGhhbSBnaWFcbiAgICAgICAga2hhY2hIYW5nLnNldEhhbmdUaGFuaFZpZW4oZmFrZXIub3B0aW9ucygpLm9wdGlvbihcIkLhuqFjXCIsIFwiVsOgbmdcIiwgXCJLaW0gQ8awxqFuZ1wiKSk7IC8vIEjhuqFuZyB0aMOgbmggdmnDqm5cblxuICAgICAgICAvLyBHw6FuIG5n4bqrdSBuaGnDqm4gbG/huqFpIGtow6FjaCBow6BuZyB04burIGRhbmggc8OhY2ggxJHDoyB04bqhb1xuICAgICAgICBraGFjaEhhbmcuc2V0TG9haUtoYWNoSGFuZyhsb2FpS2hhY2hIYW5nTGlzdC5nZXQocmFuZG9tLm5leHRJbnQobG9haUtoYWNoSGFuZ0xpc3Quc2l6ZSgpKSkpO1xuXG4gICAgICAgIHJldHVybiBraGFjaEhhbmc7XG4gICAgfVxuXG4gICAgLy8gSMOgbSBsxrB1IGThu68gbGnhu4d1IGdp4bqjIGzhuq1wIHbDoG8gREJcbiAgICBwdWJsaWMgIHZvaWQgZ2VuZXJhdGVBbmRQcmludFNhbXBsZURhdGEoKSB7XG4gICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBQZXJzaXN0ZW5jZVxuICAgICAgICAgICAgICAgIC5jcmVhdGVFbnRpdHlNYW5hZ2VyRmFjdG9yeShcIm1hcmlhZGJcIilcbiAgICAgICAgICAgICAgICAuY3JlYXRlRW50aXR5TWFuYWdlcigpO1xuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL21vZGVsL1RyYW5nVGhhaS5qYXZhXG5wYWNrYWdlIG1vZGVsO1xuXG5wdWJsaWMgZW51bSBUcmFuZ1RoYWkge1xuICAgIERBX0tIT0lfSEFOSChcIsSQw6Mga2jhu59pIGjDoG5oXCIpLFxuICAgIENIVUFfS0hPSV9IQU5IKFwiQ2jGsGEga2jhu59pIGjDoG5oXCIpLFxuICAgIERBX0hVWShcIsSQw6MgaOG7p3lcIiksXG4gICAgSE9BVF9ET05HKFwiSG/huqF0IMSR4buZbmdcIik7XG5cbiAgICBwcml2YXRlIGZpbmFsIFN0cmluZyB2YWx1ZTtcblxuICAgIFRyYW5nVGhhaShTdHJpbmcgdmFsdWUpIHtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgIH1cblxuICAgIHB1YmxpYyBTdHJpbmcgZ2V0VmFsdWUoKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIFRyYW5nVGhhaSBmcm9tVmFsdWUoU3RyaW5nIHZhbHVlKSB7XG4gICAgICAgIGZvciAoVHJhbmdUaGFpIHN0YXR1cyA6IFRyYW5nVGhhaS52YWx1ZXMoKSkge1xuICAgICAgICAgICAgaWYgKHN0YXR1cy52YWx1ZS5lcXVhbHModmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0YXR1cztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aHJvdyAuLi4iLCJpc0Vycm9yIjpmYWxzZSwicmVxdWVzdElkIjoiIn19LCJkOTg4ZWUwOS03YzdkLTQ4MTEtOWFlMS0yYTk1ZDQwMzcxMjg7dG9vbHVfMDFVa2YyNEtMekV3MnVaM2l2eGRTNEVZIjp7InBoYXNlIjo1LCJyZXN1bHQiOnsidGV4dCI6IkZpbGUgc2F2ZWQgc3VjY2Vzc2Z1bGx5LiIsImlzRXJyb3IiOmZhbHNlLCJyZXF1ZXN0SWQiOiIifX0sIjRmMGQxMzVmLTdmZDUtNDBlZS04OWJhLWI2OGRjYjcyNzdjZjt0b29sdV8wMUM0U2J5MldoUkF2S3dXR1kyRjNRTW4iOnsicGhhc2UiOjYsInJlc3VsdCI6eyJ0ZXh0IjoiRmlsZSBhbHJlYWR5IGV4aXN0czogRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9kYW8vaW1wbC9LaHV5ZW5NYWlEQU9JbXBsLmphdmEiLCJpc0Vycm9yIjp0cnVlLCJyZXF1ZXN0SWQiOiIifX0sIjQ2ZTM1YzYzLWNkZmItNGVjZi04MjJhLWJlZDRjOGQ3NDM0NTt0b29sdV8wMVJUNFV4UHREV2JFWWlEY3J2cUdCSzkiOnsicGhhc2UiOjUsInJlc3VsdCI6eyJ0ZXh0IjoiSGVyZSdzIHRoZSByZXN1bHQgb2YgcnVubmluZyBgY2F0IC1uYCBvbiBzcmMvbWFpbi9qYXZhL2Rhby9pbXBsL0todXllbk1haURBT0ltcGwuamF2YTpcbiAgICAgMVx0cGFja2FnZSBkYW8uaW1wbDtcbiAgICAgMlx0XG4gICAgIDNcdGltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXI7XG4gICAgIDRcdGltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLkVudGl0eVRyYW5zYWN0aW9uO1xuICAgICA1XHRpbXBvcnQgbG9tYm9rLkFsbEFyZ3NDb25zdHJ1Y3RvcjtcbiAgICAgNlx0aW1wb3J0IG1vZGVsLktodXllbk1haTtcbiAgICAgN1x0aW1wb3J0IHV0aWwuSlBBVXRpbDtcbiAgICAgOFx0XG4gICAgIDlcdGltcG9ydCBqYXZhLnNxbC5QcmVwYXJlZFN0YXRlbWVudDtcbiAgICAxMFx0aW1wb3J0IGphdmEuc3FsLlJlc3VsdFNldDtcbiAgICAxMVx0aW1wb3J0IGphdmEudGltZS5Mb2NhbERhdGU7XG4gICAgMTJcdGltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0O1xuICAgIDEzXHRpbXBvcnQgamF2YS51dGlsLkxpc3Q7XG4gICAgMTRcdFxuICAgIDE1XHRAQWxsQXJnc0NvbnN0cnVjdG9yXG4gICAgMTZcdHB1YmxpYyBjbGFzcyBLaHV5ZW5NYWlEQU9JbXBsIHtcbiAgICAxN1x0XG4gICAgMThcdCAgICBwcml2YXRlIEVudGl0eU1hbmFnZXIgZW07XG4gICAgMTlcdCAgICBwdWJsaWMgS2h1eWVuTWFpREFPSW1wbCgpIHtcbiAgICAyMFx0ICAgICAgICB0aGlzLmVtID0gSlBBVXRpbC5nZXRFbnRpdHlNYW5hZ2VyKCk7O1xuICAgIDIxXHQgICAgfVxuICAgIDIyXHQgICAgLy8gTOG6pXkgZGFuaCBzw6FjaCB04bqldCBj4bqjIGPDoWMga2h1eeG6v24gbcOjaVxuICAgIDIzXHQgICAgcHVibGljIExpc3Q8S2h1eWVuTWFpPiBmaW5kQWxsKCkge1xuICAgIDI0XHQgICAgICAgIFN0cmluZyBxdWVyeSA9IFwic2VsZWN0IGttIGZyb20gS2h1eWVuTWFpIGttXCI7XG4gICAgMjVcdCAgICAgICAgcmV0dXJuIGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5LCBLaHV5ZW5NYWkuY2xhc3MpLmdldFJlc3VsdExpc3QoKTtcbiAgICAyNlx0ICAgIH1cbiAgICAyN1x0XG4gICAgMjhcdCAgICAvLyBM4bqleSBkYW5oIHPDoWNoIGtodXnhur9uIG3Do2kgdGhlbyB0w6puXG4gICAgMjlcdCAgICBwdWJsaWMgTGlzdDxLaHV5ZW5NYWk+IGZpbmRCeU5hbWUoU3RyaW5nIG5hbWUpIHtcbiAgICAzMFx0ICAgICAgICBTdHJpbmcgcXVlcnkgPSBcInNlbGVjdCBrbSBmcm9tIEtodXllbk1haSBrbSB3aGVyZSBrbS50ZW5LTSBsaWtlIDpuYW1lXCI7XG4gICAgMzFcdCAgICAgICAgcmV0dXJuIGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5LCBLaHV5ZW5NYWkuY2xhc3MpXG4gICAgMzJcdCAgICAgICAgICAgICAgICAuc2V0UGFyYW1ldGVyKFwibmFtZVwiLCBcIiVcIiArIG5hbWUgKyBcIiVcIilcbiAgICAzM1x0ICAgICAgICAgICAgICAgIC5nZXRSZXN1bHRMaXN0KCk7XG4gICAgMzRcdCAgICB9XG4gICAgMzVcdFxuICAgIDM2XHQgICAgLy8gTOG6pXkga2h1eeG6v24gbcOjaSB0aGVvIG3Do1xuICAgIDM3XHQgICAgcHVibGljIEtodXllbk1haSBmaW5kQnlJZChTdHJpbmcgaWQpIHtcbiAgICAzOFx0ICAgICAgICByZXR1cm4gZW0uZmluZChLaHV5ZW5NYWkuY2xhc3MsIGlkKTtcbiAgICAzOVx0ICAgIH1cbiAgICA0MFx0XG4gICAgNDFcdCAgICAvLyBUaMOqbSBob+G6t2MgY+G6rXAgbmjhuq10IGtodXnhur9uIG3Do2lcbiAgICA0Mlx0ICAgIHB1YmxpYyBib29sZWFuIHNhdmUoS2h1eWVuTWFpIGtodXllbk1haSkge1xuICAgIDQzXHQgICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcbiAgICA0NFx0ICAgICAgICB0cnkge1xuICAgIDQ1XHQgICAgICAgICAgICB0ci5iZWdpbigpO1xuICAgIDQ2XHQgICAgICAgICAgICBpZiAoZW0uZmluZChLaHV5ZW5NYWkuY2xhc3MsIGtodXllbk1haS5nZXRNYUtNKCkpID09IG51bGwpIHtcbiAgICA0N1x0ICAgICAgICAgICAgICAgIGVtLnBlcnNpc3Qoa2h1eWVuTWFpKTsgLy8gVGjDqm0gbeG7m2lcbiAgICA0OFx0ICAgICAgICAgICAgfSBlbHNlIHtcbiAgICA0OVx0ICAgICAgICAgICAgICAgIGVtLm1lcmdlKGtodXllbk1haSk7IC8vIEPhuq1wIG5o4bqtdFxuICAgIDUwXHQgICAgICAgICAgICB9XG4gICAgNTFcdCAgICAgICAgICAgIHRyLmNvbW1pdCgpO1xuICAgIDUyXHQgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICA1M1x0ICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZXgpIHtcbiAgICA1NFx0ICAgICAgICAgICAgZXgucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgNTVcdCAgICAgICAgICAgIHRyLnJvbGxiYWNrKCk7XG4gICAgNTZcdCAgICAgICAgfVxuICAgIDU3XHQgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICA1OFx0ICAgIH1cbiAgICA1OVx0XG4gICAgNjBcdCAgICAvLyBYw7NhIGtodXnhur9uIG3Do2kgdGhlbyBtw6NcbiAgICA2MVx0ICAgIHB1YmxpYyBib29sZWFuIGRlbGV0ZShTdHJpbmcgaWQpIHtcbiAgICA2Mlx0ICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0ciA9IGVtLmdldFRyYW5zYWN0aW9uKCk7XG4gICAgNjNcdCAgICAgICAgdHJ5IHtcbiAgICA2NFx0ICAgICAgICAgICAgdHIuYmVnaW4oKTtcbiAgICA2NVx0ICAgICAgICAgICAgS2h1eWVuTWFpIGttID0gZW0uZmluZChLaHV5ZW5NYWkuY2xhc3MsIGlkKTtcbiAgICA2Nlx0ICAgICAgICAgICAgaWYgKGttICE9IG51bGwpIHtcbiAgICA2N1x0ICAgICAgICAgICAgICAgIGVtLnJlbW92ZShrbSk7XG4gICAgNjhcdCAgICAgICAgICAgICAgICB0ci5jb21taXQoKTtcbiAgICA2OVx0ICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgIDcwXHQgICAgICAgICAgICB9XG4gICAgNzFcdCAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGV4KSB7XG4gICAgNzJcdCAgICAgICAgICAgIGV4LnByaW50U3RhY2tUcmFjZSgpO1xuICAgIDczXHQgICAgICAgICAgICB0ci5yb2xsYmFjaygpO1xuICAgIDc0XHQgICAgICAgIH1cbiAgICA3NVx0ICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgNzZcdCAgICB9XG4gICAgNzdcdCAgICAvLyBUw6xtIGPDoWMga2h1eeG6v24gbcOjaSDEkWFuZyDDoXAgZOG7pW5nXG4gICAgNzhcdCAgICBwdWJsaWMgTGlzdDxLaHV5ZW5NYWk+IGZpbmRPbmdvaW5nUHJvbW90aW9ucygpIHtcbiAgICA3OVx0ICAgICAgICBTdHJpbmcgcXVlcnkgPSBcInNlbGVjdCBrbSBmcm9tIEtodXllbk1haSBrbSBcIiArXG4gICAgODBcdCAgICAgICAgICAgICAgICBcIndoZXJlIGttLnRyYW5nVGhhaSA9IDp0cmFuZ1RoYWkgXCIgK1xuICAgIDgxXHQgICAgICAgICAgICAgICAgXCJhbmQga20udGhvaUdpYW5CYXREYXUgPD0gOnRvZGF5IFwiICtcbiAgICA4Mlx0ICAgICAgICAgICAgICAgIFwiYW5kIGttLnRob2lHaWFuS2V0VGh1YyA+PSA6dG9kYXlcIjtcbiAgICA4M1x0XG4gICAgODRcdCAgICAgICAgcmV0dXJuIGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5LCBLaHV5ZW5NYWkuY2xhc3MpXG4gICAgODVcdCAgICAgICAgICAgICAgICAuc2V0UGFyYW1ldGVyKFwidHJhbmdUaGFpXCIsIFwixJBhbmcgZGnhu4VuIHJhXCIpXG4gICAgODZcdCAgICAgICAgICAgICAgICAuc2V0UGFyYW1ldGVyKFwidG9kYXlcIiwgTG9jYWxEYXRlLm5vdygpKVxuICAgIDg3XHQgICAgICAgICAgICAgICAgLmdldFJlc3VsdExpc3QoKTtcbiAgICA4OFx0ICAgIH1cbiAgICA4OVx0XG4gICAgOTBcdH1cbiAgICA5MVx0XG5Ub3RhbCBsaW5lcyBpbiBmaWxlOiA5MVxuIiwiaXNFcnJvciI6ZmFsc2UsInJlcXVlc3RJZCI6IiJ9fSwiMzNhNDRlY2YtM2RiYS00Yzc2LTkxZDctZDAzNDQ1NThiYzQ5O3Rvb2x1XzAxQXZhb3dib3hVWGk2UTVlR0Jqbjg4OCI6eyJwaGFzZSI6NiwicmVzdWx0Ijp7InRleHQiOiJJbnZhbGlkIHBhcmFtZXRlciBgc3RyX3JlcGxhY2VfZW50cmllc2AgZm9yIGBzdHJfcmVwbGFjZWAgY29tbWFuZC4gSXQgbXVzdCBiZSBhbiBhcnJheSBvZiBvYmplY3RzLiIsImlzRXJyb3IiOnRydWUsInJlcXVlc3RJZCI6IiJ9fSwiMGY1MzllMDEtZTE4Yi00MmEyLWI5NGQtNDY1NjJiMzI3MTIxO3Rvb2x1XzAxVkFydG12ekxzeE13SFY2clVtTE5COSI6eyJwaGFzZSI6NSwicmVzdWx0Ijp7InRleHQiOiJTdWNjZXNzZnVsbHkgZWRpdGVkIHRoZSBmaWxlIHNyYy9tYWluL2phdmEvZGFvL2ltcGwvS2h1eWVuTWFpREFPSW1wbC5qYXZhLlxuUmVzdWx0IGZvciBzdHJfcmVwbGFjZV9lbnRyaWVzWzBdOlxuUmVwbGFjZW1lbnQgc3VjY2Vzc2Z1bC5cbkVkaXRlZCBzZWN0aW9uIGFmdGVyIElERSBhdXRvLWZvcm1hdHRpbmcgd2FzIGFwcGxpZWQ6XG4gICAgIDFcdHBhY2thZ2UgZGFvLmltcGw7XG4gICAgIDJcdFxuICAgICAzXHRpbXBvcnQgZGFvLktodXllbk1haURBTztcbiAgICAgNFx0aW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuRW50aXR5TWFuYWdlcjtcbiAgICAgNVx0aW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuRW50aXR5VHJhbnNhY3Rpb247XG4gICAgIDZcdGltcG9ydCBsb21ib2suQWxsQXJnc0NvbnN0cnVjdG9yO1xuICAgICA3XHRpbXBvcnQgbW9kZWwuS2h1eWVuTWFpO1xuICAgICA4XHRpbXBvcnQgdXRpbC5KUEFVdGlsO1xuICAgICA5XHRcbiAgICAxMFx0aW1wb3J0IGphdmEucm1pLlJlbW90ZUV4Y2VwdGlvbjtcbiAgICAxMVx0aW1wb3J0IGphdmEucm1pLnNlcnZlci5VbmljYXN0UmVtb3RlT2JqZWN0O1xuICAgIDEyXHRpbXBvcnQgamF2YS50aW1lLkxvY2FsRGF0ZTtcbiAgICAxM1x0aW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7XG4gICAgMTRcdGltcG9ydCBqYXZhLnV0aWwuTGlzdDtcbiAgICAxNVx0XG4gICAgMTZcdEBBbGxBcmdzQ29uc3RydWN0b3JcbiAgICAxN1x0cHVibGljIGNsYXNzIEtodXllbk1haURBT0ltcGwgZXh0ZW5kcyBVbmljYXN0UmVtb3RlT2JqZWN0IGltcGxlbWVudHMgS2h1eWVuTWFpREFPIHtcbiAgICAxOFx0XG4gICAgMTlcdCAgICBwcml2YXRlIEVudGl0eU1hbmFnZXIgZW07XG4gICAgMjBcdFxuICAgIDIxXHQgICAgcHVibGljIEtodXllbk1haURBT0ltcGwoKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uIHtcbiAgICAyMlx0ICAgICAgICB0aGlzLmVtID0gSlBBVXRpbC5nZXRFbnRpdHlNYW5hZ2VyKCk7XG4gICAgMjNcdCAgICB9XG4gICAgMjRcdCAgICAvLyBM4bqleSBkYW5oIHPDoWNoIHThuqV0IGPhuqMgY8OhYyBraHV54bq/biBtw6NpXG4gICAgMjVcdCAgICBwdWJsaWMgTGlzdDxLaHV5ZW5NYWk+IGZpbmRBbGwoKSB7XG4gICAgMjZcdCAgICAgICAgU3RyaW5nIHF1ZXJ5ID0gXCJzZWxlY3Qga20gZnJvbSBLaHV5ZW5NYWkga21cIjtcbiAgICAyN1x0ICAgICAgICByZXR1cm4gZW0uY3JlYXRlUXVlcnkocXVlcnksIEtodXllbk1haS5jbGFzcykuZ2V0UmVzdWx0TGlzdCgpO1xuXG5SZXZpZXcgdGhlIGNoYW5nZXMgYW5kIG1ha2Ugc3VyZSB0aGV5IGFyZSBhcyBleHBlY3RlZCAoY29ycmVjdCBpbmRlbnRhdGlvbiwgbm8gZHVwbGljYXRlIGxpbmVzLCBldGMpLlxuRWRpdCB0aGUgZmlsZSBhZ2FpbiBpZiBuZWNlc3NhcnkuXG4iLCJpc0Vycm9yIjpmYWxzZSwicmVxdWVzdElkIjoiIn19LCI0ZjMwMGExYy01MDk5LTQ4NjctOGY2NS00Nzk0NzFiY2YxN2E7dG9vbHVfMDFFR2Z5UzNvYzdRenZmakRtVHFtQmIxIjp7InBoYXNlIjo1LCJyZXN1bHQiOnsidGV4dCI6IlN1Y2Nlc3NmdWxseSBlZGl0ZWQgdGhlIGZpbGUgc3JjL21haW4vamF2YS9kYW8vaW1wbC9LaHV5ZW5NYWlEQU9JbXBsLmphdmEuXG5SZXN1bHQgZm9yIHN0cl9yZXBsYWNlX2VudHJpZXNbMF06XG5SZXBsYWNlbWVudCBzdWNjZXNzZnVsLlxuRWRpdGVkIHNlY3Rpb24gYWZ0ZXIgSURFIGF1dG8tZm9ybWF0dGluZyB3YXMgYXBwbGllZDpcbiAgICAyMFx0XG4gICAgMjFcdCAgICBwdWJsaWMgS2h1eWVuTWFpREFPSW1wbCgpIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xuICAgIDIyXHQgICAgICAgIHRoaXMuZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcbiAgICAyM1x0ICAgIH1cbiAgICAyNFx0ICAgIC8vIEzhuqV5IGRhbmggc8OhY2ggdOG6pXQgY+G6oyBjw6FjIGtodXnhur9uIG3Do2lcbiAgICAyNVx0ICAgIEBPdmVycmlkZVxuICAgIDI2XHQgICAgcHVibGljIExpc3Q8S2h1eWVuTWFpPiBmaW5kQWxsKCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgMjdcdCAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IEpQQVV0aWwuZ2V0RW50aXR5TWFuYWdlcigpO1xuICAgIDI4XHQgICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHR4ID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcbiAgICAyOVx0ICAgICAgICBMaXN0PEtodXllbk1haT4gcmVzdWx0ID0gbmV3IEFycmF5TGlzdDw+KCk7XG4gICAgMzBcdFxuICAgIDMxXHQgICAgICAgIHRyeSB7XG4gICAgMzJcdCAgICAgICAgICAgIHR4LmJlZ2luKCk7XG4gICAgMzNcdCAgICAgICAgICAgIFN0cmluZyBxdWVyeSA9IFwic2VsZWN0IGttIGZyb20gS2h1eWVuTWFpIGttXCI7XG4gICAgMzRcdCAgICAgICAgICAgIHJlc3VsdCA9IGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5LCBLaHV5ZW5NYWkuY2xhc3MpLmdldFJlc3VsdExpc3QoKTtcbiAgICAzNVx0ICAgICAgICAgICAgdHguY29tbWl0KCk7XG4gICAgMzZcdCAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAzN1x0ICAgICAgICAgICAgaWYgKHR4LmlzQWN0aXZlKCkpIHtcbiAgICAzOFx0ICAgICAgICAgICAgICAgIHR4LnJvbGxiYWNrKCk7XG4gICAgMzlcdCAgICAgICAgICAgIH1cbiAgICA0MFx0ICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICA0MVx0ICAgICAgICAgICAgdGhyb3cgbmV3IFJlbW90ZUV4Y2VwdGlvbihcIkzhu5dpIGtoaSBs4bqleSBkYW5oIHPDoWNoIGtodXnhur9uIG3Do2lcIiwgZSk7XG4gICAgNDJcdCAgICAgICAgfSBmaW5hbGx5IHtcbiAgICA0M1x0ICAgICAgICAgICAgaWYgKGVtICE9IG51bGwgJiYgZW0uaXNPcGVuKCkpIHtcbiAgICA0NFx0ICAgICAgICAgICAgICAgIGVtLmNsb3NlKCk7XG4gICAgNDVcdCAgICAgICAgICAgIH1cbiAgICA0Nlx0ICAgICAgICB9XG4gICAgNDdcdCAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICA0OFx0ICAgIH1cbiAgICA0OVx0XG4gICAgNTBcdCAgICAvLyBM4bqleSBkYW5oIHPDoWNoIGtodXnhur9uIG3Do2kgdGhlbyB0w6puXG4gICAgNTFcdCAgICBwdWJsaWMgTGlzdDxLaHV5ZW5NYWk+IGZpbmRCeU5hbWUoU3RyaW5nIG5hbWUpIHtcbiAgICA1Mlx0ICAgICAgICBTdHJpbmcgcXVlcnkgPSBcInNlbGVjdCBrbSBmcm9tIEtodXllbk1haSBrbSB3aGVyZSBrbS50ZW5LTSBsaWtlIDpuYW1lXCI7XG5cblJldmlldyB0aGUgY2hhbmdlcyBhbmQgbWFrZSBzdXJlIHRoZXkgYXJlIGFzIGV4cGVjdGVkIChjb3JyZWN0IGluZGVudGF0aW9uLCBubyBkdXBsaWNhdGUgbGluZXMsIGV0YykuXG5FZGl0IHRoZSBmaWxlIGFnYWluIGlmIG5lY2Vzc2FyeS5cbiIsImlzRXJyb3IiOmZhbHNlLCJyZXF1ZXN0SWQiOiIifX0sImE5ZDFiMDEzLWUyNDAtNGE2OC05MjhmLWI2M2ZiNWEzNTNiOTt0b29sdV8wMUhWY0hQZGRzc05YeTExU0dtV3VFbUMiOnsicGhhc2UiOjUsInJlc3VsdCI6eyJ0ZXh0IjoiU3VjY2Vzc2Z1bGx5IGVkaXRlZCB0aGUgZmlsZSBzcmMvbWFpbi9qYXZhL2Rhby9pbXBsL0todXllbk1haURBT0ltcGwuamF2YS5cblJlc3VsdCBmb3Igc3RyX3JlcGxhY2VfZW50cmllc1swXTpcblJlcGxhY2VtZW50IHN1Y2Nlc3NmdWwuXG5FZGl0ZWQgc2VjdGlvbiBhZnRlciBJREUgYXV0by1mb3JtYXR0aW5nIHdhcyBhcHBsaWVkOlxuICAgIDQ2XHQgICAgICAgIH1cbiAgICA0N1x0ICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIDQ4XHQgICAgfVxuICAgIDQ5XHRcbiAgICA1MFx0ICAgIC8vIEzhuqV5IGRhbmggc8OhY2gga2h1eeG6v24gbcOjaSB0aGVvIHTDqm5cbiAgICA1MVx0ICAgIEBPdmVycmlkZVxuICAgIDUyXHQgICAgcHVibGljIExpc3Q8S2h1eWVuTWFpPiBmaW5kQnlOYW1lKFN0cmluZyBuYW1lKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uIHtcbiAgICA1M1x0ICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gSlBBVXRpbC5nZXRFbnRpdHlNYW5hZ2VyKCk7XG4gICAgNTRcdCAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHggPSBlbS5nZXRUcmFuc2FjdGlvbigpO1xuICAgIDU1XHQgICAgICAgIExpc3Q8S2h1eWVuTWFpPiByZXN1bHQgPSBuZXcgQXJyYXlMaXN0PD4oKTtcbiAgICA1Nlx0XG4gICAgNTdcdCAgICAgICAgdHJ5IHtcbiAgICA1OFx0ICAgICAgICAgICAgdHguYmVnaW4oKTtcbiAgICA1OVx0ICAgICAgICAgICAgU3RyaW5nIHF1ZXJ5ID0gXCJzZWxlY3Qga20gZnJvbSBLaHV5ZW5NYWkga20gd2hlcmUga20udGVuS00gbGlrZSA6bmFtZVwiO1xuICAgIDYwXHQgICAgICAgICAgICByZXN1bHQgPSBlbS5jcmVhdGVRdWVyeShxdWVyeSwgS2h1eWVuTWFpLmNsYXNzKVxuICAgIDYxXHQgICAgICAgICAgICAgICAgICAgIC5zZXRQYXJhbWV0ZXIoXCJuYW1lXCIsIFwiJVwiICsgbmFtZSArIFwiJVwiKVxuICAgIDYyXHQgICAgICAgICAgICAgICAgICAgIC5nZXRSZXN1bHRMaXN0KCk7XG4gICAgNjNcdCAgICAgICAgICAgIHR4LmNvbW1pdCgpO1xuICAgIDY0XHQgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgNjVcdCAgICAgICAgICAgIGlmICh0eC5pc0FjdGl2ZSgpKSB7XG4gICAgNjZcdCAgICAgICAgICAgICAgICB0eC5yb2xsYmFjaygpO1xuICAgIDY3XHQgICAgICAgICAgICB9XG4gICAgNjhcdCAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgNjlcdCAgICAgICAgICAgIHRocm93IG5ldyBSZW1vdGVFeGNlcHRpb24oXCJM4buXaSBraGkgdMOsbSBraHV54bq/biBtw6NpIHRoZW8gdMOqblwiLCBlKTtcbiAgICA3MFx0ICAgICAgICB9IGZpbmFsbHkge1xuICAgIDcxXHQgICAgICAgICAgICBpZiAoZW0gIT0gbnVsbCAmJiBlbS5pc09wZW4oKSkge1xuICAgIDcyXHQgICAgICAgICAgICAgICAgZW0uY2xvc2UoKTtcbiAgICA3M1x0ICAgICAgICAgICAgfVxuICAgIDc0XHQgICAgICAgIH1cbiAgICA3NVx0ICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIDc2XHQgICAgfVxuICAgIDc3XHRcbiAgICA3OFx0ICAgIC8vIEzhuqV5IGtodXnhur9uIG3Do2kgdGhlbyBtw6NcbiAgICA3OVx0ICAgIHB1YmxpYyBLaHV5ZW5NYWkgZmluZEJ5SWQoU3RyaW5nIGlkKSB7XG4gICAgODBcdCAgICAgICAgcmV0dXJuIGVtLmZpbmQoS2h1eWVuTWFpLmNsYXNzLCBpZCk7XG5cblJldmlldyB0aGUgY2hhbmdlcyBhbmQgbWFrZSBzdXJlIHRoZXkgYXJlIGFzIGV4cGVjdGVkIChjb3JyZWN0IGluZGVudGF0aW9uLCBubyBkdXBsaWNhdGUgbGluZXMsIGV0YykuXG5FZGl0IHRoZSBmaWxlIGFnYWluIGlmIG5lY2Vzc2FyeS5cbiIsImlzRXJyb3IiOmZhbHNlLCJyZXF1ZXN0SWQiOiIifX0sIjlmNDc3NTJjLTg1NzktNDkwMy04Y2Y4LWRhZmYwZDI3MjhhNjt0b29sdV8wMTlKbVU4S25tWnJ0aEpYRnV0a0dwNjEiOnsicGhhc2UiOjUsInJlc3VsdCI6eyJ0ZXh0IjoiU3VjY2Vzc2Z1bGx5IGVkaXRlZCB0aGUgZmlsZSBzcmMvbWFpbi9qYXZhL2Rhby9pbXBsL0todXllbk1haURBT0ltcGwuamF2YS5cblJlc3VsdCBmb3Igc3RyX3JlcGxhY2VfZW50cmllc1swXTpcblJlcGxhY2VtZW50IHN1Y2Nlc3NmdWwuXG5FZGl0ZWQgc2VjdGlvbiBhZnRlciBJREUgYXV0by1mb3JtYXR0aW5nIHdhcyBhcHBsaWVkOlxuICAgIDc0XHQgICAgICAgIH1cbiAgICA3NVx0ICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIDc2XHQgICAgfVxuICAgIDc3XHRcbiAgICA3OFx0ICAgIC8vIEzhuqV5IGtodXnhur9uIG3Do2kgdGhlbyBtw6NcbiAgICA3OVx0ICAgIEBPdmVycmlkZVxuICAgIDgwXHQgICAgcHVibGljIEtodXllbk1haSBmaW5kQnlJZChTdHJpbmcgaWQpIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xuICAgIDgxXHQgICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcbiAgICA4Mlx0ICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0eCA9IGVtLmdldFRyYW5zYWN0aW9uKCk7XG4gICAgODNcdCAgICAgICAgS2h1eWVuTWFpIHJlc3VsdCA9IG51bGw7XG4gICAgODRcdFxuICAgIDg1XHQgICAgICAgIHRyeSB7XG4gICAgODZcdCAgICAgICAgICAgIHR4LmJlZ2luKCk7XG4gICAgODdcdCAgICAgICAgICAgIHJlc3VsdCA9IGVtLmZpbmQoS2h1eWVuTWFpLmNsYXNzLCBpZCk7XG4gICAgODhcdCAgICAgICAgICAgIHR4LmNvbW1pdCgpO1xuICAgIDg5XHQgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgOTBcdCAgICAgICAgICAgIGlmICh0eC5pc0FjdGl2ZSgpKSB7XG4gICAgOTFcdCAgICAgICAgICAgICAgICB0eC5yb2xsYmFjaygpO1xuICAgIDkyXHQgICAgICAgICAgICB9XG4gICAgOTNcdCAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgOTRcdCAgICAgICAgICAgIHRocm93IG5ldyBSZW1vdGVFeGNlcHRpb24oXCJM4buXaSBraGkgdMOsbSBraHV54bq/biBtw6NpIHRoZW8gbcOjXCIsIGUpO1xuICAgIDk1XHQgICAgICAgIH0gZmluYWxseSB7XG4gICAgOTZcdCAgICAgICAgICAgIGlmIChlbSAhPSBudWxsICYmIGVtLmlzT3BlbigpKSB7XG4gICAgOTdcdCAgICAgICAgICAgICAgICBlbS5jbG9zZSgpO1xuICAgIDk4XHQgICAgICAgICAgICB9XG4gICAgOTlcdCAgICAgICAgfVxuICAgMTAwXHQgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAxMDFcdCAgICB9XG4gICAxMDJcdFxuICAgMTAzXHQgICAgLy8gVGjDqm0gaG/hurdjIGPhuq1wIG5o4bqtdCBraHV54bq/biBtw6NpXG4gICAxMDRcdCAgICBwdWJsaWMgYm9vbGVhbiBzYXZlKEtodXllbk1haSBraHV5ZW5NYWkpIHtcbiAgIDEwNVx0ICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0ciA9IGVtLmdldFRyYW5zYWN0aW9uKCk7XG5cblJldmlldyB0aGUgY2hhbmdlcyBhbmQgbWFrZSBzdXJlIHRoZXkgYXJlIGFzIGV4cGVjdGVkIChjb3JyZWN0IGluZGVudGF0aW9uLCBubyBkdXBsaWNhdGUgbGluZXMsIGV0YykuXG5FZGl0IHRoZSBmaWxlIGFnYWluIGlmIG5lY2Vzc2FyeS5cbiIsImlzRXJyb3IiOmZhbHNlLCJyZXF1ZXN0SWQiOiIifX0sIjBhZjI0YTBlLTI1ZGYtNDJhOS04YzU4LTk0NWIyYWU4ZmMyODt0b29sdV8wMUpEUjZBQTluVTVFU045UmtHa3lwcnYiOnsicGhhc2UiOjUsInJlc3VsdCI6eyJ0ZXh0IjoiU3VjY2Vzc2Z1bGx5IGVkaXRlZCB0aGUgZmlsZSBzcmMvbWFpbi9qYXZhL2Rhby9pbXBsL0todXllbk1haURBT0ltcGwuamF2YS5cblJlc3VsdCBmb3Igc3RyX3JlcGxhY2VfZW50cmllc1swXTpcblJlcGxhY2VtZW50IHN1Y2Nlc3NmdWwuXG5FZGl0ZWQgc2VjdGlvbiBhZnRlciBJREUgYXV0by1mb3JtYXR0aW5nIHdhcyBhcHBsaWVkOlxuICAgIDk5XHQgICAgICAgIH1cbiAgIDEwMFx0ICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgMTAxXHQgICAgfVxuICAgMTAyXHRcbiAgIDEwM1x0ICAgIC8vIFRow6ptIGhv4bq3YyBj4bqtcCBuaOG6rXQga2h1eeG6v24gbcOjaVxuICAgMTA0XHQgICAgQE92ZXJyaWRlXG4gICAxMDVcdCAgICBwdWJsaWMgYm9vbGVhbiBzYXZlKEtodXllbk1haSBraHV5ZW5NYWkpIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xuICAgMTA2XHQgICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcbiAgIDEwN1x0ICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0eCA9IGVtLmdldFRyYW5zYWN0aW9uKCk7XG4gICAxMDhcdFxuICAgMTA5XHQgICAgICAgIHRyeSB7XG4gICAxMTBcdCAgICAgICAgICAgIHR4LmJlZ2luKCk7XG4gICAxMTFcdCAgICAgICAgICAgIGlmIChlbS5maW5kKEtodXllbk1haS5jbGFzcywga2h1eWVuTWFpLmdldE1hS00oKSkgPT0gbnVsbCkge1xuICAgMTEyXHQgICAgICAgICAgICAgICAgZW0ucGVyc2lzdChraHV5ZW5NYWkpOyAvLyBUaMOqbSBt4bubaVxuICAgMTEzXHQgICAgICAgICAgICB9IGVsc2Uge1xuICAgMTE0XHQgICAgICAgICAgICAgICAgZW0ubWVyZ2Uoa2h1eWVuTWFpKTsgLy8gQ+G6rXAgbmjhuq10XG4gICAxMTVcdCAgICAgICAgICAgIH1cbiAgIDExNlx0ICAgICAgICAgICAgdHguY29tbWl0KCk7XG4gICAxMTdcdCAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgMTE4XHQgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAxMTlcdCAgICAgICAgICAgIGlmICh0eC5pc0FjdGl2ZSgpKSB7XG4gICAxMjBcdCAgICAgICAgICAgICAgICB0eC5yb2xsYmFjaygpO1xuICAgMTIxXHQgICAgICAgICAgICB9XG4gICAxMjJcdCAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAxMjNcdCAgICAgICAgICAgIHRocm93IG5ldyBSZW1vdGVFeGNlcHRpb24oXCJM4buXaSBraGkgbMawdSBraHV54bq/biBtw6NpXCIsIGUpO1xuICAgMTI0XHQgICAgICAgIH0gZmluYWxseSB7XG4gICAxMjVcdCAgICAgICAgICAgIGlmIChlbSAhPSBudWxsICYmIGVtLmlzT3BlbigpKSB7XG4gICAxMjZcdCAgICAgICAgICAgICAgICBlbS5jbG9zZSgpO1xuICAgMTI3XHQgICAgICAgICAgICB9XG4gICAxMjhcdCAgICAgICAgfVxuICAgMTI5XHQgICAgfVxuICAgMTMwXHRcbiAgIDEzMVx0ICAgIC8vIFjDs2Ega2h1eeG6v24gbcOjaSB0aGVvIG3Do1xuICAgMTMyXHQgICAgcHVibGljIGJvb2xlYW4gZGVsZXRlKFN0cmluZyBpZCkge1xuICAgMTMzXHQgICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcblxuUmV2aWV3IHRoZSBjaGFuZ2VzIGFuZCBtYWtlIHN1cmUgdGhleSBhcmUgYXMgZXhwZWN0ZWQgKGNvcnJlY3QgaW5kZW50YXRpb24sIG5vIGR1cGxpY2F0ZSBsaW5lcywgZXRjKS5cbkVkaXQgdGhlIGZpbGUgYWdhaW4gaWYgbmVjZXNzYXJ5LlxuIiwiaXNFcnJvciI6ZmFsc2UsInJlcXVlc3RJZCI6IiJ9fSwiMzUyZmY5MGItNzU1Yy00ZGExLTlkMzUtZDM2ZDZjYTQ2YTFjO3Rvb2x1XzAxUFlZTUMzaVp5RnNVZGdqamk3akxFbyI6eyJwaGFzZSI6NSwicmVzdWx0Ijp7InRleHQiOiJTdWNjZXNzZnVsbHkgZWRpdGVkIHRoZSBmaWxlIHNyYy9tYWluL2phdmEvZGFvL2ltcGwvS2h1eWVuTWFpREFPSW1wbC5qYXZhLlxuUmVzdWx0IGZvciBzdHJfcmVwbGFjZV9lbnRyaWVzWzBdOlxuUmVwbGFjZW1lbnQgc3VjY2Vzc2Z1bC5cbkVkaXRlZCBzZWN0aW9uIGFmdGVyIElERSBhdXRvLWZvcm1hdHRpbmcgd2FzIGFwcGxpZWQ6XG4gICAxMjdcdCAgICAgICAgICAgIH1cbiAgIDEyOFx0ICAgICAgICB9XG4gICAxMjlcdCAgICB9XG4gICAxMzBcdFxuICAgMTMxXHQgICAgLy8gWMOzYSBraHV54bq/biBtw6NpIHRoZW8gbcOjXG4gICAxMzJcdCAgICBAT3ZlcnJpZGVcbiAgIDEzM1x0ICAgIHB1YmxpYyBib29sZWFuIGRlbGV0ZShTdHJpbmcgaWQpIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xuICAgMTM0XHQgICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcbiAgIDEzNVx0ICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0eCA9IGVtLmdldFRyYW5zYWN0aW9uKCk7XG4gICAxMzZcdFxuICAgMTM3XHQgICAgICAgIHRyeSB7XG4gICAxMzhcdCAgICAgICAgICAgIHR4LmJlZ2luKCk7XG4gICAxMzlcdCAgICAgICAgICAgIEtodXllbk1haSBrbSA9IGVtLmZpbmQoS2h1eWVuTWFpLmNsYXNzLCBpZCk7XG4gICAxNDBcdCAgICAgICAgICAgIGlmIChrbSAhPSBudWxsKSB7XG4gICAxNDFcdCAgICAgICAgICAgICAgICBlbS5yZW1vdmUoa20pO1xuICAgMTQyXHQgICAgICAgICAgICAgICAgdHguY29tbWl0KCk7XG4gICAxNDNcdCAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgIDE0NFx0ICAgICAgICAgICAgfVxuICAgMTQ1XHQgICAgICAgICAgICB0eC5jb21taXQoKTtcbiAgIDE0Nlx0ICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgMTQ3XHQgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAxNDhcdCAgICAgICAgICAgIGlmICh0eC5pc0FjdGl2ZSgpKSB7XG4gICAxNDlcdCAgICAgICAgICAgICAgICB0eC5yb2xsYmFjaygpO1xuICAgMTUwXHQgICAgICAgICAgICB9XG4gICAxNTFcdCAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAxNTJcdCAgICAgICAgICAgIHRocm93IG5ldyBSZW1vdGVFeGNlcHRpb24oXCJM4buXaSBraGkgeMOzYSBraHV54bq/biBtw6NpXCIsIGUpO1xuICAgMTUzXHQgICAgICAgIH0gZmluYWxseSB7XG4gICAxNTRcdCAgICAgICAgICAgIGlmIChlbSAhPSBudWxsICYmIGVtLmlzT3BlbigpKSB7XG4gICAxNTVcdCAgICAgICAgICAgICAgICBlbS5jbG9zZSgpO1xuICAgMTU2XHQgICAgICAgICAgICB9XG4gICAxNTdcdCAgICAgICAgfVxuICAgMTU4XHQgICAgfVxuICAgMTU5XHQgICAgLy8gVMOsbSBjw6FjIGtodXnhur9uIG3Do2kgxJFhbmcgw6FwIGThu6VuZ1xuICAgMTYwXHQgICAgcHVibGljIExpc3Q8S2h1eWVuTWFpPiBmaW5kT25nb2luZ1Byb21vdGlvbnMoKSB7XG4gICAxNjFcdCAgICAgICAgU3RyaW5nIHF1ZXJ5ID0gXCJzZWxlY3Qga20gZnJvbSBLaHV5ZW5NYWkga20gXCIgK1xuICAgMTYyXHQgICAgICAgICAgICAgICAgXCJ3aGVyZSBrbS50cmFuZ1RoYWkgPSA6dHJhbmdUaGFpIFwiICtcblxuUmV2aWV3IHRoZSBjaGFuZ2VzIGFuZCBtYWtlIHN1cmUgdGhleSBhcmUgYXMgZXhwZWN0ZWQgKGNvcnJlY3QgaW5kZW50YXRpb24sIG5vIGR1cGxpY2F0ZSBsaW5lcywgZXRjKS5cbkVkaXQgdGhlIGZpbGUgYWdhaW4gaWYgbmVjZXNzYXJ5LlxuIiwiaXNFcnJvciI6ZmFsc2UsInJlcXVlc3RJZCI6IiJ9fSwiOTg0YzFkMjgtMjEzNS00MTkwLWJmNjQtZjc5OGFmOTVhZmQ3O3Rvb2x1XzAxRkE1V0ZlNWlFcTFYQzVFNGdnclVORiI6eyJwaGFzZSI6NSwicmVzdWx0Ijp7InRleHQiOiJTdWNjZXNzZnVsbHkgZWRpdGVkIHRoZSBmaWxlIHNyYy9tYWluL2phdmEvZGFvL2ltcGwvS2h1eWVuTWFpREFPSW1wbC5qYXZhLlxuUmVzdWx0IGZvciBzdHJfcmVwbGFjZV9lbnRyaWVzWzBdOlxuUmVwbGFjZW1lbnQgc3VjY2Vzc2Z1bC5cbkVkaXRlZCBzZWN0aW9uIGFmdGVyIElERSBhdXRvLWZvcm1hdHRpbmcgd2FzIGFwcGxpZWQ6XG4gICAxNTVcdCAgICAgICAgICAgICAgICBlbS5jbG9zZSgpO1xuICAgMTU2XHQgICAgICAgICAgICB9XG4gICAxNTdcdCAgICAgICAgfVxuICAgMTU4XHQgICAgfVxuICAgMTU5XHQgICAgLy8gVMOsbSBjw6FjIGtodXnhur9uIG3Do2kgxJFhbmcgw6FwIGThu6VuZ1xuICAgMTYwXHQgICAgQE92ZXJyaWRlXG4gICAxNjFcdCAgICBwdWJsaWMgTGlzdDxLaHV5ZW5NYWk+IGZpbmRPbmdvaW5nUHJvbW90aW9ucygpIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xuICAgMTYyXHQgICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcbiAgIDE2M1x0ICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0eCA9IGVtLmdldFRyYW5zYWN0aW9uKCk7XG4gICAxNjRcdCAgICAgICAgTGlzdDxLaHV5ZW5NYWk+IHJlc3VsdCA9IG5ldyBBcnJheUxpc3Q8PigpO1xuICAgMTY1XHRcbiAgIDE2Nlx0ICAgICAgICB0cnkge1xuICAgMTY3XHQgICAgICAgICAgICB0eC5iZWdpbigpO1xuICAgMTY4XHQgICAgICAgICAgICBTdHJpbmcgcXVlcnkgPSBcInNlbGVjdCBrbSBmcm9tIEtodXllbk1haSBrbSBcIiArXG4gICAxNjlcdCAgICAgICAgICAgICAgICAgICAgXCJ3aGVyZSBrbS50cmFuZ1RoYWkgPSA6dHJhbmdUaGFpIFwiICtcbiAgIDE3MFx0ICAgICAgICAgICAgICAgICAgICBcImFuZCBrbS50aG9pR2lhbkJhdERhdSA8PSA6dG9kYXkgXCIgK1xuICAgMTcxXHQgICAgICAgICAgICAgICAgICAgIFwiYW5kIGttLnRob2lHaWFuS2V0VGh1YyA+PSA6dG9kYXlcIjtcbiAgIDE3Mlx0XG4gICAxNzNcdCAgICAgICAgICAgIHJlc3VsdCA9IGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5LCBLaHV5ZW5NYWkuY2xhc3MpXG4gICAxNzRcdCAgICAgICAgICAgICAgICAgICAgLnNldFBhcmFtZXRlcihcInRyYW5nVGhhaVwiLCBcIsSQYW5nIGRp4buFbiByYVwiKVxuICAgMTc1XHQgICAgICAgICAgICAgICAgICAgIC5zZXRQYXJhbWV0ZXIoXCJ0b2RheVwiLCBMb2NhbERhdGUubm93KCkpXG4gICAxNzZcdCAgICAgICAgICAgICAgICAgICAgLmdldFJlc3VsdExpc3QoKTtcbiAgIDE3N1x0ICAgICAgICAgICAgdHguY29tbWl0KCk7XG4gICAxNzhcdCAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgIDE3OVx0ICAgICAgICAgICAgaWYgKHR4LmlzQWN0aXZlKCkpIHtcbiAgIDE4MFx0ICAgICAgICAgICAgICAgIHR4LnJvbGxiYWNrKCk7XG4gICAxODFcdCAgICAgICAgICAgIH1cbiAgIDE4Mlx0ICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgIDE4M1x0ICAgICAgICAgICAgdGhyb3cgbmV3IFJlbW90ZUV4Y2VwdGlvbihcIkzhu5dpIGtoaSB0w6xtIGtodXnhur9uIG3Do2kgxJFhbmcgw6FwIGThu6VuZ1wiLCBlKTtcbiAgIDE4NFx0ICAgICAgICB9IGZpbmFsbHkge1xuICAgMTg1XHQgICAgICAgICAgICBpZiAoZW0gIT0gbnVsbCAmJiBlbS5pc09wZW4oKSkge1xuICAgMTg2XHQgICAgICAgICAgICAgICAgZW0uY2xvc2UoKTtcbiAgIDE4N1x0ICAgICAgICAgICAgfVxuICAgMTg4XHQgICAgICAgIH1cbiAgIDE4OVx0ICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgMTkwXHQgICAgfVxuICAgMTkxXHRcbiAgIDE5Mlx0ICAgIEBPdmVycmlkZVxuICAgMTkzXHQgICAgcHVibGljIGJvb2xlYW4gdGVzdENvbm5lY3Rpb24oKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uIHtcbiAgIDE5NFx0ICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gSlBBVXRpbC5nZXRFbnRpdHlNYW5hZ2VyKCk7XG4gICAxOTVcdCAgICAgICAgdHJ5IHtcbiAgIDE5Nlx0ICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpO1xuICAgMTk3XHQgICAgICAgICAgICBlbS5jcmVhdGVRdWVyeShcIlNFTEVDVCAxXCIpLmdldFJlc3VsdExpc3QoKTtcbiAgIDE5OFx0ICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTtcbiAgIDE5OVx0ICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAyMDBcdCAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgIDIwMVx0ICAgICAgICAgICAgaWYgKGVtLmdldFRyYW5zYWN0aW9uKCkuaXNBY3RpdmUoKSkge1xuICAgMjAyXHQgICAgICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5yb2xsYmFjaygpO1xuICAgMjAzXHQgICAgICAgICAgICB9XG4gICAyMDRcdCAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAyMDVcdCAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgIDIwNlx0ICAgICAgICB9IGZpbmFsbHkge1xuICAgMjA3XHQgICAgICAgICAgICBpZiAoZW0gIT0gbnVsbCAmJiBlbS5pc09wZW4oKSkge1xuICAgMjA4XHQgICAgICAgICAgICAgICAgZW0uY2xvc2UoKTtcbiAgIDIwOVx0ICAgICAgICAgICAgfVxuICAgMjEwXHQgICAgICAgIH1cbiAgIDIxMVx0ICAgIH1cbiAgIDIxMlx0XG4gICAyMTNcdH1cbiAgIDIxNFx0XG5cblJldmlldyB0aGUgY2hhbmdlcyBhbmQgbWFrZSBzdXJlIHRoZXkgYXJlIGFzIGV4cGVjdGVkIChjb3JyZWN0IGluZGVudGF0aW9uLCBubyBkdXBsaWNhdGUgbGluZXMsIGV0YykuXG5FZGl0IHRoZSBmaWxlIGFnYWluIGlmIG5lY2Vzc2FyeS5cbiIsImlzRXJyb3IiOmZhbHNlLCJyZXF1ZXN0SWQiOiIifX0sIjIzNTllMWU3LTVkMDktNDlkYy1iNzlhLTA3YjJjMzMzNWNlNDt0b29sdV8wMUVrdkpIcUVwbnlYalE5V1BSQkY4MmYiOnsicGhhc2UiOjYsInJlc3VsdCI6eyJ0ZXh0IjoiRmFpbGVkIHRvIGVkaXQgdGhlIGZpbGUgc3JjL21haW4vamF2YS9tb2RlbC9Eb2lUdW9uZ0FwRHVuZy5qYXZhLiBTZWUgYmVsb3cgZm9yIGRldGFpbHMuXG5SZXN1bHQgZm9yIHN0cl9yZXBsYWNlX2VudHJpZXNbMF06XG5ObyByZXBsYWNlbWVudCB3YXMgcGVyZm9ybWVkLCBvbGRTdHIgZGlkIG5vdCBhcHBlYXIgdmVyYmF0aW0gaW4gc3JjL21haW4vamF2YS9tb2RlbC9Eb2lUdW9uZ0FwRHVuZy5qYXZhLlxuVGhlIGNvbnRlbnQgaW4gdGhlIHNwZWNpZmllZCByZWdpb24gaXM6XG4gICAgIDFcdHBhY2thZ2UgbW9kZWw7XG4gICAgIDJcdFxuICAgICAzXHRwdWJsaWMgZW51bSBEb2lUdW9uZ0FwRHVuZyB7XG4gICAgIDRcdCAgICBBTEwoXCJU4bqldCBj4bqjXCIpLFxuICAgICA1XHQgICAgQ09VUE9OKFwiY291cG9uXCIpO1xuICAgICA2XHRcbiAgICAgN1x0ICAgIHByaXZhdGUgZmluYWwgU3RyaW5nIHZhbHVlO1xuXG5EaWZmIGJldHdlZW4gb2xkU3RyIGFuZCB0aGUgc3BlY2lmaWVkIHJlZ2lvbiBpczpcbj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi0tLSBvbGRTdHJcbisrKyByZWdpb25Db250ZW50XG5AQCAtMSw0ICsxLDMgQEBcbiBwYWNrYWdlIG1vZGVsO1xuIFxuIHB1YmxpYyBlbnVtIERvaVR1b25nQXBEdW5nIHtcbi19XG5cblxuRml4IGZhaWxlZCBzdHJfcmVwbGFjZV9lbnRyaWVzIGFjY29yZGluZ2x5IGFuZCB0cnkgYWdhaW4uXG4iLCJpc0Vycm9yIjp0cnVlLCJyZXF1ZXN0SWQiOiIifX0sIjMzYTEwMDc2LWM0ZTgtNDcwZC1hZjNhLTNjOGNiNGQyOTUwMjt0b29sdV8wMUZybzFiZnZaaUpHVFJ1VWE2RWF3U1QiOnsicGhhc2UiOjUsInJlc3VsdCI6eyJ0ZXh0IjoiSGVyZSdzIHRoZSByZXN1bHQgb2YgcnVubmluZyBgY2F0IC1uYCBvbiBzcmMvbWFpbi9qYXZhL21vZGVsL0RvaVR1b25nQXBEdW5nLmphdmE6XG4gICAgIDFcdHBhY2thZ2UgbW9kZWw7XG4gICAgIDJcdFxuICAgICAzXHRwdWJsaWMgZW51bSBEb2lUdW9uZ0FwRHVuZyB7XG4gICAgIDRcdCAgICBBTEwoXCJU4bqldCBj4bqjXCIpLFxuICAgICA1XHQgICAgQ09VUE9OKFwiY291cG9uXCIpO1xuICAgICA2XHRcbiAgICAgN1x0ICAgIHByaXZhdGUgZmluYWwgU3RyaW5nIHZhbHVlO1xuICAgICA4XHRcbiAgICAgOVx0ICAgIERvaVR1b25nQXBEdW5nKFN0cmluZyB2YWx1ZSkge1xuICAgIDEwXHQgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAxMVx0ICAgIH1cbiAgICAxMlx0XG4gICAgMTNcdCAgICBwdWJsaWMgU3RyaW5nIGdldFZhbHVlKCkge1xuICAgIDE0XHQgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAxNVx0ICAgIH1cbiAgICAxNlx0fVxuICAgIDE3XHRcblRvdGFsIGxpbmVzIGluIGZpbGU6IDE3XG4iLCJpc0Vycm9yIjpmYWxzZSwicmVxdWVzdElkIjoiIn19LCJhODljOWE2Ny1mMzdmLTRmODEtOTRhOS1hOGYyYWJiYjY2NDA7dG9vbHVfMDE1RnJ1QnZwNlFWcHhUbnFBZjkxNk1QIjp7InBoYXNlIjo1LCJyZXN1bHQiOnsidGV4dCI6IlN1Y2Nlc3NmdWxseSBlZGl0ZWQgdGhlIGZpbGUgc3JjL21haW4vamF2YS9tb2RlbC9Eb2lUdW9uZ0FwRHVuZy5qYXZhLlxuUmVzdWx0IGZvciBzdHJfcmVwbGFjZV9lbnRyaWVzWzBdOlxuUmVwbGFjZW1lbnQgc3VjY2Vzc2Z1bC5cbkVkaXRlZCBzZWN0aW9uIGFmdGVyIElERSBhdXRvLWZvcm1hdHRpbmcgd2FzIGFwcGxpZWQ6XG4gICAgIDFcdHBhY2thZ2UgbW9kZWw7XG4gICAgIDJcdFxuICAgICAzXHRwdWJsaWMgZW51bSBEb2lUdW9uZ0FwRHVuZyB7XG4gICAgIDRcdCAgICBBTEwoXCJU4bqldCBj4bqjXCIpLFxuICAgICA1XHQgICAgS0hBQ0hfSEFOR19USFVPTkcoXCJLaMOhY2ggaMOgbmcgdGjGsOG7nW5nXCIpLFxuICAgICA2XHQgICAgS0hBQ0hfSEFOR19WSVAoXCJLaMOhY2ggaMOgbmcgVklQXCIpLFxuICAgICA3XHQgICAgS0hBQ0hfSEFOR19USEFOX1RISUVUKFwiS2jDoWNoIGjDoG5nIHRow6JuIHRoaeG6v3RcIiksXG4gICAgIDhcdCAgICBDT1VQT04oXCJDb3Vwb25cIik7XG4gICAgIDlcdFxuICAgIDEwXHQgICAgcHJpdmF0ZSBmaW5hbCBTdHJpbmcgdmFsdWU7XG4gICAgMTFcdFxuICAgIDEyXHQgICAgRG9pVHVvbmdBcER1bmcoU3RyaW5nIHZhbHVlKSB7XG4gICAgMTNcdCAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgIDE0XHQgICAgfVxuICAgIDE1XHRcbiAgICAxNlx0ICAgIHB1YmxpYyBTdHJpbmcgZ2V0VmFsdWUoKSB7XG4gICAgMTdcdCAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIDE4XHQgICAgfVxuICAgIDE5XHRcbiAgICAyMFx0ICAgIHB1YmxpYyBzdGF0aWMgRG9pVHVvbmdBcER1bmcgZnJvbVZhbHVlKFN0cmluZyB2YWx1ZSkge1xuICAgIDIxXHQgICAgICAgIGZvciAoRG9pVHVvbmdBcER1bmcgZG9pVHVvbmcgOiBEb2lUdW9uZ0FwRHVuZy52YWx1ZXMoKSkge1xuICAgIDIyXHQgICAgICAgICAgICBpZiAoZG9pVHVvbmcudmFsdWUuZXF1YWxzKHZhbHVlKSkge1xuICAgIDIzXHQgICAgICAgICAgICAgICAgcmV0dXJuIGRvaVR1b25nO1xuICAgIDI0XHQgICAgICAgICAgICB9XG4gICAgMjVcdCAgICAgICAgfVxuICAgIDI2XHQgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oXCJObyBlbnVtIGNvbnN0YW50IGZvciB2YWx1ZTogXCIgKyB2YWx1ZSk7XG4gICAgMjdcdCAgICB9XG4gICAgMjhcdH1cbiAgICAyOVx0XG5cblJldmlldyB0aGUgY2hhbmdlcyBhbmQgbWFrZSBzdXJlIHRoZXkgYXJlIGFzIGV4cGVjdGVkIChjb3JyZWN0IGluZGVudGF0aW9uLCBubyBkdXBsaWNhdGUgbGluZXMsIGV0YykuXG5FZGl0IHRoZSBmaWxlIGFnYWluIGlmIG5lY2Vzc2FyeS5cbiIsImlzRXJyb3IiOmZhbHNlLCJyZXF1ZXN0SWQiOiIifX19LCJkcmFmdEV4Y2hhbmdlIjp7InJlcXVlc3RfbWVzc2FnZSI6IiIsInJpY2hfdGV4dF9qc29uX3JlcHIiOnsidHlwZSI6ImRvYyIsImNvbnRlbnQiOlt7InR5cGUiOiJwYXJhZ3JhcGgifV19LCJtZW50aW9uZWRfaXRlbXMiOltdLCJzdGF0dXMiOiJkcmFmdCJ9LCJkcmFmdEFjdGl2ZUNvbnRleHRJZHMiOlsiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9kYW8vaW1wbC9DaG9OZ29pREFPSW1wbC5qYXZhIiwiL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIiwiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmdmYWxzZWZhbHNlIiwiYWdlbnRNZW1vcmllcyJdLCJyZXF1ZXN0SWRzIjpbXSwiaXNQaW5uZWQiOmZhbHNlLCJpc1NoYXJlYWJsZSI6dHJ1ZSwiZXh0cmFEYXRhIjp7ImlzQWdlbnRDb252ZXJzYXRpb24iOnRydWUsImhhc0FnZW50T25ib2FyZGVkIjp0cnVlLCJoYXNEaXJ0eUVkaXRzIjp0cnVlLCJiYXNlbGluZVRpbWVzdGFtcCI6MTc0NTI1MTM2MTQyNn0sInBlcnNvbmFUeXBlIjowfSwiMzQ3MDI5ODctNzBiNS00NjZmLTgyNTAtNWFmZThlZTY3MDcyIjp7ImlkIjoiMzQ3MDI5ODctNzBiNS00NjZmLTgyNTAtNWFmZThlZTY3MDcyIiwiY3JlYXRlZEF0SXNvIjoiMjAyNS0wNC0yMlQwNDo0MDoxNC45NzJaIiwibGFzdEludGVyYWN0ZWRBdElzbyI6IjIwMjUtMDQtMjJUMDQ6NDU6MzguMzk1WiIsImNoYXRIaXN0b3J5IjpbeyJyZXF1ZXN0X2lkIjoiODE0NDBlZDEtYTQ5Yy00MmE5LWE4ZGMtZmFkZDUxNTA0MTZjIiwidXVpZCI6IjkzYmRmMjE3LWZhMGItNDFlOC1hZTExLWYyMzc5YmU3MDIyMiIsImNoYXRJdGVtVHlwZSI6ImFnZW50aWMtY2hlY2twb2ludC1kZWxpbWl0ZXIiLCJzdGF0dXMiOiJzdWNjZXNzIiwiZnJvbVRpbWVzdGFtcCI6MCwidG9UaW1lc3RhbXAiOjE3NDUyOTY4MTQ5NzMsInNlZW5fc3RhdGUiOiJzZWVuIn0seyJzdGF0dXMiOiJzdWNjZXNzIiwicmVxdWVzdF9pZCI6IjQyM2QwOTg1LTNlYWMtNDA2Ni05M2M2LTJkNWUxMzQ1MDYyMCIsInJlcXVlc3RfbWVzc2FnZSI6ImphdmEubGFuZy5JbGxlZ2FsU3RhdGVFeGNlcHRpb246IG9yZy5oaWJlcm5hdGUuVHJhbnNpZW50UHJvcGVydHlWYWx1ZUV4Y2VwdGlvbjogTm90LW51bGwgcHJvcGVydHkgcmVmZXJlbmNlcyBhIHRyYW5zaWVudCB2YWx1ZSAtIHRyYW5zaWVudCBpbnN0YW5jZSBtdXN0IGJlIHNhdmVkIGJlZm9yZSBjdXJyZW50IG9wZXJhdGlvbjogbW9kZWwuSG9hRG9uLm52IC0+IG1vZGVsLk5oYW5WaWVuXHJcblx0YXQgb3JnLmhpYmVybmF0ZS5pbnRlcm5hbC5FeGNlcHRpb25Db252ZXJ0ZXJJbXBsLmNvbnZlcnQoRXhjZXB0aW9uQ29udmVydGVySW1wbC5qYXZhOjE1NylcclxuXHRhdCBvcmcuaGliZXJuYXRlLmludGVybmFsLkV4Y2VwdGlvbkNvbnZlcnRlckltcGwuY29udmVydChFeGNlcHRpb25Db252ZXJ0ZXJJbXBsLmphdmE6MTY3KVxyXG5cdGF0IG9yZy5oaWJlcm5hdGUuaW50ZXJuYWwuRXhjZXB0aW9uQ29udmVydGVySW1wbC5jb252ZXJ0KEV4Y2VwdGlvbkNvbnZlcnRlckltcGwuamF2YToxNzMpXHJcblx0YXQgb3JnLmhpYmVybmF0ZS5pbnRlcm5hbC5TZXNzaW9uSW1wbC5maXJlUGVyc2lzdChTZXNzaW9uSW1wbC5qYXZhOjcyNSlcclxuXHRhdCBvcmcuaGliZXJuYXRlLmludGVybmFsLlNlc3Npb25JbXBsLnBlcnNpc3QoU2Vzc2lvbkltcGwuamF2YTo2OTIpXHJcblx0YXQgZGFvLmltcGwuSG9hRG9uREFPSW1wbC5zYXZlSG9hRG9uKEhvYURvbkRBT0ltcGwuamF2YTo1MylcclxuXHRhdCBndWlDbGllbnQuVGhhbmhUb2FuR1VJLnByb2Nlc3NQYXltZW50KFRoYW5oVG9hbkdVSS5qYXZhOjE1NDkpXHJcblx0YXQgZ3VpQ2xpZW50LlRoYW5oVG9hbkdVSS5sYW1iZGEkaW5pdENvbXBvbmVudHMkMihUaGFuaFRvYW5HVUkuamF2YToxODcpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmF4LnN3aW5nLkFic3RyYWN0QnV0dG9uLmZpcmVBY3Rpb25QZXJmb3JtZWQoQWJzdHJhY3RCdXR0b24uamF2YToxOTcyKVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZheC5zd2luZy5BYnN0cmFjdEJ1dHRvbiRIYW5kbGVyLmFjdGlvblBlcmZvcm1lZChBYnN0cmFjdEJ1dHRvbi5qYXZhOjIzMTQpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmF4LnN3aW5nLkRlZmF1bHRCdXR0b25Nb2RlbC5maXJlQWN0aW9uUGVyZm9ybWVkKERlZmF1bHRCdXR0b25Nb2RlbC5qYXZhOjQwNylcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YXguc3dpbmcuRGVmYXVsdEJ1dHRvbk1vZGVsLnNldFByZXNzZWQoRGVmYXVsdEJ1dHRvbk1vZGVsLmphdmE6MjYyKVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZheC5zd2luZy5wbGFmLmJhc2ljLkJhc2ljQnV0dG9uTGlzdGVuZXIubW91c2VSZWxlYXNlZChCYXNpY0J1dHRvbkxpc3RlbmVyLmphdmE6Mjc5KVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5Db21wb25lbnQucHJvY2Vzc01vdXNlRXZlbnQoQ29tcG9uZW50LmphdmE6NjYyMSlcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YXguc3dpbmcuSkNvbXBvbmVudC5wcm9jZXNzTW91c2VFdmVudChKQ29tcG9uZW50LmphdmE6MzM5OClcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuQ29tcG9uZW50LnByb2Nlc3NFdmVudChDb21wb25lbnQuamF2YTo2Mzg2KVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5Db250YWluZXIucHJvY2Vzc0V2ZW50KENvbnRhaW5lci5qYXZhOjIyNjYpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkNvbXBvbmVudC5kaXNwYXRjaEV2ZW50SW1wbChDb21wb25lbnQuamF2YTo0OTk2KVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5Db250YWluZXIuZGlzcGF0Y2hFdmVudEltcGwoQ29udGFpbmVyLmphdmE6MjMyNClcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuQ29tcG9uZW50LmRpc3BhdGNoRXZlbnQoQ29tcG9uZW50LmphdmE6NDgyOClcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuTGlnaHR3ZWlnaHREaXNwYXRjaGVyLnJldGFyZ2V0TW91c2VFdmVudChDb250YWluZXIuamF2YTo0OTQ4KVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5MaWdodHdlaWdodERpc3BhdGNoZXIucHJvY2Vzc01vdXNlRXZlbnQoQ29udGFpbmVyLmphdmE6NDU3NSlcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuTGlnaHR3ZWlnaHREaXNwYXRjaGVyLmRpc3BhdGNoRXZlbnQoQ29udGFpbmVyLmphdmE6NDUxNilcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuQ29udGFpbmVyLmRpc3BhdGNoRXZlbnRJbXBsKENvbnRhaW5lci5qYXZhOjIzMTApXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LldpbmRvdy5kaXNwYXRjaEV2ZW50SW1wbChXaW5kb3cuamF2YToyNzgwKVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5Db21wb25lbnQuZGlzcGF0Y2hFdmVudChDb21wb25lbnQuamF2YTo0ODI4KVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5FdmVudFF1ZXVlLmRpc3BhdGNoRXZlbnRJbXBsKEV2ZW50UXVldWUuamF2YTo3NzUpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkV2ZW50UXVldWUkNC5ydW4oRXZlbnRRdWV1ZS5qYXZhOjcyMClcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuRXZlbnRRdWV1ZSQ0LnJ1bihFdmVudFF1ZXVlLmphdmE6NzE0KVxyXG5cdGF0IGphdmEuYmFzZS9qYXZhLnNlY3VyaXR5LkFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKEFjY2Vzc0NvbnRyb2xsZXIuamF2YTo0MDApXHJcblx0YXQgamF2YS5iYXNlL2phdmEuc2VjdXJpdHkuUHJvdGVjdGlvbkRvbWFpbiRKYXZhU2VjdXJpdHlBY2Nlc3NJbXBsLmRvSW50ZXJzZWN0aW9uUHJpdmlsZWdlKFByb3RlY3Rpb25Eb21haW4uamF2YTo4NylcclxuXHRhdCBqYXZhLmJhc2UvamF2YS5zZWN1cml0eS5Qcm90ZWN0aW9uRG9tYWluJEphdmFTZWN1cml0eUFjY2Vzc0ltcGwuZG9JbnRlcnNlY3Rpb25Qcml2aWxlZ2UoUHJvdGVjdGlvbkRvbWFpbi5qYXZhOjk4KVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5FdmVudFF1ZXVlJDUucnVuKEV2ZW50UXVldWUuamF2YTo3NDcpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkV2ZW50UXVldWUkNS5ydW4oRXZlbnRRdWV1ZS5qYXZhOjc0NSlcclxuXHRhdCBqYXZhLmJhc2UvamF2YS5zZWN1cml0eS5BY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZChBY2Nlc3NDb250cm9sbGVyLmphdmE6NDAwKVxyXG5cdGF0IGphdmEuYmFzZS9qYXZhLnNlY3VyaXR5LlByb3RlY3Rpb25Eb21haW4kSmF2YVNlY3VyaXR5QWNjZXNzSW1wbC5kb0ludGVyc2VjdGlvblByaXZpbGVnZShQcm90ZWN0aW9uRG9tYWluLmphdmE6ODcpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkV2ZW50UXVldWUuZGlzcGF0Y2hFdmVudChFdmVudFF1ZXVlLmphdmE6NzQ0KVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5FdmVudERpc3BhdGNoVGhyZWFkLnB1bXBPbmVFdmVudEZvckZpbHRlcnMoRXZlbnREaXNwYXRjaFRocmVhZC5qYXZhOjIwMylcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuRXZlbnREaXNwYXRjaFRocmVhZC5wdW1wRXZlbnRzRm9yRmlsdGVyKEV2ZW50RGlzcGF0Y2hUaHJlYWQuamF2YToxMjQpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkV2ZW50RGlzcGF0Y2hUaHJlYWQucHVtcEV2ZW50c0ZvckhpZXJhcmNoeShFdmVudERpc3BhdGNoVGhyZWFkLmphdmE6MTEzKVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5FdmVudERpc3BhdGNoVGhyZWFkLnB1bXBFdmVudHMoRXZlbnREaXNwYXRjaFRocmVhZC5qYXZhOjEwOSlcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuRXZlbnREaXNwYXRjaFRocmVhZC5wdW1wRXZlbnRzKEV2ZW50RGlzcGF0Y2hUaHJlYWQuamF2YToxMDEpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkV2ZW50RGlzcGF0Y2hUaHJlYWQucnVuKEV2ZW50RGlzcGF0Y2hUaHJlYWQuamF2YTo5MClcclxuQ2F1c2VkIGJ5OiBvcmcuaGliZXJuYXRlLlRyYW5zaWVudFByb3BlcnR5VmFsdWVFeGNlcHRpb246IE5vdC1udWxsIHByb3BlcnR5IHJlZmVyZW5jZXMgYSB0cmFuc2llbnQgdmFsdWUgLSB0cmFuc2llbnQgaW5zdGFuY2UgbXVzdCBiZSBzYXZlZCBiZWZvcmUgY3VycmVudCBvcGVyYXRpb246IG1vZGVsLkhvYURvbi5udiAtPiBtb2RlbC5OaGFuVmllblxyXG5cdGF0IG9yZy5oaWJlcm5hdGUuYWN0aW9uLmludGVybmFsLlVucmVzb2x2ZWRFbnRpdHlJbnNlcnRBY3Rpb25zLmNoZWNrTm9VbnJlc29sdmVkQWN0aW9uc0FmdGVyT3BlcmF0aW9uKFVucmVzb2x2ZWRFbnRpdHlJbnNlcnRBY3Rpb25zLmphdmE6MTIzKVxyXG5cdGF0IG9yZy5oaWJlcm5hdGUuZW5naW5lLnNwaS5BY3Rpb25RdWV1ZS5jaGVja05vVW5yZXNvbHZlZEFjdGlvbnNBZnRlck9wZXJhdGlvbihBY3Rpb25RdWV1ZS5qYXZhOjQ2MSlcclxuXHRhdCBvcmcuaGliZXJuYXRlLmludGVybmFsLlNlc3Npb25JbXBsLmNoZWNrTm9VbnJlc29sdmVkQWN0aW9uc0FmdGVyT3BlcmF0aW9uKFNlc3Npb25JbXBsLmphdmE6NjE0KVxyXG5cdGF0IG9yZy5oaWJlcm5hdGUuaW50ZXJuYWwuU2Vzc2lvbkltcGwuZmlyZVBlcnNpc3QoU2Vzc2lvbkltcGwuamF2YTo3MjIpXHJcblx0Li4uIDM5IG1vcmUiLCJyaWNoX3RleHRfanNvbl9yZXByIjp7InR5cGUiOiJkb2MiLCJjb250ZW50IjpbeyJ0eXBlIjoicGFyYWdyYXBoIiwiY29udGVudCI6W3sidHlwZSI6InRleHQiLCJ0ZXh0IjoiamF2YS5sYW5nLklsbGVnYWxTdGF0ZUV4Y2VwdGlvbjogb3JnLmhpYmVybmF0ZS5UcmFuc2llbnRQcm9wZXJ0eVZhbHVlRXhjZXB0aW9uOiBOb3QtbnVsbCBwcm9wZXJ0eSByZWZlcmVuY2VzIGEgdHJhbnNpZW50IHZhbHVlIC0gdHJhbnNpZW50IGluc3RhbmNlIG11c3QgYmUgc2F2ZWQgYmVmb3JlIGN1cnJlbnQgb3BlcmF0aW9uOiBtb2RlbC5Ib2FEb24ubnYgLT4gbW9kZWwuTmhhblZpZW5cciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHRhdCBvcmcuaGliZXJuYXRlLmludGVybmFsLkV4Y2VwdGlvbkNvbnZlcnRlckltcGwuY29udmVydChFeGNlcHRpb25Db252ZXJ0ZXJJbXBsLmphdmE6MTU3KVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IG9yZy5oaWJlcm5hdGUuaW50ZXJuYWwuRXhjZXB0aW9uQ29udmVydGVySW1wbC5jb252ZXJ0KEV4Y2VwdGlvbkNvbnZlcnRlckltcGwuamF2YToxNjcpXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgb3JnLmhpYmVybmF0ZS5pbnRlcm5hbC5FeGNlcHRpb25Db252ZXJ0ZXJJbXBsLmNvbnZlcnQoRXhjZXB0aW9uQ29udmVydGVySW1wbC5qYXZhOjE3MylcciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHRhdCBvcmcuaGliZXJuYXRlLmludGVybmFsLlNlc3Npb25JbXBsLmZpcmVQZXJzaXN0KFNlc3Npb25JbXBsLmphdmE6NzI1KVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IG9yZy5oaWJlcm5hdGUuaW50ZXJuYWwuU2Vzc2lvbkltcGwucGVyc2lzdChTZXNzaW9uSW1wbC5qYXZhOjY5MilcciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHRhdCBkYW8uaW1wbC5Ib2FEb25EQU9JbXBsLnNhdmVIb2FEb24oSG9hRG9uREFPSW1wbC5qYXZhOjUzKVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IGd1aUNsaWVudC5UaGFuaFRvYW5HVUkucHJvY2Vzc1BheW1lbnQoVGhhbmhUb2FuR1VJLmphdmE6MTU0OSlcciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHRhdCBndWlDbGllbnQuVGhhbmhUb2FuR1VJLmxhbWJkYSRpbml0Q29tcG9uZW50cyQyKFRoYW5oVG9hbkdVSS5qYXZhOjE4NylcciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHRhdCBqYXZhLmRlc2t0b3AvamF2YXguc3dpbmcuQWJzdHJhY3RCdXR0b24uZmlyZUFjdGlvblBlcmZvcm1lZChBYnN0cmFjdEJ1dHRvbi5qYXZhOjE5NzIpXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgamF2YS5kZXNrdG9wL2phdmF4LnN3aW5nLkFic3RyYWN0QnV0dG9uJEhhbmRsZXIuYWN0aW9uUGVyZm9ybWVkKEFic3RyYWN0QnV0dG9uLmphdmE6MjMxNClcciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHRhdCBqYXZhLmRlc2t0b3AvamF2YXguc3dpbmcuRGVmYXVsdEJ1dHRvbk1vZGVsLmZpcmVBY3Rpb25QZXJmb3JtZWQoRGVmYXVsdEJ1dHRvbk1vZGVsLmphdmE6NDA3KVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IGphdmEuZGVza3RvcC9qYXZheC5zd2luZy5EZWZhdWx0QnV0dG9uTW9kZWwuc2V0UHJlc3NlZChEZWZhdWx0QnV0dG9uTW9kZWwuamF2YToyNjIpXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgamF2YS5kZXNrdG9wL2phdmF4LnN3aW5nLnBsYWYuYmFzaWMuQmFzaWNCdXR0b25MaXN0ZW5lci5tb3VzZVJlbGVhc2VkKEJhc2ljQnV0dG9uTGlzdGVuZXIuamF2YToyNzkpXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkNvbXBvbmVudC5wcm9jZXNzTW91c2VFdmVudChDb21wb25lbnQuamF2YTo2NjIxKVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IGphdmEuZGVza3RvcC9qYXZheC5zd2luZy5KQ29tcG9uZW50LnByb2Nlc3NNb3VzZUV2ZW50KEpDb21wb25lbnQuamF2YTozMzk4KVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5Db21wb25lbnQucHJvY2Vzc0V2ZW50KENvbXBvbmVudC5qYXZhOjYzODYpXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkNvbnRhaW5lci5wcm9jZXNzRXZlbnQoQ29udGFpbmVyLmphdmE6MjI2NilcciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuQ29tcG9uZW50LmRpc3BhdGNoRXZlbnRJbXBsKENvbXBvbmVudC5qYXZhOjQ5OTYpXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkNvbnRhaW5lci5kaXNwYXRjaEV2ZW50SW1wbChDb250YWluZXIuamF2YToyMzI0KVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5Db21wb25lbnQuZGlzcGF0Y2hFdmVudChDb21wb25lbnQuamF2YTo0ODI4KVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5MaWdodHdlaWdodERpc3BhdGNoZXIucmV0YXJnZXRNb3VzZUV2ZW50KENvbnRhaW5lci5qYXZhOjQ5NDgpXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkxpZ2h0d2VpZ2h0RGlzcGF0Y2hlci5wcm9jZXNzTW91c2VFdmVudChDb250YWluZXIuamF2YTo0NTc1KVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5MaWdodHdlaWdodERpc3BhdGNoZXIuZGlzcGF0Y2hFdmVudChDb250YWluZXIuamF2YTo0NTE2KVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5Db250YWluZXIuZGlzcGF0Y2hFdmVudEltcGwoQ29udGFpbmVyLmphdmE6MjMxMClcciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuV2luZG93LmRpc3BhdGNoRXZlbnRJbXBsKFdpbmRvdy5qYXZhOjI3ODApXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkNvbXBvbmVudC5kaXNwYXRjaEV2ZW50KENvbXBvbmVudC5qYXZhOjQ4MjgpXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkV2ZW50UXVldWUuZGlzcGF0Y2hFdmVudEltcGwoRXZlbnRRdWV1ZS5qYXZhOjc3NSlcciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuRXZlbnRRdWV1ZSQ0LnJ1bihFdmVudFF1ZXVlLmphdmE6NzIwKVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5FdmVudFF1ZXVlJDQucnVuKEV2ZW50UXVldWUuamF2YTo3MTQpXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgamF2YS5iYXNlL2phdmEuc2VjdXJpdHkuQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoQWNjZXNzQ29udHJvbGxlci5qYXZhOjQwMClcciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHRhdCBqYXZhLmJhc2UvamF2YS5zZWN1cml0eS5Qcm90ZWN0aW9uRG9tYWluJEphdmFTZWN1cml0eUFjY2Vzc0ltcGwuZG9JbnRlcnNlY3Rpb25Qcml2aWxlZ2UoUHJvdGVjdGlvbkRvbWFpbi5qYXZhOjg3KVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IGphdmEuYmFzZS9qYXZhLnNlY3VyaXR5LlByb3RlY3Rpb25Eb21haW4kSmF2YVNlY3VyaXR5QWNjZXNzSW1wbC5kb0ludGVyc2VjdGlvblByaXZpbGVnZShQcm90ZWN0aW9uRG9tYWluLmphdmE6OTgpXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkV2ZW50UXVldWUkNS5ydW4oRXZlbnRRdWV1ZS5qYXZhOjc0NylcciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuRXZlbnRRdWV1ZSQ1LnJ1bihFdmVudFF1ZXVlLmphdmE6NzQ1KVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IGphdmEuYmFzZS9qYXZhLnNlY3VyaXR5LkFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKEFjY2Vzc0NvbnRyb2xsZXIuamF2YTo0MDApXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgamF2YS5iYXNlL2phdmEuc2VjdXJpdHkuUHJvdGVjdGlvbkRvbWFpbiRKYXZhU2VjdXJpdHlBY2Nlc3NJbXBsLmRvSW50ZXJzZWN0aW9uUHJpdmlsZWdlKFByb3RlY3Rpb25Eb21haW4uamF2YTo4NylcciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuRXZlbnRRdWV1ZS5kaXNwYXRjaEV2ZW50KEV2ZW50UXVldWUuamF2YTo3NDQpXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkV2ZW50RGlzcGF0Y2hUaHJlYWQucHVtcE9uZUV2ZW50Rm9yRmlsdGVycyhFdmVudERpc3BhdGNoVGhyZWFkLmphdmE6MjAzKVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5FdmVudERpc3BhdGNoVGhyZWFkLnB1bXBFdmVudHNGb3JGaWx0ZXIoRXZlbnREaXNwYXRjaFRocmVhZC5qYXZhOjEyNClcciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuRXZlbnREaXNwYXRjaFRocmVhZC5wdW1wRXZlbnRzRm9ySGllcmFyY2h5KEV2ZW50RGlzcGF0Y2hUaHJlYWQuamF2YToxMTMpXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkV2ZW50RGlzcGF0Y2hUaHJlYWQucHVtcEV2ZW50cyhFdmVudERpc3BhdGNoVGhyZWFkLmphdmE6MTA5KVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5FdmVudERpc3BhdGNoVGhyZWFkLnB1bXBFdmVudHMoRXZlbnREaXNwYXRjaFRocmVhZC5qYXZhOjEwMSlcciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuRXZlbnREaXNwYXRjaFRocmVhZC5ydW4oRXZlbnREaXNwYXRjaFRocmVhZC5qYXZhOjkwKVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJDYXVzZWQgYnk6IG9yZy5oaWJlcm5hdGUuVHJhbnNpZW50UHJvcGVydHlWYWx1ZUV4Y2VwdGlvbjogTm90LW51bGwgcHJvcGVydHkgcmVmZXJlbmNlcyBhIHRyYW5zaWVudCB2YWx1ZSAtIHRyYW5zaWVudCBpbnN0YW5jZSBtdXN0IGJlIHNhdmVkIGJlZm9yZSBjdXJyZW50IG9wZXJhdGlvbjogbW9kZWwuSG9hRG9uLm52IC0+IG1vZGVsLk5oYW5WaWVuXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgb3JnLmhpYmVybmF0ZS5hY3Rpb24uaW50ZXJuYWwuVW5yZXNvbHZlZEVudGl0eUluc2VydEFjdGlvbnMuY2hlY2tOb1VucmVzb2x2ZWRBY3Rpb25zQWZ0ZXJPcGVyYXRpb24oVW5yZXNvbHZlZEVudGl0eUluc2VydEFjdGlvbnMuamF2YToxMjMpXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgb3JnLmhpYmVybmF0ZS5lbmdpbmUuc3BpLkFjdGlvblF1ZXVlLmNoZWNrTm9VbnJlc29sdmVkQWN0aW9uc0FmdGVyT3BlcmF0aW9uKEFjdGlvblF1ZXVlLmphdmE6NDYxKVxyIn0seyJ0eXBlIjoiaGFyZEJyZWFrIn0seyJ0eXBlIjoidGV4dCIsInRleHQiOiJcdGF0IG9yZy5oaWJlcm5hdGUuaW50ZXJuYWwuU2Vzc2lvbkltcGwuY2hlY2tOb1VucmVzb2x2ZWRBY3Rpb25zQWZ0ZXJPcGVyYXRpb24oU2Vzc2lvbkltcGwuamF2YTo2MTQpXHIifSx7InR5cGUiOiJoYXJkQnJlYWsifSx7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ilx0YXQgb3JnLmhpYmVybmF0ZS5pbnRlcm5hbC5TZXNzaW9uSW1wbC5maXJlUGVyc2lzdChTZXNzaW9uSW1wbC5qYXZhOjcyMilcciJ9LHsidHlwZSI6ImhhcmRCcmVhayJ9LHsidHlwZSI6InRleHQiLCJ0ZXh0IjoiXHQuLi4gMzkgbW9yZSJ9XX1dfSwibWVudGlvbmVkX2l0ZW1zIjpbXSwic3RydWN0dXJlZF9vdXRwdXRfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjo1LCJjb250ZW50IjoiIiwidG9vbF91c2UiOnsidG9vbF91c2VfaWQiOiJ0b29sdV8wMTYyQnVmb1V6cURTcXg1N1pTTTVIRW0iLCJ0b29sX25hbWUiOiJjb2RlYmFzZS1yZXRyaWV2YWwiLCJpbnB1dF9qc29uIjoie1wiaW5mb3JtYXRpb25fcmVxdWVzdFwiOiBcIlNob3cgbWUgdGhlIEhvYURvbkRBT0ltcGwuamF2YSBmaWxlLCBwYXJ0aWN1bGFybHkgdGhlIHNhdmVIb2FEb24gbWV0aG9kIGF0IGxpbmUgNTMgd2hlcmUgdGhlIGVycm9yIGlzIG9jY3VycmluZy4gQWxzbyBzaG93IG1lIHRoZSBIb2FEb24gYW5kIE5oYW5WaWVuIGVudGl0eSBjbGFzc2VzIHRvIHVuZGVyc3RhbmQgdGhlaXIgcmVsYXRpb25zaGlwLlwifSJ9fSx7ImlkIjowLCJ0eXBlIjowLCJjb250ZW50IjoiSSBzZWUgeW91J3JlIGVuY291bnRlcmluZyBhIEhpYmVybmF0ZSBlcnJvciB3aGVuIHRyeWluZyB0byBzYXZlIGEgYEhvYURvbmAgKGludm9pY2UpIGVudGl0eS4gVGhlIGVycm9yIGlzOlxuXG5gYGBcbm9yZy5oaWJlcm5hdGUuVHJhbnNpZW50UHJvcGVydHlWYWx1ZUV4Y2VwdGlvbjogTm90LW51bGwgcHJvcGVydHkgcmVmZXJlbmNlcyBhIHRyYW5zaWVudCB2YWx1ZSAtIHRyYW5zaWVudCBpbnN0YW5jZSBtdXN0IGJlIHNhdmVkIGJlZm9yZSBjdXJyZW50IG9wZXJhdGlvbjogbW9kZWwuSG9hRG9uLm52IC0+IG1vZGVsLk5oYW5WaWVuXG5gYGBcblxuVGhpcyBpcyBhIGNvbW1vbiBIaWJlcm5hdGUgaXNzdWUuIEl0IG1lYW5zIHlvdSdyZSB0cnlpbmcgdG8gc2F2ZSBhIGBIb2FEb25gIG9iamVjdCB0aGF0IHJlZmVyZW5jZXMgYSBgTmhhblZpZW5gIChlbXBsb3llZSkgb2JqZWN0LCBidXQgdGhhdCBgTmhhblZpZW5gIG9iamVjdCBoYXNuJ3QgYmVlbiBzYXZlZCB0byB0aGUgZGF0YWJhc2UgeWV0IChpdCdzIFwidHJhbnNpZW50XCIpLlxuXG5MZXQgbWUgZ2F0aGVyIG1vcmUgaW5mb3JtYXRpb24gYWJvdXQgdGhlIHJlbGV2YW50IGNvZGUgdG8gaGVscCBmaXggdGhpcyBpc3N1ZS5cbiJ9LHsiaWQiOjIsInR5cGUiOjIsImNvbnRlbnQiOiIifSx7ImlkIjozLCJ0eXBlIjozLCJjb250ZW50IjoiIn1dLCJzZWVuX3N0YXRlIjoic2VlbiIsInN0cnVjdHVyZWRfcmVxdWVzdF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjAsInRleHRfbm9kZSI6eyJjb250ZW50IjoiamF2YS5sYW5nLklsbGVnYWxTdGF0ZUV4Y2VwdGlvbjogb3JnLmhpYmVybmF0ZS5UcmFuc2llbnRQcm9wZXJ0eVZhbHVlRXhjZXB0aW9uOiBOb3QtbnVsbCBwcm9wZXJ0eSByZWZlcmVuY2VzIGEgdHJhbnNpZW50IHZhbHVlIC0gdHJhbnNpZW50IGluc3RhbmNlIG11c3QgYmUgc2F2ZWQgYmVmb3JlIGN1cnJlbnQgb3BlcmF0aW9uOiBtb2RlbC5Ib2FEb24ubnYgLT4gbW9kZWwuTmhhblZpZW5cclxuXHRhdCBvcmcuaGliZXJuYXRlLmludGVybmFsLkV4Y2VwdGlvbkNvbnZlcnRlckltcGwuY29udmVydChFeGNlcHRpb25Db252ZXJ0ZXJJbXBsLmphdmE6MTU3KVxyXG5cdGF0IG9yZy5oaWJlcm5hdGUuaW50ZXJuYWwuRXhjZXB0aW9uQ29udmVydGVySW1wbC5jb252ZXJ0KEV4Y2VwdGlvbkNvbnZlcnRlckltcGwuamF2YToxNjcpXHJcblx0YXQgb3JnLmhpYmVybmF0ZS5pbnRlcm5hbC5FeGNlcHRpb25Db252ZXJ0ZXJJbXBsLmNvbnZlcnQoRXhjZXB0aW9uQ29udmVydGVySW1wbC5qYXZhOjE3MylcclxuXHRhdCBvcmcuaGliZXJuYXRlLmludGVybmFsLlNlc3Npb25JbXBsLmZpcmVQZXJzaXN0KFNlc3Npb25JbXBsLmphdmE6NzI1KVxyXG5cdGF0IG9yZy5oaWJlcm5hdGUuaW50ZXJuYWwuU2Vzc2lvbkltcGwucGVyc2lzdChTZXNzaW9uSW1wbC5qYXZhOjY5MilcclxuXHRhdCBkYW8uaW1wbC5Ib2FEb25EQU9JbXBsLnNhdmVIb2FEb24oSG9hRG9uREFPSW1wbC5qYXZhOjUzKVxyXG5cdGF0IGd1aUNsaWVudC5UaGFuaFRvYW5HVUkucHJvY2Vzc1BheW1lbnQoVGhhbmhUb2FuR1VJLmphdmE6MTU0OSlcclxuXHRhdCBndWlDbGllbnQuVGhhbmhUb2FuR1VJLmxhbWJkYSRpbml0Q29tcG9uZW50cyQyKFRoYW5oVG9hbkdVSS5qYXZhOjE4NylcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YXguc3dpbmcuQWJzdHJhY3RCdXR0b24uZmlyZUFjdGlvblBlcmZvcm1lZChBYnN0cmFjdEJ1dHRvbi5qYXZhOjE5NzIpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmF4LnN3aW5nLkFic3RyYWN0QnV0dG9uJEhhbmRsZXIuYWN0aW9uUGVyZm9ybWVkKEFic3RyYWN0QnV0dG9uLmphdmE6MjMxNClcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YXguc3dpbmcuRGVmYXVsdEJ1dHRvbk1vZGVsLmZpcmVBY3Rpb25QZXJmb3JtZWQoRGVmYXVsdEJ1dHRvbk1vZGVsLmphdmE6NDA3KVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZheC5zd2luZy5EZWZhdWx0QnV0dG9uTW9kZWwuc2V0UHJlc3NlZChEZWZhdWx0QnV0dG9uTW9kZWwuamF2YToyNjIpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmF4LnN3aW5nLnBsYWYuYmFzaWMuQmFzaWNCdXR0b25MaXN0ZW5lci5tb3VzZVJlbGVhc2VkKEJhc2ljQnV0dG9uTGlzdGVuZXIuamF2YToyNzkpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkNvbXBvbmVudC5wcm9jZXNzTW91c2VFdmVudChDb21wb25lbnQuamF2YTo2NjIxKVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZheC5zd2luZy5KQ29tcG9uZW50LnByb2Nlc3NNb3VzZUV2ZW50KEpDb21wb25lbnQuamF2YTozMzk4KVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5Db21wb25lbnQucHJvY2Vzc0V2ZW50KENvbXBvbmVudC5qYXZhOjYzODYpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkNvbnRhaW5lci5wcm9jZXNzRXZlbnQoQ29udGFpbmVyLmphdmE6MjI2NilcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuQ29tcG9uZW50LmRpc3BhdGNoRXZlbnRJbXBsKENvbXBvbmVudC5qYXZhOjQ5OTYpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkNvbnRhaW5lci5kaXNwYXRjaEV2ZW50SW1wbChDb250YWluZXIuamF2YToyMzI0KVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5Db21wb25lbnQuZGlzcGF0Y2hFdmVudChDb21wb25lbnQuamF2YTo0ODI4KVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5MaWdodHdlaWdodERpc3BhdGNoZXIucmV0YXJnZXRNb3VzZUV2ZW50KENvbnRhaW5lci5qYXZhOjQ5NDgpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkxpZ2h0d2VpZ2h0RGlzcGF0Y2hlci5wcm9jZXNzTW91c2VFdmVudChDb250YWluZXIuamF2YTo0NTc1KVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5MaWdodHdlaWdodERpc3BhdGNoZXIuZGlzcGF0Y2hFdmVudChDb250YWluZXIuamF2YTo0NTE2KVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5Db250YWluZXIuZGlzcGF0Y2hFdmVudEltcGwoQ29udGFpbmVyLmphdmE6MjMxMClcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuV2luZG93LmRpc3BhdGNoRXZlbnRJbXBsKFdpbmRvdy5qYXZhOjI3ODApXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkNvbXBvbmVudC5kaXNwYXRjaEV2ZW50KENvbXBvbmVudC5qYXZhOjQ4MjgpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkV2ZW50UXVldWUuZGlzcGF0Y2hFdmVudEltcGwoRXZlbnRRdWV1ZS5qYXZhOjc3NSlcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuRXZlbnRRdWV1ZSQ0LnJ1bihFdmVudFF1ZXVlLmphdmE6NzIwKVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5FdmVudFF1ZXVlJDQucnVuKEV2ZW50UXVldWUuamF2YTo3MTQpXHJcblx0YXQgamF2YS5iYXNlL2phdmEuc2VjdXJpdHkuQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoQWNjZXNzQ29udHJvbGxlci5qYXZhOjQwMClcclxuXHRhdCBqYXZhLmJhc2UvamF2YS5zZWN1cml0eS5Qcm90ZWN0aW9uRG9tYWluJEphdmFTZWN1cml0eUFjY2Vzc0ltcGwuZG9JbnRlcnNlY3Rpb25Qcml2aWxlZ2UoUHJvdGVjdGlvbkRvbWFpbi5qYXZhOjg3KVxyXG5cdGF0IGphdmEuYmFzZS9qYXZhLnNlY3VyaXR5LlByb3RlY3Rpb25Eb21haW4kSmF2YVNlY3VyaXR5QWNjZXNzSW1wbC5kb0ludGVyc2VjdGlvblByaXZpbGVnZShQcm90ZWN0aW9uRG9tYWluLmphdmE6OTgpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkV2ZW50UXVldWUkNS5ydW4oRXZlbnRRdWV1ZS5qYXZhOjc0NylcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuRXZlbnRRdWV1ZSQ1LnJ1bihFdmVudFF1ZXVlLmphdmE6NzQ1KVxyXG5cdGF0IGphdmEuYmFzZS9qYXZhLnNlY3VyaXR5LkFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKEFjY2Vzc0NvbnRyb2xsZXIuamF2YTo0MDApXHJcblx0YXQgamF2YS5iYXNlL2phdmEuc2VjdXJpdHkuUHJvdGVjdGlvbkRvbWFpbiRKYXZhU2VjdXJpdHlBY2Nlc3NJbXBsLmRvSW50ZXJzZWN0aW9uUHJpdmlsZWdlKFByb3RlY3Rpb25Eb21haW4uamF2YTo4NylcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuRXZlbnRRdWV1ZS5kaXNwYXRjaEV2ZW50KEV2ZW50UXVldWUuamF2YTo3NDQpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkV2ZW50RGlzcGF0Y2hUaHJlYWQucHVtcE9uZUV2ZW50Rm9yRmlsdGVycyhFdmVudERpc3BhdGNoVGhyZWFkLmphdmE6MjAzKVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5FdmVudERpc3BhdGNoVGhyZWFkLnB1bXBFdmVudHNGb3JGaWx0ZXIoRXZlbnREaXNwYXRjaFRocmVhZC5qYXZhOjEyNClcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuRXZlbnREaXNwYXRjaFRocmVhZC5wdW1wRXZlbnRzRm9ySGllcmFyY2h5KEV2ZW50RGlzcGF0Y2hUaHJlYWQuamF2YToxMTMpXHJcblx0YXQgamF2YS5kZXNrdG9wL2phdmEuYXd0LkV2ZW50RGlzcGF0Y2hUaHJlYWQucHVtcEV2ZW50cyhFdmVudERpc3BhdGNoVGhyZWFkLmphdmE6MTA5KVxyXG5cdGF0IGphdmEuZGVza3RvcC9qYXZhLmF3dC5FdmVudERpc3BhdGNoVGhyZWFkLnB1bXBFdmVudHMoRXZlbnREaXNwYXRjaFRocmVhZC5qYXZhOjEwMSlcclxuXHRhdCBqYXZhLmRlc2t0b3AvamF2YS5hd3QuRXZlbnREaXNwYXRjaFRocmVhZC5ydW4oRXZlbnREaXNwYXRjaFRocmVhZC5qYXZhOjkwKVxyXG5DYXVzZWQgYnk6IG9yZy5oaWJlcm5hdGUuVHJhbnNpZW50UHJvcGVydHlWYWx1ZUV4Y2VwdGlvbjogTm90LW51bGwgcHJvcGVydHkgcmVmZXJlbmNlcyBhIHRyYW5zaWVudCB2YWx1ZSAtIHRyYW5zaWVudCBpbnN0YW5jZSBtdXN0IGJlIHNhdmVkIGJlZm9yZSBjdXJyZW50IG9wZXJhdGlvbjogbW9kZWwuSG9hRG9uLm52IC0+IG1vZGVsLk5oYW5WaWVuXHJcblx0YXQgb3JnLmhpYmVybmF0ZS5hY3Rpb24uaW50ZXJuYWwuVW5yZXNvbHZlZEVudGl0eUluc2VydEFjdGlvbnMuY2hlY2tOb1VucmVzb2x2ZWRBY3Rpb25zQWZ0ZXJPcGVyYXRpb24oVW5yZXNvbHZlZEVudGl0eUluc2VydEFjdGlvbnMuamF2YToxMjMpXHJcblx0YXQgb3JnLmhpYmVybmF0ZS5lbmdpbmUuc3BpLkFjdGlvblF1ZXVlLmNoZWNrTm9VbnJlc29sdmVkQWN0aW9uc0FmdGVyT3BlcmF0aW9uKEFjdGlvblF1ZXVlLmphdmE6NDYxKVxyXG5cdGF0IG9yZy5oaWJlcm5hdGUuaW50ZXJuYWwuU2Vzc2lvbkltcGwuY2hlY2tOb1VucmVzb2x2ZWRBY3Rpb25zQWZ0ZXJPcGVyYXRpb24oU2Vzc2lvbkltcGwuamF2YTo2MTQpXHJcblx0YXQgb3JnLmhpYmVybmF0ZS5pbnRlcm5hbC5TZXNzaW9uSW1wbC5maXJlUGVyc2lzdChTZXNzaW9uSW1wbC5qYXZhOjcyMilcclxuXHQuLi4gMzkgbW9yZSJ9fSx7ImlkIjoyLCJ0eXBlIjo0LCJpZGVfc3RhdGVfbm9kZSI6eyJ3b3Jrc3BhY2VGb2xkZXJzIjpbeyJyZXBvc2l0b3J5Um9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIiwiZm9sZGVyUm9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIn1dLCJ3b3Jrc3BhY2VGb2xkZXJzVW5jaGFuZ2VkIjpmYWxzZX19XSwicmVzcG9uc2VfdGV4dCI6Ikkgc2VlIHlvdSdyZSBlbmNvdW50ZXJpbmcgYSBIaWJlcm5hdGUgZXJyb3Igd2hlbiB0cnlpbmcgdG8gc2F2ZSBhIGBIb2FEb25gIChpbnZvaWNlKSBlbnRpdHkuIFRoZSBlcnJvciBpczpcblxuYGBgXG5vcmcuaGliZXJuYXRlLlRyYW5zaWVudFByb3BlcnR5VmFsdWVFeGNlcHRpb246IE5vdC1udWxsIHByb3BlcnR5IHJlZmVyZW5jZXMgYSB0cmFuc2llbnQgdmFsdWUgLSB0cmFuc2llbnQgaW5zdGFuY2UgbXVzdCBiZSBzYXZlZCBiZWZvcmUgY3VycmVudCBvcGVyYXRpb246IG1vZGVsLkhvYURvbi5udiAtPiBtb2RlbC5OaGFuVmllblxuYGBgXG5cblRoaXMgaXMgYSBjb21tb24gSGliZXJuYXRlIGlzc3VlLiBJdCBtZWFucyB5b3UncmUgdHJ5aW5nIHRvIHNhdmUgYSBgSG9hRG9uYCBvYmplY3QgdGhhdCByZWZlcmVuY2VzIGEgYE5oYW5WaWVuYCAoZW1wbG95ZWUpIG9iamVjdCwgYnV0IHRoYXQgYE5oYW5WaWVuYCBvYmplY3QgaGFzbid0IGJlZW4gc2F2ZWQgdG8gdGhlIGRhdGFiYXNlIHlldCAoaXQncyBcInRyYW5zaWVudFwiKS5cblxuTGV0IG1lIGdhdGhlciBtb3JlIGluZm9ybWF0aW9uIGFib3V0IHRoZSByZWxldmFudCBjb2RlIHRvIGhlbHAgZml4IHRoaXMgaXNzdWUuXG4iLCJ3b3Jrc3BhY2VfZmlsZV9jaHVua3MiOltdfSx7InN0YXR1cyI6InN1Y2Nlc3MiLCJyZXF1ZXN0X2lkIjoiMzQwMmVjNDktOTliNS00Mjg5LTk1ZmUtMDBmYmMzN2NlM2UxIiwicmVxdWVzdF9tZXNzYWdlIjoiIiwic3RydWN0dXJlZF9vdXRwdXRfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjo1LCJjb250ZW50IjoiIiwidG9vbF91c2UiOnsidG9vbF91c2VfaWQiOiJ0b29sdV8wMUNkS2FSWU1LdUdqVzVnb0VzSlU4dUQiLCJ0b29sX25hbWUiOiJjb2RlYmFzZS1yZXRyaWV2YWwiLCJpbnB1dF9qc29uIjoie1wiaW5mb3JtYXRpb25fcmVxdWVzdFwiOiBcIlNob3cgbWUgdGhlIFRoYW5oVG9hbkdVSS5qYXZhIGZpbGUsIHBhcnRpY3VsYXJseSB0aGUgcHJvY2Vzc1BheW1lbnQgbWV0aG9kIGF0IGxpbmUgMTU0OSB3aGVyZSB0aGUgZXJyb3IgaXMgYmVpbmcgdHJpZ2dlcmVkLiBBbHNvLCBzaG93IG1lIGhvdyB0aGUgTmhhblZpZW4gb2JqZWN0IGlzIGJlaW5nIGNyZWF0ZWQgb3IgcmV0cmlldmVkIGJlZm9yZSBiZWluZyBhc3NpZ25lZCB0byB0aGUgSG9hRG9uLlwifSJ9fSx7ImlkIjowLCJ0eXBlIjowLCJjb250ZW50IjoiTGV0IG1lIGdldCBtb3JlIGluZm9ybWF0aW9uIGFib3V0IHRoZSBUaGFuaFRvYW5HVUkgY2xhc3Mgd2hlcmUgdGhlIGVycm9yIGlzIGJlaW5nIHRyaWdnZXJlZDpcbiJ9LHsiaWQiOjIsInR5cGUiOjIsImNvbnRlbnQiOiIifSx7ImlkIjozLCJ0eXBlIjozLCJjb250ZW50IjoiIn1dLCJzZWVuX3N0YXRlIjoic2VlbiIsInN0cnVjdHVyZWRfcmVxdWVzdF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjEsInRvb2xfcmVzdWx0X25vZGUiOnsiY29udGVudCI6IlRoZSBmb2xsb3dpbmcgY29kZSBzZWN0aW9ucyB3ZXJlIHJldHJpZXZlZDpcblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGFvL2ltcGwvSG9hRG9uREFPSW1wbC5qYXZhXG5wYWNrYWdlIGRhby5pbXBsO1xuXG5pbXBvcnQgZGFvLkhvYURvbkRBTztcbmltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXI7XG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS5FbnRpdHlUcmFuc2FjdGlvbjtcbmltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLlF1ZXJ5O1xuaW1wb3J0IG1vZGVsLkhvYURvbjtcbmltcG9ydCBtb2RlbC5Mb2FpSG9hRG9uO1xuaW1wb3J0IHV0aWwuSlBBVXRpbDtcblxuaW1wb3J0IGphdmEucm1pLlJlbW90ZUV4Y2VwdGlvbjtcbmltcG9ydCBqYXZhLnJtaS5zZXJ2ZXIuVW5pY2FzdFJlbW90ZU9iamVjdDtcbmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlO1xuaW1wb3J0IGphdmEudGltZS5mb3JtYXQuRGF0ZVRpbWVGb3JtYXR0ZXI7XG5pbXBvcnQgamF2YS51dGlsLkxpc3Q7XG5cbnB1YmxpYyBjbGFzcyBIb2FEb25EQU9JbXBsIGV4dGVuZHMgVW5pY2FzdFJlbW90ZU9iamVjdCBpbXBsZW1lbnRzIEhvYURvbkRBTyB7XG4gICAgcHVibGljIEhvYURvbkRBT0ltcGwoKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uIHtcblxuICAgIH1cblxuICAgIEBPdmVycmlkZVxuICAgIC8vIENyZWF0ZTogVGjDqm0gaMOzYSDEkcahbiBt4bubaVxuICAgIHB1YmxpYyBib29sZWFuIHNhdmVIb2FEb24oSG9hRG9uIGhvYURvbikgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcbiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHIgPSBlbS5nZXRUcmFuc2FjdGlvbigpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdHIuYmVnaW4oKTtcblxuICAgICAgICAgICAgLy8gS2nhu4NtIHRyYSB4ZW0gbcOjIGjDs2EgxJHGoW4gxJHDoyDEkcaw4bujYyB0aGnhur90IGzhuq1wIGNoxrBhXG4gICAgICAgICAgICBpZiAoaG9hRG9uLmdldE1hSEQoKSA9PSBudWxsIHx8IGhvYURvbi5nZXRNYUhEKCkuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgLy8gTuG6v3UgY2jGsGEgY8OzIG3DoyBow7NhIMSRxqFuLCB04buxIMSR4buZbmcgc2luaCBtw6NcbiAgICAgICAgICAgICAgICBTdHJpbmcgbWFIRCA9IGdlbmVyYXRlTWFIb2FEb24oXG4gICAgICAgICAgICAgICAgICAgICAgICBob2FEb24uZ2V0TmdheUxhcCgpICE9IG51bGwgP1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob2FEb24uZ2V0TmdheUxhcCgpLnRvTG9jYWxEYXRlKCkgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMb2NhbERhdGUubm93KClcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGhvYURvbi5zZXRNYUhEKG1hSEQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBLaeG7g20gdHJhIGPDoWMgxJHhu5FpIHTGsOG7o25nIGxpw6puIHF1YW5cbiAgICAgICAgICAgIGlmIChob2FEb24uZ2V0TG9haUhvYURvbigpICE9IG51bGwgJiYgaG9hRG9uLmdldExvYWlIb2FEb24oKS5nZXRNYUxvYWlIb2FEb24oKSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgLy8gTOG6pXkgbG/huqFpIGjDs2EgxJHGoW4gdOG7qyBkYXRhYmFzZSDEkeG7gyDEkeG6o20gYuG6o28gbGnDqm4ga+G6v3QgxJHDum5nXG4gICAgICAgICAgICAgICAgTG9haUhvYURvbiBsb2FpSEQgPSBnZXRMb2FpSG9hRG9uQnlJZChob2FEb24uZ2V0TG9haUhvYURvbigpLmdldE1hTG9haUhvYURvbigpKTtcbiAgICAgICAgICAgICAgICBpZiAobG9haUhEICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgaG9hRG9uLnNldExvYWlIb2FEb24obG9haUhEKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKFwiS2jDtG5nIHTDrG0gdGjhuqV5IGxv4bqhaSBow7NhIMSRxqFuIHbhu5tpIG3DozogXCIgKyBob2FEb24uZ2V0TG9haUhvYURvbigpLmdldE1hTG9haUhvYURvbigpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEzGsHUgaMOzYSDEkcahbiB2w6BvIGRhdGFiYXNlXG4gICAgICAgICAgICBlbS5wZXJzaXN0KGhvYURvbik7XG4gICAgICAgICAgICB0ci5jb21taXQoKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZXgpIHtcbiAgICAgICAgICAgIGlmICh0ci5pc0FjdGl2ZSgpKSB7XG4gICAgICAgICAgICAgICAgdHIucm9sbGJhY2soKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGV4LnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IFJlbW90ZUV4Y2VwdGlvbihcIkzhu5dpIGtoaSBsxrB1IGjDs2EgxJHGoW46IFwiICsgZXguZ2V0TWVzc2FnZSgpLCBleCk7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICBpZiAoZW0gIT0gbnVsbCAmJiBlbS5pc09wZW4oKSkge1xuICAgICAgICAgICAgICAgIGVtLmNsb3NlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4uLi5cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdHguYmVnaW4oKTtcbiAgICAgICAgICAgIC8vIFVzZSBKT0lOIEZFVENIIHRvIGVhZ2VybHkgbG9hZCByZWxhdGVkIGVudGl0aWVzXG4gICAgICAgICAgICBTdHJpbmcganBxbCA9IFwiU0VMRUNUIGggRlJPTSBIb2FEb24gaCBKT0lOIEZFVENIIGgua2hhY2hIYW5nXCI7XG4gICAgICAgICAgICBsaXN0ID0gZW0uY3JlYXRlUXVlcnkoanBxbCwgSG9hRG9uLmNsYXNzKS5nZXRSZXN1bHRMaXN0KCk7XG5cbiAgICAgICAgICAgIC8vIEVuc3VyZSBhbGwgcmVsYXRlZCBkYXRhIGlzIGxvYWRlZCB3aXRoaW4gdGhlIHRyYW5zYWN0aW9uXG4gICAgICAgICAgICBmb3IgKEhvYURvbiBoZCA6IGxpc3QpIHtcbiAgICAgICAgICAgICAgICBpZiAoaGQuZ2V0S2hhY2hIYW5nKCkgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBoZC5nZXRLaGFjaEhhbmcoKS5nZXRUZW5LaGFjaEhhbmcoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHR4LmNvbW1pdCgpO1xuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgaWYgKHR4ICE9IG51bGwgJiYgdHguaXNBY3RpdmUoKSkge1xuICAgICAgICAgICAgICAgIHR4LnJvbGxiYWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCJM4buXaSBraGkgbOG6pXkgZGFuaCBzw6FjaCBIb2FEb246IFwiICsgZS5nZXRNZXNzYWdlKCkpO1xuICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBSZW1vdGVFeGNlcHRpb24oXCJM4buXaSBraGkgbOG6pXkgZGFuaCBzw6FjaCBIb2FEb25cIiwgZSk7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICBpZiAoZW0gIT0gbnVsbCAmJiBlbS5pc09wZW4oKSkge1xuICAgICAgICAgICAgICAgIGVtLmNsb3NlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbGlzdDtcbiAgICB9XG5cbiAgICAvLyBSZWFkOiBUw6xtIGjDs2EgxJHGoW4gdGhlbyBtw6MgaMOzYSDEkcahblxuICAgIEBPdmVycmlkZVxuICAgIHB1YmxpYyBIb2FEb24gZ2V0SG9hRG9uQnlJZChTdHJpbmcgbWFIRCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcbiAgICAgICAgcmV0dXJuIGVtLmZpbmQoSG9hRG9uLmNsYXNzLCBtYUhEKTtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGU6IEPhuq1wIG5o4bqtdCB0aMO0bmcgdGluIGjDs2EgxJHGoW5cbiAgICBAT3ZlcnJpZGVcbiAgICBwdWJsaWMgYm9vbGVhbiB1cGRhdGVIb2FEb24oSG9hRG9uIGhvYURvbikgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcbiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHIgPSBlbS5nZXRUcmFuc2FjdGlvbigpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdHIuYmVnaW4oKTtcbiAgICAgICAgICAgIGVtLm1lcmdlKGhvYURvbik7XG4gICAgICAgICAgICB0ci5jb21taXQoKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZXgpIHtcbiAgICAgICAgICAgIHRyLnJvbGxiYWNrKCk7XG4gICAgICAgICAgICBleC5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gRGVsZXRlOiBYw7NhIGjDs2EgxJHGoW4gdGhlbyBtw6MgaMOzYSDEkcahblxuICAgIEBPdmVycmlkZVxuICAgIHB1YmxpYyBib29sZWFuIGRlbGV0ZUhvYURvbihTdHJpbmcgbWFIRCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcbiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHIgPSBlbS5nZXRUcmFuc2FjdGlvbigpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdHIuYmVnaW4oKTtcbiAgICAgICAgICAgIEhvYURvbiBob2FEb24gPSBlbS5maW5kKEhvYURvbi5jbGFzcywgbWFIRCk7XG4gICAgICAgICAgICBpZiAoaG9hRG9uICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBlbS5yZW1vdmUoaG9hRG9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRyLmNvbW1pdCgpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBleCkge1xuICAgICAgICAgICAgdHIucm9sbGJhY2soKTtcbiAgICAgICAgICAgIGV4LnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4uLi5cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdHIuYmVnaW4oKTtcblxuICAgICAgICAgICAgLy8gxJDhu4tuaCBk4bqhbmcgcGjhuqduIG5nw6B5IHRow6FuZyBj4bunYSBtw6MgaMOzYSDEkcahbiBraMO0bmcgY8OzIGThuqV1IFwiL1wiXG4gICAgICAgICAgICBEYXRlVGltZUZvcm1hdHRlciBmb3JtYXR0ZXIgPSBEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oXCJ5eXl5TU1kZFwiKTtcbiAgICAgICAgICAgIFN0cmluZyBkYXRlUHJlZml4ID0gXCJIRFwiICsgZm9ybWF0dGVyLmZvcm1hdChuZ2F5KTtcblxuICAgICAgICAgICAgLy8gUXVlcnkgxJHhu4MgdMOsbSBtw6MgaMOzYSDEkcahbiBs4bubbiBuaOG6pXQgdHJvbmcgbmfDoHlcbiAgICAgICAgICAgIFN0cmluZyBqcHFsID0gXCJTRUxFQ1QgaC5tYUhEIEZST00gSG9hRG9uIGggV0hFUkUgaC5tYUhEIExJS0UgOnByZWZpeCBPUkRFUiBCWSBoLm1hSEQgREVTQ1wiO1xuICAgICAgICAgICAgUXVlcnkgcXVlcnkgPSBlbS5jcmVhdGVRdWVyeShqcHFsKVxuICAgICAgICAgICAgICAgICAgICAuc2V0UGFyYW1ldGVyKFwicHJlZml4XCIsIGRhdGVQcmVmaXggKyBcIiVcIilcbiAgICAgICAgICAgICAgICAgICAgLnNldE1heFJlc3VsdHMoMSk7XG5cbiAgICAgICAgICAgIExpc3Q8Pz4gcmVzdWx0cyA9IHF1ZXJ5LmdldFJlc3VsdExpc3QoKTtcblxuICAgICAgICAgICAgLy8gWMOhYyDEkeG7i25oIHPhu5EgdGjhu6kgdOG7sSB0aeG6v3AgdGhlb1xuICAgICAgICAgICAgaW50IG5leHROdW1iZXIgPSAxO1xuXG4gICAgICAgICAgICBpZiAoIXJlc3VsdHMuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgU3RyaW5nIGxhc3RDb2RlID0gKFN0cmluZykgcmVzdWx0cy5nZXQoMCk7XG4gICAgICAgICAgICAgICAgLy8gVHLDrWNoIHh14bqldCBz4buRIHRo4bupIHThu7EgdOG7qyBtw6MgaMOzYSDEkcahbiBjdeG7kWkgY8O5bmdcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAvLyBGb3JtYXQ6IEhEeXl5eU1NZGRYWFhYXG4gICAgICAgICAgICAgICAgICAgIC8vIEzhuqV5IDQga8O9IHThu7EgY3Xhu5FpIGPDuW5nIGPhu6dhIG3DoyBow7NhIMSRxqFuXG4gICAgICAgICAgICAgICAgICAgIFN0cmluZyBudW1iZXJTdHIgPSBsYXN0Q29kZS5zdWJzdHJpbmcobGFzdENvZGUubGVuZ3RoKCkgLSA0KTtcbiAgICAgICAgICAgICAgICAgICAgbmV4dE51bWJlciA9IEludGVnZXIucGFyc2VJbnQobnVtYmVyU3RyKSArIDE7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gTuG6v3UgY8OzIGzhu5dpIGtoaSBwYXJzZSwgbeG6t2MgxJHhu4tuaCBsw6AgMVxuICAgICAgICAgICAgICAgICAgICBuZXh0TnVtYmVyID0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRyLmNvbW1pdCgpO1xuXG4gICAgICAgICAgICAvLyBU4bqhbyBtw6MgaMOzYSDEkcahbiBt4bubaSB24bubaSDEkeG7i25oIGThuqFuZyBIRHl5eXlNTWRkWFhYWFxuICAgICAgICAgICAgcmV0dXJuIFN0cmluZy5mb3JtYXQoXCIlcyUwNGRcIiwgZGF0ZVByZWZpeCwgbmV4dE51bWJlcik7XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGFvL2ltcGwvS2hhY2hIYW5nREFPSW1wbC5qYXZhXG4uLi5cblxuICAgIC8vIEzGsHUga2jDoWNoIGjDoG5nXG5AT3ZlcnJpZGVcbnB1YmxpYyBib29sZWFuIHNhdmUoS2hhY2hIYW5nIGtoYWNoSGFuZykgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgRW50aXR5TWFuYWdlciBlbSA9IEpQQVV0aWwuZ2V0RW50aXR5TWFuYWdlcigpO1xuICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcbiAgICB0cnkge1xuICAgICAgICB0ci5iZWdpbigpO1xuICAgICAgICBlbS5wZXJzaXN0KGtoYWNoSGFuZyk7XG4gICAgICAgIHRyLmNvbW1pdCgpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICBpZiAodHIgIT0gbnVsbCAmJiB0ci5pc0FjdGl2ZSgpKSB7XG4gICAgICAgICAgICB0ci5yb2xsYmFjaygpO1xuICAgICAgICB9XG4gICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihcIkzhu5dpIGtoaSBsxrB1IEtoYWNoSGFuZzogXCIgKyBlLmdldE1lc3NhZ2UoKSk7XG4gICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgIHRocm93IG5ldyBSZW1vdGVFeGNlcHRpb24oXCJM4buXaSBraGkgbMawdSBLaGFjaEhhbmdcIiwgZSk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgICAgaWYgKGVtICE9IG51bGwgJiYgZW0uaXNPcGVuKCkpIHtcbiAgICAgICAgICAgIGVtLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICB9XG59XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGFvL2ltcGwvTmhhblZpZW5EQU9JbXBsLmphdmFcbi4uLlxuICAgIEBPdmVycmlkZVxuICAgIHB1YmxpYyBib29sZWFuIHNhdmUoTmhhblZpZW4gbnYpIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xuICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0ciA9IGVtLmdldFRyYW5zYWN0aW9uKCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0ci5iZWdpbigpO1xuICAgICAgICAgICAgZW0ucGVyc2lzdChudik7XG5cbiAgICAgICAgICAgIC8vY3JlYXRlIHRhaSBraG9hbiB24bubaSBOaGFuVmllblxuICAgICAgICAgICAgVGFpS2hvYW4gdGFpS2hvYW4gPSBuZXcgVGFpS2hvYW4oKTtcbiAgICAgICAgICAgIHRhaUtob2FuLnNldE1hTlYobnYuZ2V0TWFOVigpKTtcbiAgICAgICAgICAgIHRhaUtob2FuLnNldFBhc3NXb3JkKFwiQWJjMTIzLlwiKTtcbiAgICAgICAgICAgIHRhaUtob2FuLnNldE5oYW5WaWVuKG52KTtcbiAgICAgICAgICAgIGVtLnBlcnNpc3QodGFpS2hvYW4pO1xuXG4gICAgICAgICAgICB0ci5jb21taXQoKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgIHRyLnJvbGxiYWNrKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIEBPdmVycmlkZVxuICAgIHB1YmxpYyBib29sZWFuIHVwZGF0ZShOaGFuVmllbiBudikgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRyLmJlZ2luKCk7XG4gICAgICAgICAgICBlbS5tZXJnZShudik7XG4gICAgICAgICAgICB0ci5jb21taXQoKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgIHRyLnJvbGxiYWNrKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9kYW8vaW1wbC9WZVRhdURBT0ltcGwuamF2YVxucGFja2FnZSBkYW8uaW1wbDtcblxuaW1wb3J0IGRhby5WZVRhdURBTztcbmltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXI7XG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS5FbnRpdHlUcmFuc2FjdGlvbjtcbmltcG9ydCBtb2RlbC5Ib2FEb247XG5pbXBvcnQgbW9kZWwuS2hhY2hIYW5nO1xuaW1wb3J0IG1vZGVsLlRyYW5nVGhhaVZlVGF1O1xuaW1wb3J0IG1vZGVsLlZlVGF1O1xuaW1wb3J0IHV0aWwuSlBBVXRpbDtcblxuaW1wb3J0IGphdmEucm1pLlJlbW90ZUV4Y2VwdGlvbjtcbmltcG9ydCBqYXZhLnJtaS5zZXJ2ZXIuVW5pY2FzdFJlbW90ZU9iamVjdDtcbmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDtcbmltcG9ydCBqYXZhLnV0aWwuTGlzdDtcbmltcG9ydCBqYXZhLnV0aWwuTWFwO1xuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2Rhby9pbXBsL0RvaVZlREFPSW1wbC5qYXZhXG4uLi5cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdHguYmVnaW4oKTtcblxuICAgICAgICAgICAgLy8gRm9yIG5hdGl2ZSBxdWVyaWVzIHdpdGggbmFtZWQgcGFyYW1ldGVycywgdXNlIDpuYW1lIG5vdGF0aW9uXG4gICAgICAgICAgICBTdHJpbmcgbmF0aXZlUXVlcnkgPVxuICAgICAgICAgICAgICAgICAgICBcIlNFTEVDVCBraC4qIEZST00ga2hhY2hoYW5nIGtoIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkpPSU4gaG9hZG9uIGhkIE9OIGhkLm1hX2toYWNoX2hhbmcgPSBraC5tYV9raGFjaF9oYW5nIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkpPSU4gY2hpdGlldF9ob2Fkb24gY3RoZCBPTiBjdGhkLm1hX2hkID0gaGQubWFfaGQgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiV0hFUkUgY3RoZC5tYV92ZSA9ID9cIjtcblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBraGFjaEhhbmcgPSAoS2hhY2hIYW5nKSBlbS5jcmVhdGVOYXRpdmVRdWVyeShuYXRpdmVRdWVyeSwgS2hhY2hIYW5nLmNsYXNzKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnNldFBhcmFtZXRlcigxLCBtYVZlKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmdldFNpbmdsZVJlc3VsdCgpO1xuXG4gICAgICAgICAgICAgICAgLy8gRW5zdXJlIHJlbGF0ZWQgZGF0YSBpcyBsb2FkZWQgaWYgbmVlZGVkXG4gICAgICAgICAgICAgICAgaWYgKGtoYWNoSGFuZyAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGtoYWNoSGFuZy5nZXRNYUtoYWNoSGFuZygpOyAvLyBUcmlnZ2VyIGxvYWRpbmdcblxuICAgICAgICAgICAgICAgICAgICAvLyBJZiB5b3UgbmVlZCB0byBsb2FkIHRoZSBsb2FpS2hhY2hIYW5nIHJlbGF0aW9uXG4gICAgICAgICAgICAgICAgICAgIGlmIChraGFjaEhhbmcuZ2V0TG9haUtoYWNoSGFuZygpICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGtoYWNoSGFuZy5nZXRMb2FpS2hhY2hIYW5nKCkuZ2V0TWFMb2FpS2hhY2hIYW5nKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKE5vUmVzdWx0RXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICAvLyBObyBjdXN0b21lciBmb3VuZCBmb3IgdGhpcyB0aWNrZXRcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9kYW8vaW1wbC9UYXVEQU9JbXBsLmphdmFcbi4uLlxuICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFwiRXJyb3IgZmV0Y2hpbmcgVGF1IGJ5IExpY2hUcmluaFRhdTogXCIgKyBlLmdldE1lc3NhZ2UoKSk7XG4gICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IFJlbW90ZUV4Y2VwdGlvbihcIkVycm9yIGZldGNoaW5nIFRhdSBieSBMaWNoVHJpbmhUYXVcIiwgZSk7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICBpZiAoZW0gIT0gbnVsbCAmJiBlbS5pc09wZW4oKSkge1xuICAgICAgICAgICAgICAgIGVtLmNsb3NlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGF1O1xuICAgIH1cblxuICAgIHB1YmxpYyBib29sZWFuIHNhdmUoVGF1IHQpIHtcbiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IEpQQVV0aWwuZ2V0RW50aXR5TWFuYWdlcigpO1xuICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0ciA9IGVtLmdldFRyYW5zYWN0aW9uKCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0ci5iZWdpbigpO1xuICAgICAgICAgICAgZW0ucGVyc2lzdCh0KTtcbiAgICAgICAgICAgIHRyLmNvbW1pdCgpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1jYXRjaChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgIHRyLnJvbGxiYWNrKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHB1YmxpYyBib29sZWFuIHVwZGF0ZShUYXUgdCkge1xuICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gSlBBVXRpbC5nZXRFbnRpdHlNYW5hZ2VyKCk7XG4gICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRyLmJlZ2luKCk7XG4gICAgICAgICAgICBlbS5tZXJnZSh0KTtcbiAgICAgICAgICAgIHRyLmNvbW1pdCgpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1jYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgICAgICB0ci5yb2xsYmFjaygpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvbW9kZWwvSG9hRG9uLmphdmFcbnBhY2thZ2UgbW9kZWw7XG5cblxuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuKjtcbmltcG9ydCBsb21ib2suRGF0YTtcbmltcG9ydCBsb21ib2suRXF1YWxzQW5kSGFzaENvZGU7XG5pbXBvcnQgbG9tYm9rLlRvU3RyaW5nO1xuXG5pbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7XG5pbXBvcnQgamF2YS50aW1lLkxvY2FsRGF0ZTtcbmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlVGltZTtcbmltcG9ydCBqYXZhLnV0aWwuT2JqZWN0cztcbmltcG9ydCBqYXZhLnV0aWwuU2V0O1xuXG5ARGF0YVxuQEVudGl0eVxuQFRhYmxlKG5hbWUgPSBcImhvYWRvblwiKVxuQEVxdWFsc0FuZEhhc2hDb2RlKG9ubHlFeHBsaWNpdGx5SW5jbHVkZWQgPSB0cnVlKVxucHVibGljIGNsYXNzIEhvYURvbiBpbXBsZW1lbnRzIFNlcmlhbGl6YWJsZSB7XG4gICAgQElkXG4gICAgQENvbHVtbihuYW1lID0gXCJtYV9oZFwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJ2YXJjaGFyKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSwgdW5pcXVlID0gdHJ1ZSlcbiAgICBARXF1YWxzQW5kSGFzaENvZGUuSW5jbHVkZVxuICAgIHByaXZhdGUgU3RyaW5nIG1hSEQ7XG5cbiAgICBAQ29sdW1uKG5hbWUgPSBcIm5nYXlfbGFwXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcImRhdGV0aW1lXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBMb2NhbERhdGVUaW1lIG5nYXlMYXA7XG4gICAgQENvbHVtbihuYW1lID0gXCJ0aWVuX2dpYW1cIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiZG91YmxlXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBkb3VibGUgdGllbkdpYW07XG4gICAgQENvbHVtbihuYW1lID0gXCJ0b25nX3RpZW5cIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiZG91YmxlXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBkb3VibGUgdG9uZ1RpZW47XG5cbiAgICBAVG9TdHJpbmcuRXhjbHVkZVxuICAgIEBNYW55VG9PbmUoZmV0Y2ggPSBGZXRjaFR5cGUuTEFaWSlcbiAgICBASm9pbkNvbHVtbihuYW1lID0gXCJtYV9raGFjaF9oYW5nXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBLaGFjaEhhbmcga2hhY2hIYW5nO1xuXG4gICAgQFRvU3RyaW5nLkV4Y2x1ZGVcbiAgICBATWFueVRvT25lKGZldGNoID0gRmV0Y2hUeXBlLkxBWlkpXG4gICAgQEpvaW5Db2x1bW4obmFtZSA9IFwibWFfbmhhbl92aWVuXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBOaGFuVmllbiBudjtcblxuICAgIEBUb1N0cmluZy5FeGNsdWRlXG4gICAgQE1hbnlUb09uZShmZXRjaCA9IEZldGNoVHlwZS5MQVpZKVxuICAgIEBKb2luQ29sdW1uKG5hbWUgPSBcIm1hX2xvYWlfaGRcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIExvYWlIb2FEb24gbG9haUhvYURvbjtcblxuLy8gICAgQE1hbnlUb01hbnlcbi8vICAgIEBKb2luVGFibGUobmFtZSA9IFwiY2hpdGlldF9ob2Fkb25cIixcbi8vICAgICAgICAgICAgam9pbkNvbHVtbnMgPSBASm9pbkNvbHVtbihuYW1lID0gXCJtYV9oZFwiKSxcbi8vICAgICAgICAgICAgaW52ZXJzZUpvaW5Db2x1bW5zID0gQEpvaW5Db2x1bW4obmFtZSA9IFwibWFfdmVcIikpXG4vLyAgICBwcml2YXRlIFNldDxWZVRhdT4gdmVUYXVzO1xuXG4gICAgQE9uZVRvTWFueShtYXBwZWRCeSA9IFwiaG9hRG9uXCIpXG4gICAgQFRvU3RyaW5nLkV4Y2x1ZGVcbiAgICBwcml2YXRlIFNldDxDaGlUaWV0SG9hRG9uPiBjaGlUaWV0SG9hRG9ucztcbn1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9tb2RlbC9OaGFuVmllbi5qYXZhXG5wYWNrYWdlIG1vZGVsO1xuXG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS4qO1xuaW1wb3J0IGxvbWJvay4qO1xuXG5pbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7XG5pbXBvcnQgamF2YS50aW1lLkxvY2FsRGF0ZTtcbmltcG9ydCBqYXZhLnV0aWwuU2V0O1xuLyoqXG4gKiBAROG7sSDDoW46IEFwcFxuICogQENsYXNzOiBOaGFuVmllblxuICogQFThuqFvIHbDoG8gbmfDoHk6IDE1LzAxLzIwMjVcbiAqIEBUw6FjIGdp4bqjOiBOZ3V5ZW4gSHV1IFNhbmdcbiAqL1xuQERhdGFcbkBFbnRpdHlcbkBUYWJsZShuYW1lID0gXCJuaGFudmllblwiKVxuQEVxdWFsc0FuZEhhc2hDb2RlKG9ubHlFeHBsaWNpdGx5SW5jbHVkZWQgPSB0cnVlKVxuQEFsbEFyZ3NDb25zdHJ1Y3RvclxuQE5vQXJnc0NvbnN0cnVjdG9yXG5ATmFtZWROYXRpdmVRdWVyaWVzKHtcbiAgICAgICAgQE5hbWVkTmF0aXZlUXVlcnkobmFtZSA9IFwiTmhhblZpZW4uZmluZEJ5TWFOVlwiLFxuICAgICAgICAgICAgICAgIHF1ZXJ5ID0gXCJzZWxlY3QgKiBmcm9tIG5oYW52aWVuIHdoZXJlIG1hX252ID0gOm1hTlZcIixcbiAgICAgICAgICAgICAgICByZXN1bHRDbGFzcyA9IE5oYW5WaWVuLmNsYXNzKSxcbiAgICAgICAgQE5hbWVkTmF0aXZlUXVlcnkobmFtZSA9IFwiTmhhblZpZW4uZmluZEFsbFwiLFxuICAgICAgICAgICAgICAgIHF1ZXJ5ID0gXCJzZWxlY3QgKiBmcm9tIG5oYW52aWVuXCIsXG4gICAgICAgICAgICAgICAgcmVzdWx0Q2xhc3MgPSBOaGFuVmllbi5jbGFzcylcbn0pXG5wdWJsaWMgY2xhc3MgTmhhblZpZW4gaW1wbGVtZW50cyBTZXJpYWxpemFibGUge1xuICAgIEBJZFxuICAgIEBFcXVhbHNBbmRIYXNoQ29kZS5JbmNsdWRlXG4gICAgQENvbHVtbihuYW1lID0gXCJtYV9udlwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJ2YXJjaGFyKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSwgdW5pcXVlID0gdHJ1ZSlcbiAgICBwcml2YXRlIFN0cmluZyBtYU5WOyAvLyBNw6MgbmjDom4gdmnDqm5cblxuICAgIEBDb2x1bW4obmFtZSA9IFwidGVuX252XCIsIGNvbHVtbkRlZmluaXRpb24gPSBcInZhcmNoYXIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgU3RyaW5nIHRlbk5WOyAvLyBUw6puIG5ow6JuIHZpw6puXG4gICAgQEVxdWFsc0FuZEhhc2hDb2RlLkV4Y2x1ZGVcblxuICAgIEBDb2x1bW4obmFtZSA9IFwic29fZHRcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwidmFyY2hhcigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBTdHJpbmcgc29EVDsgLy8gU+G7kSDEkWnhu4duIHRob+G6oWlcbiAgICBARXF1YWxzQW5kSGFzaENvZGUuRXhjbHVkZVxuXG4gICAgQENvbHVtbihuYW1lID0gXCJ0cmFuZ190aGFpXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcInZhcmNoYXIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgU3RyaW5nIHRyYW5nVGhhaTsgLy8gVHLhuqFuZyB0aMOhaVxuICAgIEBFcXVhbHNBbmRIYXNoQ29kZS5FeGNsdWRlXG5cbiAgICBAQ29sdW1uKG5hbWUgPSBcImNjY2RcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwidmFyY2hhcigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBTdHJpbmcgY2NjZDsgLy8gQ2jhu6luZyBjaOG7iSBjw7RuZyBkw6JuXG4gICAgQEVxdWFsc0FuZEhhc2hDb2RlLkV4Y2x1ZGVcblxuICAgIEBDb2x1bW4obmFtZSA9IFwiZGlhX2NoaVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJ2YXJjaGFyKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIFN0cmluZyBkaWFDaGk7IC8vIMSQ4buLYSBjaOG7iVxuICAgIEBFcXVhbHNBbmRIYXNoQ29kZS5FeGNsdWRlXG5cbiAgICBAQ29sdW1uKG5hbWUgPSBcIm5nYXlfdmFvX2xhbVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJkYXRlXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBMb2NhbERhdGUgbmdheVZhb0xhbTsgLy8gTmfDoHkgdsOgbyBsw6BtXG4gICAgQEVxdWFsc0FuZEhhc2hDb2RlLkV4Y2x1ZGVcblxuICAgIEBDb2x1bW4obmFtZSA9IFwiY2h1Y192dVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJ2YXJjaGFyKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIFN0cmluZyBjaHVjVnU7IC8vIENo4bupYyB24bulXG4gICAgQEVxdWFsc0FuZEhhc2hDb2RlLkV4Y2x1ZGVcblxuICAgIEBDb2x1bW4obmFtZSA9IFwiYXZhdGFcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwidmFyY2hhcigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBTdHJpbmcgYXZhdGE7IC8vIOG6om5oIMSR4bqhaSBkaeG7h25cbiAgICBARXF1YWxzQW5kSGFzaENvZGUuRXhjbHVkZVxuXG4gICAgLy8gTeG7mXQgbmjDom4gdmnDqm4gY2jhu4kgY8OzIG3hu5l0IHTDoGkga2hv4bqjblxuICAgIEBPbmVUb09uZShtYXBwZWRCeSA9IFwibmhhblZpZW5cIiwgY2FzY2FkZSA9IENhc2NhZGVUeXBlLkFMTCwgZmV0Y2ggPSBGZXRjaFR5cGUuTEFaWSlcbiAgICBAVG9TdHJpbmcuRXhjbHVkZVxuICAgIHByaXZhdGUgVGFpS2hvYW4gdGFpS2hvYW47XG5cblxuICAgIC8vIE3hu5l0IG5ow6JuIHZpw6puIGPDsyBuaGnhu4F1IGzhu4tjaCBsw6BtIHZp4buHY1xuICAgIEBPbmVUb01hbnkobWFwcGVkQnkgPSBcIm5oYW5WaWVuXCIsIGNhc2NhZGUgPSBDYXNjYWRlVHlwZS5BTEwsIG9ycGhhblJlbW92YWwgPSB0cnVlKVxuICAgIEBUb1N0cmluZy5FeGNsdWRlXG4gICAgcHJpdmF0ZSBTZXQ8TGljaExhbVZpZWM+IGRhbmhTYWNoTGljaExhbVZpZWM7XG5cbiAgICAvLyBN4buZdCBuaMOibiB2acOqbiBjw7Mgbmhp4buBdSBow7NhIMSRxqFuXG4gICAgQE9uZVRvTWFueShtYXBwZWRCeSA9IFwibnZcIiwgY2FzY2FkZSA9IENhc2NhZGVUeXBlLkFMTCwgb3JwaGFuUmVtb3ZhbCA9IHRydWUpXG4gICAgQFRvU3RyaW5nLkV4Y2x1ZGVcbiAgICBwcml2YXRlIFNldDxIb2FEb24+IGRhbmhTYWNoSG9hRG9uO1xuXG5cblxufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL21vZGVsL0xvYWlIb2FEb24uamF2YVxucGFja2FnZSBtb2RlbDtcblxuXG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS4qO1xuaW1wb3J0IGxvbWJvay5EYXRhO1xuaW1wb3J0IGxvbWJvay5FcXVhbHNBbmRIYXNoQ29kZTtcbmltcG9ydCBsb21ib2suVG9TdHJpbmc7XG5cbmltcG9ydCBqYXZhLmlvLlNlcmlhbGl6YWJsZTtcbmltcG9ydCBqYXZhLnV0aWwuU2V0O1xuXG5ARGF0YVxuQEVxdWFsc0FuZEhhc2hDb2RlKG9ubHlFeHBsaWNpdGx5SW5jbHVkZWQgPSB0cnVlKVxuQEVudGl0eVxuQFRhYmxlKG5hbWUgPSBcImxvYWlob2Fkb25cIilcbkBUb1N0cmluZ1xucHVibGljIGNsYXNzIExvYWlIb2FEb24gaW1wbGVtZW50cyBTZXJpYWxpemFibGUge1xuICAgIEBJZFxuICAgIEBDb2x1bW4obmFtZSA9IFwibWFfbG9haV9oZFwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJ2YXJjaGFyKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSwgdW5pcXVlID0gdHJ1ZSlcbiAgICBARXF1YWxzQW5kSGFzaENvZGUuSW5jbHVkZVxuICAgIHByaXZhdGUgU3RyaW5nIG1hTG9haUhvYURvbjtcbiAgICBAQ29sdW1uKG5hbWUgPSBcInRlbl9sb2FpX2hkXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcIk5WQVJDSEFSKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIFN0cmluZyB0ZW5Mb2FpSG9hRG9uO1xuXG4gICAgQE9uZVRvTWFueShtYXBwZWRCeSA9IFwibG9haUhvYURvblwiKVxuICAgIEBUb1N0cmluZy5FeGNsdWRlXG4gICAgcHJpdmF0ZSBTZXQ8SG9hRG9uPiBob2FEb25zO1xuXG5cblxuXG59XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvbW9kZWwvS2hhY2hIYW5nLmphdmFcbi4uLlxuXG5ARW50aXR5XG5ARXF1YWxzQW5kSGFzaENvZGUob25seUV4cGxpY2l0bHlJbmNsdWRlZCA9IHRydWUpXG5ARGF0YVxucHVibGljIGNsYXNzIEtoYWNoSGFuZyBpbXBsZW1lbnRzIFNlcmlhbGl6YWJsZSB7XG4gICAgQElkXG4gICAgQEVxdWFsc0FuZEhhc2hDb2RlLkluY2x1ZGVcbiAgICBAQ29sdW1uKG5hbWUgPSBcIm1hX2toYWNoX2hhbmdcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwidmFyY2hhcigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UsIHVuaXF1ZSA9IHRydWUpXG4gICAgcHJpdmF0ZSBTdHJpbmcgbWFLaGFjaEhhbmc7XG4gICAgQENvbHVtbihuYW1lID0gXCJzZHRcIiAsIGNvbHVtbkRlZmluaXRpb24gPSBcInZhcmNoYXIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgU3RyaW5nIHNvRGllblRob2FpO1xuICAgIEBDb2x1bW4obmFtZSA9IFwidGVuX2toYWNoX2hhbmdcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwidmFyY2hhcigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBTdHJpbmcgdGVuS2hhY2hIYW5nO1xuICAgIEBDb2x1bW4obmFtZSA9IFwiZ2lheV90b1wiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJ2YXJjaGFyKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIFN0cmluZyBnaWF5VG87XG4gICAgQENvbHVtbihuYW1lID0gXCJkaWFfY2hpXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcInZhcmNoYXIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgU3RyaW5nIGRpYUNoaTtcbiAgICBAQ29sdW1uKG5hbWUgPSBcImRpZW1fdGljaF9sdXlcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiZG91YmxlXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBkb3VibGUgZGllbVRpY2hMdXk7XG4gICAgQENvbHVtbihuYW1lID0gXCJuZ2F5X3NpbmhcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiZGF0ZVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgTG9jYWxEYXRlIG5nYXlTaW5oO1xuICAgIEBDb2x1bW4obmFtZSA9IFwibmdheV90aGFtX2dpYVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJkYXRlXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBMb2NhbERhdGUgbmdheVRoYW1nR2lhO1xuICAgIEBDb2x1bW4obmFtZSA9IFwiaGFuZ190aGFuaF92aWVuXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcInZhcmNoYXIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgU3RyaW5nIGhhbmdUaGFuaFZpZW47XG5cbiAgICBATWFueVRvT25lXG4gICAgQEpvaW5Db2x1bW4obmFtZSA9IFwibWFfbG9haV9raGFjaF9oYW5nXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgQFRvU3RyaW5nLkV4Y2x1ZGVcbiAgICBwcml2YXRlIExvYWlLaGFjaEhhbmcgbG9haUtoYWNoSGFuZztcblxuICAgIEBUb1N0cmluZy5FeGNsdWRlXG4gICAgQE9uZVRvTWFueShtYXBwZWRCeSA9IFwia2hhY2hIYW5nXCIpXG4gICAgcHJpdmF0ZSBTZXQ8SG9hRG9uPiBob2FEb25zO1xufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL21vZGVsL0Nob05nb2kuamF2YVxucGFja2FnZSBtb2RlbDtcblxuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuKjtcbmltcG9ydCBsb21ib2suRGF0YTtcbmltcG9ydCBsb21ib2suRXF1YWxzQW5kSGFzaENvZGU7XG5pbXBvcnQgbG9tYm9rLlRvU3RyaW5nO1xuXG5pbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7XG5cbkBFbnRpdHlcbkBEYXRhXG5ARXF1YWxzQW5kSGFzaENvZGUob25seUV4cGxpY2l0bHlJbmNsdWRlZCA9IHRydWUpXG5AVGFibGUobmFtZSA9IFwiY2hvX25nb2lcIilcbnB1YmxpYyBjbGFzcyBDaG9OZ29pIGltcGxlbWVudHMgU2VyaWFsaXphYmxlIHtcbiAgICBASWRcbiAgICBARXF1YWxzQW5kSGFzaENvZGUuSW5jbHVkZVxuICAgIEBDb2x1bW4obmFtZSA9IFwibWFfY2hvXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcIlZBUkNIQVIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlLCB1bmlxdWUgPSB0cnVlKVxuICAgIHByaXZhdGUgU3RyaW5nIG1hQ2hvO1xuICAgIEBDb2x1bW4obmFtZSA9IFwidGVuX2Nob1wiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJOVkFSQ0hBUigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBTdHJpbmcgdGVuQ2hvO1xuICAgIEBDb2x1bW4obmFtZSA9IFwidGluaF90cmFuZ1wiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJCSVRcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIGJvb2xlYW4gdGluaFRyYW5nO1xuICAgIEBDb2x1bW4obmFtZSA9IFwiZ2lhX3RpZW5cIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiRkxPQVRcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIGRvdWJsZSBnaWFUaWVuO1xuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL21vZGVsL1ZlVGF1LmphdmFcbi4uLlxuXG5ARW50aXR5XG5ARGF0YVxuQEVxdWFsc0FuZEhhc2hDb2RlKG9ubHlFeHBsaWNpdGx5SW5jbHVkZWQgPSB0cnVlKVxuQFRhYmxlKG5hbWUgPSBcInZldGF1XCIpXG5wdWJsaWMgY2xhc3MgVmVUYXUgaW1wbGVtZW50cyBTZXJpYWxpemFibGUge1xuICAgIEBJZFxuICAgIEBDb2x1bW4obmFtZSA9IFwibWFfdmVcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiVkFSQ0hBUigyNTUpXCIsIHVuaXF1ZSA9IHRydWUsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBTdHJpbmcgbWFWZTtcbiAgICBAQ29sdW1uKG5hbWUgPSBcInRlbl9raGFjaF9oYW5nXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcIlZBUkNIQVIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuXG4gICAgcHJpdmF0ZSBTdHJpbmcgdGVuS2hhY2hIYW5nO1xuICAgIEBDb2x1bW4obmFtZSA9IFwiZ2lheV90b1wiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJWQVJDSEFSKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSlcblxuICAgIHByaXZhdGUgU3RyaW5nIGdpYXlUbztcbiAgICBAQ29sdW1uKG5hbWUgPSBcIm5nYXlfZGlcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiREFURVwiLG51bGxhYmxlID0gZmFsc2UpXG5cbiAgICBwcml2YXRlIExvY2FsRGF0ZSBuZ2F5RGk7XG4gICAgQENvbHVtbihuYW1lID0gXCJkb2lfdHVvbmdcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiVkFSQ0hBUigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG5cbiAgICBwcml2YXRlIFN0cmluZyBkb2lUdW9uZztcbiAgICBAQ29sdW1uKG5hbWUgPSBcImdpYV92ZVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJGTE9BVFwiLCBudWxsYWJsZSA9IGZhbHNlKVxuXG4gICAgcHJpdmF0ZSBkb3VibGUgZ2lhVmU7XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvbW9kZWwvQ2hpVGlldEhvYURvbi5qYXZhXG4uLi5cblxuQERhdGFcbkBFbnRpdHlcbkBUYWJsZShuYW1lID0gXCJjaGl0aWV0X2hvYWRvblwiKVxucHVibGljIGNsYXNzIENoaVRpZXRIb2FEb24gaW1wbGVtZW50cyBTZXJpYWxpemFibGUge1xuXG4gICAgQEVtYmVkZGVkSWRcbiAgICBwcml2YXRlIENoaVRpZXRIb2FEb25JZCBpZDtcblxuICAgIEBUb1N0cmluZy5FeGNsdWRlXG4gICAgQE1hbnlUb09uZShmZXRjaCA9IEZldGNoVHlwZS5MQVpZKVxuICAgIEBNYXBzLi4uIiwiaXNfZXJyb3IiOmZhbHNlLCJyZXF1ZXN0X2lkIjoiIiwidG9vbF91c2VfaWQiOiJ0b29sdV8wMTYyQnVmb1V6cURTcXg1N1pTTTVIRW0ifX0seyJpZCI6MiwidHlwZSI6NCwiaWRlX3N0YXRlX25vZGUiOnsid29ya3NwYWNlRm9sZGVycyI6W3sicmVwb3NpdG9yeVJvb3QiOiJFOi9MVFBUSkFWQS9OaG9tL1BoYW5UYW5KYXZhTmhvbUdQVC9Qcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyIsImZvbGRlclJvb3QiOiJFOi9MVFBUSkFWQS9OaG9tL1BoYW5UYW5KYXZhTmhvbUdQVC9Qcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyJ9XSwid29ya3NwYWNlRm9sZGVyc1VuY2hhbmdlZCI6ZmFsc2V9fV0sInJlc3BvbnNlX3RleHQiOiJMZXQgbWUgZ2V0IG1vcmUgaW5mb3JtYXRpb24gYWJvdXQgdGhlIFRoYW5oVG9hbkdVSSBjbGFzcyB3aGVyZSB0aGUgZXJyb3IgaXMgYmVpbmcgdHJpZ2dlcmVkOlxuIiwid29ya3NwYWNlX2ZpbGVfY2h1bmtzIjpbXX0seyJzdGF0dXMiOiJzdWNjZXNzIiwicmVxdWVzdF9pZCI6IjFkMjdlZTNjLWZlNTMtNGJjMy1iMzY3LTBiYjkwMWIxYzk3ZSIsInJlcXVlc3RfbWVzc2FnZSI6IiIsInN0cnVjdHVyZWRfb3V0cHV0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6NSwiY29udGVudCI6IiIsInRvb2xfdXNlIjp7InRvb2xfdXNlX2lkIjoidG9vbHVfMDFOV2hqa0U4elZETTNxc0JoMzluSlBBIiwidG9vbF9uYW1lIjoiY29kZWJhc2UtcmV0cmlldmFsIiwiaW5wdXRfanNvbiI6IntcImluZm9ybWF0aW9uX3JlcXVlc3RcIjogXCJTaG93IG1lIHRoZSBjb21wbGV0ZSBwcm9jZXNzUGF5bWVudCBtZXRob2QgaW4gVGhhbmhUb2FuR1VJLmphdmEsIHBhcnRpY3VsYXJseSBmb2N1c2luZyBvbiBob3cgaXQgY3JlYXRlcyBhbmQgc2F2ZXMgdGhlIEhvYURvbiBvYmplY3Qgd2l0aCB0aGUgTmhhblZpZW4gcmVmZXJlbmNlLlwifSJ9fSx7ImlkIjowLCJ0eXBlIjowLCJjb250ZW50IjoiTGV0IG1lIGdldCBtb3JlIGluZm9ybWF0aW9uIGFib3V0IHRoZSBUaGFuaFRvYW5HVUkncyBwcm9jZXNzUGF5bWVudCBtZXRob2Qgc2luY2UgaXQgd2Fzbid0IGZ1bGx5IHNob3duIGluIHRoZSBwcmV2aW91cyByZXRyaWV2YWw6XG4ifSx7ImlkIjoyLCJ0eXBlIjoyLCJjb250ZW50IjoiIn0seyJpZCI6MywidHlwZSI6MywiY29udGVudCI6IiJ9XSwic2Vlbl9zdGF0ZSI6InNlZW4iLCJzdHJ1Y3R1cmVkX3JlcXVlc3Rfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjoxLCJ0b29sX3Jlc3VsdF9ub2RlIjp7ImNvbnRlbnQiOiJUaGUgZm9sbG93aW5nIGNvZGUgc2VjdGlvbnMgd2VyZSByZXRyaWV2ZWQ6XG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9UaGFuaFRvYW5HVUkuamF2YVxuLi4uXG5cbiAgICAvLyBQYXltZW50IGZpZWxkc1xuICAgIHByaXZhdGUgSlRleHRGaWVsZCBhbW91bnRQYWlkRmllbGQ7XG4gICAgcHJpdmF0ZSBKTGFiZWwgY2hhbmdlQW1vdW50TGFiZWw7XG5cbiAgICAvLyBEYXRhXG4gICAgcHJpdmF0ZSBNYXA8U3RyaW5nLCBTdHJpbmc+IHRpY2tldHNNYXA7IC8vIE1hcCBvZiBzZWF0IElEcyB0byBzY2hlZHVsZSBJRHNcbiAgICBwcml2YXRlIENvbG9yIHByaW1hcnlDb2xvciA9IG5ldyBDb2xvcigwLCAxMzYsIDIwNCk7XG5cbiAgICAvLyBFbXBsb3llZSBpbmZvcm1hdGlvblxuICAgIHByaXZhdGUgTmhhblZpZW4gbmhhblZpZW47XG5cbiAgICAvLyBEQU9zXG4gICAgcHJpdmF0ZSBMaWNoVHJpbmhUYXVEQU8gbGljaFRyaW5oVGF1REFPO1xuICAgIHByaXZhdGUgQ2hvTmdvaURBTyBjaG9OZ29pREFPO1xuICAgIHByaXZhdGUgVG9hVGF1REFPIHRvYVRhdURBTztcbiAgICBwcml2YXRlIFRhdURBTyB0YXVEQU87XG4gICAgcHJpdmF0ZSBLaHV5ZW5NYWlEQU8ga2h1eWVuTWFpREFPO1xuICAgIHByaXZhdGUgS2hhY2hIYW5nREFPIGtoYWNoSGFuZ0RBTztcbiAgICBwcml2YXRlIGRhby5Mb2FpS2hhY2hIYW5nREFPIGxvYWlLaGFjaEhhbmdEQU87XG4gICAgcHJpdmF0ZSBWZVRhdURBTyB2ZVRhdURBTztcbiAgICBwcml2YXRlIEhvYURvbkRBTyBob2FEb25EQU87XG4gICAgcHJpdmF0ZSBDaGlUaWV0SG9hRG9uREFPIGNoaVRpZXRIb2FEb25EQU87XG4gICAgcHJpdmF0ZSBMb2FpSG9hRG9uREFPIGxvYWlIb2FEb25EQU87XG5cbiAgICAvKipcbiAgICAgKiBDb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB0aWNrZXRzTWFwIE1hcCBvZiBzZWF0IElEcyB0byBzY2hlZHVsZSBJRHNcbiAgICAgKiBAcGFyYW0gbnYgVGhlIGVtcGxveWVlIHdobyBpcyBwcm9jZXNzaW5nIHRoZSBwYXltZW50XG4gICAgICovXG4gICAgcHVibGljIFRoYW5oVG9hbkdVSShNYXA8U3RyaW5nLCBTdHJpbmc+IHRpY2tldHNNYXAsIE5oYW5WaWVuIG52KSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uIHtcbiAgICAgICAgdGhpcy50aWNrZXRzTWFwID0gdGlja2V0c01hcDtcbiAgICAgICAgdGhpcy5uaGFuVmllbiA9IG52O1xuXG4gICAgICAgIC8vIEluaXRpYWxpemUgREFPc1xuICAgICAgICBsaWNoVHJpbmhUYXVEQU8gPSBuZXcgTGljaFRyaW5oVGF1REFPSW1wbCgpO1xuICAgICAgICBjaG9OZ29pREFPID0gbmV3IENob05nb2lEQU9JbXBsKCk7XG4gICAgICAgIHRvYVRhdURBTyA9IG5ldyBUb2FUYXVEQU9JbXBsKCk7XG4gICAgICAgIHRhdURBTyA9IG5ldyBUYXVEQU9JbXBsKCk7XG4gICAgICAgIGtodXllbk1haURBTyA9IG5ldyBLaHV5ZW5NYWlEQU9JbXBsKCk7XG4gICAgICAgIGtoYWNoSGFuZ0RBTyA9IG5ldyBLaGFjaEhhbmdEQU9JbXBsKCk7XG4gICAgICAgIGxvYWlLaGFjaEhhbmdEQU8gPSBuZXcgTG9haUtoYWNoSGFuZ0RBT0ltcGwoKTtcblxuICAgICAgICBzZXRUaXRsZShcIlRoYW5oIHRvw6FuIHbDqSB0w6B1XCIpO1xuICAgICAgICBzZXRTaXplKDEwMDAsIDcwMCk7XG4gICAgICAgIHNldERlZmF1bHRDbG9zZU9wZXJhdGlvbihKRnJhbWUuRElTUE9TRV9PTl9DTE9TRSk7XG4gICAgICAgIHNldExvY2F0aW9uUmVsYXRpdmVUbyhudWxsKTtcblxuICAgICAgICBpbml0Q29tcG9uZW50cygpO1xuICAgICAgICBjYWxjdWxhdGVUb3RhbCgpO1xuICAgIH1cbi4uLlxuXG4gICAgICAgIC8vIENyZWF0ZSBzb3V0aCBwYW5lbCBmb3IgY3VzdG9tZXIgaW5mbyBhbmQgcGF5bWVudCBidXR0b25cbiAgICAgICAgSlBhbmVsIHNvdXRoUGFuZWwgPSBuZXcgSlBhbmVsKG5ldyBCb3JkZXJMYXlvdXQoMCwgMTApKTtcblxuICAgICAgICAvLyBDdXN0b21lciBpbmZvcm1hdGlvbiBzZWN0aW9uXG4gICAgICAgIEpQYW5lbCBjdXN0b21lclBhbmVsID0gY3JlYXRlQ3VzdG9tZXJJbmZvUGFuZWwoKTtcbiAgICAgICAgc291dGhQYW5lbC5hZGQoY3VzdG9tZXJQYW5lbCwgQm9yZGVyTGF5b3V0Lk5PUlRIKTtcblxuICAgICAgICAvLyBQYXltZW50IGJ1dHRvblxuICAgICAgICBKUGFuZWwgcGF5bWVudFBhbmVsID0gbmV3IEpQYW5lbChuZXcgRmxvd0xheW91dChGbG93TGF5b3V0LlJJR0hUKSk7XG4gICAgICAgIEpCdXR0b24gcGF5QnV0dG9uID0gbmV3IEpCdXR0b24oXCJUaGFuaCB0b8OhblwiKTtcbiAgICAgICAgcGF5QnV0dG9uLnNldEJhY2tncm91bmQocHJpbWFyeUNvbG9yKTtcbiAgICAgICAgcGF5QnV0dG9uLnNldEZvcmVncm91bmQoQ29sb3IuV0hJVEUpO1xuICAgICAgICBwYXlCdXR0b24uc2V0Rm9udChuZXcgRm9udChcIkFyaWFsXCIsIEZvbnQuQk9MRCwgMTQpKTtcbiAgICAgICAgcGF5QnV0dG9uLnNldFByZWZlcnJlZFNpemUobmV3IERpbWVuc2lvbigxMjAsIDM1KSk7XG4gICAgICAgIHBheUJ1dHRvbi5hZGRBY3Rpb25MaXN0ZW5lcihlIC0+IHByb2Nlc3NQYXltZW50KCkpO1xuICAgICAgICBwYXltZW50UGFuZWwuYWRkKHBheUJ1dHRvbik7XG4gICAgICAgIHNvdXRoUGFuZWwuYWRkKHBheW1lbnRQYW5lbCwgQm9yZGVyTGF5b3V0LlNPVVRIKTtcbi4uLlxuXG4gICAgICAgICAgICAvLyBHZXQgdHJhaW4gaW5mb3JtYXRpb25cbiAgICAgICAgICAgIFRhdSB0YXUgPSB0YXVEQU8uZ2V0VGF1QnlMaWNoVHJpbmhUYXUobGljaFRyaW5oKTtcbiAgICAgICAgICAgIGlmICh0YXUgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihcIktow7RuZyB0w6xtIHRo4bqleSB0aMO0bmcgdGluIHTDoHUgY2hvIGzhu4tjaCB0csOsbmg6IFwiICsgc2NoZWR1bGVJZCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZXQgc2VhdCBuYW1lL251bWJlclxuICAgICAgICAgICAgU3RyaW5nIHNlYXROYW1lID0gY2hvTmdvaS5nZXRUZW5DaG8oKSAhPSBudWxsID8gY2hvTmdvaS5nZXRUZW5DaG8oKSA6IHNlYXRJZDtcblxuICAgICAgICAgICAgLy8gR2V0IHByaWNlIGJhc2VkIG9uIHNlYXQgY2xhc3MgYW5kIHJvdXRlXG4gICAgICAgICAgICBkb3VibGUgcHJpY2UgPSBnZXRTZWF0UHJpY2UoY2hvTmdvaSwgdG9hVGF1KTtcblxuICAgICAgICAgICAgLy8gR2V0IHJvdXRlIGluZm9ybWF0aW9uXG4gICAgICAgICAgICBTdHJpbmcgZnJvbSA9IGxpY2hUcmluaC5nZXRUYXUoKS5nZXRUdXllblRhdSgpLmdldEdhRGkoKTtcbiAgICAgICAgICAgIFN0cmluZyB0byA9IGxpY2hUcmluaC5nZXRUYXUoKS5nZXRUdXllblRhdSgpLmdldEdhRGVuKCk7XG5cbiAgICAgICAgICAgIC8vIEZvcm1hdCBkYXRlIGFuZCB0aW1lXG4gICAgICAgICAgICBTdHJpbmcgZGVwYXJ0RGF0ZSA9IGxpY2hUcmluaC5nZXROZ2F5RGkoKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKFwiZGQvTU0veXl5eVwiKSk7XG4gICAgICAgICAgICBTdHJpbmcgZGVwYXJ0VGltZSA9IGxpY2hUcmluaC5nZXRHaW9EaSgpLmZvcm1hdChEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oXCJISDptbVwiKSk7XG4uLi5cblxuICAgICAgICAgICAgLy8gUGFyc2UgYW1vdW50IHBhaWQgKHJlbW92ZSBjb21tYXMgaWYgcHJlc2VudClcbiAgICAgICAgICAgIGRvdWJsZSBhbW91bnRQYWlkID0gRG91YmxlLnBhcnNlRG91YmxlKGFtb3VudFBhaWRTdHIucmVwbGFjZShcIixcIiwgXCJcIikpO1xuXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgY2hhbmdlXG4gICAgICAgICAgICBkb3VibGUgY2hhbmdlID0gYW1vdW50UGFpZCAtIHRvdGFsQW1vdW50O1xuXG4gICAgICAgICAgICAvLyBVcGRhdGUgY2hhbmdlIGFtb3VudCBsYWJlbFxuICAgICAgICAgICAgaWYgKGNoYW5nZSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgY2hhbmdlQW1vdW50TGFiZWwuc2V0VGV4dChmb3JtYXRDdXJyZW5jeShjaGFuZ2UpKTtcbiAgICAgICAgICAgICAgICBjaGFuZ2VBbW91bnRMYWJlbC5zZXRGb3JlZ3JvdW5kKG5ldyBDb2xvcigwLCAxMjgsIDApKTsgLy8gR3JlZW4gZm9yIHBvc2l0aXZlIGNoYW5nZVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjaGFuZ2VBbW91bnRMYWJlbC5zZXRUZXh0KFwiVGhp4bq/dTogXCIgKyBmb3JtYXRDdXJyZW5jeShNYXRoLmFicyhjaGFuZ2UpKSk7XG4gICAgICAgICAgICAgICAgY2hhbmdlQW1vdW50TGFiZWwuc2V0Rm9yZWdyb3VuZChDb2xvci5SRUQpOyAvLyBSZWQgZm9yIG5lZ2F0aXZlIGNoYW5nZSAoaW5zdWZmaWNpZW50IHBheW1lbnQpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKE51bWJlckZvcm1hdEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICAvLyBJbnZhbGlkIGlucHV0LCBzZXQgY2hhbmdlIHRvIDBcbiAgICAgICAgICAgIGNoYW5nZUFtb3VudExhYmVsLnNldFRleHQoXCJOaOG6rXAga2jDtG5nIGjhu6NwIGzhu4dcIik7XG4gICAgICAgICAgICBjaGFuZ2VBbW91bnRMYWJlbC5zZXRGb3JlZ3JvdW5kKENvbG9yLlJFRCk7XG4gICAgICAgIH1cbiAgICB9XG4uLi5cblxuICAgIC8qKlxuICAgICAqIFByb2Nlc3MgcGF5bWVudFxuICAgICAqL1xuICAgIHByaXZhdGUgdm9pZCBwcm9jZXNzUGF5bWVudCgpIHtcbiAgICAgICAgLy8gVmFsaWRhdGUgcmVxdWlyZWQgZmllbGRzXG4gICAgICAgIGlmIChuYW1lRmllbGQuZ2V0VGV4dCgpLnRyaW0oKS5pc0VtcHR5KCkgfHxcbiAgICAgICAgICAgICAgICBpZENhcmRGaWVsZC5nZXRUZXh0KCkudHJpbSgpLmlzRW1wdHkoKSB8fFxuICAgICAgICAgICAgICAgIHBob25lRmllbGQuZ2V0VGV4dCgpLnRyaW0oKS5pc0VtcHR5KCkpIHtcblxuICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIFwiVnVpIGzDsm5nIMSRaeG7gW4gxJHhuqd5IMSR4bunIGPDoWMgdHLGsOG7nW5nIGLhuq90IGJ14buZY1wiLFxuICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsXG4gICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0VcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBWYWxpZGF0ZSBlbWFpbCBtYXRjaCBpZiBwcm92aWRlZFxuICAgICAgICBpZiAoIWVtYWlsRmllbGQuZ2V0VGV4dCgpLnRyaW0oKS5pc0VtcHR5KCkgJiZcbiAgICAgICAgICAgICAgICAhZW1haWxGaWVsZC5nZXRUZXh0KCkuZXF1YWxzKGNvbmZpcm1FbWFpbEZpZWxkLmdldFRleHQoKSkpIHtcblxuICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIFwiRW1haWwgeMOhYyBuaOG6rW4ga2jDtG5nIGto4bubcCB24bubaSBlbWFpbCDEkcOjIG5o4bqtcFwiLFxuICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsXG4gICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0VcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbi4uLlxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBkb3VibGUgYW1vdW50UGFpZCA9IERvdWJsZS5wYXJzZURvdWJsZShhbW91bnRQYWlkRmllbGQuZ2V0VGV4dCgpLnRyaW0oKS5yZXBsYWNlKFwiLFwiLCBcIlwiKSk7XG4gICAgICAgICAgICBpZiAoYW1vdW50UGFpZCA8IHRvdGFsQW1vdW50KSB7XG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJT4buRIHRp4buBbiBraMOhY2ggxJHGsGEga2jDtG5nIMSR4bunIMSR4buDIHRoYW5oIHRvw6FuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBhbW91bnRQYWlkRmllbGQucmVxdWVzdEZvY3VzKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChOdW1iZXJGb3JtYXRFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIFwiU+G7kSB0aeG7gW4ga2jDoWNoIMSRxrBhIGtow7RuZyBo4bujcCBs4buHXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiTOG7l2lcIixcbiAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGFtb3VudFBhaWRGaWVsZC5yZXF1ZXN0Rm9jdXMoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNob3cgcGF5bWVudCBvcHRpb25zIGRpYWxvZ1xuICAgICAgICBTdHJpbmdbXSBvcHRpb25zID0ge1wiVGnhu4FuIG3hurd0XCIsIFwiVGjhursgdMOtbiBk4bulbmdcIiwgXCJDaHV54buDbiBraG/huqNuXCIsIFwiVsOtIMSRaeG7h24gdOG7rVwifTtcbiAgICAgICAgaW50IGNob2ljZSA9IEpPcHRpb25QYW5lLnNob3dPcHRpb25EaWFsb2coXG4gICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICBcIkNo4buNbiBwaMawxqFuZyB0aOG7qWMgdGhhbmggdG/DoW5cIixcbiAgICAgICAgICAgICAgICBcIlRoYW5oIHRvw6FuXCIsXG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuREVGQVVMVF9PUFRJT04sXG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuUVVFU1RJT05fTUVTU0FHRSxcbiAgICAgICAgICAgICAgICBudWxsLFxuICAgICAgICAgICAgICAgIG9wdGlvbnMsXG4gICAgICAgICAgICAgICAgb3B0aW9uc1swXVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIFByb2Nlc3MgYmFzZWQgb24gc2VsZWN0ZWQgcGF5bWVudCBtZXRob2RcbiAgICAgICAgaWYgKGNob2ljZSA+PSAwKSB7XG4gICAgICAgICAgICAvLyBTaG93IHByb2Nlc3NpbmcgbWVzc2FnZVxuICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIFwixJBhbmcgeOG7rSBsw70gdGhhbmggdG/DoW4uLi5cIixcbiAgICAgICAgICAgICAgICAgICAgXCJUaGFuaCB0b8OhblwiLFxuICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5JTkZPUk1BVElPTl9NRVNTQUdFXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIEdldCBjdXN0b21lciBpbmZvcm1hdGlvbiBmcm9tIGZvcm1cbiAgICAgICAgICAgICAgICBTdHJpbmcgY3VzdG9tZXJOYW1lID0gbmFtZUZpZWxkLmdldFRleHQoKS50cmltKCk7XG4gICAgICAgICAgICAgICAgU3RyaW5nIGlkQ2FyZCA9IGlkQ2FyZEZpZWxkLmdldFRleHQoKS50cmltKCk7XG4gICAgICAgICAgICAgICAgU3RyaW5nIHBob25lID0gcGhvbmVGaWVsZC5nZXRUZXh0KCkudHJpbSgpO1xuICAgICAgICAgICAgICAgIFN0cmluZyBlbWFpbCA9IGVtYWlsRmllbGQuZ2V0VGV4dCgpLnRyaW0oKTsgLy8gVGhpcyBpcyB0aGUgYWRkcmVzcyBmaWVsZCBhcyBwZXIgcmVxdWlyZW1lbnRzXG5cbiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiBjdXN0b21lciBleGlzdHMgYnkgSUQgY2FyZCBhbmQgcGhvbmUgbnVtYmVyXG4gICAgICAgICAgICAgICAgS2hhY2hIYW5nIGV4aXN0aW5nQ3VzdG9tZXIgPSBraGFjaEhhbmdEQU8uZmluZEJ5SWRDYXJkQW5kUGhvbmUoaWRDYXJkLCBwaG9uZSk7XG4uLi5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBDdXN0b21lciBkb2Vzbid0IGV4aXN0LCBjcmVhdGUgbmV3IGN1c3RvbWVyXG4gICAgICAgICAgICAgICAgICAgIEtoYWNoSGFuZyBuZXdDdXN0b21lciA9IG5ldyBLaGFjaEhhbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgbmV3Q3VzdG9tZXIuc2V0VGVuS2hhY2hIYW5nKGN1c3RvbWVyTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIG5ld0N1c3RvbWVyLnNldEdpYXlUbyhpZENhcmQpO1xuICAgICAgICAgICAgICAgICAgICBuZXdDdXN0b21lci5zZXRTb0RpZW5UaG9haShwaG9uZSk7XG4gICAgICAgICAgICAgICAgICAgIG5ld0N1c3RvbWVyLnNldERpYUNoaShlbWFpbCk7IC8vIEVtYWlsIGFkZHJlc3MgYXMgcGVyIHJlcXVpcmVtZW50c1xuICAgICAgICAgICAgICAgICAgICBuZXdDdXN0b21lci5zZXRIYW5nVGhhbmhWaWVuKFwiVsOjbmcgbGFpXCIpOyAvLyBEZWZhdWx0IG1lbWJlciByYW5rXG4gICAgICAgICAgICAgICAgICAgIG5ld0N1c3RvbWVyLnNldERpZW1UaWNoTHV5KDAuMCk7IC8vIEluaXRpYWwgbG95YWx0eSBwb2ludHNcbiAgICAgICAgICAgICAgICAgICAgbmV3Q3VzdG9tZXIuc2V0TmdheVNpbmgoTG9jYWxEYXRlLm5vdygpKTsgLy8gRGVmYXVsdCBiaXJ0aCBkYXRlLCBzaG91bGQgYmUgdXBkYXRlZCBsYXRlclxuICAgICAgICAgICAgICAgICAgICBuZXdDdXN0b21lci5zZXROZ2F5VGhhbWdHaWEoTG9jYWxEYXRlLm5vdygpKTsgLy8gSm9pbiBkYXRlIGlzIHRvZGF5XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gR2V0IGEgZGVmYXVsdCBjdXN0b21lciB0eXBlXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBHZXQgYWxsIGN1c3RvbWVyIHR5cGVzXG4gICAgICAgICAgICAgICAgICAgICAgICBMaXN0PExvYWlLaGFjaEhhbmc+IHR5cGVzID0gbG9haUtoYWNoSGFuZ0RBTy5nZXRBbGwoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVHJ5IHRvIGZpbmQgYSBkZWZhdWx0IGN1c3RvbWVyIHR5cGUgKGFzc3VtaW5nIFwiVGjGsOG7nW5nXCIgaXMgdGhlIGRlZmF1bHQgdHlwZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIExvYWlLaGFjaEhhbmcgZGVmYXVsdFR5cGUgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChMb2FpS2hhY2hIYW5nIHR5cGUgOiB0eXBlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChcIlRoxrDhu51uZ1wiLmVxdWFscyh0eXBlLmdldFRlbkxvYWlLaGFjaEhhbmcoKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFR5cGUgPSB0eXBlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIFwiVGjGsOG7nW5nXCIgdHlwZSBkb2Vzbid0IGV4aXN0LCB1c2UgdGhlIGZpcnN0IGF2YWlsYWJsZSB0eXBlXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGVmYXVsdFR5cGUgPT0gbnVsbCAmJiAhdHlwZXMuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFR5cGUgPSB0eXBlcy5nZXQoMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZWZhdWx0VHlwZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q3VzdG9tZXIuc2V0TG9haUtoYWNoSGFuZyhkZWZhdWx0VHlwZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oXCJLaMO0bmcgdMOsbSB0aOG6pXkgbG/huqFpIGtow6FjaCBow6BuZyBuw6BvIHRyb25nIGPGoSBz4bufIGThu68gbGnhu4d1XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2kga2hpIHTDrG0gbG/huqFpIGtow6FjaCBow6BuZzogXCIgKyBlLmdldE1lc3NhZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gQWRkIG5ldyBjdXN0b21lciB0byBkYXRhYmFzZVxuICAgICAgICAgICAgICAgICAgICBraGFjaEhhbmdEQU8uYWRkKG5ld0N1c3RvbWVyKTtcblxuICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwixJDDoyB0aMOqbSBraMOhY2ggaMOgbmcgbeG7m2kgdsOgbyBjxqEgc+G7nyBk4buvIGxp4buHdS5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlRow7RuZyBiw6FvXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBjaGFuZ2UgZm9yIGNhc2ggcGF5bWVudFxuICAgICAgICAgICAgICAgIFN0cmluZyBjaGFuZ2VNZXNzYWdlID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoY2hvaWNlID09IDApIHsgLy8gQ2FzaCBwYXltZW50XG4gICAgICAgICAgICAgICAgICAgIGRvdWJsZSBhbW91bnRQYWlkID0gRG91YmxlLnBhcnNlRG91YmxlKGFtb3VudFBhaWRGaWVsZC5nZXRUZXh0KCkudHJpbSgpLnJlcGxhY2UoXCIsXCIsIFwiXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgZG91YmxlIGNoYW5nZSA9IGFtb3VudFBhaWQgLSB0b3RhbEFtb3VudDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoYW5nZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZU1lc3NhZ2UgPSBcIlxcblRp4buBbiB0aOG7kWkgbOG6oWk6IFwiICsgZm9ybWF0Q3VycmVuY3koY2hhbmdlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFNob3cgc3VjY2VzcyBtZXNzYWdlXG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJUaGFuaCB0b8OhbiB0aMOgbmggY8O0bmchIFbDqSBj4bunYSBi4bqhbiDEkcOjIMSRxrDhu6NjIMSR4bq3dC5cIiArIGNoYW5nZU1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIlRow6BuaCBjw7RuZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICAvLyBDbG9zZSBjaGVja291dCB3aW5kb3dcbiAgICAgICAgICAgICAgICBkaXNwb3NlKCk7XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaSBraGkgeOG7rSBsw70gdGhhbmggdG/DoW46IFwiICsgZS5nZXRNZXNzYWdlKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9Eb2lWZVBhbmVsLmphdmFcbi4uLlxuICAgIHByaXZhdGUgYm9vbGVhbiB4dUx5VGhhbmhUb2FuKCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyAxLiBUw6xtIGtow6FjaCBow6BuZyB04burIG3DoyB2w6lcbiAgICAgICAgICAgIEtoYWNoSGFuZyBraGFjaEhhbmcgPSBkb2lWZURBTy5nZXRLaGFjaEhhbmdCeU1hVmUodmVUYXVIaWVuVGFpLmdldE1hVmUoKSk7XG4gICAgICAgICAgICBpZiAoa2hhY2hIYW5nID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKFwiS2jDtG5nIHTDrG0gdGjhuqV5IHRow7RuZyB0aW4ga2jDoWNoIGjDoG5nIVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIsSQw6MgdMOsbSB0aOG6pXkgS2hhY2hIYW5nOiBcIiArIGtoYWNoSGFuZy5nZXRNYUtoYWNoSGFuZygpKTtcblxuICAgICAgICAgICAgLy8gMi4gVOG6oW8gaMOzYSDEkcahbiBt4bubaVxuICAgICAgICAgICAgSG9hRG9uIGhvYURvbiA9IG5ldyBIb2FEb24oKTtcbiAgICAgICAgICAgIFN0cmluZyBtYUhEID0gZ2VuZXJhdGVNYUhEKCk7XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJHZW5lcmF0ZWQgTWFIRDogXCIgKyBtYUhEKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXRNYUhEKG1hSEQpO1xuICAgICAgICAgICAgaG9hRG9uLnNldE5nYXlMYXAoTG9jYWxEYXRlVGltZS5ub3coKSk7XG4gICAgICAgICAgICBob2FEb24uc2V0VGllbkdpYW0oZ2lhVmVCYW5EYXUgLSB2ZVRhdUhpZW5UYWkuZ2V0R2lhVmUoKSk7XG4gICAgICAgICAgICBob2FEb24uc2V0VG9uZ1RpZW4odmVUYXVIaWVuVGFpLmdldEdpYVZlKCkpO1xuICAgICAgICAgICAgaG9hRG9uLnNldEtoYWNoSGFuZyhraGFjaEhhbmcpO1xuXG4gICAgICAgICAgICAvLyBEZWJ1Z2dpbmcgdGhlIE5oYW5WaWVuIHJlZmVyZW5jZVxuICAgICAgICAgICAgaWYgKG5oYW5WaWVuUGFuZWwgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihcIkVSUk9SOiBuaGFuVmllblBhbmVsIGlzIG51bGxcIik7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbihcIlRoaeG6v3UgdGjDtG5nIHRpbiBuaMOibiB2acOqbiFcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJOaGFuVmllbiBpbmZvOiBcIiArIG5oYW5WaWVuUGFuZWwuZ2V0Q2xhc3MoKS5nZXROYW1lKCkpO1xuICAgICAgICAgICAgaG9hRG9uLnNldE52KG5oYW5WaWVuUGFuZWwpO1xuXG4gICAgICAgICAgICAvLyBHZXQgTG9haUhvYURvbiBhbmQgdmVyaWZ5IGl0IGV4aXN0c1xuICAgICAgICAgICAgTG9haUhvYURvbiBsb2FpSG9hRG9uID0gbG9haUhvYURvbkRBTy5maW5kQnlJZChcIkxIRDAwMVwiKTtcbiAgICAgICAgICAgIGlmIChsb2FpSG9hRG9uID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCJFUlJPUjogS2jDtG5nIHTDrG0gdGjhuqV5IGxv4bqhaSBow7NhIMSRxqFuIExIRDAwMVwiKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKFwiS2jDtG5nIHTDrG0gdGjhuqV5IGxv4bqhaSBow7NhIMSRxqFuIVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIkZvdW5kIExvYWlIb2FEb246IFwiICsgbG9haUhvYURvbi5nZXRNYUxvYWlIb2FEb24oKSk7XG4gICAgICAgICAgICBob2FEb24uc2V0TG9haUhvYURvbihsb2FpSG9hRG9uKTtcblxuICAgICAgICAgICAgLy8gMy4gTMawdSBow7NhIMSRxqFuXG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJBdHRlbXB0aW5nIHRvIHNhdmUgSG9hRG9uLi4uXCIpO1xuICAgICAgICAgICAgYm9vbGVhbiBzYXZlZEhvYURvbiA9IGhvYURvbkRBTy5zYXZlSG9hRG9uKGhvYURvbik7XG4gICAgICAgICAgICBpZiAoIXNhdmVkSG9hRG9uKSB7XG4gICAgICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFwiRmFpbGVkIHRvIHNhdmUgSG9hRG9uIVwiKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKFwiS2jDtG5nIHRo4buDIGzGsHUgaMOzYSDEkcahbiFcIik7XG4gICAgICAgICAgICB9XG4uLi5cblxuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFwiRXJyb3IgaW4geHVMeVRoYW5oVG9hbjogXCIgKyBlLmdldE1lc3NhZ2UoKSk7XG4gICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IFJlbW90ZUV4Y2VwdGlvbihcIkzhu5dpIGtoaSB44butIGzDvSB0aGFuaCB0b8OhbjogXCIgKyBlLmdldE1lc3NhZ2UoKSwgZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIFN0cmluZyBnZW5lcmF0ZU1hSEQoKSB7XG4gICAgICAgIC8vIEZvcm1hdDogSEQgKyB5eXl5TU1kZCArIDQgc+G7kSByYW5kb21cbiAgICAgICAgU2ltcGxlRGF0ZUZvcm1hdCBzZGYgPSBuZXcgU2ltcGxlRGF0ZUZvcm1hdChcInl5eXlNTWRkXCIpO1xuICAgICAgICBTdHJpbmcgZGF0ZVBhcnQgPSBzZGYuZm9ybWF0KG5ldyBEYXRlKCkpO1xuICAgICAgICBTdHJpbmcgcmFuZG9tUGFydCA9IFN0cmluZy5mb3JtYXQoXCIlMDRkXCIsIG5ldyBSYW5kb20oKS5uZXh0SW50KDEwMDAwKSk7XG4gICAgICAgIHJldHVybiBcIkhEXCIgKyBkYXRlUGFydCArIHJhbmRvbVBhcnQ7XG4gICAgfVxufS4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9ndWlDbGllbnQvVHJhVmVQYW5lbC5qYXZhXG4uLi5cblxuICAgICAgICAgICAgLy8gVGhp4bq/dCBs4bqtcCBjw6FjIHRow7RuZyB0aW4gaMOzYSDEkcahblxuICAgICAgICAgICAgaG9hRG9uLnNldE5nYXlMYXAoTG9jYWxEYXRlVGltZS5ub3coKSk7XG4gICAgICAgICAgICBob2FEb24uc2V0VGllbkdpYW0oMCk7IC8vIEtow7RuZyBjw7MgZ2nhuqNtIGdpw6Ega2hpIHRy4bqjIHbDqVxuICAgICAgICAgICAgaG9hRG9uLnNldFRvbmdUaWVuKHRpZW5UcmFMYWkpOyAvLyBU4buVbmcgdGnhu4FuIGzDoCBz4buRIHRp4buBbiB0cuG6oyBs4bqhaSBraMOhY2hcbiAgICAgICAgICAgIGhvYURvbi5zZXRLaGFjaEhhbmcoa2hhY2hIYW5nKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXROdihuaGFuVmllbik7IC8vIE5ow6JuIHZpw6puIMSRYW5nIMSRxINuZyBuaOG6rXBcblxuICAgICAgICAgICAgLy8gVGhp4bq/dCBs4bqtcCBsb+G6oWkgaMOzYSDEkcahbiBsw6AgXCLEkMOjIHRy4bqjXCIgKExIRDAwMilcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgTG9haUhvYURvbiBsb2FpSG9hRG9uID0gaG9hRG9uREFPLmdldExvYWlIb2FEb25CeUlkKFwiTEhEMDAyXCIpO1xuICAgICAgICAgICAgICAgIGlmIChsb2FpSG9hRG9uID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFeGNlcHRpb24oXCJLaMO0bmcgdMOsbSB0aOG6pXkgbG/huqFpIGjDs2EgxJHGoW4gTEhEMDAyXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBob2FEb24uc2V0TG9haUhvYURvbihsb2FpSG9hRG9uKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUnVudGltZUV4Y2VwdGlvbihcIkzhu5dpIGtoaSBs4bqleSB0aMO0bmcgdGluIGxv4bqhaSBow7NhIMSRxqFuOiBcIiArIGUuZ2V0TWVzc2FnZSgpKTtcbiAgICAgICAgICAgIH1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9tb2RlbC9OaGFuVmllbi5qYXZhXG5wYWNrYWdlIG1vZGVsO1xuXG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS4qO1xuaW1wb3J0IGxvbWJvay4qO1xuXG5pbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7XG5pbXBvcnQgamF2YS50aW1lLkxvY2FsRGF0ZTtcbmltcG9ydCBqYXZhLnV0aWwuU2V0O1xuLyoqXG4gKiBAROG7sSDDoW46IEFwcFxuICogQENsYXNzOiBOaGFuVmllblxuICogQFThuqFvIHbDoG8gbmfDoHk6IDE1LzAxLzIwMjVcbiAqIEBUw6FjIGdp4bqjOiBOZ3V5ZW4gSHV1IFNhbmdcbiAqL1xuQERhdGFcbkBFbnRpdHlcbkBUYWJsZShuYW1lID0gXCJuaGFudmllblwiKVxuQEVxdWFsc0FuZEhhc2hDb2RlKG9ubHlFeHBsaWNpdGx5SW5jbHVkZWQgPSB0cnVlKVxuQEFsbEFyZ3NDb25zdHJ1Y3RvclxuQE5vQXJnc0NvbnN0cnVjdG9yXG5ATmFtZWROYXRpdmVRdWVyaWVzKHtcbiAgICAgICAgQE5hbWVkTmF0aXZlUXVlcnkobmFtZSA9IFwiTmhhblZpZW4uZmluZEJ5TWFOVlwiLFxuICAgICAgICAgICAgICAgIHF1ZXJ5ID0gXCJzZWxlY3QgKiBmcm9tIG5oYW52aWVuIHdoZXJlIG1hX252ID0gOm1hTlZcIixcbiAgICAgICAgICAgICAgICByZXN1bHRDbGFzcyA9IE5oYW5WaWVuLmNsYXNzKSxcbiAgICAgICAgQE5hbWVkTmF0aXZlUXVlcnkobmFtZSA9IFwiTmhhblZpZW4uZmluZEFsbFwiLFxuICAgICAgICAgICAgICAgIHF1ZXJ5ID0gXCJzZWxlY3QgKiBmcm9tIG5oYW52aWVuXCIsXG4gICAgICAgICAgICAgICAgcmVzdWx0Q2xhc3MgPSBOaGFuVmllbi5jbGFzcylcbn0pXG5wdWJsaWMgY2xhc3MgTmhhblZpZW4gaW1wbGVtZW50cyBTZXJpYWxpemFibGUge1xuICAgIEBJZFxuICAgIEBFcXVhbHNBbmRIYXNoQ29kZS5JbmNsdWRlXG4gICAgQENvbHVtbihuYW1lID0gXCJtYV9udlwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJ2YXJjaGFyKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSwgdW5pcXVlID0gdHJ1ZSlcbiAgICBwcml2YXRlIFN0cmluZyBtYU5WOyAvLyBNw6MgbmjDom4gdmnDqm5cblxuICAgIEBDb2x1bW4obmFtZSA9IFwidGVuX252XCIsIGNvbHVtbkRlZmluaXRpb24gPSBcInZhcmNoYXIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgU3RyaW5nIHRlbk5WOyAvLyBUw6puIG5ow6JuIHZpw6puXG4gICAgQEVxdWFsc0FuZEhhc2hDb2RlLkV4Y2x1ZGVcblxuICAgIEBDb2x1bW4obmFtZSA9IFwic29fZHRcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwidmFyY2hhcigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBTdHJpbmcgc29EVDsgLy8gU+G7kSDEkWnhu4duIHRob+G6oWlcbiAgICBARXF1YWxzQW5kSGFzaENvZGUuRXhjbHVkZVxuXG4gICAgQENvbHVtbihuYW1lID0gXCJ0cmFuZ190aGFpXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcInZhcmNoYXIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgU3RyaW5nIHRyYW5nVGhhaTsgLy8gVHLhuqFuZyB0aMOhaVxuICAgIEBFcXVhbHNBbmRIYXNoQ29kZS5FeGNsdWRlXG5cbiAgICBAQ29sdW1uKG5hbWUgPSBcImNjY2RcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwidmFyY2hhcigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBTdHJpbmcgY2NjZDsgLy8gQ2jhu6luZyBjaOG7iSBjw7RuZyBkw6JuXG4gICAgQEVxdWFsc0FuZEhhc2hDb2RlLkV4Y2x1ZGVcblxuICAgIEBDb2x1bW4obmFtZSA9IFwiZGlhX2NoaVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJ2YXJjaGFyKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIFN0cmluZyBkaWFDaGk7IC8vIMSQ4buLYSBjaOG7iVxuICAgIEBFcXVhbHNBbmRIYXNoQ29kZS5FeGNsdWRlXG5cbiAgICBAQ29sdW1uKG5hbWUgPSBcIm5nYXlfdmFvX2xhbVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJkYXRlXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBMb2NhbERhdGUgbmdheVZhb0xhbTsgLy8gTmfDoHkgdsOgbyBsw6BtXG4gICAgQEVxdWFsc0FuZEhhc2hDb2RlLkV4Y2x1ZGVcblxuICAgIEBDb2x1bW4obmFtZSA9IFwiY2h1Y192dVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJ2YXJjaGFyKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIFN0cmluZyBjaHVjVnU7IC8vIENo4bupYyB24bulXG4gICAgQEVxdWFsc0FuZEhhc2hDb2RlLkV4Y2x1ZGVcblxuICAgIEBDb2x1bW4obmFtZSA9IFwiYXZhdGFcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwidmFyY2hhcigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBTdHJpbmcgYXZhdGE7IC8vIOG6om5oIMSR4bqhaSBkaeG7h25cbiAgICBARXF1YWxzQW5kSGFzaENvZGUuRXhjbHVkZVxuXG4gICAgLy8gTeG7mXQgbmjDom4gdmnDqm4gY2jhu4kgY8OzIG3hu5l0IHTDoGkga2hv4bqjblxuICAgIEBPbmVUb09uZShtYXBwZWRCeSA9IFwibmhhblZpZW5cIiwgY2FzY2FkZSA9IENhc2NhZGVUeXBlLkFMTCwgZmV0Y2ggPSBGZXRjaFR5cGUuTEFaWSlcbiAgICBAVG9TdHJpbmcuRXhjbHVkZVxuICAgIHByaXZhdGUgVGFpS2hvYW4gdGFpS2hvYW47XG5cblxuICAgIC8vIE3hu5l0IG5ow6JuIHZpw6puIGPDsyBuaGnhu4F1IGzhu4tjaCBsw6BtIHZp4buHY1xuICAgIEBPbmVUb01hbnkobWFwcGVkQnkgPSBcIm5oYW5WaWVuXCIsIGNhc2NhZGUgPSBDYXNjYWRlVHlwZS5BTEwsIG9ycGhhblJlbW92YWwgPSB0cnVlKVxuICAgIEBUb1N0cmluZy5FeGNsdWRlXG4gICAgcHJpdmF0ZSBTZXQ8TGljaExhbVZpZWM+IGRhbmhTYWNoTGljaExhbVZpZWM7XG5cbiAgICAvLyBN4buZdCBuaMOibiB2acOqbiBjw7Mgbmhp4buBdSBow7NhIMSRxqFuXG4gICAgQE9uZVRvTWFueShtYXBwZWRCeSA9IFwibnZcIiwgY2FzY2FkZSA9IENhc2NhZGVUeXBlLkFMTCwgb3JwaGFuUmVtb3ZhbCA9IHRydWUpXG4gICAgQFRvU3RyaW5nLkV4Y2x1ZGVcbiAgICBwcml2YXRlIFNldDxIb2FEb24+IGRhbmhTYWNoSG9hRG9uO1xuXG5cblxufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL21vZGVsL0toYWNoSGFuZy5qYXZhXG4uLi5cblxuQEVudGl0eVxuQEVxdWFsc0FuZEhhc2hDb2RlKG9ubHlFeHBsaWNpdGx5SW5jbHVkZWQgPSB0cnVlKVxuQERhdGFcbnB1YmxpYyBjbGFzcyBLaGFjaEhhbmcgaW1wbGVtZW50cyBTZXJpYWxpemFibGUge1xuICAgIEBJZFxuICAgIEBFcXVhbHNBbmRIYXNoQ29kZS5JbmNsdWRlXG4gICAgQENvbHVtbihuYW1lID0gXCJtYV9raGFjaF9oYW5nXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcInZhcmNoYXIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlLCB1bmlxdWUgPSB0cnVlKVxuICAgIHByaXZhdGUgU3RyaW5nIG1hS2hhY2hIYW5nO1xuICAgIEBDb2x1bW4obmFtZSA9IFwic2R0XCIgLCBjb2x1bW5EZWZpbml0aW9uID0gXCJ2YXJjaGFyKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIFN0cmluZyBzb0RpZW5UaG9haTtcbiAgICBAQ29sdW1uKG5hbWUgPSBcInRlbl9raGFjaF9oYW5nXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcInZhcmNoYXIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgU3RyaW5nIHRlbktoYWNoSGFuZztcbiAgICBAQ29sdW1uKG5hbWUgPSBcImdpYXlfdG9cIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwidmFyY2hhcigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBTdHJpbmcgZ2lheVRvO1xuICAgIEBDb2x1bW4obmFtZSA9IFwiZGlhX2NoaVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJ2YXJjaGFyKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIFN0cmluZyBkaWFDaGk7XG4gICAgQENvbHVtbihuYW1lID0gXCJkaWVtX3RpY2hfbHV5XCIsIGNvbHVtbkRlZmluaXRpb24gPSBcImRvdWJsZVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgZG91YmxlIGRpZW1UaWNoTHV5O1xuICAgIEBDb2x1bW4obmFtZSA9IFwibmdheV9zaW5oXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcImRhdGVcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIExvY2FsRGF0ZSBuZ2F5U2luaDtcbiAgICBAQ29sdW1uKG5hbWUgPSBcIm5nYXlfdGhhbV9naWFcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiZGF0ZVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgTG9jYWxEYXRlIG5nYXlUaGFtZ0dpYTtcbiAgICBAQ29sdW1uKG5hbWUgPSBcImhhbmdfdGhhbmhfdmllblwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJ2YXJjaGFyKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIFN0cmluZyBoYW5nVGhhbmhWaWVuO1xuXG4gICAgQE1hbnlUb09uZVxuICAgIEBKb2luQ29sdW1uKG5hbWUgPSBcIm1hX2xvYWlfa2hhY2hfaGFuZ1wiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIEBUb1N0cmluZy5FeGNsdWRlXG4gICAgcHJpdmF0ZSBMb2FpS2hhY2hIYW5nIGxvYWlLaGFjaEhhbmc7XG5cbiAgICBAVG9TdHJpbmcuRXhjbHVkZVxuICAgIEBPbmVUb01hbnkobWFwcGVkQnkgPSBcImtoYWNoSGFuZ1wiKVxuICAgIHByaXZhdGUgU2V0PEhvYURvbj4gaG9hRG9ucztcbn1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9tb2RlbC9UYWlLaG9hbi5qYXZhXG4uLi5cblxuQERhdGFcbkBFbnRpdHlcbkBFcXVhbHNBbmRIYXNoQ29kZShvbmx5RXhwbGljaXRseUluY2x1ZGVkID0gdHJ1ZSlcbkBUYWJsZShuYW1lID0gXCJ0YWlraG9hblwiKVxucHVibGljIGNsYXNzIFRhaUtob2FuIGltcGxlbWVudHMgU2VyaWFsaXphYmxlIHtcbiAgICBASWRcbiAgICBARXF1YWxzQW5kSGFzaENvZGUuSW5jbHVkZVxuICAgIEBDb2x1bW4obmFtZSA9IFwibWFfbnZcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwidmFyY2hhcigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UsIHVuaXF1ZSA9IHRydWUpXG4gICAgcHJpdmF0ZSBTdHJpbmcgbWFOVjsgLy8gTcOjIHTDoGkga2hv4bqjblxuXG4gICAgQENvbHVtbihuYW1lID0gXCIuLi4iLCJpc19lcnJvciI6ZmFsc2UsInJlcXVlc3RfaWQiOiIiLCJ0b29sX3VzZV9pZCI6InRvb2x1XzAxQ2RLYVJZTUt1R2pXNWdvRXNKVTh1RCJ9fSx7ImlkIjoyLCJ0eXBlIjo0LCJpZGVfc3RhdGVfbm9kZSI6eyJ3b3Jrc3BhY2VGb2xkZXJzIjpbeyJyZXBvc2l0b3J5Um9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIiwiZm9sZGVyUm9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIn1dLCJ3b3Jrc3BhY2VGb2xkZXJzVW5jaGFuZ2VkIjpmYWxzZX19XSwicmVzcG9uc2VfdGV4dCI6IkxldCBtZSBnZXQgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCB0aGUgVGhhbmhUb2FuR1VJJ3MgcHJvY2Vzc1BheW1lbnQgbWV0aG9kIHNpbmNlIGl0IHdhc24ndCBmdWxseSBzaG93biBpbiB0aGUgcHJldmlvdXMgcmV0cmlldmFsOlxuIiwid29ya3NwYWNlX2ZpbGVfY2h1bmtzIjpbXX0seyJzdGF0dXMiOiJzdWNjZXNzIiwicmVxdWVzdF9pZCI6IjdkZDExY2RkLTFlMzMtNDgxZS1iZjBlLWY2NzdhNTVkNDY5MiIsInJlcXVlc3RfbWVzc2FnZSI6IiIsInN0cnVjdHVyZWRfb3V0cHV0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6NSwiY29udGVudCI6IiIsInRvb2xfdXNlIjp7InRvb2xfdXNlX2lkIjoidG9vbHVfMDEyWlVFRlRWQmlDRnNQV3ZCTGYzcWM5IiwidG9vbF9uYW1lIjoic3RyLXJlcGxhY2UtZWRpdG9yIiwiaW5wdXRfanNvbiI6IntcImNvbW1hbmRcIjogXCJ2aWV3XCIsIFwicGF0aFwiOiBcIlByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZ3VpQ2xpZW50L1RoYW5oVG9hbkdVSS5qYXZhXCIsIFwidmlld19yYW5nZVwiOiBbMTUwMCwgMTYwMF19In19LHsiaWQiOjAsInR5cGUiOjAsImNvbnRlbnQiOiJMZXQgbWUgZ2V0IG1vcmUgaW5mb3JtYXRpb24gYWJvdXQgdGhlIFRoYW5oVG9hbkdVSSdzIHByb2Nlc3NQYXltZW50IG1ldGhvZCwgc3BlY2lmaWNhbGx5IGZvY3VzaW5nIG9uIGhvdyBpdCBjcmVhdGVzIGFuZCBzYXZlcyB0aGUgSG9hRG9uIG9iamVjdDpcbiJ9LHsiaWQiOjIsInR5cGUiOjIsImNvbnRlbnQiOiIifSx7ImlkIjozLCJ0eXBlIjozLCJjb250ZW50IjoiIn1dLCJzZWVuX3N0YXRlIjoic2VlbiIsInN0cnVjdHVyZWRfcmVxdWVzdF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjEsInRvb2xfcmVzdWx0X25vZGUiOnsiY29udGVudCI6IlRoZSBmb2xsb3dpbmcgY29kZSBzZWN0aW9ucyB3ZXJlIHJldHJpZXZlZDpcblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZ3VpQ2xpZW50L0RvaVZlUGFuZWwuamF2YVxuLi4uXG5cbiAgICAgICAgICAgICAgICAgICAgU3RyaW5nIHZucF9TZWN1cmVIYXNoID0gaG1hY1NIQTUxMihcIllPVVJfU0VDUkVUX0tFWVwiLCBoYXNoRGF0YS50b1N0cmluZygpKTtcbiAgICAgICAgICAgICAgICAgICAgcXVlcnkuYXBwZW5kKFwiJnZucF9TZWN1cmVIYXNoPVwiKS5hcHBlbmQodm5wX1NlY3VyZUhhc2gpO1xuXG4gICAgICAgICAgICAgICAgICAgIFN0cmluZyBwYXltZW50VXJsID0gYXBpVXJsICsgXCI/XCIgKyBxdWVyeS50b1N0cmluZygpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFRyb25nIG3DtGkgdHLGsOG7nW5nIHRo4buxYyB04bq/LCBi4bqhbiBz4bq9IGfhu41pIEFQSSBWTlBheSDEkeG7gyBs4bqleSBVUkwgaG/hurdjIGThu68gbGnhu4d1IFFSXG4gICAgICAgICAgICAgICAgICAgIC8vIOG7niDEkcOieSwgY2jDum5nIHRhIHPhur0gdOG6oW8gbcOjIFFSIHThu6sgVVJMIHRoYW5oIHRvw6FuXG4gICAgICAgICAgICAgICAgICAgIC8vIEzGsHUgdGjDtG5nIHRpbiBuw6B5IMSR4buDIHRyYSBj4bupdSB0cuG6oW5nIHRow6FpIHRoYW5oIHRvw6FuIHNhdSBuw6B5XG4gICAgICAgICAgICAgICAgICAgIHNhdmVWbnBheVRyYW5zYWN0aW9uKHZucF9UeG5SZWYsIG1hVmUsIGFtb3VudCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gVOG6oW8gUVIgY29kZSB04burIFVSTCB0aGFuaCB0b8OhblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2VuZXJhdGVRUkNvZGVJbWFnZShwYXltZW50VXJsLCAyMDAsIDIwMCk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuLi4uXG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCLEkMOjIHTDrG0gdGjhuqV5IEtoYWNoSGFuZzogXCIgKyBraGFjaEhhbmcuZ2V0TWFLaGFjaEhhbmcoKSk7XG5cbiAgICAgICAgICAgIC8vIDIuIFThuqFvIGjDs2EgxJHGoW4gbeG7m2lcbiAgICAgICAgICAgIEhvYURvbiBob2FEb24gPSBuZXcgSG9hRG9uKCk7XG4gICAgICAgICAgICBTdHJpbmcgbWFIRCA9IGdlbmVyYXRlTWFIRCgpO1xuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiR2VuZXJhdGVkIE1hSEQ6IFwiICsgbWFIRCk7XG4gICAgICAgICAgICBob2FEb24uc2V0TWFIRChtYUhEKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXROZ2F5TGFwKExvY2FsRGF0ZVRpbWUubm93KCkpO1xuICAgICAgICAgICAgaG9hRG9uLnNldFRpZW5HaWFtKGdpYVZlQmFuRGF1IC0gdmVUYXVIaWVuVGFpLmdldEdpYVZlKCkpO1xuICAgICAgICAgICAgaG9hRG9uLnNldFRvbmdUaWVuKHZlVGF1SGllblRhaS5nZXRHaWFWZSgpKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXRLaGFjaEhhbmcoa2hhY2hIYW5nKTtcblxuICAgICAgICAgICAgLy8gRGVidWdnaW5nIHRoZSBOaGFuVmllbiByZWZlcmVuY2VcbiAgICAgICAgICAgIGlmIChuaGFuVmllblBhbmVsID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCJFUlJPUjogbmhhblZpZW5QYW5lbCBpcyBudWxsXCIpO1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oXCJUaGnhur91IHRow7RuZyB0aW4gbmjDom4gdmnDqm4hXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiTmhhblZpZW4gaW5mbzogXCIgKyBuaGFuVmllblBhbmVsLmdldENsYXNzKCkuZ2V0TmFtZSgpKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXROdihuaGFuVmllblBhbmVsKTtcblxuICAgICAgICAgICAgLy8gR2V0IExvYWlIb2FEb24gYW5kIHZlcmlmeSBpdCBleGlzdHNcbiAgICAgICAgICAgIExvYWlIb2FEb24gbG9haUhvYURvbiA9IGxvYWlIb2FEb25EQU8uZmluZEJ5SWQoXCJMSEQwMDFcIik7XG4gICAgICAgICAgICBpZiAobG9haUhvYURvbiA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFwiRVJST1I6IEtow7RuZyB0w6xtIHRo4bqleSBsb+G6oWkgaMOzYSDEkcahbiBMSEQwMDFcIik7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbihcIktow7RuZyB0w6xtIHRo4bqleSBsb+G6oWkgaMOzYSDEkcahbiFcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJGb3VuZCBMb2FpSG9hRG9uOiBcIiArIGxvYWlIb2FEb24uZ2V0TWFMb2FpSG9hRG9uKCkpO1xuICAgICAgICAgICAgaG9hRG9uLnNldExvYWlIb2FEb24obG9haUhvYURvbik7XG5cbiAgICAgICAgICAgIC8vIDMuIEzGsHUgaMOzYSDEkcahblxuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiQXR0ZW1wdGluZyB0byBzYXZlIEhvYURvbi4uLlwiKTtcbiAgICAgICAgICAgIGJvb2xlYW4gc2F2ZWRIb2FEb24gPSBob2FEb25EQU8uc2F2ZUhvYURvbihob2FEb24pO1xuICAgICAgICAgICAgaWYgKCFzYXZlZEhvYURvbikge1xuICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihcIkZhaWxlZCB0byBzYXZlIEhvYURvbiFcIik7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbihcIktow7RuZyB0aOG7gyBsxrB1IGjDs2EgxJHGoW4hXCIpO1xuICAgICAgICAgICAgfVxuLi4uXG5cbiAgICAgICAgICAgIGNoaVRpZXRIb2FEb24uc2V0VGhhbmhUaWVuKHRoYW5oVGllbik7XG4gICAgICAgICAgICBjaGlUaWV0SG9hRG9uLnNldFRpZW5UaHVlKHRpZW5UaHVlKTtcblxuICAgICAgICAgICAgLy8gNS4gTMawdSBjaGkgdGnhur90IGjDs2EgxJHGoW5cbiAgICAgICAgICAgIGJvb2xlYW4gc2F2ZWRDaGlUaWV0ID0gY2hpVGlldEhvYURvbkRBTy5zYXZlKGNoaVRpZXRIb2FEb24pO1xuICAgICAgICAgICAgaWYgKCFzYXZlZENoaVRpZXQpIHtcbiAgICAgICAgICAgICAgICAvLyBYw7NhIGjDs2EgxJHGoW4gxJHDoyB04bqhbyBu4bq/dSBraMO0bmcgdGjhu4MgbMawdSBjaGkgdGnhur90XG4gICAgICAgICAgICAgICAgLy8gaG9hRG9uREFPLmRlbGV0ZShtYUhEKTsgLy8gR2nhuqMgxJHhu4tuaCBjw7MgcGjGsMahbmcgdGjhu6ljIGRlbGV0ZVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oXCJLaMO0bmcgdGjhu4MgbMawdSBjaGkgdGnhur90IGjDs2EgxJHGoW4hXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCLEkMOjIHTDrG0gdGjhuqV5IEtoYWNoSGFuZzogXCIgKyBraGFjaEhhbmcuZ2V0TWFLaGFjaEhhbmcoKSk7XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJHZW5lcmF0ZWQgTWFIRDogXCIgKyBtYUhEKTtcbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIk5oYW5WaWVuIGluZm86IFwiICsgbmhhblZpZW5QYW5lbC5nZXRDbGFzcygpLmdldE5hbWUoKSk7XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJGb3VuZCBMb2FpSG9hRG9uOiBcIiArIGxvYWlIb2FEb24uZ2V0TWFMb2FpSG9hRG9uKCkpO1xuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiSG9hRG9uIHNhdmVkIHN1Y2Nlc3NmdWxseSFcIik7XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJDaGlUaWV0SG9hRG9uIHNhdmVkIHN1Y2Nlc3NmdWxseSFcIik7XG5cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuXG4gICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCJFcnJvciBpbiB4dUx5VGhhbmhUb2FuOiBcIiArIGUuZ2V0TWVzc2FnZSgpKTtcbiAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgICAgICB0aHJvdyBuZXcgUmVtb3RlRXhjZXB0aW9uKFwiTOG7l2kga2hpIHjhu60gbMO9IHRoYW5oIHRvw6FuOiBcIiArIGUuZ2V0TWVzc2FnZSgpLCBlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgU3RyaW5nIGdlbmVyYXRlTWFIRCgpIHtcbiAgICAgICAgLy8gRm9ybWF0OiBIRCArIHl5eXlNTWRkICsgNCBz4buRIHJhbmRvbVxuICAgICAgICBTaW1wbGVEYXRlRm9ybWF0IHNkZiA9IG5ldyBTaW1wbGVEYXRlRm9ybWF0KFwieXl5eU1NZGRcIik7XG4gICAgICAgIFN0cmluZyBkYXRlUGFydCA9IHNkZi5mb3JtYXQobmV3IERhdGUoKSk7XG4gICAgICAgIFN0cmluZyByYW5kb21QYXJ0ID0gU3RyaW5nLmZvcm1hdChcIiUwNGRcIiwgbmV3IFJhbmRvbSgpLm5leHRJbnQoMTAwMDApKTtcbiAgICAgICAgcmV0dXJuIFwiSERcIiArIGRhdGVQYXJ0ICsgcmFuZG9tUGFydDtcbiAgICB9XG59Li4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9UaGFuaFRvYW5HVUkuamF2YVxuLi4uXG5cbiAgICAvLyBQYXltZW50IGZpZWxkc1xuICAgIHByaXZhdGUgSlRleHRGaWVsZCBhbW91bnRQYWlkRmllbGQ7XG4gICAgcHJpdmF0ZSBKTGFiZWwgY2hhbmdlQW1vdW50TGFiZWw7XG5cbiAgICAvLyBEYXRhXG4gICAgcHJpdmF0ZSBNYXA8U3RyaW5nLCBTdHJpbmc+IHRpY2tldHNNYXA7IC8vIE1hcCBvZiBzZWF0IElEcyB0byBzY2hlZHVsZSBJRHNcbiAgICBwcml2YXRlIENvbG9yIHByaW1hcnlDb2xvciA9IG5ldyBDb2xvcigwLCAxMzYsIDIwNCk7XG5cbiAgICAvLyBFbXBsb3llZSBpbmZvcm1hdGlvblxuICAgIHByaXZhdGUgTmhhblZpZW4gbmhhblZpZW47XG5cbiAgICAvLyBEQU9zXG4gICAgcHJpdmF0ZSBMaWNoVHJpbmhUYXVEQU8gbGljaFRyaW5oVGF1REFPO1xuICAgIHByaXZhdGUgQ2hvTmdvaURBTyBjaG9OZ29pREFPO1xuICAgIHByaXZhdGUgVG9hVGF1REFPIHRvYVRhdURBTztcbiAgICBwcml2YXRlIFRhdURBTyB0YXVEQU87XG4gICAgcHJpdmF0ZSBLaHV5ZW5NYWlEQU8ga2h1eWVuTWFpREFPO1xuICAgIHByaXZhdGUgS2hhY2hIYW5nREFPIGtoYWNoSGFuZ0RBTztcbiAgICBwcml2YXRlIGRhby5Mb2FpS2hhY2hIYW5nREFPIGxvYWlLaGFjaEhhbmdEQU87XG4gICAgcHJpdmF0ZSBWZVRhdURBTyB2ZVRhdURBTztcbiAgICBwcml2YXRlIEhvYURvbkRBTyBob2FEb25EQU87XG4gICAgcHJpdmF0ZSBDaGlUaWV0SG9hRG9uREFPIGNoaVRpZXRIb2FEb25EQU87XG4gICAgcHJpdmF0ZSBMb2FpSG9hRG9uREFPIGxvYWlIb2FEb25EQU87XG4uLi5cblxuICAgICAgICAvLyBDcmVhdGUgc291dGggcGFuZWwgZm9yIGN1c3RvbWVyIGluZm8gYW5kIHBheW1lbnQgYnV0dG9uXG4gICAgICAgIEpQYW5lbCBzb3V0aFBhbmVsID0gbmV3IEpQYW5lbChuZXcgQm9yZGVyTGF5b3V0KDAsIDEwKSk7XG5cbiAgICAgICAgLy8gQ3VzdG9tZXIgaW5mb3JtYXRpb24gc2VjdGlvblxuICAgICAgICBKUGFuZWwgY3VzdG9tZXJQYW5lbCA9IGNyZWF0ZUN1c3RvbWVySW5mb1BhbmVsKCk7XG4gICAgICAgIHNvdXRoUGFuZWwuYWRkKGN1c3RvbWVyUGFuZWwsIEJvcmRlckxheW91dC5OT1JUSCk7XG5cbiAgICAgICAgLy8gUGF5bWVudCBidXR0b25cbiAgICAgICAgSlBhbmVsIHBheW1lbnRQYW5lbCA9IG5ldyBKUGFuZWwobmV3IEZsb3dMYXlvdXQoRmxvd0xheW91dC5SSUdIVCkpO1xuICAgICAgICBKQnV0dG9uIHBheUJ1dHRvbiA9IG5ldyBKQnV0dG9uKFwiVGhhbmggdG/DoW5cIik7XG4gICAgICAgIHBheUJ1dHRvbi5zZXRCYWNrZ3JvdW5kKHByaW1hcnlDb2xvcik7XG4gICAgICAgIHBheUJ1dHRvbi5zZXRGb3JlZ3JvdW5kKENvbG9yLldISVRFKTtcbiAgICAgICAgcGF5QnV0dG9uLnNldEZvbnQobmV3IEZvbnQoXCJBcmlhbFwiLCBGb250LkJPTEQsIDE0KSk7XG4gICAgICAgIHBheUJ1dHRvbi5zZXRQcmVmZXJyZWRTaXplKG5ldyBEaW1lbnNpb24oMTIwLCAzNSkpO1xuICAgICAgICBwYXlCdXR0b24uYWRkQWN0aW9uTGlzdGVuZXIoZSAtPiBwcm9jZXNzUGF5bWVudCgpKTtcbiAgICAgICAgcGF5bWVudFBhbmVsLmFkZChwYXlCdXR0b24pO1xuICAgICAgICBzb3V0aFBhbmVsLmFkZChwYXltZW50UGFuZWwsIEJvcmRlckxheW91dC5TT1VUSCk7XG4uLi5cblxuICAgICAgICAgICAgLy8gRm9ybWF0IHByaWNlXG4gICAgICAgICAgICBTdHJpbmcgcHJpY2VTdHIgPSBmb3JtYXRDdXJyZW5jeShwcmljZSk7XG5cbiAgICAgICAgICAgIC8vIFZBVCBjYWxjdWxhdGlvbiAoZml4ZWQgYXQgMTAlKVxuICAgICAgICAgICAgU3RyaW5nIHZhdFN0ciA9IFwiMTAlXCI7XG5cbiAgICAgICAgICAgIC8vIFBhc3NlbmdlciB0eXBlIGRpc2NvdW50IChlbXB0eSBmb3Igbm93KVxuICAgICAgICAgICAgU3RyaW5nIHByb21vdGlvbiA9IFwiXCI7XG5cbiAgICAgICAgICAgIC8vIFByb21vdGlvbiBkaXNjb3VudCAoZW1wdHkgZm9yIG5vdylcbiAgICAgICAgICAgIFN0cmluZyBwcm9tb3Rpb25EaXNjb3VudFN0ciA9IFwiMFwiO1xuXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgdG90YWwgKHByaWNlICsgVkFUKVxuICAgICAgICAgICAgZG91YmxlIHRvdGFsRm9yVGlja2V0ID0gcHJpY2UgKyAocHJpY2UgKiAwLjEpO1xuICAgICAgICAgICAgU3RyaW5nIHRvdGFsU3RyID0gZm9ybWF0Q3VycmVuY3kodG90YWxGb3JUaWNrZXQpO1xuXG4gICAgICAgICAgICAvLyBDcmVhdGUgcGFzc2VuZ2VyIGluZm8gY29tcG9uZW50IC0gd2lsbCBiZSByZXBsYWNlZCBieSB0aGUgY3VzdG9tIHJlbmRlcmVyXG4gICAgICAgICAgICBQYXNzZW5nZXJJbmZvIHBhc3NlbmdlckluZm8gPSBuZXcgUGFzc2VuZ2VySW5mbygpO1xuXG4gICAgICAgICAgICAvLyBBZGQgcm93IHRvIHRhYmxlXG4gICAgICAgICAgICB0YWJsZU1vZGVsLmFkZFJvdyhuZXcgT2JqZWN0W10ge1xuICAgICAgICAgICAgICAgICAgICBwYXNzZW5nZXJJbmZvLCBzZWF0SW5mbywgcHJpY2VTdHIsIHZhdFN0cixcbiAgICAgICAgICAgICAgICAgICAgcHJvbW90aW9uLCBwcm9tb3Rpb25EaXNjb3VudFN0ciwgdG90YWxTdHIsIFwiWFwiXG4gICAgICAgICAgICB9KTtcbi4uLlxuXG4gICAgLyoqXG4gICAgICogQ2FsY3VsYXRlIGNoYW5nZSBiYXNlZCBvbiBhbW91bnQgcGFpZCBhbmQgdG90YWwgYW1vdW50XG4gICAgICovXG4gICAgcHJpdmF0ZSB2b2lkIGNhbGN1bGF0ZUNoYW5nZSgpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEdldCBhbW91bnQgcGFpZCBmcm9tIHRleHQgZmllbGRcbiAgICAgICAgICAgIFN0cmluZyBhbW91bnRQYWlkU3RyID0gYW1vdW50UGFpZEZpZWxkLmdldFRleHQoKS50cmltKCk7XG4gICAgICAgICAgICBpZiAoYW1vdW50UGFpZFN0ci5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgICAgICBjaGFuZ2VBbW91bnRMYWJlbC5zZXRUZXh0KFwiMFwiKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFBhcnNlIGFtb3VudCBwYWlkIChyZW1vdmUgY29tbWFzIGlmIHByZXNlbnQpXG4gICAgICAgICAgICBkb3VibGUgYW1vdW50UGFpZCA9IERvdWJsZS5wYXJzZURvdWJsZShhbW91bnRQYWlkU3RyLnJlcGxhY2UoXCIsXCIsIFwiXCIpKTtcblxuICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIGNoYW5nZVxuICAgICAgICAgICAgZG91YmxlIGNoYW5nZSA9IGFtb3VudFBhaWQgLSB0b3RhbEFtb3VudDtcblxuICAgICAgICAgICAgLy8gVXBkYXRlIGNoYW5nZSBhbW91bnQgbGFiZWxcbiAgICAgICAgICAgIGlmIChjaGFuZ2UgPj0gMCkge1xuICAgICAgICAgICAgICAgIGNoYW5nZUFtb3VudExhYmVsLnNldFRleHQoZm9ybWF0Q3VycmVuY3koY2hhbmdlKSk7XG4gICAgICAgICAgICAgICAgY2hhbmdlQW1vdW50TGFiZWwuc2V0Rm9yZWdyb3VuZChuZXcgQ29sb3IoMCwgMTI4LCAwKSk7IC8vIEdyZWVuIGZvciBwb3NpdGl2ZSBjaGFuZ2VcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY2hhbmdlQW1vdW50TGFiZWwuc2V0VGV4dChcIlRoaeG6v3U6IFwiICsgZm9ybWF0Q3VycmVuY3koTWF0aC5hYnMoY2hhbmdlKSkpO1xuICAgICAgICAgICAgICAgIGNoYW5nZUFtb3VudExhYmVsLnNldEZvcmVncm91bmQoQ29sb3IuUkVEKTsgLy8gUmVkIGZvciBuZWdhdGl2ZSBjaGFuZ2UgKGluc3VmZmljaWVudCBwYXltZW50KVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChOdW1iZXJGb3JtYXRFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgLy8gSW52YWxpZCBpbnB1dCwgc2V0IGNoYW5nZSB0byAwXG4gICAgICAgICAgICBjaGFuZ2VBbW91bnRMYWJlbC5zZXRUZXh0KFwiTmjhuq1wIGtow7RuZyBo4bujcCBs4buHXCIpO1xuICAgICAgICAgICAgY2hhbmdlQW1vdW50TGFiZWwuc2V0Rm9yZWdyb3VuZChDb2xvci5SRUQpO1xuICAgICAgICB9XG4gICAgfVxuLi4uXG5cbiAgICAgICAgICAgIC8vIENhbGN1bGF0ZSB0aWNrZXQgdG90YWw6IGJhc2UgcHJpY2UgKyBWQVQgLSBwYXNzZW5nZXIgZGlzY291bnQgLSBwcm9tb3Rpb24gZGlzY291bnRcbiAgICAgICAgICAgIGRvdWJsZSB0aWNrZXRUb3RhbCA9IGJhc2VQcmljZSArIHZhdCAtIHBhc3NlbmdlckRpc2NvdW50QW1vdW50IC0gcHJvbW90aW9uRGlzY291bnQ7XG5cbiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgcm93IHdpdGggbmV3IHZhbHVlc1xuICAgICAgICAgICAgU3RyaW5nIGRpc2NvdW50U3RyID0gcGFzc2VuZ2VyRGlzY291bnRBbW91bnQgPiAwID9cbiAgICAgICAgICAgICAgICAgICAgU3RyaW5nLmZvcm1hdChcIi0lcyAoJXMlJSlcIiwgZm9ybWF0Q3VycmVuY3kocGFzc2VuZ2VyRGlzY291bnRBbW91bnQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChpbnQpKGRpc2NvdW50UGVyY2VudGFnZSAqIDEwMCkpIDogXCJcIjtcblxuICAgICAgICAgICAgdGFibGVNb2RlbC5zZXRWYWx1ZUF0KGRpc2NvdW50U3RyLCBpLCA0KTsgLy8gVXBkYXRlIHBhc3NlbmdlciBkaXNjb3VudCBjb2x1bW5cbiAgICAgICAgICAgIHRhYmxlTW9kZWwuc2V0VmFsdWVBdChmb3JtYXRDdXJyZW5jeSh0aWNrZXRUb3RhbCksIGksIDYpOyAvLyBVcGRhdGUgdG90YWwgY29sdW1uXG5cbiAgICAgICAgICAgIHRvdGFsQW1vdW50ICs9IHRpY2tldFRvdGFsO1xuICAgICAgICB9XG5cbiAgICAgICAgdG90YWxBbW91bnRMYWJlbC5zZXRUZXh0KGZvcm1hdEN1cnJlbmN5KHRvdGFsQW1vdW50KSk7XG5cbiAgICAgICAgLy8gVXBkYXRlIGNvbmZpcm1hdGlvbiB0ZXh0IGFyZWEgd2l0aCB0aWNrZXQgaW5mb3JtYXRpb25cbiAgICAgICAgdXBkYXRlQ29uZmlybWF0aW9uVGV4dCgpO1xuXG4gICAgICAgIC8vIFJlc2V0IGNoYW5nZSBjYWxjdWxhdGlvblxuICAgICAgICBpZiAoYW1vdW50UGFpZEZpZWxkICE9IG51bGwpIHtcbiAgICAgICAgICAgIGNhbGN1bGF0ZUNoYW5nZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlIGFsbCB0aWNrZXRzXG4gICAgICovXG4gICAgcHJpdmF0ZSB2b2lkIHJlbW92ZUFsbFRpY2tldHMoKSB7XG4gICAgICAgIGludCBjb25maXJtID0gSk9wdGlvblBhbmUuc2hvd0NvbmZpcm1EaWFsb2coXG4gICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICBcIkLhuqFuIGPDsyBjaOG6r2MgbXXhu5FuIHjDs2EgdOG6pXQgY+G6oyB2w6k/XCIsXG4gICAgICAgICAgICAgICAgXCJYw6FjIG5o4bqtblwiLFxuICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLllFU19OT19PUFRJT05cbiAgICAgICAgKTtcblxuICAgICAgICBpZiAoY29uZmlybSA9PSBKT3B0aW9uUGFuZS5ZRVNfT1BUSU9OKSB7XG4gICAgICAgICAgICB0YWJsZU1vZGVsLnNldFJvd0NvdW50KDApO1xuICAgICAgICAgICAgdGlja2V0c01hcC5jbGVhcigpO1xuICAgICAgICAgICAgY2FsY3VsYXRlVG90YWwoKTtcbiAgICAgICAgfVxuICAgIH1cbi4uLlxuXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgcHJvbW90aW9uIGRpc2NvdW50IGFtb3VudFxuICAgICAgICAgICAgZG91YmxlIGRpc2NvdW50QW1vdW50ID0gYmFzZVByaWNlICogZGlzY291bnRQZXJjZW50YWdlO1xuXG4gICAgICAgICAgICAvLyBGb3JtYXQgdGhlIGRpc2NvdW50IGFtb3VudCBhcyBhIG5lZ2F0aXZlIG51bWJlciB0byBpbmRpY2F0ZSBpdCdzIGEgZGlzY291bnRcbiAgICAgICAgICAgIFN0cmluZyBkaXNjb3VudFN0ciA9IFwiLVwiICsgZm9ybWF0Q3VycmVuY3koZGlzY291bnRBbW91bnQpO1xuXG4gICAgICAgICAgICAvLyBSZXBsYWNlIHRoZSBpbnN1cmFuY2UgYW1vdW50IHdpdGggdGhlIHByb21vdGlvbiBkaXNjb3VudFxuICAgICAgICAgICAgdGFibGVNb2RlbC5zZXRWYWx1ZUF0KGRpc2NvdW50U3RyLCBpLCA1KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNob3cgc3VjY2VzcyBtZXNzYWdlXG4gICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgXCLEkMOjIMOhcCBk4bulbmcga2h1eeG6v24gbcOjaTogXCIgKyBzZWxlY3RlZFByb21vdGlvbi5nZXRUZW5LTSgpLFxuICAgICAgICAgICAgICAgIFwiVGjDtG5nIGLDoW9cIixcbiAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5JTkZPUk1BVElPTl9NRVNTQUdFXG4gICAgICAgICk7XG5cbiAgICAgICAgLy8gUmVjYWxjdWxhdGUgdG90YWwgd2l0aCBwcm9tb3Rpb25cbiAgICAgICAgY2FsY3VsYXRlVG90YWwoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcm9jZXNzIHBheW1lbnRcbiAgICAgKi9cbiAgICBwcml2YXRlIHZvaWQgcHJvY2Vzc1BheW1lbnQoKSB7XG4gICAgICAgIC8vIFZhbGlkYXRlIHJlcXVpcmVkIGZpZWxkc1xuICAgICAgICBpZiAobmFtZUZpZWxkLmdldFRleHQoKS50cmltKCkuaXNFbXB0eSgpIHx8XG4gICAgICAgICAgICAgICAgaWRDYXJkRmllbGQuZ2V0VGV4dCgpLnRyaW0oKS5pc0VtcHR5KCkgfHxcbiAgICAgICAgICAgICAgICBwaG9uZUZpZWxkLmdldFRleHQoKS50cmltKCkuaXNFbXB0eSgpKSB7XG5cbiAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBcIlZ1aSBsw7JuZyDEkWnhu4FuIMSR4bqneSDEkeG7pyBjw6FjIHRyxrDhu51uZyBi4bqvdCBideG7mWNcIixcbiAgICAgICAgICAgICAgICAgICAgXCJM4buXaVwiLFxuICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVmFsaWRhdGUgZW1haWwgbWF0Y2ggaWYgcHJvdmlkZWRcbiAgICAgICAgaWYgKCFlbWFpbEZpZWxkLmdldFRleHQoKS50cmltKCkuaXNFbXB0eSgpICYmXG4gICAgICAgICAgICAgICAgIWVtYWlsRmllbGQuZ2V0VGV4dCgpLmVxdWFscyhjb25maXJtRW1haWxGaWVsZC5nZXRUZXh0KCkpKSB7XG5cbiAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBcIkVtYWlsIHjDoWMgbmjhuq1uIGtow7RuZyBraOG7m3AgduG7m2kgZW1haWwgxJHDoyBuaOG6rXBcIixcbiAgICAgICAgICAgICAgICAgICAgXCJM4buXaVwiLFxuICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4uLi5cblxuICAgICAgICBpZiAobWlzc2luZ1Bhc3NlbmdlckluZm8pIHtcbiAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBcIlZ1aSBsw7JuZyDEkWnhu4FuIMSR4bqneSDEkeG7pyB0aMO0bmcgdGluIGjDoG5oIGtow6FjaCBjaG8gdOG6pXQgY+G6oyBjw6FjIHbDqVwiLFxuICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsXG4gICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0VcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaW52YWxpZENoaWxkQWdlKSB7XG4gICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgXCLEkOG7kWkgdMaw4bujbmcgJ1Ry4bq7IGVtJyBwaOG6o2kgY8OzIHR14buVaSB04burIDEtOVwiLFxuICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsXG4gICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0VcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayBpZiBhbW91bnQgcGFpZCBpcyBzdWZmaWNpZW50XG4gICAgICAgIGlmIChhbW91bnRQYWlkRmllbGQuZ2V0VGV4dCgpLnRyaW0oKS5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBcIlZ1aSBsw7JuZyBuaOG6rXAgc+G7kSB0aeG7gW4ga2jDoWNoIMSRxrBhXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiTOG7l2lcIixcbiAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGFtb3VudFBhaWRGaWVsZC5yZXF1ZXN0Rm9jdXMoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBkb3VibGUgYW1vdW50UGFpZCA9IERvdWJsZS5wYXJzZURvdWJsZShhbW91bnRQYWlkRmllbGQuZ2V0VGV4dCgpLnRyaW0oKS5yZXBsYWNlKFwiLFwiLCBcIlwiKSk7XG4gICAgICAgICAgICBpZiAoYW1vdW50UGFpZCA8IHRvdGFsQW1vdW50KSB7XG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJT4buRIHRp4buBbiBraMOhY2ggxJHGsGEga2jDtG5nIMSR4bunIMSR4buDIHRoYW5oIHRvw6FuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBhbW91bnRQYWlkRmllbGQucmVxdWVzdEZvY3VzKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChOdW1iZXJGb3JtYXRFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIFwiU+G7kSB0aeG7gW4ga2jDoWNoIMSRxrBhIGtow7RuZyBo4bujcCBs4buHXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiTOG7l2lcIixcbiAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGFtb3VudFBhaWRGaWVsZC5yZXF1ZXN0Rm9jdXMoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNob3cgcGF5bWVudCBvcHRpb25zIGRpYWxvZ1xuICAgICAgICBTdHJpbmdbXSBvcHRpb25zID0ge1wiVGnhu4FuIG3hurd0XCIsIFwiVGjhursgdMOtbiBk4bulbmdcIiwgXCJDaHV54buDbiBraG/huqNuXCIsIFwiVsOtIMSRaeG7h24gdOG7rVwifTtcbiAgICAgICAgaW50IGNob2ljZSA9IEpPcHRpb25QYW5lLnNob3dPcHRpb25EaWFsb2coXG4gICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICBcIkNo4buNbiBwaMawxqFuZyB0aOG7qWMgdGhhbmggdG/DoW5cIixcbiAgICAgICAgICAgICAgICBcIlRoYW5oIHRvw6FuXCIsXG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuREVGQVVMVF9PUFRJT04sXG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuUVVFU1RJT05fTUVTU0FHRSxcbiAgICAgICAgICAgICAgICBudWxsLFxuICAgICAgICAgICAgICAgIG9wdGlvbnMsXG4gICAgICAgICAgICAgICAgb3B0aW9uc1swXVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIFByb2Nlc3MgYmFzZWQgb24gc2VsZWN0ZWQgcGF5bWVudCBtZXRob2RcbiAgICAgICAgaWYgKGNob2ljZSA+PSAwKSB7XG4gICAgICAgICAgICAvLyBTaG93IHByb2Nlc3NpbmcgbWVzc2FnZVxuICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIFwixJBhbmcgeOG7rSBsw70gdGhhbmggdG/DoW4uLi5cIixcbiAgICAgICAgICAgICAgICAgICAgXCJUaGFuaCB0b8OhblwiLFxuICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5JTkZPUk1BVElPTl9NRVNTQUdFXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIEdldCBjdXN0b21lciBpbmZvcm1hdGlvbiBmcm9tIGZvcm1cbiAgICAgICAgICAgICAgICBTdHJpbmcgY3VzdG9tZXJOYW1lID0gbmFtZUZpZWxkLmdldFRleHQoKS50cmltKCk7XG4gICAgICAgICAgICAgICAgU3RyaW5nIGlkQ2FyZCA9IGlkQ2FyZEZpZWxkLmdldFRleHQoKS50cmltKCk7XG4gICAgICAgICAgICAgICAgU3RyaW5nIHBob25lID0gcGhvbmVGaWVsZC5nZXRUZXh0KCkudHJpbSgpO1xuICAgICAgICAgICAgICAgIFN0cmluZyBlbWFpbCA9IGVtYWlsRmllbGQuZ2V0VGV4dCgpLnRyaW0oKTsgLy8gVGhpcyBpcyB0aGUgYWRkcmVzcyBmaWVsZCBhcyBwZXIgcmVxdWlyZW1lbnRzXG5cbiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiBjdXN0b21lciBleGlzdHMgYnkgSUQgY2FyZCBhbmQgcGhvbmUgbnVtYmVyXG4gICAgICAgICAgICAgICAgS2hhY2hIYW5nIGV4aXN0aW5nQ3VzdG9tZXIgPSBraGFjaEhhbmdEQU8uZmluZEJ5SWRDYXJkQW5kUGhvbmUoaWRDYXJkLCBwaG9uZSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZXhpc3RpbmdDdXN0b21lciAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEN1c3RvbWVyIGV4aXN0c1xuICAgICAgICAgICAgICAgICAgICBpZiAoXCJWSVBcIi5lcXVhbHNJZ25vcmVDYXNlKGV4aXN0aW5nQ3VzdG9tZXIuZ2V0SGFuZ1RoYW5oVmllbigpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ3VzdG9tZXIgaXMgVklQLCBhZGQgbG95YWx0eSBwb2ludHMgKDEgcG9pbnQgcGVyIDEwLDAwMClcbiAgICAgICAgICAgICAgICAgICAgICAgIGludCBwb2ludHNUb0FkZCA9IChpbnQpICh0b3RhbEFtb3VudCAvIDEwMDAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4aXN0aW5nQ3VzdG9tZXIuc2V0RGllbVRpY2hMdXkoZXhpc3RpbmdDdXN0b21lci5nZXREaWVtVGljaEx1eSgpICsgcG9pbnRzVG9BZGQpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgY3VzdG9tZXIgaW4gZGF0YWJhc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGtoYWNoSGFuZ0RBTy51cGRhdGUoZXhpc3RpbmdDdXN0b21lcik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIktow6FjaCBow6BuZyBWSVAgxJHDoyDEkcaw4bujYyBj4buZbmcgXCIgKyBwb2ludHNUb0FkZCArIFwiIMSRaeG7g20gdMOtY2ggbMWpeS5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJUaMO0bmcgYsOhb1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5JTkZPUk1BVElPTl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ3VzdG9tZXIgZXhpc3RzIGJ1dCBpcyBub3QgVklQLCBkb24ndCBhZGQgcG9pbnRzXG4gICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJLaMOhY2ggaMOgbmcga2jDtG5nIHBo4bqjaSBWSVAsIGtow7RuZyDEkcaw4bujYyBj4buZbmcgxJFp4buDbSB0w61jaCBsxal5LlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlRow7RuZyBiw6FvXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLklORk9STUFUSU9OX01FU1NBR0VcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIH1cbi4uLlxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2kga2hpIHTDrG0gbG/huqFpIGtow6FjaCBow6BuZzogXCIgKyBlLmdldE1lc3NhZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gQWRkIG5ldyBjdXN0b21lciB0byBkYXRhYmFzZVxuICAgICAgICAgICAgICAgICAgICBraGFjaEhhbmdEQU8uYWRkKG5ld0N1c3RvbWVyKTtcblxuICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwixJDDoyB0aMOqbSBraMOhY2ggaMOgbmcgbeG7m2kgdsOgbyBjxqEgc+G7nyBk4buvIGxp4buHdS5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlRow7RuZyBiw6FvXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBjaGFuZ2UgZm9yIGNhc2ggcGF5bWVudFxuICAgICAgICAgICAgICAgIFN0cmluZyBjaGFuZ2VNZXNzYWdlID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoY2hvaWNlID09IDApIHsgLy8gQ2FzaCBwYXltZW50XG4gICAgICAgICAgICAgICAgICAgIGRvdWJsZSBhbW91bnRQYWlkID0gRG91YmxlLnBhcnNlRG91YmxlKGFtb3VudFBhaWRGaWVsZC5nZXRUZXh0KCkudHJpbSgpLnJlcGxhY2UoXCIsXCIsIFwiXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgZG91YmxlIGNoYW5nZSA9IGFtb3VudFBhaWQgLSB0b3RhbEFtb3VudDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoYW5nZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZU1lc3NhZ2UgPSBcIlxcblRp4buBbiB0aOG7kWkgbOG6oWk6IFwiICsgZm9ybWF0Q3VycmVuY3koY2hhbmdlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFNob3cgc3VjY2VzcyBtZXNzYWdlXG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJUaGFuaCB0b8OhbiB0aMOgbmggY8O0bmchIFbDqSBj4bunYSBi4bqhbiDEkcOjIMSRxrDhu6NjIMSR4bq3dC5cIiArIGNoYW5nZU1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIlRow6BuaCBjw7RuZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICAvLyBDbG9zZSBjaGVja291dCB3aW5kb3dcbiAgICAgICAgICAgICAgICBkaXNwb3NlKCk7XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaSBraGkgeOG7rSBsw70gdGhhbmggdG/DoW46IFwiICsgZS5nZXRNZXNzYWdlKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9UcmFWZVBhbmVsLmphdmFcbi4uLlxuXG4gICAgICAgICAgICAvLyBU4bqhbyBow7NhIMSRxqFuIG3hu5tpXG4gICAgICAgICAgICBIb2FEb24gaG9hRG9uID0gbmV3IEhvYURvbigpO1xuXG4gICAgICAgICAgICAvLyBTaW5oIG3DoyBow7NhIMSRxqFuIHRoZW8gxJHhu4tuaCBk4bqhbmcgSEQgeXl5eS9NTS9kZCBYWFhYXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIFN0cmluZyBtYUhvYURvbiA9IGhvYURvbkRBTy5nZW5lcmF0ZU1hSG9hRG9uKExvY2FsRGF0ZS5ub3coKSk7XG4gICAgICAgICAgICAgICAgaG9hRG9uLnNldE1hSEQobWFIb2FEb24pO1xuICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgICAgIC8vIE7hur91IGPDsyBs4buXaSwgdOG6oW8gbcOjIGjDs2EgxJHGoW4gdGjhu6cgY8O0bmcgduG7m2kgdGltZXN0YW1wXG4gICAgICAgICAgICAgICAgU3RyaW5nIG1hSG9hRG9uID0gXCJIRFwiICsgTG9jYWxEYXRlLm5vdygpLmZvcm1hdChEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oXCJ5eXl5TU1kZFwiKSkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgIFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpICUgMTAwMDA7XG4gICAgICAgICAgICAgICAgaG9hRG9uLnNldE1hSEQobWFIb2FEb24pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBUaGnhur90IGzhuq1wIGPDoWMgdGjDtG5nIHRpbiBow7NhIMSRxqFuXG4gICAgICAgICAgICBob2FEb24uc2V0TmdheUxhcChMb2NhbERhdGVUaW1lLm5vdygpKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXRUaWVuR2lhbSgwKTsgLy8gS2jDtG5nIGPDsyBnaeG6o20gZ2nDoSBraGkgdHLhuqMgdsOpXG4gICAgICAgICAgICBob2FEb24uc2V0VG9uZ1RpZW4odGllblRyYUxhaSk7IC8vIFThu5VuZyB0aeG7gW4gbMOgIHPhu5EgdGnhu4FuIHRy4bqjIGzhuqFpIGtow6FjaFxuICAgICAgICAgICAgaG9hRG9uLnNldEtoYWNoSGFuZyhraGFjaEhhbmcpO1xuICAgICAgICAgICAgaG9hRG9uLnNldE52KG5oYW5WaWVuKTsgLy8gTmjDom4gdmnDqm4gxJFhbmcgxJHEg25nIG5o4bqtcFxuXG4gICAgICAgICAgICAvLyBUaGnhur90IGzhuq1wIGxv4bqhaSBow7NhIMSRxqFuIGzDoCBcIsSQw6MgdHLhuqNcIiAoTEhEMDAyKVxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBMb2FpSG9hRG9uIGxvYWlIb2FEb24gPSBob2FEb25EQU8uZ2V0TG9haUhvYURvbkJ5SWQoXCJMSEQwMDJcIik7XG4gICAgICAgICAgICAgICAgaWYgKGxvYWlIb2FEb24gPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUnVudGltZUV4Y2VwdGlvbihcIktow7RuZyB0w6xtIHRo4bqleSBsb+G6oWkgaMOzYSDEkcahbiBMSEQwMDJcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGhvYURvbi5zZXRMb2FpSG9hRG9uKGxvYWlIb2FEb24pO1xuICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBSdW50aW1lRXhjZXB0aW9uKFwiTOG7l2kga2hpIGzhuqV5IHRow7RuZyB0aW4gbG/huqFpIGjDs2EgxJHGoW46IFwiICsgZS5nZXRNZXNzYWdlKCkpO1xuICAgICAgICAgICAgfVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2Rhby9pbXBsL0hvYURvbkRBT0ltcGwuamF2YVxuLi4uXG5cbiAgICBAT3ZlcnJpZGVcbiAgICAvLyBDcmVhdGU6IFRow6ptIGjDs2EgxJHGoW4gbeG7m2lcbiAgICBwdWJsaWMgYm9vbGVhbiBzYXZlSG9hRG9uKEhvYURvbiBob2FEb24pIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xuICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gSlBBVXRpbC5nZXRFbnRpdHlNYW5hZ2VyKCk7XG4gICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRyLmJlZ2luKCk7XG5cbiAgICAgICAgICAgIC8vIEtp4buDbSB0cmEgeGVtIG3DoyBow7NhIMSRxqFuIMSRw6MgxJHGsOG7o2MgdGhp4bq/dCBs4bqtcCBjaMawYVxuICAgICAgICAgICAgaWYgKGhvYURvbi5nZXRNYUhEKCkgPT0gbnVsbCB8fCBob2FEb24uZ2V0TWFIRCgpLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgICAgIC8vIE7hur91IGNoxrBhIGPDsyBtw6MgaMOzYSDEkcahbiwgdOG7sSDEkeG7mW5nIHNpbmggbcOjXG4gICAgICAgICAgICAgICAgU3RyaW5nIG1hSEQgPSBnZW5lcmF0ZU1hSG9hRG9uKFxuICAgICAgICAgICAgICAgICAgICAgICAgaG9hRG9uLmdldE5nYXlMYXAoKSAhPSBudWxsID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuLi4iLCJpc19lcnJvciI6ZmFsc2UsInJlcXVlc3RfaWQiOiIiLCJ0b29sX3VzZV9pZCI6InRvb2x1XzAxTldoamtFOHpWRE0zcXNCaDM5bkpQQSJ9fSx7ImlkIjoyLCJ0eXBlIjo0LCJpZGVfc3RhdGVfbm9kZSI6eyJ3b3Jrc3BhY2VGb2xkZXJzIjpbeyJyZXBvc2l0b3J5Um9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIiwiZm9sZGVyUm9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIn1dLCJ3b3Jrc3BhY2VGb2xkZXJzVW5jaGFuZ2VkIjpmYWxzZX19XSwicmVzcG9uc2VfdGV4dCI6IkxldCBtZSBnZXQgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCB0aGUgVGhhbmhUb2FuR1VJJ3MgcHJvY2Vzc1BheW1lbnQgbWV0aG9kLCBzcGVjaWZpY2FsbHkgZm9jdXNpbmcgb24gaG93IGl0IGNyZWF0ZXMgYW5kIHNhdmVzIHRoZSBIb2FEb24gb2JqZWN0OlxuIiwid29ya3NwYWNlX2ZpbGVfY2h1bmtzIjpbXX0seyJzdGF0dXMiOiJzdWNjZXNzIiwicmVxdWVzdF9pZCI6IjY0MzVmMzMxLTIwMDctNGE1OC05ZDhmLTU0NTEyMTY3ZDE1ZiIsInJlcXVlc3RfbWVzc2FnZSI6IiIsInN0cnVjdHVyZWRfb3V0cHV0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6NSwiY29udGVudCI6IiIsInRvb2xfdXNlIjp7InRvb2xfdXNlX2lkIjoidG9vbHVfMDFBWmRhVFE2ZkVFSjVTWXlQcXZwSnN5IiwidG9vbF9uYW1lIjoiY29kZWJhc2UtcmV0cmlldmFsIiwiaW5wdXRfanNvbiI6IntcImluZm9ybWF0aW9uX3JlcXVlc3RcIjogXCJTaG93IG1lIHRoZSBjb21wbGV0ZSBUaGFuaFRvYW5HVUkuamF2YSBmaWxlLCBwYXJ0aWN1bGFybHkgZm9jdXNpbmcgb24gaG93IGl0IGNyZWF0ZXMgYW5kIHNhdmVzIHRoZSBIb2FEb24gb2JqZWN0IHdpdGggdGhlIE5oYW5WaWVuIHJlZmVyZW5jZS4gSSBuZWVkIHRvIHNlZSB0aGUgcGFydCB3aGVyZSBpdCBjYWxscyBob2FEb25EQU8uc2F2ZUhvYURvbigpLlwifSJ9fSx7ImlkIjowLCJ0eXBlIjowLCJjb250ZW50IjoiTGV0IG1lIHRyeSBhIGRpZmZlcmVudCBhcHByb2FjaCB0byBnZXQgdGhlIGNvbXBsZXRlIFRoYW5oVG9hbkdVSS5qYXZhIGZpbGU6XG4ifSx7ImlkIjoyLCJ0eXBlIjoyLCJjb250ZW50IjoiIn0seyJpZCI6MywidHlwZSI6MywiY29udGVudCI6IiJ9XSwic2Vlbl9zdGF0ZSI6InNlZW4iLCJzdHJ1Y3R1cmVkX3JlcXVlc3Rfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjoxLCJ0b29sX3Jlc3VsdF9ub2RlIjp7ImNvbnRlbnQiOiJSYW4gaW50byBVbmtub3duIGVycm9yIHdoaWxlIHRyeWluZyB0byByZWFkIFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZ3VpQ2xpZW50L1RoYW5oVG9hbkdVSS5qYXZhIiwiaXNfZXJyb3IiOnRydWUsInJlcXVlc3RfaWQiOiIiLCJ0b29sX3VzZV9pZCI6InRvb2x1XzAxMlpVRUZUVkJpQ0ZzUFd2QkxmM3FjOSJ9fSx7ImlkIjoyLCJ0eXBlIjo0LCJpZGVfc3RhdGVfbm9kZSI6eyJ3b3Jrc3BhY2VGb2xkZXJzIjpbeyJyZXBvc2l0b3J5Um9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIiwiZm9sZGVyUm9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIn1dLCJ3b3Jrc3BhY2VGb2xkZXJzVW5jaGFuZ2VkIjpmYWxzZX19XSwicmVzcG9uc2VfdGV4dCI6IkxldCBtZSB0cnkgYSBkaWZmZXJlbnQgYXBwcm9hY2ggdG8gZ2V0IHRoZSBjb21wbGV0ZSBUaGFuaFRvYW5HVUkuamF2YSBmaWxlOlxuIiwid29ya3NwYWNlX2ZpbGVfY2h1bmtzIjpbXX0seyJzdGF0dXMiOiJzdWNjZXNzIiwicmVxdWVzdF9pZCI6IjdiYjVlNzRlLWU5ODQtNDFmYy05NzY5LTMxMjM2M2VlZmRkNSIsInJlcXVlc3RfbWVzc2FnZSI6IiIsInN0cnVjdHVyZWRfb3V0cHV0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6NSwiY29udGVudCI6IiIsInRvb2xfdXNlIjp7InRvb2xfdXNlX2lkIjoidG9vbHVfMDFIMURGTkRqNEFoUFdURW9YTXpRRXd0IiwidG9vbF9uYW1lIjoiY29kZWJhc2UtcmV0cmlldmFsIiwiaW5wdXRfanNvbiI6IntcImluZm9ybWF0aW9uX3JlcXVlc3RcIjogXCJTaG93IG1lIHRoZSBwYXJ0IG9mIFRoYW5oVG9hbkdVSS5qYXZhIHdoZXJlIGl0IGNyZWF0ZXMgYSBIb2FEb24gb2JqZWN0IGFuZCBjYWxscyBob2FEb25EQU8uc2F2ZUhvYURvbigpLiBJIG5lZWQgdG8gc2VlIHNwZWNpZmljYWxseSBob3cgaXQgc2V0cyB0aGUgTmhhblZpZW4gb2JqZWN0IG9uIHRoZSBIb2FEb24uXCJ9In19LHsiaWQiOjAsInR5cGUiOjAsImNvbnRlbnQiOiJMZXQgbWUgdHJ5IHRvIGdldCB0aGUgc3BlY2lmaWMgcGFydCBvZiBUaGFuaFRvYW5HVUkuamF2YSB3aGVyZSBpdCBjcmVhdGVzIGFuZCBzYXZlcyB0aGUgSG9hRG9uIG9iamVjdDpcbiJ9LHsiaWQiOjIsInR5cGUiOjIsImNvbnRlbnQiOiIifSx7ImlkIjozLCJ0eXBlIjozLCJjb250ZW50IjoiIn1dLCJzZWVuX3N0YXRlIjoic2VlbiIsInN0cnVjdHVyZWRfcmVxdWVzdF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjEsInRvb2xfcmVzdWx0X25vZGUiOnsiY29udGVudCI6IlRoZSBmb2xsb3dpbmcgY29kZSBzZWN0aW9ucyB3ZXJlIHJldHJpZXZlZDpcblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZ3VpQ2xpZW50L0RvaVZlUGFuZWwuamF2YVxuLi4uXG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCLEkMOjIHTDrG0gdGjhuqV5IEtoYWNoSGFuZzogXCIgKyBraGFjaEhhbmcuZ2V0TWFLaGFjaEhhbmcoKSk7XG5cbiAgICAgICAgICAgIC8vIDIuIFThuqFvIGjDs2EgxJHGoW4gbeG7m2lcbiAgICAgICAgICAgIEhvYURvbiBob2FEb24gPSBuZXcgSG9hRG9uKCk7XG4gICAgICAgICAgICBTdHJpbmcgbWFIRCA9IGdlbmVyYXRlTWFIRCgpO1xuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiR2VuZXJhdGVkIE1hSEQ6IFwiICsgbWFIRCk7XG4gICAgICAgICAgICBob2FEb24uc2V0TWFIRChtYUhEKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXROZ2F5TGFwKExvY2FsRGF0ZVRpbWUubm93KCkpO1xuICAgICAgICAgICAgaG9hRG9uLnNldFRpZW5HaWFtKGdpYVZlQmFuRGF1IC0gdmVUYXVIaWVuVGFpLmdldEdpYVZlKCkpO1xuICAgICAgICAgICAgaG9hRG9uLnNldFRvbmdUaWVuKHZlVGF1SGllblRhaS5nZXRHaWFWZSgpKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXRLaGFjaEhhbmcoa2hhY2hIYW5nKTtcblxuICAgICAgICAgICAgLy8gRGVidWdnaW5nIHRoZSBOaGFuVmllbiByZWZlcmVuY2VcbiAgICAgICAgICAgIGlmIChuaGFuVmllblBhbmVsID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCJFUlJPUjogbmhhblZpZW5QYW5lbCBpcyBudWxsXCIpO1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oXCJUaGnhur91IHRow7RuZyB0aW4gbmjDom4gdmnDqm4hXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiTmhhblZpZW4gaW5mbzogXCIgKyBuaGFuVmllblBhbmVsLmdldENsYXNzKCkuZ2V0TmFtZSgpKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXROdihuaGFuVmllblBhbmVsKTtcblxuICAgICAgICAgICAgLy8gR2V0IExvYWlIb2FEb24gYW5kIHZlcmlmeSBpdCBleGlzdHNcbiAgICAgICAgICAgIExvYWlIb2FEb24gbG9haUhvYURvbiA9IGxvYWlIb2FEb25EQU8uZmluZEJ5SWQoXCJMSEQwMDFcIik7XG4gICAgICAgICAgICBpZiAobG9haUhvYURvbiA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFwiRVJST1I6IEtow7RuZyB0w6xtIHRo4bqleSBsb+G6oWkgaMOzYSDEkcahbiBMSEQwMDFcIik7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbihcIktow7RuZyB0w6xtIHRo4bqleSBsb+G6oWkgaMOzYSDEkcahbiFcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJGb3VuZCBMb2FpSG9hRG9uOiBcIiArIGxvYWlIb2FEb24uZ2V0TWFMb2FpSG9hRG9uKCkpO1xuICAgICAgICAgICAgaG9hRG9uLnNldExvYWlIb2FEb24obG9haUhvYURvbik7XG5cbiAgICAgICAgICAgIC8vIDMuIEzGsHUgaMOzYSDEkcahblxuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiQXR0ZW1wdGluZyB0byBzYXZlIEhvYURvbi4uLlwiKTtcbiAgICAgICAgICAgIGJvb2xlYW4gc2F2ZWRIb2FEb24gPSBob2FEb25EQU8uc2F2ZUhvYURvbihob2FEb24pO1xuICAgICAgICAgICAgaWYgKCFzYXZlZEhvYURvbikge1xuICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihcIkZhaWxlZCB0byBzYXZlIEhvYURvbiFcIik7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbihcIktow7RuZyB0aOG7gyBsxrB1IGjDs2EgxJHGoW4hXCIpO1xuICAgICAgICAgICAgfVxuLi4uXG5cbiAgICAgICAgICAgIGNoaVRpZXRIb2FEb24uc2V0VGhhbmhUaWVuKHRoYW5oVGllbik7XG4gICAgICAgICAgICBjaGlUaWV0SG9hRG9uLnNldFRpZW5UaHVlKHRpZW5UaHVlKTtcblxuICAgICAgICAgICAgLy8gNS4gTMawdSBjaGkgdGnhur90IGjDs2EgxJHGoW5cbiAgICAgICAgICAgIGJvb2xlYW4gc2F2ZWRDaGlUaWV0ID0gY2hpVGlldEhvYURvbkRBTy5zYXZlKGNoaVRpZXRIb2FEb24pO1xuICAgICAgICAgICAgaWYgKCFzYXZlZENoaVRpZXQpIHtcbiAgICAgICAgICAgICAgICAvLyBYw7NhIGjDs2EgxJHGoW4gxJHDoyB04bqhbyBu4bq/dSBraMO0bmcgdGjhu4MgbMawdSBjaGkgdGnhur90XG4gICAgICAgICAgICAgICAgLy8gaG9hRG9uREFPLmRlbGV0ZShtYUhEKTsgLy8gR2nhuqMgxJHhu4tuaCBjw7MgcGjGsMahbmcgdGjhu6ljIGRlbGV0ZVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oXCJLaMO0bmcgdGjhu4MgbMawdSBjaGkgdGnhur90IGjDs2EgxJHGoW4hXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCLEkMOjIHTDrG0gdGjhuqV5IEtoYWNoSGFuZzogXCIgKyBraGFjaEhhbmcuZ2V0TWFLaGFjaEhhbmcoKSk7XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJHZW5lcmF0ZWQgTWFIRDogXCIgKyBtYUhEKTtcbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIk5oYW5WaWVuIGluZm86IFwiICsgbmhhblZpZW5QYW5lbC5nZXRDbGFzcygpLmdldE5hbWUoKSk7XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJGb3VuZCBMb2FpSG9hRG9uOiBcIiArIGxvYWlIb2FEb24uZ2V0TWFMb2FpSG9hRG9uKCkpO1xuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiSG9hRG9uIHNhdmVkIHN1Y2Nlc3NmdWxseSFcIik7XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJDaGlUaWV0SG9hRG9uIHNhdmVkIHN1Y2Nlc3NmdWxseSFcIik7XG5cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9UaGFuaFRvYW5HVUkuamF2YVxuLi4uXG5cbiAgICAvLyBQYXltZW50IGZpZWxkc1xuICAgIHByaXZhdGUgSlRleHRGaWVsZCBhbW91bnRQYWlkRmllbGQ7XG4gICAgcHJpdmF0ZSBKTGFiZWwgY2hhbmdlQW1vdW50TGFiZWw7XG5cbiAgICAvLyBEYXRhXG4gICAgcHJpdmF0ZSBNYXA8U3RyaW5nLCBTdHJpbmc+IHRpY2tldHNNYXA7IC8vIE1hcCBvZiBzZWF0IElEcyB0byBzY2hlZHVsZSBJRHNcbiAgICBwcml2YXRlIENvbG9yIHByaW1hcnlDb2xvciA9IG5ldyBDb2xvcigwLCAxMzYsIDIwNCk7XG5cbiAgICAvLyBFbXBsb3llZSBpbmZvcm1hdGlvblxuICAgIHByaXZhdGUgTmhhblZpZW4gbmhhblZpZW47XG5cbiAgICAvLyBEQU9zXG4gICAgcHJpdmF0ZSBMaWNoVHJpbmhUYXVEQU8gbGljaFRyaW5oVGF1REFPO1xuICAgIHByaXZhdGUgQ2hvTmdvaURBTyBjaG9OZ29pREFPO1xuICAgIHByaXZhdGUgVG9hVGF1REFPIHRvYVRhdURBTztcbiAgICBwcml2YXRlIFRhdURBTyB0YXVEQU87XG4gICAgcHJpdmF0ZSBLaHV5ZW5NYWlEQU8ga2h1eWVuTWFpREFPO1xuICAgIHByaXZhdGUgS2hhY2hIYW5nREFPIGtoYWNoSGFuZ0RBTztcbiAgICBwcml2YXRlIGRhby5Mb2FpS2hhY2hIYW5nREFPIGxvYWlLaGFjaEhhbmdEQU87XG4gICAgcHJpdmF0ZSBWZVRhdURBTyB2ZVRhdURBTztcbiAgICBwcml2YXRlIEhvYURvbkRBTyBob2FEb25EQU87XG4gICAgcHJpdmF0ZSBDaGlUaWV0SG9hRG9uREFPIGNoaVRpZXRIb2FEb25EQU87XG4gICAgcHJpdmF0ZSBMb2FpSG9hRG9uREFPIGxvYWlIb2FEb25EQU87XG5cbiAgICAvKipcbiAgICAgKiBDb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB0aWNrZXRzTWFwIE1hcCBvZiBzZWF0IElEcyB0byBzY2hlZHVsZSBJRHNcbiAgICAgKiBAcGFyYW0gbnYgVGhlIGVtcGxveWVlIHdobyBpcyBwcm9jZXNzaW5nIHRoZSBwYXltZW50XG4gICAgICovXG4gICAgcHVibGljIFRoYW5oVG9hbkdVSShNYXA8U3RyaW5nLCBTdHJpbmc+IHRpY2tldHNNYXAsIE5oYW5WaWVuIG52KSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uIHtcbiAgICAgICAgdGhpcy50aWNrZXRzTWFwID0gdGlja2V0c01hcDtcbiAgICAgICAgdGhpcy5uaGFuVmllbiA9IG52O1xuXG4gICAgICAgIC8vIEluaXRpYWxpemUgREFPc1xuICAgICAgICBsaWNoVHJpbmhUYXVEQU8gPSBuZXcgTGljaFRyaW5oVGF1REFPSW1wbCgpO1xuICAgICAgICBjaG9OZ29pREFPID0gbmV3IENob05nb2lEQU9JbXBsKCk7XG4gICAgICAgIHRvYVRhdURBTyA9IG5ldyBUb2FUYXVEQU9JbXBsKCk7XG4gICAgICAgIHRhdURBTyA9IG5ldyBUYXVEQU9JbXBsKCk7XG4gICAgICAgIGtodXllbk1haURBTyA9IG5ldyBLaHV5ZW5NYWlEQU9JbXBsKCk7XG4gICAgICAgIGtoYWNoSGFuZ0RBTyA9IG5ldyBLaGFjaEhhbmdEQU9JbXBsKCk7XG4gICAgICAgIGxvYWlLaGFjaEhhbmdEQU8gPSBuZXcgTG9haUtoYWNoSGFuZ0RBT0ltcGwoKTtcblxuICAgICAgICBzZXRUaXRsZShcIlRoYW5oIHRvw6FuIHbDqSB0w6B1XCIpO1xuICAgICAgICBzZXRTaXplKDEwMDAsIDcwMCk7XG4gICAgICAgIHNldERlZmF1bHRDbG9zZU9wZXJhdGlvbihKRnJhbWUuRElTUE9TRV9PTl9DTE9TRSk7XG4gICAgICAgIHNldExvY2F0aW9uUmVsYXRpdmVUbyhudWxsKTtcblxuICAgICAgICBpbml0Q29tcG9uZW50cygpO1xuICAgICAgICBjYWxjdWxhdGVUb3RhbCgpO1xuICAgIH1cbi4uLlxuXG4gICAgICAgIC8vIENyZWF0ZSB0aWNrZXRzIHRhYmxlXG4gICAgICAgIGNyZWF0ZVRpY2tldHNUYWJsZSgpO1xuICAgICAgICBKU2Nyb2xsUGFuZSB0YWJsZVNjcm9sbFBhbmUgPSBuZXcgSlNjcm9sbFBhbmUodGlja2V0VGFibGUpO1xuICAgICAgICB0YWJsZVNjcm9sbFBhbmUuc2V0Qm9yZGVyKEJvcmRlckZhY3RvcnkuY3JlYXRlTGluZUJvcmRlcihuZXcgQ29sb3IoMjAwLCAyMDAsIDIwMCkpKTtcbiAgICAgICAgY2VudGVyUGFuZWwuYWRkKHRhYmxlU2Nyb2xsUGFuZSwgQm9yZGVyTGF5b3V0LkNFTlRFUik7XG5cbiAgICAgICAgLy8gQm90dG9tIHBhbmVsIGZvciBidXR0b25zIGFuZCBkaXNjb3VudFxuICAgICAgICBKUGFuZWwgYm90dG9tUGFuZWwgPSBuZXcgSlBhbmVsKG5ldyBCb3JkZXJMYXlvdXQoNSwgMCkpO1xuXG4gICAgICAgIC8vIExlZnQgLSBSZW1vdmUgYWxsIHRpY2tldHMgYnV0dG9uXG4gICAgICAgIEpQYW5lbCBidXR0b25QYW5lbCA9IG5ldyBKUGFuZWwobmV3IEZsb3dMYXlvdXQoRmxvd0xheW91dC5MRUZUKSk7XG4gICAgICAgIEpCdXR0b24gcmVtb3ZlQWxsQnV0dG9uID0gbmV3IEpCdXR0b24oXCJYw7NhIHThuqV0IGPhuqMgY8OhYyB2w6lcIik7XG4gICAgICAgIHJlbW92ZUFsbEJ1dHRvbi5zZXRJY29uKGNyZWF0ZVRyYXNoSWNvbigpKTtcbiAgICAgICAgcmVtb3ZlQWxsQnV0dG9uLmFkZEFjdGlvbkxpc3RlbmVyKGUgLT4gcmVtb3ZlQWxsVGlja2V0cygpKTtcbiAgICAgICAgYnV0dG9uUGFuZWwuYWRkKHJlbW92ZUFsbEJ1dHRvbik7XG4gICAgICAgIGJvdHRvbVBhbmVsLmFkZChidXR0b25QYW5lbCwgQm9yZGVyTGF5b3V0LldFU1QpO1xuLi4uXG5cbiAgICAgICAgLy8gQ3JlYXRlIHNvdXRoIHBhbmVsIGZvciBjdXN0b21lciBpbmZvIGFuZCBwYXltZW50IGJ1dHRvblxuICAgICAgICBKUGFuZWwgc291dGhQYW5lbCA9IG5ldyBKUGFuZWwobmV3IEJvcmRlckxheW91dCgwLCAxMCkpO1xuXG4gICAgICAgIC8vIEN1c3RvbWVyIGluZm9ybWF0aW9uIHNlY3Rpb25cbiAgICAgICAgSlBhbmVsIGN1c3RvbWVyUGFuZWwgPSBjcmVhdGVDdXN0b21lckluZm9QYW5lbCgpO1xuICAgICAgICBzb3V0aFBhbmVsLmFkZChjdXN0b21lclBhbmVsLCBCb3JkZXJMYXlvdXQuTk9SVEgpO1xuXG4gICAgICAgIC8vIFBheW1lbnQgYnV0dG9uXG4gICAgICAgIEpQYW5lbCBwYXltZW50UGFuZWwgPSBuZXcgSlBhbmVsKG5ldyBGbG93TGF5b3V0KEZsb3dMYXlvdXQuUklHSFQpKTtcbiAgICAgICAgSkJ1dHRvbiBwYXlCdXR0b24gPSBuZXcgSkJ1dHRvbihcIlRoYW5oIHRvw6FuXCIpO1xuICAgICAgICBwYXlCdXR0b24uc2V0QmFja2dyb3VuZChwcmltYXJ5Q29sb3IpO1xuICAgICAgICBwYXlCdXR0b24uc2V0Rm9yZWdyb3VuZChDb2xvci5XSElURSk7XG4gICAgICAgIHBheUJ1dHRvbi5zZXRGb250KG5ldyBGb250KFwiQXJpYWxcIiwgRm9udC5CT0xELCAxNCkpO1xuICAgICAgICBwYXlCdXR0b24uc2V0UHJlZmVycmVkU2l6ZShuZXcgRGltZW5zaW9uKDEyMCwgMzUpKTtcbiAgICAgICAgcGF5QnV0dG9uLmFkZEFjdGlvbkxpc3RlbmVyKGUgLT4gcHJvY2Vzc1BheW1lbnQoKSk7XG4gICAgICAgIHBheW1lbnRQYW5lbC5hZGQocGF5QnV0dG9uKTtcbiAgICAgICAgc291dGhQYW5lbC5hZGQocGF5bWVudFBhbmVsLCBCb3JkZXJMYXlvdXQuU09VVEgpO1xuXG4gICAgICAgIC8vIEFkZCBzb3V0aCBwYW5lbCB0byBtYWluIHBhbmVsXG4gICAgICAgIG1haW5QYW5lbC5hZGQoc291dGhQYW5lbCwgQm9yZGVyTGF5b3V0LlNPVVRIKTtcblxuICAgICAgICAvLyBBZGQgbWFpbiBwYW5lbCB0byBmcmFtZVxuICAgICAgICBhZGQobWFpblBhbmVsKTtcblxuICAgICAgICAvLyBTZXQgYSBsYXJnZXIgc2l6ZSBmb3IgdGhlIGZyYW1lIHRvIGFjY29tbW9kYXRlIHRoZSBuZXcgcGFuZWxcbiAgICAgICAgc2V0U2l6ZSgxMzAwLCA3MDApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSB0aXRsZSBwYW5lbFxuICAgICAqL1xuICAgIHByaXZhdGUgSlBhbmVsIGNyZWF0ZVRpdGxlUGFuZWwoKSB7XG4gICAgICAgIEpQYW5lbCBwYW5lbCA9IG5ldyBKUGFuZWwobmV3IEJvcmRlckxheW91dCgpKTtcbiAgICAgICAgSkxhYmVsIHRpdGxlTGFiZWwgPSBuZXcgSkxhYmVsKFwiVGhhbmggdG/DoW4gdsOpIHTDoHVcIiwgSkxhYmVsLkNFTlRFUik7XG4gICAgICAgIHRpdGxlTGFiZWwuc2V0Rm9udChuZXcgRm9udChcIkFyaWFsXCIsIEZvbnQuQk9MRCwgMjApKTtcbiAgICAgICAgdGl0bGVMYWJlbC5zZXRGb3JlZ3JvdW5kKHByaW1hcnlDb2xvcik7XG4gICAgICAgIHRpdGxlTGFiZWwuc2V0Qm9yZGVyKG5ldyBFbXB0eUJvcmRlcigwLCAwLCAxMCwgMCkpO1xuICAgICAgICBwYW5lbC5hZGQodGl0bGVMYWJlbCwgQm9yZGVyTGF5b3V0LkNFTlRFUik7XG4gICAgICAgIHJldHVybiBwYW5lbDtcbiAgICB9XG4uLi5cblxuICAgICAgICAgICAgLy8gR2V0IHRyYWluIGluZm9ybWF0aW9uXG4gICAgICAgICAgICBUYXUgdGF1ID0gdGF1REFPLmdldFRhdUJ5TGljaFRyaW5oVGF1KGxpY2hUcmluaCk7XG4gICAgICAgICAgICBpZiAodGF1ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCJLaMO0bmcgdMOsbSB0aOG6pXkgdGjDtG5nIHRpbiB0w6B1IGNobyBs4buLY2ggdHLDrG5oOiBcIiArIHNjaGVkdWxlSWQpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2V0IHNlYXQgbmFtZS9udW1iZXJcbiAgICAgICAgICAgIFN0cmluZyBzZWF0TmFtZSA9IGNob05nb2kuZ2V0VGVuQ2hvKCkgIT0gbnVsbCA/IGNob05nb2kuZ2V0VGVuQ2hvKCkgOiBzZWF0SWQ7XG5cbiAgICAgICAgICAgIC8vIEdldCBwcmljZSBiYXNlZCBvbiBzZWF0IGNsYXNzIGFuZCByb3V0ZVxuICAgICAgICAgICAgZG91YmxlIHByaWNlID0gZ2V0U2VhdFByaWNlKGNob05nb2ksIHRvYVRhdSk7XG5cbiAgICAgICAgICAgIC8vIEdldCByb3V0ZSBpbmZvcm1hdGlvblxuICAgICAgICAgICAgU3RyaW5nIGZyb20gPSBsaWNoVHJpbmguZ2V0VGF1KCkuZ2V0VHV5ZW5UYXUoKS5nZXRHYURpKCk7XG4gICAgICAgICAgICBTdHJpbmcgdG8gPSBsaWNoVHJpbmguZ2V0VGF1KCkuZ2V0VHV5ZW5UYXUoKS5nZXRHYURlbigpO1xuXG4gICAgICAgICAgICAvLyBGb3JtYXQgZGF0ZSBhbmQgdGltZVxuICAgICAgICAgICAgU3RyaW5nIGRlcGFydERhdGUgPSBsaWNoVHJpbmguZ2V0TmdheURpKCkuZm9ybWF0KERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybihcImRkL01NL3l5eXlcIikpO1xuICAgICAgICAgICAgU3RyaW5nIGRlcGFydFRpbWUgPSBsaWNoVHJpbmguZ2V0R2lvRGkoKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKFwiSEg6bW1cIikpO1xuLi4uXG5cbiAgICAgICAgICAgIC8vIEZvcm1hdCBwcmljZVxuICAgICAgICAgICAgU3RyaW5nIHByaWNlU3RyID0gZm9ybWF0Q3VycmVuY3kocHJpY2UpO1xuXG4gICAgICAgICAgICAvLyBWQVQgY2FsY3VsYXRpb24gKGZpeGVkIGF0IDEwJSlcbiAgICAgICAgICAgIFN0cmluZyB2YXRTdHIgPSBcIjEwJVwiO1xuXG4gICAgICAgICAgICAvLyBQYXNzZW5nZXIgdHlwZSBkaXNjb3VudCAoZW1wdHkgZm9yIG5vdylcbiAgICAgICAgICAgIFN0cmluZyBwcm9tb3Rpb24gPSBcIlwiO1xuXG4gICAgICAgICAgICAvLyBQcm9tb3Rpb24gZGlzY291bnQgKGVtcHR5IGZvciBub3cpXG4gICAgICAgICAgICBTdHJpbmcgcHJvbW90aW9uRGlzY291bnRTdHIgPSBcIjBcIjtcblxuICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIHRvdGFsIChwcmljZSArIFZBVClcbiAgICAgICAgICAgIGRvdWJsZSB0b3RhbEZvclRpY2tldCA9IHByaWNlICsgKHByaWNlICogMC4xKTtcbiAgICAgICAgICAgIFN0cmluZyB0b3RhbFN0ciA9IGZvcm1hdEN1cnJlbmN5KHRvdGFsRm9yVGlja2V0KTtcblxuICAgICAgICAgICAgLy8gQ3JlYXRlIHBhc3NlbmdlciBpbmZvIGNvbXBvbmVudCAtIHdpbGwgYmUgcmVwbGFjZWQgYnkgdGhlIGN1c3RvbSByZW5kZXJlclxuICAgICAgICAgICAgUGFzc2VuZ2VySW5mbyBwYXNzZW5nZXJJbmZvID0gbmV3IFBhc3NlbmdlckluZm8oKTtcblxuICAgICAgICAgICAgLy8gQWRkIHJvdyB0byB0YWJsZVxuICAgICAgICAgICAgdGFibGVNb2RlbC5hZGRSb3cobmV3IE9iamVjdFtdIHtcbiAgICAgICAgICAgICAgICAgICAgcGFzc2VuZ2VySW5mbywgc2VhdEluZm8sIHByaWNlU3RyLCB2YXRTdHIsXG4gICAgICAgICAgICAgICAgICAgIHByb21vdGlvbiwgcHJvbW90aW9uRGlzY291bnRTdHIsIHRvdGFsU3RyLCBcIlhcIlxuICAgICAgICAgICAgfSk7XG4uLi5cblxuICAgICAgICAgICAgLy8gUGFyc2UgYW1vdW50IHBhaWQgKHJlbW92ZSBjb21tYXMgaWYgcHJlc2VudClcbiAgICAgICAgICAgIGRvdWJsZSBhbW91bnRQYWlkID0gRG91YmxlLnBhcnNlRG91YmxlKGFtb3VudFBhaWRTdHIucmVwbGFjZShcIixcIiwgXCJcIikpO1xuXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgY2hhbmdlXG4gICAgICAgICAgICBkb3VibGUgY2hhbmdlID0gYW1vdW50UGFpZCAtIHRvdGFsQW1vdW50O1xuXG4gICAgICAgICAgICAvLyBVcGRhdGUgY2hhbmdlIGFtb3VudCBsYWJlbFxuICAgICAgICAgICAgaWYgKGNoYW5nZSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgY2hhbmdlQW1vdW50TGFiZWwuc2V0VGV4dChmb3JtYXRDdXJyZW5jeShjaGFuZ2UpKTtcbiAgICAgICAgICAgICAgICBjaGFuZ2VBbW91bnRMYWJlbC5zZXRGb3JlZ3JvdW5kKG5ldyBDb2xvcigwLCAxMjgsIDApKTsgLy8gR3JlZW4gZm9yIHBvc2l0aXZlIGNoYW5nZVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjaGFuZ2VBbW91bnRMYWJlbC5zZXRUZXh0KFwiVGhp4bq/dTogXCIgKyBmb3JtYXRDdXJyZW5jeShNYXRoLmFicyhjaGFuZ2UpKSk7XG4gICAgICAgICAgICAgICAgY2hhbmdlQW1vdW50TGFiZWwuc2V0Rm9yZWdyb3VuZChDb2xvci5SRUQpOyAvLyBSZWQgZm9yIG5lZ2F0aXZlIGNoYW5nZSAoaW5zdWZmaWNpZW50IHBheW1lbnQpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKE51bWJlckZvcm1hdEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICAvLyBJbnZhbGlkIGlucHV0LCBzZXQgY2hhbmdlIHRvIDBcbiAgICAgICAgICAgIGNoYW5nZUFtb3VudExhYmVsLnNldFRleHQoXCJOaOG6rXAga2jDtG5nIGjhu6NwIGzhu4dcIik7XG4gICAgICAgICAgICBjaGFuZ2VBbW91bnRMYWJlbC5zZXRGb3JlZ3JvdW5kKENvbG9yLlJFRCk7XG4gICAgICAgIH1cbiAgICB9XG4uLi5cblxuICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIHByb21vdGlvbiBkaXNjb3VudCBhbW91bnRcbiAgICAgICAgICAgIGRvdWJsZSBkaXNjb3VudEFtb3VudCA9IGJhc2VQcmljZSAqIGRpc2NvdW50UGVyY2VudGFnZTtcblxuICAgICAgICAgICAgLy8gRm9ybWF0IHRoZSBkaXNjb3VudCBhbW91bnQgYXMgYSBuZWdhdGl2ZSBudW1iZXIgdG8gaW5kaWNhdGUgaXQncyBhIGRpc2NvdW50XG4gICAgICAgICAgICBTdHJpbmcgZGlzY291bnRTdHIgPSBcIi1cIiArIGZvcm1hdEN1cnJlbmN5KGRpc2NvdW50QW1vdW50KTtcblxuICAgICAgICAgICAgLy8gUmVwbGFjZSB0aGUgaW5zdXJhbmNlIGFtb3VudCB3aXRoIHRoZSBwcm9tb3Rpb24gZGlzY291bnRcbiAgICAgICAgICAgIHRhYmxlTW9kZWwuc2V0VmFsdWVBdChkaXNjb3VudFN0ciwgaSwgNSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTaG93IHN1Y2Nlc3MgbWVzc2FnZVxuICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgIFwixJDDoyDDoXAgZOG7pW5nIGtodXnhur9uIG3Do2k6IFwiICsgc2VsZWN0ZWRQcm9tb3Rpb24uZ2V0VGVuS00oKSxcbiAgICAgICAgICAgICAgICBcIlRow7RuZyBiw6FvXCIsXG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIFJlY2FsY3VsYXRlIHRvdGFsIHdpdGggcHJvbW90aW9uXG4gICAgICAgIGNhbGN1bGF0ZVRvdGFsKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUHJvY2VzcyBwYXltZW50XG4gICAgICovXG4gICAgcHJpdmF0ZSB2b2lkIHByb2Nlc3NQYXltZW50KCkge1xuICAgICAgICAvLyBWYWxpZGF0ZSByZXF1aXJlZCBmaWVsZHNcbiAgICAgICAgaWYgKG5hbWVGaWVsZC5nZXRUZXh0KCkudHJpbSgpLmlzRW1wdHkoKSB8fFxuICAgICAgICAgICAgICAgIGlkQ2FyZEZpZWxkLmdldFRleHQoKS50cmltKCkuaXNFbXB0eSgpIHx8XG4gICAgICAgICAgICAgICAgcGhvbmVGaWVsZC5nZXRUZXh0KCkudHJpbSgpLmlzRW1wdHkoKSkge1xuXG4gICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgXCJWdWkgbMOybmcgxJFp4buBbiDEkeG6p3kgxJHhu6cgY8OhYyB0csaw4budbmcgYuG6r3QgYnXhu5ljXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiTOG7l2lcIixcbiAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFZhbGlkYXRlIGVtYWlsIG1hdGNoIGlmIHByb3ZpZGVkXG4gICAgICAgIGlmICghZW1haWxGaWVsZC5nZXRUZXh0KCkudHJpbSgpLmlzRW1wdHkoKSAmJlxuICAgICAgICAgICAgICAgICFlbWFpbEZpZWxkLmdldFRleHQoKS5lcXVhbHMoY29uZmlybUVtYWlsRmllbGQuZ2V0VGV4dCgpKSkge1xuXG4gICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgXCJFbWFpbCB4w6FjIG5o4bqtbiBraMO0bmcga2jhu5twIHbhu5tpIGVtYWlsIMSRw6Mgbmjhuq1wXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiTOG7l2lcIixcbiAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuLi4uXG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGRvdWJsZSBhbW91bnRQYWlkID0gRG91YmxlLnBhcnNlRG91YmxlKGFtb3VudFBhaWRGaWVsZC5nZXRUZXh0KCkudHJpbSgpLnJlcGxhY2UoXCIsXCIsIFwiXCIpKTtcbiAgICAgICAgICAgIGlmIChhbW91bnRQYWlkIDwgdG90YWxBbW91bnQpIHtcbiAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIlPhu5EgdGnhu4FuIGtow6FjaCDEkcawYSBraMO0bmcgxJHhu6cgxJHhu4MgdGhhbmggdG/DoW5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2lcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0VcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGFtb3VudFBhaWRGaWVsZC5yZXF1ZXN0Rm9jdXMoKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKE51bWJlckZvcm1hdEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgXCJT4buRIHRp4buBbiBraMOhY2ggxJHGsGEga2jDtG5nIGjhu6NwIGzhu4dcIixcbiAgICAgICAgICAgICAgICAgICAgXCJM4buXaVwiLFxuICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgYW1vdW50UGFpZEZpZWxkLnJlcXVlc3RGb2N1cygpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU2hvdyBwYXltZW50IG9wdGlvbnMgZGlhbG9nXG4gICAgICAgIFN0cmluZ1tdIG9wdGlvbnMgPSB7XCJUaeG7gW4gbeG6t3RcIiwgXCJUaOG6uyB0w61uIGThu6VuZ1wiLCBcIkNodXnhu4NuIGtob+G6o25cIiwgXCJWw60gxJFp4buHbiB04butXCJ9O1xuICAgICAgICBpbnQgY2hvaWNlID0gSk9wdGlvblBhbmUuc2hvd09wdGlvbkRpYWxvZyhcbiAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgIFwiQ2jhu41uIHBoxrDGoW5nIHRo4bupYyB0aGFuaCB0b8OhblwiLFxuICAgICAgICAgICAgICAgIFwiVGhhbmggdG/DoW5cIixcbiAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5ERUZBVUxUX09QVElPTixcbiAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5RVUVTVElPTl9NRVNTQUdFLFxuICAgICAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgICAgICAgICBvcHRpb25zWzBdXG4gICAgICAgICk7XG5cbiAgICAgICAgLy8gUHJvY2VzcyBiYXNlZCBvbiBzZWxlY3RlZCBwYXltZW50IG1ldGhvZFxuICAgICAgICBpZiAoY2hvaWNlID49IDApIHtcbiAgICAgICAgICAgIC8vIFNob3cgcHJvY2Vzc2luZyBtZXNzYWdlXG4gICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgXCLEkGFuZyB44butIGzDvSB0aGFuaCB0b8Ohbi4uLlwiLFxuICAgICAgICAgICAgICAgICAgICBcIlRoYW5oIHRvw6FuXCIsXG4gICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLklORk9STUFUSU9OX01FU1NBR0VcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gR2V0IGN1c3RvbWVyIGluZm9ybWF0aW9uIGZyb20gZm9ybVxuICAgICAgICAgICAgICAgIFN0cmluZyBjdXN0b21lck5hbWUgPSBuYW1lRmllbGQuZ2V0VGV4dCgpLnRyaW0oKTtcbiAgICAgICAgICAgICAgICBTdHJpbmcgaWRDYXJkID0gaWRDYXJkRmllbGQuZ2V0VGV4dCgpLnRyaW0oKTtcbiAgICAgICAgICAgICAgICBTdHJpbmcgcGhvbmUgPSBwaG9uZUZpZWxkLmdldFRleHQoKS50cmltKCk7XG4gICAgICAgICAgICAgICAgU3RyaW5nIGVtYWlsID0gZW1haWxGaWVsZC5nZXRUZXh0KCkudHJpbSgpOyAvLyBUaGlzIGlzIHRoZSBhZGRyZXNzIGZpZWxkIGFzIHBlciByZXF1aXJlbWVudHNcblxuICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIGN1c3RvbWVyIGV4aXN0cyBieSBJRCBjYXJkIGFuZCBwaG9uZSBudW1iZXJcbiAgICAgICAgICAgICAgICBLaGFjaEhhbmcgZXhpc3RpbmdDdXN0b21lciA9IGtoYWNoSGFuZ0RBTy5maW5kQnlJZENhcmRBbmRQaG9uZShpZENhcmQsIHBob25lKTtcblxuICAgICAgICAgICAgICAgIGlmIChleGlzdGluZ0N1c3RvbWVyICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQ3VzdG9tZXIgZXhpc3RzXG4gICAgICAgICAgICAgICAgICAgIGlmIChcIlZJUFwiLmVxdWFsc0lnbm9yZUNhc2UoZXhpc3RpbmdDdXN0b21lci5nZXRIYW5nVGhhbmhWaWVuKCkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDdXN0b21lciBpcyBWSVAsIGFkZCBsb3lhbHR5IHBvaW50cyAoMSBwb2ludCBwZXIgMTAsMDAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgaW50IHBvaW50c1RvQWRkID0gKGludCkgKHRvdGFsQW1vdW50IC8gMTAwMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmdDdXN0b21lci5zZXREaWVtVGljaEx1eShleGlzdGluZ0N1c3RvbWVyLmdldERpZW1UaWNoTHV5KCkgKyBwb2ludHNUb0FkZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBjdXN0b21lciBpbiBkYXRhYmFzZVxuICAgICAgICAgICAgICAgICAgICAgICAga2hhY2hIYW5nREFPLnVwZGF0ZShleGlzdGluZ0N1c3RvbWVyKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiS2jDoWNoIGjDoG5nIFZJUCDEkcOjIMSRxrDhu6NjIGPhu5luZyBcIiArIHBvaW50c1RvQWRkICsgXCIgxJFp4buDbSB0w61jaCBsxal5LlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlRow7RuZyBiw6FvXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLklORk9STUFUSU9OX01FU1NBR0VcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDdXN0b21lciBleGlzdHMgYnV0IGlzIG5vdCBWSVAsIGRvbid0IGFkZCBwb2ludHNcbiAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIktow6FjaCBow6BuZyBraMO0bmcgcGjhuqNpIFZJUCwga2jDtG5nIMSRxrDhu6NjIGPhu5luZyDEkWnhu4NtIHTDrWNoIGzFqXkuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiVGjDtG5nIGLDoW9cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRVxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuLi4uXG5cbiAgICAgICAgICAgICAgICAgICAgLy8gR2V0IGEgZGVmYXVsdCBjdXN0b21lciB0eXBlXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBHZXQgYWxsIGN1c3RvbWVyIHR5cGVzXG4gICAgICAgICAgICAgICAgICAgICAgICBMaXN0PExvYWlLaGFjaEhhbmc+IHR5cGVzID0gbG9haUtoYWNoSGFuZ0RBTy5nZXRBbGwoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVHJ5IHRvIGZpbmQgYSBkZWZhdWx0IGN1c3RvbWVyIHR5cGUgKGFzc3VtaW5nIFwiVGjGsOG7nW5nXCIgaXMgdGhlIGRlZmF1bHQgdHlwZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIExvYWlLaGFjaEhhbmcgZGVmYXVsdFR5cGUgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChMb2FpS2hhY2hIYW5nIHR5cGUgOiB0eXBlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChcIlRoxrDhu51uZ1wiLmVxdWFscyh0eXBlLmdldFRlbkxvYWlLaGFjaEhhbmcoKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFR5cGUgPSB0eXBlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIFwiVGjGsOG7nW5nXCIgdHlwZSBkb2Vzbid0IGV4aXN0LCB1c2UgdGhlIGZpcnN0IGF2YWlsYWJsZSB0eXBlXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGVmYXVsdFR5cGUgPT0gbnVsbCAmJiAhdHlwZXMuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFR5cGUgPSB0eXBlcy5nZXQoMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZWZhdWx0VHlwZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q3VzdG9tZXIuc2V0TG9haUtoYWNoSGFuZyhkZWZhdWx0VHlwZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oXCJLaMO0bmcgdMOsbSB0aOG6pXkgbG/huqFpIGtow6FjaCBow6BuZyBuw6BvIHRyb25nIGPGoSBz4bufIGThu68gbGnhu4d1XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2kga2hpIHTDrG0gbG/huqFpIGtow6FjaCBow6BuZzogXCIgKyBlLmdldE1lc3NhZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gQWRkIG5ldyBjdXN0b21lciB0byBkYXRhYmFzZVxuICAgICAgICAgICAgICAgICAgICBraGFjaEhhbmdEQU8uYWRkKG5ld0N1c3RvbWVyKTtcblxuICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwixJDDoyB0aMOqbSBraMOhY2ggaMOgbmcgbeG7m2kgdsOgbyBjxqEgc+G7nyBk4buvIGxp4buHdS5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlRow7RuZyBiw6FvXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBjaGFuZ2UgZm9yIGNhc2ggcGF5bWVudFxuICAgICAgICAgICAgICAgIFN0cmluZyBjaGFuZ2VNZXNzYWdlID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoY2hvaWNlID09IDApIHsgLy8gQ2FzaCBwYXltZW50XG4gICAgICAgICAgICAgICAgICAgIGRvdWJsZSBhbW91bnRQYWlkID0gRG91YmxlLnBhcnNlRG91YmxlKGFtb3VudFBhaWRGaWVsZC5nZXRUZXh0KCkudHJpbSgpLnJlcGxhY2UoXCIsXCIsIFwiXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgZG91YmxlIGNoYW5nZSA9IGFtb3VudFBhaWQgLSB0b3RhbEFtb3VudDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoYW5nZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZU1lc3NhZ2UgPSBcIlxcblRp4buBbiB0aOG7kWkgbOG6oWk6IFwiICsgZm9ybWF0Q3VycmVuY3koY2hhbmdlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFNob3cgc3VjY2VzcyBtZXNzYWdlXG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJUaGFuaCB0b8OhbiB0aMOgbmggY8O0bmchIFbDqSBj4bunYSBi4bqhbiDEkcOjIMSRxrDhu6NjIMSR4bq3dC5cIiArIGNoYW5nZU1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIlRow6BuaCBjw7RuZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICAvLyBDbG9zZSBjaGVja291dCB3aW5kb3dcbiAgICAgICAgICAgICAgICBkaXNwb3NlKCk7XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaSBraGkgeOG7rSBsw70gdGhhbmggdG/DoW46IFwiICsgZS5nZXRNZXNzYWdlKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2Rhby9pbXBsL0hvYURvbkRBT0ltcGwuamF2YVxuLi4uXG5cbiAgICBAT3ZlcnJpZGVcbiAgICAvLyBDcmVhdGU6IFRow6ptIGjDs2EgxJHGoW4gbeG7m2lcbiAgICBwdWJsaWMgYm9vbGVhbiBzYXZlSG9hRG9uKEhvYURvbiBob2FEb24pIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xuICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gSlBBVXRpbC5nZXRFbnRpdHlNYW5hZ2VyKCk7XG4gICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRyLmJlZ2luKCk7XG5cbiAgICAgICAgICAgIC8vIEtp4buDbSB0cmEgeGVtIG3DoyBow7NhIMSRxqFuIMSRw6MgxJHGsOG7o2MgdGhp4bq/dCBs4bqtcCBjaMawYVxuICAgICAgICAgICAgaWYgKGhvYURvbi5nZXRNYUhEKCkgPT0gbnVsbCB8fCBob2FEb24uZ2V0TWFIRCgpLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgICAgIC8vIE7hur91IGNoxrBhIGPDsyBtw6MgaMOzYSDEkcahbiwgdOG7sSDEkeG7mW5nIHNpbmggbcOjXG4gICAgICAgICAgICAgICAgU3RyaW5nIG1hSEQgPSBnZW5lcmF0ZU1hSG9hRG9uKFxuICAgICAgICAgICAgICAgICAgICAgICAgaG9hRG9uLmdldE5nYXlMYXAoKSAhPSBudWxsID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9hRG9uLmdldE5nYXlMYXAoKS50b0xvY2FsRGF0ZSgpIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTG9jYWxEYXRlLm5vdygpXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBob2FEb24uc2V0TWFIRChtYUhEKTtcbiAgICAgICAgICAgIH1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9ndWlDbGllbnQvVHJhVmVQYW5lbC5qYXZhXG4uLi5cblxuICAgICAgICAgICAgLy8gVOG6oW8gaMOzYSDEkcahbiBt4bubaVxuICAgICAgICAgICAgSG9hRG9uIGhvYURvbiA9IG5ldyBIb2FEb24oKTtcblxuICAgICAgICAgICAgLy8gU2luaCBtw6MgaMOzYSDEkcahbiB0aGVvIMSR4buLbmggZOG6oW5nIEhEIHl5eXkvTU0vZGQgWFhYWFxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBTdHJpbmcgbWFIb2FEb24gPSBob2FEb25EQU8uZ2VuZXJhdGVNYUhvYURvbihMb2NhbERhdGUubm93KCkpO1xuICAgICAgICAgICAgICAgIGhvYURvbi5zZXRNYUhEKG1hSG9hRG9uKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgICAgICAvLyBO4bq/dSBjw7MgbOG7l2ksIHThuqFvIG3DoyBow7NhIMSRxqFuIHRo4bunIGPDtG5nIHbhu5tpIHRpbWVzdGFtcFxuICAgICAgICAgICAgICAgIFN0cmluZyBtYUhvYURvbiA9IFwiSERcIiArIExvY2FsRGF0ZS5ub3coKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKFwieXl5eU1NZGRcIikpICtcbiAgICAgICAgICAgICAgICAgICAgICAgICBTeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKSAlIDEwMDAwO1xuICAgICAgICAgICAgICAgIGhvYURvbi5zZXRNYUhEKG1hSG9hRG9uKTtcbiAgICAgICAgICAgIH1cbi4uLlxuIiwiaXNfZXJyb3IiOmZhbHNlLCJyZXF1ZXN0X2lkIjoiIiwidG9vbF91c2VfaWQiOiJ0b29sdV8wMUFaZGFUUTZmRUVKNVNZeVBxdnBKc3kifX0seyJpZCI6MiwidHlwZSI6NCwiaWRlX3N0YXRlX25vZGUiOnsid29ya3NwYWNlRm9sZGVycyI6W3sicmVwb3NpdG9yeVJvb3QiOiJFOi9MVFBUSkFWQS9OaG9tL1BoYW5UYW5KYXZhTmhvbUdQVC9Qcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyIsImZvbGRlclJvb3QiOiJFOi9MVFBUSkFWQS9OaG9tL1BoYW5UYW5KYXZhTmhvbUdQVC9Qcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyJ9XSwid29ya3NwYWNlRm9sZGVyc1VuY2hhbmdlZCI6ZmFsc2V9fV0sInJlc3BvbnNlX3RleHQiOiJMZXQgbWUgdHJ5IHRvIGdldCB0aGUgc3BlY2lmaWMgcGFydCBvZiBUaGFuaFRvYW5HVUkuamF2YSB3aGVyZSBpdCBjcmVhdGVzIGFuZCBzYXZlcyB0aGUgSG9hRG9uIG9iamVjdDpcbiIsIndvcmtzcGFjZV9maWxlX2NodW5rcyI6W119LHsic3RhdHVzIjoic3VjY2VzcyIsInJlcXVlc3RfaWQiOiIyMTgyNTk5Yi0xOWQzLTRjZTgtYWJjOS0zMzZkMjJjZGQxNzAiLCJyZXF1ZXN0X21lc3NhZ2UiOiIiLCJzdHJ1Y3R1cmVkX291dHB1dF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjUsImNvbnRlbnQiOiIiLCJ0b29sX3VzZSI6eyJ0b29sX3VzZV9pZCI6InRvb2x1XzAxR1p4YkNXaHU1clF1ZUZ3QkdOcXRaYyIsInRvb2xfbmFtZSI6ImNvZGViYXNlLXJldHJpZXZhbCIsImlucHV0X2pzb24iOiJ7XCJpbmZvcm1hdGlvbl9yZXF1ZXN0XCI6IFwiU2hvdyBtZSB0aGUgcGFydCBvZiBUaGFuaFRvYW5HVUkuamF2YSB3aGVyZSBpdCBjcmVhdGVzIHRyYWluIHRpY2tldHMgKFZlVGF1IG9iamVjdHMpIGFuZCBzYXZlcyB0aGVtIHRvIHRoZSBkYXRhYmFzZS4gSSBuZWVkIHRvIHNlZSBob3cgaXQgY3JlYXRlcyBhbmQgc2F2ZXMgdGhlIEhvYURvbiBvYmplY3QgYW5kIGFzc29jaWF0ZXMgaXQgd2l0aCB0aGUgdGlja2V0cy5cIn0ifX0seyJpZCI6MCwidHlwZSI6MCwiY29udGVudCI6IkJhc2VkIG9uIHRoZSBjb2RlIEkndmUgcmV2aWV3ZWQsIEkgY2FuIHNlZSB0aGUgaXNzdWUuIExldCBtZSBjaGVjayBvbmUgbW9yZSB0aGluZyB0byBjb25maXJtIG15IHVuZGVyc3RhbmRpbmc6XG4ifSx7ImlkIjoyLCJ0eXBlIjoyLCJjb250ZW50IjoiIn0seyJpZCI6MywidHlwZSI6MywiY29udGVudCI6IiJ9XSwic2Vlbl9zdGF0ZSI6InNlZW4iLCJzdHJ1Y3R1cmVkX3JlcXVlc3Rfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjoxLCJ0b29sX3Jlc3VsdF9ub2RlIjp7ImNvbnRlbnQiOiJUaGUgZm9sbG93aW5nIGNvZGUgc2VjdGlvbnMgd2VyZSByZXRyaWV2ZWQ6XG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9Eb2lWZVBhbmVsLmphdmFcbi4uLlxuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwixJDDoyB0w6xtIHRo4bqleSBLaGFjaEhhbmc6IFwiICsga2hhY2hIYW5nLmdldE1hS2hhY2hIYW5nKCkpO1xuXG4gICAgICAgICAgICAvLyAyLiBU4bqhbyBow7NhIMSRxqFuIG3hu5tpXG4gICAgICAgICAgICBIb2FEb24gaG9hRG9uID0gbmV3IEhvYURvbigpO1xuICAgICAgICAgICAgU3RyaW5nIG1hSEQgPSBnZW5lcmF0ZU1hSEQoKTtcbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIkdlbmVyYXRlZCBNYUhEOiBcIiArIG1hSEQpO1xuICAgICAgICAgICAgaG9hRG9uLnNldE1hSEQobWFIRCk7XG4gICAgICAgICAgICBob2FEb24uc2V0TmdheUxhcChMb2NhbERhdGVUaW1lLm5vdygpKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXRUaWVuR2lhbShnaWFWZUJhbkRhdSAtIHZlVGF1SGllblRhaS5nZXRHaWFWZSgpKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXRUb25nVGllbih2ZVRhdUhpZW5UYWkuZ2V0R2lhVmUoKSk7XG4gICAgICAgICAgICBob2FEb24uc2V0S2hhY2hIYW5nKGtoYWNoSGFuZyk7XG5cbiAgICAgICAgICAgIC8vIERlYnVnZ2luZyB0aGUgTmhhblZpZW4gcmVmZXJlbmNlXG4gICAgICAgICAgICBpZiAobmhhblZpZW5QYW5lbCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFwiRVJST1I6IG5oYW5WaWVuUGFuZWwgaXMgbnVsbFwiKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKFwiVGhp4bq/dSB0aMO0bmcgdGluIG5ow6JuIHZpw6puIVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIk5oYW5WaWVuIGluZm86IFwiICsgbmhhblZpZW5QYW5lbC5nZXRDbGFzcygpLmdldE5hbWUoKSk7XG4gICAgICAgICAgICBob2FEb24uc2V0TnYobmhhblZpZW5QYW5lbCk7XG5cbiAgICAgICAgICAgIC8vIEdldCBMb2FpSG9hRG9uIGFuZCB2ZXJpZnkgaXQgZXhpc3RzXG4gICAgICAgICAgICBMb2FpSG9hRG9uIGxvYWlIb2FEb24gPSBsb2FpSG9hRG9uREFPLmZpbmRCeUlkKFwiTEhEMDAxXCIpO1xuICAgICAgICAgICAgaWYgKGxvYWlIb2FEb24gPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihcIkVSUk9SOiBLaMO0bmcgdMOsbSB0aOG6pXkgbG/huqFpIGjDs2EgxJHGoW4gTEhEMDAxXCIpO1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oXCJLaMO0bmcgdMOsbSB0aOG6pXkgbG/huqFpIGjDs2EgxJHGoW4hXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiRm91bmQgTG9haUhvYURvbjogXCIgKyBsb2FpSG9hRG9uLmdldE1hTG9haUhvYURvbigpKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXRMb2FpSG9hRG9uKGxvYWlIb2FEb24pO1xuXG4gICAgICAgICAgICAvLyAzLiBMxrB1IGjDs2EgxJHGoW5cbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIkF0dGVtcHRpbmcgdG8gc2F2ZSBIb2FEb24uLi5cIik7XG4gICAgICAgICAgICBib29sZWFuIHNhdmVkSG9hRG9uID0gaG9hRG9uREFPLnNhdmVIb2FEb24oaG9hRG9uKTtcbiAgICAgICAgICAgIGlmICghc2F2ZWRIb2FEb24pIHtcbiAgICAgICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCJGYWlsZWQgdG8gc2F2ZSBIb2FEb24hXCIpO1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oXCJLaMO0bmcgdGjhu4MgbMawdSBow7NhIMSRxqFuIVwiKTtcbiAgICAgICAgICAgIH1cbi4uLlxuXG4gICAgICAgICAgICBjaGlUaWV0SG9hRG9uLnNldFRoYW5oVGllbih0aGFuaFRpZW4pO1xuICAgICAgICAgICAgY2hpVGlldEhvYURvbi5zZXRUaWVuVGh1ZSh0aWVuVGh1ZSk7XG5cbiAgICAgICAgICAgIC8vIDUuIEzGsHUgY2hpIHRp4bq/dCBow7NhIMSRxqFuXG4gICAgICAgICAgICBib29sZWFuIHNhdmVkQ2hpVGlldCA9IGNoaVRpZXRIb2FEb25EQU8uc2F2ZShjaGlUaWV0SG9hRG9uKTtcbiAgICAgICAgICAgIGlmICghc2F2ZWRDaGlUaWV0KSB7XG4gICAgICAgICAgICAgICAgLy8gWMOzYSBow7NhIMSRxqFuIMSRw6MgdOG6oW8gbuG6v3Uga2jDtG5nIHRo4buDIGzGsHUgY2hpIHRp4bq/dFxuICAgICAgICAgICAgICAgIC8vIGhvYURvbkRBTy5kZWxldGUobWFIRCk7IC8vIEdp4bqjIMSR4buLbmggY8OzIHBoxrDGoW5nIHRo4bupYyBkZWxldGVcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKFwiS2jDtG5nIHRo4buDIGzGsHUgY2hpIHRp4bq/dCBow7NhIMSRxqFuIVwiKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwixJDDoyB0w6xtIHRo4bqleSBLaGFjaEhhbmc6IFwiICsga2hhY2hIYW5nLmdldE1hS2hhY2hIYW5nKCkpO1xuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiR2VuZXJhdGVkIE1hSEQ6IFwiICsgbWFIRCk7XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJOaGFuVmllbiBpbmZvOiBcIiArIG5oYW5WaWVuUGFuZWwuZ2V0Q2xhc3MoKS5nZXROYW1lKCkpO1xuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiRm91bmQgTG9haUhvYURvbjogXCIgKyBsb2FpSG9hRG9uLmdldE1hTG9haUhvYURvbigpKTtcbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIkhvYURvbiBzYXZlZCBzdWNjZXNzZnVsbHkhXCIpO1xuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiQ2hpVGlldEhvYURvbiBzYXZlZCBzdWNjZXNzZnVsbHkhXCIpO1xuXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcblxuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFwiRXJyb3IgaW4geHVMeVRoYW5oVG9hbjogXCIgKyBlLmdldE1lc3NhZ2UoKSk7XG4gICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IFJlbW90ZUV4Y2VwdGlvbihcIkzhu5dpIGtoaSB44butIGzDvSB0aGFuaCB0b8OhbjogXCIgKyBlLmdldE1lc3NhZ2UoKSwgZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIFN0cmluZyBnZW5lcmF0ZU1hSEQoKSB7XG4gICAgICAgIC8vIEZvcm1hdDogSEQgKyB5eXl5TU1kZCArIDQgc+G7kSByYW5kb21cbiAgICAgICAgU2ltcGxlRGF0ZUZvcm1hdCBzZGYgPSBuZXcgU2ltcGxlRGF0ZUZvcm1hdChcInl5eXlNTWRkXCIpO1xuICAgICAgICBTdHJpbmcgZGF0ZVBhcnQgPSBzZGYuZm9ybWF0KG5ldyBEYXRlKCkpO1xuICAgICAgICBTdHJpbmcgcmFuZG9tUGFydCA9IFN0cmluZy5mb3JtYXQoXCIlMDRkXCIsIG5ldyBSYW5kb20oKS5uZXh0SW50KDEwMDAwKSk7XG4gICAgICAgIHJldHVybiBcIkhEXCIgKyBkYXRlUGFydCArIHJhbmRvbVBhcnQ7XG4gICAgfVxufS4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9ndWlDbGllbnQvVGhhbmhUb2FuR1VJLmphdmFcbnBhY2thZ2UgZ3VpQ2xpZW50O1xuXG5pbXBvcnQgZGFvLio7XG5pbXBvcnQgZGFvLmltcGwuKjtcbmltcG9ydCBtb2RlbC4qO1xuXG5pbXBvcnQgamF2YXguc3dpbmcuKjtcbmltcG9ydCBqYXZheC5zd2luZy5ib3JkZXIuKjtcbmltcG9ydCBqYXZheC5zd2luZy50YWJsZS4qO1xuaW1wb3J0IGphdmEuYXd0Lio7XG5pbXBvcnQgamF2YS5hd3QuZXZlbnQuKjtcbmltcG9ydCBqYXZhLnJtaS5SZW1vdGVFeGNlcHRpb247XG5pbXBvcnQgamF2YS50ZXh0Lk51bWJlckZvcm1hdDtcbmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlO1xuaW1wb3J0IGphdmEudGltZS5mb3JtYXQuRGF0ZVRpbWVGb3JtYXR0ZXI7XG5pbXBvcnQgamF2YS51dGlsLio7XG5pbXBvcnQgamF2YS51dGlsLkxpc3Q7XG5cbi8qKlxuICogQ2hlY2tvdXQgaW50ZXJmYWNlIGZvciB0cmFpbiB0aWNrZXQgYm9va2luZyBzeXN0ZW1cbiAqIERpc3BsYXlzIHNlbGVjdGVkIHRpY2tldHMgYW5kIGNvbGxlY3RzIHBhc3NlbmdlciBpbmZvcm1hdGlvblxuICogQGF1dGhvciBsdW9uZ3RhbjIwNFxuICovXG5wdWJsaWMgY2xhc3MgVGhhbmhUb2FuR1VJIGV4dGVuZHMgSkZyYW1lIHtcbiAgICAvLyBNYWluIHBhbmVsc1xuICAgIHByaXZhdGUgSlBhbmVsIG1haW5QYW5lbDtcbiAgICBwcml2YXRlIEpUYWJsZSB0aWNrZXRUYWJsZTtcbiAgICBwcml2YXRlIERlZmF1bHRUYWJsZU1vZGVsIHRhYmxlTW9kZWw7XG5cbiAgICAvLyBGb3JtIGZpZWxkc1xuICAgIHByaXZhdGUgSlRleHRGaWVsZCBuYW1lRmllbGQ7XG4gICAgcHJpdmF0ZSBKVGV4dEZpZWxkIGlkQ2FyZEZpZWxkO1xuICAgIHByaXZhdGUgSlRleHRGaWVsZCBlbWFpbEZpZWxkO1xuICAgIHByaXZhdGUgSlRleHRGaWVsZCBjb25maXJtRW1haWxGaWVsZDtcbiAgICBwcml2YXRlIEpUZXh0RmllbGQgcGhvbmVGaWVsZDtcbiAgICBwcml2YXRlIEpDb21ib0JveDxLaHV5ZW5NYWk+IHByb21vdGlvbkNvbWJvQm94O1xuXG4gICAgLy8gU3RvcmUgdGhlIHNjaGVkdWxlIGRhdGUgZm9yIHByb21vdGlvbnNcbiAgICBwcml2YXRlIExvY2FsRGF0ZSBzY2hlZHVsZURhdGU7XG5cbiAgICAvLyBTdW1tYXJ5IGZpZWxkc1xuICAgIHByaXZhdGUgSkxhYmVsIHRvdGFsQW1vdW50TGFiZWw7XG4gICAgcHJpdmF0ZSBkb3VibGUgdG90YWxBbW91bnQgPSAwLjA7XG5cbiAgICAvLyBDb25maXJtYXRpb24gcGFuZWxcbiAgICBwcml2YXRlIEpUZXh0QXJlYSBjb25maXJtYXRpb25UZXh0QXJlYTtcblxuICAgIC8vIFBheW1lbnQgZmllbGRzXG4gICAgcHJpdmF0ZSBKVGV4dEZpZWxkIGFtb3VudFBhaWRGaWVsZDtcbiAgICBwcml2YXRlIEpMYWJlbCBjaGFuZ2VBbW91bnRMYWJlbDtcblxuICAgIC8vIERhdGFcbiAgICBwcml2YXRlIE1hcDxTdHJpbmcsIFN0cmluZz4gdGlja2V0c01hcDsgLy8gTWFwIG9mIHNlYXQgSURzIHRvIHNjaGVkdWxlIElEc1xuICAgIHByaXZhdGUgQ29sb3IgcHJpbWFyeUNvbG9yID0gbmV3IENvbG9yKDAsIDEzNiwgMjA0KTtcblxuICAgIC8vIEVtcGxveWVlIGluZm9ybWF0aW9uXG4gICAgcHJpdmF0ZSBOaGFuVmllbiBuaGFuVmllbjtcblxuICAgIC8vIERBT3NcbiAgICBwcml2YXRlIExpY2hUcmluaFRhdURBTyBsaWNoVHJpbmhUYXVEQU87XG4gICAgcHJpdmF0ZSBDaG9OZ29pREFPIGNob05nb2lEQU87XG4gICAgcHJpdmF0ZSBUb2FUYXVEQU8gdG9hVGF1REFPO1xuICAgIHByaXZhdGUgVGF1REFPIHRhdURBTztcbiAgICBwcml2YXRlIEtodXllbk1haURBTyBraHV5ZW5NYWlEQU87XG4gICAgcHJpdmF0ZSBLaGFjaEhhbmdEQU8ga2hhY2hIYW5nREFPO1xuICAgIHByaXZhdGUgZGFvLkxvYWlLaGFjaEhhbmdEQU8gbG9haUtoYWNoSGFuZ0RBTztcbiAgICBwcml2YXRlIFZlVGF1REFPIHZlVGF1REFPO1xuICAgIHByaXZhdGUgSG9hRG9uREFPIGhvYURvbkRBTztcbiAgICBwcml2YXRlIENoaVRpZXRIb2FEb25EQU8gY2hpVGlldEhvYURvbkRBTztcbiAgICBwcml2YXRlIExvYWlIb2FEb25EQU8gbG9haUhvYURvbkRBTztcblxuICAgIC8qKlxuICAgICAqIENvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHRpY2tldHNNYXAgTWFwIG9mIHNlYXQgSURzIHRvIHNjaGVkdWxlIElEc1xuICAgICAqIEBwYXJhbSBudiBUaGUgZW1wbG95ZWUgd2hvIGlzIHByb2Nlc3NpbmcgdGhlIHBheW1lbnRcbiAgICAgKi9cbiAgICBwdWJsaWMgVGhhbmhUb2FuR1VJKE1hcDxTdHJpbmcsIFN0cmluZz4gdGlja2V0c01hcCwgTmhhblZpZW4gbnYpIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xuICAgICAgICB0aGlzLnRpY2tldHNNYXAgPSB0aWNrZXRzTWFwO1xuICAgICAgICB0aGlzLm5oYW5WaWVuID0gbnY7XG5cbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBEQU9zXG4gICAgICAgIGxpY2hUcmluaFRhdURBTyA9IG5ldyBMaWNoVHJpbmhUYXVEQU9JbXBsKCk7XG4gICAgICAgIGNob05nb2lEQU8gPSBuZXcgQ2hvTmdvaURBT0ltcGwoKTtcbiAgICAgICAgdG9hVGF1REFPID0gbmV3IFRvYVRhdURBT0ltcGwoKTtcbiAgICAgICAgdGF1REFPID0gbmV3IFRhdURBT0ltcGwoKTtcbiAgICAgICAga2h1eWVuTWFpREFPID0gbmV3IEtodXllbk1haURBT0ltcGwoKTtcbiAgICAgICAga2hhY2hIYW5nREFPID0gbmV3IEtoYWNoSGFuZ0RBT0ltcGwoKTtcbiAgICAgICAgbG9haUtoYWNoSGFuZ0RBTyA9IG5ldyBMb2FpS2hhY2hIYW5nREFPSW1wbCgpO1xuXG4gICAgICAgIHNldFRpdGxlKFwiVGhhbmggdG/DoW4gdsOpIHTDoHVcIik7XG4gICAgICAgIHNldFNpemUoMTAwMCwgNzAwKTtcbiAgICAgICAgc2V0RGVmYXVsdENsb3NlT3BlcmF0aW9uKEpGcmFtZS5ESVNQT1NFX09OX0NMT1NFKTtcbiAgICAgICAgc2V0TG9jYXRpb25SZWxhdGl2ZVRvKG51bGwpO1xuXG4gICAgICAgIGluaXRDb21wb25lbnRzKCk7XG4gICAgICAgIGNhbGN1bGF0ZVRvdGFsKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZSBjb21wb25lbnRzXG4gICAgICovXG4gICAgcHJpdmF0ZSB2b2lkIGluaXRDb21wb25lbnRzKCkge1xuICAgICAgICAvLyBNYWluIGNvbnRhaW5lciB3aXRoIHBhZGRpbmdcbiAgICAgICAgbWFpblBhbmVsID0gbmV3IEpQYW5lbChuZXcgQm9yZGVyTGF5b3V0KDEwLCAxMCkpO1xuICAgICAgICBtYWluUGFuZWwuc2V0Qm9yZGVyKG5ldyBFbXB0eUJvcmRlcigxNSwgMTUsIDE1LCAxNSkpO1xuXG4gICAgICAgIC8vIFRpdGxlIHBhbmVsXG4gICAgICAgIEpQYW5lbCB0aXRsZVBhbmVsID0gY3JlYXRlVGl0bGVQYW5lbCgpO1xuICAgICAgICBtYWluUGFuZWwuYWRkKHRpdGxlUGFuZWwsIEJvcmRlckxheW91dC5OT1JUSCk7XG5cbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBwcm9tb3Rpb25Db21ib0JveCBiZWZvcmUgY3JlYXRpbmcgdGlja2V0cyB0YWJsZVxuICAgICAgICBwcm9tb3Rpb25Db21ib0JveCA9IG5ldyBKQ29tYm9Cb3g8PigpO1xuICAgICAgICBwcm9tb3Rpb25Db21ib0JveC5zZXRQcmVmZXJyZWRTaXplKG5ldyBEaW1lbnNpb24oMjAwLCAzMCkpO1xuXG4gICAgICAgIC8vIENlbnRlciBwYW5lbCBjb250YWluaW5nIHRpY2tldHMgdGFibGUgYW5kIGJvdHRvbSBjb250cm9sc1xuICAgICAgICBKUGFuZWwgY2VudGVyUGFuZWwgPSBuZXcgSlBhbmVsKG5ldyBCb3JkZXJMYXlvdXQoMCwgMTApKTtcbi4uLlxuXG4gICAgICAgIC8vIENyZWF0ZSBzb3V0aCBwYW5lbCBmb3IgY3VzdG9tZXIgaW5mbyBhbmQgcGF5bWVudCBidXR0b25cbiAgICAgICAgSlBhbmVsIHNvdXRoUGFuZWwgPSBuZXcgSlBhbmVsKG5ldyBCb3JkZXJMYXlvdXQoMCwgMTApKTtcblxuICAgICAgICAvLyBDdXN0b21lciBpbmZvcm1hdGlvbiBzZWN0aW9uXG4gICAgICAgIEpQYW5lbCBjdXN0b21lclBhbmVsID0gY3JlYXRlQ3VzdG9tZXJJbmZvUGFuZWwoKTtcbiAgICAgICAgc291dGhQYW5lbC5hZGQoY3VzdG9tZXJQYW5lbCwgQm9yZGVyTGF5b3V0Lk5PUlRIKTtcblxuICAgICAgICAvLyBQYXltZW50IGJ1dHRvblxuICAgICAgICBKUGFuZWwgcGF5bWVudFBhbmVsID0gbmV3IEpQYW5lbChuZXcgRmxvd0xheW91dChGbG93TGF5b3V0LlJJR0hUKSk7XG4gICAgICAgIEpCdXR0b24gcGF5QnV0dG9uID0gbmV3IEpCdXR0b24oXCJUaGFuaCB0b8OhblwiKTtcbiAgICAgICAgcGF5QnV0dG9uLnNldEJhY2tncm91bmQocHJpbWFyeUNvbG9yKTtcbiAgICAgICAgcGF5QnV0dG9uLnNldEZvcmVncm91bmQoQ29sb3IuV0hJVEUpO1xuICAgICAgICBwYXlCdXR0b24uc2V0Rm9udChuZXcgRm9udChcIkFyaWFsXCIsIEZvbnQuQk9MRCwgMTQpKTtcbiAgICAgICAgcGF5QnV0dG9uLnNldFByZWZlcnJlZFNpemUobmV3IERpbWVuc2lvbigxMjAsIDM1KSk7XG4gICAgICAgIHBheUJ1dHRvbi5hZGRBY3Rpb25MaXN0ZW5lcihlIC0+IHByb2Nlc3NQYXltZW50KCkpO1xuICAgICAgICBwYXltZW50UGFuZWwuYWRkKHBheUJ1dHRvbik7XG4gICAgICAgIHNvdXRoUGFuZWwuYWRkKHBheW1lbnRQYW5lbCwgQm9yZGVyTGF5b3V0LlNPVVRIKTtcbi4uLlxuXG4gICAgICAgICAgICAvLyBHZXQgdHJhaW4gaW5mb3JtYXRpb25cbiAgICAgICAgICAgIFRhdSB0YXUgPSB0YXVEQU8uZ2V0VGF1QnlMaWNoVHJpbmhUYXUobGljaFRyaW5oKTtcbiAgICAgICAgICAgIGlmICh0YXUgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihcIktow7RuZyB0w6xtIHRo4bqleSB0aMO0bmcgdGluIHTDoHUgY2hvIGzhu4tjaCB0csOsbmg6IFwiICsgc2NoZWR1bGVJZCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZXQgc2VhdCBuYW1lL251bWJlclxuICAgICAgICAgICAgU3RyaW5nIHNlYXROYW1lID0gY2hvTmdvaS5nZXRUZW5DaG8oKSAhPSBudWxsID8gY2hvTmdvaS5nZXRUZW5DaG8oKSA6IHNlYXRJZDtcblxuICAgICAgICAgICAgLy8gR2V0IHByaWNlIGJhc2VkIG9uIHNlYXQgY2xhc3MgYW5kIHJvdXRlXG4gICAgICAgICAgICBkb3VibGUgcHJpY2UgPSBnZXRTZWF0UHJpY2UoY2hvTmdvaSwgdG9hVGF1KTtcblxuICAgICAgICAgICAgLy8gR2V0IHJvdXRlIGluZm9ybWF0aW9uXG4gICAgICAgICAgICBTdHJpbmcgZnJvbSA9IGxpY2hUcmluaC5nZXRUYXUoKS5nZXRUdXllblRhdSgpLmdldEdhRGkoKTtcbiAgICAgICAgICAgIFN0cmluZyB0byA9IGxpY2hUcmluaC5nZXRUYXUoKS5nZXRUdXllblRhdSgpLmdldEdhRGVuKCk7XG5cbiAgICAgICAgICAgIC8vIEZvcm1hdCBkYXRlIGFuZCB0aW1lXG4gICAgICAgICAgICBTdHJpbmcgZGVwYXJ0RGF0ZSA9IGxpY2hUcmluaC5nZXROZ2F5RGkoKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKFwiZGQvTU0veXl5eVwiKSk7XG4gICAgICAgICAgICBTdHJpbmcgZGVwYXJ0VGltZSA9IGxpY2hUcmluaC5nZXRHaW9EaSgpLmZvcm1hdChEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oXCJISDptbVwiKSk7XG4uLi5cblxuICAgICAgICAgICAgcGFuZWwuYWRkKG5hbWVGaWVsZCk7XG4gICAgICAgICAgICBwYW5lbC5hZGQodHlwZUNvbWJvKTtcbiAgICAgICAgICAgIHBhbmVsLmFkZChpZEZpZWxkKTtcbiAgICAgICAgICAgIHBhbmVsLmFkZChhZ2VGaWVsZCk7XG5cbiAgICAgICAgICAgIHBhbmVsLnNldEJhY2tncm91bmQoQ29sb3IuV0hJVEUpO1xuXG4gICAgICAgICAgICAvLyBBZGQgYWN0aW9uIGxpc3RlbmVycyBmb3IgcHJlc3NpbmcgRW50ZXJcbiAgICAgICAgICAgIG5hbWVGaWVsZC5hZGRBY3Rpb25MaXN0ZW5lcihlIC0+IHVwZGF0ZUN1cnJlbnRJbmZvKCkpO1xuICAgICAgICAgICAgaWRGaWVsZC5hZGRBY3Rpb25MaXN0ZW5lcihlIC0+IHVwZGF0ZUN1cnJlbnRJbmZvKCkpO1xuICAgICAgICAgICAgYWdlRmllbGQuYWRkQWN0aW9uTGlzdGVuZXIoZSAtPiB1cGRhdGVDdXJyZW50SW5mbygpKTtcblxuICAgICAgICAgICAgLy8gQWRkIHR5cGUgY29tYm8gbGlzdGVuZXJcbiAgICAgICAgICAgIHR5cGVDb21iby5hZGRBY3Rpb25MaXN0ZW5lcihlIC0+IHtcbiAgICAgICAgICAgICAgICB1cGRhdGVDdXJyZW50SW5mbygpO1xuICAgICAgICAgICAgICAgIC8vIEVuYWJsZSBhZ2UgZmllbGQgb25seSBmb3IgY2hpbGRyZW5cbiAgICAgICAgICAgICAgICBhZ2VGaWVsZC5zZXRFbmFibGVkKFwiVHLhursgZW1cIi5lcXVhbHModHlwZUNvbWJvLmdldFNlbGVjdGVkSXRlbSgpKSk7XG5cbiAgICAgICAgICAgICAgICAvLyBSZWNhbGN1bGF0ZSB0b3RhbHMgd2hlbiBwYXNzZW5nZXIgdHlwZSBjaGFuZ2VzXG4gICAgICAgICAgICAgICAgaWYgKHRpY2tldFRhYmxlLmlzRWRpdGluZygpKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0b3BFZGl0aW5nKCk7XG4gICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZVRvdGFsKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4uLi5cblxuICAgICAgICBwcml2YXRlIHZvaWQgdXBkYXRlQ3VycmVudEluZm8oKSB7XG4gICAgICAgICAgICBjdXJyZW50SW5mby5uYW1lID0gbmFtZUZpZWxkLmdldFRleHQoKTtcbiAgICAgICAgICAgIGN1cnJlbnRJbmZvLmlkTnVtYmVyID0gaWRGaWVsZC5nZXRUZXh0KCk7XG4gICAgICAgICAgICBjdXJyZW50SW5mby5wYXNzZW5nZXJUeXBlID0gKFN0cmluZykgdHlwZUNvbWJvLmdldFNlbGVjdGVkSXRlbSgpO1xuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRJbmZvLmFnZSA9IGFnZUZpZWxkLmdldFRleHQoKS5pc0VtcHR5KCkgPyAwIDogSW50ZWdlci5wYXJzZUludChhZ2VGaWVsZC5nZXRUZXh0KCkpO1xuICAgICAgICAgICAgfSBjYXRjaCAoTnVtYmVyRm9ybWF0RXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50SW5mby5hZ2UgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4uLi5cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgZG91YmxlIGFtb3VudFBhaWQgPSBEb3VibGUucGFyc2VEb3VibGUoYW1vdW50UGFpZEZpZWxkLmdldFRleHQoKS50cmltKCkucmVwbGFjZShcIixcIiwgXCJcIikpO1xuICAgICAgICAgICAgaWYgKGFtb3VudFBhaWQgPCB0b3RhbEFtb3VudCkge1xuICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiU+G7kSB0aeG7gW4ga2jDoWNoIMSRxrBhIGtow7RuZyDEkeG7pyDEkeG7gyB0aGFuaCB0b8OhblwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgYW1vdW50UGFpZEZpZWxkLnJlcXVlc3RGb2N1cygpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoTnVtYmVyRm9ybWF0RXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBcIlPhu5EgdGnhu4FuIGtow6FjaCDEkcawYSBraMO0bmcgaOG7o3AgbOG7h1wiLFxuICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsXG4gICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0VcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBhbW91bnRQYWlkRmllbGQucmVxdWVzdEZvY3VzKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTaG93IHBheW1lbnQgb3B0aW9ucyBkaWFsb2dcbiAgICAgICAgU3RyaW5nW10gb3B0aW9ucyA9IHtcIlRp4buBbiBt4bq3dFwiLCBcIlRo4bq7IHTDrW4gZOG7pW5nXCIsIFwiQ2h1eeG7g24ga2hv4bqjblwiLCBcIlbDrSDEkWnhu4duIHThu61cIn07XG4gICAgICAgIGludCBjaG9pY2UgPSBKT3B0aW9uUGFuZS5zaG93T3B0aW9uRGlhbG9nKFxuICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgXCJDaOG7jW4gcGjGsMahbmcgdGjhu6ljIHRoYW5oIHRvw6FuXCIsXG4gICAgICAgICAgICAgICAgXCJUaGFuaCB0b8OhblwiLFxuICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLkRFRkFVTFRfT1BUSU9OLFxuICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLlFVRVNUSU9OX01FU1NBR0UsXG4gICAgICAgICAgICAgICAgbnVsbCxcbiAgICAgICAgICAgICAgICBvcHRpb25zLFxuICAgICAgICAgICAgICAgIG9wdGlvbnNbMF1cbiAgICAgICAgKTtcblxuICAgICAgICAvLyBQcm9jZXNzIGJhc2VkIG9uIHNlbGVjdGVkIHBheW1lbnQgbWV0aG9kXG4gICAgICAgIGlmIChjaG9pY2UgPj0gMCkge1xuICAgICAgICAgICAgLy8gU2hvdyBwcm9jZXNzaW5nIG1lc3NhZ2VcbiAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBcIsSQYW5nIHjhu60gbMO9IHRoYW5oIHRvw6FuLi4uXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiVGhhbmggdG/DoW5cIixcbiAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBHZXQgY3VzdG9tZXIgaW5mb3JtYXRpb24gZnJvbSBmb3JtXG4gICAgICAgICAgICAgICAgU3RyaW5nIGN1c3RvbWVyTmFtZSA9IG5hbWVGaWVsZC5nZXRUZXh0KCkudHJpbSgpO1xuICAgICAgICAgICAgICAgIFN0cmluZyBpZENhcmQgPSBpZENhcmRGaWVsZC5nZXRUZXh0KCkudHJpbSgpO1xuICAgICAgICAgICAgICAgIFN0cmluZyBwaG9uZSA9IHBob25lRmllbGQuZ2V0VGV4dCgpLnRyaW0oKTtcbiAgICAgICAgICAgICAgICBTdHJpbmcgZW1haWwgPSBlbWFpbEZpZWxkLmdldFRleHQoKS50cmltKCk7IC8vIFRoaXMgaXMgdGhlIGFkZHJlc3MgZmllbGQgYXMgcGVyIHJlcXVpcmVtZW50c1xuXG4gICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgY3VzdG9tZXIgZXhpc3RzIGJ5IElEIGNhcmQgYW5kIHBob25lIG51bWJlclxuICAgICAgICAgICAgICAgIEtoYWNoSGFuZyBleGlzdGluZ0N1c3RvbWVyID0ga2hhY2hIYW5nREFPLmZpbmRCeUlkQ2FyZEFuZFBob25lKGlkQ2FyZCwgcGhvbmUpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nQ3VzdG9tZXIgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBDdXN0b21lciBleGlzdHNcbiAgICAgICAgICAgICAgICAgICAgaWYgKFwiVklQXCIuZXF1YWxzSWdub3JlQ2FzZShleGlzdGluZ0N1c3RvbWVyLmdldEhhbmdUaGFuaFZpZW4oKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEN1c3RvbWVyIGlzIFZJUCwgYWRkIGxveWFsdHkgcG9pbnRzICgxIHBvaW50IHBlciAxMCwwMDApXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnQgcG9pbnRzVG9BZGQgPSAoaW50KSAodG90YWxBbW91bnQgLyAxMDAwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBleGlzdGluZ0N1c3RvbWVyLnNldERpZW1UaWNoTHV5KGV4aXN0aW5nQ3VzdG9tZXIuZ2V0RGllbVRpY2hMdXkoKSArIHBvaW50c1RvQWRkKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIGN1c3RvbWVyIGluIGRhdGFiYXNlXG4gICAgICAgICAgICAgICAgICAgICAgICBraGFjaEhhbmdEQU8udXBkYXRlKGV4aXN0aW5nQ3VzdG9tZXIpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJLaMOhY2ggaMOgbmcgVklQIMSRw6MgxJHGsOG7o2MgY+G7mW5nIFwiICsgcG9pbnRzVG9BZGQgKyBcIiDEkWnhu4NtIHTDrWNoIGzFqXkuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiVGjDtG5nIGLDoW9cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRVxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEN1c3RvbWVyIGV4aXN0cyBidXQgaXMgbm90IFZJUCwgZG9uJ3QgYWRkIHBvaW50c1xuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiS2jDoWNoIGjDoG5nIGtow7RuZyBwaOG6o2kgVklQLCBraMO0bmcgxJHGsOG7o2MgY+G7mW5nIMSRaeG7g20gdMOtY2ggbMWpeS5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJUaMO0bmcgYsOhb1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5JTkZPUk1BVElPTl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQ3VzdG9tZXIgZG9lc24ndCBleGlzdCwgY3JlYXRlIG5ldyBjdXN0b21lclxuICAgICAgICAgICAgICAgICAgICBLaGFjaEhhbmcgbmV3Q3VzdG9tZXIgPSBuZXcgS2hhY2hIYW5nKCk7XG4gICAgICAgICAgICAgICAgICAgIG5ld0N1c3RvbWVyLnNldFRlbktoYWNoSGFuZyhjdXN0b21lck5hbWUpO1xuICAgICAgICAgICAgICAgICAgICBuZXdDdXN0b21lci5zZXRHaWF5VG8oaWRDYXJkKTtcbiAgICAgICAgICAgICAgICAgICAgbmV3Q3VzdG9tZXIuc2V0U29EaWVuVGhvYWkocGhvbmUpO1xuICAgICAgICAgICAgICAgICAgICBuZXdDdXN0b21lci5zZXREaWFDaGkoZW1haWwpOyAvLyBFbWFpbCBhZGRyZXNzIGFzIHBlciByZXF1aXJlbWVudHNcbiAgICAgICAgICAgICAgICAgICAgbmV3Q3VzdG9tZXIuc2V0SGFuZ1RoYW5oVmllbihcIlbDo25nIGxhaVwiKTsgLy8gRGVmYXVsdCBtZW1iZXIgcmFua1xuICAgICAgICAgICAgICAgICAgICBuZXdDdXN0b21lci5zZXREaWVtVGljaEx1eSgwLjApOyAvLyBJbml0aWFsIGxveWFsdHkgcG9pbnRzXG4gICAgICAgICAgICAgICAgICAgIG5ld0N1c3RvbWVyLnNldE5nYXlTaW5oKExvY2FsRGF0ZS5ub3coKSk7IC8vIERlZmF1bHQgYmlydGggZGF0ZSwgc2hvdWxkIGJlIHVwZGF0ZWQgbGF0ZXJcbiAgICAgICAgICAgICAgICAgICAgbmV3Q3VzdG9tZXIuc2V0TmdheVRoYW1nR2lhKExvY2FsRGF0ZS5ub3coKSk7IC8vIEpvaW4gZGF0ZSBpcyB0b2RheVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIEdldCBhIGRlZmF1bHQgY3VzdG9tZXIgdHlwZVxuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gR2V0IGFsbCBjdXN0b21lciB0eXBlc1xuICAgICAgICAgICAgICAgICAgICAgICAgTGlzdDxMb2FpS2hhY2hIYW5nPiB0eXBlcyA9IGxvYWlLaGFjaEhhbmdEQU8uZ2V0QWxsKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRyeSB0byBmaW5kIGEgZGVmYXVsdCBjdXN0b21lciB0eXBlIChhc3N1bWluZyBcIlRoxrDhu51uZ1wiIGlzIHRoZSBkZWZhdWx0IHR5cGUpXG4gICAgICAgICAgICAgICAgICAgICAgICBMb2FpS2hhY2hIYW5nIGRlZmF1bHRUeXBlID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoTG9haUtoYWNoSGFuZyB0eXBlIDogdHlwZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoXCJUaMaw4budbmdcIi5lcXVhbHModHlwZS5nZXRUZW5Mb2FpS2hhY2hIYW5nKCkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRUeXBlID0gdHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBcIlRoxrDhu51uZ1wiIHR5cGUgZG9lc24ndCBleGlzdCwgdXNlIHRoZSBmaXJzdCBhdmFpbGFibGUgdHlwZVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRlZmF1bHRUeXBlID09IG51bGwgJiYgIXR5cGVzLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRUeXBlID0gdHlwZXMuZ2V0KDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGVmYXVsdFR5cGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0N1c3RvbWVyLnNldExvYWlLaGFjaEhhbmcoZGVmYXVsdFR5cGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKFwiS2jDtG5nIHTDrG0gdGjhuqV5IGxv4bqhaSBraMOhY2ggaMOgbmcgbsOgbyB0cm9uZyBjxqEgc+G7nyBk4buvIGxp4buHdVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpIGtoaSB0w6xtIGxv4bqhaSBraMOhY2ggaMOgbmc6IFwiICsgZS5nZXRNZXNzYWdlKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2lcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRVxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZCBuZXcgY3VzdG9tZXIgdG8gZGF0YWJhc2VcbiAgICAgICAgICAgICAgICAgICAga2hhY2hIYW5nREFPLmFkZChuZXdDdXN0b21lcik7XG5cbiAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIsSQw6MgdGjDqm0ga2jDoWNoIGjDoG5nIG3hu5tpIHbDoG8gY8ahIHPhu58gZOG7ryBsaeG7h3UuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJUaMO0bmcgYsOhb1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLklORk9STUFUSU9OX01FU1NBR0VcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgY2hhbmdlIGZvciBjYXNoIHBheW1lbnRcbiAgICAgICAgICAgICAgICBTdHJpbmcgY2hhbmdlTWVzc2FnZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGNob2ljZSA9PSAwKSB7IC8vIENhc2ggcGF5bWVudFxuICAgICAgICAgICAgICAgICAgICBkb3VibGUgYW1vdW50UGFpZCA9IERvdWJsZS5wYXJzZURvdWJsZShhbW91bnRQYWlkRmllbGQuZ2V0VGV4dCgpLnRyaW0oKS5yZXBsYWNlKFwiLFwiLCBcIlwiKSk7XG4gICAgICAgICAgICAgICAgICAgIGRvdWJsZSBjaGFuZ2UgPSBhbW91bnRQYWlkIC0gdG90YWxBbW91bnQ7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGFuZ2UgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VNZXNzYWdlID0gXCJcXG5UaeG7gW4gdGjhu5FpIGzhuqFpOiBcIiArIGZvcm1hdEN1cnJlbmN5KGNoYW5nZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBTaG93IHN1Y2Nlc3MgbWVzc2FnZVxuICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiVGhhbmggdG/DoW4gdGjDoG5oIGPDtG5nISBWw6kgY+G7p2EgYuG6oW4gxJHDoyDEkcaw4bujYyDEkeG6t3QuXCIgKyBjaGFuZ2VNZXNzYWdlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJUaMOgbmggY8O0bmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLklORk9STUFUSU9OX01FU1NBR0VcbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgLy8gQ2xvc2UgY2hlY2tvdXQgd2luZG93XG4gICAgICAgICAgICAgICAgZGlzcG9zZSgpO1xuXG4gICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2kga2hpIHjhu60gbMO9IHRoYW5oIHRvw6FuOiBcIiArIGUuZ2V0TWVzc2FnZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9ndWlDbGllbnQvVHJhVmVQYW5lbC5qYXZhXG4uLi5cblxuICAgICAgICAgICAgLy8gVOG6oW8gaMOzYSDEkcahbiBt4bubaVxuICAgICAgICAgICAgSG9hRG9uIGhvYURvbiA9IG5ldyBIb2FEb24oKTtcblxuICAgICAgICAgICAgLy8gU2luaCBtw6MgaMOzYSDEkcahbiB0aGVvIMSR4buLbmggZOG6oW5nIEhEIHl5eXkvTU0vZGQgWFhYWFxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBTdHJpbmcgbWFIb2FEb24gPSBob2FEb25EQU8uZ2VuZXJhdGVNYUhvYURvbihMb2NhbERhdGUubm93KCkpO1xuICAgICAgICAgICAgICAgIGhvYURvbi5zZXRNYUhEKG1hSG9hRG9uKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgICAgICAvLyBO4bq/dSBjw7MgbOG7l2ksIHThuqFvIG3DoyBow7NhIMSRxqFuIHRo4bunIGPDtG5nIHbhu5tpIHRpbWVzdGFtcFxuICAgICAgICAgICAgICAgIFN0cmluZyBtYUhvYURvbiA9IFwiSERcIiArIExvY2FsRGF0ZS5ub3coKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKFwieXl5eU1NZGRcIikpICtcbiAgICAgICAgICAgICAgICAgICAgICAgICBTeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKSAlIDEwMDAwO1xuICAgICAgICAgICAgICAgIGhvYURvbi5zZXRNYUhEKG1hSG9hRG9uKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gVGhp4bq/dCBs4bqtcCBjw6FjIHRow7RuZyB0aW4gaMOzYSDEkcahblxuICAgICAgICAgICAgaG9hRG9uLnNldE5nYXlMYXAoTG9jYWxEYXRlVGltZS5ub3coKSk7XG4gICAgICAgICAgICBob2FEb24uc2V0VGllbkdpYW0oMCk7IC8vIEtow7RuZyBjw7MgZ2nhuqNtIGdpw6Ega2hpIHRy4bqjIHbDqVxuICAgICAgICAgICAgaG9hRG9uLnNldFRvbmdUaWVuKHRpZW5UcmFMYWkpOyAvLyBU4buVbmcgdGnhu4FuIGzDoCBz4buRIHRp4buBbiB0cuG6oyBs4bqhaSBraMOhY2hcbiAgICAgICAgICAgIGhvYURvbi5zZXRLaGFjaEhhbmcoa2hhY2hIYW5nKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXROdihuaGFuVmllbik7IC8vIE5ow6JuIHZpw6puIMSRYW5nIMSRxINuZyBuaOG6rXBcblxuICAgICAgICAgICAgLy8gVGhp4bq/dCBs4bqtcCBsb+G6oWkgaMOzYSDEkcahbiBsw6AgXCLEkMOjIHRy4bqjXCIgKExIRDAwMilcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgTG9haUhvYURvbiBsb2FpSG9hRG9uID0gaG9hRG9uREFPLmdldExvYWlIb2FEb25CeUlkKFwiTEhEMDAyXCIpO1xuICAgICAgICAgICAgICAgIGlmIChsb2FpSG9hRG9uID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFeGNlcHRpb24oXCJLaMO0bmcgdMOsbSB0aOG6pXkgbG/huqFpIGjDs2EgxJHGoW4gTEhEMDAyXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBob2FEb24uc2V0TG9haUhvYURvbihsb2FpSG9hRG9uKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUnVudGltZUV4Y2VwdGlvbihcIkzhu5dpIGtoaSBs4bqleSB0aMO0bmcgdGluIGxv4bqhaSBow7NhIMSRxqFuOiBcIiArIGUuZ2V0TWVzc2FnZSgpKTtcbiAgICAgICAgICAgIH1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9kYW8vaW1wbC9Ib2FEb25EQU9JbXBsLmphdmFcbi4uLlxuXG4gICAgQE92ZXJyaWRlXG4gICAgLy8gQ3JlYXRlOiBUaMOqbSBow7NhIMSRxqFuIG3hu5tpXG4gICAgcHVibGljIGJvb2xlYW4gc2F2ZUhvYURvbihIb2FEb24gaG9hRG9uKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uIHtcbiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IEpQQVV0aWwuZ2V0RW50aXR5TWFuYWdlcigpO1xuICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0ciA9IGVtLmdldFRyYW5zYWN0aW9uKCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0ci5iZWdpbigpO1xuXG4gICAgICAgICAgICAvLyBLaeG7g20gdHJhIHhlbSBtw6MgaMOzYSDEkcahbiDEkcOjIMSRxrDhu6NjIHRoaeG6v3QgbOG6rXAgY2jGsGFcbiAgICAgICAgICAgIGlmIChob2FEb24uZ2V0TWFIRCgpID09IG51bGwgfHwgaG9hRG9uLmdldE1hSEQoKS5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgICAgICAvLyBO4bq/dSBjaMawYSBjw7MgbcOjIGjDs2EgxJHGoW4sIHThu7EgxJHhu5luZyBzaW5oIG3Do1xuICAgICAgICAgICAgICAgIFN0cmluZyBtYUhEID0gZ2VuZXJhdGVNYUhvYURvbihcbiAgICAgICAgICAgICAgICAgICAgICAgIGhvYURvbi5nZXROZ2F5TGFwKCkgIT0gbnVsbCA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvYURvbi5nZXROZ2F5TGFwKCkudG9Mb2NhbERhdGUoKSA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIExvY2FsRGF0ZS5ub3coKVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgaG9hRG9uLnNldE1hSEQobWFIRCk7XG4gICAgICAgICAgIC4uLiIsImlzX2Vycm9yIjpmYWxzZSwicmVxdWVzdF9pZCI6IiIsInRvb2xfdXNlX2lkIjoidG9vbHVfMDFIMURGTkRqNEFoUFdURW9YTXpRRXd0In19LHsiaWQiOjIsInR5cGUiOjQsImlkZV9zdGF0ZV9ub2RlIjp7IndvcmtzcGFjZUZvbGRlcnMiOlt7InJlcG9zaXRvcnlSb290IjoiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmciLCJmb2xkZXJSb290IjoiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcifV0sIndvcmtzcGFjZUZvbGRlcnNVbmNoYW5nZWQiOmZhbHNlfX1dLCJyZXNwb25zZV90ZXh0IjoiQmFzZWQgb24gdGhlIGNvZGUgSSd2ZSByZXZpZXdlZCwgSSBjYW4gc2VlIHRoZSBpc3N1ZS4gTGV0IG1lIGNoZWNrIG9uZSBtb3JlIHRoaW5nIHRvIGNvbmZpcm0gbXkgdW5kZXJzdGFuZGluZzpcbiIsIndvcmtzcGFjZV9maWxlX2NodW5rcyI6W119LHsic3RhdHVzIjoic3VjY2VzcyIsInJlcXVlc3RfaWQiOiI3ZjZkMDU4ZC0xOTM3LTRkNTMtOTc5My04MDVhNWY5MzkwNjUiLCJyZXF1ZXN0X21lc3NhZ2UiOiIiLCJzdHJ1Y3R1cmVkX291dHB1dF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjUsImNvbnRlbnQiOiIiLCJ0b29sX3VzZSI6eyJ0b29sX3VzZV9pZCI6InRvb2x1XzAxOW1XRW83bTRIQjE1cXdFRm1xakI3aiIsInRvb2xfbmFtZSI6InN0ci1yZXBsYWNlLWVkaXRvciIsImlucHV0X2pzb24iOiJ7XCJjb21tYW5kXCI6IFwidmlld1wiLCBcInBhdGhcIjogXCJQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9UaGFuaFRvYW5HVUkuamF2YVwiLCBcInZpZXdfcmFuZ2VcIjogWzEsIDEwMF19In19LHsiaWQiOjAsInR5cGUiOjAsImNvbnRlbnQiOiJCYXNlZCBvbiBteSBhbmFseXNpcyBvZiB0aGUgY29kZSwgSSd2ZSBpZGVudGlmaWVkIHRoZSBpc3N1ZS4gVGhlIHByb2JsZW0gaXMgaW4gdGhlIGBUaGFuaFRvYW5HVUkuamF2YWAgZmlsZS4gVGhlIGVycm9yIG9jY3VycyBiZWNhdXNlIHRoZSBjb2RlIGlzIHRyeWluZyB0byBzYXZlIGEgYEhvYURvbmAgb2JqZWN0IHdpdGggYSByZWZlcmVuY2UgdG8gYSBgTmhhblZpZW5gIG9iamVjdCB0aGF0IGhhc24ndCBiZWVuIHNhdmVkIHRvIHRoZSBkYXRhYmFzZSB5ZXQgKGl0J3MgXCJ0cmFuc2llbnRcIikuXG5cbkxldCBtZSBmaXggdGhlIGlzc3VlIGJ5IG1vZGlmeWluZyB0aGUgYHByb2Nlc3NQYXltZW50YCBtZXRob2QgaW4gYFRoYW5oVG9hbkdVSS5qYXZhYCB0byBwcm9wZXJseSBjcmVhdGUgYW5kIHNhdmUgdGhlIGBIb2FEb25gIG9iamVjdCB3aXRoIHRoZSBgTmhhblZpZW5gIHJlZmVyZW5jZTpcbiJ9LHsiaWQiOjIsInR5cGUiOjIsImNvbnRlbnQiOiIifSx7ImlkIjozLCJ0eXBlIjozLCJjb250ZW50IjoiIn1dLCJzZWVuX3N0YXRlIjoic2VlbiIsInN0cnVjdHVyZWRfcmVxdWVzdF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjEsInRvb2xfcmVzdWx0X25vZGUiOnsiY29udGVudCI6IlRoZSBmb2xsb3dpbmcgY29kZSBzZWN0aW9ucyB3ZXJlIHJldHJpZXZlZDpcblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZ3VpQ2xpZW50L1RyYWluVGlja2V0Qm9va2luZ1N5c3RlbS5qYXZhXG4uLi5cbiAgICAgICAgY2hlY2tvdXRCdXR0b24uYWRkQWN0aW9uTGlzdGVuZXIoZSAtPiB7XG4gICAgICAgICAgICBpZiAoY2FydEl0ZW1zLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICAgICAgVHJhaW5UaWNrZXRCb29raW5nU3lzdGVtLnRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkdp4buPIHbDqSB0cuG7kW5nLiBWdWkgbMOybmcgY2jhu41uIHbDqSB0csaw4bubYyBraGkgdGhhbmggdG/DoW4uXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIlRow7RuZyBiw6FvXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5JTkZPUk1BVElPTl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIENyZWF0ZSBhIG1hcCBvZiBzZWF0IElEcyB0byBzY2hlZHVsZSBJRHNcbiAgICAgICAgICAgIE1hcDxTdHJpbmcsIFN0cmluZz4gdGlja2V0c1RvQ2hlY2tvdXQgPSBuZXcgSGFzaE1hcDw+KCk7XG4gICAgICAgICAgICBmb3IgKFRpY2tldEl0ZW0gaXRlbSA6IGNhcnRJdGVtcykge1xuICAgICAgICAgICAgICAgIHRpY2tldHNUb0NoZWNrb3V0LnB1dChpdGVtLnNlYXRJZCwgY3VycmVudE1hTGljaCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIE9wZW4gY2hlY2tvdXQgc2NyZWVuIHdpdGggb25seSB0aGUgbmVjZXNzYXJ5IGlkZW50aWZpZXJzXG4gICAgICAgICAgICBUaGFuaFRvYW5HVUkgY2hlY2tvdXRTY3JlZW4gPSBudWxsO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjaGVja291dFNjcmVlbiA9IG5ldyBUaGFuaFRvYW5HVUkodGlja2V0c1RvQ2hlY2tvdXQpO1xuICAgICAgICAgICAgfSBjYXRjaCAoUmVtb3RlRXhjZXB0aW9uIGV4KSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFeGNlcHRpb24oZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2hlY2tvdXRTY3JlZW4uc2V0VmlzaWJsZSh0cnVlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIE9wZW4gY2hlY2tvdXQgc2NyZWVuXG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZ3VpQ2xpZW50L0RvaVZlUGFuZWwuamF2YVxuLi4uXG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCLEkMOjIHTDrG0gdGjhuqV5IEtoYWNoSGFuZzogXCIgKyBraGFjaEhhbmcuZ2V0TWFLaGFjaEhhbmcoKSk7XG5cbiAgICAgICAgICAgIC8vIDIuIFThuqFvIGjDs2EgxJHGoW4gbeG7m2lcbiAgICAgICAgICAgIEhvYURvbiBob2FEb24gPSBuZXcgSG9hRG9uKCk7XG4gICAgICAgICAgICBTdHJpbmcgbWFIRCA9IGdlbmVyYXRlTWFIRCgpO1xuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiR2VuZXJhdGVkIE1hSEQ6IFwiICsgbWFIRCk7XG4gICAgICAgICAgICBob2FEb24uc2V0TWFIRChtYUhEKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXROZ2F5TGFwKExvY2FsRGF0ZVRpbWUubm93KCkpO1xuICAgICAgICAgICAgaG9hRG9uLnNldFRpZW5HaWFtKGdpYVZlQmFuRGF1IC0gdmVUYXVIaWVuVGFpLmdldEdpYVZlKCkpO1xuICAgICAgICAgICAgaG9hRG9uLnNldFRvbmdUaWVuKHZlVGF1SGllblRhaS5nZXRHaWFWZSgpKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXRLaGFjaEhhbmcoa2hhY2hIYW5nKTtcblxuICAgICAgICAgICAgLy8gRGVidWdnaW5nIHRoZSBOaGFuVmllbiByZWZlcmVuY2VcbiAgICAgICAgICAgIGlmIChuaGFuVmllblBhbmVsID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCJFUlJPUjogbmhhblZpZW5QYW5lbCBpcyBudWxsXCIpO1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oXCJUaGnhur91IHRow7RuZyB0aW4gbmjDom4gdmnDqm4hXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiTmhhblZpZW4gaW5mbzogXCIgKyBuaGFuVmllblBhbmVsLmdldENsYXNzKCkuZ2V0TmFtZSgpKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXROdihuaGFuVmllblBhbmVsKTtcblxuICAgICAgICAgICAgLy8gR2V0IExvYWlIb2FEb24gYW5kIHZlcmlmeSBpdCBleGlzdHNcbiAgICAgICAgICAgIExvYWlIb2FEb24gbG9haUhvYURvbiA9IGxvYWlIb2FEb25EQU8uZmluZEJ5SWQoXCJMSEQwMDFcIik7XG4gICAgICAgICAgICBpZiAobG9haUhvYURvbiA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFwiRVJST1I6IEtow7RuZyB0w6xtIHRo4bqleSBsb+G6oWkgaMOzYSDEkcahbiBMSEQwMDFcIik7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbihcIktow7RuZyB0w6xtIHRo4bqleSBsb+G6oWkgaMOzYSDEkcahbiFcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJGb3VuZCBMb2FpSG9hRG9uOiBcIiArIGxvYWlIb2FEb24uZ2V0TWFMb2FpSG9hRG9uKCkpO1xuICAgICAgICAgICAgaG9hRG9uLnNldExvYWlIb2FEb24obG9haUhvYURvbik7XG5cbiAgICAgICAgICAgIC8vIDMuIEzGsHUgaMOzYSDEkcahblxuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiQXR0ZW1wdGluZyB0byBzYXZlIEhvYURvbi4uLlwiKTtcbiAgICAgICAgICAgIGJvb2xlYW4gc2F2ZWRIb2FEb24gPSBob2FEb25EQU8uc2F2ZUhvYURvbihob2FEb24pO1xuICAgICAgICAgICAgaWYgKCFzYXZlZEhvYURvbikge1xuICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihcIkZhaWxlZCB0byBzYXZlIEhvYURvbiFcIik7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbihcIktow7RuZyB0aOG7gyBsxrB1IGjDs2EgxJHGoW4hXCIpO1xuICAgICAgICAgICAgfVxuLi4uXG5cbiAgICAgICAgICAgIGNoaVRpZXRIb2FEb24uc2V0VGhhbmhUaWVuKHRoYW5oVGllbik7XG4gICAgICAgICAgICBjaGlUaWV0SG9hRG9uLnNldFRpZW5UaHVlKHRpZW5UaHVlKTtcblxuICAgICAgICAgICAgLy8gNS4gTMawdSBjaGkgdGnhur90IGjDs2EgxJHGoW5cbiAgICAgICAgICAgIGJvb2xlYW4gc2F2ZWRDaGlUaWV0ID0gY2hpVGlldEhvYURvbkRBTy5zYXZlKGNoaVRpZXRIb2FEb24pO1xuICAgICAgICAgICAgaWYgKCFzYXZlZENoaVRpZXQpIHtcbiAgICAgICAgICAgICAgICAvLyBYw7NhIGjDs2EgxJHGoW4gxJHDoyB04bqhbyBu4bq/dSBraMO0bmcgdGjhu4MgbMawdSBjaGkgdGnhur90XG4gICAgICAgICAgICAgICAgLy8gaG9hRG9uREFPLmRlbGV0ZShtYUhEKTsgLy8gR2nhuqMgxJHhu4tuaCBjw7MgcGjGsMahbmcgdGjhu6ljIGRlbGV0ZVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oXCJLaMO0bmcgdGjhu4MgbMawdSBjaGkgdGnhur90IGjDs2EgxJHGoW4hXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCLEkMOjIHTDrG0gdGjhuqV5IEtoYWNoSGFuZzogXCIgKyBraGFjaEhhbmcuZ2V0TWFLaGFjaEhhbmcoKSk7XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJHZW5lcmF0ZWQgTWFIRDogXCIgKyBtYUhEKTtcbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIk5oYW5WaWVuIGluZm86IFwiICsgbmhhblZpZW5QYW5lbC5nZXRDbGFzcygpLmdldE5hbWUoKSk7XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJGb3VuZCBMb2FpSG9hRG9uOiBcIiArIGxvYWlIb2FEb24uZ2V0TWFMb2FpSG9hRG9uKCkpO1xuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiSG9hRG9uIHNhdmVkIHN1Y2Nlc3NmdWxseSFcIik7XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJDaGlUaWV0SG9hRG9uIHNhdmVkIHN1Y2Nlc3NmdWxseSFcIik7XG5cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9UaGFuaFRvYW5HVUkuamF2YVxuLi4uXG5cbiAgICAvLyBQYXltZW50IGZpZWxkc1xuICAgIHByaXZhdGUgSlRleHRGaWVsZCBhbW91bnRQYWlkRmllbGQ7XG4gICAgcHJpdmF0ZSBKTGFiZWwgY2hhbmdlQW1vdW50TGFiZWw7XG5cbiAgICAvLyBEYXRhXG4gICAgcHJpdmF0ZSBNYXA8U3RyaW5nLCBTdHJpbmc+IHRpY2tldHNNYXA7IC8vIE1hcCBvZiBzZWF0IElEcyB0byBzY2hlZHVsZSBJRHNcbiAgICBwcml2YXRlIENvbG9yIHByaW1hcnlDb2xvciA9IG5ldyBDb2xvcigwLCAxMzYsIDIwNCk7XG5cbiAgICAvLyBFbXBsb3llZSBpbmZvcm1hdGlvblxuICAgIHByaXZhdGUgTmhhblZpZW4gbmhhblZpZW47XG5cbiAgICAvLyBEQU9zXG4gICAgcHJpdmF0ZSBMaWNoVHJpbmhUYXVEQU8gbGljaFRyaW5oVGF1REFPO1xuICAgIHByaXZhdGUgQ2hvTmdvaURBTyBjaG9OZ29pREFPO1xuICAgIHByaXZhdGUgVG9hVGF1REFPIHRvYVRhdURBTztcbiAgICBwcml2YXRlIFRhdURBTyB0YXVEQU87XG4gICAgcHJpdmF0ZSBLaHV5ZW5NYWlEQU8ga2h1eWVuTWFpREFPO1xuICAgIHByaXZhdGUgS2hhY2hIYW5nREFPIGtoYWNoSGFuZ0RBTztcbiAgICBwcml2YXRlIGRhby5Mb2FpS2hhY2hIYW5nREFPIGxvYWlLaGFjaEhhbmdEQU87XG4gICAgcHJpdmF0ZSBWZVRhdURBTyB2ZVRhdURBTztcbiAgICBwcml2YXRlIEhvYURvbkRBTyBob2FEb25EQU87XG4gICAgcHJpdmF0ZSBDaGlUaWV0SG9hRG9uREFPIGNoaVRpZXRIb2FEb25EQU87XG4gICAgcHJpdmF0ZSBMb2FpSG9hRG9uREFPIGxvYWlIb2FEb25EQU87XG5cbiAgICAvKipcbiAgICAgKiBDb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB0aWNrZXRzTWFwIE1hcCBvZiBzZWF0IElEcyB0byBzY2hlZHVsZSBJRHNcbiAgICAgKiBAcGFyYW0gbnYgVGhlIGVtcGxveWVlIHdobyBpcyBwcm9jZXNzaW5nIHRoZSBwYXltZW50XG4gICAgICovXG4gICAgcHVibGljIFRoYW5oVG9hbkdVSShNYXA8U3RyaW5nLCBTdHJpbmc+IHRpY2tldHNNYXAsIE5oYW5WaWVuIG52KSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uIHtcbiAgICAgICAgdGhpcy50aWNrZXRzTWFwID0gdGlja2V0c01hcDtcbiAgICAgICAgdGhpcy5uaGFuVmllbiA9IG52O1xuXG4gICAgICAgIC8vIEluaXRpYWxpemUgREFPc1xuICAgICAgICBsaWNoVHJpbmhUYXVEQU8gPSBuZXcgTGljaFRyaW5oVGF1REFPSW1wbCgpO1xuICAgICAgICBjaG9OZ29pREFPID0gbmV3IENob05nb2lEQU9JbXBsKCk7XG4gICAgICAgIHRvYVRhdURBTyA9IG5ldyBUb2FUYXVEQU9JbXBsKCk7XG4gICAgICAgIHRhdURBTyA9IG5ldyBUYXVEQU9JbXBsKCk7XG4gICAgICAgIGtodXllbk1haURBTyA9IG5ldyBLaHV5ZW5NYWlEQU9JbXBsKCk7XG4gICAgICAgIGtoYWNoSGFuZ0RBTyA9IG5ldyBLaGFjaEhhbmdEQU9JbXBsKCk7XG4gICAgICAgIGxvYWlLaGFjaEhhbmdEQU8gPSBuZXcgTG9haUtoYWNoSGFuZ0RBT0ltcGwoKTtcblxuICAgICAgICBzZXRUaXRsZShcIlRoYW5oIHRvw6FuIHbDqSB0w6B1XCIpO1xuICAgICAgICBzZXRTaXplKDEwMDAsIDcwMCk7XG4gICAgICAgIHNldERlZmF1bHRDbG9zZU9wZXJhdGlvbihKRnJhbWUuRElTUE9TRV9PTl9DTE9TRSk7XG4gICAgICAgIHNldExvY2F0aW9uUmVsYXRpdmVUbyhudWxsKTtcblxuICAgICAgICBpbml0Q29tcG9uZW50cygpO1xuICAgICAgICBjYWxjdWxhdGVUb3RhbCgpO1xuICAgIH1cbi4uLlxuXG4gICAgICAgIC8vIENyZWF0ZSBzb3V0aCBwYW5lbCBmb3IgY3VzdG9tZXIgaW5mbyBhbmQgcGF5bWVudCBidXR0b25cbiAgICAgICAgSlBhbmVsIHNvdXRoUGFuZWwgPSBuZXcgSlBhbmVsKG5ldyBCb3JkZXJMYXlvdXQoMCwgMTApKTtcblxuICAgICAgICAvLyBDdXN0b21lciBpbmZvcm1hdGlvbiBzZWN0aW9uXG4gICAgICAgIEpQYW5lbCBjdXN0b21lclBhbmVsID0gY3JlYXRlQ3VzdG9tZXJJbmZvUGFuZWwoKTtcbiAgICAgICAgc291dGhQYW5lbC5hZGQoY3VzdG9tZXJQYW5lbCwgQm9yZGVyTGF5b3V0Lk5PUlRIKTtcblxuICAgICAgICAvLyBQYXltZW50IGJ1dHRvblxuICAgICAgICBKUGFuZWwgcGF5bWVudFBhbmVsID0gbmV3IEpQYW5lbChuZXcgRmxvd0xheW91dChGbG93TGF5b3V0LlJJR0hUKSk7XG4gICAgICAgIEpCdXR0b24gcGF5QnV0dG9uID0gbmV3IEpCdXR0b24oXCJUaGFuaCB0b8OhblwiKTtcbiAgICAgICAgcGF5QnV0dG9uLnNldEJhY2tncm91bmQocHJpbWFyeUNvbG9yKTtcbiAgICAgICAgcGF5QnV0dG9uLnNldEZvcmVncm91bmQoQ29sb3IuV0hJVEUpO1xuICAgICAgICBwYXlCdXR0b24uc2V0Rm9udChuZXcgRm9udChcIkFyaWFsXCIsIEZvbnQuQk9MRCwgMTQpKTtcbiAgICAgICAgcGF5QnV0dG9uLnNldFByZWZlcnJlZFNpemUobmV3IERpbWVuc2lvbigxMjAsIDM1KSk7XG4gICAgICAgIHBheUJ1dHRvbi5hZGRBY3Rpb25MaXN0ZW5lcihlIC0+IHByb2Nlc3NQYXltZW50KCkpO1xuICAgICAgICBwYXltZW50UGFuZWwuYWRkKHBheUJ1dHRvbik7XG4gICAgICAgIHNvdXRoUGFuZWwuYWRkKHBheW1lbnRQYW5lbCwgQm9yZGVyTGF5b3V0LlNPVVRIKTtcbi4uLlxuXG4gICAgICAgIC8vIEFkZCB0YWJsZSBkYXRhIGZvciBlYWNoIHRpY2tldFxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgZm9yIChNYXAuRW50cnk8U3RyaW5nLCBTdHJpbmc+IGVudHJ5IDogdGlja2V0c01hcC5lbnRyeVNldCgpKSB7XG4gICAgICAgICAgICAgICAgU3RyaW5nIHNlYXRJZCA9IGVudHJ5LmdldEtleSgpO1xuICAgICAgICAgICAgICAgIFN0cmluZyBsaWNoVHJpbmhJZCA9IGVudHJ5LmdldFZhbHVlKCk7XG5cbiAgICAgICAgICAgICAgICAvLyBHZXQgdGlja2V0IGluZm9ybWF0aW9uIGZyb20gZGF0YWJhc2UgdXNpbmcgREFPc1xuICAgICAgICAgICAgICAgIGFkZFRpY2tldFRvVGFibGUoc2VhdElkLCBsaWNoVHJpbmhJZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgXCJM4buXaSBraGkgdOG6o2kgdGjDtG5nIHRpbiB2w6k6IFwiICsgZS5nZXRNZXNzYWdlKCksXG4gICAgICAgICAgICAgICAgICAgIFwiTOG7l2lcIixcbiAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgIH1cbi4uLlxuXG4gICAgLyoqXG4gICAgICogQWRkIGEgdGlja2V0IHRvIHRoZSB0YWJsZSB1c2luZyBzZWF0SWQgYW5kIHNjaGVkdWxlSWRcbiAgICAgKi9cbiAgICBwcml2YXRlIHZvaWQgYWRkVGlja2V0VG9UYWJsZShTdHJpbmcgc2VhdElkLCBTdHJpbmcgc2NoZWR1bGVJZCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IHNlYXQgaW5mb3JtYXRpb25cbiAgICAgICAgICAgIENob05nb2kgY2hvTmdvaSA9IGNob05nb2lEQU8uZ2V0QnlJZChzZWF0SWQpO1xuICAgICAgICAgICAgaWYgKGNob05nb2kgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihcIktow7RuZyB0w6xtIHRo4bqleSB0aMO0bmcgdGluIGdo4bq/OiBcIiArIHNlYXRJZCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZXQgc2NoZWR1bGUgaW5mb3JtYXRpb25cbiAgICAgICAgICAgIExpY2hUcmluaFRhdSBsaWNoVHJpbmggPSBsaWNoVHJpbmhUYXVEQU8uZ2V0QnlJZChzY2hlZHVsZUlkKTtcbiAgICAgICAgICAgIGlmIChsaWNoVHJpbmggPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihcIktow7RuZyB0w6xtIHRo4bqleSB0aMO0bmcgdGluIGzhu4tjaCB0csOsbmg6IFwiICsgc2NoZWR1bGVJZCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZXQgdG9hIGluZm9ybWF0aW9uIChmcm9tIHNlYXQncyB0b2FJZClcbiAgICAgICAgICAgIFN0cmluZyB0b2FJZCA9IGNob05nb2kuZ2V0VG9hVGF1KCkuZ2V0TWFUb2EoKTtcbiAgICAgICAgICAgIFRvYVRhdSB0b2FUYXUgPSB0b2FUYXVEQU8uZ2V0VG9hVGF1QnlJZCh0b2FJZCk7XG4gICAgICAgICAgICBpZiAodG9hVGF1ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCJLaMO0bmcgdMOsbSB0aOG6pXkgdGjDtG5nIHRpbiB0b2E6IFwiICsgdG9hSWQpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2V0IHRyYWluIGluZm9ybWF0aW9uXG4gICAgICAgICAgICBUYXUgdGF1ID0gdGF1REFPLmdldFRhdUJ5TGljaFRyaW5oVGF1KGxpY2hUcmluaCk7XG4gICAgICAgICAgICBpZiAodGF1ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCJLaMO0bmcgdMOsbSB0aOG6pXkgdGjDtG5nIHRpbiB0w6B1IGNobyBs4buLY2ggdHLDrG5oOiBcIiArIHNjaGVkdWxlSWQpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2V0IHNlYXQgbmFtZS9udW1iZXJcbiAgICAgICAgICAgIFN0cmluZyBzZWF0TmFtZSA9IGNob05nb2kuZ2V0VGVuQ2hvKCkgIT0gbnVsbCA/IGNob05nb2kuZ2V0VGVuQ2hvKCkgOiBzZWF0SWQ7XG5cbiAgICAgICAgICAgIC8vIEdldCBwcmljZSBiYXNlZCBvbiBzZWF0IGNsYXNzIGFuZCByb3V0ZVxuICAgICAgICAgICAgZG91YmxlIHByaWNlID0gZ2V0U2VhdFByaWNlKGNob05nb2ksIHRvYVRhdSk7XG5cbiAgICAgICAgICAgIC8vIEdldCByb3V0ZSBpbmZvcm1hdGlvblxuICAgICAgICAgICAgU3RyaW5nIGZyb20gPSBsaWNoVHJpbmguZ2V0VGF1KCkuZ2V0VHV5ZW5UYXUoKS5nZXRHYURpKCk7XG4gICAgICAgICAgICBTdHJpbmcgdG8gPSBsaWNoVHJpbmguZ2V0VGF1KCkuZ2V0VHV5ZW5UYXUoKS5nZXRHYURlbigpO1xuXG4gICAgICAgICAgICAvLyBGb3JtYXQgZGF0ZSBhbmQgdGltZVxuICAgICAgICAgICAgU3RyaW5nIGRlcGFydERhdGUgPSBsaWNoVHJpbmguZ2V0TmdheURpKCkuZm9ybWF0KERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybihcImRkL01NL3l5eXlcIikpO1xuICAgICAgICAgICAgU3RyaW5nIGRlcGFydFRpbWUgPSBsaWNoVHJpbmguZ2V0R2lvRGkoKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKFwiSEg6bW1cIikpO1xuLi4uXG5cbiAgICAgICAgICAgIC8vIEZvcm1hdCBwcmljZVxuICAgICAgICAgICAgU3RyaW5nIHByaWNlU3RyID0gZm9ybWF0Q3VycmVuY3kocHJpY2UpO1xuXG4gICAgICAgICAgICAvLyBWQVQgY2FsY3VsYXRpb24gKGZpeGVkIGF0IDEwJSlcbiAgICAgICAgICAgIFN0cmluZyB2YXRTdHIgPSBcIjEwJVwiO1xuXG4gICAgICAgICAgICAvLyBQYXNzZW5nZXIgdHlwZSBkaXNjb3VudCAoZW1wdHkgZm9yIG5vdylcbiAgICAgICAgICAgIFN0cmluZyBwcm9tb3Rpb24gPSBcIlwiO1xuXG4gICAgICAgICAgICAvLyBQcm9tb3Rpb24gZGlzY291bnQgKGVtcHR5IGZvciBub3cpXG4gICAgICAgICAgICBTdHJpbmcgcHJvbW90aW9uRGlzY291bnRTdHIgPSBcIjBcIjtcblxuICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIHRvdGFsIChwcmljZSArIFZBVClcbiAgICAgICAgICAgIGRvdWJsZSB0b3RhbEZvclRpY2tldCA9IHByaWNlICsgKHByaWNlICogMC4xKTtcbiAgICAgICAgICAgIFN0cmluZyB0b3RhbFN0ciA9IGZvcm1hdEN1cnJlbmN5KHRvdGFsRm9yVGlja2V0KTtcblxuICAgICAgICAgICAgLy8gQ3JlYXRlIHBhc3NlbmdlciBpbmZvIGNvbXBvbmVudCAtIHdpbGwgYmUgcmVwbGFjZWQgYnkgdGhlIGN1c3RvbSByZW5kZXJlclxuICAgICAgICAgICAgUGFzc2VuZ2VySW5mbyBwYXNzZW5nZXJJbmZvID0gbmV3IFBhc3NlbmdlckluZm8oKTtcblxuICAgICAgICAgICAgLy8gQWRkIHJvdyB0byB0YWJsZVxuICAgICAgICAgICAgdGFibGVNb2RlbC5hZGRSb3cobmV3IE9iamVjdFtdIHtcbiAgICAgICAgICAgICAgICAgICAgcGFzc2VuZ2VySW5mbywgc2VhdEluZm8sIHByaWNlU3RyLCB2YXRTdHIsXG4gICAgICAgICAgICAgICAgICAgIHByb21vdGlvbiwgcHJvbW90aW9uRGlzY291bnRTdHIsIHRvdGFsU3RyLCBcIlhcIlxuICAgICAgICAgICAgfSk7XG4uLi5cblxuICAgICAgICAgICAgLy8gUGFyc2UgYW1vdW50IHBhaWQgKHJlbW92ZSBjb21tYXMgaWYgcHJlc2VudClcbiAgICAgICAgICAgIGRvdWJsZSBhbW91bnRQYWlkID0gRG91YmxlLnBhcnNlRG91YmxlKGFtb3VudFBhaWRTdHIucmVwbGFjZShcIixcIiwgXCJcIikpO1xuXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgY2hhbmdlXG4gICAgICAgICAgICBkb3VibGUgY2hhbmdlID0gYW1vdW50UGFpZCAtIHRvdGFsQW1vdW50O1xuXG4gICAgICAgICAgICAvLyBVcGRhdGUgY2hhbmdlIGFtb3VudCBsYWJlbFxuICAgICAgICAgICAgaWYgKGNoYW5nZSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgY2hhbmdlQW1vdW50TGFiZWwuc2V0VGV4dChmb3JtYXRDdXJyZW5jeShjaGFuZ2UpKTtcbiAgICAgICAgICAgICAgICBjaGFuZ2VBbW91bnRMYWJlbC5zZXRGb3JlZ3JvdW5kKG5ldyBDb2xvcigwLCAxMjgsIDApKTsgLy8gR3JlZW4gZm9yIHBvc2l0aXZlIGNoYW5nZVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjaGFuZ2VBbW91bnRMYWJlbC5zZXRUZXh0KFwiVGhp4bq/dTogXCIgKyBmb3JtYXRDdXJyZW5jeShNYXRoLmFicyhjaGFuZ2UpKSk7XG4gICAgICAgICAgICAgICAgY2hhbmdlQW1vdW50TGFiZWwuc2V0Rm9yZWdyb3VuZChDb2xvci5SRUQpOyAvLyBSZWQgZm9yIG5lZ2F0aXZlIGNoYW5nZSAoaW5zdWZmaWNpZW50IHBheW1lbnQpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKE51bWJlckZvcm1hdEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICAvLyBJbnZhbGlkIGlucHV0LCBzZXQgY2hhbmdlIHRvIDBcbiAgICAgICAgICAgIGNoYW5nZUFtb3VudExhYmVsLnNldFRleHQoXCJOaOG6rXAga2jDtG5nIGjhu6NwIGzhu4dcIik7XG4gICAgICAgICAgICBjaGFuZ2VBbW91bnRMYWJlbC5zZXRGb3JlZ3JvdW5kKENvbG9yLlJFRCk7XG4gICAgICAgIH1cbiAgICB9XG4uLi5cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgZG91YmxlIGFtb3VudFBhaWQgPSBEb3VibGUucGFyc2VEb3VibGUoYW1vdW50UGFpZEZpZWxkLmdldFRleHQoKS50cmltKCkucmVwbGFjZShcIixcIiwgXCJcIikpO1xuICAgICAgICAgICAgaWYgKGFtb3VudFBhaWQgPCB0b3RhbEFtb3VudCkge1xuICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiU+G7kSB0aeG7gW4ga2jDoWNoIMSRxrBhIGtow7RuZyDEkeG7pyDEkeG7gyB0aGFuaCB0b8OhblwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgYW1vdW50UGFpZEZpZWxkLnJlcXVlc3RGb2N1cygpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoTnVtYmVyRm9ybWF0RXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBcIlPhu5EgdGnhu4FuIGtow6FjaCDEkcawYSBraMO0bmcgaOG7o3AgbOG7h1wiLFxuICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsXG4gICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0VcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBhbW91bnRQYWlkRmllbGQucmVxdWVzdEZvY3VzKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTaG93IHBheW1lbnQgb3B0aW9ucyBkaWFsb2dcbiAgICAgICAgU3RyaW5nW10gb3B0aW9ucyA9IHtcIlRp4buBbiBt4bq3dFwiLCBcIlRo4bq7IHTDrW4gZOG7pW5nXCIsIFwiQ2h1eeG7g24ga2hv4bqjblwiLCBcIlbDrSDEkWnhu4duIHThu61cIn07XG4gICAgICAgIGludCBjaG9pY2UgPSBKT3B0aW9uUGFuZS5zaG93T3B0aW9uRGlhbG9nKFxuICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgXCJDaOG7jW4gcGjGsMahbmcgdGjhu6ljIHRoYW5oIHRvw6FuXCIsXG4gICAgICAgICAgICAgICAgXCJUaGFuaCB0b8OhblwiLFxuICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLkRFRkFVTFRfT1BUSU9OLFxuICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLlFVRVNUSU9OX01FU1NBR0UsXG4gICAgICAgICAgICAgICAgbnVsbCxcbiAgICAgICAgICAgICAgICBvcHRpb25zLFxuICAgICAgICAgICAgICAgIG9wdGlvbnNbMF1cbiAgICAgICAgKTtcblxuICAgICAgICAvLyBQcm9jZXNzIGJhc2VkIG9uIHNlbGVjdGVkIHBheW1lbnQgbWV0aG9kXG4gICAgICAgIGlmIChjaG9pY2UgPj0gMCkge1xuICAgICAgICAgICAgLy8gU2hvdyBwcm9jZXNzaW5nIG1lc3NhZ2VcbiAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBcIsSQYW5nIHjhu60gbMO9IHRoYW5oIHRvw6FuLi4uXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiVGhhbmggdG/DoW5cIixcbiAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBHZXQgY3VzdG9tZXIgaW5mb3JtYXRpb24gZnJvbSBmb3JtXG4gICAgICAgICAgICAgICAgU3RyaW5nIGN1c3RvbWVyTmFtZSA9IG5hbWVGaWVsZC5nZXRUZXh0KCkudHJpbSgpO1xuICAgICAgICAgICAgICAgIFN0cmluZyBpZENhcmQgPSBpZENhcmRGaWVsZC5nZXRUZXh0KCkudHJpbSgpO1xuICAgICAgICAgICAgICAgIFN0cmluZyBwaG9uZSA9IHBob25lRmllbGQuZ2V0VGV4dCgpLnRyaW0oKTtcbiAgICAgICAgICAgICAgICBTdHJpbmcgZW1haWwgPSBlbWFpbEZpZWxkLmdldFRleHQoKS50cmltKCk7IC8vIFRoaXMgaXMgdGhlIGFkZHJlc3MgZmllbGQgYXMgcGVyIHJlcXVpcmVtZW50c1xuXG4gICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgY3VzdG9tZXIgZXhpc3RzIGJ5IElEIGNhcmQgYW5kIHBob25lIG51bWJlclxuICAgICAgICAgICAgICAgIEtoYWNoSGFuZyBleGlzdGluZ0N1c3RvbWVyID0ga2hhY2hIYW5nREFPLmZpbmRCeUlkQ2FyZEFuZFBob25lKGlkQ2FyZCwgcGhvbmUpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nQ3VzdG9tZXIgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBDdXN0b21lciBleGlzdHNcbiAgICAgICAgICAgICAgICAgICAgaWYgKFwiVklQXCIuZXF1YWxzSWdub3JlQ2FzZShleGlzdGluZ0N1c3RvbWVyLmdldEhhbmdUaGFuaFZpZW4oKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEN1c3RvbWVyIGlzIFZJUCwgYWRkIGxveWFsdHkgcG9pbnRzICgxIHBvaW50IHBlciAxMCwwMDApXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnQgcG9pbnRzVG9BZGQgPSAoaW50KSAodG90YWxBbW91bnQgLyAxMDAwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBleGlzdGluZ0N1c3RvbWVyLnNldERpZW1UaWNoTHV5KGV4aXN0aW5nQ3VzdG9tZXIuZ2V0RGllbVRpY2hMdXkoKSArIHBvaW50c1RvQWRkKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIGN1c3RvbWVyIGluIGRhdGFiYXNlXG4gICAgICAgICAgICAgICAgICAgICAgICBraGFjaEhhbmdEQU8udXBkYXRlKGV4aXN0aW5nQ3VzdG9tZXIpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJLaMOhY2ggaMOgbmcgVklQIMSRw6MgxJHGsOG7o2MgY+G7mW5nIFwiICsgcG9pbnRzVG9BZGQgKyBcIiDEkWnhu4NtIHTDrWNoIGzFqXkuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiVGjDtG5nIGLDoW9cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRVxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEN1c3RvbWVyIGV4aXN0cyBidXQgaXMgbm90IFZJUCwgZG9uJ3QgYWRkIHBvaW50c1xuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiS2jDoWNoIGjDoG5nIGtow7RuZyBwaOG6o2kgVklQLCBraMO0bmcgxJHGsOG7o2MgY+G7mW5nIMSRaeG7g20gdMOtY2ggbMWpeS5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJUaMO0bmcgYsOhb1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5JTkZPUk1BVElPTl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQ3VzdG9tZXIgZG9lc24ndCBleGlzdCwgY3JlYXRlIG5ldyBjdXN0b21lclxuICAgICAgICAgICAgICAgICAgICBLaGFjaEhhbmcgbmV3Q3VzdG9tZXIgPSBuZXcgS2hhY2hIYW5nKCk7XG4gICAgICAgICAgICAgICAgICAgIG5ld0N1c3RvbWVyLnNldFRlbktoYWNoSGFuZyhjdXN0b21lck5hbWUpO1xuICAgICAgICAgICAgICAgICAgICBuZXdDdXN0b21lci5zZXRHaWF5VG8oaWRDYXJkKTtcbiAgICAgICAgICAgICAgICAgICAgbmV3Q3VzdG9tZXIuc2V0U29EaWVuVGhvYWkocGhvbmUpO1xuICAgICAgICAgICAgICAgICAgICBuZXdDdXN0b21lci5zZXREaWFDaGkoZW1haWwpOyAvLyBFbWFpbCBhZGRyZXNzIGFzIHBlciByZXF1aXJlbWVudHNcbiAgICAgICAgICAgICAgICAgICAgbmV3Q3VzdG9tZXIuc2V0SGFuZ1RoYW5oVmllbihcIlbDo25nIGxhaVwiKTsgLy8gRGVmYXVsdCBtZW1iZXIgcmFua1xuICAgICAgICAgICAgICAgICAgICBuZXdDdXN0b21lci5zZXREaWVtVGljaEx1eSgwLjApOyAvLyBJbml0aWFsIGxveWFsdHkgcG9pbnRzXG4gICAgICAgICAgICAgICAgICAgIG5ld0N1c3RvbWVyLnNldE5nYXlTaW5oKExvY2FsRGF0ZS5ub3coKSk7IC8vIERlZmF1bHQgYmlydGggZGF0ZSwgc2hvdWxkIGJlIHVwZGF0ZWQgbGF0ZXJcbiAgICAgICAgICAgICAgICAgICAgbmV3Q3VzdG9tZXIuc2V0TmdheVRoYW1nR2lhKExvY2FsRGF0ZS5ub3coKSk7IC8vIEpvaW4gZGF0ZSBpcyB0b2RheVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIEdldCBhIGRlZmF1bHQgY3VzdG9tZXIgdHlwZVxuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gR2V0IGFsbCBjdXN0b21lciB0eXBlc1xuICAgICAgICAgICAgICAgICAgICAgICAgTGlzdDxMb2FpS2hhY2hIYW5nPiB0eXBlcyA9IGxvYWlLaGFjaEhhbmdEQU8uZ2V0QWxsKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRyeSB0byBmaW5kIGEgZGVmYXVsdCBjdXN0b21lciB0eXBlIChhc3N1bWluZyBcIlRoxrDhu51uZ1wiIGlzIHRoZSBkZWZhdWx0IHR5cGUpXG4gICAgICAgICAgICAgICAgICAgICAgICBMb2FpS2hhY2hIYW5nIGRlZmF1bHRUeXBlID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoTG9haUtoYWNoSGFuZyB0eXBlIDogdHlwZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoXCJUaMaw4budbmdcIi5lcXVhbHModHlwZS5nZXRUZW5Mb2FpS2hhY2hIYW5nKCkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRUeXBlID0gdHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBcIlRoxrDhu51uZ1wiIHR5cGUgZG9lc24ndCBleGlzdCwgdXNlIHRoZSBmaXJzdCBhdmFpbGFibGUgdHlwZVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRlZmF1bHRUeXBlID09IG51bGwgJiYgIXR5cGVzLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRUeXBlID0gdHlwZXMuZ2V0KDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGVmYXVsdFR5cGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0N1c3RvbWVyLnNldExvYWlLaGFjaEhhbmcoZGVmYXVsdFR5cGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKFwiS2jDtG5nIHTDrG0gdGjhuqV5IGxv4bqhaSBraMOhY2ggaMOgbmcgbsOgbyB0cm9uZyBjxqEgc+G7nyBk4buvIGxp4buHdVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpIGtoaSB0w6xtIGxv4bqhaSBraMOhY2ggaMOgbmc6IFwiICsgZS5nZXRNZXNzYWdlKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2lcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRVxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZCBuZXcgY3VzdG9tZXIgdG8gZGF0YWJhc2VcbiAgICAgICAgICAgICAgICAgICAga2hhY2hIYW5nREFPLmFkZChuZXdDdXN0b21lcik7XG5cbiAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIsSQw6MgdGjDqm0ga2jDoWNoIGjDoG5nIG3hu5tpIHbDoG8gY8ahIHPhu58gZOG7ryBsaeG7h3UuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJUaMO0bmcgYsOhb1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLklORk9STUFUSU9OX01FU1NBR0VcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgY2hhbmdlIGZvciBjYXNoIHBheW1lbnRcbiAgICAgICAgICAgICAgICBTdHJpbmcgY2hhbmdlTWVzc2FnZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGNob2ljZSA9PSAwKSB7IC8vIENhc2ggcGF5bWVudFxuICAgICAgICAgICAgICAgICAgICBkb3VibGUgYW1vdW50UGFpZCA9IERvdWJsZS5wYXJzZURvdWJsZShhbW91bnRQYWlkRmllbGQuZ2V0VGV4dCgpLnRyaW0oKS5yZXBsYWNlKFwiLFwiLCBcIlwiKSk7XG4gICAgICAgICAgICAgICAgICAgIGRvdWJsZSBjaGFuZ2UgPSBhbW91bnRQYWlkIC0gdG90YWxBbW91bnQ7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGFuZ2UgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VNZXNzYWdlID0gXCJcXG5UaeG7gW4gdGjhu5FpIGzhuqFpOiBcIiArIGZvcm1hdEN1cnJlbmN5KGNoYW5nZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBTaG93IHN1Y2Nlc3MgbWVzc2FnZVxuICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiVGhhbmggdG/DoW4gdGjDoG5oIGPDtG5nISBWw6kgY+G7p2EgYuG6oW4gxJHDoyDEkcaw4bujYyDEkeG6t3QuXCIgKyBjaGFuZ2VNZXNzYWdlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJUaMOgbmggY8O0bmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLklORk9STUFUSU9OX01FU1NBR0VcbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgLy8gQ2xvc2UgY2hlY2tvdXQgd2luZG93XG4gICAgICAgICAgICAgICAgZGlzcG9zZSgpO1xuXG4gICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2kga2hpIHjhu60gbMO9IHRoYW5oIHRvw6FuOiBcIiArIGUuZ2V0TWVzc2FnZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9ndWlDbGllbnQvVHJhVmVQYW5lbC5qYXZhXG4uLi5cblxuICAgICAgICAgICAgLy8gVOG6oW8gaMOzYSDEkcahbiBt4bubaVxuICAgICAgICAgICAgSG9hRG9uIGhvYURvbiA9IG5ldyBIb2FEb24oKTtcblxuICAgICAgICAgICAgLy8gU2luaCBtw6MgaMOzYSDEkcahbiB0aGVvIMSR4buLbmggZOG6oW5nIEhEIHl5eXkvTU0vZGQgWFhYWFxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBTdHJpbmcgbWFIb2FEb24gPSBob2FEb25EQU8uZ2VuZXJhdGVNYUhvYURvbihMb2NhbERhdGUubm93KCkpO1xuICAgICAgICAgICAgICAgIGhvYURvbi5zZXRNYUhEKG1hSG9hRG9uKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgICAgICAvLyBO4bq/dSBjw7MgbOG7l2ksIHThuqFvIG3DoyBow7NhIMSRxqFuIHRo4bunIGPDtG5nIHbhu5tpIHRpbWVzdGFtcFxuICAgICAgICAgICAgICAgIFN0cmluZyBtYUhvYURvbiA9IFwiSERcIiArIExvY2FsRGF0ZS5ub3coKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKFwieXl5eU1NZGRcIikpICtcbiAgICAgICAgICAgICAgICAgICAgICAgICBTeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKSAlIDEwMDAwO1xuICAgICAgICAgICAgICAgIGhvYURvbi5zZXRNYUhEKG1hSG9hRG9uKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gVGhp4bq/dCBs4bqtcCBjw6FjIHRow7RuZyB0aW4gaMOzYSDEkcahblxuICAgICAgICAgICAgaG9hRG9uLnNldE5nYXlMYXAoTG9jYWxEYXRlVGltZS5ub3coKSk7XG4gICAgICAgICAgICBob2FEb24uc2V0VGllbkdpYW0oMCk7IC8vIEtow7RuZyBjw7MgZ2nhuqNtIGdpw6Ega2hpIHRy4bqjIHbDqVxuICAgICAgICAgICAgaG9hRG9uLnNldFRvbmdUaWVuKHRpZW5UcmFMYWkpOyAvLyBU4buVbmcgdGnhu4FuIGzDoCBz4buRIHRp4buBbiB0cuG6oyBs4bqhaSBraMOhY2hcbiAgICAgICAgICAgIGhvYURvbi5zZXRLaGFjaEhhbmcoa2hhY2hIYW5nKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXROdihuaGFuVmllbik7IC8vIE5ow6JuIHZpw6puIMSRYW5nIMSRxINuZyBuaOG6rXBcblxuICAgICAgICAgICAgLy8gVGhp4bq/dCBs4bqtcCBsb+G6oWkgaMOzYSDEkcahbiBsw6AgXCLEkMOjIHRy4bqjXCIgKExIRDAwMilcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgTG9haUhvYURvbiBsb2FpSG9hRG9uID0gaG9hRG9uREFPLmdldExvYWlIb2FEb25CeUlkKFwiTEhEMDAyXCIpO1xuICAgICAgICAgICAgICAgIGlmIChsb2FpSG9hRG9uID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFeGNlcHRpb24oXCJLaMO0bmcgdMOsbSB0aOG6pXkgbG/huqFpIGjDs2EgxJHGoW4gTEhEMDAyXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBob2FEb24uc2V0TG9haUhvYURvbihsb2FpSG9hRG9uKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUnVudGltZUV4Y2VwdGlvbihcIkzhu5dpIGtoaSBs4bqleSB0aMO0bmcgdGluIGxv4bqhaSBow7NhIMSRxqFuOiBcIiArIGUuZ2UuLi4iLCJpc19lcnJvciI6ZmFsc2UsInJlcXVlc3RfaWQiOiIiLCJ0b29sX3VzZV9pZCI6InRvb2x1XzAxR1p4YkNXaHU1clF1ZUZ3QkdOcXRaYyJ9fSx7ImlkIjoyLCJ0eXBlIjo0LCJpZGVfc3RhdGVfbm9kZSI6eyJ3b3Jrc3BhY2VGb2xkZXJzIjpbeyJyZXBvc2l0b3J5Um9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIiwiZm9sZGVyUm9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIn1dLCJ3b3Jrc3BhY2VGb2xkZXJzVW5jaGFuZ2VkIjpmYWxzZX19XSwicmVzcG9uc2VfdGV4dCI6IkJhc2VkIG9uIG15IGFuYWx5c2lzIG9mIHRoZSBjb2RlLCBJJ3ZlIGlkZW50aWZpZWQgdGhlIGlzc3VlLiBUaGUgcHJvYmxlbSBpcyBpbiB0aGUgYFRoYW5oVG9hbkdVSS5qYXZhYCBmaWxlLiBUaGUgZXJyb3Igb2NjdXJzIGJlY2F1c2UgdGhlIGNvZGUgaXMgdHJ5aW5nIHRvIHNhdmUgYSBgSG9hRG9uYCBvYmplY3Qgd2l0aCBhIHJlZmVyZW5jZSB0byBhIGBOaGFuVmllbmAgb2JqZWN0IHRoYXQgaGFzbid0IGJlZW4gc2F2ZWQgdG8gdGhlIGRhdGFiYXNlIHlldCAoaXQncyBcInRyYW5zaWVudFwiKS5cblxuTGV0IG1lIGZpeCB0aGUgaXNzdWUgYnkgbW9kaWZ5aW5nIHRoZSBgcHJvY2Vzc1BheW1lbnRgIG1ldGhvZCBpbiBgVGhhbmhUb2FuR1VJLmphdmFgIHRvIHByb3Blcmx5IGNyZWF0ZSBhbmQgc2F2ZSB0aGUgYEhvYURvbmAgb2JqZWN0IHdpdGggdGhlIGBOaGFuVmllbmAgcmVmZXJlbmNlOlxuIiwid29ya3NwYWNlX2ZpbGVfY2h1bmtzIjpbXX0seyJzdGF0dXMiOiJzdWNjZXNzIiwicmVxdWVzdF9pZCI6IjU5NGZiOTUxLWJhOWUtNGM5Zi1hMzg2LTBjOGZhYjBlOTVhMiIsInJlcXVlc3RfbWVzc2FnZSI6IiIsInN0cnVjdHVyZWRfb3V0cHV0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6NSwiY29udGVudCI6IiIsInRvb2xfdXNlIjp7InRvb2xfdXNlX2lkIjoidG9vbHVfMDEzQzNRWW5CVmQ2V2FHUkZZaXU3WWNaIiwidG9vbF9uYW1lIjoibGF1bmNoLXByb2Nlc3MiLCJpbnB1dF9qc29uIjoie1wiY29tbWFuZFwiOiBcInR5cGUgXFxcIkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZ3VpQ2xpZW50L1RoYW5oVG9hbkdVSS5qYXZhXFxcIiB8IGZpbmRzdHIgL24gXFxcInByb2Nlc3NQYXltZW50XFxcIlwiLCBcIndhaXRcIjogdHJ1ZSwgXCJtYXhfd2FpdF9zZWNvbmRzXCI6IDMwfSJ9fSx7ImlkIjowLCJ0eXBlIjowLCJjb250ZW50IjoiTGV0IG1lIHRyeSBhIGRpZmZlcmVudCBhcHByb2FjaCB0byBnZXQgdGhlIGZpbGU6XG4ifSx7ImlkIjoyLCJ0eXBlIjoyLCJjb250ZW50IjoiIn0seyJpZCI6MywidHlwZSI6MywiY29udGVudCI6IiJ9XSwic2Vlbl9zdGF0ZSI6InNlZW4iLCJzdHJ1Y3R1cmVkX3JlcXVlc3Rfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjoxLCJ0b29sX3Jlc3VsdF9ub2RlIjp7ImNvbnRlbnQiOiJSYW4gaW50byBVbmtub3duIGVycm9yIHdoaWxlIHRyeWluZyB0byByZWFkIFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZ3VpQ2xpZW50L1RoYW5oVG9hbkdVSS5qYXZhIiwiaXNfZXJyb3IiOnRydWUsInJlcXVlc3RfaWQiOiIiLCJ0b29sX3VzZV9pZCI6InRvb2x1XzAxOW1XRW83bTRIQjE1cXdFRm1xakI3aiJ9fSx7ImlkIjoyLCJ0eXBlIjo0LCJpZGVfc3RhdGVfbm9kZSI6eyJ3b3Jrc3BhY2VGb2xkZXJzIjpbeyJyZXBvc2l0b3J5Um9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIiwiZm9sZGVyUm9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIn1dLCJ3b3Jrc3BhY2VGb2xkZXJzVW5jaGFuZ2VkIjpmYWxzZX19XSwicmVzcG9uc2VfdGV4dCI6IkxldCBtZSB0cnkgYSBkaWZmZXJlbnQgYXBwcm9hY2ggdG8gZ2V0IHRoZSBmaWxlOlxuIiwid29ya3NwYWNlX2ZpbGVfY2h1bmtzIjpbXX0seyJzdGF0dXMiOiJzdWNjZXNzIiwicmVxdWVzdF9pZCI6IjU4MWJlYzk2LTVlZTYtNGVmMS1hY2UzLWVhZjIwZDAxNzkzZCIsInJlcXVlc3RfbWVzc2FnZSI6IiIsInN0cnVjdHVyZWRfb3V0cHV0X25vZGVzIjpbeyJpZCI6MCwidHlwZSI6MCwiY29udGVudCI6IkJhc2VkIG9uIG15IGFuYWx5c2lzIG9mIHRoZSBjb2RlIGFuZCB0aGUgZXJyb3IgbWVzc2FnZSwgSSd2ZSBpZGVudGlmaWVkIHRoZSBpc3N1ZS4gVGhlIGVycm9yIG9jY3VycyBiZWNhdXNlIHlvdSdyZSB0cnlpbmcgdG8gc2F2ZSBhIGBIb2FEb25gIG9iamVjdCB3aXRoIGEgcmVmZXJlbmNlIHRvIGEgYE5oYW5WaWVuYCBvYmplY3QgdGhhdCBoYXNuJ3QgYmVlbiBzYXZlZCB0byB0aGUgZGF0YWJhc2UgeWV0IChpdCdzIFwidHJhbnNpZW50XCIpLlxuXG5UaGUgc3BlY2lmaWMgZXJyb3IgaXM6XG5gYGBcbm9yZy5oaWJlcm5hdGUuVHJhbnNpZW50UHJvcGVydHlWYWx1ZUV4Y2VwdGlvbjogTm90LW51bGwgcHJvcGVydHkgcmVmZXJlbmNlcyBhIHRyYW5zaWVudCB2YWx1ZSAtIHRyYW5zaWVudCBpbnN0YW5jZSBtdXN0IGJlIHNhdmVkIGJlZm9yZSBjdXJyZW50IG9wZXJhdGlvbjogbW9kZWwuSG9hRG9uLm52IC0+IG1vZGVsLk5oYW5WaWVuXG5gYGBcblxuVGhpcyBpcyBhIGNvbW1vbiBIaWJlcm5hdGUgaXNzdWUuIFdoZW4geW91IGhhdmUgYSByZWxhdGlvbnNoaXAgYmV0d2VlbiBlbnRpdGllcyAoaW4gdGhpcyBjYXNlLCBgSG9hRG9uYCBoYXMgYSByZWZlcmVuY2UgdG8gYE5oYW5WaWVuYCksIEhpYmVybmF0ZSBuZWVkcyB0byBlbnN1cmUgdGhhdCBib3RoIGVudGl0aWVzIGFyZSBwcm9wZXJseSBwZXJzaXN0ZWQuIFRoZSBlcnJvciBvY2N1cnMgYmVjYXVzZSB5b3UncmUgdHJ5aW5nIHRvIHNhdmUgYSBgSG9hRG9uYCB3aXRoIGEgcmVmZXJlbmNlIHRvIGEgYE5oYW5WaWVuYCB0aGF0IEhpYmVybmF0ZSBkb2Vzbid0IHJlY29nbml6ZSBhcyBiZWluZyBpbiB0aGUgZGF0YWJhc2UuXG5cbiMjIFRoZSBTb2x1dGlvblxuXG5UaGVyZSBhcmUgdHdvIG1haW4gYXBwcm9hY2hlcyB0byBmaXggdGhpczpcblxuMS4gKipNYWtlIHN1cmUgdGhlIGBOaGFuVmllbmAgb2JqZWN0IGlzIGxvYWRlZCBmcm9tIHRoZSBkYXRhYmFzZSoqIGJlZm9yZSBhc3NpZ25pbmcgaXQgdG8gdGhlIGBIb2FEb25gXG4yLiAqKkNvbmZpZ3VyZSB0aGUgcmVsYXRpb25zaGlwIHRvIGNhc2NhZGUgdGhlIHNhdmUgb3BlcmF0aW9uKiogZnJvbSBgSG9hRG9uYCB0byBgTmhhblZpZW5gXG5cbkxldCdzIGltcGxlbWVudCB0aGUgZmlyc3QgYXBwcm9hY2gsIHdoaWNoIGlzIHNpbXBsZXIgYW5kIHNhZmVyOlxuXG5gYGBqYXZhXG4vLyBJbiBUaGFuaFRvYW5HVUkuamF2YSdzIHByb2Nlc3NQYXltZW50IG1ldGhvZFxuLy8gQmVmb3JlIGNyZWF0aW5nIHRoZSBIb2FEb24sIGVuc3VyZSB0aGUgTmhhblZpZW4gaXMgbG9hZGVkIGZyb20gdGhlIGRhdGFiYXNlXG5cbi8vIEdldCB0aGUgTmhhblZpZW4gZnJvbSB0aGUgZGF0YWJhc2UgdXNpbmcgaXRzIElEXG5OaGFuVmllbiBtYW5hZ2VkTmhhblZpZW4gPSBuaGFuVmllbkRBTy5nZXRCeUlkKG5oYW5WaWVuLmdldE1hTlYoKSk7XG5pZiAobWFuYWdlZE5oYW5WaWVuID09IG51bGwpIHtcbiAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKFwiS2jDtG5nIHRo4buDIHTDrG0gdGjhuqV5IHRow7RuZyB0aW4gbmjDom4gdmnDqm4gdHJvbmcgY8ahIHPhu58gZOG7ryBsaeG7h3VcIik7XG59XG5cbi8vIENyZWF0ZSBIb2FEb24gd2l0aCB0aGUgbWFuYWdlZCBOaGFuVmllblxuSG9hRG9uIGhvYURvbiA9IG5ldyBIb2FEb24oKTtcbmhvYURvbi5zZXRNYUhEKGhvYURvbkRBTy5nZW5lcmF0ZU1hSG9hRG9uKExvY2FsRGF0ZS5ub3coKSkpO1xuaG9hRG9uLnNldE5nYXlMYXAoTG9jYWxEYXRlVGltZS5ub3coKSk7XG5ob2FEb24uc2V0VG9uZ1RpZW4odG90YWxBbW91bnQpO1xuaG9hRG9uLnNldFRpZW5HaWFtKDApOyAvLyBTZXQgZGlzY291bnQgaWYgYXBwbGljYWJsZVxuaG9hRG9uLnNldEtoYWNoSGFuZyhleGlzdGluZ0N1c3RvbWVyKTsgLy8gT3IgbmV3Q3VzdG9tZXIgaWYgdGhhdCdzIHdoYXQgeW91J3JlIHVzaW5nXG5ob2FEb24uc2V0TnYobWFuYWdlZE5oYW5WaWVuKTsgLy8gVXNlIHRoZSBtYW5hZ2VkIE5oYW5WaWVuIGZyb20gdGhlIGRhdGFiYXNlXG5cbi8vIEdldCBMb2FpSG9hRG9uXG5Mb2FpSG9hRG9uIGxvYWlIb2FEb24gPSBsb2FpSG9hRG9uREFPLmdldExvYWlIb2FEb25CeUlkKFwiTEhEMDAxXCIpOyAvLyBBc3N1bWluZyBMSEQwMDEgaXMgZm9yIG5ldyBwdXJjaGFzZXNcbmlmIChsb2FpSG9hRG9uID09IG51bGwpIHtcbiAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKFwiS2jDtG5nIHTDrG0gdGjhuqV5IGxv4bqhaSBow7NhIMSRxqFuXCIpO1xufVxuaG9hRG9uLnNldExvYWlIb2FEb24obG9haUhvYURvbik7XG5cbi8vIFNhdmUgdGhlIEhvYURvblxuYm9vbGVhbiBzYXZlZCA9IGhvYURvbkRBTy5zYXZlSG9hRG9uKGhvYURvbik7XG5pZiAoIXNhdmVkKSB7XG4gICAgdGhyb3cgbmV3IEV4Y2VwdGlvbihcIktow7RuZyB0aOG7gyBsxrB1IGjDs2EgxJHGoW5cIik7XG59XG5gYGBcblxuVG8gaW1wbGVtZW50IHRoaXMgc29sdXRpb24sIHlvdSdsbCBuZWVkIHRvOlxuXG4xLiBBZGQgYSBgTmhhblZpZW5EQU9gIHRvIHlvdXIgYFRoYW5oVG9hbkdVSWAgY2xhc3NcbjIuIEluaXRpYWxpemUgaXQgaW4gdGhlIGNvbnN0cnVjdG9yXG4zLiBNb2RpZnkgdGhlIGBwcm9jZXNzUGF5bWVudGAgbWV0aG9kIHRvIGxvYWQgdGhlIGBOaGFuVmllbmAgZnJvbSB0aGUgZGF0YWJhc2UgYmVmb3JlIGNyZWF0aW5nIHRoZSBgSG9hRG9uYFxuXG5Xb3VsZCB5b3UgbGlrZSBtZSB0byBpbXBsZW1lbnQgdGhlc2UgY2hhbmdlcyBmb3IgeW91P1xuIn0seyJpZCI6MiwidHlwZSI6MiwiY29udGVudCI6IiJ9LHsiaWQiOjMsInR5cGUiOjMsImNvbnRlbnQiOiIifV0sInNlZW5fc3RhdGUiOiJzZWVuIiwic3RydWN0dXJlZF9yZXF1ZXN0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6MSwidG9vbF9yZXN1bHRfbm9kZSI6eyJjb250ZW50IjoiSGVyZSBhcmUgdGhlIHJlc3VsdHMgZnJvbSBleGVjdXRpbmcgdGhlIGNvbW1hbmQuXG4gICAgICAgIDxyZXR1cm4tY29kZT5cbiAgICAgICAgMFxuICAgICAgICA8L3JldHVybi1jb2RlPlxuICAgICAgICA8c3Rkb3V0PlxuICAgICAgICBcdTAwMWJbPzkwMDFoXHUwMDFiWz8xMDA0aFx1MDAxYls/MjVsXHUwMDFiWzJKXHUwMDFiW21cdTAwMWJbMzg7NTsxNW1cdTAwMWJbSDE4NzogICAgICAgIFx1MDAxYlttcGF5QnV0dG9uLmFkZEFjdGlvbkxpc3RlbmVyKGUgLT4gcHJvY2Vzc1BheW1lbnQoKSk7XHUwMDFiWzM4OzU7MTVtXG4xMTk3OiAgICBcdTAwMWJbbXByaXZhdGUgdm9pZCBwcm9jZXNzUGF5bWVudCgpIHtcblx1MDAxYl0wO0M6XFxXaW5kb3dzXFxTeXN0ZW0zMlxcV2luZG93c1Bvd2VyU2hlbGxcXHYxLjBcXHBvd2Vyc2hlbGwuZXhlXHUwMDA3XHUwMDFiWz8yNWhcbiAgICAgICAgPC9zdGRvdXQ+XG4gICAgICAgIDxzdGRlcnI+XG4gICAgICAgIFxuICAgICAgICA8L3N0ZGVycj4iLCJpc19lcnJvciI6ZmFsc2UsInJlcXVlc3RfaWQiOiIiLCJ0b29sX3VzZV9pZCI6InRvb2x1XzAxM0MzUVluQlZkNldhR1JGWWl1N1ljWiJ9fSx7ImlkIjoyLCJ0eXBlIjo0LCJpZGVfc3RhdGVfbm9kZSI6eyJ3b3Jrc3BhY2VGb2xkZXJzIjpbeyJyZXBvc2l0b3J5Um9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIiwiZm9sZGVyUm9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIn1dLCJ3b3Jrc3BhY2VGb2xkZXJzVW5jaGFuZ2VkIjpmYWxzZSwiY3VycmVudFRlcm1pbmFsIjp7InRlcm1pbmFsSWQiOjIyLCJjdXJyZW50V29ya2luZ0RpcmVjdG9yeSI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIn19fV0sInJlc3BvbnNlX3RleHQiOiJCYXNlZCBvbiBteSBhbmFseXNpcyBvZiB0aGUgY29kZSBhbmQgdGhlIGVycm9yIG1lc3NhZ2UsIEkndmUgaWRlbnRpZmllZCB0aGUgaXNzdWUuIFRoZSBlcnJvciBvY2N1cnMgYmVjYXVzZSB5b3UncmUgdHJ5aW5nIHRvIHNhdmUgYSBgSG9hRG9uYCBvYmplY3Qgd2l0aCBhIHJlZmVyZW5jZSB0byBhIGBOaGFuVmllbmAgb2JqZWN0IHRoYXQgaGFzbid0IGJlZW4gc2F2ZWQgdG8gdGhlIGRhdGFiYXNlIHlldCAoaXQncyBcInRyYW5zaWVudFwiKS5cblxuVGhlIHNwZWNpZmljIGVycm9yIGlzOlxuYGBgXG5vcmcuaGliZXJuYXRlLlRyYW5zaWVudFByb3BlcnR5VmFsdWVFeGNlcHRpb246IE5vdC1udWxsIHByb3BlcnR5IHJlZmVyZW5jZXMgYSB0cmFuc2llbnQgdmFsdWUgLSB0cmFuc2llbnQgaW5zdGFuY2UgbXVzdCBiZSBzYXZlZCBiZWZvcmUgY3VycmVudCBvcGVyYXRpb246IG1vZGVsLkhvYURvbi5udiAtPiBtb2RlbC5OaGFuVmllblxuYGBgXG5cblRoaXMgaXMgYSBjb21tb24gSGliZXJuYXRlIGlzc3VlLiBXaGVuIHlvdSBoYXZlIGEgcmVsYXRpb25zaGlwIGJldHdlZW4gZW50aXRpZXMgKGluIHRoaXMgY2FzZSwgYEhvYURvbmAgaGFzIGEgcmVmZXJlbmNlIHRvIGBOaGFuVmllbmApLCBIaWJlcm5hdGUgbmVlZHMgdG8gZW5zdXJlIHRoYXQgYm90aCBlbnRpdGllcyBhcmUgcHJvcGVybHkgcGVyc2lzdGVkLiBUaGUgZXJyb3Igb2NjdXJzIGJlY2F1c2UgeW91J3JlIHRyeWluZyB0byBzYXZlIGEgYEhvYURvbmAgd2l0aCBhIHJlZmVyZW5jZSB0byBhIGBOaGFuVmllbmAgdGhhdCBIaWJlcm5hdGUgZG9lc24ndCByZWNvZ25pemUgYXMgYmVpbmcgaW4gdGhlIGRhdGFiYXNlLlxuXG4jIyBUaGUgU29sdXRpb25cblxuVGhlcmUgYXJlIHR3byBtYWluIGFwcHJvYWNoZXMgdG8gZml4IHRoaXM6XG5cbjEuICoqTWFrZSBzdXJlIHRoZSBgTmhhblZpZW5gIG9iamVjdCBpcyBsb2FkZWQgZnJvbSB0aGUgZGF0YWJhc2UqKiBiZWZvcmUgYXNzaWduaW5nIGl0IHRvIHRoZSBgSG9hRG9uYFxuMi4gKipDb25maWd1cmUgdGhlIHJlbGF0aW9uc2hpcCB0byBjYXNjYWRlIHRoZSBzYXZlIG9wZXJhdGlvbioqIGZyb20gYEhvYURvbmAgdG8gYE5oYW5WaWVuYFxuXG5MZXQncyBpbXBsZW1lbnQgdGhlIGZpcnN0IGFwcHJvYWNoLCB3aGljaCBpcyBzaW1wbGVyIGFuZCBzYWZlcjpcblxuYGBgamF2YVxuLy8gSW4gVGhhbmhUb2FuR1VJLmphdmEncyBwcm9jZXNzUGF5bWVudCBtZXRob2Rcbi8vIEJlZm9yZSBjcmVhdGluZyB0aGUgSG9hRG9uLCBlbnN1cmUgdGhlIE5oYW5WaWVuIGlzIGxvYWRlZCBmcm9tIHRoZSBkYXRhYmFzZVxuXG4vLyBHZXQgdGhlIE5oYW5WaWVuIGZyb20gdGhlIGRhdGFiYXNlIHVzaW5nIGl0cyBJRFxuTmhhblZpZW4gbWFuYWdlZE5oYW5WaWVuID0gbmhhblZpZW5EQU8uZ2V0QnlJZChuaGFuVmllbi5nZXRNYU5WKCkpO1xuaWYgKG1hbmFnZWROaGFuVmllbiA9PSBudWxsKSB7XG4gICAgdGhyb3cgbmV3IEV4Y2VwdGlvbihcIktow7RuZyB0aOG7gyB0w6xtIHRo4bqleSB0aMO0bmcgdGluIG5ow6JuIHZpw6puIHRyb25nIGPGoSBz4bufIGThu68gbGnhu4d1XCIpO1xufVxuXG4vLyBDcmVhdGUgSG9hRG9uIHdpdGggdGhlIG1hbmFnZWQgTmhhblZpZW5cbkhvYURvbiBob2FEb24gPSBuZXcgSG9hRG9uKCk7XG5ob2FEb24uc2V0TWFIRChob2FEb25EQU8uZ2VuZXJhdGVNYUhvYURvbihMb2NhbERhdGUubm93KCkpKTtcbmhvYURvbi5zZXROZ2F5TGFwKExvY2FsRGF0ZVRpbWUubm93KCkpO1xuaG9hRG9uLnNldFRvbmdUaWVuKHRvdGFsQW1vdW50KTtcbmhvYURvbi5zZXRUaWVuR2lhbSgwKTsgLy8gU2V0IGRpc2NvdW50IGlmIGFwcGxpY2FibGVcbmhvYURvbi5zZXRLaGFjaEhhbmcoZXhpc3RpbmdDdXN0b21lcik7IC8vIE9yIG5ld0N1c3RvbWVyIGlmIHRoYXQncyB3aGF0IHlvdSdyZSB1c2luZ1xuaG9hRG9uLnNldE52KG1hbmFnZWROaGFuVmllbik7IC8vIFVzZSB0aGUgbWFuYWdlZCBOaGFuVmllbiBmcm9tIHRoZSBkYXRhYmFzZVxuXG4vLyBHZXQgTG9haUhvYURvblxuTG9haUhvYURvbiBsb2FpSG9hRG9uID0gbG9haUhvYURvbkRBTy5nZXRMb2FpSG9hRG9uQnlJZChcIkxIRDAwMVwiKTsgLy8gQXNzdW1pbmcgTEhEMDAxIGlzIGZvciBuZXcgcHVyY2hhc2VzXG5pZiAobG9haUhvYURvbiA9PSBudWxsKSB7XG4gICAgdGhyb3cgbmV3IEV4Y2VwdGlvbihcIktow7RuZyB0w6xtIHRo4bqleSBsb+G6oWkgaMOzYSDEkcahblwiKTtcbn1cbmhvYURvbi5zZXRMb2FpSG9hRG9uKGxvYWlIb2FEb24pO1xuXG4vLyBTYXZlIHRoZSBIb2FEb25cbmJvb2xlYW4gc2F2ZWQgPSBob2FEb25EQU8uc2F2ZUhvYURvbihob2FEb24pO1xuaWYgKCFzYXZlZCkge1xuICAgIHRocm93IG5ldyBFeGNlcHRpb24oXCJLaMO0bmcgdGjhu4MgbMawdSBow7NhIMSRxqFuXCIpO1xufVxuYGBgXG5cblRvIGltcGxlbWVudCB0aGlzIHNvbHV0aW9uLCB5b3UnbGwgbmVlZCB0bzpcblxuMS4gQWRkIGEgYE5oYW5WaWVuREFPYCB0byB5b3VyIGBUaGFuaFRvYW5HVUlgIGNsYXNzXG4yLiBJbml0aWFsaXplIGl0IGluIHRoZSBjb25zdHJ1Y3RvclxuMy4gTW9kaWZ5IHRoZSBgcHJvY2Vzc1BheW1lbnRgIG1ldGhvZCB0byBsb2FkIHRoZSBgTmhhblZpZW5gIGZyb20gdGhlIGRhdGFiYXNlIGJlZm9yZSBjcmVhdGluZyB0aGUgYEhvYURvbmBcblxuV291bGQgeW91IGxpa2UgbWUgdG8gaW1wbGVtZW50IHRoZXNlIGNoYW5nZXMgZm9yIHlvdT9cbiIsIndvcmtzcGFjZV9maWxlX2NodW5rcyI6W119XSwiZmVlZGJhY2tTdGF0ZXMiOnsidGVtcC1mZS1mZmViYjIzYS1iZTVhLTQ2OWItYTM3Ni1lYTRmOWMwYTg3ZTkiOnsic2VsZWN0ZWRSYXRpbmciOjAsImZlZWRiYWNrTm90ZSI6IiJ9LCJ0ZW1wLWZlLWQ1ZWIzZDdjLWRlZGQtNDhhYy1iNDhkLWM0MzdmNzBhOWY2MCI6eyJzZWxlY3RlZFJhdGluZyI6MCwiZmVlZGJhY2tOb3RlIjoiIn0sInRlbXAtZmUtMDFlYWFjNjItNTE1ZC00NmZkLWFiZTEtZTNkNmU3NjI5MWM0Ijp7InNlbGVjdGVkUmF0aW5nIjowLCJmZWVkYmFja05vdGUiOiIifSwidGVtcC1mZS03MDZkZjdkOS1kZTYzLTRhMWItOGIyOC00ZmVjZWI1MzAyZjciOnsic2VsZWN0ZWRSYXRpbmciOjAsImZlZWRiYWNrTm90ZSI6IiJ9LCJ0ZW1wLWZlLTBlNWY5NmU0LWQyYjQtNDJmZi04MDMwLTMyYjNlMDU4YTRmNCI6eyJzZWxlY3RlZFJhdGluZyI6MCwiZmVlZGJhY2tOb3RlIjoiIn0sInRlbXAtZmUtNTdmMjU3YzMtMTg0OC00MzBhLTg3YzctMjc0MDlmMjdiMWRlIjp7InNlbGVjdGVkUmF0aW5nIjowLCJmZWVkYmFja05vdGUiOiIifSwidGVtcC1mZS0wN2U1MmIxYy1hZmQyLTQyNjItOWJiMi1lNzc0MWU5NGQzMjEiOnsic2VsZWN0ZWRSYXRpbmciOjAsImZlZWRiYWNrTm90ZSI6IiJ9LCJ0ZW1wLWZlLTUzOTBkYTljLTQxMDQtNDI5MC1iY2UwLTRlNDU5ZDhkNWQyZiI6eyJzZWxlY3RlZFJhdGluZyI6MCwiZmVlZGJhY2tOb3RlIjoiIn0sInRlbXAtZmUtNzMyYTQ1M2EtZmI0YS00NmI5LWEwMjItMjJhYjJkNzljMjBhIjp7InNlbGVjdGVkUmF0aW5nIjowLCJmZWVkYmFja05vdGUiOiIifSwidGVtcC1mZS02OTJhNjJhNy04YTVmLTQ4ZjUtYTYyNy1mYjgzMDI1MGY0ZjIiOnsic2VsZWN0ZWRSYXRpbmciOjAsImZlZWRiYWNrTm90ZSI6IiJ9fSwidG9vbFVzZVN0YXRlcyI6eyI0MjNkMDk4NS0zZWFjLTQwNjYtOTNjNi0yZDVlMTM0NTA2MjA7dG9vbHVfMDE2MkJ1Zm9VenFEU3F4NTdaU001SEVtIjp7InBoYXNlIjo1LCJyZXN1bHQiOnsidGV4dCI6IlRoZSBmb2xsb3dpbmcgY29kZSBzZWN0aW9ucyB3ZXJlIHJldHJpZXZlZDpcblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGFvL2ltcGwvSG9hRG9uREFPSW1wbC5qYXZhXG5wYWNrYWdlIGRhby5pbXBsO1xuXG5pbXBvcnQgZGFvLkhvYURvbkRBTztcbmltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXI7XG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS5FbnRpdHlUcmFuc2FjdGlvbjtcbmltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLlF1ZXJ5O1xuaW1wb3J0IG1vZGVsLkhvYURvbjtcbmltcG9ydCBtb2RlbC5Mb2FpSG9hRG9uO1xuaW1wb3J0IHV0aWwuSlBBVXRpbDtcblxuaW1wb3J0IGphdmEucm1pLlJlbW90ZUV4Y2VwdGlvbjtcbmltcG9ydCBqYXZhLnJtaS5zZXJ2ZXIuVW5pY2FzdFJlbW90ZU9iamVjdDtcbmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlO1xuaW1wb3J0IGphdmEudGltZS5mb3JtYXQuRGF0ZVRpbWVGb3JtYXR0ZXI7XG5pbXBvcnQgamF2YS51dGlsLkxpc3Q7XG5cbnB1YmxpYyBjbGFzcyBIb2FEb25EQU9JbXBsIGV4dGVuZHMgVW5pY2FzdFJlbW90ZU9iamVjdCBpbXBsZW1lbnRzIEhvYURvbkRBTyB7XG4gICAgcHVibGljIEhvYURvbkRBT0ltcGwoKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uIHtcblxuICAgIH1cblxuICAgIEBPdmVycmlkZVxuICAgIC8vIENyZWF0ZTogVGjDqm0gaMOzYSDEkcahbiBt4bubaVxuICAgIHB1YmxpYyBib29sZWFuIHNhdmVIb2FEb24oSG9hRG9uIGhvYURvbikgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcbiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHIgPSBlbS5nZXRUcmFuc2FjdGlvbigpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdHIuYmVnaW4oKTtcblxuICAgICAgICAgICAgLy8gS2nhu4NtIHRyYSB4ZW0gbcOjIGjDs2EgxJHGoW4gxJHDoyDEkcaw4bujYyB0aGnhur90IGzhuq1wIGNoxrBhXG4gICAgICAgICAgICBpZiAoaG9hRG9uLmdldE1hSEQoKSA9PSBudWxsIHx8IGhvYURvbi5nZXRNYUhEKCkuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgLy8gTuG6v3UgY2jGsGEgY8OzIG3DoyBow7NhIMSRxqFuLCB04buxIMSR4buZbmcgc2luaCBtw6NcbiAgICAgICAgICAgICAgICBTdHJpbmcgbWFIRCA9IGdlbmVyYXRlTWFIb2FEb24oXG4gICAgICAgICAgICAgICAgICAgICAgICBob2FEb24uZ2V0TmdheUxhcCgpICE9IG51bGwgP1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob2FEb24uZ2V0TmdheUxhcCgpLnRvTG9jYWxEYXRlKCkgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMb2NhbERhdGUubm93KClcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGhvYURvbi5zZXRNYUhEKG1hSEQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBLaeG7g20gdHJhIGPDoWMgxJHhu5FpIHTGsOG7o25nIGxpw6puIHF1YW5cbiAgICAgICAgICAgIGlmIChob2FEb24uZ2V0TG9haUhvYURvbigpICE9IG51bGwgJiYgaG9hRG9uLmdldExvYWlIb2FEb24oKS5nZXRNYUxvYWlIb2FEb24oKSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgLy8gTOG6pXkgbG/huqFpIGjDs2EgxJHGoW4gdOG7qyBkYXRhYmFzZSDEkeG7gyDEkeG6o20gYuG6o28gbGnDqm4ga+G6v3QgxJHDum5nXG4gICAgICAgICAgICAgICAgTG9haUhvYURvbiBsb2FpSEQgPSBnZXRMb2FpSG9hRG9uQnlJZChob2FEb24uZ2V0TG9haUhvYURvbigpLmdldE1hTG9haUhvYURvbigpKTtcbiAgICAgICAgICAgICAgICBpZiAobG9haUhEICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgaG9hRG9uLnNldExvYWlIb2FEb24obG9haUhEKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKFwiS2jDtG5nIHTDrG0gdGjhuqV5IGxv4bqhaSBow7NhIMSRxqFuIHbhu5tpIG3DozogXCIgKyBob2FEb24uZ2V0TG9haUhvYURvbigpLmdldE1hTG9haUhvYURvbigpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEzGsHUgaMOzYSDEkcahbiB2w6BvIGRhdGFiYXNlXG4gICAgICAgICAgICBlbS5wZXJzaXN0KGhvYURvbik7XG4gICAgICAgICAgICB0ci5jb21taXQoKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZXgpIHtcbiAgICAgICAgICAgIGlmICh0ci5pc0FjdGl2ZSgpKSB7XG4gICAgICAgICAgICAgICAgdHIucm9sbGJhY2soKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGV4LnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IFJlbW90ZUV4Y2VwdGlvbihcIkzhu5dpIGtoaSBsxrB1IGjDs2EgxJHGoW46IFwiICsgZXguZ2V0TWVzc2FnZSgpLCBleCk7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICBpZiAoZW0gIT0gbnVsbCAmJiBlbS5pc09wZW4oKSkge1xuICAgICAgICAgICAgICAgIGVtLmNsb3NlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4uLi5cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdHguYmVnaW4oKTtcbiAgICAgICAgICAgIC8vIFVzZSBKT0lOIEZFVENIIHRvIGVhZ2VybHkgbG9hZCByZWxhdGVkIGVudGl0aWVzXG4gICAgICAgICAgICBTdHJpbmcganBxbCA9IFwiU0VMRUNUIGggRlJPTSBIb2FEb24gaCBKT0lOIEZFVENIIGgua2hhY2hIYW5nXCI7XG4gICAgICAgICAgICBsaXN0ID0gZW0uY3JlYXRlUXVlcnkoanBxbCwgSG9hRG9uLmNsYXNzKS5nZXRSZXN1bHRMaXN0KCk7XG5cbiAgICAgICAgICAgIC8vIEVuc3VyZSBhbGwgcmVsYXRlZCBkYXRhIGlzIGxvYWRlZCB3aXRoaW4gdGhlIHRyYW5zYWN0aW9uXG4gICAgICAgICAgICBmb3IgKEhvYURvbiBoZCA6IGxpc3QpIHtcbiAgICAgICAgICAgICAgICBpZiAoaGQuZ2V0S2hhY2hIYW5nKCkgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBoZC5nZXRLaGFjaEhhbmcoKS5nZXRUZW5LaGFjaEhhbmcoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHR4LmNvbW1pdCgpO1xuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgaWYgKHR4ICE9IG51bGwgJiYgdHguaXNBY3RpdmUoKSkge1xuICAgICAgICAgICAgICAgIHR4LnJvbGxiYWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCJM4buXaSBraGkgbOG6pXkgZGFuaCBzw6FjaCBIb2FEb246IFwiICsgZS5nZXRNZXNzYWdlKCkpO1xuICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBSZW1vdGVFeGNlcHRpb24oXCJM4buXaSBraGkgbOG6pXkgZGFuaCBzw6FjaCBIb2FEb25cIiwgZSk7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICBpZiAoZW0gIT0gbnVsbCAmJiBlbS5pc09wZW4oKSkge1xuICAgICAgICAgICAgICAgIGVtLmNsb3NlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbGlzdDtcbiAgICB9XG5cbiAgICAvLyBSZWFkOiBUw6xtIGjDs2EgxJHGoW4gdGhlbyBtw6MgaMOzYSDEkcahblxuICAgIEBPdmVycmlkZVxuICAgIHB1YmxpYyBIb2FEb24gZ2V0SG9hRG9uQnlJZChTdHJpbmcgbWFIRCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcbiAgICAgICAgcmV0dXJuIGVtLmZpbmQoSG9hRG9uLmNsYXNzLCBtYUhEKTtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGU6IEPhuq1wIG5o4bqtdCB0aMO0bmcgdGluIGjDs2EgxJHGoW5cbiAgICBAT3ZlcnJpZGVcbiAgICBwdWJsaWMgYm9vbGVhbiB1cGRhdGVIb2FEb24oSG9hRG9uIGhvYURvbikgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcbiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHIgPSBlbS5nZXRUcmFuc2FjdGlvbigpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdHIuYmVnaW4oKTtcbiAgICAgICAgICAgIGVtLm1lcmdlKGhvYURvbik7XG4gICAgICAgICAgICB0ci5jb21taXQoKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZXgpIHtcbiAgICAgICAgICAgIHRyLnJvbGxiYWNrKCk7XG4gICAgICAgICAgICBleC5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gRGVsZXRlOiBYw7NhIGjDs2EgxJHGoW4gdGhlbyBtw6MgaMOzYSDEkcahblxuICAgIEBPdmVycmlkZVxuICAgIHB1YmxpYyBib29sZWFuIGRlbGV0ZUhvYURvbihTdHJpbmcgbWFIRCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcbiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHIgPSBlbS5nZXRUcmFuc2FjdGlvbigpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdHIuYmVnaW4oKTtcbiAgICAgICAgICAgIEhvYURvbiBob2FEb24gPSBlbS5maW5kKEhvYURvbi5jbGFzcywgbWFIRCk7XG4gICAgICAgICAgICBpZiAoaG9hRG9uICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBlbS5yZW1vdmUoaG9hRG9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRyLmNvbW1pdCgpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBleCkge1xuICAgICAgICAgICAgdHIucm9sbGJhY2soKTtcbiAgICAgICAgICAgIGV4LnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4uLi5cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdHIuYmVnaW4oKTtcblxuICAgICAgICAgICAgLy8gxJDhu4tuaCBk4bqhbmcgcGjhuqduIG5nw6B5IHRow6FuZyBj4bunYSBtw6MgaMOzYSDEkcahbiBraMO0bmcgY8OzIGThuqV1IFwiL1wiXG4gICAgICAgICAgICBEYXRlVGltZUZvcm1hdHRlciBmb3JtYXR0ZXIgPSBEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oXCJ5eXl5TU1kZFwiKTtcbiAgICAgICAgICAgIFN0cmluZyBkYXRlUHJlZml4ID0gXCJIRFwiICsgZm9ybWF0dGVyLmZvcm1hdChuZ2F5KTtcblxuICAgICAgICAgICAgLy8gUXVlcnkgxJHhu4MgdMOsbSBtw6MgaMOzYSDEkcahbiBs4bubbiBuaOG6pXQgdHJvbmcgbmfDoHlcbiAgICAgICAgICAgIFN0cmluZyBqcHFsID0gXCJTRUxFQ1QgaC5tYUhEIEZST00gSG9hRG9uIGggV0hFUkUgaC5tYUhEIExJS0UgOnByZWZpeCBPUkRFUiBCWSBoLm1hSEQgREVTQ1wiO1xuICAgICAgICAgICAgUXVlcnkgcXVlcnkgPSBlbS5jcmVhdGVRdWVyeShqcHFsKVxuICAgICAgICAgICAgICAgICAgICAuc2V0UGFyYW1ldGVyKFwicHJlZml4XCIsIGRhdGVQcmVmaXggKyBcIiVcIilcbiAgICAgICAgICAgICAgICAgICAgLnNldE1heFJlc3VsdHMoMSk7XG5cbiAgICAgICAgICAgIExpc3Q8Pz4gcmVzdWx0cyA9IHF1ZXJ5LmdldFJlc3VsdExpc3QoKTtcblxuICAgICAgICAgICAgLy8gWMOhYyDEkeG7i25oIHPhu5EgdGjhu6kgdOG7sSB0aeG6v3AgdGhlb1xuICAgICAgICAgICAgaW50IG5leHROdW1iZXIgPSAxO1xuXG4gICAgICAgICAgICBpZiAoIXJlc3VsdHMuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgU3RyaW5nIGxhc3RDb2RlID0gKFN0cmluZykgcmVzdWx0cy5nZXQoMCk7XG4gICAgICAgICAgICAgICAgLy8gVHLDrWNoIHh14bqldCBz4buRIHRo4bupIHThu7EgdOG7qyBtw6MgaMOzYSDEkcahbiBjdeG7kWkgY8O5bmdcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAvLyBGb3JtYXQ6IEhEeXl5eU1NZGRYWFhYXG4gICAgICAgICAgICAgICAgICAgIC8vIEzhuqV5IDQga8O9IHThu7EgY3Xhu5FpIGPDuW5nIGPhu6dhIG3DoyBow7NhIMSRxqFuXG4gICAgICAgICAgICAgICAgICAgIFN0cmluZyBudW1iZXJTdHIgPSBsYXN0Q29kZS5zdWJzdHJpbmcobGFzdENvZGUubGVuZ3RoKCkgLSA0KTtcbiAgICAgICAgICAgICAgICAgICAgbmV4dE51bWJlciA9IEludGVnZXIucGFyc2VJbnQobnVtYmVyU3RyKSArIDE7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gTuG6v3UgY8OzIGzhu5dpIGtoaSBwYXJzZSwgbeG6t2MgxJHhu4tuaCBsw6AgMVxuICAgICAgICAgICAgICAgICAgICBuZXh0TnVtYmVyID0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRyLmNvbW1pdCgpO1xuXG4gICAgICAgICAgICAvLyBU4bqhbyBtw6MgaMOzYSDEkcahbiBt4bubaSB24bubaSDEkeG7i25oIGThuqFuZyBIRHl5eXlNTWRkWFhYWFxuICAgICAgICAgICAgcmV0dXJuIFN0cmluZy5mb3JtYXQoXCIlcyUwNGRcIiwgZGF0ZVByZWZpeCwgbmV4dE51bWJlcik7XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGFvL2ltcGwvS2hhY2hIYW5nREFPSW1wbC5qYXZhXG4uLi5cblxuICAgIC8vIEzGsHUga2jDoWNoIGjDoG5nXG5AT3ZlcnJpZGVcbnB1YmxpYyBib29sZWFuIHNhdmUoS2hhY2hIYW5nIGtoYWNoSGFuZykgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgRW50aXR5TWFuYWdlciBlbSA9IEpQQVV0aWwuZ2V0RW50aXR5TWFuYWdlcigpO1xuICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcbiAgICB0cnkge1xuICAgICAgICB0ci5iZWdpbigpO1xuICAgICAgICBlbS5wZXJzaXN0KGtoYWNoSGFuZyk7XG4gICAgICAgIHRyLmNvbW1pdCgpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICBpZiAodHIgIT0gbnVsbCAmJiB0ci5pc0FjdGl2ZSgpKSB7XG4gICAgICAgICAgICB0ci5yb2xsYmFjaygpO1xuICAgICAgICB9XG4gICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihcIkzhu5dpIGtoaSBsxrB1IEtoYWNoSGFuZzogXCIgKyBlLmdldE1lc3NhZ2UoKSk7XG4gICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgIHRocm93IG5ldyBSZW1vdGVFeGNlcHRpb24oXCJM4buXaSBraGkgbMawdSBLaGFjaEhhbmdcIiwgZSk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgICAgaWYgKGVtICE9IG51bGwgJiYgZW0uaXNPcGVuKCkpIHtcbiAgICAgICAgICAgIGVtLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICB9XG59XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGFvL2ltcGwvTmhhblZpZW5EQU9JbXBsLmphdmFcbi4uLlxuICAgIEBPdmVycmlkZVxuICAgIHB1YmxpYyBib29sZWFuIHNhdmUoTmhhblZpZW4gbnYpIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xuICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0ciA9IGVtLmdldFRyYW5zYWN0aW9uKCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0ci5iZWdpbigpO1xuICAgICAgICAgICAgZW0ucGVyc2lzdChudik7XG5cbiAgICAgICAgICAgIC8vY3JlYXRlIHRhaSBraG9hbiB24bubaSBOaGFuVmllblxuICAgICAgICAgICAgVGFpS2hvYW4gdGFpS2hvYW4gPSBuZXcgVGFpS2hvYW4oKTtcbiAgICAgICAgICAgIHRhaUtob2FuLnNldE1hTlYobnYuZ2V0TWFOVigpKTtcbiAgICAgICAgICAgIHRhaUtob2FuLnNldFBhc3NXb3JkKFwiQWJjMTIzLlwiKTtcbiAgICAgICAgICAgIHRhaUtob2FuLnNldE5oYW5WaWVuKG52KTtcbiAgICAgICAgICAgIGVtLnBlcnNpc3QodGFpS2hvYW4pO1xuXG4gICAgICAgICAgICB0ci5jb21taXQoKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgIHRyLnJvbGxiYWNrKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIEBPdmVycmlkZVxuICAgIHB1YmxpYyBib29sZWFuIHVwZGF0ZShOaGFuVmllbiBudikgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRyLmJlZ2luKCk7XG4gICAgICAgICAgICBlbS5tZXJnZShudik7XG4gICAgICAgICAgICB0ci5jb21taXQoKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgIHRyLnJvbGxiYWNrKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9kYW8vaW1wbC9WZVRhdURBT0ltcGwuamF2YVxucGFja2FnZSBkYW8uaW1wbDtcblxuaW1wb3J0IGRhby5WZVRhdURBTztcbmltcG9ydCBqYWthcnRhLnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXI7XG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS5FbnRpdHlUcmFuc2FjdGlvbjtcbmltcG9ydCBtb2RlbC5Ib2FEb247XG5pbXBvcnQgbW9kZWwuS2hhY2hIYW5nO1xuaW1wb3J0IG1vZGVsLlRyYW5nVGhhaVZlVGF1O1xuaW1wb3J0IG1vZGVsLlZlVGF1O1xuaW1wb3J0IHV0aWwuSlBBVXRpbDtcblxuaW1wb3J0IGphdmEucm1pLlJlbW90ZUV4Y2VwdGlvbjtcbmltcG9ydCBqYXZhLnJtaS5zZXJ2ZXIuVW5pY2FzdFJlbW90ZU9iamVjdDtcbmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDtcbmltcG9ydCBqYXZhLnV0aWwuTGlzdDtcbmltcG9ydCBqYXZhLnV0aWwuTWFwO1xuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2Rhby9pbXBsL0RvaVZlREFPSW1wbC5qYXZhXG4uLi5cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdHguYmVnaW4oKTtcblxuICAgICAgICAgICAgLy8gRm9yIG5hdGl2ZSBxdWVyaWVzIHdpdGggbmFtZWQgcGFyYW1ldGVycywgdXNlIDpuYW1lIG5vdGF0aW9uXG4gICAgICAgICAgICBTdHJpbmcgbmF0aXZlUXVlcnkgPVxuICAgICAgICAgICAgICAgICAgICBcIlNFTEVDVCBraC4qIEZST00ga2hhY2hoYW5nIGtoIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkpPSU4gaG9hZG9uIGhkIE9OIGhkLm1hX2toYWNoX2hhbmcgPSBraC5tYV9raGFjaF9oYW5nIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkpPSU4gY2hpdGlldF9ob2Fkb24gY3RoZCBPTiBjdGhkLm1hX2hkID0gaGQubWFfaGQgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiV0hFUkUgY3RoZC5tYV92ZSA9ID9cIjtcblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBraGFjaEhhbmcgPSAoS2hhY2hIYW5nKSBlbS5jcmVhdGVOYXRpdmVRdWVyeShuYXRpdmVRdWVyeSwgS2hhY2hIYW5nLmNsYXNzKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnNldFBhcmFtZXRlcigxLCBtYVZlKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmdldFNpbmdsZVJlc3VsdCgpO1xuXG4gICAgICAgICAgICAgICAgLy8gRW5zdXJlIHJlbGF0ZWQgZGF0YSBpcyBsb2FkZWQgaWYgbmVlZGVkXG4gICAgICAgICAgICAgICAgaWYgKGtoYWNoSGFuZyAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGtoYWNoSGFuZy5nZXRNYUtoYWNoSGFuZygpOyAvLyBUcmlnZ2VyIGxvYWRpbmdcblxuICAgICAgICAgICAgICAgICAgICAvLyBJZiB5b3UgbmVlZCB0byBsb2FkIHRoZSBsb2FpS2hhY2hIYW5nIHJlbGF0aW9uXG4gICAgICAgICAgICAgICAgICAgIGlmIChraGFjaEhhbmcuZ2V0TG9haUtoYWNoSGFuZygpICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGtoYWNoSGFuZy5nZXRMb2FpS2hhY2hIYW5nKCkuZ2V0TWFMb2FpS2hhY2hIYW5nKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKE5vUmVzdWx0RXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICAvLyBObyBjdXN0b21lciBmb3VuZCBmb3IgdGhpcyB0aWNrZXRcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9kYW8vaW1wbC9UYXVEQU9JbXBsLmphdmFcbi4uLlxuICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFwiRXJyb3IgZmV0Y2hpbmcgVGF1IGJ5IExpY2hUcmluaFRhdTogXCIgKyBlLmdldE1lc3NhZ2UoKSk7XG4gICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IFJlbW90ZUV4Y2VwdGlvbihcIkVycm9yIGZldGNoaW5nIFRhdSBieSBMaWNoVHJpbmhUYXVcIiwgZSk7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICBpZiAoZW0gIT0gbnVsbCAmJiBlbS5pc09wZW4oKSkge1xuICAgICAgICAgICAgICAgIGVtLmNsb3NlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGF1O1xuICAgIH1cblxuICAgIHB1YmxpYyBib29sZWFuIHNhdmUoVGF1IHQpIHtcbiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IEpQQVV0aWwuZ2V0RW50aXR5TWFuYWdlcigpO1xuICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0ciA9IGVtLmdldFRyYW5zYWN0aW9uKCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0ci5iZWdpbigpO1xuICAgICAgICAgICAgZW0ucGVyc2lzdCh0KTtcbiAgICAgICAgICAgIHRyLmNvbW1pdCgpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1jYXRjaChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgIHRyLnJvbGxiYWNrKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHB1YmxpYyBib29sZWFuIHVwZGF0ZShUYXUgdCkge1xuICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gSlBBVXRpbC5nZXRFbnRpdHlNYW5hZ2VyKCk7XG4gICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRyLmJlZ2luKCk7XG4gICAgICAgICAgICBlbS5tZXJnZSh0KTtcbiAgICAgICAgICAgIHRyLmNvbW1pdCgpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1jYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgICAgICB0ci5yb2xsYmFjaygpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvbW9kZWwvSG9hRG9uLmphdmFcbnBhY2thZ2UgbW9kZWw7XG5cblxuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuKjtcbmltcG9ydCBsb21ib2suRGF0YTtcbmltcG9ydCBsb21ib2suRXF1YWxzQW5kSGFzaENvZGU7XG5pbXBvcnQgbG9tYm9rLlRvU3RyaW5nO1xuXG5pbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7XG5pbXBvcnQgamF2YS50aW1lLkxvY2FsRGF0ZTtcbmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlVGltZTtcbmltcG9ydCBqYXZhLnV0aWwuT2JqZWN0cztcbmltcG9ydCBqYXZhLnV0aWwuU2V0O1xuXG5ARGF0YVxuQEVudGl0eVxuQFRhYmxlKG5hbWUgPSBcImhvYWRvblwiKVxuQEVxdWFsc0FuZEhhc2hDb2RlKG9ubHlFeHBsaWNpdGx5SW5jbHVkZWQgPSB0cnVlKVxucHVibGljIGNsYXNzIEhvYURvbiBpbXBsZW1lbnRzIFNlcmlhbGl6YWJsZSB7XG4gICAgQElkXG4gICAgQENvbHVtbihuYW1lID0gXCJtYV9oZFwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJ2YXJjaGFyKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSwgdW5pcXVlID0gdHJ1ZSlcbiAgICBARXF1YWxzQW5kSGFzaENvZGUuSW5jbHVkZVxuICAgIHByaXZhdGUgU3RyaW5nIG1hSEQ7XG5cbiAgICBAQ29sdW1uKG5hbWUgPSBcIm5nYXlfbGFwXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcImRhdGV0aW1lXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBMb2NhbERhdGVUaW1lIG5nYXlMYXA7XG4gICAgQENvbHVtbihuYW1lID0gXCJ0aWVuX2dpYW1cIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiZG91YmxlXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBkb3VibGUgdGllbkdpYW07XG4gICAgQENvbHVtbihuYW1lID0gXCJ0b25nX3RpZW5cIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiZG91YmxlXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBkb3VibGUgdG9uZ1RpZW47XG5cbiAgICBAVG9TdHJpbmcuRXhjbHVkZVxuICAgIEBNYW55VG9PbmUoZmV0Y2ggPSBGZXRjaFR5cGUuTEFaWSlcbiAgICBASm9pbkNvbHVtbihuYW1lID0gXCJtYV9raGFjaF9oYW5nXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBLaGFjaEhhbmcga2hhY2hIYW5nO1xuXG4gICAgQFRvU3RyaW5nLkV4Y2x1ZGVcbiAgICBATWFueVRvT25lKGZldGNoID0gRmV0Y2hUeXBlLkxBWlkpXG4gICAgQEpvaW5Db2x1bW4obmFtZSA9IFwibWFfbmhhbl92aWVuXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBOaGFuVmllbiBudjtcblxuICAgIEBUb1N0cmluZy5FeGNsdWRlXG4gICAgQE1hbnlUb09uZShmZXRjaCA9IEZldGNoVHlwZS5MQVpZKVxuICAgIEBKb2luQ29sdW1uKG5hbWUgPSBcIm1hX2xvYWlfaGRcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIExvYWlIb2FEb24gbG9haUhvYURvbjtcblxuLy8gICAgQE1hbnlUb01hbnlcbi8vICAgIEBKb2luVGFibGUobmFtZSA9IFwiY2hpdGlldF9ob2Fkb25cIixcbi8vICAgICAgICAgICAgam9pbkNvbHVtbnMgPSBASm9pbkNvbHVtbihuYW1lID0gXCJtYV9oZFwiKSxcbi8vICAgICAgICAgICAgaW52ZXJzZUpvaW5Db2x1bW5zID0gQEpvaW5Db2x1bW4obmFtZSA9IFwibWFfdmVcIikpXG4vLyAgICBwcml2YXRlIFNldDxWZVRhdT4gdmVUYXVzO1xuXG4gICAgQE9uZVRvTWFueShtYXBwZWRCeSA9IFwiaG9hRG9uXCIpXG4gICAgQFRvU3RyaW5nLkV4Y2x1ZGVcbiAgICBwcml2YXRlIFNldDxDaGlUaWV0SG9hRG9uPiBjaGlUaWV0SG9hRG9ucztcbn1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9tb2RlbC9OaGFuVmllbi5qYXZhXG5wYWNrYWdlIG1vZGVsO1xuXG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS4qO1xuaW1wb3J0IGxvbWJvay4qO1xuXG5pbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7XG5pbXBvcnQgamF2YS50aW1lLkxvY2FsRGF0ZTtcbmltcG9ydCBqYXZhLnV0aWwuU2V0O1xuLyoqXG4gKiBAROG7sSDDoW46IEFwcFxuICogQENsYXNzOiBOaGFuVmllblxuICogQFThuqFvIHbDoG8gbmfDoHk6IDE1LzAxLzIwMjVcbiAqIEBUw6FjIGdp4bqjOiBOZ3V5ZW4gSHV1IFNhbmdcbiAqL1xuQERhdGFcbkBFbnRpdHlcbkBUYWJsZShuYW1lID0gXCJuaGFudmllblwiKVxuQEVxdWFsc0FuZEhhc2hDb2RlKG9ubHlFeHBsaWNpdGx5SW5jbHVkZWQgPSB0cnVlKVxuQEFsbEFyZ3NDb25zdHJ1Y3RvclxuQE5vQXJnc0NvbnN0cnVjdG9yXG5ATmFtZWROYXRpdmVRdWVyaWVzKHtcbiAgICAgICAgQE5hbWVkTmF0aXZlUXVlcnkobmFtZSA9IFwiTmhhblZpZW4uZmluZEJ5TWFOVlwiLFxuICAgICAgICAgICAgICAgIHF1ZXJ5ID0gXCJzZWxlY3QgKiBmcm9tIG5oYW52aWVuIHdoZXJlIG1hX252ID0gOm1hTlZcIixcbiAgICAgICAgICAgICAgICByZXN1bHRDbGFzcyA9IE5oYW5WaWVuLmNsYXNzKSxcbiAgICAgICAgQE5hbWVkTmF0aXZlUXVlcnkobmFtZSA9IFwiTmhhblZpZW4uZmluZEFsbFwiLFxuICAgICAgICAgICAgICAgIHF1ZXJ5ID0gXCJzZWxlY3QgKiBmcm9tIG5oYW52aWVuXCIsXG4gICAgICAgICAgICAgICAgcmVzdWx0Q2xhc3MgPSBOaGFuVmllbi5jbGFzcylcbn0pXG5wdWJsaWMgY2xhc3MgTmhhblZpZW4gaW1wbGVtZW50cyBTZXJpYWxpemFibGUge1xuICAgIEBJZFxuICAgIEBFcXVhbHNBbmRIYXNoQ29kZS5JbmNsdWRlXG4gICAgQENvbHVtbihuYW1lID0gXCJtYV9udlwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJ2YXJjaGFyKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSwgdW5pcXVlID0gdHJ1ZSlcbiAgICBwcml2YXRlIFN0cmluZyBtYU5WOyAvLyBNw6MgbmjDom4gdmnDqm5cblxuICAgIEBDb2x1bW4obmFtZSA9IFwidGVuX252XCIsIGNvbHVtbkRlZmluaXRpb24gPSBcInZhcmNoYXIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgU3RyaW5nIHRlbk5WOyAvLyBUw6puIG5ow6JuIHZpw6puXG4gICAgQEVxdWFsc0FuZEhhc2hDb2RlLkV4Y2x1ZGVcblxuICAgIEBDb2x1bW4obmFtZSA9IFwic29fZHRcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwidmFyY2hhcigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBTdHJpbmcgc29EVDsgLy8gU+G7kSDEkWnhu4duIHRob+G6oWlcbiAgICBARXF1YWxzQW5kSGFzaENvZGUuRXhjbHVkZVxuXG4gICAgQENvbHVtbihuYW1lID0gXCJ0cmFuZ190aGFpXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcInZhcmNoYXIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgU3RyaW5nIHRyYW5nVGhhaTsgLy8gVHLhuqFuZyB0aMOhaVxuICAgIEBFcXVhbHNBbmRIYXNoQ29kZS5FeGNsdWRlXG5cbiAgICBAQ29sdW1uKG5hbWUgPSBcImNjY2RcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwidmFyY2hhcigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBTdHJpbmcgY2NjZDsgLy8gQ2jhu6luZyBjaOG7iSBjw7RuZyBkw6JuXG4gICAgQEVxdWFsc0FuZEhhc2hDb2RlLkV4Y2x1ZGVcblxuICAgIEBDb2x1bW4obmFtZSA9IFwiZGlhX2NoaVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJ2YXJjaGFyKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIFN0cmluZyBkaWFDaGk7IC8vIMSQ4buLYSBjaOG7iVxuICAgIEBFcXVhbHNBbmRIYXNoQ29kZS5FeGNsdWRlXG5cbiAgICBAQ29sdW1uKG5hbWUgPSBcIm5nYXlfdmFvX2xhbVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJkYXRlXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBMb2NhbERhdGUgbmdheVZhb0xhbTsgLy8gTmfDoHkgdsOgbyBsw6BtXG4gICAgQEVxdWFsc0FuZEhhc2hDb2RlLkV4Y2x1ZGVcblxuICAgIEBDb2x1bW4obmFtZSA9IFwiY2h1Y192dVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJ2YXJjaGFyKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIFN0cmluZyBjaHVjVnU7IC8vIENo4bupYyB24bulXG4gICAgQEVxdWFsc0FuZEhhc2hDb2RlLkV4Y2x1ZGVcblxuICAgIEBDb2x1bW4obmFtZSA9IFwiYXZhdGFcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwidmFyY2hhcigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBTdHJpbmcgYXZhdGE7IC8vIOG6om5oIMSR4bqhaSBkaeG7h25cbiAgICBARXF1YWxzQW5kSGFzaENvZGUuRXhjbHVkZVxuXG4gICAgLy8gTeG7mXQgbmjDom4gdmnDqm4gY2jhu4kgY8OzIG3hu5l0IHTDoGkga2hv4bqjblxuICAgIEBPbmVUb09uZShtYXBwZWRCeSA9IFwibmhhblZpZW5cIiwgY2FzY2FkZSA9IENhc2NhZGVUeXBlLkFMTCwgZmV0Y2ggPSBGZXRjaFR5cGUuTEFaWSlcbiAgICBAVG9TdHJpbmcuRXhjbHVkZVxuICAgIHByaXZhdGUgVGFpS2hvYW4gdGFpS2hvYW47XG5cblxuICAgIC8vIE3hu5l0IG5ow6JuIHZpw6puIGPDsyBuaGnhu4F1IGzhu4tjaCBsw6BtIHZp4buHY1xuICAgIEBPbmVUb01hbnkobWFwcGVkQnkgPSBcIm5oYW5WaWVuXCIsIGNhc2NhZGUgPSBDYXNjYWRlVHlwZS5BTEwsIG9ycGhhblJlbW92YWwgPSB0cnVlKVxuICAgIEBUb1N0cmluZy5FeGNsdWRlXG4gICAgcHJpdmF0ZSBTZXQ8TGljaExhbVZpZWM+IGRhbmhTYWNoTGljaExhbVZpZWM7XG5cbiAgICAvLyBN4buZdCBuaMOibiB2acOqbiBjw7Mgbmhp4buBdSBow7NhIMSRxqFuXG4gICAgQE9uZVRvTWFueShtYXBwZWRCeSA9IFwibnZcIiwgY2FzY2FkZSA9IENhc2NhZGVUeXBlLkFMTCwgb3JwaGFuUmVtb3ZhbCA9IHRydWUpXG4gICAgQFRvU3RyaW5nLkV4Y2x1ZGVcbiAgICBwcml2YXRlIFNldDxIb2FEb24+IGRhbmhTYWNoSG9hRG9uO1xuXG5cblxufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL21vZGVsL0xvYWlIb2FEb24uamF2YVxucGFja2FnZSBtb2RlbDtcblxuXG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS4qO1xuaW1wb3J0IGxvbWJvay5EYXRhO1xuaW1wb3J0IGxvbWJvay5FcXVhbHNBbmRIYXNoQ29kZTtcbmltcG9ydCBsb21ib2suVG9TdHJpbmc7XG5cbmltcG9ydCBqYXZhLmlvLlNlcmlhbGl6YWJsZTtcbmltcG9ydCBqYXZhLnV0aWwuU2V0O1xuXG5ARGF0YVxuQEVxdWFsc0FuZEhhc2hDb2RlKG9ubHlFeHBsaWNpdGx5SW5jbHVkZWQgPSB0cnVlKVxuQEVudGl0eVxuQFRhYmxlKG5hbWUgPSBcImxvYWlob2Fkb25cIilcbkBUb1N0cmluZ1xucHVibGljIGNsYXNzIExvYWlIb2FEb24gaW1wbGVtZW50cyBTZXJpYWxpemFibGUge1xuICAgIEBJZFxuICAgIEBDb2x1bW4obmFtZSA9IFwibWFfbG9haV9oZFwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJ2YXJjaGFyKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSwgdW5pcXVlID0gdHJ1ZSlcbiAgICBARXF1YWxzQW5kSGFzaENvZGUuSW5jbHVkZVxuICAgIHByaXZhdGUgU3RyaW5nIG1hTG9haUhvYURvbjtcbiAgICBAQ29sdW1uKG5hbWUgPSBcInRlbl9sb2FpX2hkXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcIk5WQVJDSEFSKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIFN0cmluZyB0ZW5Mb2FpSG9hRG9uO1xuXG4gICAgQE9uZVRvTWFueShtYXBwZWRCeSA9IFwibG9haUhvYURvblwiKVxuICAgIEBUb1N0cmluZy5FeGNsdWRlXG4gICAgcHJpdmF0ZSBTZXQ8SG9hRG9uPiBob2FEb25zO1xuXG5cblxuXG59XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvbW9kZWwvS2hhY2hIYW5nLmphdmFcbi4uLlxuXG5ARW50aXR5XG5ARXF1YWxzQW5kSGFzaENvZGUob25seUV4cGxpY2l0bHlJbmNsdWRlZCA9IHRydWUpXG5ARGF0YVxucHVibGljIGNsYXNzIEtoYWNoSGFuZyBpbXBsZW1lbnRzIFNlcmlhbGl6YWJsZSB7XG4gICAgQElkXG4gICAgQEVxdWFsc0FuZEhhc2hDb2RlLkluY2x1ZGVcbiAgICBAQ29sdW1uKG5hbWUgPSBcIm1hX2toYWNoX2hhbmdcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwidmFyY2hhcigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UsIHVuaXF1ZSA9IHRydWUpXG4gICAgcHJpdmF0ZSBTdHJpbmcgbWFLaGFjaEhhbmc7XG4gICAgQENvbHVtbihuYW1lID0gXCJzZHRcIiAsIGNvbHVtbkRlZmluaXRpb24gPSBcInZhcmNoYXIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgU3RyaW5nIHNvRGllblRob2FpO1xuICAgIEBDb2x1bW4obmFtZSA9IFwidGVuX2toYWNoX2hhbmdcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwidmFyY2hhcigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBTdHJpbmcgdGVuS2hhY2hIYW5nO1xuICAgIEBDb2x1bW4obmFtZSA9IFwiZ2lheV90b1wiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJ2YXJjaGFyKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIFN0cmluZyBnaWF5VG87XG4gICAgQENvbHVtbihuYW1lID0gXCJkaWFfY2hpXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcInZhcmNoYXIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgU3RyaW5nIGRpYUNoaTtcbiAgICBAQ29sdW1uKG5hbWUgPSBcImRpZW1fdGljaF9sdXlcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiZG91YmxlXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBkb3VibGUgZGllbVRpY2hMdXk7XG4gICAgQENvbHVtbihuYW1lID0gXCJuZ2F5X3NpbmhcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiZGF0ZVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgTG9jYWxEYXRlIG5nYXlTaW5oO1xuICAgIEBDb2x1bW4obmFtZSA9IFwibmdheV90aGFtX2dpYVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJkYXRlXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBMb2NhbERhdGUgbmdheVRoYW1nR2lhO1xuICAgIEBDb2x1bW4obmFtZSA9IFwiaGFuZ190aGFuaF92aWVuXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcInZhcmNoYXIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgU3RyaW5nIGhhbmdUaGFuaFZpZW47XG5cbiAgICBATWFueVRvT25lXG4gICAgQEpvaW5Db2x1bW4obmFtZSA9IFwibWFfbG9haV9raGFjaF9oYW5nXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgQFRvU3RyaW5nLkV4Y2x1ZGVcbiAgICBwcml2YXRlIExvYWlLaGFjaEhhbmcgbG9haUtoYWNoSGFuZztcblxuICAgIEBUb1N0cmluZy5FeGNsdWRlXG4gICAgQE9uZVRvTWFueShtYXBwZWRCeSA9IFwia2hhY2hIYW5nXCIpXG4gICAgcHJpdmF0ZSBTZXQ8SG9hRG9uPiBob2FEb25zO1xufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL21vZGVsL0Nob05nb2kuamF2YVxucGFja2FnZSBtb2RlbDtcblxuaW1wb3J0IGpha2FydGEucGVyc2lzdGVuY2UuKjtcbmltcG9ydCBsb21ib2suRGF0YTtcbmltcG9ydCBsb21ib2suRXF1YWxzQW5kSGFzaENvZGU7XG5pbXBvcnQgbG9tYm9rLlRvU3RyaW5nO1xuXG5pbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7XG5cbkBFbnRpdHlcbkBEYXRhXG5ARXF1YWxzQW5kSGFzaENvZGUob25seUV4cGxpY2l0bHlJbmNsdWRlZCA9IHRydWUpXG5AVGFibGUobmFtZSA9IFwiY2hvX25nb2lcIilcbnB1YmxpYyBjbGFzcyBDaG9OZ29pIGltcGxlbWVudHMgU2VyaWFsaXphYmxlIHtcbiAgICBASWRcbiAgICBARXF1YWxzQW5kSGFzaENvZGUuSW5jbHVkZVxuICAgIEBDb2x1bW4obmFtZSA9IFwibWFfY2hvXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcIlZBUkNIQVIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlLCB1bmlxdWUgPSB0cnVlKVxuICAgIHByaXZhdGUgU3RyaW5nIG1hQ2hvO1xuICAgIEBDb2x1bW4obmFtZSA9IFwidGVuX2Nob1wiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJOVkFSQ0hBUigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBTdHJpbmcgdGVuQ2hvO1xuICAgIEBDb2x1bW4obmFtZSA9IFwidGluaF90cmFuZ1wiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJCSVRcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIGJvb2xlYW4gdGluaFRyYW5nO1xuICAgIEBDb2x1bW4obmFtZSA9IFwiZ2lhX3RpZW5cIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiRkxPQVRcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIGRvdWJsZSBnaWFUaWVuO1xuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL21vZGVsL1ZlVGF1LmphdmFcbi4uLlxuXG5ARW50aXR5XG5ARGF0YVxuQEVxdWFsc0FuZEhhc2hDb2RlKG9ubHlFeHBsaWNpdGx5SW5jbHVkZWQgPSB0cnVlKVxuQFRhYmxlKG5hbWUgPSBcInZldGF1XCIpXG5wdWJsaWMgY2xhc3MgVmVUYXUgaW1wbGVtZW50cyBTZXJpYWxpemFibGUge1xuICAgIEBJZFxuICAgIEBDb2x1bW4obmFtZSA9IFwibWFfdmVcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiVkFSQ0hBUigyNTUpXCIsIHVuaXF1ZSA9IHRydWUsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBTdHJpbmcgbWFWZTtcbiAgICBAQ29sdW1uKG5hbWUgPSBcInRlbl9raGFjaF9oYW5nXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcIlZBUkNIQVIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuXG4gICAgcHJpdmF0ZSBTdHJpbmcgdGVuS2hhY2hIYW5nO1xuICAgIEBDb2x1bW4obmFtZSA9IFwiZ2lheV90b1wiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJWQVJDSEFSKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSlcblxuICAgIHByaXZhdGUgU3RyaW5nIGdpYXlUbztcbiAgICBAQ29sdW1uKG5hbWUgPSBcIm5nYXlfZGlcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiREFURVwiLG51bGxhYmxlID0gZmFsc2UpXG5cbiAgICBwcml2YXRlIExvY2FsRGF0ZSBuZ2F5RGk7XG4gICAgQENvbHVtbihuYW1lID0gXCJkb2lfdHVvbmdcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiVkFSQ0hBUigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG5cbiAgICBwcml2YXRlIFN0cmluZyBkb2lUdW9uZztcbiAgICBAQ29sdW1uKG5hbWUgPSBcImdpYV92ZVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJGTE9BVFwiLCBudWxsYWJsZSA9IGZhbHNlKVxuXG4gICAgcHJpdmF0ZSBkb3VibGUgZ2lhVmU7XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvbW9kZWwvQ2hpVGlldEhvYURvbi5qYXZhXG4uLi5cblxuQERhdGFcbkBFbnRpdHlcbkBUYWJsZShuYW1lID0gXCJjaGl0aWV0X2hvYWRvblwiKVxucHVibGljIGNsYXNzIENoaVRpZXRIb2FEb24gaW1wbGVtZW50cyBTZXJpYWxpemFibGUge1xuXG4gICAgQEVtYmVkZGVkSWRcbiAgICBwcml2YXRlIENoaVRpZXRIb2FEb25JZCBpZDtcblxuICAgIEBUb1N0cmluZy5FeGNsdWRlXG4gICAgQE1hbnlUb09uZShmZXRjaCA9IEZldGNoVHlwZS5MQVpZKVxuICAgIEBNYXBzLi4uIiwiaXNFcnJvciI6ZmFsc2UsInJlcXVlc3RJZCI6IiJ9fSwiMzQwMmVjNDktOTliNS00Mjg5LTk1ZmUtMDBmYmMzN2NlM2UxO3Rvb2x1XzAxQ2RLYVJZTUt1R2pXNWdvRXNKVTh1RCI6eyJwaGFzZSI6NSwicmVzdWx0Ijp7InRleHQiOiJUaGUgZm9sbG93aW5nIGNvZGUgc2VjdGlvbnMgd2VyZSByZXRyaWV2ZWQ6XG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9UaGFuaFRvYW5HVUkuamF2YVxuLi4uXG5cbiAgICAvLyBQYXltZW50IGZpZWxkc1xuICAgIHByaXZhdGUgSlRleHRGaWVsZCBhbW91bnRQYWlkRmllbGQ7XG4gICAgcHJpdmF0ZSBKTGFiZWwgY2hhbmdlQW1vdW50TGFiZWw7XG5cbiAgICAvLyBEYXRhXG4gICAgcHJpdmF0ZSBNYXA8U3RyaW5nLCBTdHJpbmc+IHRpY2tldHNNYXA7IC8vIE1hcCBvZiBzZWF0IElEcyB0byBzY2hlZHVsZSBJRHNcbiAgICBwcml2YXRlIENvbG9yIHByaW1hcnlDb2xvciA9IG5ldyBDb2xvcigwLCAxMzYsIDIwNCk7XG5cbiAgICAvLyBFbXBsb3llZSBpbmZvcm1hdGlvblxuICAgIHByaXZhdGUgTmhhblZpZW4gbmhhblZpZW47XG5cbiAgICAvLyBEQU9zXG4gICAgcHJpdmF0ZSBMaWNoVHJpbmhUYXVEQU8gbGljaFRyaW5oVGF1REFPO1xuICAgIHByaXZhdGUgQ2hvTmdvaURBTyBjaG9OZ29pREFPO1xuICAgIHByaXZhdGUgVG9hVGF1REFPIHRvYVRhdURBTztcbiAgICBwcml2YXRlIFRhdURBTyB0YXVEQU87XG4gICAgcHJpdmF0ZSBLaHV5ZW5NYWlEQU8ga2h1eWVuTWFpREFPO1xuICAgIHByaXZhdGUgS2hhY2hIYW5nREFPIGtoYWNoSGFuZ0RBTztcbiAgICBwcml2YXRlIGRhby5Mb2FpS2hhY2hIYW5nREFPIGxvYWlLaGFjaEhhbmdEQU87XG4gICAgcHJpdmF0ZSBWZVRhdURBTyB2ZVRhdURBTztcbiAgICBwcml2YXRlIEhvYURvbkRBTyBob2FEb25EQU87XG4gICAgcHJpdmF0ZSBDaGlUaWV0SG9hRG9uREFPIGNoaVRpZXRIb2FEb25EQU87XG4gICAgcHJpdmF0ZSBMb2FpSG9hRG9uREFPIGxvYWlIb2FEb25EQU87XG5cbiAgICAvKipcbiAgICAgKiBDb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB0aWNrZXRzTWFwIE1hcCBvZiBzZWF0IElEcyB0byBzY2hlZHVsZSBJRHNcbiAgICAgKiBAcGFyYW0gbnYgVGhlIGVtcGxveWVlIHdobyBpcyBwcm9jZXNzaW5nIHRoZSBwYXltZW50XG4gICAgICovXG4gICAgcHVibGljIFRoYW5oVG9hbkdVSShNYXA8U3RyaW5nLCBTdHJpbmc+IHRpY2tldHNNYXAsIE5oYW5WaWVuIG52KSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uIHtcbiAgICAgICAgdGhpcy50aWNrZXRzTWFwID0gdGlja2V0c01hcDtcbiAgICAgICAgdGhpcy5uaGFuVmllbiA9IG52O1xuXG4gICAgICAgIC8vIEluaXRpYWxpemUgREFPc1xuICAgICAgICBsaWNoVHJpbmhUYXVEQU8gPSBuZXcgTGljaFRyaW5oVGF1REFPSW1wbCgpO1xuICAgICAgICBjaG9OZ29pREFPID0gbmV3IENob05nb2lEQU9JbXBsKCk7XG4gICAgICAgIHRvYVRhdURBTyA9IG5ldyBUb2FUYXVEQU9JbXBsKCk7XG4gICAgICAgIHRhdURBTyA9IG5ldyBUYXVEQU9JbXBsKCk7XG4gICAgICAgIGtodXllbk1haURBTyA9IG5ldyBLaHV5ZW5NYWlEQU9JbXBsKCk7XG4gICAgICAgIGtoYWNoSGFuZ0RBTyA9IG5ldyBLaGFjaEhhbmdEQU9JbXBsKCk7XG4gICAgICAgIGxvYWlLaGFjaEhhbmdEQU8gPSBuZXcgTG9haUtoYWNoSGFuZ0RBT0ltcGwoKTtcblxuICAgICAgICBzZXRUaXRsZShcIlRoYW5oIHRvw6FuIHbDqSB0w6B1XCIpO1xuICAgICAgICBzZXRTaXplKDEwMDAsIDcwMCk7XG4gICAgICAgIHNldERlZmF1bHRDbG9zZU9wZXJhdGlvbihKRnJhbWUuRElTUE9TRV9PTl9DTE9TRSk7XG4gICAgICAgIHNldExvY2F0aW9uUmVsYXRpdmVUbyhudWxsKTtcblxuICAgICAgICBpbml0Q29tcG9uZW50cygpO1xuICAgICAgICBjYWxjdWxhdGVUb3RhbCgpO1xuICAgIH1cbi4uLlxuXG4gICAgICAgIC8vIENyZWF0ZSBzb3V0aCBwYW5lbCBmb3IgY3VzdG9tZXIgaW5mbyBhbmQgcGF5bWVudCBidXR0b25cbiAgICAgICAgSlBhbmVsIHNvdXRoUGFuZWwgPSBuZXcgSlBhbmVsKG5ldyBCb3JkZXJMYXlvdXQoMCwgMTApKTtcblxuICAgICAgICAvLyBDdXN0b21lciBpbmZvcm1hdGlvbiBzZWN0aW9uXG4gICAgICAgIEpQYW5lbCBjdXN0b21lclBhbmVsID0gY3JlYXRlQ3VzdG9tZXJJbmZvUGFuZWwoKTtcbiAgICAgICAgc291dGhQYW5lbC5hZGQoY3VzdG9tZXJQYW5lbCwgQm9yZGVyTGF5b3V0Lk5PUlRIKTtcblxuICAgICAgICAvLyBQYXltZW50IGJ1dHRvblxuICAgICAgICBKUGFuZWwgcGF5bWVudFBhbmVsID0gbmV3IEpQYW5lbChuZXcgRmxvd0xheW91dChGbG93TGF5b3V0LlJJR0hUKSk7XG4gICAgICAgIEpCdXR0b24gcGF5QnV0dG9uID0gbmV3IEpCdXR0b24oXCJUaGFuaCB0b8OhblwiKTtcbiAgICAgICAgcGF5QnV0dG9uLnNldEJhY2tncm91bmQocHJpbWFyeUNvbG9yKTtcbiAgICAgICAgcGF5QnV0dG9uLnNldEZvcmVncm91bmQoQ29sb3IuV0hJVEUpO1xuICAgICAgICBwYXlCdXR0b24uc2V0Rm9udChuZXcgRm9udChcIkFyaWFsXCIsIEZvbnQuQk9MRCwgMTQpKTtcbiAgICAgICAgcGF5QnV0dG9uLnNldFByZWZlcnJlZFNpemUobmV3IERpbWVuc2lvbigxMjAsIDM1KSk7XG4gICAgICAgIHBheUJ1dHRvbi5hZGRBY3Rpb25MaXN0ZW5lcihlIC0+IHByb2Nlc3NQYXltZW50KCkpO1xuICAgICAgICBwYXltZW50UGFuZWwuYWRkKHBheUJ1dHRvbik7XG4gICAgICAgIHNvdXRoUGFuZWwuYWRkKHBheW1lbnRQYW5lbCwgQm9yZGVyTGF5b3V0LlNPVVRIKTtcbi4uLlxuXG4gICAgICAgICAgICAvLyBHZXQgdHJhaW4gaW5mb3JtYXRpb25cbiAgICAgICAgICAgIFRhdSB0YXUgPSB0YXVEQU8uZ2V0VGF1QnlMaWNoVHJpbmhUYXUobGljaFRyaW5oKTtcbiAgICAgICAgICAgIGlmICh0YXUgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihcIktow7RuZyB0w6xtIHRo4bqleSB0aMO0bmcgdGluIHTDoHUgY2hvIGzhu4tjaCB0csOsbmg6IFwiICsgc2NoZWR1bGVJZCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZXQgc2VhdCBuYW1lL251bWJlclxuICAgICAgICAgICAgU3RyaW5nIHNlYXROYW1lID0gY2hvTmdvaS5nZXRUZW5DaG8oKSAhPSBudWxsID8gY2hvTmdvaS5nZXRUZW5DaG8oKSA6IHNlYXRJZDtcblxuICAgICAgICAgICAgLy8gR2V0IHByaWNlIGJhc2VkIG9uIHNlYXQgY2xhc3MgYW5kIHJvdXRlXG4gICAgICAgICAgICBkb3VibGUgcHJpY2UgPSBnZXRTZWF0UHJpY2UoY2hvTmdvaSwgdG9hVGF1KTtcblxuICAgICAgICAgICAgLy8gR2V0IHJvdXRlIGluZm9ybWF0aW9uXG4gICAgICAgICAgICBTdHJpbmcgZnJvbSA9IGxpY2hUcmluaC5nZXRUYXUoKS5nZXRUdXllblRhdSgpLmdldEdhRGkoKTtcbiAgICAgICAgICAgIFN0cmluZyB0byA9IGxpY2hUcmluaC5nZXRUYXUoKS5nZXRUdXllblRhdSgpLmdldEdhRGVuKCk7XG5cbiAgICAgICAgICAgIC8vIEZvcm1hdCBkYXRlIGFuZCB0aW1lXG4gICAgICAgICAgICBTdHJpbmcgZGVwYXJ0RGF0ZSA9IGxpY2hUcmluaC5nZXROZ2F5RGkoKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKFwiZGQvTU0veXl5eVwiKSk7XG4gICAgICAgICAgICBTdHJpbmcgZGVwYXJ0VGltZSA9IGxpY2hUcmluaC5nZXRHaW9EaSgpLmZvcm1hdChEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oXCJISDptbVwiKSk7XG4uLi5cblxuICAgICAgICAgICAgLy8gUGFyc2UgYW1vdW50IHBhaWQgKHJlbW92ZSBjb21tYXMgaWYgcHJlc2VudClcbiAgICAgICAgICAgIGRvdWJsZSBhbW91bnRQYWlkID0gRG91YmxlLnBhcnNlRG91YmxlKGFtb3VudFBhaWRTdHIucmVwbGFjZShcIixcIiwgXCJcIikpO1xuXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgY2hhbmdlXG4gICAgICAgICAgICBkb3VibGUgY2hhbmdlID0gYW1vdW50UGFpZCAtIHRvdGFsQW1vdW50O1xuXG4gICAgICAgICAgICAvLyBVcGRhdGUgY2hhbmdlIGFtb3VudCBsYWJlbFxuICAgICAgICAgICAgaWYgKGNoYW5nZSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgY2hhbmdlQW1vdW50TGFiZWwuc2V0VGV4dChmb3JtYXRDdXJyZW5jeShjaGFuZ2UpKTtcbiAgICAgICAgICAgICAgICBjaGFuZ2VBbW91bnRMYWJlbC5zZXRGb3JlZ3JvdW5kKG5ldyBDb2xvcigwLCAxMjgsIDApKTsgLy8gR3JlZW4gZm9yIHBvc2l0aXZlIGNoYW5nZVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjaGFuZ2VBbW91bnRMYWJlbC5zZXRUZXh0KFwiVGhp4bq/dTogXCIgKyBmb3JtYXRDdXJyZW5jeShNYXRoLmFicyhjaGFuZ2UpKSk7XG4gICAgICAgICAgICAgICAgY2hhbmdlQW1vdW50TGFiZWwuc2V0Rm9yZWdyb3VuZChDb2xvci5SRUQpOyAvLyBSZWQgZm9yIG5lZ2F0aXZlIGNoYW5nZSAoaW5zdWZmaWNpZW50IHBheW1lbnQpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKE51bWJlckZvcm1hdEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICAvLyBJbnZhbGlkIGlucHV0LCBzZXQgY2hhbmdlIHRvIDBcbiAgICAgICAgICAgIGNoYW5nZUFtb3VudExhYmVsLnNldFRleHQoXCJOaOG6rXAga2jDtG5nIGjhu6NwIGzhu4dcIik7XG4gICAgICAgICAgICBjaGFuZ2VBbW91bnRMYWJlbC5zZXRGb3JlZ3JvdW5kKENvbG9yLlJFRCk7XG4gICAgICAgIH1cbiAgICB9XG4uLi5cblxuICAgIC8qKlxuICAgICAqIFByb2Nlc3MgcGF5bWVudFxuICAgICAqL1xuICAgIHByaXZhdGUgdm9pZCBwcm9jZXNzUGF5bWVudCgpIHtcbiAgICAgICAgLy8gVmFsaWRhdGUgcmVxdWlyZWQgZmllbGRzXG4gICAgICAgIGlmIChuYW1lRmllbGQuZ2V0VGV4dCgpLnRyaW0oKS5pc0VtcHR5KCkgfHxcbiAgICAgICAgICAgICAgICBpZENhcmRGaWVsZC5nZXRUZXh0KCkudHJpbSgpLmlzRW1wdHkoKSB8fFxuICAgICAgICAgICAgICAgIHBob25lRmllbGQuZ2V0VGV4dCgpLnRyaW0oKS5pc0VtcHR5KCkpIHtcblxuICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIFwiVnVpIGzDsm5nIMSRaeG7gW4gxJHhuqd5IMSR4bunIGPDoWMgdHLGsOG7nW5nIGLhuq90IGJ14buZY1wiLFxuICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsXG4gICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0VcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBWYWxpZGF0ZSBlbWFpbCBtYXRjaCBpZiBwcm92aWRlZFxuICAgICAgICBpZiAoIWVtYWlsRmllbGQuZ2V0VGV4dCgpLnRyaW0oKS5pc0VtcHR5KCkgJiZcbiAgICAgICAgICAgICAgICAhZW1haWxGaWVsZC5nZXRUZXh0KCkuZXF1YWxzKGNvbmZpcm1FbWFpbEZpZWxkLmdldFRleHQoKSkpIHtcblxuICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIFwiRW1haWwgeMOhYyBuaOG6rW4ga2jDtG5nIGto4bubcCB24bubaSBlbWFpbCDEkcOjIG5o4bqtcFwiLFxuICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsXG4gICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0VcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbi4uLlxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBkb3VibGUgYW1vdW50UGFpZCA9IERvdWJsZS5wYXJzZURvdWJsZShhbW91bnRQYWlkRmllbGQuZ2V0VGV4dCgpLnRyaW0oKS5yZXBsYWNlKFwiLFwiLCBcIlwiKSk7XG4gICAgICAgICAgICBpZiAoYW1vdW50UGFpZCA8IHRvdGFsQW1vdW50KSB7XG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJT4buRIHRp4buBbiBraMOhY2ggxJHGsGEga2jDtG5nIMSR4bunIMSR4buDIHRoYW5oIHRvw6FuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBhbW91bnRQYWlkRmllbGQucmVxdWVzdEZvY3VzKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChOdW1iZXJGb3JtYXRFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIFwiU+G7kSB0aeG7gW4ga2jDoWNoIMSRxrBhIGtow7RuZyBo4bujcCBs4buHXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiTOG7l2lcIixcbiAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGFtb3VudFBhaWRGaWVsZC5yZXF1ZXN0Rm9jdXMoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNob3cgcGF5bWVudCBvcHRpb25zIGRpYWxvZ1xuICAgICAgICBTdHJpbmdbXSBvcHRpb25zID0ge1wiVGnhu4FuIG3hurd0XCIsIFwiVGjhursgdMOtbiBk4bulbmdcIiwgXCJDaHV54buDbiBraG/huqNuXCIsIFwiVsOtIMSRaeG7h24gdOG7rVwifTtcbiAgICAgICAgaW50IGNob2ljZSA9IEpPcHRpb25QYW5lLnNob3dPcHRpb25EaWFsb2coXG4gICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICBcIkNo4buNbiBwaMawxqFuZyB0aOG7qWMgdGhhbmggdG/DoW5cIixcbiAgICAgICAgICAgICAgICBcIlRoYW5oIHRvw6FuXCIsXG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuREVGQVVMVF9PUFRJT04sXG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuUVVFU1RJT05fTUVTU0FHRSxcbiAgICAgICAgICAgICAgICBudWxsLFxuICAgICAgICAgICAgICAgIG9wdGlvbnMsXG4gICAgICAgICAgICAgICAgb3B0aW9uc1swXVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIFByb2Nlc3MgYmFzZWQgb24gc2VsZWN0ZWQgcGF5bWVudCBtZXRob2RcbiAgICAgICAgaWYgKGNob2ljZSA+PSAwKSB7XG4gICAgICAgICAgICAvLyBTaG93IHByb2Nlc3NpbmcgbWVzc2FnZVxuICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIFwixJBhbmcgeOG7rSBsw70gdGhhbmggdG/DoW4uLi5cIixcbiAgICAgICAgICAgICAgICAgICAgXCJUaGFuaCB0b8OhblwiLFxuICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5JTkZPUk1BVElPTl9NRVNTQUdFXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIEdldCBjdXN0b21lciBpbmZvcm1hdGlvbiBmcm9tIGZvcm1cbiAgICAgICAgICAgICAgICBTdHJpbmcgY3VzdG9tZXJOYW1lID0gbmFtZUZpZWxkLmdldFRleHQoKS50cmltKCk7XG4gICAgICAgICAgICAgICAgU3RyaW5nIGlkQ2FyZCA9IGlkQ2FyZEZpZWxkLmdldFRleHQoKS50cmltKCk7XG4gICAgICAgICAgICAgICAgU3RyaW5nIHBob25lID0gcGhvbmVGaWVsZC5nZXRUZXh0KCkudHJpbSgpO1xuICAgICAgICAgICAgICAgIFN0cmluZyBlbWFpbCA9IGVtYWlsRmllbGQuZ2V0VGV4dCgpLnRyaW0oKTsgLy8gVGhpcyBpcyB0aGUgYWRkcmVzcyBmaWVsZCBhcyBwZXIgcmVxdWlyZW1lbnRzXG5cbiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiBjdXN0b21lciBleGlzdHMgYnkgSUQgY2FyZCBhbmQgcGhvbmUgbnVtYmVyXG4gICAgICAgICAgICAgICAgS2hhY2hIYW5nIGV4aXN0aW5nQ3VzdG9tZXIgPSBraGFjaEhhbmdEQU8uZmluZEJ5SWRDYXJkQW5kUGhvbmUoaWRDYXJkLCBwaG9uZSk7XG4uLi5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBDdXN0b21lciBkb2Vzbid0IGV4aXN0LCBjcmVhdGUgbmV3IGN1c3RvbWVyXG4gICAgICAgICAgICAgICAgICAgIEtoYWNoSGFuZyBuZXdDdXN0b21lciA9IG5ldyBLaGFjaEhhbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgbmV3Q3VzdG9tZXIuc2V0VGVuS2hhY2hIYW5nKGN1c3RvbWVyTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIG5ld0N1c3RvbWVyLnNldEdpYXlUbyhpZENhcmQpO1xuICAgICAgICAgICAgICAgICAgICBuZXdDdXN0b21lci5zZXRTb0RpZW5UaG9haShwaG9uZSk7XG4gICAgICAgICAgICAgICAgICAgIG5ld0N1c3RvbWVyLnNldERpYUNoaShlbWFpbCk7IC8vIEVtYWlsIGFkZHJlc3MgYXMgcGVyIHJlcXVpcmVtZW50c1xuICAgICAgICAgICAgICAgICAgICBuZXdDdXN0b21lci5zZXRIYW5nVGhhbmhWaWVuKFwiVsOjbmcgbGFpXCIpOyAvLyBEZWZhdWx0IG1lbWJlciByYW5rXG4gICAgICAgICAgICAgICAgICAgIG5ld0N1c3RvbWVyLnNldERpZW1UaWNoTHV5KDAuMCk7IC8vIEluaXRpYWwgbG95YWx0eSBwb2ludHNcbiAgICAgICAgICAgICAgICAgICAgbmV3Q3VzdG9tZXIuc2V0TmdheVNpbmgoTG9jYWxEYXRlLm5vdygpKTsgLy8gRGVmYXVsdCBiaXJ0aCBkYXRlLCBzaG91bGQgYmUgdXBkYXRlZCBsYXRlclxuICAgICAgICAgICAgICAgICAgICBuZXdDdXN0b21lci5zZXROZ2F5VGhhbWdHaWEoTG9jYWxEYXRlLm5vdygpKTsgLy8gSm9pbiBkYXRlIGlzIHRvZGF5XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gR2V0IGEgZGVmYXVsdCBjdXN0b21lciB0eXBlXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBHZXQgYWxsIGN1c3RvbWVyIHR5cGVzXG4gICAgICAgICAgICAgICAgICAgICAgICBMaXN0PExvYWlLaGFjaEhhbmc+IHR5cGVzID0gbG9haUtoYWNoSGFuZ0RBTy5nZXRBbGwoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVHJ5IHRvIGZpbmQgYSBkZWZhdWx0IGN1c3RvbWVyIHR5cGUgKGFzc3VtaW5nIFwiVGjGsOG7nW5nXCIgaXMgdGhlIGRlZmF1bHQgdHlwZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIExvYWlLaGFjaEhhbmcgZGVmYXVsdFR5cGUgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChMb2FpS2hhY2hIYW5nIHR5cGUgOiB0eXBlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChcIlRoxrDhu51uZ1wiLmVxdWFscyh0eXBlLmdldFRlbkxvYWlLaGFjaEhhbmcoKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFR5cGUgPSB0eXBlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIFwiVGjGsOG7nW5nXCIgdHlwZSBkb2Vzbid0IGV4aXN0LCB1c2UgdGhlIGZpcnN0IGF2YWlsYWJsZSB0eXBlXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGVmYXVsdFR5cGUgPT0gbnVsbCAmJiAhdHlwZXMuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFR5cGUgPSB0eXBlcy5nZXQoMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZWZhdWx0VHlwZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q3VzdG9tZXIuc2V0TG9haUtoYWNoSGFuZyhkZWZhdWx0VHlwZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oXCJLaMO0bmcgdMOsbSB0aOG6pXkgbG/huqFpIGtow6FjaCBow6BuZyBuw6BvIHRyb25nIGPGoSBz4bufIGThu68gbGnhu4d1XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2kga2hpIHTDrG0gbG/huqFpIGtow6FjaCBow6BuZzogXCIgKyBlLmdldE1lc3NhZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gQWRkIG5ldyBjdXN0b21lciB0byBkYXRhYmFzZVxuICAgICAgICAgICAgICAgICAgICBraGFjaEhhbmdEQU8uYWRkKG5ld0N1c3RvbWVyKTtcblxuICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwixJDDoyB0aMOqbSBraMOhY2ggaMOgbmcgbeG7m2kgdsOgbyBjxqEgc+G7nyBk4buvIGxp4buHdS5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlRow7RuZyBiw6FvXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBjaGFuZ2UgZm9yIGNhc2ggcGF5bWVudFxuICAgICAgICAgICAgICAgIFN0cmluZyBjaGFuZ2VNZXNzYWdlID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoY2hvaWNlID09IDApIHsgLy8gQ2FzaCBwYXltZW50XG4gICAgICAgICAgICAgICAgICAgIGRvdWJsZSBhbW91bnRQYWlkID0gRG91YmxlLnBhcnNlRG91YmxlKGFtb3VudFBhaWRGaWVsZC5nZXRUZXh0KCkudHJpbSgpLnJlcGxhY2UoXCIsXCIsIFwiXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgZG91YmxlIGNoYW5nZSA9IGFtb3VudFBhaWQgLSB0b3RhbEFtb3VudDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoYW5nZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZU1lc3NhZ2UgPSBcIlxcblRp4buBbiB0aOG7kWkgbOG6oWk6IFwiICsgZm9ybWF0Q3VycmVuY3koY2hhbmdlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFNob3cgc3VjY2VzcyBtZXNzYWdlXG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJUaGFuaCB0b8OhbiB0aMOgbmggY8O0bmchIFbDqSBj4bunYSBi4bqhbiDEkcOjIMSRxrDhu6NjIMSR4bq3dC5cIiArIGNoYW5nZU1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIlRow6BuaCBjw7RuZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICAvLyBDbG9zZSBjaGVja291dCB3aW5kb3dcbiAgICAgICAgICAgICAgICBkaXNwb3NlKCk7XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaSBraGkgeOG7rSBsw70gdGhhbmggdG/DoW46IFwiICsgZS5nZXRNZXNzYWdlKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9Eb2lWZVBhbmVsLmphdmFcbi4uLlxuICAgIHByaXZhdGUgYm9vbGVhbiB4dUx5VGhhbmhUb2FuKCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyAxLiBUw6xtIGtow6FjaCBow6BuZyB04burIG3DoyB2w6lcbiAgICAgICAgICAgIEtoYWNoSGFuZyBraGFjaEhhbmcgPSBkb2lWZURBTy5nZXRLaGFjaEhhbmdCeU1hVmUodmVUYXVIaWVuVGFpLmdldE1hVmUoKSk7XG4gICAgICAgICAgICBpZiAoa2hhY2hIYW5nID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKFwiS2jDtG5nIHTDrG0gdGjhuqV5IHRow7RuZyB0aW4ga2jDoWNoIGjDoG5nIVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIsSQw6MgdMOsbSB0aOG6pXkgS2hhY2hIYW5nOiBcIiArIGtoYWNoSGFuZy5nZXRNYUtoYWNoSGFuZygpKTtcblxuICAgICAgICAgICAgLy8gMi4gVOG6oW8gaMOzYSDEkcahbiBt4bubaVxuICAgICAgICAgICAgSG9hRG9uIGhvYURvbiA9IG5ldyBIb2FEb24oKTtcbiAgICAgICAgICAgIFN0cmluZyBtYUhEID0gZ2VuZXJhdGVNYUhEKCk7XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJHZW5lcmF0ZWQgTWFIRDogXCIgKyBtYUhEKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXRNYUhEKG1hSEQpO1xuICAgICAgICAgICAgaG9hRG9uLnNldE5nYXlMYXAoTG9jYWxEYXRlVGltZS5ub3coKSk7XG4gICAgICAgICAgICBob2FEb24uc2V0VGllbkdpYW0oZ2lhVmVCYW5EYXUgLSB2ZVRhdUhpZW5UYWkuZ2V0R2lhVmUoKSk7XG4gICAgICAgICAgICBob2FEb24uc2V0VG9uZ1RpZW4odmVUYXVIaWVuVGFpLmdldEdpYVZlKCkpO1xuICAgICAgICAgICAgaG9hRG9uLnNldEtoYWNoSGFuZyhraGFjaEhhbmcpO1xuXG4gICAgICAgICAgICAvLyBEZWJ1Z2dpbmcgdGhlIE5oYW5WaWVuIHJlZmVyZW5jZVxuICAgICAgICAgICAgaWYgKG5oYW5WaWVuUGFuZWwgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihcIkVSUk9SOiBuaGFuVmllblBhbmVsIGlzIG51bGxcIik7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbihcIlRoaeG6v3UgdGjDtG5nIHRpbiBuaMOibiB2acOqbiFcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJOaGFuVmllbiBpbmZvOiBcIiArIG5oYW5WaWVuUGFuZWwuZ2V0Q2xhc3MoKS5nZXROYW1lKCkpO1xuICAgICAgICAgICAgaG9hRG9uLnNldE52KG5oYW5WaWVuUGFuZWwpO1xuXG4gICAgICAgICAgICAvLyBHZXQgTG9haUhvYURvbiBhbmQgdmVyaWZ5IGl0IGV4aXN0c1xuICAgICAgICAgICAgTG9haUhvYURvbiBsb2FpSG9hRG9uID0gbG9haUhvYURvbkRBTy5maW5kQnlJZChcIkxIRDAwMVwiKTtcbiAgICAgICAgICAgIGlmIChsb2FpSG9hRG9uID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCJFUlJPUjogS2jDtG5nIHTDrG0gdGjhuqV5IGxv4bqhaSBow7NhIMSRxqFuIExIRDAwMVwiKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKFwiS2jDtG5nIHTDrG0gdGjhuqV5IGxv4bqhaSBow7NhIMSRxqFuIVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIkZvdW5kIExvYWlIb2FEb246IFwiICsgbG9haUhvYURvbi5nZXRNYUxvYWlIb2FEb24oKSk7XG4gICAgICAgICAgICBob2FEb24uc2V0TG9haUhvYURvbihsb2FpSG9hRG9uKTtcblxuICAgICAgICAgICAgLy8gMy4gTMawdSBow7NhIMSRxqFuXG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJBdHRlbXB0aW5nIHRvIHNhdmUgSG9hRG9uLi4uXCIpO1xuICAgICAgICAgICAgYm9vbGVhbiBzYXZlZEhvYURvbiA9IGhvYURvbkRBTy5zYXZlSG9hRG9uKGhvYURvbik7XG4gICAgICAgICAgICBpZiAoIXNhdmVkSG9hRG9uKSB7XG4gICAgICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFwiRmFpbGVkIHRvIHNhdmUgSG9hRG9uIVwiKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKFwiS2jDtG5nIHRo4buDIGzGsHUgaMOzYSDEkcahbiFcIik7XG4gICAgICAgICAgICB9XG4uLi5cblxuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFwiRXJyb3IgaW4geHVMeVRoYW5oVG9hbjogXCIgKyBlLmdldE1lc3NhZ2UoKSk7XG4gICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IFJlbW90ZUV4Y2VwdGlvbihcIkzhu5dpIGtoaSB44butIGzDvSB0aGFuaCB0b8OhbjogXCIgKyBlLmdldE1lc3NhZ2UoKSwgZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIFN0cmluZyBnZW5lcmF0ZU1hSEQoKSB7XG4gICAgICAgIC8vIEZvcm1hdDogSEQgKyB5eXl5TU1kZCArIDQgc+G7kSByYW5kb21cbiAgICAgICAgU2ltcGxlRGF0ZUZvcm1hdCBzZGYgPSBuZXcgU2ltcGxlRGF0ZUZvcm1hdChcInl5eXlNTWRkXCIpO1xuICAgICAgICBTdHJpbmcgZGF0ZVBhcnQgPSBzZGYuZm9ybWF0KG5ldyBEYXRlKCkpO1xuICAgICAgICBTdHJpbmcgcmFuZG9tUGFydCA9IFN0cmluZy5mb3JtYXQoXCIlMDRkXCIsIG5ldyBSYW5kb20oKS5uZXh0SW50KDEwMDAwKSk7XG4gICAgICAgIHJldHVybiBcIkhEXCIgKyBkYXRlUGFydCArIHJhbmRvbVBhcnQ7XG4gICAgfVxufS4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9ndWlDbGllbnQvVHJhVmVQYW5lbC5qYXZhXG4uLi5cblxuICAgICAgICAgICAgLy8gVGhp4bq/dCBs4bqtcCBjw6FjIHRow7RuZyB0aW4gaMOzYSDEkcahblxuICAgICAgICAgICAgaG9hRG9uLnNldE5nYXlMYXAoTG9jYWxEYXRlVGltZS5ub3coKSk7XG4gICAgICAgICAgICBob2FEb24uc2V0VGllbkdpYW0oMCk7IC8vIEtow7RuZyBjw7MgZ2nhuqNtIGdpw6Ega2hpIHRy4bqjIHbDqVxuICAgICAgICAgICAgaG9hRG9uLnNldFRvbmdUaWVuKHRpZW5UcmFMYWkpOyAvLyBU4buVbmcgdGnhu4FuIGzDoCBz4buRIHRp4buBbiB0cuG6oyBs4bqhaSBraMOhY2hcbiAgICAgICAgICAgIGhvYURvbi5zZXRLaGFjaEhhbmcoa2hhY2hIYW5nKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXROdihuaGFuVmllbik7IC8vIE5ow6JuIHZpw6puIMSRYW5nIMSRxINuZyBuaOG6rXBcblxuICAgICAgICAgICAgLy8gVGhp4bq/dCBs4bqtcCBsb+G6oWkgaMOzYSDEkcahbiBsw6AgXCLEkMOjIHRy4bqjXCIgKExIRDAwMilcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgTG9haUhvYURvbiBsb2FpSG9hRG9uID0gaG9hRG9uREFPLmdldExvYWlIb2FEb25CeUlkKFwiTEhEMDAyXCIpO1xuICAgICAgICAgICAgICAgIGlmIChsb2FpSG9hRG9uID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFeGNlcHRpb24oXCJLaMO0bmcgdMOsbSB0aOG6pXkgbG/huqFpIGjDs2EgxJHGoW4gTEhEMDAyXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBob2FEb24uc2V0TG9haUhvYURvbihsb2FpSG9hRG9uKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUnVudGltZUV4Y2VwdGlvbihcIkzhu5dpIGtoaSBs4bqleSB0aMO0bmcgdGluIGxv4bqhaSBow7NhIMSRxqFuOiBcIiArIGUuZ2V0TWVzc2FnZSgpKTtcbiAgICAgICAgICAgIH1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9tb2RlbC9OaGFuVmllbi5qYXZhXG5wYWNrYWdlIG1vZGVsO1xuXG5pbXBvcnQgamFrYXJ0YS5wZXJzaXN0ZW5jZS4qO1xuaW1wb3J0IGxvbWJvay4qO1xuXG5pbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7XG5pbXBvcnQgamF2YS50aW1lLkxvY2FsRGF0ZTtcbmltcG9ydCBqYXZhLnV0aWwuU2V0O1xuLyoqXG4gKiBAROG7sSDDoW46IEFwcFxuICogQENsYXNzOiBOaGFuVmllblxuICogQFThuqFvIHbDoG8gbmfDoHk6IDE1LzAxLzIwMjVcbiAqIEBUw6FjIGdp4bqjOiBOZ3V5ZW4gSHV1IFNhbmdcbiAqL1xuQERhdGFcbkBFbnRpdHlcbkBUYWJsZShuYW1lID0gXCJuaGFudmllblwiKVxuQEVxdWFsc0FuZEhhc2hDb2RlKG9ubHlFeHBsaWNpdGx5SW5jbHVkZWQgPSB0cnVlKVxuQEFsbEFyZ3NDb25zdHJ1Y3RvclxuQE5vQXJnc0NvbnN0cnVjdG9yXG5ATmFtZWROYXRpdmVRdWVyaWVzKHtcbiAgICAgICAgQE5hbWVkTmF0aXZlUXVlcnkobmFtZSA9IFwiTmhhblZpZW4uZmluZEJ5TWFOVlwiLFxuICAgICAgICAgICAgICAgIHF1ZXJ5ID0gXCJzZWxlY3QgKiBmcm9tIG5oYW52aWVuIHdoZXJlIG1hX252ID0gOm1hTlZcIixcbiAgICAgICAgICAgICAgICByZXN1bHRDbGFzcyA9IE5oYW5WaWVuLmNsYXNzKSxcbiAgICAgICAgQE5hbWVkTmF0aXZlUXVlcnkobmFtZSA9IFwiTmhhblZpZW4uZmluZEFsbFwiLFxuICAgICAgICAgICAgICAgIHF1ZXJ5ID0gXCJzZWxlY3QgKiBmcm9tIG5oYW52aWVuXCIsXG4gICAgICAgICAgICAgICAgcmVzdWx0Q2xhc3MgPSBOaGFuVmllbi5jbGFzcylcbn0pXG5wdWJsaWMgY2xhc3MgTmhhblZpZW4gaW1wbGVtZW50cyBTZXJpYWxpemFibGUge1xuICAgIEBJZFxuICAgIEBFcXVhbHNBbmRIYXNoQ29kZS5JbmNsdWRlXG4gICAgQENvbHVtbihuYW1lID0gXCJtYV9udlwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJ2YXJjaGFyKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSwgdW5pcXVlID0gdHJ1ZSlcbiAgICBwcml2YXRlIFN0cmluZyBtYU5WOyAvLyBNw6MgbmjDom4gdmnDqm5cblxuICAgIEBDb2x1bW4obmFtZSA9IFwidGVuX252XCIsIGNvbHVtbkRlZmluaXRpb24gPSBcInZhcmNoYXIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgU3RyaW5nIHRlbk5WOyAvLyBUw6puIG5ow6JuIHZpw6puXG4gICAgQEVxdWFsc0FuZEhhc2hDb2RlLkV4Y2x1ZGVcblxuICAgIEBDb2x1bW4obmFtZSA9IFwic29fZHRcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwidmFyY2hhcigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBTdHJpbmcgc29EVDsgLy8gU+G7kSDEkWnhu4duIHRob+G6oWlcbiAgICBARXF1YWxzQW5kSGFzaENvZGUuRXhjbHVkZVxuXG4gICAgQENvbHVtbihuYW1lID0gXCJ0cmFuZ190aGFpXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcInZhcmNoYXIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgU3RyaW5nIHRyYW5nVGhhaTsgLy8gVHLhuqFuZyB0aMOhaVxuICAgIEBFcXVhbHNBbmRIYXNoQ29kZS5FeGNsdWRlXG5cbiAgICBAQ29sdW1uKG5hbWUgPSBcImNjY2RcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwidmFyY2hhcigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBTdHJpbmcgY2NjZDsgLy8gQ2jhu6luZyBjaOG7iSBjw7RuZyBkw6JuXG4gICAgQEVxdWFsc0FuZEhhc2hDb2RlLkV4Y2x1ZGVcblxuICAgIEBDb2x1bW4obmFtZSA9IFwiZGlhX2NoaVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJ2YXJjaGFyKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIFN0cmluZyBkaWFDaGk7IC8vIMSQ4buLYSBjaOG7iVxuICAgIEBFcXVhbHNBbmRIYXNoQ29kZS5FeGNsdWRlXG5cbiAgICBAQ29sdW1uKG5hbWUgPSBcIm5nYXlfdmFvX2xhbVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJkYXRlXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBMb2NhbERhdGUgbmdheVZhb0xhbTsgLy8gTmfDoHkgdsOgbyBsw6BtXG4gICAgQEVxdWFsc0FuZEhhc2hDb2RlLkV4Y2x1ZGVcblxuICAgIEBDb2x1bW4obmFtZSA9IFwiY2h1Y192dVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJ2YXJjaGFyKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIFN0cmluZyBjaHVjVnU7IC8vIENo4bupYyB24bulXG4gICAgQEVxdWFsc0FuZEhhc2hDb2RlLkV4Y2x1ZGVcblxuICAgIEBDb2x1bW4obmFtZSA9IFwiYXZhdGFcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwidmFyY2hhcigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBTdHJpbmcgYXZhdGE7IC8vIOG6om5oIMSR4bqhaSBkaeG7h25cbiAgICBARXF1YWxzQW5kSGFzaENvZGUuRXhjbHVkZVxuXG4gICAgLy8gTeG7mXQgbmjDom4gdmnDqm4gY2jhu4kgY8OzIG3hu5l0IHTDoGkga2hv4bqjblxuICAgIEBPbmVUb09uZShtYXBwZWRCeSA9IFwibmhhblZpZW5cIiwgY2FzY2FkZSA9IENhc2NhZGVUeXBlLkFMTCwgZmV0Y2ggPSBGZXRjaFR5cGUuTEFaWSlcbiAgICBAVG9TdHJpbmcuRXhjbHVkZVxuICAgIHByaXZhdGUgVGFpS2hvYW4gdGFpS2hvYW47XG5cblxuICAgIC8vIE3hu5l0IG5ow6JuIHZpw6puIGPDsyBuaGnhu4F1IGzhu4tjaCBsw6BtIHZp4buHY1xuICAgIEBPbmVUb01hbnkobWFwcGVkQnkgPSBcIm5oYW5WaWVuXCIsIGNhc2NhZGUgPSBDYXNjYWRlVHlwZS5BTEwsIG9ycGhhblJlbW92YWwgPSB0cnVlKVxuICAgIEBUb1N0cmluZy5FeGNsdWRlXG4gICAgcHJpdmF0ZSBTZXQ8TGljaExhbVZpZWM+IGRhbmhTYWNoTGljaExhbVZpZWM7XG5cbiAgICAvLyBN4buZdCBuaMOibiB2acOqbiBjw7Mgbmhp4buBdSBow7NhIMSRxqFuXG4gICAgQE9uZVRvTWFueShtYXBwZWRCeSA9IFwibnZcIiwgY2FzY2FkZSA9IENhc2NhZGVUeXBlLkFMTCwgb3JwaGFuUmVtb3ZhbCA9IHRydWUpXG4gICAgQFRvU3RyaW5nLkV4Y2x1ZGVcbiAgICBwcml2YXRlIFNldDxIb2FEb24+IGRhbmhTYWNoSG9hRG9uO1xuXG5cblxufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL21vZGVsL0toYWNoSGFuZy5qYXZhXG4uLi5cblxuQEVudGl0eVxuQEVxdWFsc0FuZEhhc2hDb2RlKG9ubHlFeHBsaWNpdGx5SW5jbHVkZWQgPSB0cnVlKVxuQERhdGFcbnB1YmxpYyBjbGFzcyBLaGFjaEhhbmcgaW1wbGVtZW50cyBTZXJpYWxpemFibGUge1xuICAgIEBJZFxuICAgIEBFcXVhbHNBbmRIYXNoQ29kZS5JbmNsdWRlXG4gICAgQENvbHVtbihuYW1lID0gXCJtYV9raGFjaF9oYW5nXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcInZhcmNoYXIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlLCB1bmlxdWUgPSB0cnVlKVxuICAgIHByaXZhdGUgU3RyaW5nIG1hS2hhY2hIYW5nO1xuICAgIEBDb2x1bW4obmFtZSA9IFwic2R0XCIgLCBjb2x1bW5EZWZpbml0aW9uID0gXCJ2YXJjaGFyKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIFN0cmluZyBzb0RpZW5UaG9haTtcbiAgICBAQ29sdW1uKG5hbWUgPSBcInRlbl9raGFjaF9oYW5nXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcInZhcmNoYXIoMjU1KVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgU3RyaW5nIHRlbktoYWNoSGFuZztcbiAgICBAQ29sdW1uKG5hbWUgPSBcImdpYXlfdG9cIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwidmFyY2hhcigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UpXG4gICAgcHJpdmF0ZSBTdHJpbmcgZ2lheVRvO1xuICAgIEBDb2x1bW4obmFtZSA9IFwiZGlhX2NoaVwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJ2YXJjaGFyKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIFN0cmluZyBkaWFDaGk7XG4gICAgQENvbHVtbihuYW1lID0gXCJkaWVtX3RpY2hfbHV5XCIsIGNvbHVtbkRlZmluaXRpb24gPSBcImRvdWJsZVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgZG91YmxlIGRpZW1UaWNoTHV5O1xuICAgIEBDb2x1bW4obmFtZSA9IFwibmdheV9zaW5oXCIsIGNvbHVtbkRlZmluaXRpb24gPSBcImRhdGVcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIExvY2FsRGF0ZSBuZ2F5U2luaDtcbiAgICBAQ29sdW1uKG5hbWUgPSBcIm5nYXlfdGhhbV9naWFcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwiZGF0ZVwiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIHByaXZhdGUgTG9jYWxEYXRlIG5nYXlUaGFtZ0dpYTtcbiAgICBAQ29sdW1uKG5hbWUgPSBcImhhbmdfdGhhbmhfdmllblwiLCBjb2x1bW5EZWZpbml0aW9uID0gXCJ2YXJjaGFyKDI1NSlcIiwgbnVsbGFibGUgPSBmYWxzZSlcbiAgICBwcml2YXRlIFN0cmluZyBoYW5nVGhhbmhWaWVuO1xuXG4gICAgQE1hbnlUb09uZVxuICAgIEBKb2luQ29sdW1uKG5hbWUgPSBcIm1hX2xvYWlfa2hhY2hfaGFuZ1wiLCBudWxsYWJsZSA9IGZhbHNlKVxuICAgIEBUb1N0cmluZy5FeGNsdWRlXG4gICAgcHJpdmF0ZSBMb2FpS2hhY2hIYW5nIGxvYWlLaGFjaEhhbmc7XG5cbiAgICBAVG9TdHJpbmcuRXhjbHVkZVxuICAgIEBPbmVUb01hbnkobWFwcGVkQnkgPSBcImtoYWNoSGFuZ1wiKVxuICAgIHByaXZhdGUgU2V0PEhvYURvbj4gaG9hRG9ucztcbn1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9tb2RlbC9UYWlLaG9hbi5qYXZhXG4uLi5cblxuQERhdGFcbkBFbnRpdHlcbkBFcXVhbHNBbmRIYXNoQ29kZShvbmx5RXhwbGljaXRseUluY2x1ZGVkID0gdHJ1ZSlcbkBUYWJsZShuYW1lID0gXCJ0YWlraG9hblwiKVxucHVibGljIGNsYXNzIFRhaUtob2FuIGltcGxlbWVudHMgU2VyaWFsaXphYmxlIHtcbiAgICBASWRcbiAgICBARXF1YWxzQW5kSGFzaENvZGUuSW5jbHVkZVxuICAgIEBDb2x1bW4obmFtZSA9IFwibWFfbnZcIiwgY29sdW1uRGVmaW5pdGlvbiA9IFwidmFyY2hhcigyNTUpXCIsIG51bGxhYmxlID0gZmFsc2UsIHVuaXF1ZSA9IHRydWUpXG4gICAgcHJpdmF0ZSBTdHJpbmcgbWFOVjsgLy8gTcOjIHTDoGkga2hv4bqjblxuXG4gICAgQENvbHVtbihuYW1lID0gXCIuLi4iLCJpc0Vycm9yIjpmYWxzZSwicmVxdWVzdElkIjoiIn19LCIxZDI3ZWUzYy1mZTUzLTRiYzMtYjM2Ny0wYmI5MDFiMWM5N2U7dG9vbHVfMDFOV2hqa0U4elZETTNxc0JoMzluSlBBIjp7InBoYXNlIjo1LCJyZXN1bHQiOnsidGV4dCI6IlRoZSBmb2xsb3dpbmcgY29kZSBzZWN0aW9ucyB3ZXJlIHJldHJpZXZlZDpcblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZ3VpQ2xpZW50L0RvaVZlUGFuZWwuamF2YVxuLi4uXG5cbiAgICAgICAgICAgICAgICAgICAgU3RyaW5nIHZucF9TZWN1cmVIYXNoID0gaG1hY1NIQTUxMihcIllPVVJfU0VDUkVUX0tFWVwiLCBoYXNoRGF0YS50b1N0cmluZygpKTtcbiAgICAgICAgICAgICAgICAgICAgcXVlcnkuYXBwZW5kKFwiJnZucF9TZWN1cmVIYXNoPVwiKS5hcHBlbmQodm5wX1NlY3VyZUhhc2gpO1xuXG4gICAgICAgICAgICAgICAgICAgIFN0cmluZyBwYXltZW50VXJsID0gYXBpVXJsICsgXCI/XCIgKyBxdWVyeS50b1N0cmluZygpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFRyb25nIG3DtGkgdHLGsOG7nW5nIHRo4buxYyB04bq/LCBi4bqhbiBz4bq9IGfhu41pIEFQSSBWTlBheSDEkeG7gyBs4bqleSBVUkwgaG/hurdjIGThu68gbGnhu4d1IFFSXG4gICAgICAgICAgICAgICAgICAgIC8vIOG7niDEkcOieSwgY2jDum5nIHRhIHPhur0gdOG6oW8gbcOjIFFSIHThu6sgVVJMIHRoYW5oIHRvw6FuXG4gICAgICAgICAgICAgICAgICAgIC8vIEzGsHUgdGjDtG5nIHRpbiBuw6B5IMSR4buDIHRyYSBj4bupdSB0cuG6oW5nIHRow6FpIHRoYW5oIHRvw6FuIHNhdSBuw6B5XG4gICAgICAgICAgICAgICAgICAgIHNhdmVWbnBheVRyYW5zYWN0aW9uKHZucF9UeG5SZWYsIG1hVmUsIGFtb3VudCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gVOG6oW8gUVIgY29kZSB04burIFVSTCB0aGFuaCB0b8OhblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2VuZXJhdGVRUkNvZGVJbWFnZShwYXltZW50VXJsLCAyMDAsIDIwMCk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuLi4uXG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCLEkMOjIHTDrG0gdGjhuqV5IEtoYWNoSGFuZzogXCIgKyBraGFjaEhhbmcuZ2V0TWFLaGFjaEhhbmcoKSk7XG5cbiAgICAgICAgICAgIC8vIDIuIFThuqFvIGjDs2EgxJHGoW4gbeG7m2lcbiAgICAgICAgICAgIEhvYURvbiBob2FEb24gPSBuZXcgSG9hRG9uKCk7XG4gICAgICAgICAgICBTdHJpbmcgbWFIRCA9IGdlbmVyYXRlTWFIRCgpO1xuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiR2VuZXJhdGVkIE1hSEQ6IFwiICsgbWFIRCk7XG4gICAgICAgICAgICBob2FEb24uc2V0TWFIRChtYUhEKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXROZ2F5TGFwKExvY2FsRGF0ZVRpbWUubm93KCkpO1xuICAgICAgICAgICAgaG9hRG9uLnNldFRpZW5HaWFtKGdpYVZlQmFuRGF1IC0gdmVUYXVIaWVuVGFpLmdldEdpYVZlKCkpO1xuICAgICAgICAgICAgaG9hRG9uLnNldFRvbmdUaWVuKHZlVGF1SGllblRhaS5nZXRHaWFWZSgpKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXRLaGFjaEhhbmcoa2hhY2hIYW5nKTtcblxuICAgICAgICAgICAgLy8gRGVidWdnaW5nIHRoZSBOaGFuVmllbiByZWZlcmVuY2VcbiAgICAgICAgICAgIGlmIChuaGFuVmllblBhbmVsID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCJFUlJPUjogbmhhblZpZW5QYW5lbCBpcyBudWxsXCIpO1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oXCJUaGnhur91IHRow7RuZyB0aW4gbmjDom4gdmnDqm4hXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiTmhhblZpZW4gaW5mbzogXCIgKyBuaGFuVmllblBhbmVsLmdldENsYXNzKCkuZ2V0TmFtZSgpKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXROdihuaGFuVmllblBhbmVsKTtcblxuICAgICAgICAgICAgLy8gR2V0IExvYWlIb2FEb24gYW5kIHZlcmlmeSBpdCBleGlzdHNcbiAgICAgICAgICAgIExvYWlIb2FEb24gbG9haUhvYURvbiA9IGxvYWlIb2FEb25EQU8uZmluZEJ5SWQoXCJMSEQwMDFcIik7XG4gICAgICAgICAgICBpZiAobG9haUhvYURvbiA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFwiRVJST1I6IEtow7RuZyB0w6xtIHRo4bqleSBsb+G6oWkgaMOzYSDEkcahbiBMSEQwMDFcIik7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbihcIktow7RuZyB0w6xtIHRo4bqleSBsb+G6oWkgaMOzYSDEkcahbiFcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJGb3VuZCBMb2FpSG9hRG9uOiBcIiArIGxvYWlIb2FEb24uZ2V0TWFMb2FpSG9hRG9uKCkpO1xuICAgICAgICAgICAgaG9hRG9uLnNldExvYWlIb2FEb24obG9haUhvYURvbik7XG5cbiAgICAgICAgICAgIC8vIDMuIEzGsHUgaMOzYSDEkcahblxuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiQXR0ZW1wdGluZyB0byBzYXZlIEhvYURvbi4uLlwiKTtcbiAgICAgICAgICAgIGJvb2xlYW4gc2F2ZWRIb2FEb24gPSBob2FEb25EQU8uc2F2ZUhvYURvbihob2FEb24pO1xuICAgICAgICAgICAgaWYgKCFzYXZlZEhvYURvbikge1xuICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihcIkZhaWxlZCB0byBzYXZlIEhvYURvbiFcIik7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbihcIktow7RuZyB0aOG7gyBsxrB1IGjDs2EgxJHGoW4hXCIpO1xuICAgICAgICAgICAgfVxuLi4uXG5cbiAgICAgICAgICAgIGNoaVRpZXRIb2FEb24uc2V0VGhhbmhUaWVuKHRoYW5oVGllbik7XG4gICAgICAgICAgICBjaGlUaWV0SG9hRG9uLnNldFRpZW5UaHVlKHRpZW5UaHVlKTtcblxuICAgICAgICAgICAgLy8gNS4gTMawdSBjaGkgdGnhur90IGjDs2EgxJHGoW5cbiAgICAgICAgICAgIGJvb2xlYW4gc2F2ZWRDaGlUaWV0ID0gY2hpVGlldEhvYURvbkRBTy5zYXZlKGNoaVRpZXRIb2FEb24pO1xuICAgICAgICAgICAgaWYgKCFzYXZlZENoaVRpZXQpIHtcbiAgICAgICAgICAgICAgICAvLyBYw7NhIGjDs2EgxJHGoW4gxJHDoyB04bqhbyBu4bq/dSBraMO0bmcgdGjhu4MgbMawdSBjaGkgdGnhur90XG4gICAgICAgICAgICAgICAgLy8gaG9hRG9uREFPLmRlbGV0ZShtYUhEKTsgLy8gR2nhuqMgxJHhu4tuaCBjw7MgcGjGsMahbmcgdGjhu6ljIGRlbGV0ZVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oXCJLaMO0bmcgdGjhu4MgbMawdSBjaGkgdGnhur90IGjDs2EgxJHGoW4hXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCLEkMOjIHTDrG0gdGjhuqV5IEtoYWNoSGFuZzogXCIgKyBraGFjaEhhbmcuZ2V0TWFLaGFjaEhhbmcoKSk7XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJHZW5lcmF0ZWQgTWFIRDogXCIgKyBtYUhEKTtcbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIk5oYW5WaWVuIGluZm86IFwiICsgbmhhblZpZW5QYW5lbC5nZXRDbGFzcygpLmdldE5hbWUoKSk7XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJGb3VuZCBMb2FpSG9hRG9uOiBcIiArIGxvYWlIb2FEb24uZ2V0TWFMb2FpSG9hRG9uKCkpO1xuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiSG9hRG9uIHNhdmVkIHN1Y2Nlc3NmdWxseSFcIik7XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJDaGlUaWV0SG9hRG9uIHNhdmVkIHN1Y2Nlc3NmdWxseSFcIik7XG5cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuXG4gICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCJFcnJvciBpbiB4dUx5VGhhbmhUb2FuOiBcIiArIGUuZ2V0TWVzc2FnZSgpKTtcbiAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgICAgICB0aHJvdyBuZXcgUmVtb3RlRXhjZXB0aW9uKFwiTOG7l2kga2hpIHjhu60gbMO9IHRoYW5oIHRvw6FuOiBcIiArIGUuZ2V0TWVzc2FnZSgpLCBlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgU3RyaW5nIGdlbmVyYXRlTWFIRCgpIHtcbiAgICAgICAgLy8gRm9ybWF0OiBIRCArIHl5eXlNTWRkICsgNCBz4buRIHJhbmRvbVxuICAgICAgICBTaW1wbGVEYXRlRm9ybWF0IHNkZiA9IG5ldyBTaW1wbGVEYXRlRm9ybWF0KFwieXl5eU1NZGRcIik7XG4gICAgICAgIFN0cmluZyBkYXRlUGFydCA9IHNkZi5mb3JtYXQobmV3IERhdGUoKSk7XG4gICAgICAgIFN0cmluZyByYW5kb21QYXJ0ID0gU3RyaW5nLmZvcm1hdChcIiUwNGRcIiwgbmV3IFJhbmRvbSgpLm5leHRJbnQoMTAwMDApKTtcbiAgICAgICAgcmV0dXJuIFwiSERcIiArIGRhdGVQYXJ0ICsgcmFuZG9tUGFydDtcbiAgICB9XG59Li4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9UaGFuaFRvYW5HVUkuamF2YVxuLi4uXG5cbiAgICAvLyBQYXltZW50IGZpZWxkc1xuICAgIHByaXZhdGUgSlRleHRGaWVsZCBhbW91bnRQYWlkRmllbGQ7XG4gICAgcHJpdmF0ZSBKTGFiZWwgY2hhbmdlQW1vdW50TGFiZWw7XG5cbiAgICAvLyBEYXRhXG4gICAgcHJpdmF0ZSBNYXA8U3RyaW5nLCBTdHJpbmc+IHRpY2tldHNNYXA7IC8vIE1hcCBvZiBzZWF0IElEcyB0byBzY2hlZHVsZSBJRHNcbiAgICBwcml2YXRlIENvbG9yIHByaW1hcnlDb2xvciA9IG5ldyBDb2xvcigwLCAxMzYsIDIwNCk7XG5cbiAgICAvLyBFbXBsb3llZSBpbmZvcm1hdGlvblxuICAgIHByaXZhdGUgTmhhblZpZW4gbmhhblZpZW47XG5cbiAgICAvLyBEQU9zXG4gICAgcHJpdmF0ZSBMaWNoVHJpbmhUYXVEQU8gbGljaFRyaW5oVGF1REFPO1xuICAgIHByaXZhdGUgQ2hvTmdvaURBTyBjaG9OZ29pREFPO1xuICAgIHByaXZhdGUgVG9hVGF1REFPIHRvYVRhdURBTztcbiAgICBwcml2YXRlIFRhdURBTyB0YXVEQU87XG4gICAgcHJpdmF0ZSBLaHV5ZW5NYWlEQU8ga2h1eWVuTWFpREFPO1xuICAgIHByaXZhdGUgS2hhY2hIYW5nREFPIGtoYWNoSGFuZ0RBTztcbiAgICBwcml2YXRlIGRhby5Mb2FpS2hhY2hIYW5nREFPIGxvYWlLaGFjaEhhbmdEQU87XG4gICAgcHJpdmF0ZSBWZVRhdURBTyB2ZVRhdURBTztcbiAgICBwcml2YXRlIEhvYURvbkRBTyBob2FEb25EQU87XG4gICAgcHJpdmF0ZSBDaGlUaWV0SG9hRG9uREFPIGNoaVRpZXRIb2FEb25EQU87XG4gICAgcHJpdmF0ZSBMb2FpSG9hRG9uREFPIGxvYWlIb2FEb25EQU87XG4uLi5cblxuICAgICAgICAvLyBDcmVhdGUgc291dGggcGFuZWwgZm9yIGN1c3RvbWVyIGluZm8gYW5kIHBheW1lbnQgYnV0dG9uXG4gICAgICAgIEpQYW5lbCBzb3V0aFBhbmVsID0gbmV3IEpQYW5lbChuZXcgQm9yZGVyTGF5b3V0KDAsIDEwKSk7XG5cbiAgICAgICAgLy8gQ3VzdG9tZXIgaW5mb3JtYXRpb24gc2VjdGlvblxuICAgICAgICBKUGFuZWwgY3VzdG9tZXJQYW5lbCA9IGNyZWF0ZUN1c3RvbWVySW5mb1BhbmVsKCk7XG4gICAgICAgIHNvdXRoUGFuZWwuYWRkKGN1c3RvbWVyUGFuZWwsIEJvcmRlckxheW91dC5OT1JUSCk7XG5cbiAgICAgICAgLy8gUGF5bWVudCBidXR0b25cbiAgICAgICAgSlBhbmVsIHBheW1lbnRQYW5lbCA9IG5ldyBKUGFuZWwobmV3IEZsb3dMYXlvdXQoRmxvd0xheW91dC5SSUdIVCkpO1xuICAgICAgICBKQnV0dG9uIHBheUJ1dHRvbiA9IG5ldyBKQnV0dG9uKFwiVGhhbmggdG/DoW5cIik7XG4gICAgICAgIHBheUJ1dHRvbi5zZXRCYWNrZ3JvdW5kKHByaW1hcnlDb2xvcik7XG4gICAgICAgIHBheUJ1dHRvbi5zZXRGb3JlZ3JvdW5kKENvbG9yLldISVRFKTtcbiAgICAgICAgcGF5QnV0dG9uLnNldEZvbnQobmV3IEZvbnQoXCJBcmlhbFwiLCBGb250LkJPTEQsIDE0KSk7XG4gICAgICAgIHBheUJ1dHRvbi5zZXRQcmVmZXJyZWRTaXplKG5ldyBEaW1lbnNpb24oMTIwLCAzNSkpO1xuICAgICAgICBwYXlCdXR0b24uYWRkQWN0aW9uTGlzdGVuZXIoZSAtPiBwcm9jZXNzUGF5bWVudCgpKTtcbiAgICAgICAgcGF5bWVudFBhbmVsLmFkZChwYXlCdXR0b24pO1xuICAgICAgICBzb3V0aFBhbmVsLmFkZChwYXltZW50UGFuZWwsIEJvcmRlckxheW91dC5TT1VUSCk7XG4uLi5cblxuICAgICAgICAgICAgLy8gRm9ybWF0IHByaWNlXG4gICAgICAgICAgICBTdHJpbmcgcHJpY2VTdHIgPSBmb3JtYXRDdXJyZW5jeShwcmljZSk7XG5cbiAgICAgICAgICAgIC8vIFZBVCBjYWxjdWxhdGlvbiAoZml4ZWQgYXQgMTAlKVxuICAgICAgICAgICAgU3RyaW5nIHZhdFN0ciA9IFwiMTAlXCI7XG5cbiAgICAgICAgICAgIC8vIFBhc3NlbmdlciB0eXBlIGRpc2NvdW50IChlbXB0eSBmb3Igbm93KVxuICAgICAgICAgICAgU3RyaW5nIHByb21vdGlvbiA9IFwiXCI7XG5cbiAgICAgICAgICAgIC8vIFByb21vdGlvbiBkaXNjb3VudCAoZW1wdHkgZm9yIG5vdylcbiAgICAgICAgICAgIFN0cmluZyBwcm9tb3Rpb25EaXNjb3VudFN0ciA9IFwiMFwiO1xuXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgdG90YWwgKHByaWNlICsgVkFUKVxuICAgICAgICAgICAgZG91YmxlIHRvdGFsRm9yVGlja2V0ID0gcHJpY2UgKyAocHJpY2UgKiAwLjEpO1xuICAgICAgICAgICAgU3RyaW5nIHRvdGFsU3RyID0gZm9ybWF0Q3VycmVuY3kodG90YWxGb3JUaWNrZXQpO1xuXG4gICAgICAgICAgICAvLyBDcmVhdGUgcGFzc2VuZ2VyIGluZm8gY29tcG9uZW50IC0gd2lsbCBiZSByZXBsYWNlZCBieSB0aGUgY3VzdG9tIHJlbmRlcmVyXG4gICAgICAgICAgICBQYXNzZW5nZXJJbmZvIHBhc3NlbmdlckluZm8gPSBuZXcgUGFzc2VuZ2VySW5mbygpO1xuXG4gICAgICAgICAgICAvLyBBZGQgcm93IHRvIHRhYmxlXG4gICAgICAgICAgICB0YWJsZU1vZGVsLmFkZFJvdyhuZXcgT2JqZWN0W10ge1xuICAgICAgICAgICAgICAgICAgICBwYXNzZW5nZXJJbmZvLCBzZWF0SW5mbywgcHJpY2VTdHIsIHZhdFN0cixcbiAgICAgICAgICAgICAgICAgICAgcHJvbW90aW9uLCBwcm9tb3Rpb25EaXNjb3VudFN0ciwgdG90YWxTdHIsIFwiWFwiXG4gICAgICAgICAgICB9KTtcbi4uLlxuXG4gICAgLyoqXG4gICAgICogQ2FsY3VsYXRlIGNoYW5nZSBiYXNlZCBvbiBhbW91bnQgcGFpZCBhbmQgdG90YWwgYW1vdW50XG4gICAgICovXG4gICAgcHJpdmF0ZSB2b2lkIGNhbGN1bGF0ZUNoYW5nZSgpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEdldCBhbW91bnQgcGFpZCBmcm9tIHRleHQgZmllbGRcbiAgICAgICAgICAgIFN0cmluZyBhbW91bnRQYWlkU3RyID0gYW1vdW50UGFpZEZpZWxkLmdldFRleHQoKS50cmltKCk7XG4gICAgICAgICAgICBpZiAoYW1vdW50UGFpZFN0ci5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgICAgICBjaGFuZ2VBbW91bnRMYWJlbC5zZXRUZXh0KFwiMFwiKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFBhcnNlIGFtb3VudCBwYWlkIChyZW1vdmUgY29tbWFzIGlmIHByZXNlbnQpXG4gICAgICAgICAgICBkb3VibGUgYW1vdW50UGFpZCA9IERvdWJsZS5wYXJzZURvdWJsZShhbW91bnRQYWlkU3RyLnJlcGxhY2UoXCIsXCIsIFwiXCIpKTtcblxuICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIGNoYW5nZVxuICAgICAgICAgICAgZG91YmxlIGNoYW5nZSA9IGFtb3VudFBhaWQgLSB0b3RhbEFtb3VudDtcblxuICAgICAgICAgICAgLy8gVXBkYXRlIGNoYW5nZSBhbW91bnQgbGFiZWxcbiAgICAgICAgICAgIGlmIChjaGFuZ2UgPj0gMCkge1xuICAgICAgICAgICAgICAgIGNoYW5nZUFtb3VudExhYmVsLnNldFRleHQoZm9ybWF0Q3VycmVuY3koY2hhbmdlKSk7XG4gICAgICAgICAgICAgICAgY2hhbmdlQW1vdW50TGFiZWwuc2V0Rm9yZWdyb3VuZChuZXcgQ29sb3IoMCwgMTI4LCAwKSk7IC8vIEdyZWVuIGZvciBwb3NpdGl2ZSBjaGFuZ2VcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY2hhbmdlQW1vdW50TGFiZWwuc2V0VGV4dChcIlRoaeG6v3U6IFwiICsgZm9ybWF0Q3VycmVuY3koTWF0aC5hYnMoY2hhbmdlKSkpO1xuICAgICAgICAgICAgICAgIGNoYW5nZUFtb3VudExhYmVsLnNldEZvcmVncm91bmQoQ29sb3IuUkVEKTsgLy8gUmVkIGZvciBuZWdhdGl2ZSBjaGFuZ2UgKGluc3VmZmljaWVudCBwYXltZW50KVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChOdW1iZXJGb3JtYXRFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgLy8gSW52YWxpZCBpbnB1dCwgc2V0IGNoYW5nZSB0byAwXG4gICAgICAgICAgICBjaGFuZ2VBbW91bnRMYWJlbC5zZXRUZXh0KFwiTmjhuq1wIGtow7RuZyBo4bujcCBs4buHXCIpO1xuICAgICAgICAgICAgY2hhbmdlQW1vdW50TGFiZWwuc2V0Rm9yZWdyb3VuZChDb2xvci5SRUQpO1xuICAgICAgICB9XG4gICAgfVxuLi4uXG5cbiAgICAgICAgICAgIC8vIENhbGN1bGF0ZSB0aWNrZXQgdG90YWw6IGJhc2UgcHJpY2UgKyBWQVQgLSBwYXNzZW5nZXIgZGlzY291bnQgLSBwcm9tb3Rpb24gZGlzY291bnRcbiAgICAgICAgICAgIGRvdWJsZSB0aWNrZXRUb3RhbCA9IGJhc2VQcmljZSArIHZhdCAtIHBhc3NlbmdlckRpc2NvdW50QW1vdW50IC0gcHJvbW90aW9uRGlzY291bnQ7XG5cbiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgcm93IHdpdGggbmV3IHZhbHVlc1xuICAgICAgICAgICAgU3RyaW5nIGRpc2NvdW50U3RyID0gcGFzc2VuZ2VyRGlzY291bnRBbW91bnQgPiAwID9cbiAgICAgICAgICAgICAgICAgICAgU3RyaW5nLmZvcm1hdChcIi0lcyAoJXMlJSlcIiwgZm9ybWF0Q3VycmVuY3kocGFzc2VuZ2VyRGlzY291bnRBbW91bnQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChpbnQpKGRpc2NvdW50UGVyY2VudGFnZSAqIDEwMCkpIDogXCJcIjtcblxuICAgICAgICAgICAgdGFibGVNb2RlbC5zZXRWYWx1ZUF0KGRpc2NvdW50U3RyLCBpLCA0KTsgLy8gVXBkYXRlIHBhc3NlbmdlciBkaXNjb3VudCBjb2x1bW5cbiAgICAgICAgICAgIHRhYmxlTW9kZWwuc2V0VmFsdWVBdChmb3JtYXRDdXJyZW5jeSh0aWNrZXRUb3RhbCksIGksIDYpOyAvLyBVcGRhdGUgdG90YWwgY29sdW1uXG5cbiAgICAgICAgICAgIHRvdGFsQW1vdW50ICs9IHRpY2tldFRvdGFsO1xuICAgICAgICB9XG5cbiAgICAgICAgdG90YWxBbW91bnRMYWJlbC5zZXRUZXh0KGZvcm1hdEN1cnJlbmN5KHRvdGFsQW1vdW50KSk7XG5cbiAgICAgICAgLy8gVXBkYXRlIGNvbmZpcm1hdGlvbiB0ZXh0IGFyZWEgd2l0aCB0aWNrZXQgaW5mb3JtYXRpb25cbiAgICAgICAgdXBkYXRlQ29uZmlybWF0aW9uVGV4dCgpO1xuXG4gICAgICAgIC8vIFJlc2V0IGNoYW5nZSBjYWxjdWxhdGlvblxuICAgICAgICBpZiAoYW1vdW50UGFpZEZpZWxkICE9IG51bGwpIHtcbiAgICAgICAgICAgIGNhbGN1bGF0ZUNoYW5nZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlIGFsbCB0aWNrZXRzXG4gICAgICovXG4gICAgcHJpdmF0ZSB2b2lkIHJlbW92ZUFsbFRpY2tldHMoKSB7XG4gICAgICAgIGludCBjb25maXJtID0gSk9wdGlvblBhbmUuc2hvd0NvbmZpcm1EaWFsb2coXG4gICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICBcIkLhuqFuIGPDsyBjaOG6r2MgbXXhu5FuIHjDs2EgdOG6pXQgY+G6oyB2w6k/XCIsXG4gICAgICAgICAgICAgICAgXCJYw6FjIG5o4bqtblwiLFxuICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLllFU19OT19PUFRJT05cbiAgICAgICAgKTtcblxuICAgICAgICBpZiAoY29uZmlybSA9PSBKT3B0aW9uUGFuZS5ZRVNfT1BUSU9OKSB7XG4gICAgICAgICAgICB0YWJsZU1vZGVsLnNldFJvd0NvdW50KDApO1xuICAgICAgICAgICAgdGlja2V0c01hcC5jbGVhcigpO1xuICAgICAgICAgICAgY2FsY3VsYXRlVG90YWwoKTtcbiAgICAgICAgfVxuICAgIH1cbi4uLlxuXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgcHJvbW90aW9uIGRpc2NvdW50IGFtb3VudFxuICAgICAgICAgICAgZG91YmxlIGRpc2NvdW50QW1vdW50ID0gYmFzZVByaWNlICogZGlzY291bnRQZXJjZW50YWdlO1xuXG4gICAgICAgICAgICAvLyBGb3JtYXQgdGhlIGRpc2NvdW50IGFtb3VudCBhcyBhIG5lZ2F0aXZlIG51bWJlciB0byBpbmRpY2F0ZSBpdCdzIGEgZGlzY291bnRcbiAgICAgICAgICAgIFN0cmluZyBkaXNjb3VudFN0ciA9IFwiLVwiICsgZm9ybWF0Q3VycmVuY3koZGlzY291bnRBbW91bnQpO1xuXG4gICAgICAgICAgICAvLyBSZXBsYWNlIHRoZSBpbnN1cmFuY2UgYW1vdW50IHdpdGggdGhlIHByb21vdGlvbiBkaXNjb3VudFxuICAgICAgICAgICAgdGFibGVNb2RlbC5zZXRWYWx1ZUF0KGRpc2NvdW50U3RyLCBpLCA1KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNob3cgc3VjY2VzcyBtZXNzYWdlXG4gICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgXCLEkMOjIMOhcCBk4bulbmcga2h1eeG6v24gbcOjaTogXCIgKyBzZWxlY3RlZFByb21vdGlvbi5nZXRUZW5LTSgpLFxuICAgICAgICAgICAgICAgIFwiVGjDtG5nIGLDoW9cIixcbiAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5JTkZPUk1BVElPTl9NRVNTQUdFXG4gICAgICAgICk7XG5cbiAgICAgICAgLy8gUmVjYWxjdWxhdGUgdG90YWwgd2l0aCBwcm9tb3Rpb25cbiAgICAgICAgY2FsY3VsYXRlVG90YWwoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcm9jZXNzIHBheW1lbnRcbiAgICAgKi9cbiAgICBwcml2YXRlIHZvaWQgcHJvY2Vzc1BheW1lbnQoKSB7XG4gICAgICAgIC8vIFZhbGlkYXRlIHJlcXVpcmVkIGZpZWxkc1xuICAgICAgICBpZiAobmFtZUZpZWxkLmdldFRleHQoKS50cmltKCkuaXNFbXB0eSgpIHx8XG4gICAgICAgICAgICAgICAgaWRDYXJkRmllbGQuZ2V0VGV4dCgpLnRyaW0oKS5pc0VtcHR5KCkgfHxcbiAgICAgICAgICAgICAgICBwaG9uZUZpZWxkLmdldFRleHQoKS50cmltKCkuaXNFbXB0eSgpKSB7XG5cbiAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBcIlZ1aSBsw7JuZyDEkWnhu4FuIMSR4bqneSDEkeG7pyBjw6FjIHRyxrDhu51uZyBi4bqvdCBideG7mWNcIixcbiAgICAgICAgICAgICAgICAgICAgXCJM4buXaVwiLFxuICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVmFsaWRhdGUgZW1haWwgbWF0Y2ggaWYgcHJvdmlkZWRcbiAgICAgICAgaWYgKCFlbWFpbEZpZWxkLmdldFRleHQoKS50cmltKCkuaXNFbXB0eSgpICYmXG4gICAgICAgICAgICAgICAgIWVtYWlsRmllbGQuZ2V0VGV4dCgpLmVxdWFscyhjb25maXJtRW1haWxGaWVsZC5nZXRUZXh0KCkpKSB7XG5cbiAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBcIkVtYWlsIHjDoWMgbmjhuq1uIGtow7RuZyBraOG7m3AgduG7m2kgZW1haWwgxJHDoyBuaOG6rXBcIixcbiAgICAgICAgICAgICAgICAgICAgXCJM4buXaVwiLFxuICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4uLi5cblxuICAgICAgICBpZiAobWlzc2luZ1Bhc3NlbmdlckluZm8pIHtcbiAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBcIlZ1aSBsw7JuZyDEkWnhu4FuIMSR4bqneSDEkeG7pyB0aMO0bmcgdGluIGjDoG5oIGtow6FjaCBjaG8gdOG6pXQgY+G6oyBjw6FjIHbDqVwiLFxuICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsXG4gICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0VcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaW52YWxpZENoaWxkQWdlKSB7XG4gICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgXCLEkOG7kWkgdMaw4bujbmcgJ1Ry4bq7IGVtJyBwaOG6o2kgY8OzIHR14buVaSB04burIDEtOVwiLFxuICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsXG4gICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0VcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayBpZiBhbW91bnQgcGFpZCBpcyBzdWZmaWNpZW50XG4gICAgICAgIGlmIChhbW91bnRQYWlkRmllbGQuZ2V0VGV4dCgpLnRyaW0oKS5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBcIlZ1aSBsw7JuZyBuaOG6rXAgc+G7kSB0aeG7gW4ga2jDoWNoIMSRxrBhXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiTOG7l2lcIixcbiAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGFtb3VudFBhaWRGaWVsZC5yZXF1ZXN0Rm9jdXMoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBkb3VibGUgYW1vdW50UGFpZCA9IERvdWJsZS5wYXJzZURvdWJsZShhbW91bnRQYWlkRmllbGQuZ2V0VGV4dCgpLnRyaW0oKS5yZXBsYWNlKFwiLFwiLCBcIlwiKSk7XG4gICAgICAgICAgICBpZiAoYW1vdW50UGFpZCA8IHRvdGFsQW1vdW50KSB7XG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJT4buRIHRp4buBbiBraMOhY2ggxJHGsGEga2jDtG5nIMSR4bunIMSR4buDIHRoYW5oIHRvw6FuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBhbW91bnRQYWlkRmllbGQucmVxdWVzdEZvY3VzKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChOdW1iZXJGb3JtYXRFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIFwiU+G7kSB0aeG7gW4ga2jDoWNoIMSRxrBhIGtow7RuZyBo4bujcCBs4buHXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiTOG7l2lcIixcbiAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGFtb3VudFBhaWRGaWVsZC5yZXF1ZXN0Rm9jdXMoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNob3cgcGF5bWVudCBvcHRpb25zIGRpYWxvZ1xuICAgICAgICBTdHJpbmdbXSBvcHRpb25zID0ge1wiVGnhu4FuIG3hurd0XCIsIFwiVGjhursgdMOtbiBk4bulbmdcIiwgXCJDaHV54buDbiBraG/huqNuXCIsIFwiVsOtIMSRaeG7h24gdOG7rVwifTtcbiAgICAgICAgaW50IGNob2ljZSA9IEpPcHRpb25QYW5lLnNob3dPcHRpb25EaWFsb2coXG4gICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICBcIkNo4buNbiBwaMawxqFuZyB0aOG7qWMgdGhhbmggdG/DoW5cIixcbiAgICAgICAgICAgICAgICBcIlRoYW5oIHRvw6FuXCIsXG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuREVGQVVMVF9PUFRJT04sXG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuUVVFU1RJT05fTUVTU0FHRSxcbiAgICAgICAgICAgICAgICBudWxsLFxuICAgICAgICAgICAgICAgIG9wdGlvbnMsXG4gICAgICAgICAgICAgICAgb3B0aW9uc1swXVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIFByb2Nlc3MgYmFzZWQgb24gc2VsZWN0ZWQgcGF5bWVudCBtZXRob2RcbiAgICAgICAgaWYgKGNob2ljZSA+PSAwKSB7XG4gICAgICAgICAgICAvLyBTaG93IHByb2Nlc3NpbmcgbWVzc2FnZVxuICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIFwixJBhbmcgeOG7rSBsw70gdGhhbmggdG/DoW4uLi5cIixcbiAgICAgICAgICAgICAgICAgICAgXCJUaGFuaCB0b8OhblwiLFxuICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5JTkZPUk1BVElPTl9NRVNTQUdFXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIEdldCBjdXN0b21lciBpbmZvcm1hdGlvbiBmcm9tIGZvcm1cbiAgICAgICAgICAgICAgICBTdHJpbmcgY3VzdG9tZXJOYW1lID0gbmFtZUZpZWxkLmdldFRleHQoKS50cmltKCk7XG4gICAgICAgICAgICAgICAgU3RyaW5nIGlkQ2FyZCA9IGlkQ2FyZEZpZWxkLmdldFRleHQoKS50cmltKCk7XG4gICAgICAgICAgICAgICAgU3RyaW5nIHBob25lID0gcGhvbmVGaWVsZC5nZXRUZXh0KCkudHJpbSgpO1xuICAgICAgICAgICAgICAgIFN0cmluZyBlbWFpbCA9IGVtYWlsRmllbGQuZ2V0VGV4dCgpLnRyaW0oKTsgLy8gVGhpcyBpcyB0aGUgYWRkcmVzcyBmaWVsZCBhcyBwZXIgcmVxdWlyZW1lbnRzXG5cbiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiBjdXN0b21lciBleGlzdHMgYnkgSUQgY2FyZCBhbmQgcGhvbmUgbnVtYmVyXG4gICAgICAgICAgICAgICAgS2hhY2hIYW5nIGV4aXN0aW5nQ3VzdG9tZXIgPSBraGFjaEhhbmdEQU8uZmluZEJ5SWRDYXJkQW5kUGhvbmUoaWRDYXJkLCBwaG9uZSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZXhpc3RpbmdDdXN0b21lciAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEN1c3RvbWVyIGV4aXN0c1xuICAgICAgICAgICAgICAgICAgICBpZiAoXCJWSVBcIi5lcXVhbHNJZ25vcmVDYXNlKGV4aXN0aW5nQ3VzdG9tZXIuZ2V0SGFuZ1RoYW5oVmllbigpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ3VzdG9tZXIgaXMgVklQLCBhZGQgbG95YWx0eSBwb2ludHMgKDEgcG9pbnQgcGVyIDEwLDAwMClcbiAgICAgICAgICAgICAgICAgICAgICAgIGludCBwb2ludHNUb0FkZCA9IChpbnQpICh0b3RhbEFtb3VudCAvIDEwMDAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4aXN0aW5nQ3VzdG9tZXIuc2V0RGllbVRpY2hMdXkoZXhpc3RpbmdDdXN0b21lci5nZXREaWVtVGljaEx1eSgpICsgcG9pbnRzVG9BZGQpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgY3VzdG9tZXIgaW4gZGF0YWJhc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGtoYWNoSGFuZ0RBTy51cGRhdGUoZXhpc3RpbmdDdXN0b21lcik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIktow6FjaCBow6BuZyBWSVAgxJHDoyDEkcaw4bujYyBj4buZbmcgXCIgKyBwb2ludHNUb0FkZCArIFwiIMSRaeG7g20gdMOtY2ggbMWpeS5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJUaMO0bmcgYsOhb1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5JTkZPUk1BVElPTl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ3VzdG9tZXIgZXhpc3RzIGJ1dCBpcyBub3QgVklQLCBkb24ndCBhZGQgcG9pbnRzXG4gICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJLaMOhY2ggaMOgbmcga2jDtG5nIHBo4bqjaSBWSVAsIGtow7RuZyDEkcaw4bujYyBj4buZbmcgxJFp4buDbSB0w61jaCBsxal5LlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlRow7RuZyBiw6FvXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLklORk9STUFUSU9OX01FU1NBR0VcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIH1cbi4uLlxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2kga2hpIHTDrG0gbG/huqFpIGtow6FjaCBow6BuZzogXCIgKyBlLmdldE1lc3NhZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gQWRkIG5ldyBjdXN0b21lciB0byBkYXRhYmFzZVxuICAgICAgICAgICAgICAgICAgICBraGFjaEhhbmdEQU8uYWRkKG5ld0N1c3RvbWVyKTtcblxuICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwixJDDoyB0aMOqbSBraMOhY2ggaMOgbmcgbeG7m2kgdsOgbyBjxqEgc+G7nyBk4buvIGxp4buHdS5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlRow7RuZyBiw6FvXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBjaGFuZ2UgZm9yIGNhc2ggcGF5bWVudFxuICAgICAgICAgICAgICAgIFN0cmluZyBjaGFuZ2VNZXNzYWdlID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoY2hvaWNlID09IDApIHsgLy8gQ2FzaCBwYXltZW50XG4gICAgICAgICAgICAgICAgICAgIGRvdWJsZSBhbW91bnRQYWlkID0gRG91YmxlLnBhcnNlRG91YmxlKGFtb3VudFBhaWRGaWVsZC5nZXRUZXh0KCkudHJpbSgpLnJlcGxhY2UoXCIsXCIsIFwiXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgZG91YmxlIGNoYW5nZSA9IGFtb3VudFBhaWQgLSB0b3RhbEFtb3VudDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoYW5nZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZU1lc3NhZ2UgPSBcIlxcblRp4buBbiB0aOG7kWkgbOG6oWk6IFwiICsgZm9ybWF0Q3VycmVuY3koY2hhbmdlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFNob3cgc3VjY2VzcyBtZXNzYWdlXG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJUaGFuaCB0b8OhbiB0aMOgbmggY8O0bmchIFbDqSBj4bunYSBi4bqhbiDEkcOjIMSRxrDhu6NjIMSR4bq3dC5cIiArIGNoYW5nZU1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIlRow6BuaCBjw7RuZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICAvLyBDbG9zZSBjaGVja291dCB3aW5kb3dcbiAgICAgICAgICAgICAgICBkaXNwb3NlKCk7XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaSBraGkgeOG7rSBsw70gdGhhbmggdG/DoW46IFwiICsgZS5nZXRNZXNzYWdlKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9UcmFWZVBhbmVsLmphdmFcbi4uLlxuXG4gICAgICAgICAgICAvLyBU4bqhbyBow7NhIMSRxqFuIG3hu5tpXG4gICAgICAgICAgICBIb2FEb24gaG9hRG9uID0gbmV3IEhvYURvbigpO1xuXG4gICAgICAgICAgICAvLyBTaW5oIG3DoyBow7NhIMSRxqFuIHRoZW8gxJHhu4tuaCBk4bqhbmcgSEQgeXl5eS9NTS9kZCBYWFhYXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIFN0cmluZyBtYUhvYURvbiA9IGhvYURvbkRBTy5nZW5lcmF0ZU1hSG9hRG9uKExvY2FsRGF0ZS5ub3coKSk7XG4gICAgICAgICAgICAgICAgaG9hRG9uLnNldE1hSEQobWFIb2FEb24pO1xuICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgICAgIC8vIE7hur91IGPDsyBs4buXaSwgdOG6oW8gbcOjIGjDs2EgxJHGoW4gdGjhu6cgY8O0bmcgduG7m2kgdGltZXN0YW1wXG4gICAgICAgICAgICAgICAgU3RyaW5nIG1hSG9hRG9uID0gXCJIRFwiICsgTG9jYWxEYXRlLm5vdygpLmZvcm1hdChEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oXCJ5eXl5TU1kZFwiKSkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgIFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpICUgMTAwMDA7XG4gICAgICAgICAgICAgICAgaG9hRG9uLnNldE1hSEQobWFIb2FEb24pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBUaGnhur90IGzhuq1wIGPDoWMgdGjDtG5nIHRpbiBow7NhIMSRxqFuXG4gICAgICAgICAgICBob2FEb24uc2V0TmdheUxhcChMb2NhbERhdGVUaW1lLm5vdygpKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXRUaWVuR2lhbSgwKTsgLy8gS2jDtG5nIGPDsyBnaeG6o20gZ2nDoSBraGkgdHLhuqMgdsOpXG4gICAgICAgICAgICBob2FEb24uc2V0VG9uZ1RpZW4odGllblRyYUxhaSk7IC8vIFThu5VuZyB0aeG7gW4gbMOgIHPhu5EgdGnhu4FuIHRy4bqjIGzhuqFpIGtow6FjaFxuICAgICAgICAgICAgaG9hRG9uLnNldEtoYWNoSGFuZyhraGFjaEhhbmcpO1xuICAgICAgICAgICAgaG9hRG9uLnNldE52KG5oYW5WaWVuKTsgLy8gTmjDom4gdmnDqm4gxJFhbmcgxJHEg25nIG5o4bqtcFxuXG4gICAgICAgICAgICAvLyBUaGnhur90IGzhuq1wIGxv4bqhaSBow7NhIMSRxqFuIGzDoCBcIsSQw6MgdHLhuqNcIiAoTEhEMDAyKVxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBMb2FpSG9hRG9uIGxvYWlIb2FEb24gPSBob2FEb25EQU8uZ2V0TG9haUhvYURvbkJ5SWQoXCJMSEQwMDJcIik7XG4gICAgICAgICAgICAgICAgaWYgKGxvYWlIb2FEb24gPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUnVudGltZUV4Y2VwdGlvbihcIktow7RuZyB0w6xtIHRo4bqleSBsb+G6oWkgaMOzYSDEkcahbiBMSEQwMDJcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGhvYURvbi5zZXRMb2FpSG9hRG9uKGxvYWlIb2FEb24pO1xuICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBSdW50aW1lRXhjZXB0aW9uKFwiTOG7l2kga2hpIGzhuqV5IHRow7RuZyB0aW4gbG/huqFpIGjDs2EgxJHGoW46IFwiICsgZS5nZXRNZXNzYWdlKCkpO1xuICAgICAgICAgICAgfVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2Rhby9pbXBsL0hvYURvbkRBT0ltcGwuamF2YVxuLi4uXG5cbiAgICBAT3ZlcnJpZGVcbiAgICAvLyBDcmVhdGU6IFRow6ptIGjDs2EgxJHGoW4gbeG7m2lcbiAgICBwdWJsaWMgYm9vbGVhbiBzYXZlSG9hRG9uKEhvYURvbiBob2FEb24pIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xuICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gSlBBVXRpbC5nZXRFbnRpdHlNYW5hZ2VyKCk7XG4gICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRyLmJlZ2luKCk7XG5cbiAgICAgICAgICAgIC8vIEtp4buDbSB0cmEgeGVtIG3DoyBow7NhIMSRxqFuIMSRw6MgxJHGsOG7o2MgdGhp4bq/dCBs4bqtcCBjaMawYVxuICAgICAgICAgICAgaWYgKGhvYURvbi5nZXRNYUhEKCkgPT0gbnVsbCB8fCBob2FEb24uZ2V0TWFIRCgpLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgICAgIC8vIE7hur91IGNoxrBhIGPDsyBtw6MgaMOzYSDEkcahbiwgdOG7sSDEkeG7mW5nIHNpbmggbcOjXG4gICAgICAgICAgICAgICAgU3RyaW5nIG1hSEQgPSBnZW5lcmF0ZU1hSG9hRG9uKFxuICAgICAgICAgICAgICAgICAgICAgICAgaG9hRG9uLmdldE5nYXlMYXAoKSAhPSBudWxsID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuLi4iLCJpc0Vycm9yIjpmYWxzZSwicmVxdWVzdElkIjoiIn19LCI3ZGQxMWNkZC0xZTMzLTQ4MWUtYmYwZS1mNjc3YTU1ZDQ2OTI7dG9vbHVfMDEyWlVFRlRWQmlDRnNQV3ZCTGYzcWM5Ijp7InBoYXNlIjo2LCJyZXN1bHQiOnsidGV4dCI6IlJhbiBpbnRvIFVua25vd24gZXJyb3Igd2hpbGUgdHJ5aW5nIHRvIHJlYWQgUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9ndWlDbGllbnQvVGhhbmhUb2FuR1VJLmphdmEiLCJpc0Vycm9yIjp0cnVlLCJyZXF1ZXN0SWQiOiIifX0sIjY0MzVmMzMxLTIwMDctNGE1OC05ZDhmLTU0NTEyMTY3ZDE1Zjt0b29sdV8wMUFaZGFUUTZmRUVKNVNZeVBxdnBKc3kiOnsicGhhc2UiOjUsInJlc3VsdCI6eyJ0ZXh0IjoiVGhlIGZvbGxvd2luZyBjb2RlIHNlY3Rpb25zIHdlcmUgcmV0cmlldmVkOlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9ndWlDbGllbnQvRG9pVmVQYW5lbC5qYXZhXG4uLi5cbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIsSQw6MgdMOsbSB0aOG6pXkgS2hhY2hIYW5nOiBcIiArIGtoYWNoSGFuZy5nZXRNYUtoYWNoSGFuZygpKTtcblxuICAgICAgICAgICAgLy8gMi4gVOG6oW8gaMOzYSDEkcahbiBt4bubaVxuICAgICAgICAgICAgSG9hRG9uIGhvYURvbiA9IG5ldyBIb2FEb24oKTtcbiAgICAgICAgICAgIFN0cmluZyBtYUhEID0gZ2VuZXJhdGVNYUhEKCk7XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJHZW5lcmF0ZWQgTWFIRDogXCIgKyBtYUhEKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXRNYUhEKG1hSEQpO1xuICAgICAgICAgICAgaG9hRG9uLnNldE5nYXlMYXAoTG9jYWxEYXRlVGltZS5ub3coKSk7XG4gICAgICAgICAgICBob2FEb24uc2V0VGllbkdpYW0oZ2lhVmVCYW5EYXUgLSB2ZVRhdUhpZW5UYWkuZ2V0R2lhVmUoKSk7XG4gICAgICAgICAgICBob2FEb24uc2V0VG9uZ1RpZW4odmVUYXVIaWVuVGFpLmdldEdpYVZlKCkpO1xuICAgICAgICAgICAgaG9hRG9uLnNldEtoYWNoSGFuZyhraGFjaEhhbmcpO1xuXG4gICAgICAgICAgICAvLyBEZWJ1Z2dpbmcgdGhlIE5oYW5WaWVuIHJlZmVyZW5jZVxuICAgICAgICAgICAgaWYgKG5oYW5WaWVuUGFuZWwgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihcIkVSUk9SOiBuaGFuVmllblBhbmVsIGlzIG51bGxcIik7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbihcIlRoaeG6v3UgdGjDtG5nIHRpbiBuaMOibiB2acOqbiFcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJOaGFuVmllbiBpbmZvOiBcIiArIG5oYW5WaWVuUGFuZWwuZ2V0Q2xhc3MoKS5nZXROYW1lKCkpO1xuICAgICAgICAgICAgaG9hRG9uLnNldE52KG5oYW5WaWVuUGFuZWwpO1xuXG4gICAgICAgICAgICAvLyBHZXQgTG9haUhvYURvbiBhbmQgdmVyaWZ5IGl0IGV4aXN0c1xuICAgICAgICAgICAgTG9haUhvYURvbiBsb2FpSG9hRG9uID0gbG9haUhvYURvbkRBTy5maW5kQnlJZChcIkxIRDAwMVwiKTtcbiAgICAgICAgICAgIGlmIChsb2FpSG9hRG9uID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCJFUlJPUjogS2jDtG5nIHTDrG0gdGjhuqV5IGxv4bqhaSBow7NhIMSRxqFuIExIRDAwMVwiKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKFwiS2jDtG5nIHTDrG0gdGjhuqV5IGxv4bqhaSBow7NhIMSRxqFuIVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIkZvdW5kIExvYWlIb2FEb246IFwiICsgbG9haUhvYURvbi5nZXRNYUxvYWlIb2FEb24oKSk7XG4gICAgICAgICAgICBob2FEb24uc2V0TG9haUhvYURvbihsb2FpSG9hRG9uKTtcblxuICAgICAgICAgICAgLy8gMy4gTMawdSBow7NhIMSRxqFuXG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJBdHRlbXB0aW5nIHRvIHNhdmUgSG9hRG9uLi4uXCIpO1xuICAgICAgICAgICAgYm9vbGVhbiBzYXZlZEhvYURvbiA9IGhvYURvbkRBTy5zYXZlSG9hRG9uKGhvYURvbik7XG4gICAgICAgICAgICBpZiAoIXNhdmVkSG9hRG9uKSB7XG4gICAgICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFwiRmFpbGVkIHRvIHNhdmUgSG9hRG9uIVwiKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKFwiS2jDtG5nIHRo4buDIGzGsHUgaMOzYSDEkcahbiFcIik7XG4gICAgICAgICAgICB9XG4uLi5cblxuICAgICAgICAgICAgY2hpVGlldEhvYURvbi5zZXRUaGFuaFRpZW4odGhhbmhUaWVuKTtcbiAgICAgICAgICAgIGNoaVRpZXRIb2FEb24uc2V0VGllblRodWUodGllblRodWUpO1xuXG4gICAgICAgICAgICAvLyA1LiBMxrB1IGNoaSB0aeG6v3QgaMOzYSDEkcahblxuICAgICAgICAgICAgYm9vbGVhbiBzYXZlZENoaVRpZXQgPSBjaGlUaWV0SG9hRG9uREFPLnNhdmUoY2hpVGlldEhvYURvbik7XG4gICAgICAgICAgICBpZiAoIXNhdmVkQ2hpVGlldCkge1xuICAgICAgICAgICAgICAgIC8vIFjDs2EgaMOzYSDEkcahbiDEkcOjIHThuqFvIG7hur91IGtow7RuZyB0aOG7gyBsxrB1IGNoaSB0aeG6v3RcbiAgICAgICAgICAgICAgICAvLyBob2FEb25EQU8uZGVsZXRlKG1hSEQpOyAvLyBHaeG6oyDEkeG7i25oIGPDsyBwaMawxqFuZyB0aOG7qWMgZGVsZXRlXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbihcIktow7RuZyB0aOG7gyBsxrB1IGNoaSB0aeG6v3QgaMOzYSDEkcahbiFcIik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIsSQw6MgdMOsbSB0aOG6pXkgS2hhY2hIYW5nOiBcIiArIGtoYWNoSGFuZy5nZXRNYUtoYWNoSGFuZygpKTtcbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIkdlbmVyYXRlZCBNYUhEOiBcIiArIG1hSEQpO1xuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiTmhhblZpZW4gaW5mbzogXCIgKyBuaGFuVmllblBhbmVsLmdldENsYXNzKCkuZ2V0TmFtZSgpKTtcbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIkZvdW5kIExvYWlIb2FEb246IFwiICsgbG9haUhvYURvbi5nZXRNYUxvYWlIb2FEb24oKSk7XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJIb2FEb24gc2F2ZWQgc3VjY2Vzc2Z1bGx5IVwiKTtcbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIkNoaVRpZXRIb2FEb24gc2F2ZWQgc3VjY2Vzc2Z1bGx5IVwiKTtcblxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZ3VpQ2xpZW50L1RoYW5oVG9hbkdVSS5qYXZhXG4uLi5cblxuICAgIC8vIFBheW1lbnQgZmllbGRzXG4gICAgcHJpdmF0ZSBKVGV4dEZpZWxkIGFtb3VudFBhaWRGaWVsZDtcbiAgICBwcml2YXRlIEpMYWJlbCBjaGFuZ2VBbW91bnRMYWJlbDtcblxuICAgIC8vIERhdGFcbiAgICBwcml2YXRlIE1hcDxTdHJpbmcsIFN0cmluZz4gdGlja2V0c01hcDsgLy8gTWFwIG9mIHNlYXQgSURzIHRvIHNjaGVkdWxlIElEc1xuICAgIHByaXZhdGUgQ29sb3IgcHJpbWFyeUNvbG9yID0gbmV3IENvbG9yKDAsIDEzNiwgMjA0KTtcblxuICAgIC8vIEVtcGxveWVlIGluZm9ybWF0aW9uXG4gICAgcHJpdmF0ZSBOaGFuVmllbiBuaGFuVmllbjtcblxuICAgIC8vIERBT3NcbiAgICBwcml2YXRlIExpY2hUcmluaFRhdURBTyBsaWNoVHJpbmhUYXVEQU87XG4gICAgcHJpdmF0ZSBDaG9OZ29pREFPIGNob05nb2lEQU87XG4gICAgcHJpdmF0ZSBUb2FUYXVEQU8gdG9hVGF1REFPO1xuICAgIHByaXZhdGUgVGF1REFPIHRhdURBTztcbiAgICBwcml2YXRlIEtodXllbk1haURBTyBraHV5ZW5NYWlEQU87XG4gICAgcHJpdmF0ZSBLaGFjaEhhbmdEQU8ga2hhY2hIYW5nREFPO1xuICAgIHByaXZhdGUgZGFvLkxvYWlLaGFjaEhhbmdEQU8gbG9haUtoYWNoSGFuZ0RBTztcbiAgICBwcml2YXRlIFZlVGF1REFPIHZlVGF1REFPO1xuICAgIHByaXZhdGUgSG9hRG9uREFPIGhvYURvbkRBTztcbiAgICBwcml2YXRlIENoaVRpZXRIb2FEb25EQU8gY2hpVGlldEhvYURvbkRBTztcbiAgICBwcml2YXRlIExvYWlIb2FEb25EQU8gbG9haUhvYURvbkRBTztcblxuICAgIC8qKlxuICAgICAqIENvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHRpY2tldHNNYXAgTWFwIG9mIHNlYXQgSURzIHRvIHNjaGVkdWxlIElEc1xuICAgICAqIEBwYXJhbSBudiBUaGUgZW1wbG95ZWUgd2hvIGlzIHByb2Nlc3NpbmcgdGhlIHBheW1lbnRcbiAgICAgKi9cbiAgICBwdWJsaWMgVGhhbmhUb2FuR1VJKE1hcDxTdHJpbmcsIFN0cmluZz4gdGlja2V0c01hcCwgTmhhblZpZW4gbnYpIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xuICAgICAgICB0aGlzLnRpY2tldHNNYXAgPSB0aWNrZXRzTWFwO1xuICAgICAgICB0aGlzLm5oYW5WaWVuID0gbnY7XG5cbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBEQU9zXG4gICAgICAgIGxpY2hUcmluaFRhdURBTyA9IG5ldyBMaWNoVHJpbmhUYXVEQU9JbXBsKCk7XG4gICAgICAgIGNob05nb2lEQU8gPSBuZXcgQ2hvTmdvaURBT0ltcGwoKTtcbiAgICAgICAgdG9hVGF1REFPID0gbmV3IFRvYVRhdURBT0ltcGwoKTtcbiAgICAgICAgdGF1REFPID0gbmV3IFRhdURBT0ltcGwoKTtcbiAgICAgICAga2h1eWVuTWFpREFPID0gbmV3IEtodXllbk1haURBT0ltcGwoKTtcbiAgICAgICAga2hhY2hIYW5nREFPID0gbmV3IEtoYWNoSGFuZ0RBT0ltcGwoKTtcbiAgICAgICAgbG9haUtoYWNoSGFuZ0RBTyA9IG5ldyBMb2FpS2hhY2hIYW5nREFPSW1wbCgpO1xuXG4gICAgICAgIHNldFRpdGxlKFwiVGhhbmggdG/DoW4gdsOpIHTDoHVcIik7XG4gICAgICAgIHNldFNpemUoMTAwMCwgNzAwKTtcbiAgICAgICAgc2V0RGVmYXVsdENsb3NlT3BlcmF0aW9uKEpGcmFtZS5ESVNQT1NFX09OX0NMT1NFKTtcbiAgICAgICAgc2V0TG9jYXRpb25SZWxhdGl2ZVRvKG51bGwpO1xuXG4gICAgICAgIGluaXRDb21wb25lbnRzKCk7XG4gICAgICAgIGNhbGN1bGF0ZVRvdGFsKCk7XG4gICAgfVxuLi4uXG5cbiAgICAgICAgLy8gQ3JlYXRlIHRpY2tldHMgdGFibGVcbiAgICAgICAgY3JlYXRlVGlja2V0c1RhYmxlKCk7XG4gICAgICAgIEpTY3JvbGxQYW5lIHRhYmxlU2Nyb2xsUGFuZSA9IG5ldyBKU2Nyb2xsUGFuZSh0aWNrZXRUYWJsZSk7XG4gICAgICAgIHRhYmxlU2Nyb2xsUGFuZS5zZXRCb3JkZXIoQm9yZGVyRmFjdG9yeS5jcmVhdGVMaW5lQm9yZGVyKG5ldyBDb2xvcigyMDAsIDIwMCwgMjAwKSkpO1xuICAgICAgICBjZW50ZXJQYW5lbC5hZGQodGFibGVTY3JvbGxQYW5lLCBCb3JkZXJMYXlvdXQuQ0VOVEVSKTtcblxuICAgICAgICAvLyBCb3R0b20gcGFuZWwgZm9yIGJ1dHRvbnMgYW5kIGRpc2NvdW50XG4gICAgICAgIEpQYW5lbCBib3R0b21QYW5lbCA9IG5ldyBKUGFuZWwobmV3IEJvcmRlckxheW91dCg1LCAwKSk7XG5cbiAgICAgICAgLy8gTGVmdCAtIFJlbW92ZSBhbGwgdGlja2V0cyBidXR0b25cbiAgICAgICAgSlBhbmVsIGJ1dHRvblBhbmVsID0gbmV3IEpQYW5lbChuZXcgRmxvd0xheW91dChGbG93TGF5b3V0LkxFRlQpKTtcbiAgICAgICAgSkJ1dHRvbiByZW1vdmVBbGxCdXR0b24gPSBuZXcgSkJ1dHRvbihcIljDs2EgdOG6pXQgY+G6oyBjw6FjIHbDqVwiKTtcbiAgICAgICAgcmVtb3ZlQWxsQnV0dG9uLnNldEljb24oY3JlYXRlVHJhc2hJY29uKCkpO1xuICAgICAgICByZW1vdmVBbGxCdXR0b24uYWRkQWN0aW9uTGlzdGVuZXIoZSAtPiByZW1vdmVBbGxUaWNrZXRzKCkpO1xuICAgICAgICBidXR0b25QYW5lbC5hZGQocmVtb3ZlQWxsQnV0dG9uKTtcbiAgICAgICAgYm90dG9tUGFuZWwuYWRkKGJ1dHRvblBhbmVsLCBCb3JkZXJMYXlvdXQuV0VTVCk7XG4uLi5cblxuICAgICAgICAvLyBDcmVhdGUgc291dGggcGFuZWwgZm9yIGN1c3RvbWVyIGluZm8gYW5kIHBheW1lbnQgYnV0dG9uXG4gICAgICAgIEpQYW5lbCBzb3V0aFBhbmVsID0gbmV3IEpQYW5lbChuZXcgQm9yZGVyTGF5b3V0KDAsIDEwKSk7XG5cbiAgICAgICAgLy8gQ3VzdG9tZXIgaW5mb3JtYXRpb24gc2VjdGlvblxuICAgICAgICBKUGFuZWwgY3VzdG9tZXJQYW5lbCA9IGNyZWF0ZUN1c3RvbWVySW5mb1BhbmVsKCk7XG4gICAgICAgIHNvdXRoUGFuZWwuYWRkKGN1c3RvbWVyUGFuZWwsIEJvcmRlckxheW91dC5OT1JUSCk7XG5cbiAgICAgICAgLy8gUGF5bWVudCBidXR0b25cbiAgICAgICAgSlBhbmVsIHBheW1lbnRQYW5lbCA9IG5ldyBKUGFuZWwobmV3IEZsb3dMYXlvdXQoRmxvd0xheW91dC5SSUdIVCkpO1xuICAgICAgICBKQnV0dG9uIHBheUJ1dHRvbiA9IG5ldyBKQnV0dG9uKFwiVGhhbmggdG/DoW5cIik7XG4gICAgICAgIHBheUJ1dHRvbi5zZXRCYWNrZ3JvdW5kKHByaW1hcnlDb2xvcik7XG4gICAgICAgIHBheUJ1dHRvbi5zZXRGb3JlZ3JvdW5kKENvbG9yLldISVRFKTtcbiAgICAgICAgcGF5QnV0dG9uLnNldEZvbnQobmV3IEZvbnQoXCJBcmlhbFwiLCBGb250LkJPTEQsIDE0KSk7XG4gICAgICAgIHBheUJ1dHRvbi5zZXRQcmVmZXJyZWRTaXplKG5ldyBEaW1lbnNpb24oMTIwLCAzNSkpO1xuICAgICAgICBwYXlCdXR0b24uYWRkQWN0aW9uTGlzdGVuZXIoZSAtPiBwcm9jZXNzUGF5bWVudCgpKTtcbiAgICAgICAgcGF5bWVudFBhbmVsLmFkZChwYXlCdXR0b24pO1xuICAgICAgICBzb3V0aFBhbmVsLmFkZChwYXltZW50UGFuZWwsIEJvcmRlckxheW91dC5TT1VUSCk7XG5cbiAgICAgICAgLy8gQWRkIHNvdXRoIHBhbmVsIHRvIG1haW4gcGFuZWxcbiAgICAgICAgbWFpblBhbmVsLmFkZChzb3V0aFBhbmVsLCBCb3JkZXJMYXlvdXQuU09VVEgpO1xuXG4gICAgICAgIC8vIEFkZCBtYWluIHBhbmVsIHRvIGZyYW1lXG4gICAgICAgIGFkZChtYWluUGFuZWwpO1xuXG4gICAgICAgIC8vIFNldCBhIGxhcmdlciBzaXplIGZvciB0aGUgZnJhbWUgdG8gYWNjb21tb2RhdGUgdGhlIG5ldyBwYW5lbFxuICAgICAgICBzZXRTaXplKDEzMDAsIDcwMCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIHRpdGxlIHBhbmVsXG4gICAgICovXG4gICAgcHJpdmF0ZSBKUGFuZWwgY3JlYXRlVGl0bGVQYW5lbCgpIHtcbiAgICAgICAgSlBhbmVsIHBhbmVsID0gbmV3IEpQYW5lbChuZXcgQm9yZGVyTGF5b3V0KCkpO1xuICAgICAgICBKTGFiZWwgdGl0bGVMYWJlbCA9IG5ldyBKTGFiZWwoXCJUaGFuaCB0b8OhbiB2w6kgdMOgdVwiLCBKTGFiZWwuQ0VOVEVSKTtcbiAgICAgICAgdGl0bGVMYWJlbC5zZXRGb250KG5ldyBGb250KFwiQXJpYWxcIiwgRm9udC5CT0xELCAyMCkpO1xuICAgICAgICB0aXRsZUxhYmVsLnNldEZvcmVncm91bmQocHJpbWFyeUNvbG9yKTtcbiAgICAgICAgdGl0bGVMYWJlbC5zZXRCb3JkZXIobmV3IEVtcHR5Qm9yZGVyKDAsIDAsIDEwLCAwKSk7XG4gICAgICAgIHBhbmVsLmFkZCh0aXRsZUxhYmVsLCBCb3JkZXJMYXlvdXQuQ0VOVEVSKTtcbiAgICAgICAgcmV0dXJuIHBhbmVsO1xuICAgIH1cbi4uLlxuXG4gICAgICAgICAgICAvLyBHZXQgdHJhaW4gaW5mb3JtYXRpb25cbiAgICAgICAgICAgIFRhdSB0YXUgPSB0YXVEQU8uZ2V0VGF1QnlMaWNoVHJpbmhUYXUobGljaFRyaW5oKTtcbiAgICAgICAgICAgIGlmICh0YXUgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihcIktow7RuZyB0w6xtIHRo4bqleSB0aMO0bmcgdGluIHTDoHUgY2hvIGzhu4tjaCB0csOsbmg6IFwiICsgc2NoZWR1bGVJZCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZXQgc2VhdCBuYW1lL251bWJlclxuICAgICAgICAgICAgU3RyaW5nIHNlYXROYW1lID0gY2hvTmdvaS5nZXRUZW5DaG8oKSAhPSBudWxsID8gY2hvTmdvaS5nZXRUZW5DaG8oKSA6IHNlYXRJZDtcblxuICAgICAgICAgICAgLy8gR2V0IHByaWNlIGJhc2VkIG9uIHNlYXQgY2xhc3MgYW5kIHJvdXRlXG4gICAgICAgICAgICBkb3VibGUgcHJpY2UgPSBnZXRTZWF0UHJpY2UoY2hvTmdvaSwgdG9hVGF1KTtcblxuICAgICAgICAgICAgLy8gR2V0IHJvdXRlIGluZm9ybWF0aW9uXG4gICAgICAgICAgICBTdHJpbmcgZnJvbSA9IGxpY2hUcmluaC5nZXRUYXUoKS5nZXRUdXllblRhdSgpLmdldEdhRGkoKTtcbiAgICAgICAgICAgIFN0cmluZyB0byA9IGxpY2hUcmluaC5nZXRUYXUoKS5nZXRUdXllblRhdSgpLmdldEdhRGVuKCk7XG5cbiAgICAgICAgICAgIC8vIEZvcm1hdCBkYXRlIGFuZCB0aW1lXG4gICAgICAgICAgICBTdHJpbmcgZGVwYXJ0RGF0ZSA9IGxpY2hUcmluaC5nZXROZ2F5RGkoKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKFwiZGQvTU0veXl5eVwiKSk7XG4gICAgICAgICAgICBTdHJpbmcgZGVwYXJ0VGltZSA9IGxpY2hUcmluaC5nZXRHaW9EaSgpLmZvcm1hdChEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oXCJISDptbVwiKSk7XG4uLi5cblxuICAgICAgICAgICAgLy8gRm9ybWF0IHByaWNlXG4gICAgICAgICAgICBTdHJpbmcgcHJpY2VTdHIgPSBmb3JtYXRDdXJyZW5jeShwcmljZSk7XG5cbiAgICAgICAgICAgIC8vIFZBVCBjYWxjdWxhdGlvbiAoZml4ZWQgYXQgMTAlKVxuICAgICAgICAgICAgU3RyaW5nIHZhdFN0ciA9IFwiMTAlXCI7XG5cbiAgICAgICAgICAgIC8vIFBhc3NlbmdlciB0eXBlIGRpc2NvdW50IChlbXB0eSBmb3Igbm93KVxuICAgICAgICAgICAgU3RyaW5nIHByb21vdGlvbiA9IFwiXCI7XG5cbiAgICAgICAgICAgIC8vIFByb21vdGlvbiBkaXNjb3VudCAoZW1wdHkgZm9yIG5vdylcbiAgICAgICAgICAgIFN0cmluZyBwcm9tb3Rpb25EaXNjb3VudFN0ciA9IFwiMFwiO1xuXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgdG90YWwgKHByaWNlICsgVkFUKVxuICAgICAgICAgICAgZG91YmxlIHRvdGFsRm9yVGlja2V0ID0gcHJpY2UgKyAocHJpY2UgKiAwLjEpO1xuICAgICAgICAgICAgU3RyaW5nIHRvdGFsU3RyID0gZm9ybWF0Q3VycmVuY3kodG90YWxGb3JUaWNrZXQpO1xuXG4gICAgICAgICAgICAvLyBDcmVhdGUgcGFzc2VuZ2VyIGluZm8gY29tcG9uZW50IC0gd2lsbCBiZSByZXBsYWNlZCBieSB0aGUgY3VzdG9tIHJlbmRlcmVyXG4gICAgICAgICAgICBQYXNzZW5nZXJJbmZvIHBhc3NlbmdlckluZm8gPSBuZXcgUGFzc2VuZ2VySW5mbygpO1xuXG4gICAgICAgICAgICAvLyBBZGQgcm93IHRvIHRhYmxlXG4gICAgICAgICAgICB0YWJsZU1vZGVsLmFkZFJvdyhuZXcgT2JqZWN0W10ge1xuICAgICAgICAgICAgICAgICAgICBwYXNzZW5nZXJJbmZvLCBzZWF0SW5mbywgcHJpY2VTdHIsIHZhdFN0cixcbiAgICAgICAgICAgICAgICAgICAgcHJvbW90aW9uLCBwcm9tb3Rpb25EaXNjb3VudFN0ciwgdG90YWxTdHIsIFwiWFwiXG4gICAgICAgICAgICB9KTtcbi4uLlxuXG4gICAgICAgICAgICAvLyBQYXJzZSBhbW91bnQgcGFpZCAocmVtb3ZlIGNvbW1hcyBpZiBwcmVzZW50KVxuICAgICAgICAgICAgZG91YmxlIGFtb3VudFBhaWQgPSBEb3VibGUucGFyc2VEb3VibGUoYW1vdW50UGFpZFN0ci5yZXBsYWNlKFwiLFwiLCBcIlwiKSk7XG5cbiAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBjaGFuZ2VcbiAgICAgICAgICAgIGRvdWJsZSBjaGFuZ2UgPSBhbW91bnRQYWlkIC0gdG90YWxBbW91bnQ7XG5cbiAgICAgICAgICAgIC8vIFVwZGF0ZSBjaGFuZ2UgYW1vdW50IGxhYmVsXG4gICAgICAgICAgICBpZiAoY2hhbmdlID49IDApIHtcbiAgICAgICAgICAgICAgICBjaGFuZ2VBbW91bnRMYWJlbC5zZXRUZXh0KGZvcm1hdEN1cnJlbmN5KGNoYW5nZSkpO1xuICAgICAgICAgICAgICAgIGNoYW5nZUFtb3VudExhYmVsLnNldEZvcmVncm91bmQobmV3IENvbG9yKDAsIDEyOCwgMCkpOyAvLyBHcmVlbiBmb3IgcG9zaXRpdmUgY2hhbmdlXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNoYW5nZUFtb3VudExhYmVsLnNldFRleHQoXCJUaGnhur91OiBcIiArIGZvcm1hdEN1cnJlbmN5KE1hdGguYWJzKGNoYW5nZSkpKTtcbiAgICAgICAgICAgICAgICBjaGFuZ2VBbW91bnRMYWJlbC5zZXRGb3JlZ3JvdW5kKENvbG9yLlJFRCk7IC8vIFJlZCBmb3IgbmVnYXRpdmUgY2hhbmdlIChpbnN1ZmZpY2llbnQgcGF5bWVudClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoTnVtYmVyRm9ybWF0RXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgIC8vIEludmFsaWQgaW5wdXQsIHNldCBjaGFuZ2UgdG8gMFxuICAgICAgICAgICAgY2hhbmdlQW1vdW50TGFiZWwuc2V0VGV4dChcIk5o4bqtcCBraMO0bmcgaOG7o3AgbOG7h1wiKTtcbiAgICAgICAgICAgIGNoYW5nZUFtb3VudExhYmVsLnNldEZvcmVncm91bmQoQ29sb3IuUkVEKTtcbiAgICAgICAgfVxuICAgIH1cbi4uLlxuXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgcHJvbW90aW9uIGRpc2NvdW50IGFtb3VudFxuICAgICAgICAgICAgZG91YmxlIGRpc2NvdW50QW1vdW50ID0gYmFzZVByaWNlICogZGlzY291bnRQZXJjZW50YWdlO1xuXG4gICAgICAgICAgICAvLyBGb3JtYXQgdGhlIGRpc2NvdW50IGFtb3VudCBhcyBhIG5lZ2F0aXZlIG51bWJlciB0byBpbmRpY2F0ZSBpdCdzIGEgZGlzY291bnRcbiAgICAgICAgICAgIFN0cmluZyBkaXNjb3VudFN0ciA9IFwiLVwiICsgZm9ybWF0Q3VycmVuY3koZGlzY291bnRBbW91bnQpO1xuXG4gICAgICAgICAgICAvLyBSZXBsYWNlIHRoZSBpbnN1cmFuY2UgYW1vdW50IHdpdGggdGhlIHByb21vdGlvbiBkaXNjb3VudFxuICAgICAgICAgICAgdGFibGVNb2RlbC5zZXRWYWx1ZUF0KGRpc2NvdW50U3RyLCBpLCA1KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNob3cgc3VjY2VzcyBtZXNzYWdlXG4gICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgXCLEkMOjIMOhcCBk4bulbmcga2h1eeG6v24gbcOjaTogXCIgKyBzZWxlY3RlZFByb21vdGlvbi5nZXRUZW5LTSgpLFxuICAgICAgICAgICAgICAgIFwiVGjDtG5nIGLDoW9cIixcbiAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5JTkZPUk1BVElPTl9NRVNTQUdFXG4gICAgICAgICk7XG5cbiAgICAgICAgLy8gUmVjYWxjdWxhdGUgdG90YWwgd2l0aCBwcm9tb3Rpb25cbiAgICAgICAgY2FsY3VsYXRlVG90YWwoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcm9jZXNzIHBheW1lbnRcbiAgICAgKi9cbiAgICBwcml2YXRlIHZvaWQgcHJvY2Vzc1BheW1lbnQoKSB7XG4gICAgICAgIC8vIFZhbGlkYXRlIHJlcXVpcmVkIGZpZWxkc1xuICAgICAgICBpZiAobmFtZUZpZWxkLmdldFRleHQoKS50cmltKCkuaXNFbXB0eSgpIHx8XG4gICAgICAgICAgICAgICAgaWRDYXJkRmllbGQuZ2V0VGV4dCgpLnRyaW0oKS5pc0VtcHR5KCkgfHxcbiAgICAgICAgICAgICAgICBwaG9uZUZpZWxkLmdldFRleHQoKS50cmltKCkuaXNFbXB0eSgpKSB7XG5cbiAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBcIlZ1aSBsw7JuZyDEkWnhu4FuIMSR4bqneSDEkeG7pyBjw6FjIHRyxrDhu51uZyBi4bqvdCBideG7mWNcIixcbiAgICAgICAgICAgICAgICAgICAgXCJM4buXaVwiLFxuICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVmFsaWRhdGUgZW1haWwgbWF0Y2ggaWYgcHJvdmlkZWRcbiAgICAgICAgaWYgKCFlbWFpbEZpZWxkLmdldFRleHQoKS50cmltKCkuaXNFbXB0eSgpICYmXG4gICAgICAgICAgICAgICAgIWVtYWlsRmllbGQuZ2V0VGV4dCgpLmVxdWFscyhjb25maXJtRW1haWxGaWVsZC5nZXRUZXh0KCkpKSB7XG5cbiAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBcIkVtYWlsIHjDoWMgbmjhuq1uIGtow7RuZyBraOG7m3AgduG7m2kgZW1haWwgxJHDoyBuaOG6rXBcIixcbiAgICAgICAgICAgICAgICAgICAgXCJM4buXaVwiLFxuICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4uLi5cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgZG91YmxlIGFtb3VudFBhaWQgPSBEb3VibGUucGFyc2VEb3VibGUoYW1vdW50UGFpZEZpZWxkLmdldFRleHQoKS50cmltKCkucmVwbGFjZShcIixcIiwgXCJcIikpO1xuICAgICAgICAgICAgaWYgKGFtb3VudFBhaWQgPCB0b3RhbEFtb3VudCkge1xuICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiU+G7kSB0aeG7gW4ga2jDoWNoIMSRxrBhIGtow7RuZyDEkeG7pyDEkeG7gyB0aGFuaCB0b8OhblwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgYW1vdW50UGFpZEZpZWxkLnJlcXVlc3RGb2N1cygpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoTnVtYmVyRm9ybWF0RXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBcIlPhu5EgdGnhu4FuIGtow6FjaCDEkcawYSBraMO0bmcgaOG7o3AgbOG7h1wiLFxuICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsXG4gICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0VcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBhbW91bnRQYWlkRmllbGQucmVxdWVzdEZvY3VzKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTaG93IHBheW1lbnQgb3B0aW9ucyBkaWFsb2dcbiAgICAgICAgU3RyaW5nW10gb3B0aW9ucyA9IHtcIlRp4buBbiBt4bq3dFwiLCBcIlRo4bq7IHTDrW4gZOG7pW5nXCIsIFwiQ2h1eeG7g24ga2hv4bqjblwiLCBcIlbDrSDEkWnhu4duIHThu61cIn07XG4gICAgICAgIGludCBjaG9pY2UgPSBKT3B0aW9uUGFuZS5zaG93T3B0aW9uRGlhbG9nKFxuICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgXCJDaOG7jW4gcGjGsMahbmcgdGjhu6ljIHRoYW5oIHRvw6FuXCIsXG4gICAgICAgICAgICAgICAgXCJUaGFuaCB0b8OhblwiLFxuICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLkRFRkFVTFRfT1BUSU9OLFxuICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLlFVRVNUSU9OX01FU1NBR0UsXG4gICAgICAgICAgICAgICAgbnVsbCxcbiAgICAgICAgICAgICAgICBvcHRpb25zLFxuICAgICAgICAgICAgICAgIG9wdGlvbnNbMF1cbiAgICAgICAgKTtcblxuICAgICAgICAvLyBQcm9jZXNzIGJhc2VkIG9uIHNlbGVjdGVkIHBheW1lbnQgbWV0aG9kXG4gICAgICAgIGlmIChjaG9pY2UgPj0gMCkge1xuICAgICAgICAgICAgLy8gU2hvdyBwcm9jZXNzaW5nIG1lc3NhZ2VcbiAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBcIsSQYW5nIHjhu60gbMO9IHRoYW5oIHRvw6FuLi4uXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiVGhhbmggdG/DoW5cIixcbiAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBHZXQgY3VzdG9tZXIgaW5mb3JtYXRpb24gZnJvbSBmb3JtXG4gICAgICAgICAgICAgICAgU3RyaW5nIGN1c3RvbWVyTmFtZSA9IG5hbWVGaWVsZC5nZXRUZXh0KCkudHJpbSgpO1xuICAgICAgICAgICAgICAgIFN0cmluZyBpZENhcmQgPSBpZENhcmRGaWVsZC5nZXRUZXh0KCkudHJpbSgpO1xuICAgICAgICAgICAgICAgIFN0cmluZyBwaG9uZSA9IHBob25lRmllbGQuZ2V0VGV4dCgpLnRyaW0oKTtcbiAgICAgICAgICAgICAgICBTdHJpbmcgZW1haWwgPSBlbWFpbEZpZWxkLmdldFRleHQoKS50cmltKCk7IC8vIFRoaXMgaXMgdGhlIGFkZHJlc3MgZmllbGQgYXMgcGVyIHJlcXVpcmVtZW50c1xuXG4gICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgY3VzdG9tZXIgZXhpc3RzIGJ5IElEIGNhcmQgYW5kIHBob25lIG51bWJlclxuICAgICAgICAgICAgICAgIEtoYWNoSGFuZyBleGlzdGluZ0N1c3RvbWVyID0ga2hhY2hIYW5nREFPLmZpbmRCeUlkQ2FyZEFuZFBob25lKGlkQ2FyZCwgcGhvbmUpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nQ3VzdG9tZXIgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBDdXN0b21lciBleGlzdHNcbiAgICAgICAgICAgICAgICAgICAgaWYgKFwiVklQXCIuZXF1YWxzSWdub3JlQ2FzZShleGlzdGluZ0N1c3RvbWVyLmdldEhhbmdUaGFuaFZpZW4oKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEN1c3RvbWVyIGlzIFZJUCwgYWRkIGxveWFsdHkgcG9pbnRzICgxIHBvaW50IHBlciAxMCwwMDApXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnQgcG9pbnRzVG9BZGQgPSAoaW50KSAodG90YWxBbW91bnQgLyAxMDAwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBleGlzdGluZ0N1c3RvbWVyLnNldERpZW1UaWNoTHV5KGV4aXN0aW5nQ3VzdG9tZXIuZ2V0RGllbVRpY2hMdXkoKSArIHBvaW50c1RvQWRkKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIGN1c3RvbWVyIGluIGRhdGFiYXNlXG4gICAgICAgICAgICAgICAgICAgICAgICBraGFjaEhhbmdEQU8udXBkYXRlKGV4aXN0aW5nQ3VzdG9tZXIpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJLaMOhY2ggaMOgbmcgVklQIMSRw6MgxJHGsOG7o2MgY+G7mW5nIFwiICsgcG9pbnRzVG9BZGQgKyBcIiDEkWnhu4NtIHTDrWNoIGzFqXkuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiVGjDtG5nIGLDoW9cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRVxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEN1c3RvbWVyIGV4aXN0cyBidXQgaXMgbm90IFZJUCwgZG9uJ3QgYWRkIHBvaW50c1xuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiS2jDoWNoIGjDoG5nIGtow7RuZyBwaOG6o2kgVklQLCBraMO0bmcgxJHGsOG7o2MgY+G7mW5nIMSRaeG7g20gdMOtY2ggbMWpeS5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJUaMO0bmcgYsOhb1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5JTkZPUk1BVElPTl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB9XG4uLi5cblxuICAgICAgICAgICAgICAgICAgICAvLyBHZXQgYSBkZWZhdWx0IGN1c3RvbWVyIHR5cGVcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEdldCBhbGwgY3VzdG9tZXIgdHlwZXNcbiAgICAgICAgICAgICAgICAgICAgICAgIExpc3Q8TG9haUtoYWNoSGFuZz4gdHlwZXMgPSBsb2FpS2hhY2hIYW5nREFPLmdldEFsbCgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUcnkgdG8gZmluZCBhIGRlZmF1bHQgY3VzdG9tZXIgdHlwZSAoYXNzdW1pbmcgXCJUaMaw4budbmdcIiBpcyB0aGUgZGVmYXVsdCB0eXBlKVxuICAgICAgICAgICAgICAgICAgICAgICAgTG9haUtoYWNoSGFuZyBkZWZhdWx0VHlwZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKExvYWlLaGFjaEhhbmcgdHlwZSA6IHR5cGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFwiVGjGsOG7nW5nXCIuZXF1YWxzKHR5cGUuZ2V0VGVuTG9haUtoYWNoSGFuZygpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0VHlwZSA9IHR5cGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgXCJUaMaw4budbmdcIiB0eXBlIGRvZXNuJ3QgZXhpc3QsIHVzZSB0aGUgZmlyc3QgYXZhaWxhYmxlIHR5cGVcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZWZhdWx0VHlwZSA9PSBudWxsICYmICF0eXBlcy5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0VHlwZSA9IHR5cGVzLmdldCgwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRlZmF1bHRUeXBlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdDdXN0b21lci5zZXRMb2FpS2hhY2hIYW5nKGRlZmF1bHRUeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbihcIktow7RuZyB0w6xtIHRo4bqleSBsb+G6oWkga2jDoWNoIGjDoG5nIG7DoG8gdHJvbmcgY8ahIHPhu58gZOG7ryBsaeG7h3VcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaSBraGkgdMOsbSBsb+G6oWkga2jDoWNoIGjDoG5nOiBcIiArIGUuZ2V0TWVzc2FnZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0VcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBBZGQgbmV3IGN1c3RvbWVyIHRvIGRhdGFiYXNlXG4gICAgICAgICAgICAgICAgICAgIGtoYWNoSGFuZ0RBTy5hZGQobmV3Q3VzdG9tZXIpO1xuXG4gICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCLEkMOjIHRow6ptIGtow6FjaCBow6BuZyBt4bubaSB2w6BvIGPGoSBz4bufIGThu68gbGnhu4d1LlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiVGjDtG5nIGLDoW9cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5JTkZPUk1BVElPTl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIGNoYW5nZSBmb3IgY2FzaCBwYXltZW50XG4gICAgICAgICAgICAgICAgU3RyaW5nIGNoYW5nZU1lc3NhZ2UgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChjaG9pY2UgPT0gMCkgeyAvLyBDYXNoIHBheW1lbnRcbiAgICAgICAgICAgICAgICAgICAgZG91YmxlIGFtb3VudFBhaWQgPSBEb3VibGUucGFyc2VEb3VibGUoYW1vdW50UGFpZEZpZWxkLmdldFRleHQoKS50cmltKCkucmVwbGFjZShcIixcIiwgXCJcIikpO1xuICAgICAgICAgICAgICAgICAgICBkb3VibGUgY2hhbmdlID0gYW1vdW50UGFpZCAtIHRvdGFsQW1vdW50O1xuICAgICAgICAgICAgICAgICAgICBpZiAoY2hhbmdlID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlTWVzc2FnZSA9IFwiXFxuVGnhu4FuIHRo4buRaSBs4bqhaTogXCIgKyBmb3JtYXRDdXJyZW5jeShjaGFuZ2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gU2hvdyBzdWNjZXNzIG1lc3NhZ2VcbiAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIlRoYW5oIHRvw6FuIHRow6BuaCBjw7RuZyEgVsOpIGPhu6dhIGLhuqFuIMSRw6MgxJHGsOG7o2MgxJHhurd0LlwiICsgY2hhbmdlTWVzc2FnZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiVGjDoG5oIGPDtG5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5JTkZPUk1BVElPTl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIC8vIENsb3NlIGNoZWNrb3V0IHdpbmRvd1xuICAgICAgICAgICAgICAgIGRpc3Bvc2UoKTtcblxuICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpIGtoaSB44butIGzDvSB0aGFuaCB0b8OhbjogXCIgKyBlLmdldE1lc3NhZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2lcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0VcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZGFvL2ltcGwvSG9hRG9uREFPSW1wbC5qYXZhXG4uLi5cblxuICAgIEBPdmVycmlkZVxuICAgIC8vIENyZWF0ZTogVGjDqm0gaMOzYSDEkcahbiBt4bubaVxuICAgIHB1YmxpYyBib29sZWFuIHNhdmVIb2FEb24oSG9hRG9uIGhvYURvbikgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBKUEFVdGlsLmdldEVudGl0eU1hbmFnZXIoKTtcbiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHIgPSBlbS5nZXRUcmFuc2FjdGlvbigpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdHIuYmVnaW4oKTtcblxuICAgICAgICAgICAgLy8gS2nhu4NtIHRyYSB4ZW0gbcOjIGjDs2EgxJHGoW4gxJHDoyDEkcaw4bujYyB0aGnhur90IGzhuq1wIGNoxrBhXG4gICAgICAgICAgICBpZiAoaG9hRG9uLmdldE1hSEQoKSA9PSBudWxsIHx8IGhvYURvbi5nZXRNYUhEKCkuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgLy8gTuG6v3UgY2jGsGEgY8OzIG3DoyBow7NhIMSRxqFuLCB04buxIMSR4buZbmcgc2luaCBtw6NcbiAgICAgICAgICAgICAgICBTdHJpbmcgbWFIRCA9IGdlbmVyYXRlTWFIb2FEb24oXG4gICAgICAgICAgICAgICAgICAgICAgICBob2FEb24uZ2V0TmdheUxhcCgpICE9IG51bGwgP1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob2FEb24uZ2V0TmdheUxhcCgpLnRvTG9jYWxEYXRlKCkgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMb2NhbERhdGUubm93KClcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGhvYURvbi5zZXRNYUhEKG1hSEQpO1xuICAgICAgICAgICAgfVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9UcmFWZVBhbmVsLmphdmFcbi4uLlxuXG4gICAgICAgICAgICAvLyBU4bqhbyBow7NhIMSRxqFuIG3hu5tpXG4gICAgICAgICAgICBIb2FEb24gaG9hRG9uID0gbmV3IEhvYURvbigpO1xuXG4gICAgICAgICAgICAvLyBTaW5oIG3DoyBow7NhIMSRxqFuIHRoZW8gxJHhu4tuaCBk4bqhbmcgSEQgeXl5eS9NTS9kZCBYWFhYXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIFN0cmluZyBtYUhvYURvbiA9IGhvYURvbkRBTy5nZW5lcmF0ZU1hSG9hRG9uKExvY2FsRGF0ZS5ub3coKSk7XG4gICAgICAgICAgICAgICAgaG9hRG9uLnNldE1hSEQobWFIb2FEb24pO1xuICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgICAgIC8vIE7hur91IGPDsyBs4buXaSwgdOG6oW8gbcOjIGjDs2EgxJHGoW4gdGjhu6cgY8O0bmcgduG7m2kgdGltZXN0YW1wXG4gICAgICAgICAgICAgICAgU3RyaW5nIG1hSG9hRG9uID0gXCJIRFwiICsgTG9jYWxEYXRlLm5vdygpLmZvcm1hdChEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oXCJ5eXl5TU1kZFwiKSkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgIFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpICUgMTAwMDA7XG4gICAgICAgICAgICAgICAgaG9hRG9uLnNldE1hSEQobWFIb2FEb24pO1xuICAgICAgICAgICAgfVxuLi4uXG4iLCJpc0Vycm9yIjpmYWxzZSwicmVxdWVzdElkIjoiIn19LCI3YmI1ZTc0ZS1lOTg0LTQxZmMtOTc2OS0zMTIzNjNlZWZkZDU7dG9vbHVfMDFIMURGTkRqNEFoUFdURW9YTXpRRXd0Ijp7InBoYXNlIjo1LCJyZXN1bHQiOnsidGV4dCI6IlRoZSBmb2xsb3dpbmcgY29kZSBzZWN0aW9ucyB3ZXJlIHJldHJpZXZlZDpcblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZ3VpQ2xpZW50L0RvaVZlUGFuZWwuamF2YVxuLi4uXG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCLEkMOjIHTDrG0gdGjhuqV5IEtoYWNoSGFuZzogXCIgKyBraGFjaEhhbmcuZ2V0TWFLaGFjaEhhbmcoKSk7XG5cbiAgICAgICAgICAgIC8vIDIuIFThuqFvIGjDs2EgxJHGoW4gbeG7m2lcbiAgICAgICAgICAgIEhvYURvbiBob2FEb24gPSBuZXcgSG9hRG9uKCk7XG4gICAgICAgICAgICBTdHJpbmcgbWFIRCA9IGdlbmVyYXRlTWFIRCgpO1xuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiR2VuZXJhdGVkIE1hSEQ6IFwiICsgbWFIRCk7XG4gICAgICAgICAgICBob2FEb24uc2V0TWFIRChtYUhEKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXROZ2F5TGFwKExvY2FsRGF0ZVRpbWUubm93KCkpO1xuICAgICAgICAgICAgaG9hRG9uLnNldFRpZW5HaWFtKGdpYVZlQmFuRGF1IC0gdmVUYXVIaWVuVGFpLmdldEdpYVZlKCkpO1xuICAgICAgICAgICAgaG9hRG9uLnNldFRvbmdUaWVuKHZlVGF1SGllblRhaS5nZXRHaWFWZSgpKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXRLaGFjaEhhbmcoa2hhY2hIYW5nKTtcblxuICAgICAgICAgICAgLy8gRGVidWdnaW5nIHRoZSBOaGFuVmllbiByZWZlcmVuY2VcbiAgICAgICAgICAgIGlmIChuaGFuVmllblBhbmVsID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCJFUlJPUjogbmhhblZpZW5QYW5lbCBpcyBudWxsXCIpO1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oXCJUaGnhur91IHRow7RuZyB0aW4gbmjDom4gdmnDqm4hXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiTmhhblZpZW4gaW5mbzogXCIgKyBuaGFuVmllblBhbmVsLmdldENsYXNzKCkuZ2V0TmFtZSgpKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXROdihuaGFuVmllblBhbmVsKTtcblxuICAgICAgICAgICAgLy8gR2V0IExvYWlIb2FEb24gYW5kIHZlcmlmeSBpdCBleGlzdHNcbiAgICAgICAgICAgIExvYWlIb2FEb24gbG9haUhvYURvbiA9IGxvYWlIb2FEb25EQU8uZmluZEJ5SWQoXCJMSEQwMDFcIik7XG4gICAgICAgICAgICBpZiAobG9haUhvYURvbiA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFwiRVJST1I6IEtow7RuZyB0w6xtIHRo4bqleSBsb+G6oWkgaMOzYSDEkcahbiBMSEQwMDFcIik7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbihcIktow7RuZyB0w6xtIHRo4bqleSBsb+G6oWkgaMOzYSDEkcahbiFcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJGb3VuZCBMb2FpSG9hRG9uOiBcIiArIGxvYWlIb2FEb24uZ2V0TWFMb2FpSG9hRG9uKCkpO1xuICAgICAgICAgICAgaG9hRG9uLnNldExvYWlIb2FEb24obG9haUhvYURvbik7XG5cbiAgICAgICAgICAgIC8vIDMuIEzGsHUgaMOzYSDEkcahblxuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiQXR0ZW1wdGluZyB0byBzYXZlIEhvYURvbi4uLlwiKTtcbiAgICAgICAgICAgIGJvb2xlYW4gc2F2ZWRIb2FEb24gPSBob2FEb25EQU8uc2F2ZUhvYURvbihob2FEb24pO1xuICAgICAgICAgICAgaWYgKCFzYXZlZEhvYURvbikge1xuICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihcIkZhaWxlZCB0byBzYXZlIEhvYURvbiFcIik7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbihcIktow7RuZyB0aOG7gyBsxrB1IGjDs2EgxJHGoW4hXCIpO1xuICAgICAgICAgICAgfVxuLi4uXG5cbiAgICAgICAgICAgIGNoaVRpZXRIb2FEb24uc2V0VGhhbmhUaWVuKHRoYW5oVGllbik7XG4gICAgICAgICAgICBjaGlUaWV0SG9hRG9uLnNldFRpZW5UaHVlKHRpZW5UaHVlKTtcblxuICAgICAgICAgICAgLy8gNS4gTMawdSBjaGkgdGnhur90IGjDs2EgxJHGoW5cbiAgICAgICAgICAgIGJvb2xlYW4gc2F2ZWRDaGlUaWV0ID0gY2hpVGlldEhvYURvbkRBTy5zYXZlKGNoaVRpZXRIb2FEb24pO1xuICAgICAgICAgICAgaWYgKCFzYXZlZENoaVRpZXQpIHtcbiAgICAgICAgICAgICAgICAvLyBYw7NhIGjDs2EgxJHGoW4gxJHDoyB04bqhbyBu4bq/dSBraMO0bmcgdGjhu4MgbMawdSBjaGkgdGnhur90XG4gICAgICAgICAgICAgICAgLy8gaG9hRG9uREFPLmRlbGV0ZShtYUhEKTsgLy8gR2nhuqMgxJHhu4tuaCBjw7MgcGjGsMahbmcgdGjhu6ljIGRlbGV0ZVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oXCJLaMO0bmcgdGjhu4MgbMawdSBjaGkgdGnhur90IGjDs2EgxJHGoW4hXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCLEkMOjIHTDrG0gdGjhuqV5IEtoYWNoSGFuZzogXCIgKyBraGFjaEhhbmcuZ2V0TWFLaGFjaEhhbmcoKSk7XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJHZW5lcmF0ZWQgTWFIRDogXCIgKyBtYUhEKTtcbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIk5oYW5WaWVuIGluZm86IFwiICsgbmhhblZpZW5QYW5lbC5nZXRDbGFzcygpLmdldE5hbWUoKSk7XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJGb3VuZCBMb2FpSG9hRG9uOiBcIiArIGxvYWlIb2FEb24uZ2V0TWFMb2FpSG9hRG9uKCkpO1xuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiSG9hRG9uIHNhdmVkIHN1Y2Nlc3NmdWxseSFcIik7XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJDaGlUaWV0SG9hRG9uIHNhdmVkIHN1Y2Nlc3NmdWxseSFcIik7XG5cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuXG4gICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCJFcnJvciBpbiB4dUx5VGhhbmhUb2FuOiBcIiArIGUuZ2V0TWVzc2FnZSgpKTtcbiAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgICAgICB0aHJvdyBuZXcgUmVtb3RlRXhjZXB0aW9uKFwiTOG7l2kga2hpIHjhu60gbMO9IHRoYW5oIHRvw6FuOiBcIiArIGUuZ2V0TWVzc2FnZSgpLCBlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgU3RyaW5nIGdlbmVyYXRlTWFIRCgpIHtcbiAgICAgICAgLy8gRm9ybWF0OiBIRCArIHl5eXlNTWRkICsgNCBz4buRIHJhbmRvbVxuICAgICAgICBTaW1wbGVEYXRlRm9ybWF0IHNkZiA9IG5ldyBTaW1wbGVEYXRlRm9ybWF0KFwieXl5eU1NZGRcIik7XG4gICAgICAgIFN0cmluZyBkYXRlUGFydCA9IHNkZi5mb3JtYXQobmV3IERhdGUoKSk7XG4gICAgICAgIFN0cmluZyByYW5kb21QYXJ0ID0gU3RyaW5nLmZvcm1hdChcIiUwNGRcIiwgbmV3IFJhbmRvbSgpLm5leHRJbnQoMTAwMDApKTtcbiAgICAgICAgcmV0dXJuIFwiSERcIiArIGRhdGVQYXJ0ICsgcmFuZG9tUGFydDtcbiAgICB9XG59Li4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9UaGFuaFRvYW5HVUkuamF2YVxucGFja2FnZSBndWlDbGllbnQ7XG5cbmltcG9ydCBkYW8uKjtcbmltcG9ydCBkYW8uaW1wbC4qO1xuaW1wb3J0IG1vZGVsLio7XG5cbmltcG9ydCBqYXZheC5zd2luZy4qO1xuaW1wb3J0IGphdmF4LnN3aW5nLmJvcmRlci4qO1xuaW1wb3J0IGphdmF4LnN3aW5nLnRhYmxlLio7XG5pbXBvcnQgamF2YS5hd3QuKjtcbmltcG9ydCBqYXZhLmF3dC5ldmVudC4qO1xuaW1wb3J0IGphdmEucm1pLlJlbW90ZUV4Y2VwdGlvbjtcbmltcG9ydCBqYXZhLnRleHQuTnVtYmVyRm9ybWF0O1xuaW1wb3J0IGphdmEudGltZS5Mb2NhbERhdGU7XG5pbXBvcnQgamF2YS50aW1lLmZvcm1hdC5EYXRlVGltZUZvcm1hdHRlcjtcbmltcG9ydCBqYXZhLnV0aWwuKjtcbmltcG9ydCBqYXZhLnV0aWwuTGlzdDtcblxuLyoqXG4gKiBDaGVja291dCBpbnRlcmZhY2UgZm9yIHRyYWluIHRpY2tldCBib29raW5nIHN5c3RlbVxuICogRGlzcGxheXMgc2VsZWN0ZWQgdGlja2V0cyBhbmQgY29sbGVjdHMgcGFzc2VuZ2VyIGluZm9ybWF0aW9uXG4gKiBAYXV0aG9yIGx1b25ndGFuMjA0XG4gKi9cbnB1YmxpYyBjbGFzcyBUaGFuaFRvYW5HVUkgZXh0ZW5kcyBKRnJhbWUge1xuICAgIC8vIE1haW4gcGFuZWxzXG4gICAgcHJpdmF0ZSBKUGFuZWwgbWFpblBhbmVsO1xuICAgIHByaXZhdGUgSlRhYmxlIHRpY2tldFRhYmxlO1xuICAgIHByaXZhdGUgRGVmYXVsdFRhYmxlTW9kZWwgdGFibGVNb2RlbDtcblxuICAgIC8vIEZvcm0gZmllbGRzXG4gICAgcHJpdmF0ZSBKVGV4dEZpZWxkIG5hbWVGaWVsZDtcbiAgICBwcml2YXRlIEpUZXh0RmllbGQgaWRDYXJkRmllbGQ7XG4gICAgcHJpdmF0ZSBKVGV4dEZpZWxkIGVtYWlsRmllbGQ7XG4gICAgcHJpdmF0ZSBKVGV4dEZpZWxkIGNvbmZpcm1FbWFpbEZpZWxkO1xuICAgIHByaXZhdGUgSlRleHRGaWVsZCBwaG9uZUZpZWxkO1xuICAgIHByaXZhdGUgSkNvbWJvQm94PEtodXllbk1haT4gcHJvbW90aW9uQ29tYm9Cb3g7XG5cbiAgICAvLyBTdG9yZSB0aGUgc2NoZWR1bGUgZGF0ZSBmb3IgcHJvbW90aW9uc1xuICAgIHByaXZhdGUgTG9jYWxEYXRlIHNjaGVkdWxlRGF0ZTtcblxuICAgIC8vIFN1bW1hcnkgZmllbGRzXG4gICAgcHJpdmF0ZSBKTGFiZWwgdG90YWxBbW91bnRMYWJlbDtcbiAgICBwcml2YXRlIGRvdWJsZSB0b3RhbEFtb3VudCA9IDAuMDtcblxuICAgIC8vIENvbmZpcm1hdGlvbiBwYW5lbFxuICAgIHByaXZhdGUgSlRleHRBcmVhIGNvbmZpcm1hdGlvblRleHRBcmVhO1xuXG4gICAgLy8gUGF5bWVudCBmaWVsZHNcbiAgICBwcml2YXRlIEpUZXh0RmllbGQgYW1vdW50UGFpZEZpZWxkO1xuICAgIHByaXZhdGUgSkxhYmVsIGNoYW5nZUFtb3VudExhYmVsO1xuXG4gICAgLy8gRGF0YVxuICAgIHByaXZhdGUgTWFwPFN0cmluZywgU3RyaW5nPiB0aWNrZXRzTWFwOyAvLyBNYXAgb2Ygc2VhdCBJRHMgdG8gc2NoZWR1bGUgSURzXG4gICAgcHJpdmF0ZSBDb2xvciBwcmltYXJ5Q29sb3IgPSBuZXcgQ29sb3IoMCwgMTM2LCAyMDQpO1xuXG4gICAgLy8gRW1wbG95ZWUgaW5mb3JtYXRpb25cbiAgICBwcml2YXRlIE5oYW5WaWVuIG5oYW5WaWVuO1xuXG4gICAgLy8gREFPc1xuICAgIHByaXZhdGUgTGljaFRyaW5oVGF1REFPIGxpY2hUcmluaFRhdURBTztcbiAgICBwcml2YXRlIENob05nb2lEQU8gY2hvTmdvaURBTztcbiAgICBwcml2YXRlIFRvYVRhdURBTyB0b2FUYXVEQU87XG4gICAgcHJpdmF0ZSBUYXVEQU8gdGF1REFPO1xuICAgIHByaXZhdGUgS2h1eWVuTWFpREFPIGtodXllbk1haURBTztcbiAgICBwcml2YXRlIEtoYWNoSGFuZ0RBTyBraGFjaEhhbmdEQU87XG4gICAgcHJpdmF0ZSBkYW8uTG9haUtoYWNoSGFuZ0RBTyBsb2FpS2hhY2hIYW5nREFPO1xuICAgIHByaXZhdGUgVmVUYXVEQU8gdmVUYXVEQU87XG4gICAgcHJpdmF0ZSBIb2FEb25EQU8gaG9hRG9uREFPO1xuICAgIHByaXZhdGUgQ2hpVGlldEhvYURvbkRBTyBjaGlUaWV0SG9hRG9uREFPO1xuICAgIHByaXZhdGUgTG9haUhvYURvbkRBTyBsb2FpSG9hRG9uREFPO1xuXG4gICAgLyoqXG4gICAgICogQ29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0gdGlja2V0c01hcCBNYXAgb2Ygc2VhdCBJRHMgdG8gc2NoZWR1bGUgSURzXG4gICAgICogQHBhcmFtIG52IFRoZSBlbXBsb3llZSB3aG8gaXMgcHJvY2Vzc2luZyB0aGUgcGF5bWVudFxuICAgICAqL1xuICAgIHB1YmxpYyBUaGFuaFRvYW5HVUkoTWFwPFN0cmluZywgU3RyaW5nPiB0aWNrZXRzTWFwLCBOaGFuVmllbiBudikgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgICAgIHRoaXMudGlja2V0c01hcCA9IHRpY2tldHNNYXA7XG4gICAgICAgIHRoaXMubmhhblZpZW4gPSBudjtcblxuICAgICAgICAvLyBJbml0aWFsaXplIERBT3NcbiAgICAgICAgbGljaFRyaW5oVGF1REFPID0gbmV3IExpY2hUcmluaFRhdURBT0ltcGwoKTtcbiAgICAgICAgY2hvTmdvaURBTyA9IG5ldyBDaG9OZ29pREFPSW1wbCgpO1xuICAgICAgICB0b2FUYXVEQU8gPSBuZXcgVG9hVGF1REFPSW1wbCgpO1xuICAgICAgICB0YXVEQU8gPSBuZXcgVGF1REFPSW1wbCgpO1xuICAgICAgICBraHV5ZW5NYWlEQU8gPSBuZXcgS2h1eWVuTWFpREFPSW1wbCgpO1xuICAgICAgICBraGFjaEhhbmdEQU8gPSBuZXcgS2hhY2hIYW5nREFPSW1wbCgpO1xuICAgICAgICBsb2FpS2hhY2hIYW5nREFPID0gbmV3IExvYWlLaGFjaEhhbmdEQU9JbXBsKCk7XG5cbiAgICAgICAgc2V0VGl0bGUoXCJUaGFuaCB0b8OhbiB2w6kgdMOgdVwiKTtcbiAgICAgICAgc2V0U2l6ZSgxMDAwLCA3MDApO1xuICAgICAgICBzZXREZWZhdWx0Q2xvc2VPcGVyYXRpb24oSkZyYW1lLkRJU1BPU0VfT05fQ0xPU0UpO1xuICAgICAgICBzZXRMb2NhdGlvblJlbGF0aXZlVG8obnVsbCk7XG5cbiAgICAgICAgaW5pdENvbXBvbmVudHMoKTtcbiAgICAgICAgY2FsY3VsYXRlVG90YWwoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplIGNvbXBvbmVudHNcbiAgICAgKi9cbiAgICBwcml2YXRlIHZvaWQgaW5pdENvbXBvbmVudHMoKSB7XG4gICAgICAgIC8vIE1haW4gY29udGFpbmVyIHdpdGggcGFkZGluZ1xuICAgICAgICBtYWluUGFuZWwgPSBuZXcgSlBhbmVsKG5ldyBCb3JkZXJMYXlvdXQoMTAsIDEwKSk7XG4gICAgICAgIG1haW5QYW5lbC5zZXRCb3JkZXIobmV3IEVtcHR5Qm9yZGVyKDE1LCAxNSwgMTUsIDE1KSk7XG5cbiAgICAgICAgLy8gVGl0bGUgcGFuZWxcbiAgICAgICAgSlBhbmVsIHRpdGxlUGFuZWwgPSBjcmVhdGVUaXRsZVBhbmVsKCk7XG4gICAgICAgIG1haW5QYW5lbC5hZGQodGl0bGVQYW5lbCwgQm9yZGVyTGF5b3V0Lk5PUlRIKTtcblxuICAgICAgICAvLyBJbml0aWFsaXplIHByb21vdGlvbkNvbWJvQm94IGJlZm9yZSBjcmVhdGluZyB0aWNrZXRzIHRhYmxlXG4gICAgICAgIHByb21vdGlvbkNvbWJvQm94ID0gbmV3IEpDb21ib0JveDw+KCk7XG4gICAgICAgIHByb21vdGlvbkNvbWJvQm94LnNldFByZWZlcnJlZFNpemUobmV3IERpbWVuc2lvbigyMDAsIDMwKSk7XG5cbiAgICAgICAgLy8gQ2VudGVyIHBhbmVsIGNvbnRhaW5pbmcgdGlja2V0cyB0YWJsZSBhbmQgYm90dG9tIGNvbnRyb2xzXG4gICAgICAgIEpQYW5lbCBjZW50ZXJQYW5lbCA9IG5ldyBKUGFuZWwobmV3IEJvcmRlckxheW91dCgwLCAxMCkpO1xuLi4uXG5cbiAgICAgICAgLy8gQ3JlYXRlIHNvdXRoIHBhbmVsIGZvciBjdXN0b21lciBpbmZvIGFuZCBwYXltZW50IGJ1dHRvblxuICAgICAgICBKUGFuZWwgc291dGhQYW5lbCA9IG5ldyBKUGFuZWwobmV3IEJvcmRlckxheW91dCgwLCAxMCkpO1xuXG4gICAgICAgIC8vIEN1c3RvbWVyIGluZm9ybWF0aW9uIHNlY3Rpb25cbiAgICAgICAgSlBhbmVsIGN1c3RvbWVyUGFuZWwgPSBjcmVhdGVDdXN0b21lckluZm9QYW5lbCgpO1xuICAgICAgICBzb3V0aFBhbmVsLmFkZChjdXN0b21lclBhbmVsLCBCb3JkZXJMYXlvdXQuTk9SVEgpO1xuXG4gICAgICAgIC8vIFBheW1lbnQgYnV0dG9uXG4gICAgICAgIEpQYW5lbCBwYXltZW50UGFuZWwgPSBuZXcgSlBhbmVsKG5ldyBGbG93TGF5b3V0KEZsb3dMYXlvdXQuUklHSFQpKTtcbiAgICAgICAgSkJ1dHRvbiBwYXlCdXR0b24gPSBuZXcgSkJ1dHRvbihcIlRoYW5oIHRvw6FuXCIpO1xuICAgICAgICBwYXlCdXR0b24uc2V0QmFja2dyb3VuZChwcmltYXJ5Q29sb3IpO1xuICAgICAgICBwYXlCdXR0b24uc2V0Rm9yZWdyb3VuZChDb2xvci5XSElURSk7XG4gICAgICAgIHBheUJ1dHRvbi5zZXRGb250KG5ldyBGb250KFwiQXJpYWxcIiwgRm9udC5CT0xELCAxNCkpO1xuICAgICAgICBwYXlCdXR0b24uc2V0UHJlZmVycmVkU2l6ZShuZXcgRGltZW5zaW9uKDEyMCwgMzUpKTtcbiAgICAgICAgcGF5QnV0dG9uLmFkZEFjdGlvbkxpc3RlbmVyKGUgLT4gcHJvY2Vzc1BheW1lbnQoKSk7XG4gICAgICAgIHBheW1lbnRQYW5lbC5hZGQocGF5QnV0dG9uKTtcbiAgICAgICAgc291dGhQYW5lbC5hZGQocGF5bWVudFBhbmVsLCBCb3JkZXJMYXlvdXQuU09VVEgpO1xuLi4uXG5cbiAgICAgICAgICAgIC8vIEdldCB0cmFpbiBpbmZvcm1hdGlvblxuICAgICAgICAgICAgVGF1IHRhdSA9IHRhdURBTy5nZXRUYXVCeUxpY2hUcmluaFRhdShsaWNoVHJpbmgpO1xuICAgICAgICAgICAgaWYgKHRhdSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFwiS2jDtG5nIHTDrG0gdGjhuqV5IHRow7RuZyB0aW4gdMOgdSBjaG8gbOG7i2NoIHRyw6xuaDogXCIgKyBzY2hlZHVsZUlkKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdldCBzZWF0IG5hbWUvbnVtYmVyXG4gICAgICAgICAgICBTdHJpbmcgc2VhdE5hbWUgPSBjaG9OZ29pLmdldFRlbkNobygpICE9IG51bGwgPyBjaG9OZ29pLmdldFRlbkNobygpIDogc2VhdElkO1xuXG4gICAgICAgICAgICAvLyBHZXQgcHJpY2UgYmFzZWQgb24gc2VhdCBjbGFzcyBhbmQgcm91dGVcbiAgICAgICAgICAgIGRvdWJsZSBwcmljZSA9IGdldFNlYXRQcmljZShjaG9OZ29pLCB0b2FUYXUpO1xuXG4gICAgICAgICAgICAvLyBHZXQgcm91dGUgaW5mb3JtYXRpb25cbiAgICAgICAgICAgIFN0cmluZyBmcm9tID0gbGljaFRyaW5oLmdldFRhdSgpLmdldFR1eWVuVGF1KCkuZ2V0R2FEaSgpO1xuICAgICAgICAgICAgU3RyaW5nIHRvID0gbGljaFRyaW5oLmdldFRhdSgpLmdldFR1eWVuVGF1KCkuZ2V0R2FEZW4oKTtcblxuICAgICAgICAgICAgLy8gRm9ybWF0IGRhdGUgYW5kIHRpbWVcbiAgICAgICAgICAgIFN0cmluZyBkZXBhcnREYXRlID0gbGljaFRyaW5oLmdldE5nYXlEaSgpLmZvcm1hdChEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oXCJkZC9NTS95eXl5XCIpKTtcbiAgICAgICAgICAgIFN0cmluZyBkZXBhcnRUaW1lID0gbGljaFRyaW5oLmdldEdpb0RpKCkuZm9ybWF0KERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybihcIkhIOm1tXCIpKTtcbi4uLlxuXG4gICAgICAgICAgICBwYW5lbC5hZGQobmFtZUZpZWxkKTtcbiAgICAgICAgICAgIHBhbmVsLmFkZCh0eXBlQ29tYm8pO1xuICAgICAgICAgICAgcGFuZWwuYWRkKGlkRmllbGQpO1xuICAgICAgICAgICAgcGFuZWwuYWRkKGFnZUZpZWxkKTtcblxuICAgICAgICAgICAgcGFuZWwuc2V0QmFja2dyb3VuZChDb2xvci5XSElURSk7XG5cbiAgICAgICAgICAgIC8vIEFkZCBhY3Rpb24gbGlzdGVuZXJzIGZvciBwcmVzc2luZyBFbnRlclxuICAgICAgICAgICAgbmFtZUZpZWxkLmFkZEFjdGlvbkxpc3RlbmVyKGUgLT4gdXBkYXRlQ3VycmVudEluZm8oKSk7XG4gICAgICAgICAgICBpZEZpZWxkLmFkZEFjdGlvbkxpc3RlbmVyKGUgLT4gdXBkYXRlQ3VycmVudEluZm8oKSk7XG4gICAgICAgICAgICBhZ2VGaWVsZC5hZGRBY3Rpb25MaXN0ZW5lcihlIC0+IHVwZGF0ZUN1cnJlbnRJbmZvKCkpO1xuXG4gICAgICAgICAgICAvLyBBZGQgdHlwZSBjb21ibyBsaXN0ZW5lclxuICAgICAgICAgICAgdHlwZUNvbWJvLmFkZEFjdGlvbkxpc3RlbmVyKGUgLT4ge1xuICAgICAgICAgICAgICAgIHVwZGF0ZUN1cnJlbnRJbmZvKCk7XG4gICAgICAgICAgICAgICAgLy8gRW5hYmxlIGFnZSBmaWVsZCBvbmx5IGZvciBjaGlsZHJlblxuICAgICAgICAgICAgICAgIGFnZUZpZWxkLnNldEVuYWJsZWQoXCJUcuG6uyBlbVwiLmVxdWFscyh0eXBlQ29tYm8uZ2V0U2VsZWN0ZWRJdGVtKCkpKTtcblxuICAgICAgICAgICAgICAgIC8vIFJlY2FsY3VsYXRlIHRvdGFscyB3aGVuIHBhc3NlbmdlciB0eXBlIGNoYW5nZXNcbiAgICAgICAgICAgICAgICBpZiAodGlja2V0VGFibGUuaXNFZGl0aW5nKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RvcEVkaXRpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlVG90YWwoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbi4uLlxuXG4gICAgICAgIHByaXZhdGUgdm9pZCB1cGRhdGVDdXJyZW50SW5mbygpIHtcbiAgICAgICAgICAgIGN1cnJlbnRJbmZvLm5hbWUgPSBuYW1lRmllbGQuZ2V0VGV4dCgpO1xuICAgICAgICAgICAgY3VycmVudEluZm8uaWROdW1iZXIgPSBpZEZpZWxkLmdldFRleHQoKTtcbiAgICAgICAgICAgIGN1cnJlbnRJbmZvLnBhc3NlbmdlclR5cGUgPSAoU3RyaW5nKSB0eXBlQ29tYm8uZ2V0U2VsZWN0ZWRJdGVtKCk7XG5cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY3VycmVudEluZm8uYWdlID0gYWdlRmllbGQuZ2V0VGV4dCgpLmlzRW1wdHkoKSA/IDAgOiBJbnRlZ2VyLnBhcnNlSW50KGFnZUZpZWxkLmdldFRleHQoKSk7XG4gICAgICAgICAgICB9IGNhdGNoIChOdW1iZXJGb3JtYXRFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRJbmZvLmFnZSA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbi4uLlxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBkb3VibGUgYW1vdW50UGFpZCA9IERvdWJsZS5wYXJzZURvdWJsZShhbW91bnRQYWlkRmllbGQuZ2V0VGV4dCgpLnRyaW0oKS5yZXBsYWNlKFwiLFwiLCBcIlwiKSk7XG4gICAgICAgICAgICBpZiAoYW1vdW50UGFpZCA8IHRvdGFsQW1vdW50KSB7XG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJT4buRIHRp4buBbiBraMOhY2ggxJHGsGEga2jDtG5nIMSR4bunIMSR4buDIHRoYW5oIHRvw6FuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBhbW91bnRQYWlkRmllbGQucmVxdWVzdEZvY3VzKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChOdW1iZXJGb3JtYXRFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIFwiU+G7kSB0aeG7gW4ga2jDoWNoIMSRxrBhIGtow7RuZyBo4bujcCBs4buHXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiTOG7l2lcIixcbiAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGFtb3VudFBhaWRGaWVsZC5yZXF1ZXN0Rm9jdXMoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNob3cgcGF5bWVudCBvcHRpb25zIGRpYWxvZ1xuICAgICAgICBTdHJpbmdbXSBvcHRpb25zID0ge1wiVGnhu4FuIG3hurd0XCIsIFwiVGjhursgdMOtbiBk4bulbmdcIiwgXCJDaHV54buDbiBraG/huqNuXCIsIFwiVsOtIMSRaeG7h24gdOG7rVwifTtcbiAgICAgICAgaW50IGNob2ljZSA9IEpPcHRpb25QYW5lLnNob3dPcHRpb25EaWFsb2coXG4gICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICBcIkNo4buNbiBwaMawxqFuZyB0aOG7qWMgdGhhbmggdG/DoW5cIixcbiAgICAgICAgICAgICAgICBcIlRoYW5oIHRvw6FuXCIsXG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuREVGQVVMVF9PUFRJT04sXG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuUVVFU1RJT05fTUVTU0FHRSxcbiAgICAgICAgICAgICAgICBudWxsLFxuICAgICAgICAgICAgICAgIG9wdGlvbnMsXG4gICAgICAgICAgICAgICAgb3B0aW9uc1swXVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIFByb2Nlc3MgYmFzZWQgb24gc2VsZWN0ZWQgcGF5bWVudCBtZXRob2RcbiAgICAgICAgaWYgKGNob2ljZSA+PSAwKSB7XG4gICAgICAgICAgICAvLyBTaG93IHByb2Nlc3NpbmcgbWVzc2FnZVxuICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIFwixJBhbmcgeOG7rSBsw70gdGhhbmggdG/DoW4uLi5cIixcbiAgICAgICAgICAgICAgICAgICAgXCJUaGFuaCB0b8OhblwiLFxuICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5JTkZPUk1BVElPTl9NRVNTQUdFXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIEdldCBjdXN0b21lciBpbmZvcm1hdGlvbiBmcm9tIGZvcm1cbiAgICAgICAgICAgICAgICBTdHJpbmcgY3VzdG9tZXJOYW1lID0gbmFtZUZpZWxkLmdldFRleHQoKS50cmltKCk7XG4gICAgICAgICAgICAgICAgU3RyaW5nIGlkQ2FyZCA9IGlkQ2FyZEZpZWxkLmdldFRleHQoKS50cmltKCk7XG4gICAgICAgICAgICAgICAgU3RyaW5nIHBob25lID0gcGhvbmVGaWVsZC5nZXRUZXh0KCkudHJpbSgpO1xuICAgICAgICAgICAgICAgIFN0cmluZyBlbWFpbCA9IGVtYWlsRmllbGQuZ2V0VGV4dCgpLnRyaW0oKTsgLy8gVGhpcyBpcyB0aGUgYWRkcmVzcyBmaWVsZCBhcyBwZXIgcmVxdWlyZW1lbnRzXG5cbiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiBjdXN0b21lciBleGlzdHMgYnkgSUQgY2FyZCBhbmQgcGhvbmUgbnVtYmVyXG4gICAgICAgICAgICAgICAgS2hhY2hIYW5nIGV4aXN0aW5nQ3VzdG9tZXIgPSBraGFjaEhhbmdEQU8uZmluZEJ5SWRDYXJkQW5kUGhvbmUoaWRDYXJkLCBwaG9uZSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZXhpc3RpbmdDdXN0b21lciAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEN1c3RvbWVyIGV4aXN0c1xuICAgICAgICAgICAgICAgICAgICBpZiAoXCJWSVBcIi5lcXVhbHNJZ25vcmVDYXNlKGV4aXN0aW5nQ3VzdG9tZXIuZ2V0SGFuZ1RoYW5oVmllbigpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ3VzdG9tZXIgaXMgVklQLCBhZGQgbG95YWx0eSBwb2ludHMgKDEgcG9pbnQgcGVyIDEwLDAwMClcbiAgICAgICAgICAgICAgICAgICAgICAgIGludCBwb2ludHNUb0FkZCA9IChpbnQpICh0b3RhbEFtb3VudCAvIDEwMDAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4aXN0aW5nQ3VzdG9tZXIuc2V0RGllbVRpY2hMdXkoZXhpc3RpbmdDdXN0b21lci5nZXREaWVtVGljaEx1eSgpICsgcG9pbnRzVG9BZGQpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgY3VzdG9tZXIgaW4gZGF0YWJhc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGtoYWNoSGFuZ0RBTy51cGRhdGUoZXhpc3RpbmdDdXN0b21lcik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIktow6FjaCBow6BuZyBWSVAgxJHDoyDEkcaw4bujYyBj4buZbmcgXCIgKyBwb2ludHNUb0FkZCArIFwiIMSRaeG7g20gdMOtY2ggbMWpeS5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJUaMO0bmcgYsOhb1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5JTkZPUk1BVElPTl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ3VzdG9tZXIgZXhpc3RzIGJ1dCBpcyBub3QgVklQLCBkb24ndCBhZGQgcG9pbnRzXG4gICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJLaMOhY2ggaMOgbmcga2jDtG5nIHBo4bqjaSBWSVAsIGtow7RuZyDEkcaw4bujYyBj4buZbmcgxJFp4buDbSB0w61jaCBsxal5LlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlRow7RuZyBiw6FvXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLklORk9STUFUSU9OX01FU1NBR0VcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBDdXN0b21lciBkb2Vzbid0IGV4aXN0LCBjcmVhdGUgbmV3IGN1c3RvbWVyXG4gICAgICAgICAgICAgICAgICAgIEtoYWNoSGFuZyBuZXdDdXN0b21lciA9IG5ldyBLaGFjaEhhbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgbmV3Q3VzdG9tZXIuc2V0VGVuS2hhY2hIYW5nKGN1c3RvbWVyTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIG5ld0N1c3RvbWVyLnNldEdpYXlUbyhpZENhcmQpO1xuICAgICAgICAgICAgICAgICAgICBuZXdDdXN0b21lci5zZXRTb0RpZW5UaG9haShwaG9uZSk7XG4gICAgICAgICAgICAgICAgICAgIG5ld0N1c3RvbWVyLnNldERpYUNoaShlbWFpbCk7IC8vIEVtYWlsIGFkZHJlc3MgYXMgcGVyIHJlcXVpcmVtZW50c1xuICAgICAgICAgICAgICAgICAgICBuZXdDdXN0b21lci5zZXRIYW5nVGhhbmhWaWVuKFwiVsOjbmcgbGFpXCIpOyAvLyBEZWZhdWx0IG1lbWJlciByYW5rXG4gICAgICAgICAgICAgICAgICAgIG5ld0N1c3RvbWVyLnNldERpZW1UaWNoTHV5KDAuMCk7IC8vIEluaXRpYWwgbG95YWx0eSBwb2ludHNcbiAgICAgICAgICAgICAgICAgICAgbmV3Q3VzdG9tZXIuc2V0TmdheVNpbmgoTG9jYWxEYXRlLm5vdygpKTsgLy8gRGVmYXVsdCBiaXJ0aCBkYXRlLCBzaG91bGQgYmUgdXBkYXRlZCBsYXRlclxuICAgICAgICAgICAgICAgICAgICBuZXdDdXN0b21lci5zZXROZ2F5VGhhbWdHaWEoTG9jYWxEYXRlLm5vdygpKTsgLy8gSm9pbiBkYXRlIGlzIHRvZGF5XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gR2V0IGEgZGVmYXVsdCBjdXN0b21lciB0eXBlXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBHZXQgYWxsIGN1c3RvbWVyIHR5cGVzXG4gICAgICAgICAgICAgICAgICAgICAgICBMaXN0PExvYWlLaGFjaEhhbmc+IHR5cGVzID0gbG9haUtoYWNoSGFuZ0RBTy5nZXRBbGwoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVHJ5IHRvIGZpbmQgYSBkZWZhdWx0IGN1c3RvbWVyIHR5cGUgKGFzc3VtaW5nIFwiVGjGsOG7nW5nXCIgaXMgdGhlIGRlZmF1bHQgdHlwZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIExvYWlLaGFjaEhhbmcgZGVmYXVsdFR5cGUgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChMb2FpS2hhY2hIYW5nIHR5cGUgOiB0eXBlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChcIlRoxrDhu51uZ1wiLmVxdWFscyh0eXBlLmdldFRlbkxvYWlLaGFjaEhhbmcoKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFR5cGUgPSB0eXBlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIFwiVGjGsOG7nW5nXCIgdHlwZSBkb2Vzbid0IGV4aXN0LCB1c2UgdGhlIGZpcnN0IGF2YWlsYWJsZSB0eXBlXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGVmYXVsdFR5cGUgPT0gbnVsbCAmJiAhdHlwZXMuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFR5cGUgPSB0eXBlcy5nZXQoMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZWZhdWx0VHlwZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q3VzdG9tZXIuc2V0TG9haUtoYWNoSGFuZyhkZWZhdWx0VHlwZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oXCJLaMO0bmcgdMOsbSB0aOG6pXkgbG/huqFpIGtow6FjaCBow6BuZyBuw6BvIHRyb25nIGPGoSBz4bufIGThu68gbGnhu4d1XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2kga2hpIHTDrG0gbG/huqFpIGtow6FjaCBow6BuZzogXCIgKyBlLmdldE1lc3NhZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gQWRkIG5ldyBjdXN0b21lciB0byBkYXRhYmFzZVxuICAgICAgICAgICAgICAgICAgICBraGFjaEhhbmdEQU8uYWRkKG5ld0N1c3RvbWVyKTtcblxuICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwixJDDoyB0aMOqbSBraMOhY2ggaMOgbmcgbeG7m2kgdsOgbyBjxqEgc+G7nyBk4buvIGxp4buHdS5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlRow7RuZyBiw6FvXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBjaGFuZ2UgZm9yIGNhc2ggcGF5bWVudFxuICAgICAgICAgICAgICAgIFN0cmluZyBjaGFuZ2VNZXNzYWdlID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoY2hvaWNlID09IDApIHsgLy8gQ2FzaCBwYXltZW50XG4gICAgICAgICAgICAgICAgICAgIGRvdWJsZSBhbW91bnRQYWlkID0gRG91YmxlLnBhcnNlRG91YmxlKGFtb3VudFBhaWRGaWVsZC5nZXRUZXh0KCkudHJpbSgpLnJlcGxhY2UoXCIsXCIsIFwiXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgZG91YmxlIGNoYW5nZSA9IGFtb3VudFBhaWQgLSB0b3RhbEFtb3VudDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoYW5nZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZU1lc3NhZ2UgPSBcIlxcblRp4buBbiB0aOG7kWkgbOG6oWk6IFwiICsgZm9ybWF0Q3VycmVuY3koY2hhbmdlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFNob3cgc3VjY2VzcyBtZXNzYWdlXG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJUaGFuaCB0b8OhbiB0aMOgbmggY8O0bmchIFbDqSBj4bunYSBi4bqhbiDEkcOjIMSRxrDhu6NjIMSR4bq3dC5cIiArIGNoYW5nZU1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIlRow6BuaCBjw7RuZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICAvLyBDbG9zZSBjaGVja291dCB3aW5kb3dcbiAgICAgICAgICAgICAgICBkaXNwb3NlKCk7XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaSBraGkgeOG7rSBsw70gdGhhbmggdG/DoW46IFwiICsgZS5nZXRNZXNzYWdlKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9UcmFWZVBhbmVsLmphdmFcbi4uLlxuXG4gICAgICAgICAgICAvLyBU4bqhbyBow7NhIMSRxqFuIG3hu5tpXG4gICAgICAgICAgICBIb2FEb24gaG9hRG9uID0gbmV3IEhvYURvbigpO1xuXG4gICAgICAgICAgICAvLyBTaW5oIG3DoyBow7NhIMSRxqFuIHRoZW8gxJHhu4tuaCBk4bqhbmcgSEQgeXl5eS9NTS9kZCBYWFhYXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIFN0cmluZyBtYUhvYURvbiA9IGhvYURvbkRBTy5nZW5lcmF0ZU1hSG9hRG9uKExvY2FsRGF0ZS5ub3coKSk7XG4gICAgICAgICAgICAgICAgaG9hRG9uLnNldE1hSEQobWFIb2FEb24pO1xuICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgICAgIC8vIE7hur91IGPDsyBs4buXaSwgdOG6oW8gbcOjIGjDs2EgxJHGoW4gdGjhu6cgY8O0bmcgduG7m2kgdGltZXN0YW1wXG4gICAgICAgICAgICAgICAgU3RyaW5nIG1hSG9hRG9uID0gXCJIRFwiICsgTG9jYWxEYXRlLm5vdygpLmZvcm1hdChEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oXCJ5eXl5TU1kZFwiKSkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgIFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpICUgMTAwMDA7XG4gICAgICAgICAgICAgICAgaG9hRG9uLnNldE1hSEQobWFIb2FEb24pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBUaGnhur90IGzhuq1wIGPDoWMgdGjDtG5nIHRpbiBow7NhIMSRxqFuXG4gICAgICAgICAgICBob2FEb24uc2V0TmdheUxhcChMb2NhbERhdGVUaW1lLm5vdygpKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXRUaWVuR2lhbSgwKTsgLy8gS2jDtG5nIGPDsyBnaeG6o20gZ2nDoSBraGkgdHLhuqMgdsOpXG4gICAgICAgICAgICBob2FEb24uc2V0VG9uZ1RpZW4odGllblRyYUxhaSk7IC8vIFThu5VuZyB0aeG7gW4gbMOgIHPhu5EgdGnhu4FuIHRy4bqjIGzhuqFpIGtow6FjaFxuICAgICAgICAgICAgaG9hRG9uLnNldEtoYWNoSGFuZyhraGFjaEhhbmcpO1xuICAgICAgICAgICAgaG9hRG9uLnNldE52KG5oYW5WaWVuKTsgLy8gTmjDom4gdmnDqm4gxJFhbmcgxJHEg25nIG5o4bqtcFxuXG4gICAgICAgICAgICAvLyBUaGnhur90IGzhuq1wIGxv4bqhaSBow7NhIMSRxqFuIGzDoCBcIsSQw6MgdHLhuqNcIiAoTEhEMDAyKVxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBMb2FpSG9hRG9uIGxvYWlIb2FEb24gPSBob2FEb25EQU8uZ2V0TG9haUhvYURvbkJ5SWQoXCJMSEQwMDJcIik7XG4gICAgICAgICAgICAgICAgaWYgKGxvYWlIb2FEb24gPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUnVudGltZUV4Y2VwdGlvbihcIktow7RuZyB0w6xtIHRo4bqleSBsb+G6oWkgaMOzYSDEkcahbiBMSEQwMDJcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGhvYURvbi5zZXRMb2FpSG9hRG9uKGxvYWlIb2FEb24pO1xuICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBSdW50aW1lRXhjZXB0aW9uKFwiTOG7l2kga2hpIGzhuqV5IHRow7RuZyB0aW4gbG/huqFpIGjDs2EgxJHGoW46IFwiICsgZS5nZXRNZXNzYWdlKCkpO1xuICAgICAgICAgICAgfVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2Rhby9pbXBsL0hvYURvbkRBT0ltcGwuamF2YVxuLi4uXG5cbiAgICBAT3ZlcnJpZGVcbiAgICAvLyBDcmVhdGU6IFRow6ptIGjDs2EgxJHGoW4gbeG7m2lcbiAgICBwdWJsaWMgYm9vbGVhbiBzYXZlSG9hRG9uKEhvYURvbiBob2FEb24pIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xuICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gSlBBVXRpbC5nZXRFbnRpdHlNYW5hZ2VyKCk7XG4gICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRyLmJlZ2luKCk7XG5cbiAgICAgICAgICAgIC8vIEtp4buDbSB0cmEgeGVtIG3DoyBow7NhIMSRxqFuIMSRw6MgxJHGsOG7o2MgdGhp4bq/dCBs4bqtcCBjaMawYVxuICAgICAgICAgICAgaWYgKGhvYURvbi5nZXRNYUhEKCkgPT0gbnVsbCB8fCBob2FEb24uZ2V0TWFIRCgpLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgICAgIC8vIE7hur91IGNoxrBhIGPDsyBtw6MgaMOzYSDEkcahbiwgdOG7sSDEkeG7mW5nIHNpbmggbcOjXG4gICAgICAgICAgICAgICAgU3RyaW5nIG1hSEQgPSBnZW5lcmF0ZU1hSG9hRG9uKFxuICAgICAgICAgICAgICAgICAgICAgICAgaG9hRG9uLmdldE5nYXlMYXAoKSAhPSBudWxsID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9hRG9uLmdldE5nYXlMYXAoKS50b0xvY2FsRGF0ZSgpIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTG9jYWxEYXRlLm5vdygpXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBob2FEb24uc2V0TWFIRChtYUhEKTtcbiAgICAgICAgICAgLi4uIiwiaXNFcnJvciI6ZmFsc2UsInJlcXVlc3RJZCI6IiJ9fSwiMjE4MjU5OWItMTlkMy00Y2U4LWFiYzktMzM2ZDIyY2RkMTcwO3Rvb2x1XzAxR1p4YkNXaHU1clF1ZUZ3QkdOcXRaYyI6eyJwaGFzZSI6NSwicmVzdWx0Ijp7InRleHQiOiJUaGUgZm9sbG93aW5nIGNvZGUgc2VjdGlvbnMgd2VyZSByZXRyaWV2ZWQ6XG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9UcmFpblRpY2tldEJvb2tpbmdTeXN0ZW0uamF2YVxuLi4uXG4gICAgICAgIGNoZWNrb3V0QnV0dG9uLmFkZEFjdGlvbkxpc3RlbmVyKGUgLT4ge1xuICAgICAgICAgICAgaWYgKGNhcnRJdGVtcy5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgICAgIFRyYWluVGlja2V0Qm9va2luZ1N5c3RlbS50aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJHaeG7jyB2w6kgdHLhu5FuZy4gVnVpIGzDsm5nIGNo4buNbiB2w6kgdHLGsOG7m2Mga2hpIHRoYW5oIHRvw6FuLlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJUaMO0bmcgYsOhb1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBDcmVhdGUgYSBtYXAgb2Ygc2VhdCBJRHMgdG8gc2NoZWR1bGUgSURzXG4gICAgICAgICAgICBNYXA8U3RyaW5nLCBTdHJpbmc+IHRpY2tldHNUb0NoZWNrb3V0ID0gbmV3IEhhc2hNYXA8PigpO1xuICAgICAgICAgICAgZm9yIChUaWNrZXRJdGVtIGl0ZW0gOiBjYXJ0SXRlbXMpIHtcbiAgICAgICAgICAgICAgICB0aWNrZXRzVG9DaGVja291dC5wdXQoaXRlbS5zZWF0SWQsIGN1cnJlbnRNYUxpY2gpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBPcGVuIGNoZWNrb3V0IHNjcmVlbiB3aXRoIG9ubHkgdGhlIG5lY2Vzc2FyeSBpZGVudGlmaWVyc1xuICAgICAgICAgICAgVGhhbmhUb2FuR1VJIGNoZWNrb3V0U2NyZWVuID0gbnVsbDtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY2hlY2tvdXRTY3JlZW4gPSBuZXcgVGhhbmhUb2FuR1VJKHRpY2tldHNUb0NoZWNrb3V0KTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKFJlbW90ZUV4Y2VwdGlvbiBleCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBSdW50aW1lRXhjZXB0aW9uKGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNoZWNrb3V0U2NyZWVuLnNldFZpc2libGUodHJ1ZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBPcGVuIGNoZWNrb3V0IHNjcmVlblxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9Eb2lWZVBhbmVsLmphdmFcbi4uLlxuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwixJDDoyB0w6xtIHRo4bqleSBLaGFjaEhhbmc6IFwiICsga2hhY2hIYW5nLmdldE1hS2hhY2hIYW5nKCkpO1xuXG4gICAgICAgICAgICAvLyAyLiBU4bqhbyBow7NhIMSRxqFuIG3hu5tpXG4gICAgICAgICAgICBIb2FEb24gaG9hRG9uID0gbmV3IEhvYURvbigpO1xuICAgICAgICAgICAgU3RyaW5nIG1hSEQgPSBnZW5lcmF0ZU1hSEQoKTtcbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIkdlbmVyYXRlZCBNYUhEOiBcIiArIG1hSEQpO1xuICAgICAgICAgICAgaG9hRG9uLnNldE1hSEQobWFIRCk7XG4gICAgICAgICAgICBob2FEb24uc2V0TmdheUxhcChMb2NhbERhdGVUaW1lLm5vdygpKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXRUaWVuR2lhbShnaWFWZUJhbkRhdSAtIHZlVGF1SGllblRhaS5nZXRHaWFWZSgpKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXRUb25nVGllbih2ZVRhdUhpZW5UYWkuZ2V0R2lhVmUoKSk7XG4gICAgICAgICAgICBob2FEb24uc2V0S2hhY2hIYW5nKGtoYWNoSGFuZyk7XG5cbiAgICAgICAgICAgIC8vIERlYnVnZ2luZyB0aGUgTmhhblZpZW4gcmVmZXJlbmNlXG4gICAgICAgICAgICBpZiAobmhhblZpZW5QYW5lbCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFwiRVJST1I6IG5oYW5WaWVuUGFuZWwgaXMgbnVsbFwiKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKFwiVGhp4bq/dSB0aMO0bmcgdGluIG5ow6JuIHZpw6puIVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIk5oYW5WaWVuIGluZm86IFwiICsgbmhhblZpZW5QYW5lbC5nZXRDbGFzcygpLmdldE5hbWUoKSk7XG4gICAgICAgICAgICBob2FEb24uc2V0TnYobmhhblZpZW5QYW5lbCk7XG5cbiAgICAgICAgICAgIC8vIEdldCBMb2FpSG9hRG9uIGFuZCB2ZXJpZnkgaXQgZXhpc3RzXG4gICAgICAgICAgICBMb2FpSG9hRG9uIGxvYWlIb2FEb24gPSBsb2FpSG9hRG9uREFPLmZpbmRCeUlkKFwiTEhEMDAxXCIpO1xuICAgICAgICAgICAgaWYgKGxvYWlIb2FEb24gPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihcIkVSUk9SOiBLaMO0bmcgdMOsbSB0aOG6pXkgbG/huqFpIGjDs2EgxJHGoW4gTEhEMDAxXCIpO1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oXCJLaMO0bmcgdMOsbSB0aOG6pXkgbG/huqFpIGjDs2EgxJHGoW4hXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiRm91bmQgTG9haUhvYURvbjogXCIgKyBsb2FpSG9hRG9uLmdldE1hTG9haUhvYURvbigpKTtcbiAgICAgICAgICAgIGhvYURvbi5zZXRMb2FpSG9hRG9uKGxvYWlIb2FEb24pO1xuXG4gICAgICAgICAgICAvLyAzLiBMxrB1IGjDs2EgxJHGoW5cbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIkF0dGVtcHRpbmcgdG8gc2F2ZSBIb2FEb24uLi5cIik7XG4gICAgICAgICAgICBib29sZWFuIHNhdmVkSG9hRG9uID0gaG9hRG9uREFPLnNhdmVIb2FEb24oaG9hRG9uKTtcbiAgICAgICAgICAgIGlmICghc2F2ZWRIb2FEb24pIHtcbiAgICAgICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCJGYWlsZWQgdG8gc2F2ZSBIb2FEb24hXCIpO1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oXCJLaMO0bmcgdGjhu4MgbMawdSBow7NhIMSRxqFuIVwiKTtcbiAgICAgICAgICAgIH1cbi4uLlxuXG4gICAgICAgICAgICBjaGlUaWV0SG9hRG9uLnNldFRoYW5oVGllbih0aGFuaFRpZW4pO1xuICAgICAgICAgICAgY2hpVGlldEhvYURvbi5zZXRUaWVuVGh1ZSh0aWVuVGh1ZSk7XG5cbiAgICAgICAgICAgIC8vIDUuIEzGsHUgY2hpIHRp4bq/dCBow7NhIMSRxqFuXG4gICAgICAgICAgICBib29sZWFuIHNhdmVkQ2hpVGlldCA9IGNoaVRpZXRIb2FEb25EQU8uc2F2ZShjaGlUaWV0SG9hRG9uKTtcbiAgICAgICAgICAgIGlmICghc2F2ZWRDaGlUaWV0KSB7XG4gICAgICAgICAgICAgICAgLy8gWMOzYSBow7NhIMSRxqFuIMSRw6MgdOG6oW8gbuG6v3Uga2jDtG5nIHRo4buDIGzGsHUgY2hpIHRp4bq/dFxuICAgICAgICAgICAgICAgIC8vIGhvYURvbkRBTy5kZWxldGUobWFIRCk7IC8vIEdp4bqjIMSR4buLbmggY8OzIHBoxrDGoW5nIHRo4bupYyBkZWxldGVcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKFwiS2jDtG5nIHRo4buDIGzGsHUgY2hpIHRp4bq/dCBow7NhIMSRxqFuIVwiKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwixJDDoyB0w6xtIHRo4bqleSBLaGFjaEhhbmc6IFwiICsga2hhY2hIYW5nLmdldE1hS2hhY2hIYW5nKCkpO1xuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiR2VuZXJhdGVkIE1hSEQ6IFwiICsgbWFIRCk7XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJOaGFuVmllbiBpbmZvOiBcIiArIG5oYW5WaWVuUGFuZWwuZ2V0Q2xhc3MoKS5nZXROYW1lKCkpO1xuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiRm91bmQgTG9haUhvYURvbjogXCIgKyBsb2FpSG9hRG9uLmdldE1hTG9haUhvYURvbigpKTtcbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIkhvYURvbiBzYXZlZCBzdWNjZXNzZnVsbHkhXCIpO1xuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiQ2hpVGlldEhvYURvbiBzYXZlZCBzdWNjZXNzZnVsbHkhXCIpO1xuXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9ndWlDbGllbnQvVGhhbmhUb2FuR1VJLmphdmFcbi4uLlxuXG4gICAgLy8gUGF5bWVudCBmaWVsZHNcbiAgICBwcml2YXRlIEpUZXh0RmllbGQgYW1vdW50UGFpZEZpZWxkO1xuICAgIHByaXZhdGUgSkxhYmVsIGNoYW5nZUFtb3VudExhYmVsO1xuXG4gICAgLy8gRGF0YVxuICAgIHByaXZhdGUgTWFwPFN0cmluZywgU3RyaW5nPiB0aWNrZXRzTWFwOyAvLyBNYXAgb2Ygc2VhdCBJRHMgdG8gc2NoZWR1bGUgSURzXG4gICAgcHJpdmF0ZSBDb2xvciBwcmltYXJ5Q29sb3IgPSBuZXcgQ29sb3IoMCwgMTM2LCAyMDQpO1xuXG4gICAgLy8gRW1wbG95ZWUgaW5mb3JtYXRpb25cbiAgICBwcml2YXRlIE5oYW5WaWVuIG5oYW5WaWVuO1xuXG4gICAgLy8gREFPc1xuICAgIHByaXZhdGUgTGljaFRyaW5oVGF1REFPIGxpY2hUcmluaFRhdURBTztcbiAgICBwcml2YXRlIENob05nb2lEQU8gY2hvTmdvaURBTztcbiAgICBwcml2YXRlIFRvYVRhdURBTyB0b2FUYXVEQU87XG4gICAgcHJpdmF0ZSBUYXVEQU8gdGF1REFPO1xuICAgIHByaXZhdGUgS2h1eWVuTWFpREFPIGtodXllbk1haURBTztcbiAgICBwcml2YXRlIEtoYWNoSGFuZ0RBTyBraGFjaEhhbmdEQU87XG4gICAgcHJpdmF0ZSBkYW8uTG9haUtoYWNoSGFuZ0RBTyBsb2FpS2hhY2hIYW5nREFPO1xuICAgIHByaXZhdGUgVmVUYXVEQU8gdmVUYXVEQU87XG4gICAgcHJpdmF0ZSBIb2FEb25EQU8gaG9hRG9uREFPO1xuICAgIHByaXZhdGUgQ2hpVGlldEhvYURvbkRBTyBjaGlUaWV0SG9hRG9uREFPO1xuICAgIHByaXZhdGUgTG9haUhvYURvbkRBTyBsb2FpSG9hRG9uREFPO1xuXG4gICAgLyoqXG4gICAgICogQ29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0gdGlja2V0c01hcCBNYXAgb2Ygc2VhdCBJRHMgdG8gc2NoZWR1bGUgSURzXG4gICAgICogQHBhcmFtIG52IFRoZSBlbXBsb3llZSB3aG8gaXMgcHJvY2Vzc2luZyB0aGUgcGF5bWVudFxuICAgICAqL1xuICAgIHB1YmxpYyBUaGFuaFRvYW5HVUkoTWFwPFN0cmluZywgU3RyaW5nPiB0aWNrZXRzTWFwLCBOaGFuVmllbiBudikgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgICAgIHRoaXMudGlja2V0c01hcCA9IHRpY2tldHNNYXA7XG4gICAgICAgIHRoaXMubmhhblZpZW4gPSBudjtcblxuICAgICAgICAvLyBJbml0aWFsaXplIERBT3NcbiAgICAgICAgbGljaFRyaW5oVGF1REFPID0gbmV3IExpY2hUcmluaFRhdURBT0ltcGwoKTtcbiAgICAgICAgY2hvTmdvaURBTyA9IG5ldyBDaG9OZ29pREFPSW1wbCgpO1xuICAgICAgICB0b2FUYXVEQU8gPSBuZXcgVG9hVGF1REFPSW1wbCgpO1xuICAgICAgICB0YXVEQU8gPSBuZXcgVGF1REFPSW1wbCgpO1xuICAgICAgICBraHV5ZW5NYWlEQU8gPSBuZXcgS2h1eWVuTWFpREFPSW1wbCgpO1xuICAgICAgICBraGFjaEhhbmdEQU8gPSBuZXcgS2hhY2hIYW5nREFPSW1wbCgpO1xuICAgICAgICBsb2FpS2hhY2hIYW5nREFPID0gbmV3IExvYWlLaGFjaEhhbmdEQU9JbXBsKCk7XG5cbiAgICAgICAgc2V0VGl0bGUoXCJUaGFuaCB0b8OhbiB2w6kgdMOgdVwiKTtcbiAgICAgICAgc2V0U2l6ZSgxMDAwLCA3MDApO1xuICAgICAgICBzZXREZWZhdWx0Q2xvc2VPcGVyYXRpb24oSkZyYW1lLkRJU1BPU0VfT05fQ0xPU0UpO1xuICAgICAgICBzZXRMb2NhdGlvblJlbGF0aXZlVG8obnVsbCk7XG5cbiAgICAgICAgaW5pdENvbXBvbmVudHMoKTtcbiAgICAgICAgY2FsY3VsYXRlVG90YWwoKTtcbiAgICB9XG4uLi5cblxuICAgICAgICAvLyBDcmVhdGUgc291dGggcGFuZWwgZm9yIGN1c3RvbWVyIGluZm8gYW5kIHBheW1lbnQgYnV0dG9uXG4gICAgICAgIEpQYW5lbCBzb3V0aFBhbmVsID0gbmV3IEpQYW5lbChuZXcgQm9yZGVyTGF5b3V0KDAsIDEwKSk7XG5cbiAgICAgICAgLy8gQ3VzdG9tZXIgaW5mb3JtYXRpb24gc2VjdGlvblxuICAgICAgICBKUGFuZWwgY3VzdG9tZXJQYW5lbCA9IGNyZWF0ZUN1c3RvbWVySW5mb1BhbmVsKCk7XG4gICAgICAgIHNvdXRoUGFuZWwuYWRkKGN1c3RvbWVyUGFuZWwsIEJvcmRlckxheW91dC5OT1JUSCk7XG5cbiAgICAgICAgLy8gUGF5bWVudCBidXR0b25cbiAgICAgICAgSlBhbmVsIHBheW1lbnRQYW5lbCA9IG5ldyBKUGFuZWwobmV3IEZsb3dMYXlvdXQoRmxvd0xheW91dC5SSUdIVCkpO1xuICAgICAgICBKQnV0dG9uIHBheUJ1dHRvbiA9IG5ldyBKQnV0dG9uKFwiVGhhbmggdG/DoW5cIik7XG4gICAgICAgIHBheUJ1dHRvbi5zZXRCYWNrZ3JvdW5kKHByaW1hcnlDb2xvcik7XG4gICAgICAgIHBheUJ1dHRvbi5zZXRGb3JlZ3JvdW5kKENvbG9yLldISVRFKTtcbiAgICAgICAgcGF5QnV0dG9uLnNldEZvbnQobmV3IEZvbnQoXCJBcmlhbFwiLCBGb250LkJPTEQsIDE0KSk7XG4gICAgICAgIHBheUJ1dHRvbi5zZXRQcmVmZXJyZWRTaXplKG5ldyBEaW1lbnNpb24oMTIwLCAzNSkpO1xuICAgICAgICBwYXlCdXR0b24uYWRkQWN0aW9uTGlzdGVuZXIoZSAtPiBwcm9jZXNzUGF5bWVudCgpKTtcbiAgICAgICAgcGF5bWVudFBhbmVsLmFkZChwYXlCdXR0b24pO1xuICAgICAgICBzb3V0aFBhbmVsLmFkZChwYXltZW50UGFuZWwsIEJvcmRlckxheW91dC5TT1VUSCk7XG4uLi5cblxuICAgICAgICAvLyBBZGQgdGFibGUgZGF0YSBmb3IgZWFjaCB0aWNrZXRcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGZvciAoTWFwLkVudHJ5PFN0cmluZywgU3RyaW5nPiBlbnRyeSA6IHRpY2tldHNNYXAuZW50cnlTZXQoKSkge1xuICAgICAgICAgICAgICAgIFN0cmluZyBzZWF0SWQgPSBlbnRyeS5nZXRLZXkoKTtcbiAgICAgICAgICAgICAgICBTdHJpbmcgbGljaFRyaW5oSWQgPSBlbnRyeS5nZXRWYWx1ZSgpO1xuXG4gICAgICAgICAgICAgICAgLy8gR2V0IHRpY2tldCBpbmZvcm1hdGlvbiBmcm9tIGRhdGFiYXNlIHVzaW5nIERBT3NcbiAgICAgICAgICAgICAgICBhZGRUaWNrZXRUb1RhYmxlKHNlYXRJZCwgbGljaFRyaW5oSWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIFwiTOG7l2kga2hpIHThuqNpIHRow7RuZyB0aW4gdsOpOiBcIiArIGUuZ2V0TWVzc2FnZSgpLFxuICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsXG4gICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0VcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICB9XG4uLi5cblxuICAgIC8qKlxuICAgICAqIEFkZCBhIHRpY2tldCB0byB0aGUgdGFibGUgdXNpbmcgc2VhdElkIGFuZCBzY2hlZHVsZUlkXG4gICAgICovXG4gICAgcHJpdmF0ZSB2b2lkIGFkZFRpY2tldFRvVGFibGUoU3RyaW5nIHNlYXRJZCwgU3RyaW5nIHNjaGVkdWxlSWQpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEdldCBzZWF0IGluZm9ybWF0aW9uXG4gICAgICAgICAgICBDaG9OZ29pIGNob05nb2kgPSBjaG9OZ29pREFPLmdldEJ5SWQoc2VhdElkKTtcbiAgICAgICAgICAgIGlmIChjaG9OZ29pID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCJLaMO0bmcgdMOsbSB0aOG6pXkgdGjDtG5nIHRpbiBnaOG6vzogXCIgKyBzZWF0SWQpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2V0IHNjaGVkdWxlIGluZm9ybWF0aW9uXG4gICAgICAgICAgICBMaWNoVHJpbmhUYXUgbGljaFRyaW5oID0gbGljaFRyaW5oVGF1REFPLmdldEJ5SWQoc2NoZWR1bGVJZCk7XG4gICAgICAgICAgICBpZiAobGljaFRyaW5oID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCJLaMO0bmcgdMOsbSB0aOG6pXkgdGjDtG5nIHRpbiBs4buLY2ggdHLDrG5oOiBcIiArIHNjaGVkdWxlSWQpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2V0IHRvYSBpbmZvcm1hdGlvbiAoZnJvbSBzZWF0J3MgdG9hSWQpXG4gICAgICAgICAgICBTdHJpbmcgdG9hSWQgPSBjaG9OZ29pLmdldFRvYVRhdSgpLmdldE1hVG9hKCk7XG4gICAgICAgICAgICBUb2FUYXUgdG9hVGF1ID0gdG9hVGF1REFPLmdldFRvYVRhdUJ5SWQodG9hSWQpO1xuICAgICAgICAgICAgaWYgKHRvYVRhdSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFwiS2jDtG5nIHTDrG0gdGjhuqV5IHRow7RuZyB0aW4gdG9hOiBcIiArIHRvYUlkKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdldCB0cmFpbiBpbmZvcm1hdGlvblxuICAgICAgICAgICAgVGF1IHRhdSA9IHRhdURBTy5nZXRUYXVCeUxpY2hUcmluaFRhdShsaWNoVHJpbmgpO1xuICAgICAgICAgICAgaWYgKHRhdSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFwiS2jDtG5nIHTDrG0gdGjhuqV5IHRow7RuZyB0aW4gdMOgdSBjaG8gbOG7i2NoIHRyw6xuaDogXCIgKyBzY2hlZHVsZUlkKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdldCBzZWF0IG5hbWUvbnVtYmVyXG4gICAgICAgICAgICBTdHJpbmcgc2VhdE5hbWUgPSBjaG9OZ29pLmdldFRlbkNobygpICE9IG51bGwgPyBjaG9OZ29pLmdldFRlbkNobygpIDogc2VhdElkO1xuXG4gICAgICAgICAgICAvLyBHZXQgcHJpY2UgYmFzZWQgb24gc2VhdCBjbGFzcyBhbmQgcm91dGVcbiAgICAgICAgICAgIGRvdWJsZSBwcmljZSA9IGdldFNlYXRQcmljZShjaG9OZ29pLCB0b2FUYXUpO1xuXG4gICAgICAgICAgICAvLyBHZXQgcm91dGUgaW5mb3JtYXRpb25cbiAgICAgICAgICAgIFN0cmluZyBmcm9tID0gbGljaFRyaW5oLmdldFRhdSgpLmdldFR1eWVuVGF1KCkuZ2V0R2FEaSgpO1xuICAgICAgICAgICAgU3RyaW5nIHRvID0gbGljaFRyaW5oLmdldFRhdSgpLmdldFR1eWVuVGF1KCkuZ2V0R2FEZW4oKTtcblxuICAgICAgICAgICAgLy8gRm9ybWF0IGRhdGUgYW5kIHRpbWVcbiAgICAgICAgICAgIFN0cmluZyBkZXBhcnREYXRlID0gbGljaFRyaW5oLmdldE5nYXlEaSgpLmZvcm1hdChEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oXCJkZC9NTS95eXl5XCIpKTtcbiAgICAgICAgICAgIFN0cmluZyBkZXBhcnRUaW1lID0gbGljaFRyaW5oLmdldEdpb0RpKCkuZm9ybWF0KERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybihcIkhIOm1tXCIpKTtcbi4uLlxuXG4gICAgICAgICAgICAvLyBGb3JtYXQgcHJpY2VcbiAgICAgICAgICAgIFN0cmluZyBwcmljZVN0ciA9IGZvcm1hdEN1cnJlbmN5KHByaWNlKTtcblxuICAgICAgICAgICAgLy8gVkFUIGNhbGN1bGF0aW9uIChmaXhlZCBhdCAxMCUpXG4gICAgICAgICAgICBTdHJpbmcgdmF0U3RyID0gXCIxMCVcIjtcblxuICAgICAgICAgICAgLy8gUGFzc2VuZ2VyIHR5cGUgZGlzY291bnQgKGVtcHR5IGZvciBub3cpXG4gICAgICAgICAgICBTdHJpbmcgcHJvbW90aW9uID0gXCJcIjtcblxuICAgICAgICAgICAgLy8gUHJvbW90aW9uIGRpc2NvdW50IChlbXB0eSBmb3Igbm93KVxuICAgICAgICAgICAgU3RyaW5nIHByb21vdGlvbkRpc2NvdW50U3RyID0gXCIwXCI7XG5cbiAgICAgICAgICAgIC8vIENhbGN1bGF0ZSB0b3RhbCAocHJpY2UgKyBWQVQpXG4gICAgICAgICAgICBkb3VibGUgdG90YWxGb3JUaWNrZXQgPSBwcmljZSArIChwcmljZSAqIDAuMSk7XG4gICAgICAgICAgICBTdHJpbmcgdG90YWxTdHIgPSBmb3JtYXRDdXJyZW5jeSh0b3RhbEZvclRpY2tldCk7XG5cbiAgICAgICAgICAgIC8vIENyZWF0ZSBwYXNzZW5nZXIgaW5mbyBjb21wb25lbnQgLSB3aWxsIGJlIHJlcGxhY2VkIGJ5IHRoZSBjdXN0b20gcmVuZGVyZXJcbiAgICAgICAgICAgIFBhc3NlbmdlckluZm8gcGFzc2VuZ2VySW5mbyA9IG5ldyBQYXNzZW5nZXJJbmZvKCk7XG5cbiAgICAgICAgICAgIC8vIEFkZCByb3cgdG8gdGFibGVcbiAgICAgICAgICAgIHRhYmxlTW9kZWwuYWRkUm93KG5ldyBPYmplY3RbXSB7XG4gICAgICAgICAgICAgICAgICAgIHBhc3NlbmdlckluZm8sIHNlYXRJbmZvLCBwcmljZVN0ciwgdmF0U3RyLFxuICAgICAgICAgICAgICAgICAgICBwcm9tb3Rpb24sIHByb21vdGlvbkRpc2NvdW50U3RyLCB0b3RhbFN0ciwgXCJYXCJcbiAgICAgICAgICAgIH0pO1xuLi4uXG5cbiAgICAgICAgICAgIC8vIFBhcnNlIGFtb3VudCBwYWlkIChyZW1vdmUgY29tbWFzIGlmIHByZXNlbnQpXG4gICAgICAgICAgICBkb3VibGUgYW1vdW50UGFpZCA9IERvdWJsZS5wYXJzZURvdWJsZShhbW91bnRQYWlkU3RyLnJlcGxhY2UoXCIsXCIsIFwiXCIpKTtcblxuICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIGNoYW5nZVxuICAgICAgICAgICAgZG91YmxlIGNoYW5nZSA9IGFtb3VudFBhaWQgLSB0b3RhbEFtb3VudDtcblxuICAgICAgICAgICAgLy8gVXBkYXRlIGNoYW5nZSBhbW91bnQgbGFiZWxcbiAgICAgICAgICAgIGlmIChjaGFuZ2UgPj0gMCkge1xuICAgICAgICAgICAgICAgIGNoYW5nZUFtb3VudExhYmVsLnNldFRleHQoZm9ybWF0Q3VycmVuY3koY2hhbmdlKSk7XG4gICAgICAgICAgICAgICAgY2hhbmdlQW1vdW50TGFiZWwuc2V0Rm9yZWdyb3VuZChuZXcgQ29sb3IoMCwgMTI4LCAwKSk7IC8vIEdyZWVuIGZvciBwb3NpdGl2ZSBjaGFuZ2VcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY2hhbmdlQW1vdW50TGFiZWwuc2V0VGV4dChcIlRoaeG6v3U6IFwiICsgZm9ybWF0Q3VycmVuY3koTWF0aC5hYnMoY2hhbmdlKSkpO1xuICAgICAgICAgICAgICAgIGNoYW5nZUFtb3VudExhYmVsLnNldEZvcmVncm91bmQoQ29sb3IuUkVEKTsgLy8gUmVkIGZvciBuZWdhdGl2ZSBjaGFuZ2UgKGluc3VmZmljaWVudCBwYXltZW50KVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChOdW1iZXJGb3JtYXRFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgLy8gSW52YWxpZCBpbnB1dCwgc2V0IGNoYW5nZSB0byAwXG4gICAgICAgICAgICBjaGFuZ2VBbW91bnRMYWJlbC5zZXRUZXh0KFwiTmjhuq1wIGtow7RuZyBo4bujcCBs4buHXCIpO1xuICAgICAgICAgICAgY2hhbmdlQW1vdW50TGFiZWwuc2V0Rm9yZWdyb3VuZChDb2xvci5SRUQpO1xuICAgICAgICB9XG4gICAgfVxuLi4uXG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGRvdWJsZSBhbW91bnRQYWlkID0gRG91YmxlLnBhcnNlRG91YmxlKGFtb3VudFBhaWRGaWVsZC5nZXRUZXh0KCkudHJpbSgpLnJlcGxhY2UoXCIsXCIsIFwiXCIpKTtcbiAgICAgICAgICAgIGlmIChhbW91bnRQYWlkIDwgdG90YWxBbW91bnQpIHtcbiAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIlPhu5EgdGnhu4FuIGtow6FjaCDEkcawYSBraMO0bmcgxJHhu6cgxJHhu4MgdGhhbmggdG/DoW5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2lcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0VcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGFtb3VudFBhaWRGaWVsZC5yZXF1ZXN0Rm9jdXMoKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKE51bWJlckZvcm1hdEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgXCJT4buRIHRp4buBbiBraMOhY2ggxJHGsGEga2jDtG5nIGjhu6NwIGzhu4dcIixcbiAgICAgICAgICAgICAgICAgICAgXCJM4buXaVwiLFxuICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgYW1vdW50UGFpZEZpZWxkLnJlcXVlc3RGb2N1cygpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU2hvdyBwYXltZW50IG9wdGlvbnMgZGlhbG9nXG4gICAgICAgIFN0cmluZ1tdIG9wdGlvbnMgPSB7XCJUaeG7gW4gbeG6t3RcIiwgXCJUaOG6uyB0w61uIGThu6VuZ1wiLCBcIkNodXnhu4NuIGtob+G6o25cIiwgXCJWw60gxJFp4buHbiB04butXCJ9O1xuICAgICAgICBpbnQgY2hvaWNlID0gSk9wdGlvblBhbmUuc2hvd09wdGlvbkRpYWxvZyhcbiAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgIFwiQ2jhu41uIHBoxrDGoW5nIHRo4bupYyB0aGFuaCB0b8OhblwiLFxuICAgICAgICAgICAgICAgIFwiVGhhbmggdG/DoW5cIixcbiAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5ERUZBVUxUX09QVElPTixcbiAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5RVUVTVElPTl9NRVNTQUdFLFxuICAgICAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgICAgICAgICBvcHRpb25zWzBdXG4gICAgICAgICk7XG5cbiAgICAgICAgLy8gUHJvY2VzcyBiYXNlZCBvbiBzZWxlY3RlZCBwYXltZW50IG1ldGhvZFxuICAgICAgICBpZiAoY2hvaWNlID49IDApIHtcbiAgICAgICAgICAgIC8vIFNob3cgcHJvY2Vzc2luZyBtZXNzYWdlXG4gICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgXCLEkGFuZyB44butIGzDvSB0aGFuaCB0b8Ohbi4uLlwiLFxuICAgICAgICAgICAgICAgICAgICBcIlRoYW5oIHRvw6FuXCIsXG4gICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLklORk9STUFUSU9OX01FU1NBR0VcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gR2V0IGN1c3RvbWVyIGluZm9ybWF0aW9uIGZyb20gZm9ybVxuICAgICAgICAgICAgICAgIFN0cmluZyBjdXN0b21lck5hbWUgPSBuYW1lRmllbGQuZ2V0VGV4dCgpLnRyaW0oKTtcbiAgICAgICAgICAgICAgICBTdHJpbmcgaWRDYXJkID0gaWRDYXJkRmllbGQuZ2V0VGV4dCgpLnRyaW0oKTtcbiAgICAgICAgICAgICAgICBTdHJpbmcgcGhvbmUgPSBwaG9uZUZpZWxkLmdldFRleHQoKS50cmltKCk7XG4gICAgICAgICAgICAgICAgU3RyaW5nIGVtYWlsID0gZW1haWxGaWVsZC5nZXRUZXh0KCkudHJpbSgpOyAvLyBUaGlzIGlzIHRoZSBhZGRyZXNzIGZpZWxkIGFzIHBlciByZXF1aXJlbWVudHNcblxuICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIGN1c3RvbWVyIGV4aXN0cyBieSBJRCBjYXJkIGFuZCBwaG9uZSBudW1iZXJcbiAgICAgICAgICAgICAgICBLaGFjaEhhbmcgZXhpc3RpbmdDdXN0b21lciA9IGtoYWNoSGFuZ0RBTy5maW5kQnlJZENhcmRBbmRQaG9uZShpZENhcmQsIHBob25lKTtcblxuICAgICAgICAgICAgICAgIGlmIChleGlzdGluZ0N1c3RvbWVyICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQ3VzdG9tZXIgZXhpc3RzXG4gICAgICAgICAgICAgICAgICAgIGlmIChcIlZJUFwiLmVxdWFsc0lnbm9yZUNhc2UoZXhpc3RpbmdDdXN0b21lci5nZXRIYW5nVGhhbmhWaWVuKCkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDdXN0b21lciBpcyBWSVAsIGFkZCBsb3lhbHR5IHBvaW50cyAoMSBwb2ludCBwZXIgMTAsMDAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgaW50IHBvaW50c1RvQWRkID0gKGludCkgKHRvdGFsQW1vdW50IC8gMTAwMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmdDdXN0b21lci5zZXREaWVtVGljaEx1eShleGlzdGluZ0N1c3RvbWVyLmdldERpZW1UaWNoTHV5KCkgKyBwb2ludHNUb0FkZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBjdXN0b21lciBpbiBkYXRhYmFzZVxuICAgICAgICAgICAgICAgICAgICAgICAga2hhY2hIYW5nREFPLnVwZGF0ZShleGlzdGluZ0N1c3RvbWVyKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiS2jDoWNoIGjDoG5nIFZJUCDEkcOjIMSRxrDhu6NjIGPhu5luZyBcIiArIHBvaW50c1RvQWRkICsgXCIgxJFp4buDbSB0w61jaCBsxal5LlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlRow7RuZyBiw6FvXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLklORk9STUFUSU9OX01FU1NBR0VcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDdXN0b21lciBleGlzdHMgYnV0IGlzIG5vdCBWSVAsIGRvbid0IGFkZCBwb2ludHNcbiAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIktow6FjaCBow6BuZyBraMO0bmcgcGjhuqNpIFZJUCwga2jDtG5nIMSRxrDhu6NjIGPhu5luZyDEkWnhu4NtIHTDrWNoIGzFqXkuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiVGjDtG5nIGLDoW9cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRVxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEN1c3RvbWVyIGRvZXNuJ3QgZXhpc3QsIGNyZWF0ZSBuZXcgY3VzdG9tZXJcbiAgICAgICAgICAgICAgICAgICAgS2hhY2hIYW5nIG5ld0N1c3RvbWVyID0gbmV3IEtoYWNoSGFuZygpO1xuICAgICAgICAgICAgICAgICAgICBuZXdDdXN0b21lci5zZXRUZW5LaGFjaEhhbmcoY3VzdG9tZXJOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgbmV3Q3VzdG9tZXIuc2V0R2lheVRvKGlkQ2FyZCk7XG4gICAgICAgICAgICAgICAgICAgIG5ld0N1c3RvbWVyLnNldFNvRGllblRob2FpKHBob25lKTtcbiAgICAgICAgICAgICAgICAgICAgbmV3Q3VzdG9tZXIuc2V0RGlhQ2hpKGVtYWlsKTsgLy8gRW1haWwgYWRkcmVzcyBhcyBwZXIgcmVxdWlyZW1lbnRzXG4gICAgICAgICAgICAgICAgICAgIG5ld0N1c3RvbWVyLnNldEhhbmdUaGFuaFZpZW4oXCJWw6NuZyBsYWlcIik7IC8vIERlZmF1bHQgbWVtYmVyIHJhbmtcbiAgICAgICAgICAgICAgICAgICAgbmV3Q3VzdG9tZXIuc2V0RGllbVRpY2hMdXkoMC4wKTsgLy8gSW5pdGlhbCBsb3lhbHR5IHBvaW50c1xuICAgICAgICAgICAgICAgICAgICBuZXdDdXN0b21lci5zZXROZ2F5U2luaChMb2NhbERhdGUubm93KCkpOyAvLyBEZWZhdWx0IGJpcnRoIGRhdGUsIHNob3VsZCBiZSB1cGRhdGVkIGxhdGVyXG4gICAgICAgICAgICAgICAgICAgIG5ld0N1c3RvbWVyLnNldE5nYXlUaGFtZ0dpYShMb2NhbERhdGUubm93KCkpOyAvLyBKb2luIGRhdGUgaXMgdG9kYXlcblxuICAgICAgICAgICAgICAgICAgICAvLyBHZXQgYSBkZWZhdWx0IGN1c3RvbWVyIHR5cGVcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEdldCBhbGwgY3VzdG9tZXIgdHlwZXNcbiAgICAgICAgICAgICAgICAgICAgICAgIExpc3Q8TG9haUtoYWNoSGFuZz4gdHlwZXMgPSBsb2FpS2hhY2hIYW5nREFPLmdldEFsbCgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUcnkgdG8gZmluZCBhIGRlZmF1bHQgY3VzdG9tZXIgdHlwZSAoYXNzdW1pbmcgXCJUaMaw4budbmdcIiBpcyB0aGUgZGVmYXVsdCB0eXBlKVxuICAgICAgICAgICAgICAgICAgICAgICAgTG9haUtoYWNoSGFuZyBkZWZhdWx0VHlwZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKExvYWlLaGFjaEhhbmcgdHlwZSA6IHR5cGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFwiVGjGsOG7nW5nXCIuZXF1YWxzKHR5cGUuZ2V0VGVuTG9haUtoYWNoSGFuZygpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0VHlwZSA9IHR5cGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgXCJUaMaw4budbmdcIiB0eXBlIGRvZXNuJ3QgZXhpc3QsIHVzZSB0aGUgZmlyc3QgYXZhaWxhYmxlIHR5cGVcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZWZhdWx0VHlwZSA9PSBudWxsICYmICF0eXBlcy5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0VHlwZSA9IHR5cGVzLmdldCgwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRlZmF1bHRUeXBlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdDdXN0b21lci5zZXRMb2FpS2hhY2hIYW5nKGRlZmF1bHRUeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbihcIktow7RuZyB0w6xtIHRo4bqleSBsb+G6oWkga2jDoWNoIGjDoG5nIG7DoG8gdHJvbmcgY8ahIHPhu58gZOG7ryBsaeG7h3VcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaSBraGkgdMOsbSBsb+G6oWkga2jDoWNoIGjDoG5nOiBcIiArIGUuZ2V0TWVzc2FnZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0VcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBBZGQgbmV3IGN1c3RvbWVyIHRvIGRhdGFiYXNlXG4gICAgICAgICAgICAgICAgICAgIGtoYWNoSGFuZ0RBTy5hZGQobmV3Q3VzdG9tZXIpO1xuXG4gICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCLEkMOjIHRow6ptIGtow6FjaCBow6BuZyBt4bubaSB2w6BvIGPGoSBz4bufIGThu68gbGnhu4d1LlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiVGjDtG5nIGLDoW9cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5JTkZPUk1BVElPTl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIGNoYW5nZSBmb3IgY2FzaCBwYXltZW50XG4gICAgICAgICAgICAgICAgU3RyaW5nIGNoYW5nZU1lc3NhZ2UgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChjaG9pY2UgPT0gMCkgeyAvLyBDYXNoIHBheW1lbnRcbiAgICAgICAgICAgICAgICAgICAgZG91YmxlIGFtb3VudFBhaWQgPSBEb3VibGUucGFyc2VEb3VibGUoYW1vdW50UGFpZEZpZWxkLmdldFRleHQoKS50cmltKCkucmVwbGFjZShcIixcIiwgXCJcIikpO1xuICAgICAgICAgICAgICAgICAgICBkb3VibGUgY2hhbmdlID0gYW1vdW50UGFpZCAtIHRvdGFsQW1vdW50O1xuICAgICAgICAgICAgICAgICAgICBpZiAoY2hhbmdlID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlTWVzc2FnZSA9IFwiXFxuVGnhu4FuIHRo4buRaSBs4bqhaTogXCIgKyBmb3JtYXRDdXJyZW5jeShjaGFuZ2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gU2hvdyBzdWNjZXNzIG1lc3NhZ2VcbiAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIlRoYW5oIHRvw6FuIHRow6BuaCBjw7RuZyEgVsOpIGPhu6dhIGLhuqFuIMSRw6MgxJHGsOG7o2MgxJHhurd0LlwiICsgY2hhbmdlTWVzc2FnZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiVGjDoG5oIGPDtG5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5JTkZPUk1BVElPTl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIC8vIENsb3NlIGNoZWNrb3V0IHdpbmRvd1xuICAgICAgICAgICAgICAgIGRpc3Bvc2UoKTtcblxuICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpIGtoaSB44butIGzDvSB0aGFuaCB0b8OhbjogXCIgKyBlLmdldE1lc3NhZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2lcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0VcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZ3VpQ2xpZW50L1RyYVZlUGFuZWwuamF2YVxuLi4uXG5cbiAgICAgICAgICAgIC8vIFThuqFvIGjDs2EgxJHGoW4gbeG7m2lcbiAgICAgICAgICAgIEhvYURvbiBob2FEb24gPSBuZXcgSG9hRG9uKCk7XG5cbiAgICAgICAgICAgIC8vIFNpbmggbcOjIGjDs2EgxJHGoW4gdGhlbyDEkeG7i25oIGThuqFuZyBIRCB5eXl5L01NL2RkIFhYWFhcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgU3RyaW5nIG1hSG9hRG9uID0gaG9hRG9uREFPLmdlbmVyYXRlTWFIb2FEb24oTG9jYWxEYXRlLm5vdygpKTtcbiAgICAgICAgICAgICAgICBob2FEb24uc2V0TWFIRChtYUhvYURvbik7XG4gICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgICAgICAgICAgLy8gTuG6v3UgY8OzIGzhu5dpLCB04bqhbyBtw6MgaMOzYSDEkcahbiB0aOG7pyBjw7RuZyB24bubaSB0aW1lc3RhbXBcbiAgICAgICAgICAgICAgICBTdHJpbmcgbWFIb2FEb24gPSBcIkhEXCIgKyBMb2NhbERhdGUubm93KCkuZm9ybWF0KERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybihcInl5eXlNTWRkXCIpKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCkgJSAxMDAwMDtcbiAgICAgICAgICAgICAgICBob2FEb24uc2V0TWFIRChtYUhvYURvbik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFRoaeG6v3QgbOG6rXAgY8OhYyB0aMO0bmcgdGluIGjDs2EgxJHGoW5cbiAgICAgICAgICAgIGhvYURvbi5zZXROZ2F5TGFwKExvY2FsRGF0ZVRpbWUubm93KCkpO1xuICAgICAgICAgICAgaG9hRG9uLnNldFRpZW5HaWFtKDApOyAvLyBLaMO0bmcgY8OzIGdp4bqjbSBnacOhIGtoaSB0cuG6oyB2w6lcbiAgICAgICAgICAgIGhvYURvbi5zZXRUb25nVGllbih0aWVuVHJhTGFpKTsgLy8gVOG7lW5nIHRp4buBbiBsw6Agc+G7kSB0aeG7gW4gdHLhuqMgbOG6oWkga2jDoWNoXG4gICAgICAgICAgICBob2FEb24uc2V0S2hhY2hIYW5nKGtoYWNoSGFuZyk7XG4gICAgICAgICAgICBob2FEb24uc2V0TnYobmhhblZpZW4pOyAvLyBOaMOibiB2acOqbiDEkWFuZyDEkcSDbmcgbmjhuq1wXG5cbiAgICAgICAgICAgIC8vIFRoaeG6v3QgbOG6rXAgbG/huqFpIGjDs2EgxJHGoW4gbMOgIFwixJDDoyB0cuG6o1wiIChMSEQwMDIpXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIExvYWlIb2FEb24gbG9haUhvYURvbiA9IGhvYURvbkRBTy5nZXRMb2FpSG9hRG9uQnlJZChcIkxIRDAwMlwiKTtcbiAgICAgICAgICAgICAgICBpZiAobG9haUhvYURvbiA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBSdW50aW1lRXhjZXB0aW9uKFwiS2jDtG5nIHTDrG0gdGjhuqV5IGxv4bqhaSBow7NhIMSRxqFuIExIRDAwMlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaG9hRG9uLnNldExvYWlIb2FEb24obG9haUhvYURvbik7XG4gICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFeGNlcHRpb24oXCJM4buXaSBraGkgbOG6pXkgdGjDtG5nIHRpbiBsb+G6oWkgaMOzYSDEkcahbjogXCIgKyBlLmdlLi4uIiwiaXNFcnJvciI6ZmFsc2UsInJlcXVlc3RJZCI6IiJ9fSwiN2Y2ZDA1OGQtMTkzNy00ZDUzLTk3OTMtODA1YTVmOTM5MDY1O3Rvb2x1XzAxOW1XRW83bTRIQjE1cXdFRm1xakI3aiI6eyJwaGFzZSI6NiwicmVzdWx0Ijp7InRleHQiOiJSYW4gaW50byBVbmtub3duIGVycm9yIHdoaWxlIHRyeWluZyB0byByZWFkIFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZ3VpQ2xpZW50L1RoYW5oVG9hbkdVSS5qYXZhIiwiaXNFcnJvciI6dHJ1ZSwicmVxdWVzdElkIjoiIn19LCI1OTRmYjk1MS1iYTllLTRjOWYtYTM4Ni0wYzhmYWIwZTk1YTI7dG9vbHVfMDEzQzNRWW5CVmQ2V2FHUkZZaXU3WWNaIjp7InBoYXNlIjo1LCJyZXN1bHQiOnsidGV4dCI6IkhlcmUgYXJlIHRoZSByZXN1bHRzIGZyb20gZXhlY3V0aW5nIHRoZSBjb21tYW5kLlxuICAgICAgICA8cmV0dXJuLWNvZGU+XG4gICAgICAgIDBcbiAgICAgICAgPC9yZXR1cm4tY29kZT5cbiAgICAgICAgPHN0ZG91dD5cbiAgICAgICAgXHUwMDFiWz85MDAxaFx1MDAxYls/MTAwNGhcdTAwMWJbPzI1bFx1MDAxYlsySlx1MDAxYlttXHUwMDFiWzM4OzU7MTVtXHUwMDFiW0gxODc6ICAgICAgICBcdTAwMWJbbXBheUJ1dHRvbi5hZGRBY3Rpb25MaXN0ZW5lcihlIC0+IHByb2Nlc3NQYXltZW50KCkpO1x1MDAxYlszODs1OzE1bVxuMTE5NzogICAgXHUwMDFiW21wcml2YXRlIHZvaWQgcHJvY2Vzc1BheW1lbnQoKSB7XG5cdTAwMWJdMDtDOlxcV2luZG93c1xcU3lzdGVtMzJcXFdpbmRvd3NQb3dlclNoZWxsXFx2MS4wXFxwb3dlcnNoZWxsLmV4ZVx1MDAwN1x1MDAxYls/MjVoXG4gICAgICAgIDwvc3Rkb3V0PlxuICAgICAgICA8c3RkZXJyPlxuICAgICAgICBcbiAgICAgICAgPC9zdGRlcnI+IiwiaXNFcnJvciI6ZmFsc2UsInJlcXVlc3RJZCI6IiJ9fX0sImRyYWZ0RXhjaGFuZ2UiOnsicmVxdWVzdF9tZXNzYWdlIjoiIiwicmljaF90ZXh0X2pzb25fcmVwciI6eyJ0eXBlIjoiZG9jIiwiY29udGVudCI6W3sidHlwZSI6InBhcmFncmFwaCJ9XX0sIm1lbnRpb25lZF9pdGVtcyI6W10sInN0YXR1cyI6ImRyYWZ0In0sImRyYWZ0QWN0aXZlQ29udGV4dElkcyI6WyJhZ2VudE1lbW9yaWVzIl0sInJlcXVlc3RJZHMiOltdLCJpc1Bpbm5lZCI6ZmFsc2UsImlzU2hhcmVhYmxlIjp0cnVlLCJleHRyYURhdGEiOnsiaXNBZ2VudENvbnZlcnNhdGlvbiI6dHJ1ZSwiaGFzRGlydHlFZGl0cyI6dHJ1ZX0sInBlcnNvbmFUeXBlIjowfSwiZjFiOWU0M2ItMTVjOC00ZWNhLWJmZDctYmIyYzJhODc3M2JkIjp7ImlkIjoiZjFiOWU0M2ItMTVjOC00ZWNhLWJmZDctYmIyYzJhODc3M2JkIiwiY3JlYXRlZEF0SXNvIjoiMjAyNS0wNC0yMlQwNDo1NTo1My4wOTFaIiwibGFzdEludGVyYWN0ZWRBdElzbyI6IjIwMjUtMDQtMjJUMDQ6NTU6NTMuMDkxWiIsImNoYXRIaXN0b3J5IjpbeyJyZXF1ZXN0X2lkIjoiM2Q5ZDYyODktN2ExNC00NTczLWI4N2QtZDlhNDMxYjIxN2JjIiwidXVpZCI6ImNhNjc3NTE0LWQ2NjMtNDJhYy04NmE1LWRkODQxZWQxMzIxOSIsImNoYXRJdGVtVHlwZSI6ImFnZW50aWMtY2hlY2twb2ludC1kZWxpbWl0ZXIiLCJzdGF0dXMiOiJzdWNjZXNzIiwiZnJvbVRpbWVzdGFtcCI6MCwidG9UaW1lc3RhbXAiOjE3NDUyOTc3NTMwOTIsInNlZW5fc3RhdGUiOiJzZWVuIn1dLCJmZWVkYmFja1N0YXRlcyI6e30sInRvb2xVc2VTdGF0ZXMiOnt9LCJkcmFmdEV4Y2hhbmdlIjp7InJlcXVlc3RfbWVzc2FnZSI6IkBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyIsInJpY2hfdGV4dF9qc29uX3JlcHIiOnsidHlwZSI6ImRvYyIsImNvbnRlbnQiOlt7InR5cGUiOiJwYXJhZ3JhcGgiLCJjb250ZW50IjpbeyJ0eXBlIjoibWVudGlvbiIsImF0dHJzIjp7ImlkIjoiL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIiwibGFiZWwiOiJQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyIsImRhdGEiOnsibGFiZWwiOiJQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyIsIm5hbWUiOiJQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyIsImlkIjoiL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIiwiZm9sZGVyIjp7InJlcG9Sb290IjoiIiwicGF0aE5hbWUiOiJQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyJ9LCJ0eXBlIjoiaXRlbSJ9fX1dfV19LCJtZW50aW9uZWRfaXRlbXMiOlt7ImxhYmVsIjoiUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmciLCJuYW1lIjoiUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmciLCJpZCI6Ii9Qcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZyIsImZvbGRlciI6eyJyZXBvUm9vdCI6IiIsInBhdGhOYW1lIjoiUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcifSwidHlwZSI6Iml0ZW0ifV0sInN0YXR1cyI6ImRyYWZ0In0sImRyYWZ0QWN0aXZlQ29udGV4dElkcyI6WyJhZ2VudE1lbW9yaWVzIl0sInJlcXVlc3RJZHMiOltdLCJpc1Bpbm5lZCI6ZmFsc2UsImlzU2hhcmVhYmxlIjpmYWxzZSwiZXh0cmFEYXRhIjp7ImlzQWdlbnRDb252ZXJzYXRpb24iOnRydWUsImhhc0RpcnR5RWRpdHMiOmZhbHNlfSwicGVyc29uYVR5cGUiOjB9LCJmOGQxODUwZC01YzlhLTRhM2UtODU3Ni1jYzZlMzUwMzE0OWMiOnsiaWQiOiJmOGQxODUwZC01YzlhLTRhM2UtODU3Ni1jYzZlMzUwMzE0OWMiLCJjcmVhdGVkQXRJc28iOiIyMDI1LTA0LTIyVDA0OjU2OjExLjEwMVoiLCJsYXN0SW50ZXJhY3RlZEF0SXNvIjoiMjAyNS0wNC0yMlQwOToxODoyOC42MzNaIiwiY2hhdEhpc3RvcnkiOlt7InJlcXVlc3RfaWQiOiJlYWM3ODk5Zi1lZTE4LTQyYzQtYmY3MC01Y2Q4NDAxYjVjODgiLCJ1dWlkIjoiMDc5NWI3MDktMjVlNi00Yjg4LTk3NzMtZTEwMDQ0MzJiOWQ1IiwiY2hhdEl0ZW1UeXBlIjoiYWdlbnRpYy1jaGVja3BvaW50LWRlbGltaXRlciIsInN0YXR1cyI6InN1Y2Nlc3MiLCJmcm9tVGltZXN0YW1wIjowLCJ0b1RpbWVzdGFtcCI6MTc0NTI5Nzc3MTEwMSwic2Vlbl9zdGF0ZSI6InNlZW4ifSx7InN0YXR1cyI6InN1Y2Nlc3MiLCJyZXF1ZXN0X2lkIjoiNDJmZTA3YjUtYWI4Yi00ZDdlLTg2NjYtMjJkZGNiOGJiMTAzIiwicmVxdWVzdF9tZXNzYWdlIjoiY2jhu4luaCBs4bqhaSBUcmFpblRpY2tldEJvb2tpbmdTeXN0ZW0gdsOgIFRoYW5oVG9hbkdVSSBnaeG7kW5nIHbhu5tpIExpY2hUcmluaFRhdVBhbmVsIHLhu5NpIHRow6ptIG7DsyB2w6BvIE1haW5HVUkiLCJyaWNoX3RleHRfanNvbl9yZXByIjp7InR5cGUiOiJkb2MiLCJjb250ZW50IjpbeyJ0eXBlIjoicGFyYWdyYXBoIiwiY29udGVudCI6W3sidHlwZSI6InRleHQiLCJ0ZXh0IjoiY2jhu4luaCBs4bqhaSBUcmFpblRpY2tldEJvb2tpbmdTeXN0ZW0gdsOgIFRoYW5oVG9hbkdVSSBnaeG7kW5nIHbhu5tpIExpY2hUcmluaFRhdVBhbmVsIHLhu5NpIHRow6ptIG7DsyB2w6BvIE1haW5HVUkifV19XX0sIm1lbnRpb25lZF9pdGVtcyI6W10sInN0cnVjdHVyZWRfb3V0cHV0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6NSwiY29udGVudCI6IiIsInRvb2xfdXNlIjp7InRvb2xfdXNlX2lkIjoidG9vbHVfMDEyeDhqOVdMYXNydnRQWllVSnJHY3k1IiwidG9vbF9uYW1lIjoiY29kZWJhc2UtcmV0cmlldmFsIiwiaW5wdXRfanNvbiI6IntcImluZm9ybWF0aW9uX3JlcXVlc3RcIjogXCJGaW5kIHRoZSBMaWNoVHJpbmhUYXVQYW5lbC5qYXZhIGZpbGUgdG8gdW5kZXJzdGFuZCBpdHMgc3RydWN0dXJlIGFuZCBob3cgaXQncyBpbXBsZW1lbnRlZFwifSJ9fSx7ImlkIjowLCJ0eXBlIjowLCJjb250ZW50IjoiSSdsbCBoZWxwIHlvdSBtb2RpZnkgdGhlIFRyYWluVGlja2V0Qm9va2luZ1N5c3RlbSBhbmQgVGhhbmhUb2FuR1VJIGNsYXNzZXMgdG8gbWF0Y2ggdGhlIHN0cnVjdHVyZSBvZiBMaWNoVHJpbmhUYXVQYW5lbCwgYW5kIHRoZW4gYWRkIHRoZW0gdG8gTWFpbkdVSS4gTGV0IG1lIGZpcnN0IGdhdGhlciBpbmZvcm1hdGlvbiBhYm91dCB0aGVzZSBmaWxlcyB0byB1bmRlcnN0YW5kIHRoZWlyIGN1cnJlbnQgc3RydWN0dXJlLlxuIn0seyJpZCI6MiwidHlwZSI6MiwiY29udGVudCI6IiJ9LHsiaWQiOjMsInR5cGUiOjMsImNvbnRlbnQiOiIifV0sInNlZW5fc3RhdGUiOiJzZWVuIiwic3RydWN0dXJlZF9yZXF1ZXN0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6MCwidGV4dF9ub2RlIjp7ImNvbnRlbnQiOiJjaOG7iW5oIGzhuqFpIFRyYWluVGlja2V0Qm9va2luZ1N5c3RlbSB2w6AgVGhhbmhUb2FuR1VJIGdp4buRbmcgduG7m2kgTGljaFRyaW5oVGF1UGFuZWwgcuG7k2kgdGjDqm0gbsOzIHbDoG8gTWFpbkdVSSJ9fSx7ImlkIjoyLCJ0eXBlIjo0LCJpZGVfc3RhdGVfbm9kZSI6eyJ3b3Jrc3BhY2VGb2xkZXJzIjpbeyJyZXBvc2l0b3J5Um9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIiwiZm9sZGVyUm9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIn1dLCJ3b3Jrc3BhY2VGb2xkZXJzVW5jaGFuZ2VkIjpmYWxzZSwiY3VycmVudFRlcm1pbmFsIjp7InRlcm1pbmFsSWQiOjIyLCJjdXJyZW50V29ya2luZ0RpcmVjdG9yeSI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIn19fV0sInJlc3BvbnNlX3RleHQiOiJJJ2xsIGhlbHAgeW91IG1vZGlmeSB0aGUgVHJhaW5UaWNrZXRCb29raW5nU3lzdGVtIGFuZCBUaGFuaFRvYW5HVUkgY2xhc3NlcyB0byBtYXRjaCB0aGUgc3RydWN0dXJlIG9mIExpY2hUcmluaFRhdVBhbmVsLCBhbmQgdGhlbiBhZGQgdGhlbSB0byBNYWluR1VJLiBMZXQgbWUgZmlyc3QgZ2F0aGVyIGluZm9ybWF0aW9uIGFib3V0IHRoZXNlIGZpbGVzIHRvIHVuZGVyc3RhbmQgdGhlaXIgY3VycmVudCBzdHJ1Y3R1cmUuXG4iLCJ3b3Jrc3BhY2VfZmlsZV9jaHVua3MiOltdfSx7InN0YXR1cyI6InN1Y2Nlc3MiLCJyZXF1ZXN0X2lkIjoiMjdjYmQ5NzktZjllYS00ODUyLWJkZGYtYjEyYWQ5ODkxYzhhIiwicmVxdWVzdF9tZXNzYWdlIjoiIiwic3RydWN0dXJlZF9vdXRwdXRfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjo1LCJjb250ZW50IjoiIiwidG9vbF91c2UiOnsidG9vbF91c2VfaWQiOiJ0b29sdV8wMVRYclZEUmFoNWVxNU44UnhMdjd2TVQiLCJ0b29sX25hbWUiOiJjb2RlYmFzZS1yZXRyaWV2YWwiLCJpbnB1dF9qc29uIjoie1wiaW5mb3JtYXRpb25fcmVxdWVzdFwiOiBcIkZpbmQgdGhlIFRyYWluVGlja2V0Qm9va2luZ1N5c3RlbS5qYXZhIGFuZCBUaGFuaFRvYW5HVUkuamF2YSBmaWxlcyB0byB1bmRlcnN0YW5kIHRoZWlyIGN1cnJlbnQgc3RydWN0dXJlXCJ9In19LHsiaWQiOjAsInR5cGUiOjAsImNvbnRlbnQiOiIifSx7ImlkIjoyLCJ0eXBlIjoyLCJjb250ZW50IjoiIn0seyJpZCI6MywidHlwZSI6MywiY29udGVudCI6IiJ9XSwic2Vlbl9zdGF0ZSI6InNlZW4iLCJzdHJ1Y3R1cmVkX3JlcXVlc3Rfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjoxLCJ0b29sX3Jlc3VsdF9ub2RlIjp7ImNvbnRlbnQiOiJUaGUgZm9sbG93aW5nIGNvZGUgc2VjdGlvbnMgd2VyZSByZXRyaWV2ZWQ6XG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9MaWNoVHJpbmhUYXVQYW5lbC5qYXZhXG5wYWNrYWdlIGd1aUNsaWVudDtcblxuaW1wb3J0IGNvbS50b2VkdGVyLmNhbGVuZGFyLkpEYXRlQ2hvb3NlcjtcbmltcG9ydCBkYW8uTGljaFRyaW5oVGF1REFPO1xuaW1wb3J0IGRhby5UYXVEQU87XG5pbXBvcnQgbW9kZWwuTGljaFRyaW5oVGF1O1xuaW1wb3J0IG1vZGVsLlRhdTtcbmltcG9ydCBtb2RlbC5UcmFuZ1RoYWk7XG5pbXBvcnQgc2VydmljZS5BSVRyYXZlbFRpbWVQcmVkaWN0b3I7XG5pbXBvcnQgc2VydmljZS5TY2hlZHVsZVN0YXR1c01hbmFnZXI7XG4uLi5cblxuICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvZ2dlciBMT0dHRVIgPSBMb2dnZXIuZ2V0TG9nZ2VyKExpY2hUcmluaFRhdVBhbmVsLmNsYXNzLmdldE5hbWUoKSk7XG4gICAgLy8gxJDhu4thIGNo4buJIElQIHbDoCBwb3J0IGPhu6dhIFJNSSBzZXJ2ZXJcbiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmcgUk1JX1NFUlZFUl9JUCA9IFwiMTI3LjAuMC4xXCI7XG4gICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgaW50IFJNSV9TRVJWRVJfUE9SVCA9IDkwOTA7XG4gICAgcHJpdmF0ZSBKVGFibGUgc2NoZWR1bGVUYWJsZTtcbiAgICBwcml2YXRlIERlZmF1bHRUYWJsZU1vZGVsIHRhYmxlTW9kZWw7XG4gICAgcHJpdmF0ZSBKRGF0ZUNob29zZXIgZGF0ZUNob29zZXI7XG4gICAgcHJpdmF0ZSBKQnV0dG9uIHNlYXJjaEJ1dHRvbjtcbiAgICBwcml2YXRlIEpCdXR0b24gcmVmcmVzaEJ1dHRvbjtcbiAgICBwcml2YXRlIEpCdXR0b24gYWRkQnV0dG9uO1xuICAgIHByaXZhdGUgSkJ1dHRvbiBlZGl0QnV0dG9uO1xuICAgIHByaXZhdGUgSkJ1dHRvbiBkZWxldGVCdXR0b247XG4gICAgcHJpdmF0ZSBKQ29tYm9Cb3g8T2JqZWN0PiBmaWx0ZXJDb21ib0JveDtcbiAgICBwcml2YXRlIEpUYWJiZWRQYW5lIHZpZXdUYWJiZWRQYW5lOyAvLyBUYWIgxJHhu4MgY2h1eeG7g24gxJHhu5VpIGdp4buvYSBk4bqhbmcgYuG6o25nIHbDoCBs4buLY2hcbiAgICBwcml2YXRlIFRyYWluU2NoZWR1bGVDYWxlbmRhclBhbmVsIGNhbGVuZGFyUGFuZWw7IC8vIFBhbmVsIGThuqFuZyBs4buLY2hcbiAgICBwcml2YXRlIEpQYW5lbCB0YWJsZVZpZXdQYW5lbDsgLy8gUGFuZWwgY2jhu6lhIGLhuqNuZ1xuLi4uXG5cbiAgICBwdWJsaWMgTGljaFRyaW5oVGF1UGFuZWwoKSB7XG4gICAgICAgIHNldExheW91dChuZXcgQm9yZGVyTGF5b3V0KDEwLCAxMCkpO1xuICAgICAgICBzZXRCb3JkZXIoQm9yZGVyRmFjdG9yeS5jcmVhdGVFbXB0eUJvcmRlcigxMCwgMTAsIDEwLCAxMCkpO1xuXG4gICAgICAgIC8vIENvbm5lY3QgdG8gUk1JIHNlcnZlclxuICAgICAgICBjb25uZWN0VG9STUlTZXJ2ZXIoKTtcblxuICAgICAgICAvLyBBZGQgY29tcG9uZW50cyB0byB0aGUgcGFuZWxcbiAgICAgICAgYWRkKGNyZWF0ZVRpdGxlUGFuZWwoKSwgQm9yZGVyTGF5b3V0Lk5PUlRIKTtcbiAgICAgICAgYWRkKGNyZWF0ZUNlbnRlclBhbmVsKCksIEJvcmRlckxheW91dC5DRU5URVIpO1xuXG4gICAgICAgIC8vIExvYWQgaW5pdGlhbCBkYXRhXG4gICAgICAgIGlmIChpc0Nvbm5lY3RlZCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpbml0U3RhdHVzTWFuYWdlcigpO1xuICAgICAgICAgICAgICAgIGxvYWRBbGxTY2hlZHVsZURhdGEoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFpUHJlZGljdG9yID0gQUlUcmF2ZWxUaW1lUHJlZGljdG9yLmdldEluc3RhbmNlKCk7XG4gICAgICAgICAgICB9IGNhdGNoIChSZW1vdGVFeGNlcHRpb24gZXgpIHtcbiAgICAgICAgICAgICAgICBMT0dHRVIubG9nKExldmVsLlNFVkVSRSwgXCJFcnJvciBsb2FkaW5nIHNjaGVkdWxlIGRhdGFcIiwgZXgpO1xuICAgICAgICAgICAgICAgIHNob3dFcnJvck1lc3NhZ2UoXCJLaMO0bmcgdGjhu4MgdOG6o2kgZOG7ryBsaeG7h3UgbOG7i2NoIHRyw6xuaFwiLCBleCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzaG93RXJyb3JNZXNzYWdlKFwiS2jDtG5nIHRo4buDIGvhur90IG7hu5FpIMSR4bq/biBtw6F5IGNo4bunXCIsIG51bGwpO1xuICAgICAgICB9XG4gICAgICAgIGxvYWREYXRhSW5CYWNrZ3JvdW5kKCk7XG4gICAgfVxuLi4uXG5cbiAgICAgICAgICAgIEBPdmVycmlkZVxuICAgICAgICAgICAgcHJvdGVjdGVkIHZvaWQgZG9uZSgpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBib29sZWFuIGNvbm5lY3RlZCA9IGdldCgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29ubmVjdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBYw7NhIHRow7RuZyBiw6FvIFwixJFhbmcgdOG6o2lcIlxuICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVNb2RlbC5zZXRSb3dDb3VudCgwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFThuqNpIGThu68gbGnhu4d1IGzhu4tjaCB0csOsbmhcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRBbGxTY2hlZHVsZURhdGEoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gS2jhu59pIHThuqFvIHRyw6xuaCBxdeG6o24gbMO9IHRy4bqhbmcgdGjDoWlcbiAgICAgICAgICAgICAgICAgICAgICAgIGluaXRTdGF0dXNNYW5hZ2VyKCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWJsZU1vZGVsLnNldFJvd0NvdW50KDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVNb2RlbC5hZGRSb3cobmV3IE9iamVjdFtde1wiS2jDtG5nIHRo4buDIGvhur90IG7hu5FpIMSR4bq/biBtw6F5IGNo4bunXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCJ9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNob3dFcnJvck1lc3NhZ2UoXCJLaMO0bmcgdGjhu4Mga+G6v3QgbuG7kWkgxJHhur9uIG3DoXkgY2jhu6dcIiwgbnVsbCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgICAgICAgICBMT0dHRVIubG9nKExldmVsLlNFVkVSRSwgXCJFcnJvciBsb2FkaW5nIHNjaGVkdWxlIGRhdGFcIiwgZSk7XG4gICAgICAgICAgICAgICAgICAgIHRhYmxlTW9kZWwuc2V0Um93Q291bnQoMCk7XG4gICAgICAgICAgICAgICAgICAgIHRhYmxlTW9kZWwuYWRkUm93KG5ldyBPYmplY3RbXXtcIkzhu5dpOiBcIiArIGUuZ2V0TWVzc2FnZSgpLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwifSk7XG4gICAgICAgICAgICAgICAgICAgIHNob3dFcnJvck1lc3NhZ2UoXCJLaMO0bmcgdGjhu4MgdOG6o2kgZOG7ryBsaeG7h3UgbOG7i2NoIHRyw6xuaFwiLCBlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgd29ya2VyLmV4ZWN1dGUoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHZvaWQgaW5pdFN0YXR1c01hbmFnZXIoKSB7XG4gICAgICAgIGlmIChpc0Nvbm5lY3RlZCAmJiBsaWNoVHJpbmhUYXVEQU8gIT0gbnVsbCkge1xuICAgICAgICAgICAgLy8gVOG6oW8gY2FsbGJhY2sgbMOgbSBt4bubaSBk4buvIGxp4buHdVxuICAgICAgICAgICAgUnVubmFibGUgcmVmcmVzaENhbGxiYWNrID0gdGhpczo6cmVmcmVzaERhdGFBZnRlclVwZGF0ZTtcblxuICAgICAgICAgICAgLy8gS2jhu59pIHThuqFvIHRyw6xuaCBxdeG6o24gbMO9IHRy4bqhbmcgdGjDoWlcbiAgICAgICAgICAgIHN0YXR1c01hbmFnZXIgPSBuZXcgU2NoZWR1bGVTdGF0dXNNYW5hZ2VyKGxpY2hUcmluaFRhdURBTywgcmVmcmVzaENhbGxiYWNrKTtcblxuICAgICAgICAgICAgTE9HR0VSLmluZm8oXCLEkMOjIGto4bufaSB04bqhbyB0csOsbmggcXXhuqNuIGzDvSBj4bqtcCBuaOG6rXQgdHLhuqFuZyB0aMOhaSB04buxIMSR4buZbmdcIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcHJpdmF0ZSB2b2lkIHJlZnJlc2hEYXRhQWZ0ZXJVcGRhdGUoKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBMw6BtIG3hu5tpIGThu68gbGnhu4d1IHRyw6puIGdpYW8gZGnhu4duIG3DoCBraMO0bmcgZ+G7jWkgY+G6rXAgbmjhuq10IHRy4bqhbmcgdGjDoWkgbOG6oWlcbiAgICAgICAgICAgIGxvYWREYXRhV2l0aG91dFN0YXR1c0NoZWNrKCk7XG5cbiAgICAgICAgICAgIC8vIEhp4buDbiB0aOG7iyB0aMO0bmcgYsOhbyBuaOG7jyAodMO5eSBjaOG7jW4pXG4gICAgICAgICAgICBzaG93Tm90aWZpY2F0aW9uKFwixJDDoyBj4bqtcCBuaOG6rXQgdHLhuqFuZyB0aMOhaSBjw6FjIGzhu4tjaCB0csOsbmggdMOgdVwiKTtcblxuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZXgpIHtcbiAgICAgICAgICAgIExPR0dFUi5sb2coTGV2ZWwuU0VWRVJFLCBcIkzhu5dpIGtoaSBsw6BtIG3hu5tpIGThu68gbGnhu4d1IHNhdSBraGkgY+G6rXAgbmjhuq10IHRy4bqhbmcgdGjDoWlcIiwgZXgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSB2b2lkIGxvYWREYXRhV2l0aG91dFN0YXR1c0NoZWNrKCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgICAgIGlmICghaXNDb25uZWN0ZWQgfHwgbGljaFRyaW5oVGF1REFPID09IG51bGwpIHtcbiAgICAgICAgICAgIGNvbm5lY3RUb1JNSVNlcnZlcigpO1xuICAgICAgICAgICAgaWYgKCFpc0Nvbm5lY3RlZCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBSZW1vdGVFeGNlcHRpb24oXCJOb3QgY29ubmVjdGVkIHRvIFJNSSBzZXJ2ZXJcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0YWJsZU1vZGVsLnNldFJvd0NvdW50KDApO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBMaXN0PExpY2hUcmluaFRhdT4gc2NoZWR1bGVzID0gbGljaFRyaW5oVGF1REFPLmdldEFsbExpc3QoKTtcblxuICAgICAgICAgICAgaWYgKHNjaGVkdWxlcyA9PSBudWxsIHx8IHNjaGVkdWxlcy5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgICAgICBMT0dHRVIuaW5mbyhcIktow7RuZyBjw7MgbOG7i2NoIHRyw6xuaCBuw6BvIMSR4buDIGhp4buDbiB0aOG7iy5cIik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBM4buNYyB2w6AgaGnhu4NuIHRo4buLIGThu68gbGnhu4d1IHRoZW8gYuG7mSBs4buNYyBoaeG7h24gdOG6oWlcbiAgICAgICAgICAgIFN0cmluZyBmaWx0ZXJPcHRpb24gPSBmaWx0ZXJDb21ib0JveC5nZXRTZWxlY3RlZEl0ZW0oKS50b1N0cmluZygpO1xuICAgICAgICAgICAgZm9yIChMaWNoVHJpbmhUYXUgc2NoZWR1bGUgOiBzY2hlZHVsZXMpIHtcbiAgICAgICAgICAgICAgICBpZiAobWF0Y2hlc0ZpbHRlcihzY2hlZHVsZSwgZmlsdGVyT3B0aW9uKSkge1xuICAgICAgICAgICAgICAgICAgICB0YWJsZU1vZGVsLmFkZFJvdyhjcmVhdGVUYWJsZVJvdyhzY2hlZHVsZSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbi4uLlxuXG4gICAgcHJpdmF0ZSBKUGFuZWwgY3JlYXRlVGl0bGVQYW5lbCgpIHtcbiAgICAgICAgSlBhbmVsIHBhbmVsID0gbmV3IEpQYW5lbChuZXcgQm9yZGVyTGF5b3V0KCkpO1xuXG4gICAgICAgIEpMYWJlbCB0aXRsZUxhYmVsID0gbmV3IEpMYWJlbChcIlFV4bqiTiBMw50gTOG7ikNIIFRSw4xOSCBUw4BVXCIsIEpMYWJlbC5DRU5URVIpO1xuICAgICAgICB0aXRsZUxhYmVsLnNldEZvbnQobmV3IEZvbnQoXCJBcmlhbFwiLCBGb250LkJPTEQsIDIwKSk7XG4gICAgICAgIHRpdGxlTGFiZWwuc2V0Rm9yZWdyb3VuZChuZXcgQ29sb3IoNDEsIDEyOCwgMTg1KSk7XG4gICAgICAgIHRpdGxlTGFiZWwuc2V0Qm9yZGVyKEJvcmRlckZhY3RvcnkuY3JlYXRlRW1wdHlCb3JkZXIoMCwgMCwgMTAsIDApKTtcblxuICAgICAgICBwYW5lbC5hZGQodGl0bGVMYWJlbCwgQm9yZGVyTGF5b3V0LkNFTlRFUik7XG4gICAgICAgIHJldHVybiBwYW5lbDtcbiAgICB9XG5cbiAgICBwcml2YXRlIEpQYW5lbCBjcmVhdGVDZW50ZXJQYW5lbCgpIHtcbiAgICAgICAgSlBhbmVsIHBhbmVsID0gbmV3IEpQYW5lbChuZXcgQm9yZGVyTGF5b3V0KDEwLCAxMCkpO1xuXG4gICAgICAgIHBhbmVsLmFkZChjcmVhdGVTZWFyY2hQYW5lbCgpLCBCb3JkZXJMYXlvdXQuTk9SVEgpO1xuXG4gICAgICAgIC8vIFThuqFvIFRhYmJlZFBhbmUgxJHhu4MgY2jhu6lhIGPhuqMgY2jhur8gxJHhu5kgeGVtIGLhuqNuZyB2w6AgbOG7i2NoXG4gICAgICAgIHZpZXdUYWJiZWRQYW5lID0gbmV3IEpUYWJiZWRQYW5lKCk7XG5cbiAgICAgICAgLy8gVOG6oW8gcGFuZWwgY2jhur8gxJHhu5kgeGVtIGLhuqNuZ1xuICAgICAgICB0YWJsZVZpZXdQYW5lbCA9IG5ldyBKUGFuZWwobmV3IEJvcmRlckxheW91dCgpKTtcbiAgICAgICAgdGFibGVWaWV3UGFuZWwuYWRkKGNyZWF0ZVRhYmxlUGFuZWwoKSwgQm9yZGVyTGF5b3V0LkNFTlRFUik7XG4gICAgICAgIGNhbGVuZGFyUGFuZWwgPSBuZXcgVHJhaW5TY2hlZHVsZUNhbGVuZGFyUGFuZWwoaXNDb25uZWN0ZWQgPyBsaWNoVHJpbmhUYXVEQU8gOiBudWxsKTtcbiAgICAgICAgLy8gTuG6v3UgxJHDoyBr4bq/dCBu4buRaSwgdOG6oW8gcGFuZWwgbOG7i2NoXG4gICAgICAgIGlmIChpc0Nvbm5lY3RlZCAmJiBsaWNoVHJpbmhUYXVEQU8gIT0gbnVsbCkge1xuICAgICAgICAgICAgLy8gVGhp4bq/dCBs4bqtcCBsaXN0ZW5lciBjaG8gc+G7sSBraeG7h24gY2xpY2sgbmfDoHlcbiAgICAgICAgICAgIGNhbGVuZGFyUGFuZWwuc2V0RGF5UGFuZWxDbGlja0xpc3RlbmVyKChkYXRlLCBzY2hlZHVsZXMpIC0+IHtcbiAgICAgICAgICAgICAgICAvLyBIaeG7g24gdGjhu4sgZGFuaCBzw6FjaCBs4buLY2ggdHLDrG5oIGPhu6dhIG5nw6B5IMSRxrDhu6NjIGNo4buNblxuICAgICAgICAgICAgICAgIGlmICghc2NoZWR1bGVzLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgICAgICAgICBzaG93U2NoZWR1bGVEZXRhaWxzRGlhbG9nKGRhdGUsIHNjaGVkdWxlcyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2codGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIktow7RuZyBjw7MgbOG7i2NoIHRyw6xuaCBuw6BvIGNobyBuZ8OgeSBcIiArIGRhdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJUaMO0bmcgdGluXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4uLi5cblxuICAgICAgICAvLyBU4bqhbyBt4buZdCBs4buNYyB2xINuIGLhuqNuIMSR4buDIHjhu60gbMO9IHPhu7Ega2nhu4duIGLDoG4gcGjDrW0gdGhheSB2w6wgZMO5bmcgRG9jdW1lbnRMaXN0ZW5lclxuICAgICAgICBlZGl0b3IuYWRkS2V5TGlzdGVuZXIobmV3IEtleUFkYXB0ZXIoKSB7XG4gICAgICAgICAgICBAT3ZlcnJpZGVcbiAgICAgICAgICAgIHB1YmxpYyB2b2lkIGtleVJlbGVhc2VkKEtleUV2ZW50IGUpIHtcbiAgICAgICAgICAgICAgICAvLyBC4buPIHF1YSBjw6FjIHBow61tIMSR4bq3YyBiaeG7h3RcbiAgICAgICAgICAgICAgICBpZiAoZS5nZXRLZXlDb2RlKCkgPT0gS2V5RXZlbnQuVktfRU5URVIgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuZ2V0S2V5Q29kZSgpID09IEtleUV2ZW50LlZLX0VTQ0FQRSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgZS5nZXRLZXlDb2RlKCkgPT0gS2V5RXZlbnQuVktfVVAgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuZ2V0S2V5Q29kZSgpID09IEtleUV2ZW50LlZLX0RPV04pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIEzhuqV5IHbEg24gYuG6o24gaGnhu4duIHThuqFpIHRyb25nIGVkaXRvclxuICAgICAgICAgICAgICAgIFN0cmluZyB0ZXh0ID0gZWRpdG9yLmdldFRleHQoKTtcblxuICAgICAgICAgICAgICAgIC8vIEtow7RuZyB0aOG7sWMgaGnhu4duIGzhu41jIG7hur91IHbEg24gYuG6o24gcXXDoSBuZ+G6r25cbiAgICAgICAgICAgICAgICBpZiAodGV4dC5sZW5ndGgoKSA8IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFPhu60gZOG7pW5nIFN3aW5nVXRpbGl0aWVzLmludm9rZUxhdGVyIMSR4buDIHRyw6FuaCBs4buXaSBraGkgc+G7rWEgxJHhu5VpIG3DtCBow6xuaCB0cm9uZyBsw7pjIHjhu60gbMO9IHPhu7Ega2nhu4duXG4gICAgICAgICAgICAgICAgU3dpbmdVdGlsaXRpZXMuaW52b2tlTGF0ZXIoKCkgLT4ge1xuICAgICAgICAgICAgICAgICAgICBmaWx0ZXJJdGVtcyhjb21ib0JveCwgdGV4dCwgb3JpZ2luYWxJdGVtcyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbi4uLlxuXG4gICAgICAgICAgICAgICAgICAgIC8vIMOBcCBk4bulbmcgbW9kZWwgbeG7m2lcbiAgICAgICAgICAgICAgICAgICAgY29tYm9Cb3guc2V0TW9kZWwobW9kZWwpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIMSQ4bq3dCBs4bqhaSB2xINuIGLhuqNuXG4gICAgICAgICAgICAgICAgICAgIGNvbWJvQm94LmdldEVkaXRvcigpLnNldEl0ZW0odGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5zZXRDYXJldFBvc2l0aW9uKHRleHQubGVuZ3RoKCkpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIEhp4buDbiB0aOG7iyBs4bqhaSBwb3B1cCBu4bq/dSB0csaw4bubYyDEkcOzIMSRw6MgbeG7nyB2w6AgY8OzIGvhur90IHF14bqjXG4gICAgICAgICAgICAgICAgICAgIGlmICgod2FzVmlzaWJsZSB8fCAhdGV4dC5pc0VtcHR5KCkpICYmIG1vZGVsLmdldFNpemUoKSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbWJvQm94LnNob3dQb3B1cCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgdm9pZCBzZWFyY2hTY2hlZHVsZXMoTG9jYWxEYXRlIGRhdGUsIFN0cmluZyBnYURpLCBTdHJpbmcgZ2FEZW4sIFN0cmluZyBnaW9EaSkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgICAgIGlmICghaXNDb25uZWN0ZWQgfHwgbGljaFRyaW5oVGF1REFPID09IG51bGwpIHtcbiAgICAgICAgICAgIHJlY29ubmVjdEFuZExvYWREYXRhKGRhdGUpO1xuICAgICAgICAgICAgaWYgKCFpc0Nvbm5lY3RlZCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBSZW1vdGVFeGNlcHRpb24oXCJLaMO0bmcgdGjhu4Mga+G6v3QgbuG7kWkgxJHhur9uIHNlcnZlclwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRhYmxlTW9kZWwuc2V0Um93Q291bnQoMCk7XG4gICAgICAgIExpc3Q8TGljaFRyaW5oVGF1PiBzY2hlZHVsZXM7XG4uLi5cblxuICAgICAgICAvLyBOw7p0IHRow6ptIG5oaeG7gXUgbOG7i2NoIHRyw6xuaCB04buxIMSR4buZbmdcbiAgICAgICAgSkJ1dHRvbiBiYXRjaEFkZEJ1dHRvbiA9IG5ldyBKQnV0dG9uKFwiVOG6oW8gTmhp4buBdSBM4buLY2ggVHLDrG5oXCIpO1xuICAgICAgICBiYXRjaEFkZEJ1dHRvbi5zZXRJY29uKGNyZWF0ZUJhdGNoSWNvbigxNiwgMTYpKTtcbiAgICAgICAgYmF0Y2hBZGRCdXR0b24uYWRkQWN0aW9uTGlzdGVuZXIoZSAtPiBjcmVhdGVCYXRjaFNjaGVkdWxlcygpKTtcblxuICAgICAgICBlZGl0QnV0dG9uID0gbmV3IEpCdXR0b24oXCJDaOG7iW5oIFPhu61hXCIpO1xuICAgICAgICBlZGl0QnV0dG9uLnNldEljb24oY3JlYXRlRWRpdEljb24oMTYsIDE2KSk7XG4gICAgICAgIGVkaXRCdXR0b24uYWRkQWN0aW9uTGlzdGVuZXIoZSAtPiBlZGl0U2NoZWR1bGUoKSk7XG5cbiAgICAgICAgZGVsZXRlQnV0dG9uID0gbmV3IEpCdXR0b24oXCJYw7NhXCIpO1xuICAgICAgICBkZWxldGVCdXR0b24uc2V0SWNvbihjcmVhdGVEZWxldGVJY29uKDE2LCAxNikpO1xuICAgICAgICBkZWxldGVCdXR0b24uYWRkQWN0aW9uTGlzdGVuZXIoZSAtPiBkZWxldGVTY2hlZHVsZSgpKTtcblxuICAgICAgICAvLyBBZGQgYnV0dG9ucyB0byBwYW5lbFxuICAgICAgICBwYW5lbC5hZGQoY2hhdGJvdEJ1dHRvbik7XG4gICAgICAgIHBhbmVsLmFkZChwcmVkaWN0QnV0dG9uKTtcbiAgICAgICAgcGFuZWwuYWRkKGFkZEJ1dHRvbik7XG4gICAgICAgIHBhbmVsLmFkZChiYXRjaEFkZEJ1dHRvbik7XG4gICAgICAgIHBhbmVsLmFkZChlZGl0QnV0dG9uKTtcbiAgICAgICAgcGFuZWwuYWRkKGRlbGV0ZUJ1dHRvbik7XG4gICAgICAgIHJldHVybiBwYW5lbDtcbiAgICB9XG4uLi5cblxuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwixJBhbmcgdMOsbSBraeG6v20gY2hvIG5nw6B5OiBcIiArIGxvY2FsRGF0ZSk7XG5cbiAgICAgICAgICAgIGlmIChpc0Nvbm5lY3RlZCkge1xuICAgICAgICAgICAgICAgIC8vIE7hur91IMSRYW5nIOG7nyBjaOG6vyDEkeG7mSB4ZW0gYuG6o25nLCB04bqjaSBk4buvIGxp4buHdSB2w6BvIGLhuqNuZ1xuICAgICAgICAgICAgICAgIGlmICh2aWV3VGFiYmVkUGFuZS5nZXRTZWxlY3RlZEluZGV4KCkgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBsb2FkU2NoZWR1bGVEYXRhKGxvY2FsRGF0ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIE7hur91IMSRYW5nIOG7nyBjaOG6vyDEkeG7mSB4ZW0gbOG7i2NoLCBjaHV54buDbiDEkeG6v24gbmfDoHkgxJHGsOG7o2MgY2jhu41uXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodmlld1RhYmJlZFBhbmUuZ2V0U2VsZWN0ZWRJbmRleCgpID09IDEgJiYgY2FsZW5kYXJQYW5lbCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbGVuZGFyUGFuZWwuc2V0U2VsZWN0ZWREYXRlKGxvY2FsRGF0ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZWNvbm5lY3RBbmRMb2FkRGF0YShsb2NhbERhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gZXgpIHtcbiAgICAgICAgICAgIExPR0dFUi5sb2coTGV2ZWwuV0FSTklORywgXCJJbnZhbGlkIGRhdGUgc2VsZWN0aW9uXCIsIGV4KTtcbiAgICAgICAgICAgIHNob3dFcnJvck1lc3NhZ2UoXCJWdWkgbMOybmcgY2jhu41uIG5nw6B5IGjhu6NwIGzhu4cuXCIsIG51bGwpO1xuICAgICAgICB9IGNhdGNoIChSZW1vdGVFeGNlcHRpb24gZXgpIHtcbiAgICAgICAgICAgIExPR0dFUi5sb2coTGV2ZWwuU0VWRVJFLCBcIkVycm9yIGxvYWRpbmcgc2NoZWR1bGUgZGF0YVwiLCBleCk7XG4gICAgICAgICAgICBzaG93RXJyb3JNZXNzYWdlKFwiTOG7l2kga2hpIHThuqNpIGThu68gbGnhu4d1XCIsIGV4KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgdm9pZCBsb2FkU2NoZWR1bGVEYXRhKExvY2FsRGF0ZSBkYXRlKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uIHtcbiAgICAgICAgaWYgKCFpc0Nvbm5lY3RlZCB8fCBsaWNoVHJpbmhUYXVEQU8gPT0gbnVsbCkge1xuICAgICAgICAgICAgcmVjb25uZWN0QW5kTG9hZERhdGEoZGF0ZSk7XG4gICAgICAgICAgICBpZiAoIWlzQ29ubmVjdGVkKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFJlbW90ZUV4Y2VwdGlvbihcIk5vdCBjb25uZWN0ZWQgdG8gUk1JIHNlcnZlclwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuLi4uXG5cbiAgICAgICAgLy8gVOG6o2kgZGFuaCBzw6FjaCB0w6B1IHThu6sgVGF1REFPXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBU4bqhbyBr4bq/dCBu4buRaSDEkeG6v24gUk1JIHNlcnZlclxuICAgICAgICAgICAgUmVnaXN0cnkgcmVnaXN0cnkgPSBMb2NhdGVSZWdpc3RyeS5nZXRSZWdpc3RyeShSTUlfU0VSVkVSX0lQLCBSTUlfU0VSVkVSX1BPUlQpO1xuICAgICAgICAgICAgVGF1REFPIHRhdURBTyA9IChUYXVEQU8pIHJlZ2lzdHJ5Lmxvb2t1cChcInRhdURBT1wiKTtcblxuICAgICAgICAgICAgLy8gTOG6pXkgZGFuaCBzw6FjaCB0w6B1IHbDoCB0aMOqbSB2w6BvIGNvbWJvYm94XG4gICAgICAgICAgICBMaXN0PFRhdT4gdHJhaW5zID0gdGF1REFPLmdldEFsbExpc3RUKCk7XG4gICAgICAgICAgICBpZiAodHJhaW5zICE9IG51bGwgJiYgIXRyYWlucy5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgICAgICBEZWZhdWx0Q29tYm9Cb3hNb2RlbDxUYXU+IG1vZGVsID0gbmV3IERlZmF1bHRDb21ib0JveE1vZGVsPD4oKTtcbiAgICAgICAgICAgICAgICBmb3IgKFRhdSB0cmFpbiA6IHRyYWlucykge1xuICAgICAgICAgICAgICAgICAgICBtb2RlbC5hZGRFbGVtZW50KHRyYWluKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdHJhaW5Db21ib0JveC5zZXRNb2RlbChtb2RlbCk7XG5cbiAgICAgICAgICAgICAgICAvLyBIaeG7g24gdGjhu4sgdGjDtG5nIHRpbiB0dXnhur9uIMSRxrDhu51uZyBj4bunYSB0w6B1IMSRxrDhu6NjIGNo4buNblxuICAgICAgICAgICAgICAgIHVwZGF0ZVJvdXRlSW5mbyh0cmFpbkNvbWJvQm94LCByb3V0ZVRleHRGaWVsZCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKGJhdGNoRGlhbG9nLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJLaMO0bmcgY8OzIHTDoHUgbsOgbyB0cm9uZyBo4buHIHRo4buRbmcuIFZ1aSBsw7JuZyB04bqhbyB0w6B1IHRyxrDhu5tjLlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRSk7XG4gICAgICAgICAgICAgICAgYmF0Y2hEaWFsb2cuZGlzcG9zZSgpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGV4KSB7XG4gICAgICAgICAgICBMT0dHRVIubG9nKExldmVsLlNFVkVSRSwgXCJM4buXaSBraGkgdOG6o2kgZGFuaCBzw6FjaCB0w6B1XCIsIGV4KTtcbiAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKGJhdGNoRGlhbG9nLFxuICAgICAgICAgICAgICAgICAgICBcIktow7RuZyB0aOG7gyB04bqjaSBkYW5oIHPDoWNoIHTDoHU6IFwiICsgZXguZ2V0TWVzc2FnZSgpLFxuICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsXG4gICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0UpO1xuICAgICAgICAgICAgYmF0Y2hEaWFsb2cuZGlzcG9zZSgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ+G6rXAgbmjhuq10IHRow7RuZyB0aW4gdHV54bq/biDEkcaw4budbmcga2hpIGNo4buNbiB0w6B1IGtow6FjXG4gICAgICAgIHRyYWluQ29tYm9Cb3guYWRkQWN0aW9uTGlzdGVuZXIoZSAtPiB7XG4gICAgICAgICAgICB1cGRhdGVSb3V0ZUluZm8odHJhaW5Db21ib0JveCwgcm91dGVUZXh0RmllbGQpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBD4bqtcCBuaOG6rXQgc+G7kSBsxrDhu6NuZyBs4buLY2ggdHLDrG5oIGThu7Ega2nhur9uIGtoaSB0aGF5IMSR4buVaSBuZ8OgeSBob+G6t2MgY2hlY2tib3hcbiAgICAgICAgUHJvcGVydHlDaGFuZ2VMaXN0ZW5lciBkYXRlTGlzdGVuZXIgPSBldnQgLT4ge1xuICAgICAgICAgICAgaWYgKFwiZGF0ZVwiLmVxdWFscyhldnQuZ2V0UHJvcGVydHlOYW1lKCkpKSB7XG4gICAgICAgICAgICAgICAgdXBkYXRlU2NoZWR1bGVDb3VudChzdGFydERhdGVDaG9vc2VyLCBlbmREYXRlQ2hvb3Nlciwgd2Vla2RheUNoZWNrYm94ZXMsIGNvdW50SW5mb0xhYmVsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBzdGFydERhdGVDaG9vc2VyLmFkZFByb3BlcnR5Q2hhbmdlTGlzdGVuZXIoZGF0ZUxpc3RlbmVyKTtcbiAgICAgICAgZW5kRGF0ZUNob29zZXIuYWRkUHJvcGVydHlDaGFuZ2VMaXN0ZW5lcihkYXRlTGlzdGVuZXIpO1xuXG4gICAgICAgIGZvciAoSkNoZWNrQm94IGNoZWNrYm94IDogd2Vla2RheUNoZWNrYm94ZXMpIHtcbiAgICAgICAgICAgIGNoZWNrYm94LmFkZEFjdGlvbkxpc3RlbmVyKGUgLT4ge1xuICAgICAgICAgICAgICAgIHVwZGF0ZVNjaGVkdWxlQ291bnQoc3RhcnREYXRlQ2hvb3NlciwgZW5kRGF0ZUNob29zZXIsIHdlZWtkYXlDaGVja2JveGVzLCBjb3VudEluZm9MYWJlbCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEPhuq1wIG5o4bqtdCBiYW4gxJHhuqd1XG4gICAgICAgIHVwZGF0ZVNjaGVkdWxlQ291bnQoc3RhcnREYXRlQ2hvb3NlciwgZW5kRGF0ZUNob29zZXIsIHdlZWtkYXlDaGVja2JveGVzLCBjb3VudEluZm9MYWJlbCk7XG5cbiAgICAgICAgLy8gWOG7rSBsw70gc+G7sSBraeG7h24ga2hpIG5o4bqlbiBuw7p0IFwiSOG7p3lcIlxuICAgICAgICBjYW5jZWxCdXR0b24uYWRkQWN0aW9uTGlzdGVuZXIoZSAtPiBiYXRjaERpYWxvZy5kaXNwb3NlKCkpO1xuLi4uXG5cbiAgICBwcml2YXRlIHZvaWQgbG9hZEFsbFNjaGVkdWxlRGF0YSgpIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xuICAgICAgICBpZiAoIWlzQ29ubmVjdGVkIHx8IGxpY2hUcmluaFRhdURBTyA9PSBudWxsKSB7XG4gICAgICAgICAgICBjb25uZWN0VG9STUlTZXJ2ZXIoKTtcbiAgICAgICAgICAgIGlmICghaXNDb25uZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUmVtb3RlRXhjZXB0aW9uKFwiTm90IGNvbm5lY3RlZCB0byBSTUkgc2VydmVyXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGFibGVNb2RlbC5zZXRSb3dDb3VudCgwKTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgTGlzdDxMaWNoVHJpbmhUYXU+IHNjaGVkdWxlcyA9IGxpY2hUcmluaFRhdURBTy5nZXRBbGxMaXN0KCk7XG5cbiAgICAgICAgICAgIGlmIChzY2hlZHVsZXMgPT0gbnVsbCB8fCBzY2hlZHVsZXMuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2codGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiS2jDtG5nIGPDsyBs4buLY2ggdHLDrG5oIG7DoG8gxJHhu4MgaGnhu4NuIHRo4buLLlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJUaMO0bmcgYsOhb1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBBcHBseSBmaWx0ZXIgaWYgc2VsZWN0ZWRcbiAgICAgICAgICAgIFN0cmluZyBmaWx0ZXJPcHRpb24gPSAoU3RyaW5nKSBmaWx0ZXJDb21ib0JveC5nZXRTZWxlY3RlZEl0ZW0oKTtcbiAgICAgICAgICAgIGZvciAoTGljaFRyaW5oVGF1IHNjaGVkdWxlIDogc2NoZWR1bGVzKSB7XG4gICAgICAgICAgICAgICAgaWYgKG1hdGNoZXNGaWx0ZXIoc2NoZWR1bGUsIGZpbHRlck9wdGlvbikpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFibGVNb2RlbC5hZGRSb3coY3JlYXRlVGFibGVSb3coc2NoZWR1bGUpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4uLi5cblxuICAgICAgICAvLyBUaMOqbSB04bqldCBj4bqjIGPDoWMgcGFuZWwgY29uIHbDoG8gcGFuZWwgY2jDrW5oXG4gICAgICAgIG1haW5QYW5lbC5hZGQodHJhaW5QYW5lbCk7XG4gICAgICAgIG1haW5QYW5lbC5hZGQoQm94LmNyZWF0ZVZlcnRpY2FsU3RydXQoMTUpKTtcbiAgICAgICAgbWFpblBhbmVsLmFkZChkYXRlUGFuZWwpO1xuICAgICAgICBtYWluUGFuZWwuYWRkKEJveC5jcmVhdGVWZXJ0aWNhbFN0cnV0KDE1KSk7XG4gICAgICAgIG1haW5QYW5lbC5hZGQodGltZVBhbmVsKTtcbiAgICAgICAgbWFpblBhbmVsLmFkZChCb3guY3JlYXRlVmVydGljYWxTdHJ1dCgxNSkpO1xuICAgICAgICBtYWluUGFuZWwuYWRkKHN0YXR1c1BhbmVsKTtcbiAgICAgICAgbWFpblBhbmVsLmFkZChCb3guY3JlYXRlVmVydGljYWxTdHJ1dCgxNSkpO1xuICAgICAgICBtYWluUGFuZWwuYWRkKHJvdXRlUGFuZWwpO1xuXG4gICAgICAgIC8vIFBhbmVsIGNo4bupYSBjw6FjIG7DunQgdGhhbyB0w6FjXG4gICAgICAgIEpQYW5lbCBidXR0b25zUGFuZWwgPSBuZXcgSlBhbmVsKG5ldyBGbG93TGF5b3V0KEZsb3dMYXlvdXQuUklHSFQsIDEwLCAxMCkpO1xuICAgICAgICBKQnV0dG9uIHNhdmVCdXR0b24gPSBuZXcgSkJ1dHRvbihcIkzGsHVcIik7XG4gICAgICAgIHNhdmVCdXR0b24uc2V0Rm9udChuZXcgRm9udChcIkFyaWFsXCIsIEZvbnQuQk9MRCwgMTQpKTtcbiAgICAgICAgc2F2ZUJ1dHRvbi5zZXRQcmVmZXJyZWRTaXplKG5ldyBEaW1lbnNpb24oMTAwLCAzNSkpO1xuXG4gICAgICAgIEpCdXR0b24gY2FuY2VsQnV0dG9uID0gbmV3IEpCdXR0b24oXCJI4buneVwiKTtcbiAgICAgICAgY2FuY2VsQnV0dG9uLnNldEZvbnQobmV3IEZvbnQoXCJBcmlhbFwiLCBGb250LkJPTEQsIDE0KSk7XG4gICAgICAgIGNhbmNlbEJ1dHRvbi5zZXRQcmVmZXJyZWRTaXplKG5ldyBEaW1lbnNpb24oMTAwLCAzNSkpO1xuXG4gICAgICAgIC8vIFRow6ptIGljb24gY2hvIG7DunQgKG7hur91IHBoxrDGoW5nIHRo4bupYyB04bqhbyBpY29uIGhv4bqhdCDEkeG7mW5nKVxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgc2F2ZUJ1dHRvbi5zZXRJY29uKGNyZWF0ZUFkZEljb24oMTYsIDE2KSk7XG4gICAgICAgICAgICBjYW5jZWxCdXR0b24uc2V0SWNvbihjcmVhdGVEZWxldGVJY29uKDE2LCAxNikpO1xuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgTE9HR0VSLmxvZyhMZXZlbC5XQVJOSU5HLCBcIktow7RuZyB0aOG7gyB0aGnhur90IGzhuq1wIGljb24gY2hvIG7DunRcIiwgZSk7XG4gICAgICAgIH1cblxuICAgICAgICBidXR0b25zUGFuZWwuYWRkKHNhdmVCdXR0b24pO1xuICAgICAgICBidXR0b25zUGFuZWwuYWRkKGNhbmNlbEJ1dHRvbik7XG5cbiAgICAgICAgLy8gVGjDqm0gcGFuZWwgY2jDrW5oIHbDoCBwYW5lbCBuw7p0IHbDoG8gZGlhbG9nXG4gICAgICAgIGFkZERpYWxvZy5hZGQobWFpblBhbmVsLCBCb3JkZXJMYXlvdXQuQ0VOVEVSKTtcbiAgICAgICAgYWRkRGlhbG9nLmFkZChidXR0b25zUGFuZWwsIEJvcmRlckxheW91dC5TT1VUSCk7XG5cbiAgICAgICAgLy8gVOG6o2kgZGFuaCBzw6FjaCB0w6B1IHThu6sgVGF1REFPXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBU4bqhbyBr4bq/dCBu4buRaSDEkeG6v24gUk1JIHNlcnZlclxuICAgICAgICAgICAgUmVnaXN0cnkgcmVnaXN0cnkgPSBMb2NhdGVSZWdpc3RyeS5nZXRSZWdpc3RyeShSTUlfU0VSVkVSX0lQLCBSTUlfU0VSVkVSX1BPUlQpO1xuICAgICAgICAgICAgVGF1REFPIHRhdURBTyA9IChUYXVEQU8pIHJlZ2lzdHJ5Lmxvb2t1cChcInRhdURBT1wiKTtcbi4uLlxuXG4gICAgICAgICAgICByb3V0ZUluZm9QYW5lbC5hZGQocm91dGVJbmZvTGFiZWwpO1xuICAgICAgICAgICAgcm91dGVJbmZvUGFuZWwuYWRkKHJvdXRlSW5mb0ZpZWxkKTtcbiAgICAgICAgICAgIG1haW5QYW5lbC5hZGQocm91dGVJbmZvUGFuZWwpO1xuXG4gICAgICAgICAgICAvLyBU4bqjaSBkYW5oIHPDoWNoIHTDoHVcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgUmVnaXN0cnkgcmVnaXN0cnkgPSBMb2NhdGVSZWdpc3RyeS5nZXRSZWdpc3RyeShSTUlfU0VSVkVSX0lQLCBSTUlfU0VSVkVSX1BPUlQpO1xuICAgICAgICAgICAgICAgIFRhdURBTyB0YXVEQU8gPSAoVGF1REFPKSByZWdpc3RyeS5sb29rdXAoXCJ0YXVEQU9cIik7XG4gICAgICAgICAgICAgICAgTGlzdDxUYXU+IHRyYWluTGlzdCA9IHRhdURBTy5nZXRBbGxMaXN0VCgpO1xuXG4gICAgICAgICAgICAgICAgLy8gVGjDqm0gdMOgdSB2w6BvIGNvbWJvYm94XG4gICAgICAgICAgICAgICAgRGVmYXVsdENvbWJvQm94TW9kZWw8VGF1PiB0cmFpbk1vZGVsID0gbmV3IERlZmF1bHRDb21ib0JveE1vZGVsPD4oKTtcbiAgICAgICAgICAgICAgICBmb3IgKFRhdSB0YXUgOiB0cmFpbkxpc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJhaW5Nb2RlbC5hZGRFbGVtZW50KHRhdSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRyYWluQ29tYm9Cb3guc2V0TW9kZWwodHJhaW5Nb2RlbCk7XG5cbiAgICAgICAgICAgICAgICAvLyDEkOG6t3QgdMOgdSBoaeG7h24gdOG6oWlcbiAgICAgICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHRyYWluTW9kZWwuZ2V0U2l6ZSgpOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgVGF1IHRhdSA9IHRyYWluTW9kZWwuZ2V0RWxlbWVudEF0KGkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGF1LmdldE1hVGF1KCkuZXF1YWxzKGxpY2hUcmluaC5nZXRUYXUoKS5nZXRNYVRhdSgpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhaW5Db21ib0JveC5zZXRTZWxlY3RlZEluZGV4KGkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4uLi5cblxuICAgIC8vIFRow6ptIHbDoG8gcGjGsMahbmcgdGjhu6ljIGto4bufaSB04bqhbyBob+G6t2MgbeG7mXQgcGjGsMahbmcgdGjhu6ljIHJpw6puZyBiaeG7h3RcbiAgICBwcml2YXRlIHZvaWQgc2V0dXBLZXlCaW5kaW5ncygpIHtcbiAgICAgICAgSW5wdXRNYXAgaW5wdXRNYXAgPSBzY2hlZHVsZVRhYmxlLmdldElucHV0TWFwKEpDb21wb25lbnQuV0hFTl9GT0NVU0VEKTtcbiAgICAgICAgQWN0aW9uTWFwIGFjdGlvbk1hcCA9IHNjaGVkdWxlVGFibGUuZ2V0QWN0aW9uTWFwKCk7XG5cbiAgICAgICAgLy8gVGjDqm0gcGjDrW0gdOG6r3QgRGVsZXRlIMSR4buDIHjDs2EgbOG7i2NoIHRyw6xuaFxuICAgICAgICBpbnB1dE1hcC5wdXQoS2V5U3Ryb2tlLmdldEtleVN0cm9rZShLZXlFdmVudC5WS19ERUxFVEUsIDApLCBcImRlbGV0ZVwiKTtcbiAgICAgICAgYWN0aW9uTWFwLnB1dChcImRlbGV0ZVwiLCBuZXcgQWJzdHJhY3RBY3Rpb24oKSB7XG4gICAgICAgICAgICBAT3ZlcnJpZGVcbiAgICAgICAgICAgIHB1YmxpYyB2b2lkIGFjdGlvblBlcmZvcm1lZChBY3Rpb25FdmVudCBlKSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlU2NoZWR1bGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gVGjDqm0gcGjDrW0gdOG6r3QgRW50ZXIgxJHhu4MgeGVtIGNoaSB0aeG6v3RcbiAgICAgICAgaW5wdXRNYXAucHV0KEtleVN0cm9rZS5nZXRLZXlTdHJva2UoS2V5RXZlbnQuVktfRU5URVIsIDApLCBcInZpZXdcIik7XG4gICAgICAgIGFjdGlvbk1hcC5wdXQoXCJ2aWV3XCIsIG5ldyBBYnN0cmFjdEFjdGlvbigpIHtcbiAgICAgICAgICAgIEBPdmVycmlkZVxuICAgICAgICAgICAgcHVibGljIHZvaWQgYWN0aW9uUGVyZm9ybWVkKEFjdGlvbkV2ZW50IGUpIHtcbiAgICAgICAgICAgICAgICB2aWV3U2NoZWR1bGVEZXRhaWxzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9ndWlDbGllbnQvVHJhVmVQYW5lbC5qYXZhXG4uLi5cblxucHVibGljIGNsYXNzIFRyYVZlUGFuZWwgZXh0ZW5kcyBKUGFuZWwge1xuICAgIHByaXZhdGUgVmVUYXVEQU8gdmVUYXVEQU87XG4gICAgcHJpdmF0ZSBKVGV4dEZpZWxkIHR4dE1hVmU7XG4gICAgcHJpdmF0ZSBKVGV4dEZpZWxkIHR4dFRlbktoYWNoSGFuZztcbiAgICBwcml2YXRlIEpUZXh0RmllbGQgdHh0R2lheVRvO1xuICAgIHByaXZhdGUgSlRleHRGaWVsZCB0eHROZ2F5RGk7XG4gICAgcHJpdmF0ZSBKQ29tYm9Cb3g8U3RyaW5nPiBjYm9Eb2lUdW9uZztcbiAgICBwcml2YXRlIEpCdXR0b24gYnRuVGltS2llbTtcbiAgICBwcml2YXRlIEpCdXR0b24gYnRuVHJhVmU7XG4gICAgcHJpdmF0ZSBKQnV0dG9uIGJ0bkxhbU1vaTtcbiAgICBwcml2YXRlIEpCdXR0b24gYnRuVGhvYXQ7XG4gICAgcHJpdmF0ZSBKTGFiZWwgbGJsTGljaFRyaW5oO1xuICAgIHByaXZhdGUgSkxhYmVsIGxibENob05nb2k7XG4gICAgcHJpdmF0ZSBKTGFiZWwgbGJsVHJhbmdUaGFpO1xuICAgIHByaXZhdGUgSkxhYmVsIGxibEdpYVZlO1xuICAgIHByaXZhdGUgSkJ1dHRvbiBidG5DaG9uTGljaFRyaW5oO1xuICAgIHByaXZhdGUgSkJ1dHRvbiBidG5DaG9uQ2hvTmdvaTtcbiAgICBwcml2YXRlIEpUZXh0RmllbGQgdHh0UGhpVHJhVmU7XG4gICAgcHJpdmF0ZSBKTGFiZWwgbGJsVGllblRyYUxhaTtcbiAgICBwcml2YXRlIExpY2hUcmluaFRhdURBTyBsaWNoVHJpbmhUYXVEQU87XG4gICAgLy8gVGjDqm0gY8OhYyBiaeG6v24gdGjDoG5oIHZpw6puIG3hu5tpXG4gICAgcHJpdmF0ZSBIb2FEb25EQU8gaG9hRG9uREFPO1xuICAgIHByaXZhdGUgQ2hpVGlldEhvYURvbkRBTyBjaGlUaWV0SG9hRG9uREFPO1xuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9UcmFpblNjaGVkdWxlQ2FsZW5kYXJQYW5lbC5qYXZhXG5wYWNrYWdlIGd1aUNsaWVudDtcblxuaW1wb3J0IGRhby5MaWNoVHJpbmhUYXVEQU87XG5pbXBvcnQgbW9kZWwuTGljaFRyaW5oVGF1O1xuaW1wb3J0IG1vZGVsLlRyYW5nVGhhaTtcblxuaW1wb3J0IGphdmF4LnN3aW5nLio7XG5pbXBvcnQgamF2YS5hd3QuKjtcbmltcG9ydCBqYXZhLnRpbWUuRGF5T2ZXZWVrO1xuaW1wb3J0IGphdmEudGltZS5Mb2NhbERhdGU7XG5pbXBvcnQgamF2YS50aW1lLmZvcm1hdC5EYXRlVGltZUZvcm1hdHRlcjtcbmltcG9ydCBqYXZhLnRpbWUuZm9ybWF0LlRleHRTdHlsZTtcbmltcG9ydCBqYXZhLnV0aWwuKjtcbmltcG9ydCBqYXZhLnV0aWwuTGlzdDtcbmltcG9ydCBqYXZhLnV0aWwubG9nZ2luZy5MZXZlbDtcbmltcG9ydCBqYXZhLnV0aWwubG9nZ2luZy5Mb2dnZXI7XG5cbi8qKlxuICogUGFuZWwgaGnhu4NuIHRo4buLIGzhu4tjaCB0csOsbmggdMOgdSB0aGVvIGThuqFuZyBs4buLY2hcbiAqL1xucHVibGljIGNsYXNzIFRyYWluU2NoZWR1bGVDYWxlbmRhclBhbmVsIGV4dGVuZHMgSlBhbmVsIHtcbiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2dnZXIgTE9HR0VSID0gTG9nZ2VyLmdldExvZ2dlcihUcmFpblNjaGVkdWxlQ2FsZW5kYXJQYW5lbC5jbGFzcy5nZXROYW1lKCkpO1xuLi4uXG4iLCJpc19lcnJvciI6ZmFsc2UsInJlcXVlc3RfaWQiOiIiLCJ0b29sX3VzZV9pZCI6InRvb2x1XzAxMng4ajlXTGFzcnZ0UFpZVUpyR2N5NSJ9fSx7ImlkIjoyLCJ0eXBlIjo0LCJpZGVfc3RhdGVfbm9kZSI6eyJ3b3Jrc3BhY2VGb2xkZXJzIjpbeyJyZXBvc2l0b3J5Um9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIiwiZm9sZGVyUm9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIn1dLCJ3b3Jrc3BhY2VGb2xkZXJzVW5jaGFuZ2VkIjpmYWxzZSwiY3VycmVudFRlcm1pbmFsIjp7InRlcm1pbmFsSWQiOjIyLCJjdXJyZW50V29ya2luZ0RpcmVjdG9yeSI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIn19fV0sInJlc3BvbnNlX3RleHQiOiIiLCJ3b3Jrc3BhY2VfZmlsZV9jaHVua3MiOltdfSx7InN0YXR1cyI6InN1Y2Nlc3MiLCJyZXF1ZXN0X2lkIjoiZDE5MzhiN2MtNTQ2Ny00NmMyLWFjNWItYTI3MjMwZTZiZTBkIiwicmVxdWVzdF9tZXNzYWdlIjoiIiwic3RydWN0dXJlZF9vdXRwdXRfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjo1LCJjb250ZW50IjoiIiwidG9vbF91c2UiOnsidG9vbF91c2VfaWQiOiJ0b29sdV8wMTlRMWNmUkNWc2hrc2lkUTFjbm5kN0UiLCJ0b29sX25hbWUiOiJjb2RlYmFzZS1yZXRyaWV2YWwiLCJpbnB1dF9qc29uIjoie1wiaW5mb3JtYXRpb25fcmVxdWVzdFwiOiBcIkZpbmQgdGhlIE1haW5HVUkuamF2YSBmaWxlIHRvIHVuZGVyc3RhbmQgaG93IHRvIGFkZCB0aGUgcGFuZWxzIHRvIGl0XCJ9In19LHsiaWQiOjAsInR5cGUiOjAsImNvbnRlbnQiOiIifSx7ImlkIjoyLCJ0eXBlIjoyLCJjb250ZW50IjoiIn0seyJpZCI6MywidHlwZSI6MywiY29udGVudCI6IiJ9XSwic2Vlbl9zdGF0ZSI6InNlZW4iLCJzdHJ1Y3R1cmVkX3JlcXVlc3Rfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjoxLCJ0b29sX3Jlc3VsdF9ub2RlIjp7ImNvbnRlbnQiOiJUaGUgZm9sbG93aW5nIGNvZGUgc2VjdGlvbnMgd2VyZSByZXRyaWV2ZWQ6XG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9UcmFpblRpY2tldEJvb2tpbmdTeXN0ZW0uamF2YVxucGFja2FnZSBndWlDbGllbnQ7XG5cbmltcG9ydCBkYW8uKjtcbmltcG9ydCBkYW8uaW1wbC4qO1xuaW1wb3J0IG1vZGVsLio7XG5cbmltcG9ydCBqYXZheC5zd2luZy4qO1xuaW1wb3J0IGphdmF4LnN3aW5nLmJvcmRlci4qO1xuaW1wb3J0IGphdmF4LnN3aW5nLnRleHQuRGVmYXVsdENhcmV0O1xuaW1wb3J0IGphdmEuYXd0Lio7XG5pbXBvcnQgamF2YS5hd3QuZXZlbnQuKjtcbmltcG9ydCBqYXZhLnJtaS5SZW1vdGVFeGNlcHRpb247XG5pbXBvcnQgamF2YS50ZXh0Lk51bWJlckZvcm1hdDtcbmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlO1xuaW1wb3J0IGphdmEudGltZS5ab25lSWQ7XG5pbXBvcnQgamF2YS50aW1lLmZvcm1hdC5EYXRlVGltZUZvcm1hdHRlcjtcbmltcG9ydCBqYXZhLnV0aWwuKjtcbmltcG9ydCBqYXZhLnV0aWwuTGlzdDtcbmltcG9ydCBqYXZheC5zd2luZy5UaW1lcjtcbmltcG9ydCBqYXZheC5zd2luZy5wbGFmLmJhc2ljLkJhc2ljU2Nyb2xsQmFyVUk7XG5pbXBvcnQgamF2YS51dGlsLnN0cmVhbS5Db2xsZWN0b3JzO1xuaW1wb3J0IGNvbS50b2VkdGVyLmNhbGVuZGFyLkpEYXRlQ2hvb3NlcjtcblxuLyoqXG4gKiBUcmFpbiBUaWNrZXQgQm9va2luZyBTeXN0ZW0gR1VJXG4gKiBBbGxvd3MgdXNlcnMgdG8gc2VhcmNoIGZvciB0cmFpbnMsIHZpZXcgY2Fycywgc2VsZWN0IHNlYXRzLCBhbmQgYm9vayB0aWNrZXRzXG4gKiBAYXV0aG9yIGx1b25ndGFuMjA0XG4gKi9cbnB1YmxpYyBjbGFzcyBUcmFpblRpY2tldEJvb2tpbmdTeXN0ZW0gZXh0ZW5kcyBKRnJhbWUge1xuICAgIC8vIFVJIENvbXBvbmVudHNcbiAgICBwcml2YXRlIEpQYW5lbCBzZWF0c1BhbmVsO1xuICAgIHByaXZhdGUgSlBhbmVsIGNhcnNQYW5lbDtcbiAgICBwcml2YXRlIEpQYW5lbCB0cmFpbnNQYW5lbDtcbiAgICBwcml2YXRlIEpTY3JvbGxQYW5lIHRyYWluc1Njcm9sbFBhbmU7XG4gICAgcHJpdmF0ZSBKU2Nyb2xsUGFuZSBjYXJzU2Nyb2xsUGFuZTtcbiAgICBwcml2YXRlIEpMYWJlbCBzZWF0aW5nU2VjdGlvbkxhYmVsO1xuICAgIHByaXZhdGUgSkxhYmVsIHRvdGFsTGFiZWw7XG5cbiAgICAvLyBGb3JtIGZpZWxkc1xuICAgIHByaXZhdGUgSlRleHRGaWVsZCBkZXBhcnR1cmVGaWVsZDtcbiAgICBwcml2YXRlIEpUZXh0RmllbGQgYXJyaXZhbEZpZWxkO1xuICAgIHByaXZhdGUgSlRleHRGaWVsZCBkZXBhcnR1cmVEYXRlRmllbGQ7XG4gICAgcHJpdmF0ZSBKVGV4dEZpZWxkIHJldHVybkRhdGVGaWVsZDtcbiAgICBwcml2YXRlIEpSYWRpb0J1dHRvbiBvbmVXYXlSYWRpbztcbiAgICBwcml2YXRlIEpSYWRpb0J1dHRvbiByb3VuZFRyaXBSYWRpbztcblxuICAgIC8vIFN0YXRlIHZhcmlhYmxlc1xuICAgIHByaXZhdGUgU3RyaW5nIHNlbGVjdGVkVHJhaW5JZCA9IFwiXCI7ICAgLy8gQ29tcG91bmQgSUQgZm9yIHNlbGVjdGlvbiAodHJhaW4gY29kZSArIHRpbWUpXG4gICAgcHJpdmF0ZSBTdHJpbmcgY3VycmVudFRyYWluSWQgPSBcIlwiOyAgICAvLyBKdXN0IHRoZSB0cmFpbiBjb2RlXG4gICAgcHJpdmF0ZSBTdHJpbmcgY3VycmVudFRvYUlkID0gXCJcIjsgICAgICAvLyBDYXIgSURcbiAgICBwcml2YXRlIFN0cmluZyBjdXJyZW50TWFMaWNoID0gXCJcIjsgICAgIC8vIFNjaGVkdWxlIElEIGZvciBzZWF0IGxvYWRpbmdcbiAgICBwcml2YXRlIEFycmF5TGlzdDxUaWNrZXRJdGVtPiBjYXJ0SXRlbXMgPSBuZXcgQXJyYXlMaXN0PD4oKTtcbiAgICBwcml2YXRlIGRvdWJsZSB0b3RhbEFtb3VudCA9IDAuMDtcblxuICAgIC8vIFNlYXQgc3RhdHVzIGNvbnN0YW50c1xuICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyBTVEFUVVNfQVZBSUxBQkxFID0gXCJUcuG7kW5nXCI7XG4gICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgU3RyaW5nIFNUQVRVU19CT09LRUQgPSBcIsSQw6MgxJHhurd0XCI7XG4gICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgU3RyaW5nIFNUQVRVU19QRU5ESU5HID0gXCJDaOG7nSB4w6FjIG5o4bqtblwiO1xuXG4gICAgLy8gU2VhdCBjb2xvcnNcbiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBDb2xvciBTRUFUX0FWQUlMQUJMRV9DT0xPUiA9IENvbG9yLldISVRFO1xuICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIENvbG9yIFNFQVRfQk9PS0VEX0NPTE9SID0gQ29sb3IuTElHSFRfR1JBWTtcbiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBDb2xvciBTRUFUX1BFTkRJTkdfQ09MT1IgPSBDb2xvci5ZRUxMT1c7XG5cbiAgICBwcml2YXRlIE1hcDxTdHJpbmcsIFRpbWVyPiByZXNlcnZhdGlvblRpbWVycyA9IG5ldyBIYXNoTWFwPD4oKTsgLy8gU3RvcmUgdGltZXJzIGZvciBlYWNoIHJlc2VydmVkIHNlYXRcbiAgICBwcml2YXRlIE1hcDxTdHJpbmcsIEludGVnZXI+IHJlbWFpbmluZ1RpbWVzID0gbmV3IEhhc2hNYXA8PigpOyAgLy8gU3RvcmUgcmVtYWluaW5nIHNlY29uZHMgZm9yIGVhY2ggcmVzZXJ2YXRpb25cbiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBpbnQgUkVTRVJWQVRJT05fVElNRU9VVCA9IDMwMDsgLy8gMzAwIHNlY29uZHMgKDUgbWludXRlcylcblxuICAgIC8vIFZpc3VhbCBlZmZlY3RzXG4gICAgcHJpdmF0ZSBDb2xvciBhY3RpdmVDb2xvciA9IG5ldyBDb2xvcigwLCAxMzYsIDIwNCk7XG4gICAgcHJpdmF0ZSBDb2xvciBpbmFjdGl2ZUNvbG9yID0gbmV3IENvbG9yKDE1MywgMTUzLCAxNTMpO1xuICAgIHByaXZhdGUgQ29sb3IgaG92ZXJDb2xvciA9IG5ldyBDb2xvcig1MSwgMTUzLCAyNTUpO1xuICAgIHByaXZhdGUgQm9yZGVyIGFjdGl2ZUJvcmRlciA9IEJvcmRlckZhY3RvcnkuY3JlYXRlQ29tcG91bmRCb3JkZXIoXG4gICAgICAgICAgICBCb3JkZXJGYWN0b3J5LmNyZWF0ZUxpbmVCb3JkZXIobmV3IENvbG9yKDI1NSwgMjE1LCAwKSwgMiksIC8vIEdvbGQgYm9yZGVyXG4gICAgICAgICAgICBCb3JkZXJGYWN0b3J5LmNyZWF0ZUVtcHR5Qm9yZGVyKDEsIDEsIDEsIDEpXG4gICAgKTtcbiAgICBwcml2YXRlIEJvcmRlciBub3JtYWxCb3JkZXIgPSBCb3JkZXJGYWN0b3J5LmNyZWF0ZUVtcHR5Qm9yZGVyKDMsIDMsIDMsIDMpO1xuXG4gICAgLy8gREFPc1xuICAgIHByaXZhdGUgTGljaFRyaW5oVGF1REFPIGxpY2hUcmluaFRhdURBTztcbiAgICBwcml2YXRlIFRhdURBTyB0YXVEQU87XG4gICAgcHJpdmF0ZSBUb2FUYXVEQU8gdG9hVGF1REFPO1xuICAgIHByaXZhdGUgQ2hvTmdvaURBTyBjaG9OZ29pREFPO1xuICAgIHByaXZhdGUgS2h1eWVuTWFpREFPIGtodXllbk1haURBTztcblxuICAgIC8vIEVtcGxveWVlIGluZm9ybWF0aW9uXG4gICAgcHJpdmF0ZSBOaGFuVmllbiBuaGFuVmllbjtcblxuICAgIC8qKlxuICAgICAqIENvbnN0cnVjdG9yIC0gaW5pdGlhbGl6ZXMgdGhlIGFwcGxpY2F0aW9uXG4gICAgICogQHBhcmFtIG52IFRoZSBlbXBsb3llZSB3aG8gaXMgdXNpbmcgdGhlIHN5c3RlbVxuICAgICAqL1xuICAgIHB1YmxpYyBUcmFpblRpY2tldEJvb2tpbmdTeXN0ZW0oTmhhblZpZW4gbnYpIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xuICAgICAgICB0aGlzLm5oYW5WaWVuID0gbnY7XG4gICAgICAgIHNldFRpdGxlKFwiSOG7hyB0aOG7kW5nIMSR4bq3dCB2w6kgdMOgdVwiKTtcbiAgICAgICAgc2V0U2l6ZSgxMjAwLCA2NTApO1xuICAgICAgICBzZXREZWZhdWx0Q2xvc2VPcGVyYXRpb24oSkZyYW1lLkVYSVRfT05fQ0xPU0UpO1xuICAgICAgICBzZXRMb2NhdGlvblJlbGF0aXZlVG8obnVsbCk7XG5cbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBEQU9zXG4gICAgICAgIGxpY2hUcmluaFRhdURBTyA9IG5ldyBMaWNoVHJpbmhUYXVEQU9JbXBsKCk7XG4gICAgICAgIHRhdURBTyA9IG5ldyBUYXVEQU9JbXBsKCk7XG4gICAgICAgIHRvYVRhdURBTyA9IG5ldyBUb2FUYXVEQU9JbXBsKCk7XG4gICAgICAgIGNob05nb2lEQU8gPSBuZXcgQ2hvTmdvaURBT0ltcGwoKTtcbiAgICAgICAga2h1eWVuTWFpREFPID0gbmV3IEtodXllbk1haURBT0ltcGwoKTtcblxuICAgICAgICAvLyBNYWluIGNvbnRhaW5lciBwYW5lbCB3aXRoIEJvcmRlckxheW91dFxuICAgICAgICBKUGFuZWwgY29udGFpbmVyUGFuZWwgPSBuZXcgSlBhbmVsKG5ldyBCb3JkZXJMYXlvdXQoMTAsIDEwKSk7XG4uLi5cblxuICAgICAgICAgICAgLy8gR2V0IHNlYXQgcHJpY2UgYmFzZWQgb24gcm91dGUgYW5kIHNlYXQgY2xhc3NcbiAgICAgICAgICAgIGRvdWJsZSBwcmljZSA9IGdldFNlYXRQcmljZShjaG9OZ29pKTtcbiAgICAgICAgICAgIFN0cmluZyBkaXNwbGF5TmFtZSA9IChjaG9OZ29pLmdldFRlbkNobygpICE9IG51bGwpID8gY2hvTmdvaS5nZXRUZW5DaG8oKSA6IHNlYXRJZDtcblxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBVSSB0byByZWZsZWN0IHBlbmRpbmcgc3RhdHVzXG4gICAgICAgICAgICAgICAgdXBkYXRlU2VhdFN0YXR1cyhzZWF0SWQsIFNUQVRVU19QRU5ESU5HKTtcblxuICAgICAgICAgICAgICAgIC8vIEFkZCB0byBjYXJ0XG4gICAgICAgICAgICAgICAgYWRkVG9DYXJ0V2l0aFRpbWVvdXQoc2VhdElkLCBkaXNwbGF5TmFtZSwgcHJpY2UpO1xuXG4gICAgICAgICAgICAgICAgLy8gU3RhcnQgY291bnRkb3duIHRpbWVyIGZvciB0aGlzIHNlYXRcbiAgICAgICAgICAgICAgICBzdGFydFJlc2VydmF0aW9uQ291bnRkb3duKHNlYXRJZCwgZGlzcGxheU5hbWUsIHByaWNlKTtcblxuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZXgpIHtcbiAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIFwiTOG7l2kga2hpIGdp4buvIGNo4buXOiBcIiArIGV4LmdldE1lc3NhZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgXCJM4buXaVwiLCBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFKTtcbiAgICAgICAgICAgIGV4LnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICB9XG4gICAgfVxuLi4uXG5cbiAgICAgICAgLy8gQ3JlYXRlIGFuZCBhZGQgdGlja2V0IGl0ZW0gdG8gY2FydCB3aXRoIHNlYXRJZCBmb3IgbGF0ZXIgcmVmZXJlbmNlXG4gICAgICAgIFRpY2tldEl0ZW0gaXRlbSA9IG5ldyBUaWNrZXRJdGVtKGN1cnJlbnRUcmFpbklkLCBzZWF0SWQsIGRpc3BsYXlOYW1lLCBmcm9tLCB0bywgZGVwYXJ0dXJlRGF0ZSwgcHJpY2UsIGNhcklkLCBjYXJOYW1lKTtcbiAgICAgICAgY2FydEl0ZW1zLmFkZChpdGVtKTtcblxuICAgICAgICAvLyBVcGRhdGUgY2FydCBkaXNwbGF5XG4gICAgICAgIHVwZGF0ZUNhcnREaXNwbGF5KCk7XG5cbiAgICAgICAgLy8gSW1tZWRpYXRlbHkgdXBkYXRlIHRoZSBzZWF0IHN0YXR1cyBpbiBVSSB0byBzaG93IGFzIHBlbmRpbmcgKHllbGxvdylcbiAgICAgICAgdXBkYXRlU2VhdFN0YXR1cyhzZWF0SWQsIFNUQVRVU19QRU5ESU5HKTtcbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBjYXJ0IGl0ZW0gdG8gc2hvdyBjb3VudGRvd25cbiAgICAgKi9cblxuXG4gICAgLyoqXG4gICAgICogSGVscGVyIHRvIHVwZGF0ZSBhIHBhbmVsIHdpdGggY291bnRkb3duXG4gICAgICovXG4uLi5cblxuICAgIC8qKlxuICAgICAqIFNlYXJjaCBmb3IgdHJhaW5zIGJhc2VkIG9uIGZvcm0gZGF0YVxuICAgICAqL1xuICAgIHByaXZhdGUgdm9pZCBzZWFyY2hUcmFpbnMoKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZXQgaW5wdXQgZGF0YVxuICAgICAgICAgICAgU3RyaW5nIGdhRGkgPSBkZXBhcnR1cmVGaWVsZC5nZXRUZXh0KCkudHJpbSgpO1xuICAgICAgICAgICAgU3RyaW5nIGdhRGVuID0gYXJyaXZhbEZpZWxkLmdldFRleHQoKS50cmltKCk7XG5cbiAgICAgICAgICAgIC8vIFBhcnNlIGRhdGVcbiAgICAgICAgICAgIERhdGVUaW1lRm9ybWF0dGVyIGZvcm1hdHRlciA9IERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybihcImRkL01NL3l5eXlcIik7XG4gICAgICAgICAgICBMb2NhbERhdGUgZGVwYXJ0dXJlRGF0ZSA9IExvY2FsRGF0ZS5wYXJzZShkZXBhcnR1cmVEYXRlRmllbGQuZ2V0VGV4dCgpLnRyaW0oKSwgZm9ybWF0dGVyKTtcblxuICAgICAgICAgICAgLy8gQ2FsbCBEQU8gdG8gZ2V0IHRyYWluIHNjaGVkdWxlc1xuICAgICAgICAgICAgTGlzdDxMaWNoVHJpbmhUYXU+IGFsbExpY2hUcmluaExpc3QgPSBsaWNoVHJpbmhUYXVEQU8uZ2V0TGlzdExpY2hUcmluaFRhdUJ5RGF0ZUFuZEdhRGlHYURlbihkZXBhcnR1cmVEYXRlLCBnYURpLCBnYURlbik7XG4uLi5cblxuICAgICAgICAgICAgLy8gQ3JlYXRlIHRyYWluIGNhcmRzIG9ubHkgZm9yIGZpbHRlcmVkIHNjaGVkdWxlc1xuICAgICAgICAgICAgZm9yIChMaWNoVHJpbmhUYXUgbGljaFRyaW5oIDogZmlsdGVyZWRMaWNoVHJpbmhMaXN0KSB7XG4gICAgICAgICAgICAgICAgLy8gR2V0IHRyYWluIG9iamVjdFxuICAgICAgICAgICAgICAgIFRhdSB0YXUgPSB0YXVEQU8uZ2V0VGF1QnlMaWNoVHJpbmhUYXUobGljaFRyaW5oKTtcblxuICAgICAgICAgICAgICAgIC8vIEZvcm1hdCBkZXBhcnR1cmUgdGltZVxuICAgICAgICAgICAgICAgIERhdGVUaW1lRm9ybWF0dGVyIHRpbWVGb3JtYXR0ZXIgPSBEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oXCJISDptbVwiKTtcbiAgICAgICAgICAgICAgICBTdHJpbmcgZGVwYXJ0VGltZSA9IGxpY2hUcmluaC5nZXRHaW9EaSgpLmZvcm1hdCh0aW1lRm9ybWF0dGVyKTtcblxuICAgICAgICAgICAgICAgIC8vIEZvcm1hdCBkYXRlXG4gICAgICAgICAgICAgICAgRGF0ZVRpbWVGb3JtYXR0ZXIgZGF0ZUZvcm1hdHRlciA9IERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybihcImRkL01NXCIpO1xuICAgICAgICAgICAgICAgIFN0cmluZyBkZXBhcnREYXRlID0gbGljaFRyaW5oLmdldE5nYXlEaSgpLmZvcm1hdChkYXRlRm9ybWF0dGVyKTtcblxuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBmb3JtYXR0ZWQgdGltZXMgZm9yIGRpc3BsYXlcbiAgICAgICAgICAgICAgICBTdHJpbmcgZGVwYXJ0VGltZUZvcm1hdHRlZCA9IGRlcGFydERhdGUgKyBcIiBcIiArIGRlcGFydFRpbWU7XG5cbiAgICAgICAgICAgICAgICAvLyBHZXQgYXZhaWxhYmxlIHNlYXRzXG4gICAgICAgICAgICAgICAgbG9uZyBhdmFpbGFibGVTZWF0cyA9IGxpY2hUcmluaFRhdURBTy5nZXRBdmFpbGFibGVTZWF0c0J5U2NoZWR1bGUobGljaFRyaW5oLmdldE1hTGljaCgpKTtcblxuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSB0cmFpbiBjYXJkIHdpdGggc3RhdHVzIGluZGljYXRvclxuICAgICAgICAgICAgICAgIEpQYW5lbCB0cmFpbkNhcmQgPSBjcmVhdGVUcmFpbkNhcmQoXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXUuZ2V0TWFUYXUoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlcGFydFRpbWVGb3JtYXR0ZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBhdmFpbGFibGVTZWF0cyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhbHNlLCAvLyBJbml0aWFsbHkgbm90IHNlbGVjdGVkXG4gICAgICAgICAgICAgICAgICAgICAgICBsaWNoVHJpbmguZ2V0VHJhbmdUaGFpKCksICAvLyBQYXNzIHRoZSBzdGF0dXMgdG8gcG9zc2libHkgZGlzcGxheSBpdFxuICAgICAgICAgICAgICAgICAgICAgICAgbGljaFRyaW5oLmdldE1hTGljaCgpICAgICAgLy8gU3RvcmUgc2NoZWR1bGUgSURcbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgdHJhaW5zUGFuZWwuYWRkKHRyYWluQ2FyZCk7XG4gICAgICAgICAgICAgICAgdHJhaW5zUGFuZWwuYWRkKEJveC5jcmVhdGVIb3Jpem9udGFsU3RydXQoMTApKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQ2xlYXIgY2FyIHBhbmVsIGFuZCB1cGRhdGUgaGVhZGVyXG4gICAgICAgICAgICBsb2FkVHJhaW5DYXJzKFwiXCIpOyAvLyBFbXB0eSB0cmFpbiBJRCB0byBzaG93IHBsYWNlaG9sZGVyXG4gICAgICAgICAgICBzZWF0aW5nU2VjdGlvbkxhYmVsLnNldFRleHQoXCJUb2E6IENoxrBhIGNo4buNblwiKTtcblxuICAgICAgICAgICAgLy8gVXBkYXRlIGhlYWRlclxuICAgICAgICAgICAgdXBkYXRlSGVhZGVySW5mbyhnYURpLCBnYURlbiwgZGVwYXJ0dXJlRGF0ZUZpZWxkLmdldFRleHQoKSk7XG5cbiAgICAgICAgICAgIC8vIFJlZnJlc2ggVUlcbiAgICAgICAgICAgIHRyYWluc1BhbmVsLnJldmFsaWRhdGUoKTtcbiAgICAgICAgICAgIHRyYWluc1BhbmVsLnJlcGFpbnQoKTtcblxuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiU2VhcmNoIGNvbXBsZXRlZCwgXCIgKyBmaWx0ZXJlZExpY2hUcmluaExpc3Quc2l6ZSgpICsgXCIgdHJhaW5zIGZvdW5kXCIpO1xuLi4uXG4gICAgICAgIGNoZWNrb3V0QnV0dG9uLmFkZEFjdGlvbkxpc3RlbmVyKGUgLT4ge1xuICAgICAgICAgICAgaWYgKGNhcnRJdGVtcy5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgICAgIFRyYWluVGlja2V0Qm9va2luZ1N5c3RlbS50aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJHaeG7jyB2w6kgdHLhu5FuZy4gVnVpIGzDsm5nIGNo4buNbiB2w6kgdHLGsOG7m2Mga2hpIHRoYW5oIHRvw6FuLlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJUaMO0bmcgYsOhb1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBDcmVhdGUgYSBtYXAgb2Ygc2VhdCBJRHMgdG8gc2NoZWR1bGUgSURzXG4gICAgICAgICAgICBNYXA8U3RyaW5nLCBTdHJpbmc+IHRpY2tldHNUb0NoZWNrb3V0ID0gbmV3IEhhc2hNYXA8PigpO1xuICAgICAgICAgICAgZm9yIChUaWNrZXRJdGVtIGl0ZW0gOiBjYXJ0SXRlbXMpIHtcbiAgICAgICAgICAgICAgICB0aWNrZXRzVG9DaGVja291dC5wdXQoaXRlbS5zZWF0SWQsIGN1cnJlbnRNYUxpY2gpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBPcGVuIGNoZWNrb3V0IHNjcmVlbiB3aXRoIG9ubHkgdGhlIG5lY2Vzc2FyeSBpZGVudGlmaWVycyBhbmQgZW1wbG95ZWUgaW5mb3JtYXRpb25cbiAgICAgICAgICAgIFRoYW5oVG9hbkdVSSBjaGVja291dFNjcmVlbiA9IG51bGw7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNoZWNrb3V0U2NyZWVuID0gbmV3IFRoYW5oVG9hbkdVSSh0aWNrZXRzVG9DaGVja291dCwgbmhhblZpZW4pO1xuICAgICAgICAgICAgfSBjYXRjaCAoUmVtb3RlRXhjZXB0aW9uIGV4KSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFeGNlcHRpb24oZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2hlY2tvdXRTY3JlZW4uc2V0VmlzaWJsZSh0cnVlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIE9wZW4gY2hlY2tvdXQgc2NyZWVuXG4uLi5cblxuXG5cblxuICAgIC8qKlxuICAgICAqIE1haW4gbWV0aG9kXG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyB2b2lkIG1haW4oU3RyaW5nW10gYXJncykge1xuICAgICAgICAvLyBTZXQgc3lzdGVtIHRpbWUgZm9yIGRlYnVnZ2luZyAtIGluIHByb2R1Y3Rpb24gdGhpcyB3b3VsZCBiZSByZW1vdmVkXG4gICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIlN5c3RlbSB0aW1lOiBcIiArIG5ldyBEYXRlKCkpO1xuICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJVc2VyOiBsdW9uZ3RhbjIwNHZpZXRcIik7XG5cbiAgICAgICAgU3dpbmdVdGlsaXRpZXMuaW52b2tlTGF0ZXIoKCkgLT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgYSBzYW1wbGUgZW1wbG95ZWUgZm9yIHRlc3RpbmdcbiAgICAgICAgICAgICAgICBOaGFuVmllbiBudiA9IG5ldyBOaGFuVmllbigpO1xuICAgICAgICAgICAgICAgIE5oYW5WaWVuREFPIG5oYW5WaWVuREFPID0gbmV3IE5oYW5WaWVuREFPSW1wbCgpO1xuICAgICAgICAgICAgICAgIG52ID0gbmhhblZpZW5EQU8uZ2V0bmhhbnZpZW5CeUlkKFwiTlYyMDI1MDQxODAwMDFcIik7XG5cbiAgICAgICAgICAgICAgICBUcmFpblRpY2tldEJvb2tpbmdTeXN0ZW0gYXBwID0gbmV3IFRyYWluVGlja2V0Qm9va2luZ1N5c3RlbShudik7XG4gICAgICAgICAgICAgICAgYXBwLnNldFZpc2libGUodHJ1ZSk7XG4gICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpIGto4bufaSDEkeG7mW5nIOG7qW5nIGThu6VuZzogXCIgKyBlLmdldE1lc3NhZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2lcIiwgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRSk7XG4gICAgICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9UaGFuaFRvYW5HVUkuamF2YVxucGFja2FnZSBndWlDbGllbnQ7XG5cbmltcG9ydCBkYW8uKjtcbmltcG9ydCBkYW8uaW1wbC4qO1xuaW1wb3J0IG1vZGVsLio7XG5cbmltcG9ydCBqYXZheC5zd2luZy4qO1xuaW1wb3J0IGphdmF4LnN3aW5nLmJvcmRlci4qO1xuaW1wb3J0IGphdmF4LnN3aW5nLnRhYmxlLio7XG5pbXBvcnQgamF2YS5hd3QuKjtcbmltcG9ydCBqYXZhLmF3dC5ldmVudC4qO1xuaW1wb3J0IGphdmEucm1pLlJlbW90ZUV4Y2VwdGlvbjtcbmltcG9ydCBqYXZhLnRleHQuTnVtYmVyRm9ybWF0O1xuaW1wb3J0IGphdmEudGltZS5Mb2NhbERhdGU7XG5pbXBvcnQgamF2YS50aW1lLmZvcm1hdC5EYXRlVGltZUZvcm1hdHRlcjtcbmltcG9ydCBqYXZhLnV0aWwuKjtcbmltcG9ydCBqYXZhLnV0aWwuTGlzdDtcblxuLyoqXG4gKiBDaGVja291dCBpbnRlcmZhY2UgZm9yIHRyYWluIHRpY2tldCBib29raW5nIHN5c3RlbVxuICogRGlzcGxheXMgc2VsZWN0ZWQgdGlja2V0cyBhbmQgY29sbGVjdHMgcGFzc2VuZ2VyIGluZm9ybWF0aW9uXG4gKiBAYXV0aG9yIGx1b25ndGFuMjA0XG4gKi9cbnB1YmxpYyBjbGFzcyBUaGFuaFRvYW5HVUkgZXh0ZW5kcyBKRnJhbWUge1xuICAgIC8vIE1haW4gcGFuZWxzXG4gICAgcHJpdmF0ZSBKUGFuZWwgbWFpblBhbmVsO1xuICAgIHByaXZhdGUgSlRhYmxlIHRpY2tldFRhYmxlO1xuICAgIHByaXZhdGUgRGVmYXVsdFRhYmxlTW9kZWwgdGFibGVNb2RlbDtcblxuICAgIC8vIEZvcm0gZmllbGRzXG4gICAgcHJpdmF0ZSBKVGV4dEZpZWxkIG5hbWVGaWVsZDtcbiAgICBwcml2YXRlIEpUZXh0RmllbGQgaWRDYXJkRmllbGQ7XG4gICAgcHJpdmF0ZSBKVGV4dEZpZWxkIGVtYWlsRmllbGQ7XG4gICAgcHJpdmF0ZSBKVGV4dEZpZWxkIGNvbmZpcm1FbWFpbEZpZWxkO1xuICAgIHByaXZhdGUgSlRleHRGaWVsZCBwaG9uZUZpZWxkO1xuICAgIHByaXZhdGUgSkNvbWJvQm94PEtodXllbk1haT4gcHJvbW90aW9uQ29tYm9Cb3g7XG5cbiAgICAvLyBTdG9yZSB0aGUgc2NoZWR1bGUgZGF0ZSBmb3IgcHJvbW90aW9uc1xuICAgIHByaXZhdGUgTG9jYWxEYXRlIHNjaGVkdWxlRGF0ZTtcblxuICAgIC8vIFN1bW1hcnkgZmllbGRzXG4gICAgcHJpdmF0ZSBKTGFiZWwgdG90YWxBbW91bnRMYWJlbDtcbiAgICBwcml2YXRlIGRvdWJsZSB0b3RhbEFtb3VudCA9IDAuMDtcblxuICAgIC8vIENvbmZpcm1hdGlvbiBwYW5lbFxuICAgIHByaXZhdGUgSlRleHRBcmVhIGNvbmZpcm1hdGlvblRleHRBcmVhO1xuXG4gICAgLy8gUGF5bWVudCBmaWVsZHNcbiAgICBwcml2YXRlIEpUZXh0RmllbGQgYW1vdW50UGFpZEZpZWxkO1xuICAgIHByaXZhdGUgSkxhYmVsIGNoYW5nZUFtb3VudExhYmVsO1xuXG4gICAgLy8gRGF0YVxuICAgIHByaXZhdGUgTWFwPFN0cmluZywgU3RyaW5nPiB0aWNrZXRzTWFwOyAvLyBNYXAgb2Ygc2VhdCBJRHMgdG8gc2NoZWR1bGUgSURzXG4gICAgcHJpdmF0ZSBDb2xvciBwcmltYXJ5Q29sb3IgPSBuZXcgQ29sb3IoMCwgMTM2LCAyMDQpO1xuXG4gICAgLy8gRW1wbG95ZWUgaW5mb3JtYXRpb25cbiAgICBwcml2YXRlIE5oYW5WaWVuIG5oYW5WaWVuO1xuXG4gICAgLy8gREFPc1xuICAgIHByaXZhdGUgTGljaFRyaW5oVGF1REFPIGxpY2hUcmluaFRhdURBTztcbiAgICBwcml2YXRlIENob05nb2lEQU8gY2hvTmdvaURBTztcbiAgICBwcml2YXRlIFRvYVRhdURBTyB0b2FUYXVEQU87XG4gICAgcHJpdmF0ZSBUYXVEQU8gdGF1REFPO1xuICAgIHByaXZhdGUgS2h1eWVuTWFpREFPIGtodXllbk1haURBTztcbiAgICBwcml2YXRlIEtoYWNoSGFuZ0RBTyBraGFjaEhhbmdEQU87XG4gICAgcHJpdmF0ZSBkYW8uTG9haUtoYWNoSGFuZ0RBTyBsb2FpS2hhY2hIYW5nREFPO1xuICAgIHByaXZhdGUgVmVUYXVEQU8gdmVUYXVEQU87XG4gICAgcHJpdmF0ZSBIb2FEb25EQU8gaG9hRG9uREFPO1xuICAgIHByaXZhdGUgQ2hpVGlldEhvYURvbkRBTyBjaGlUaWV0SG9hRG9uREFPO1xuICAgIHByaXZhdGUgTG9haUhvYURvbkRBTyBsb2FpSG9hRG9uREFPO1xuXG4gICAgLyoqXG4gICAgICogQ29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0gdGlja2V0c01hcCBNYXAgb2Ygc2VhdCBJRHMgdG8gc2NoZWR1bGUgSURzXG4gICAgICogQHBhcmFtIG52IFRoZSBlbXBsb3llZSB3aG8gaXMgcHJvY2Vzc2luZyB0aGUgcGF5bWVudFxuICAgICAqL1xuICAgIHB1YmxpYyBUaGFuaFRvYW5HVUkoTWFwPFN0cmluZywgU3RyaW5nPiB0aWNrZXRzTWFwLCBOaGFuVmllbiBudikgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgICAgIHRoaXMudGlja2V0c01hcCA9IHRpY2tldHNNYXA7XG4gICAgICAgIHRoaXMubmhhblZpZW4gPSBudjtcblxuICAgICAgICAvLyBJbml0aWFsaXplIERBT3NcbiAgICAgICAgbGljaFRyaW5oVGF1REFPID0gbmV3IExpY2hUcmluaFRhdURBT0ltcGwoKTtcbiAgICAgICAgY2hvTmdvaURBTyA9IG5ldyBDaG9OZ29pREFPSW1wbCgpO1xuICAgICAgICB0b2FUYXVEQU8gPSBuZXcgVG9hVGF1REFPSW1wbCgpO1xuICAgICAgICB0YXVEQU8gPSBuZXcgVGF1REFPSW1wbCgpO1xuICAgICAgICBraHV5ZW5NYWlEQU8gPSBuZXcgS2h1eWVuTWFpREFPSW1wbCgpO1xuICAgICAgICBraGFjaEhhbmdEQU8gPSBuZXcgS2hhY2hIYW5nREFPSW1wbCgpO1xuICAgICAgICBsb2FpS2hhY2hIYW5nREFPID0gbmV3IExvYWlLaGFjaEhhbmdEQU9JbXBsKCk7XG4gICAgICAgIHZlVGF1REFPID0gbmV3IFZlVGF1REFPSW1wbCgpO1xuICAgICAgICBob2FEb25EQU8gPSBuZXcgSG9hRG9uREFPSW1wbCgpO1xuICAgICAgICBjaGlUaWV0SG9hRG9uREFPID0gbmV3IENoaVRpZXRIb2FEb25EQU9JbXBsKCk7XG4gICAgICAgIGxvYWlIb2FEb25EQU8gPSBuZXcgTG9haUhvYURvbkRBT0ltcGwoKTtcblxuICAgICAgICBzZXRUaXRsZShcIlRoYW5oIHRvw6FuIHbDqSB0w6B1XCIpO1xuICAgICAgICBzZXRTaXplKDEwMDAsIDcwMCk7XG4gICAgICAgIHNldERlZmF1bHRDbG9zZU9wZXJhdGlvbihKRnJhbWUuRElTUE9TRV9PTl9DTE9TRSk7XG4gICAgICAgIHNldExvY2F0aW9uUmVsYXRpdmVUbyhudWxsKTtcblxuICAgICAgICBpbml0Q29tcG9uZW50cygpO1xuICAgICAgICBjYWxjdWxhdGVUb3RhbCgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEluaXRpYWxpemUgY29tcG9uZW50c1xuICAgICAqL1xuICAgIHByaXZhdGUgdm9pZCBpbml0Q29tcG9uZW50cygpIHtcbiAgICAgICAgLy8gTWFpbiBjb250YWluZXIgd2l0aCBwYWRkaW5nXG4gICAgICAgIG1haW5QYW5lbCA9IG5ldyBKUGFuZWwobmV3IEJvcmRlckxheW91dCgxMCwgMTApKTtcbiAgICAgICAgbWFpblBhbmVsLnNldEJvcmRlcihuZXcgRW1wdHlCb3JkZXIoMTUsIDE1LCAxNSwgMTUpKTtcblxuICAgICAgICAvLyBUaXRsZSBwYW5lbFxuICAgICAgICBKUGFuZWwgdGl0bGVQYW5lbCA9IGNyZWF0ZVRpdGxlUGFuZWwoKTtcbiAgICAgICAgbWFpblBhbmVsLmFkZCh0aXRsZVBhbmVsLCBCb3JkZXJMYXlvdXQuTk9SVEgpO1xuXG4gICAgICAgIC8vIEluaXRpYWxpemUgcHJvbW90aW9uQ29tYm9Cb3ggYmVmb3JlIGNyZWF0aW5nIHRpY2tldHMgdGFibGVcbiAgICAgICAgcHJvbW90aW9uQ29tYm9Cb3ggPSBuZXcgSkNvbWJvQm94PD4oKTtcbiAgICAgICAgcHJvbW90aW9uQ29tYm9Cb3guc2V0UHJlZmVycmVkU2l6ZShuZXcgRGltZW5zaW9uKDIwMCwgMzApKTtcblxuICAgICAgICAvLyBDZW50ZXIgcGFuZWwgY29udGFpbmluZyB0aWNrZXRzIHRhYmxlIGFuZCBib3R0b20gY29udHJvbHNcbiAgICAgICAgSlBhbmVsIGNlbnRlclBhbmVsID0gbmV3IEpQYW5lbChuZXcgQm9yZGVyTGF5b3V0KDAsIDEwKSk7XG5cbiAgICAgICAgLy8gQ3JlYXRlIHRpY2tldHMgdGFibGVcbiAgICAgICAgY3JlYXRlVGlja2V0c1RhYmxlKCk7XG4gICAgICAgIEpTY3JvbGxQYW5lIHRhYmxlU2Nyb2xsUGFuZSA9IG5ldyBKU2Nyb2xsUGFuZSh0aWNrZXRUYWJsZSk7XG4gICAgICAgIHRhYmxlU2Nyb2xsUGFuZS5zZXRCb3JkZXIoQm9yZGVyRmFjdG9yeS5jcmVhdGVMaW5lQm9yZGVyKG5ldyBDb2xvcigyMDAsIDIwMCwgMjAwKSkpO1xuICAgICAgICBjZW50ZXJQYW5lbC5hZGQodGFibGVTY3JvbGxQYW5lLCBCb3JkZXJMYXlvdXQuQ0VOVEVSKTtcblxuICAgICAgICAvLyBCb3R0b20gcGFuZWwgZm9yIGJ1dHRvbnMgYW5kIGRpc2NvdW50XG4gICAgICAgIEpQYW5lbCBib3R0b21QYW5lbCA9IG5ldyBKUGFuZWwobmV3IEJvcmRlckxheW91dCg1LCAwKSk7XG5cbiAgICAgICAgLy8gTGVmdCAtIFJlbW92ZSBhbGwgdGlja2V0cyBidXR0b25cbiAgICAgICAgSlBhbmVsIGJ1dHRvblBhbmVsID0gbmV3IEpQYW5lbChuZXcgRmxvd0xheW91dChGbG93TGF5b3V0LkxFRlQpKTtcbiAgICAgICAgSkJ1dHRvbiByZW1vdmVBbGxCdXR0b24gPSBuZXcgSkJ1dHRvbihcIljDs2EgdOG6pXQgY+G6oyBjw6FjIHbDqVwiKTtcbiAgICAgICAgcmVtb3ZlQWxsQnV0dG9uLnNldEljb24oY3JlYXRlVHJhc2hJY29uKCkpO1xuICAgICAgICByZW1vdmVBbGxCdXR0b24uYWRkQWN0aW9uTGlzdGVuZXIoZSAtPiByZW1vdmVBbGxUaWNrZXRzKCkpO1xuICAgICAgICBidXR0b25QYW5lbC5hZGQocmVtb3ZlQWxsQnV0dG9uKTtcbiAgICAgICAgYm90dG9tUGFuZWwuYWRkKGJ1dHRvblBhbmVsLCBCb3JkZXJMYXlvdXQuV0VTVCk7XG4uLi5cblxuICAgICAgICAvLyBDcmVhdGUgc291dGggcGFuZWwgZm9yIGN1c3RvbWVyIGluZm8gYW5kIHBheW1lbnQgYnV0dG9uXG4gICAgICAgIEpQYW5lbCBzb3V0aFBhbmVsID0gbmV3IEpQYW5lbChuZXcgQm9yZGVyTGF5b3V0KDAsIDEwKSk7XG5cbiAgICAgICAgLy8gQ3VzdG9tZXIgaW5mb3JtYXRpb24gc2VjdGlvblxuICAgICAgICBKUGFuZWwgY3VzdG9tZXJQYW5lbCA9IGNyZWF0ZUN1c3RvbWVySW5mb1BhbmVsKCk7XG4gICAgICAgIHNvdXRoUGFuZWwuYWRkKGN1c3RvbWVyUGFuZWwsIEJvcmRlckxheW91dC5OT1JUSCk7XG5cbiAgICAgICAgLy8gUGF5bWVudCBidXR0b25cbiAgICAgICAgSlBhbmVsIHBheW1lbnRQYW5lbCA9IG5ldyBKUGFuZWwobmV3IEZsb3dMYXlvdXQoRmxvd0xheW91dC5SSUdIVCkpO1xuICAgICAgICBKQnV0dG9uIHBheUJ1dHRvbiA9IG5ldyBKQnV0dG9uKFwiVGhhbmggdG/DoW5cIik7XG4gICAgICAgIHBheUJ1dHRvbi5zZXRCYWNrZ3JvdW5kKHByaW1hcnlDb2xvcik7XG4gICAgICAgIHBheUJ1dHRvbi5zZXRGb3JlZ3JvdW5kKENvbG9yLldISVRFKTtcbiAgICAgICAgcGF5QnV0dG9uLnNldEZvbnQobmV3IEZvbnQoXCJBcmlhbFwiLCBGb250LkJPTEQsIDE0KSk7XG4gICAgICAgIHBheUJ1dHRvbi5zZXRQcmVmZXJyZWRTaXplKG5ldyBEaW1lbnNpb24oMTIwLCAzNSkpO1xuICAgICAgICBwYXlCdXR0b24uYWRkQWN0aW9uTGlzdGVuZXIoZSAtPiBwcm9jZXNzUGF5bWVudCgpKTtcbiAgICAgICAgcGF5bWVudFBhbmVsLmFkZChwYXlCdXR0b24pO1xuICAgICAgICBzb3V0aFBhbmVsLmFkZChwYXltZW50UGFuZWwsIEJvcmRlckxheW91dC5TT1VUSCk7XG4uLi5cblxuICAgICAgICAgICAgaWRGaWVsZC5zZXRCb3JkZXIoQm9yZGVyRmFjdG9yeS5jcmVhdGVUaXRsZWRCb3JkZXIoXG4gICAgICAgICAgICAgICAgICAgIEJvcmRlckZhY3RvcnkuY3JlYXRlTGluZUJvcmRlcihuZXcgQ29sb3IoMjAwLCAyMDAsIDIwMCkpLFxuICAgICAgICAgICAgICAgICAgICBcIlPhu5EgZ2nhuqV5IHThu51cIixcbiAgICAgICAgICAgICAgICAgICAgVGl0bGVkQm9yZGVyLkRFRkFVTFRfSlVTVElGSUNBVElPTixcbiAgICAgICAgICAgICAgICAgICAgVGl0bGVkQm9yZGVyLlRPUCxcbiAgICAgICAgICAgICAgICAgICAgbmV3IEZvbnQoXCJBcmlhbFwiLCBGb250LlBMQUlOLCAxMCksXG4gICAgICAgICAgICAgICAgICAgIG5ldyBDb2xvcigxMDAsIDEwMCwgMTAwKVxuICAgICAgICAgICAgKSk7XG5cbiAgICAgICAgICAgIGFnZUZpZWxkLnNldEJvcmRlcihCb3JkZXJGYWN0b3J5LmNyZWF0ZVRpdGxlZEJvcmRlcihcbiAgICAgICAgICAgICAgICAgICAgQm9yZGVyRmFjdG9yeS5jcmVhdGVMaW5lQm9yZGVyKG5ldyBDb2xvcigyMDAsIDIwMCwgMjAwKSksXG4gICAgICAgICAgICAgICAgICAgIFwiVHXhu5VpIChjaG8gdHLhursgZW0pXCIsXG4gICAgICAgICAgICAgICAgICAgIFRpdGxlZEJvcmRlci5ERUZBVUxUX0pVU1RJRklDQVRJT04sXG4gICAgICAgICAgICAgICAgICAgIFRpdGxlZEJvcmRlci5UT1AsXG4gICAgICAgICAgICAgICAgICAgIG5ldyBGb250KFwiQXJpYWxcIiwgRm9udC5QTEFJTiwgMTApLFxuICAgICAgICAgICAgICAgICAgICBuZXcgQ29sb3IoMTAwLCAxMDAsIDEwMClcbiAgICAgICAgICAgICkpO1xuXG4gICAgICAgICAgICBhZGQobmFtZUZpZWxkKTtcbiAgICAgICAgICAgIGFkZCh0eXBlQ29tYm8pO1xuICAgICAgICAgICAgYWRkKGlkRmllbGQpO1xuICAgICAgICAgICAgYWRkKGFnZUZpZWxkKTtcblxuICAgICAgICAgICAgc2V0QmFja2dyb3VuZChDb2xvci5XSElURSk7XG4gICAgICAgIH1cbi4uLlxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBkb3VibGUgYW1vdW50UGFpZCA9IERvdWJsZS5wYXJzZURvdWJsZShhbW91bnRQYWlkRmllbGQuZ2V0VGV4dCgpLnRyaW0oKS5yZXBsYWNlKFwiLFwiLCBcIlwiKSk7XG4gICAgICAgICAgICBpZiAoYW1vdW50UGFpZCA8IHRvdGFsQW1vdW50KSB7XG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJT4buRIHRp4buBbiBraMOhY2ggxJHGsGEga2jDtG5nIMSR4bunIMSR4buDIHRoYW5oIHRvw6FuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBhbW91bnRQYWlkRmllbGQucmVxdWVzdEZvY3VzKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChOdW1iZXJGb3JtYXRFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIFwiU+G7kSB0aeG7gW4ga2jDoWNoIMSRxrBhIGtow7RuZyBo4bujcCBs4buHXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiTOG7l2lcIixcbiAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGFtb3VudFBhaWRGaWVsZC5yZXF1ZXN0Rm9jdXMoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNob3cgcGF5bWVudCBvcHRpb25zIGRpYWxvZ1xuICAgICAgICBTdHJpbmdbXSBvcHRpb25zID0ge1wiVGnhu4FuIG3hurd0XCIsIFwiVGjhursgdMOtbiBk4bulbmdcIiwgXCJDaHV54buDbiBraG/huqNuXCIsIFwiVsOtIMSRaeG7h24gdOG7rVwifTtcbiAgICAgICAgaW50IGNob2ljZSA9IEpPcHRpb25QYW5lLnNob3dPcHRpb25EaWFsb2coXG4gICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICBcIkNo4buNbiBwaMawxqFuZyB0aOG7qWMgdGhhbmggdG/DoW5cIixcbiAgICAgICAgICAgICAgICBcIlRoYW5oIHRvw6FuXCIsXG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuREVGQVVMVF9PUFRJT04sXG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuUVVFU1RJT05fTUVTU0FHRSxcbiAgICAgICAgICAgICAgICBudWxsLFxuICAgICAgICAgICAgICAgIG9wdGlvbnMsXG4gICAgICAgICAgICAgICAgb3B0aW9uc1swXVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIFByb2Nlc3MgYmFzZWQgb24gc2VsZWN0ZWQgcGF5bWVudCBtZXRob2RcbiAgICAgICAgaWYgKGNob2ljZSA+PSAwKSB7XG4gICAgICAgICAgICAvLyBTaG93IHByb2Nlc3NpbmcgbWVzc2FnZVxuICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIFwixJBhbmcgeOG7rSBsw70gdGhhbmggdG/DoW4uLi5cIixcbiAgICAgICAgICAgICAgICAgICAgXCJUaGFuaCB0b8OhblwiLFxuICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5JTkZPUk1BVElPTl9NRVNTQUdFXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIEdldCBjdXN0b21lciBpbmZvcm1hdGlvbiBmcm9tIGZvcm1cbiAgICAgICAgICAgICAgICBTdHJpbmcgY3VzdG9tZXJOYW1lID0gbmFtZUZpZWxkLmdldFRleHQoKS50cmltKCk7XG4gICAgICAgICAgICAgICAgU3RyaW5nIGlkQ2FyZCA9IGlkQ2FyZEZpZWxkLmdldFRleHQoKS50cmltKCk7XG4gICAgICAgICAgICAgICAgU3RyaW5nIHBob25lID0gcGhvbmVGaWVsZC5nZXRUZXh0KCkudHJpbSgpO1xuICAgICAgICAgICAgICAgIFN0cmluZyBlbWFpbCA9IGVtYWlsRmllbGQuZ2V0VGV4dCgpLnRyaW0oKTsgLy8gVGhpcyBpcyB0aGUgYWRkcmVzcyBmaWVsZCBhcyBwZXIgcmVxdWlyZW1lbnRzXG5cbiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiBjdXN0b21lciBleGlzdHMgYnkgSUQgY2FyZCBhbmQgcGhvbmUgbnVtYmVyXG4gICAgICAgICAgICAgICAgS2hhY2hIYW5nIGV4aXN0aW5nQ3VzdG9tZXIgPSBraGFjaEhhbmdEQU8uZmluZEJ5SWRDYXJkQW5kUGhvbmUoaWRDYXJkLCBwaG9uZSk7XG4uLi5cblxuICAgICAgICAgICAgICAgICAgICAvLyBTYXZlIGludm9pY2UgZGV0YWlsIHRvIGRhdGFiYXNlXG4gICAgICAgICAgICAgICAgICAgIGlmICghY2hpVGlldEhvYURvbkRBTy5zYXZlKGRldGFpbCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oXCJM4buXaSBraGkgbMawdSBjaGkgdGnhur90IGjDs2EgxJHGoW4gY2hvIHbDqTogXCIgKyB0aWNrZXQuZ2V0TWFWZSgpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBjaGFuZ2UgZm9yIGNhc2ggcGF5bWVudFxuICAgICAgICAgICAgICAgIFN0cmluZyBjaGFuZ2VNZXNzYWdlID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoY2hvaWNlID09IDApIHsgLy8gQ2FzaCBwYXltZW50XG4gICAgICAgICAgICAgICAgICAgIGRvdWJsZSBhbW91bnRQYWlkID0gRG91YmxlLnBhcnNlRG91YmxlKGFtb3VudFBhaWRGaWVsZC5nZXRUZXh0KCkudHJpbSgpLnJlcGxhY2UoXCIsXCIsIFwiXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgZG91YmxlIGNoYW5nZSA9IGFtb3VudFBhaWQgLSB0b3RhbEFtb3VudDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoYW5nZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZU1lc3NhZ2UgPSBcIlxcblRp4buBbiB0aOG7kWkgbOG6oWk6IFwiICsgZm9ybWF0Q3VycmVuY3koY2hhbmdlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFNob3cgc3VjY2VzcyBtZXNzYWdlXG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJUaGFuaCB0b8OhbiB0aMOgbmggY8O0bmchIFbDqSBj4bunYSBi4bqhbiDEkcOjIMSRxrDhu6NjIMSR4bq3dC5cIiArIGNoYW5nZU1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIlRow6BuaCBjw7RuZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICAvLyBDbG9zZSBjaGVja291dCB3aW5kb3dcbiAgICAgICAgICAgICAgICBkaXNwb3NlKCk7XG4uLi5cbiIsImlzX2Vycm9yIjpmYWxzZSwicmVxdWVzdF9pZCI6IiIsInRvb2xfdXNlX2lkIjoidG9vbHVfMDFUWHJWRFJhaDVlcTVOOFJ4THY3dk1UIn19LHsiaWQiOjIsInR5cGUiOjQsImlkZV9zdGF0ZV9ub2RlIjp7IndvcmtzcGFjZUZvbGRlcnMiOlt7InJlcG9zaXRvcnlSb290IjoiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmciLCJmb2xkZXJSb290IjoiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcifV0sIndvcmtzcGFjZUZvbGRlcnNVbmNoYW5nZWQiOmZhbHNlLCJjdXJyZW50VGVybWluYWwiOnsidGVybWluYWxJZCI6MjIsImN1cnJlbnRXb3JraW5nRGlyZWN0b3J5IjoiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcifX19XSwicmVzcG9uc2VfdGV4dCI6IiIsIndvcmtzcGFjZV9maWxlX2NodW5rcyI6W119LHsic3RhdHVzIjoic3VjY2VzcyIsInJlcXVlc3RfaWQiOiJkMzk2MDk0MC03N2M2LTQ1NTQtOTFjMS03NDQ3ZDI3Y2MxNGMiLCJyZXF1ZXN0X21lc3NhZ2UiOiIiLCJzdHJ1Y3R1cmVkX291dHB1dF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjUsImNvbnRlbnQiOiIiLCJ0b29sX3VzZSI6eyJ0b29sX3VzZV9pZCI6InRvb2x1XzAxMzh1MkFhcXhSY2t2OUVWVEVZWEZ4dyIsInRvb2xfbmFtZSI6InN0ci1yZXBsYWNlLWVkaXRvciIsImlucHV0X2pzb24iOiJ7XCJjb21tYW5kXCI6IFwidmlld1wiLCBcInBhdGhcIjogXCJQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9UcmFpblRpY2tldEJvb2tpbmdTeXN0ZW0uamF2YVwiLCBcInZpZXdfcmFuZ2VcIjogWzEsIDUwXX0ifX0seyJpZCI6MCwidHlwZSI6MCwiY29udGVudCI6IkJhc2VkIG9uIHRoZSBpbmZvcm1hdGlvbiBJJ3ZlIGdhdGhlcmVkLCBJJ2xsIG5vdyBjcmVhdGUgYSBwbGFuIHRvIG1vZGlmeSB0aGUgVHJhaW5UaWNrZXRCb29raW5nU3lzdGVtIGFuZCBUaGFuaFRvYW5HVUkgY2xhc3NlcyB0byBtYXRjaCB0aGUgc3RydWN0dXJlIG9mIExpY2hUcmluaFRhdVBhbmVsLCBhbmQgdGhlbiBhZGQgdGhlbSB0byBNYWluR1VJLlxuXG4jIyBQbGFuOlxuXG4xLiAqKk1vZGlmeSBUcmFpblRpY2tldEJvb2tpbmdTeXN0ZW0uamF2YSoqOlxuICAgLSBDb252ZXJ0IGZyb20gSkZyYW1lIHRvIEpQYW5lbFxuICAgLSBJbXBsZW1lbnQgc2ltaWxhciBzdHJ1Y3R1cmUgdG8gTGljaFRyaW5oVGF1UGFuZWwgKHRpdGxlIHBhbmVsLCBjZW50ZXIgcGFuZWwsIGV0Yy4pXG4gICAtIEFkZCBSTUkgY29ubmVjdGlvbiBoYW5kbGluZyBzaW1pbGFyIHRvIExpY2hUcmluaFRhdVBhbmVsXG4gICAtIE1vZGlmeSBjb25zdHJ1Y3RvciB0byBhY2NlcHQgTmhhblZpZW4gcGFyYW1ldGVyXG5cbjIuICoqTW9kaWZ5IFRoYW5oVG9hbkdVSS5qYXZhKio6XG4gICAtIENvbnZlcnQgZnJvbSBKRnJhbWUgdG8gSlBhbmVsXG4gICAtIEltcGxlbWVudCBzaW1pbGFyIHN0cnVjdHVyZSB0byBMaWNoVHJpbmhUYXVQYW5lbFxuICAgLSBBZGQgUk1JIGNvbm5lY3Rpb24gaGFuZGxpbmdcbiAgIC0gTW9kaWZ5IGNvbnN0cnVjdG9yIHRvIGFjY2VwdCBuZWNlc3NhcnkgcGFyYW1ldGVyc1xuXG4zLiAqKlVwZGF0ZSBNYWluR1VJLmphdmEqKjpcbiAgIC0gQWRkIG1lbnUgaXRlbXMgZm9yIHRoZSBuZXcgcGFuZWxzXG4gICAtIEltcGxlbWVudCB0aGUgcGFuZWwgbG9hZGluZyBsb2dpYyBpbiB0aGUgc3dpdGNoVG9QYW5lbCBtZXRob2RcblxuTGV0J3Mgc3RhcnQgaW1wbGVtZW50aW5nIHRoZXNlIGNoYW5nZXM6XG5cbiMjIDEuIEZpcnN0LCBsZXQncyBtb2RpZnkgVHJhaW5UaWNrZXRCb29raW5nU3lzdGVtLmphdmE6XG4ifSx7ImlkIjoyLCJ0eXBlIjoyLCJjb250ZW50IjoiIn0seyJpZCI6MywidHlwZSI6MywiY29udGVudCI6IiJ9XSwic2Vlbl9zdGF0ZSI6InNlZW4iLCJzdHJ1Y3R1cmVkX3JlcXVlc3Rfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjoxLCJ0b29sX3Jlc3VsdF9ub2RlIjp7ImNvbnRlbnQiOiJUaGUgZm9sbG93aW5nIGNvZGUgc2VjdGlvbnMgd2VyZSByZXRyaWV2ZWQ6XG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9NYWluR1VJLmphdmFcbnBhY2thZ2UgZ3VpQ2xpZW50O1xuXG5pbXBvcnQgZGFvLkRvaVZlREFPO1xuaW1wb3J0IGRhby5pbXBsLkRvaVZlREFPSW1wbDtcbmltcG9ydCBkYW8uaW1wbC5OaGFuVmllbkRBT0ltcGw7XG5pbXBvcnQgbW9kZWwuTmhhblZpZW47XG5cbmltcG9ydCBqYXZheC5zd2luZy4qO1xuaW1wb3J0IGphdmEuYXd0Lio7XG5pbXBvcnQgamF2YS5hd3QuZXZlbnQuTW91c2VBZGFwdGVyO1xuaW1wb3J0IGphdmEuYXd0LmV2ZW50Lk1vdXNlRXZlbnQ7XG5pbXBvcnQgamF2YS5hd3QuZXZlbnQuV2luZG93QWRhcHRlcjtcbmltcG9ydCBqYXZhLmF3dC5ldmVudC5XaW5kb3dFdmVudDtcbmltcG9ydCBqYXZhLmF3dC5pbWFnZS5CdWZmZXJlZEltYWdlO1xuaW1wb3J0IGphdmEucm1pLlJlbW90ZUV4Y2VwdGlvbjtcbmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlO1xuaW1wb3J0IGphdmEudXRpbC5IYXNoTWFwO1xuaW1wb3J0IGphdmEudXRpbC5NYXA7XG5cbnB1YmxpYyBjbGFzcyBNYWluR1VJIGV4dGVuZHMgSkZyYW1lIHtcblxuICAgIHByaXZhdGUgSlBhbmVsIGNvbnRlbnRQYW5lbDsgLy8gQ29udGVudCBwYW5lbCBtYW5hZ2VkIGJ5IENhcmRMYXlvdXRcbiAgICBwcml2YXRlIENhcmRMYXlvdXQgY2FyZExheW91dDsgLy8gQ2FyZExheW91dCBmb3Igc3dpdGNoaW5nIHBhbmVsc1xuICAgIHByaXZhdGUgTWFwPFN0cmluZywgSlBhbmVsPiBwYW5lbE1hcDsgLy8gQ2FjaGUgZm9yIHBhbmVsc1xuICAgIHByaXZhdGUgTGljaFRyaW5oVGF1UGFuZWwgbGljaFRyaW5oVGF1UGFuZWw7XG4gICAgcHJpdmF0ZSBOaGFuVmllbiBuaGFuVmllbjtcblxuICAgIHB1YmxpYyBNYWluR1VJKE5oYW5WaWVuIG52KSB7XG4gICAgICAgIG5oYW5WaWVuID0gbnY7XG4gICAgICAgIHNldFRpdGxlKFwiUXXhuqNuIGzDvSB0w6B1IGjhu49hXCIpO1xuICAgICAgICBzZXRTaXplKDEyMDAsIDgwMCk7XG4gICAgICAgIHNldERlZmF1bHRDbG9zZU9wZXJhdGlvbihKRnJhbWUuRVhJVF9PTl9DTE9TRSk7XG4gICAgICAgIHNldExvY2F0aW9uUmVsYXRpdmVUbyhudWxsKTtcblxuICAgICAgICAvLyBJbml0aWFsaXplIHBhbmVsIG1hcFxuICAgICAgICBwYW5lbE1hcCA9IG5ldyBIYXNoTWFwPD4oKTtcblxuICAgICAgICAvLyBDcmVhdGUgdGhlIG1haW4gbGF5b3V0XG4gICAgICAgIEpQYW5lbCBtYWluUGFuZWwgPSBuZXcgSlBhbmVsKG5ldyBCb3JkZXJMYXlvdXQoKSk7XG5cbiAgICAgICAgLy8gQ3JlYXRlIGhlYWRlclxuICAgICAgICBKUGFuZWwgaGVhZGVyUGFuZWwgPSBjcmVhdGVIZWFkZXJQYW5lbCgpO1xuICAgICAgICBtYWluUGFuZWwuYWRkKGhlYWRlclBhbmVsLCBCb3JkZXJMYXlvdXQuTk9SVEgpO1xuXG4gICAgICAgIC8vIENyZWF0ZSB2ZXJ0aWNhbCBtZW51XG4gICAgICAgIEpQYW5lbCB2ZXJ0aWNhbE1lbnUgPSBjcmVhdGVWZXJ0aWNhbE1lbnUoKTtcbiAgICAgICAgbWFpblBhbmVsLmFkZCh2ZXJ0aWNhbE1lbnUsIEJvcmRlckxheW91dC5XRVNUKTtcblxuICAgICAgICAvLyBDcmVhdGUgY29udGVudCBwYW5lbCB3aXRoIENhcmRMYXlvdXRcbiAgICAgICAgY2FyZExheW91dCA9IG5ldyBDYXJkTGF5b3V0KCk7XG4gICAgICAgIGNvbnRlbnRQYW5lbCA9IG5ldyBKUGFuZWwoY2FyZExheW91dCk7XG5cbiAgICAgICAgLy8gQWRkIGRlZmF1bHQgY29udGVudCBwYW5lbFxuICAgICAgICBKUGFuZWwgZGVmYXVsdFBhbmVsID0gY3JlYXRlRGVmYXVsdENvbnRlbnRQYW5lbCgpO1xuICAgICAgICBjb250ZW50UGFuZWwuYWRkKGRlZmF1bHRQYW5lbCwgXCJUcmFuZyBjaOG7p1wiKTtcbiAgICAgICAgcGFuZWxNYXAucHV0KFwiVHJhbmcgY2jhu6dcIiwgZGVmYXVsdFBhbmVsKTtcblxuICAgICAgICBtYWluUGFuZWwuYWRkKGNvbnRlbnRQYW5lbCwgQm9yZGVyTGF5b3V0LkNFTlRFUik7XG5cbiAgICAgICAgYWRkKG1haW5QYW5lbCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBKUGFuZWwgY3JlYXRlSGVhZGVyUGFuZWwoKSB7XG4gICAgICAgIEpQYW5lbCBoZWFkZXJQYW5lbCA9IG5ldyBKUGFuZWwobmV3IEJvcmRlckxheW91dCgpKTtcbiAgICAgICAgaGVhZGVyUGFuZWwuc2V0QmFja2dyb3VuZChuZXcgQ29sb3IoNDEsIDEyOCwgMTg1KSk7IC8vIEJsdWUgaGVhZGVyIGJhY2tncm91bmRcbiAgICAgICAgaGVhZGVyUGFuZWwuc2V0UHJlZmVycmVkU2l6ZShuZXcgRGltZW5zaW9uKDAsIDYwKSk7XG5cbiAgICAgICAgSkxhYmVsIHRpdGxlTGFiZWwgPSBuZXcgSkxhYmVsKFwiSOG7hyB0aOG7kW5nIHF14bqjbiBsw70gdMOgdSBo4buPYVwiLCBKTGFiZWwuQ0VOVEVSKTtcbiAgICAgICAgdGl0bGVMYWJlbC5zZXRGb250KG5ldyBGb250KFwiQXJpYWxcIiwgRm9udC5CT0xELCAyNCkpO1xuICAgICAgICB0aXRsZUxhYmVsLnNldEZvcmVncm91bmQoQ29sb3IuV0hJVEUpO1xuXG4gICAgICAgIGhlYWRlclBhbmVsLmFkZCh0aXRsZUxhYmVsLCBCb3JkZXJMYXlvdXQuQ0VOVEVSKTtcbiAgICAgICAgcmV0dXJuIGhlYWRlclBhbmVsO1xuICAgIH1cblxuICAgIEBPdmVycmlkZVxuICAgIHB1YmxpYyB2b2lkIGRpc3Bvc2UoKSB7XG4gICAgICAgIC8vIEdp4bqjaSBwaMOzbmcgY8OhYyB0w6BpIG5ndXnDqm5cbiAgICAgICAgaWYgKGxpY2hUcmluaFRhdVBhbmVsICE9IG51bGwpIHtcbiAgICAgICAgICAgIGxpY2hUcmluaFRhdVBhbmVsLnNodXRkb3duKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBH4buNaSBwaMawxqFuZyB0aOG7qWMgZGlzcG9zZSBj4bunYSBs4bubcCBjaGFcbiAgICAgICAgc3VwZXIuZGlzcG9zZSgpO1xuICAgIH1cblxuICAgIHByaXZhdGUgdm9pZCBzZXR1cFdpbmRvd0xpc3RlbmVycygpIHtcbiAgICAgICAgYWRkV2luZG93TGlzdGVuZXIobmV3IFdpbmRvd0FkYXB0ZXIoKSB7XG4gICAgICAgICAgICBAT3ZlcnJpZGVcbiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHdpbmRvd0Nsb3NpbmcoV2luZG93RXZlbnQgZSkge1xuICAgICAgICAgICAgICAgIC8vIEdp4bqjaSBwaMOzbmcgdMOgaSBuZ3V5w6puIHRyxrDhu5tjIGtoaSDEkcOzbmdcbiAgICAgICAgICAgICAgICBpZiAobGljaFRyaW5oVGF1UGFuZWwgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBsaWNoVHJpbmhUYXVQYW5lbC5zaHV0ZG93bigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBkaXNwb3NlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgSlBhbmVsIGNyZWF0ZVZlcnRpY2FsTWVudSgpIHtcbiAgICAgICAgSlBhbmVsIG1lbnVQYW5lbCA9IG5ldyBKUGFuZWwoKTtcbiAgICAgICAgbWVudVBhbmVsLnNldExheW91dChuZXcgQm94TGF5b3V0KG1lbnVQYW5lbCwgQm94TGF5b3V0LllfQVhJUykpO1xuICAgICAgICBtZW51UGFuZWwuc2V0QmFja2dyb3VuZChuZXcgQ29sb3IoNTIsIDczLCA5NCkpOyAvLyBEYXJrIGdyYXkgbWVudSBiYWNrZ3JvdW5kXG4gICAgICAgIG1lbnVQYW5lbC5zZXRQcmVmZXJyZWRTaXplKG5ldyBEaW1lbnNpb24oMjUwLCAwKSk7XG5cbiAgICAgICAgU3RyaW5nW10gbWVudUl0ZW1zID0ge1xuICAgICAgICAgICAgICAgIFwiVHJhbmcgY2jhu6dcIiwgXCJUaMO0bmcgdGluIGhv4bqhdCDEkeG7mW5nXCIsIFwiUXXhuqNuIGzDvSBraMOhY2ggaMOgbmdcIixcbiAgICAgICAgICAgICAgICBcIlF14bqjbiBsw70gdsOpXCIsIFwiUXXhuqNuIGzDvSBs4buLY2ggdHLDrG5oXCIsIFwiQsOhbyBjw6FvXCIsIFwiVHJhIGPhu6l1IHbDqVwiLCBcIsSQ4buVaSB2w6lcIiwgXCJUcuG6oyB2w6lcIiwgXCJRdeG6o24gbMO9IG5ow6JuIHZpw6puXCIsXG4gICAgICAgICAgICAgICAgXCJUaOG7kW5nIGvDqiBz4buRIGzGsOG7o25nIHbDqSB0aGVvIHRo4budaSBnaWFuXCIsIFwiUXXhuqNuIGzDvSBraHV54bq/biBtw6NpXCJcbiAgICAgICAgfTtcblxuICAgICAgICBmb3IgKFN0cmluZyBpdGVtIDogbWVudUl0ZW1zKSB7XG4gICAgICAgICAgICBKUGFuZWwgbWVudUl0ZW1QYW5lbCA9IG5ldyBKUGFuZWwobmV3IEJvcmRlckxheW91dCgpKTtcbiAgICAgICAgICAgIG1lbnVJdGVtUGFuZWwuc2V0QmFja2dyb3VuZChuZXcgQ29sb3IoNTIsIDczLCA5NCkpO1xuICAgICAgICAgICAgbWVudUl0ZW1QYW5lbC5zZXRNYXhpbXVtU2l6ZShuZXcgRGltZW5zaW9uKDI1MCwgNTApKTtcblxuICAgICAgICAgICAgSkxhYmVsIG1lbnVMYWJlbCA9IG5ldyBKTGFiZWwoaXRlbSk7XG4gICAgICAgICAgICBtZW51TGFiZWwuc2V0Rm9yZWdyb3VuZChDb2xvci5XSElURSk7XG4gICAgICAgICAgICBtZW51TGFiZWwuc2V0Rm9udChuZXcgRm9udChcIkFyaWFsXCIsIEZvbnQuUExBSU4sIDE2KSk7XG4gICAgICAgICAgICBtZW51TGFiZWwuc2V0Qm9yZGVyKEJvcmRlckZhY3RvcnkuY3JlYXRlRW1wdHlCb3JkZXIoMTAsIDIwLCAxMCwgMTApKTtcblxuICAgICAgICAgICAgbWVudUl0ZW1QYW5lbC5hZGQobWVudUxhYmVsLCBCb3JkZXJMYXlvdXQuQ0VOVEVSKTtcblxuICAgICAgICAgICAgLy8gSG92ZXIgZWZmZWN0XG4gICAgICAgICAgICBtZW51SXRlbVBhbmVsLmFkZE1vdXNlTGlzdGVuZXIobmV3IE1vdXNlQWRhcHRlcigpIHtcbiAgICAgICAgICAgICAgICBAT3ZlcnJpZGVcbiAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBtb3VzZUVudGVyZWQoTW91c2VFdmVudCBlKSB7XG4gICAgICAgICAgICAgICAgICAgIG1lbnVJdGVtUGFuZWwuc2V0QmFja2dyb3VuZChuZXcgQ29sb3IoNDEsIDEyOCwgMTg1KSk7IC8vIEJsdWUgaG92ZXIgYmFja2dyb3VuZFxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIEBPdmVycmlkZVxuICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIG1vdXNlRXhpdGVkKE1vdXNlRXZlbnQgZSkge1xuICAgICAgICAgICAgICAgICAgICBtZW51SXRlbVBhbmVsLnNldEJhY2tncm91bmQobmV3IENvbG9yKDUyLCA3MywgOTQpKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBAT3ZlcnJpZGVcbiAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBtb3VzZUNsaWNrZWQoTW91c2VFdmVudCBlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFN3aXRjaCBjb250ZW50IGJhc2VkIG9uIHRoZSBtZW51IGl0ZW0gY2xpY2tlZFxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2hUb1BhbmVsKGl0ZW0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBtZW51UGFuZWwuYWRkKG1lbnVJdGVtUGFuZWwpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG1lbnVQYW5lbDtcbiAgICB9XG5cbiAgICBwcml2YXRlIEpQYW5lbCBjcmVhdGVEZWZhdWx0Q29udGVudFBhbmVsKCkge1xuICAgICAgICBKUGFuZWwgcGFuZWwgPSBuZXcgSlBhbmVsKG5ldyBCb3JkZXJMYXlvdXQoKSk7XG4gICAgICAgIHBhbmVsLnNldEJhY2tncm91bmQoQ29sb3IuV0hJVEUpO1xuXG4gICAgICAgIEpMYWJlbCBjb250ZW50TGFiZWwgPSBuZXcgSkxhYmVsKFwiQ2jDoG8gbeG7q25nIMSR4bq/biBo4buHIHRo4buRbmcgcXXhuqNuIGzDvSB0w6B1IGjhu49hIVwiLCBKTGFiZWwuQ0VOVEVSKTtcbiAgICAgICAgY29udGVudExhYmVsLnNldEZvbnQobmV3IEZvbnQoXCJBcmlhbFwiLCBGb250LklUQUxJQywgMTgpKTtcbiAgICAgICAgY29udGVudExhYmVsLnNldEZvcmVncm91bmQoQ29sb3IuR1JBWSk7XG5cbiAgICAgICAgcGFuZWwuYWRkKGNvbnRlbnRMYWJlbCwgQm9yZGVyTGF5b3V0LkNFTlRFUik7XG4gICAgICAgIHJldHVybiBwYW5lbDtcbiAgICB9XG5cbiAgICBwcml2YXRlIEpQYW5lbCBjcmVhdGVQbGFjZWhvbGRlclBhbmVsKFN0cmluZyBtZW51TmFtZSkge1xuICAgICAgICBKUGFuZWwgcGFuZWwgPSBuZXcgSlBhbmVsKG5ldyBCb3JkZXJMYXlvdXQoKSk7XG4gICAgICAgIHBhbmVsLnNldEJhY2tncm91bmQoQ29sb3IuV0hJVEUpO1xuXG4gICAgICAgIEpMYWJlbCBwbGFjZWhvbGRlckxhYmVsID0gbmV3IEpMYWJlbChcIk7hu5lpIGR1bmcgY2hvIFwiICsgbWVudU5hbWUgKyBcIiDEkWFuZyDEkcaw4bujYyBwaMOhdCB0cmnhu4NuLlwiLCBKTGFiZWwuQ0VOVEVSKTtcbiAgICAgICAgcGxhY2Vob2xkZXJMYWJlbC5zZXRGb250KG5ldyBGb250KFwiQXJpYWxcIiwgRm9udC5JVEFMSUMsIDE4KSk7XG4gICAgICAgIHBsYWNlaG9sZGVyTGFiZWwuc2V0Rm9yZWdyb3VuZChDb2xvci5HUkFZKTtcblxuICAgICAgICBwYW5lbC5hZGQocGxhY2Vob2xkZXJMYWJlbCwgQm9yZGVyTGF5b3V0LkNFTlRFUik7XG4gICAgICAgIHJldHVybiBwYW5lbDtcbiAgICB9XG5cbiAgICBwcml2YXRlIHZvaWQgc3dpdGNoVG9QYW5lbChTdHJpbmcgcGFuZWxOYW1lKSB7XG4gICAgICAgIC8vIENoZWNrIGlmIHRoZSBwYW5lbCBhbHJlYWR5IGV4aXN0cyBpbiB0aGUgY2FjaGVcbiAgICAgICAgaWYgKCFwYW5lbE1hcC5jb250YWluc0tleShwYW5lbE5hbWUpKSB7XG4gICAgICAgICAgICBKUGFuZWwgbmV3UGFuZWw7XG5cbiAgICAgICAgICAgIGlmIChwYW5lbE5hbWUuZXF1YWxzKFwiUXXhuqNuIGzDvSBraMOhY2ggaMOgbmdcIikpIHtcbiAgICAgICAgICAgICAgICAvLyBEaXNwbGF5IGxvYWRpbmcgaW50ZXJmYWNlXG4gICAgICAgICAgICAgICAgSlBhbmVsIGxvYWRpbmdQYW5lbCA9IGNyZWF0ZUxvYWRpbmdQYW5lbChcIsSQYW5nIHThuqNpIGThu68gbGnhu4d1IGtow6FjaCBow6BuZy4uLlwiKTtcbiAgICAgICAgICAgICAgICBjb250ZW50UGFuZWwuYWRkKGxvYWRpbmdQYW5lbCwgXCJMb2FkaW5nX1wiICsgcGFuZWxOYW1lKTtcbiAgICAgICAgICAgICAgICBjYXJkTGF5b3V0LnNob3coY29udGVudFBhbmVsLCBcIkxvYWRpbmdfXCIgKyBwYW5lbE5hbWUpO1xuXG4gICAgICAgICAgICAgICAgLy8gQ3JlYXRlIGN1c3RvbWVyIG1hbmFnZW1lbnQgcGFuZWwgaW4gYSBzZXBhcmF0ZSB0aHJlYWRcbiAgICAgICAgICAgICAgICBTd2luZ1dvcmtlcjxRdWFuTHlLaGFjaEhhbmdQYW5lbCwgVm9pZD4gd29ya2VyID0gbmV3IFN3aW5nV29ya2VyPD4oKSB7XG4gICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZVxuICAgICAgICAgICAgICAgICAgICBwcm90ZWN0ZWQgUXVhbkx5S2hhY2hIYW5nUGFuZWwgZG9JbkJhY2tncm91bmQoKSB0aHJvd3MgRXhjZXB0aW9uIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUXVhbkx5S2hhY2hIYW5nUGFuZWwoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZVxuICAgICAgICAgICAgICAgICAgICBwcm90ZWN0ZWQgdm9pZCBkb25lKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBHZXQgdGhlIHBhbmVsIGFmdGVyIGl0J3MgY3JlYXRlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFF1YW5MeUtoYWNoSGFuZ1BhbmVsIHBhbmVsID0gZ2V0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBZGQgdG8gY2FjaGUgYW5kIGRpc3BsYXlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50UGFuZWwuYWRkKHBhbmVsLCBwYW5lbE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhbmVsTWFwLnB1dChwYW5lbE5hbWUsIHBhbmVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkTGF5b3V0LnNob3coY29udGVudFBhbmVsLCBwYW5lbE5hbWUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIGxvYWRpbmcgcGFuZWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50UGFuZWwucmVtb3ZlKGxvYWRpbmdQYW5lbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coTWFpbkdVSS50aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJLaMO0bmcgdGjhu4MgdOG6o2kgZOG7ryBsaeG7h3Uga2jDoWNoIGjDoG5nOiBcIiArIGUuZ2V0TWVzc2FnZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaSBr4bq/dCBu4buRaVwiLCBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkTGF5b3V0LnNob3coY29udGVudFBhbmVsLCBcIlRyYW5nIGNo4bunXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHdvcmtlci5leGVjdXRlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuOyAvLyBFeGl0IGVhcmx5LCBkb24ndCBleGVjdXRlIHRoZSByZXN0IG9mIHRoZSBtZXRob2RcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocGFuZWxOYW1lLmVxdWFscyhcIlF14bqjbiBsw70gbOG7i2NoIHRyw6xuaFwiKSkge1xuICAgICAgICAgICAgICAgIC8vIEhp4buDbiB0aOG7iyBnaWFvIGRp4buHbiB04bqjaSBk4buvIGxp4buHdVxuICAgICAgICAgICAgICAgIEpQYW5lbCBsb2FkaW5nUGFuZWwgPSBjcmVhdGVMb2FkaW5nUGFuZWwoXCLEkGFuZyB04bqjaSBk4buvIGxp4buHdSBs4buLY2ggdHLDrG5oLi4uXCIpO1xuICAgICAgICAgICAgICAgIGNvbnRlbnRQYW5lbC5hZGQobG9hZGluZ1BhbmVsLCBcIkxvYWRpbmdfXCIgKyBwYW5lbE5hbWUpO1xuICAgICAgICAgICAgICAgIGNhcmRMYXlvdXQuc2hvdyhjb250ZW50UGFuZWwsIFwiTG9hZGluZ19cIiArIHBhbmVsTmFtZSk7XG5cbiAgICAgICAgICAgICAgICAvLyBU4bqhbyBwYW5lbCBxdeG6o24gbMO9IGzhu4tjaCB0csOsbmggdHJvbmcgbHXhu5NuZyByacOqbmdcbiAgICAgICAgICAgICAgICBTd2luZ1dvcmtlcjxMaWNoVHJpbmhUYXVQYW5lbCwgVm9pZD4gd29ya2VyID0gbmV3IFN3aW5nV29ya2VyPD4oKSB7XG4gICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZVxuICAgICAgICAgICAgICAgICAgICBwcm90ZWN0ZWQgTGljaFRyaW5oVGF1UGFuZWwgZG9JbkJhY2tncm91bmQoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IExpY2hUcmluaFRhdVBhbmVsKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGVcbiAgICAgICAgICAgICAgICAgICAgcHJvdGVjdGVkIHZvaWQgZG9uZSgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTOG6pXkgcGFuZWwgc2F1IGtoaSDEkcOjIHThuqFvIHhvbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBMaWNoVHJpbmhUYXVQYW5lbCBwYW5lbCA9IGdldCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpY2hUcmluaFRhdVBhbmVsID0gcGFuZWw7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaMOqbSB2w6BvIGNhY2hlIHbDoCBoaeG7g24gdGjhu4tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50UGFuZWwuYWRkKHBhbmVsLCBwYW5lbE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhbmVsTWFwLnB1dChwYW5lbE5hbWUsIHBhbmVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkTGF5b3V0LnNob3coY29udGVudFBhbmVsLCBwYW5lbE5hbWUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gWMOzYSBwYW5lbCBsb2FkaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFBhbmVsLnJlbW92ZShsb2FkaW5nUGFuZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKE1haW5HVUkudGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiS2jDtG5nIHRo4buDIHThuqNpIGThu68gbGnhu4d1OiBcIiArIGUuZ2V0TWVzc2FnZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaSBr4bq/dCBu4buRaVwiLCBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkTGF5b3V0LnNob3coY29udGVudFBhbmVsLCBcIlRyYW5nIGNo4bunXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4uLi5cblxuICAgICAgICAgICAgICAgIC8vIFThuqFvIHBhbmVsIHF14bqjbiBsw70gdsOpIHRyb25nIGx14buTbmcgcmnDqm5nXG4gICAgICAgICAgICAgICAgU3dpbmdXb3JrZXI8RG9pVmVQYW5lbCwgVm9pZD4gd29ya2VyID0gbmV3IFN3aW5nV29ya2VyPD4oKSB7XG4gICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZVxuICAgICAgICAgICAgICAgICAgICBwcm90ZWN0ZWQgRG9pVmVQYW5lbCBkb0luQmFja2dyb3VuZCgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRG9pVmVQYW5lbChuaGFuVmllbik7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGVcbiAgICAgICAgICAgICAgICAgICAgcHJvdGVjdGVkIHZvaWQgZG9uZSgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTOG6pXkgcGFuZWwgc2F1IGtoaSDEkcOjIHThuqFvIHhvbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBEb2lWZVBhbmVsIHBhbmVsID0gZ2V0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaMOqbSB2w6BvIGNhY2hlIHbDoCBoaeG7g24gdGjhu4tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50UGFuZWwuYWRkKHBhbmVsLCBwYW5lbE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhbmVsTWFwLnB1dChwYW5lbE5hbWUsIHBhbmVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkTGF5b3V0LnNob3coY29udGVudFBhbmVsLCBwYW5lbE5hbWUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gWMOzYSBwYW5lbCBsb2FkaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFBhbmVsLnJlbW92ZShsb2FkaW5nUGFuZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKE1haW5HVUkudGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiS2jDtG5nIHRo4buDIHThuqNpIGThu68gbGnhu4d1OiBcIiArIGUuZ2V0TWVzc2FnZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaSBr4bq/dCBu4buRaVwiLCBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkTGF5b3V0LnNob3coY29udGVudFBhbmVsLCBcIlRyYW5nIGNo4bunXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbi4uLlxuXG4gICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZVxuICAgICAgICAgICAgICAgICAgICBwcm90ZWN0ZWQgdm9pZCBkb25lKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBM4bqleSBwYW5lbCBzYXUga2hpIMSRw6MgdOG6oW8geG9uZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRyYVZlUGFuZWwgcGFuZWwgPSBnZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaMOqbSB2w6BvIGNhY2hlIHbDoCBoaeG7g24gdGjhu4tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50UGFuZWwuYWRkKHBhbmVsLCBwYW5lbE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhbmVsTWFwLnB1dChwYW5lbE5hbWUsIHBhbmVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkTGF5b3V0LnNob3coY29udGVudFBhbmVsLCBwYW5lbE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFjDs2EgcGFuZWwgbG9hZGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRQYW5lbC5yZW1vdmUobG9hZGluZ1BhbmVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhNYWluR1VJLnRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIktow7RuZyB0aOG7gyB04bqjaSBk4buvIGxp4buHdSB0cuG6oyB2w6k6IFwiICsgZS5nZXRNZXNzYWdlKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpIGvhur90IG7hu5FpXCIsIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRMYXlvdXQuc2hvdyhjb250ZW50UGFuZWwsIFwiVHJhbmcgY2jhu6dcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHdvcmtlci5leGVjdXRlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuOyAvLyBUaG/DoXQgc+G7m21cbiAgICAgICAgICAgIH0gZWxzZSBpZiAocGFuZWxOYW1lLmVxdWFscyhcIlF14bqjbiBsw70gbmjDom4gdmnDqm5cIikpIHtcbiAgICAgICAgICAgICAgICAvLyBIaeG7g24gdGjhu4sgZ2lhbyBkaeG7h24gdOG6o2kgZOG7ryBsaeG7h3VcbiAgICAgICAgICAgICAgICBKUGFuZWwgbG9hZGluZ1BhbmVsID0gY3JlYXRlTG9hZGluZ1BhbmVsKFwixJBhbmcgdOG6o2kgZOG7ryBsaeG7h3UgbmjDom4gdmnDqm4uLi5cIik7XG4gICAgICAgICAgICAgICAgY29udGVudFBhbmVsLmFkZChsb2FkaW5nUGFuZWwsIFwiTG9hZGluZ19cIiArIHBhbmVsTmFtZSk7XG4gICAgICAgICAgICAgICAgY2FyZExheW91dC5zaG93KGNvbnRlbnRQYW5lbCwgXCJMb2FkaW5nX1wiICsgcGFuZWxOYW1lKTtcblxuICAgICAgICAgICAgICAgIC8vIFThuqFvIHBhbmVsIHRy4bqjIHbDqSB0cm9uZyBsdeG7k25nIHJpw6puZ1xuICAgICAgICAgICAgICAgIFN3aW5nV29ya2VyPFF1YW5MeU5oYW5WaWVuUGFuZWwsIFZvaWQ+IHdvcmtlciA9IG5ldyBTd2luZ1dvcmtlcjw+KCkge1xuICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGVcbiAgICAgICAgICAgICAgICAgICAgcHJvdGVjdGVkIFF1YW5MeU5oYW5WaWVuUGFuZWwgZG9JbkJhY2tncm91bmQoKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUXVhbkx5TmhhblZpZW5QYW5lbCgpOyAvLyBUcmFWZVBhbmVsIHPhur0gdOG7sSBr4bq/dCBu4buRaSBSTUlcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZVxuICAgICAgICAgICAgICAgICAgICBwcm90ZWN0ZWQgdm9pZCBkb25lKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBM4bqleSBwYW5lbCBzYXUga2hpIMSRw6MgdOG6oW8geG9uZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFF1YW5MeU5oYW5WaWVuUGFuZWwgcGFuZWwgPSBnZXQoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRow6ptIHbDoG8gY2FjaGUgdsOgIGhp4buDbiB0aOG7i1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRQYW5lbC5hZGQocGFuZWwsIHBhbmVsTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFuZWxNYXAucHV0KHBhbmVsTmFtZSwgcGFuZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRMYXlvdXQuc2hvdyhjb250ZW50UGFuZWwsIHBhbmVsTmFtZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBYw7NhIHBhbmVsIGxvYWRpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50UGFuZWwucmVtb3ZlKGxvYWRpbmdQYW5lbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coTWFpbkdVSS50aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJLaMO0bmcgdGjhu4MgdOG6o2kgZOG7ryBsaeG7h3UgbmjDom4gdmnDqm46IFwiICsgZS5nZXRNZXNzYWdlKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpIGvhur90IG7hu5FpXCIsIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRMYXlvdXQuc2hvdyhjb250ZW50UGFuZWwsIFwiVHJhbmcgY2jhu6dcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuLi4uXG5cbiAgICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlXG4gICAgICAgICAgICAgICAgICAgIHByb3RlY3RlZCB2b2lkIGRvbmUoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEzhuqV5IHBhbmVsIHNhdSBraGkgxJHDoyB04bqhbyB4b25nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgS2h1eWVuTWFpUGFuZWwgcGFuZWwgPSBnZXQoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRow6ptIHbDoG8gY2FjaGUgdsOgIGhp4buDbiB0aOG7i1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRQYW5lbC5hZGQocGFuZWwsIHBhbmVsTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFuZWxNYXAucHV0KHBhbmVsTmFtZSwgcGFuZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRMYXlvdXQuc2hvdyhjb250ZW50UGFuZWwsIHBhbmVsTmFtZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBYw7NhIHBhbmVsIGxvYWRpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50UGFuZWwucmVtb3ZlKGxvYWRpbmdQYW5lbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coTWFpbkdVSS50aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJLaMO0bmcgdGjhu4MgdOG6o2kgZOG7ryBsaeG7h3Uga2h1eeG6v24gbcOjaTogXCIgKyBlLmdldE1lc3NhZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2kga+G6v3QgbuG7kWlcIiwgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyZExheW91dC5zaG93KGNvbnRlbnRQYW5lbCwgXCJUcmFuZyBjaOG7p1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4uLi5cblxuICAgICAgICAgICAgICAgIC8vIFThuqFvIHBhbmVsIHF14bqjbiBsw70gdsOpIHRyb25nIGx14buTbmcgcmnDqm5nXG4gICAgICAgICAgICAgICAgU3dpbmdXb3JrZXI8VHJhQ3V1VmVQYW5lbCwgVm9pZD4gd29ya2VyID0gbmV3IFN3aW5nV29ya2VyPD4oKSB7XG4gICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZVxuICAgICAgICAgICAgICAgICAgICBwcm90ZWN0ZWQgVHJhQ3V1VmVQYW5lbCBkb0luQmFja2dyb3VuZCgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVHJhQ3V1VmVQYW5lbCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlXG4gICAgICAgICAgICAgICAgICAgIHByb3RlY3RlZCB2b2lkIGRvbmUoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEzhuqV5IHBhbmVsIHNhdSBraGkgxJHDoyB04bqhbyB4b25nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVHJhQ3V1VmVQYW5lbCBwYW5lbCA9IGdldCgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGjDqm0gdsOgbyBjYWNoZSB2w6AgaGnhu4NuIHRo4buLXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFBhbmVsLmFkZChwYW5lbCwgcGFuZWxOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYW5lbE1hcC5wdXQocGFuZWxOYW1lLCBwYW5lbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyZExheW91dC5zaG93KGNvbnRlbnRQYW5lbCwgcGFuZWxOYW1lKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFjDs2EgcGFuZWwgbG9hZGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRQYW5lbC5yZW1vdmUobG9hZGluZ1BhbmVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhNYWluR1VJLnRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIktow7RuZyB0aOG7gyB04bqjaSBk4buvIGxp4buHdTogXCIgKyBlLmdldE1lc3NhZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2kga+G6v3QgbuG7kWlcIiwgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyZExheW91dC5zaG93KGNvbnRlbnRQYW5lbCwgXCJUcmFuZyBjaOG7p1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4uLi5cblxuICAgICAgICAgICAgICAgIC8vIFThuqFvIHBhbmVsIHF14bqjbiBsw70gdsOpIHRyb25nIGx14buTbmcgcmnDqm5nXG4gICAgICAgICAgICAgICAgU3dpbmdXb3JrZXI8VGhvbmdLZVZlUGFuZWwsIFZvaWQ+IHdvcmtlciA9IG5ldyBTd2luZ1dvcmtlcjw+KCkge1xuICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGVcbiAgICAgICAgICAgICAgICAgICAgcHJvdGVjdGVkIFRob25nS2VWZVBhbmVsIGRvSW5CYWNrZ3JvdW5kKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBUaG9uZ0tlVmVQYW5lbCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlXG4gICAgICAgICAgICAgICAgICAgIHByb3RlY3RlZCB2b2lkIGRvbmUoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEzhuqV5IHBhbmVsIHNhdSBraGkgxJHDoyB04bqhbyB4b25nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVGhvbmdLZVZlUGFuZWwgcGFuZWwgPSBnZXQoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRow6ptIHbDoG8gY2FjaGUgdsOgIGhp4buDbiB0aOG7i1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRQYW5lbC5hZGQocGFuZWwsIHBhbmVsTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFuZWxNYXAucHV0KHBhbmVsTmFtZSwgcGFuZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRMYXlvdXQuc2hvdyhjb250ZW50UGFuZWwsIHBhbmVsTmFtZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBYw7NhIHBhbmVsIGxvYWRpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50UGFuZWwucmVtb3ZlKGxvYWRpbmdQYW5lbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coTWFpbkdVSS50aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJLaMO0bmcgdGjhu4MgdOG6o2kgZOG7ryBsaeG7h3U6IFwiICsgZS5nZXRNZXNzYWdlKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpIGvhur90IG7hu5FpXCIsIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRMYXlvdXQuc2hvdyhjb250ZW50UGFuZWwsIFwiVHJhbmcgY2jhu6dcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyLmV4ZWN1dGUoKTtcbiAgICAgICAgICAgICAgICByZXR1cm47IC8vIFRob8OhdCBz4bubbVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cblxuICAgICAgICAvLyBTd2l0Y2ggdG8gdGhlIHBhbmVsXG4gICAgICAgIGNhcmRMYXlvdXQuc2hvdyhjb250ZW50UGFuZWwsIHBhbmVsTmFtZSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBKUGFuZWwgY3JlYXRlTG9hZGluZ1BhbmVsKFN0cmluZyBtZXNzYWdlKSB7XG4gICAgICAgIEpQYW5lbCBsb2FkaW5nUGFuZWwgPSBuZXcgSlBhbmVsKG5ldyBCb3JkZXJMYXlvdXQoKSk7XG4gICAgICAgIGxvYWRpbmdQYW5lbC5zZXRCYWNrZ3JvdW5kKENvbG9yLldISVRFKTtcblxuICAgICAgICBKTGFiZWwgbG9hZGluZ0xhYmVsID0gbmV3IEpMYWJlbChtZXNzYWdlLCBKTGFiZWwuQ0VOVEVSKTtcbiAgICAgICAgbG9hZGluZ0xhYmVsLnNldEZvbnQobmV3IEZvbnQoXCJBcmlhbFwiLCBGb250LklUQUxJQywgMTgpKTtcbiAgICAgICAgbG9hZGluZ0xhYmVsLnNldEZvcmVncm91bmQoQ29sb3IuR1JBWSk7XG5cbiAgICAgICAgbG9hZGluZ1BhbmVsLmFkZChsb2FkaW5nTGFiZWwsIEJvcmRlckxheW91dC5DRU5URVIpO1xuICAgICAgICByZXR1cm4gbG9hZGluZ1BhbmVsO1xuICAgIH1cblxuICAgIC8vIFBoxrDGoW5nIHRo4bupYyB04bqhbyBzcGlubmVyIChob+G6t2MgYuG6oW4gY8OzIHRo4buDIHPhu60gZOG7pW5nIG3hu5l0IOG6o25oIEdJRiBzcGlubmVyIGPDsyBz4bq1bilcbiAgICBwcml2YXRlIEltYWdlIGNyZWF0ZUxvYWRpbmdTcGlubmVyR2lmKCkge1xuICAgICAgICAvLyBC4bqhbiBjw7MgdGjhu4MgdGhheSB0aOG6vyBjw6FpIG7DoHkgYuG6sW5nIG3hu5l0IOG6o25oIEdJRiBzcGlubmVyIHRo4buxYyB04bq/XG4gICAgICAgIC8vIMSQw6J5IGNo4buJIGzDoCBt4buZdCBwbGFjZWhvbGRlciDEkcahbiBnaeG6o25cbiAgICAgICAgQnVmZmVyZWRJbWFnZSBpbWFnZSA9IG5ldyBCdWZmZXJlZEltYWdlKDUwLCA1MCwgQnVmZmVyZWRJbWFnZS5UWVBFX0lOVF9BUkdCKTtcbiAgICAgICAgR3JhcGhpY3MyRCBnMiA9IGltYWdlLmNyZWF0ZUdyYXBoaWNzKCk7XG4gICAgICAgIGcyLnNldENvbG9yKG5ldyBDb2xvcig0MSwgMTI4LCAxODUpKTtcbiAgICAgICAgZzIuZmlsbE92YWwoMCwgMCwgNTAsIDUwKTtcbiAgICAgICAgZzIuZGlzcG9zZSgpO1xuICAgICAgICByZXR1cm4gaW1hZ2U7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyB2b2lkIG1haW4oU3RyaW5nW10gYXJncykge1xuICAgICAgICBTd2luZ1V0aWxpdGllcy5pbnZva2VMYXRlcigoKSAtPiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIFVJTWFuYWdlci5zZXRMb29rQW5kRmVlbChVSU1hbmFnZXIuZ2V0U3lzdGVtTG9va0FuZEZlZWxDbGFzc05hbWUoKSk7XG4gICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG5ldyBNYWluR1VJKG5ldyBOaGFuVmllbigpKS5zZXRWaXNpYmxlKHRydWUpO1xuICAgICAgICB9KTtcbiAgICB9XG59XG4uLi5cbiIsImlzX2Vycm9yIjpmYWxzZSwicmVxdWVzdF9pZCI6IiIsInRvb2xfdXNlX2lkIjoidG9vbHVfMDE5UTFjZlJDVnNoa3NpZFExY25uZDdFIn19LHsiaWQiOjIsInR5cGUiOjQsImlkZV9zdGF0ZV9ub2RlIjp7IndvcmtzcGFjZUZvbGRlcnMiOlt7InJlcG9zaXRvcnlSb290IjoiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmciLCJmb2xkZXJSb290IjoiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcifV0sIndvcmtzcGFjZUZvbGRlcnNVbmNoYW5nZWQiOmZhbHNlLCJjdXJyZW50VGVybWluYWwiOnsidGVybWluYWxJZCI6MjIsImN1cnJlbnRXb3JraW5nRGlyZWN0b3J5IjoiRTovTFRQVEpBVkEvTmhvbS9QaGFuVGFuSmF2YU5ob21HUFQvUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcifX19XSwicmVzcG9uc2VfdGV4dCI6IkJhc2VkIG9uIHRoZSBpbmZvcm1hdGlvbiBJJ3ZlIGdhdGhlcmVkLCBJJ2xsIG5vdyBjcmVhdGUgYSBwbGFuIHRvIG1vZGlmeSB0aGUgVHJhaW5UaWNrZXRCb29raW5nU3lzdGVtIGFuZCBUaGFuaFRvYW5HVUkgY2xhc3NlcyB0byBtYXRjaCB0aGUgc3RydWN0dXJlIG9mIExpY2hUcmluaFRhdVBhbmVsLCBhbmQgdGhlbiBhZGQgdGhlbSB0byBNYWluR1VJLlxuXG4jIyBQbGFuOlxuXG4xLiAqKk1vZGlmeSBUcmFpblRpY2tldEJvb2tpbmdTeXN0ZW0uamF2YSoqOlxuICAgLSBDb252ZXJ0IGZyb20gSkZyYW1lIHRvIEpQYW5lbFxuICAgLSBJbXBsZW1lbnQgc2ltaWxhciBzdHJ1Y3R1cmUgdG8gTGljaFRyaW5oVGF1UGFuZWwgKHRpdGxlIHBhbmVsLCBjZW50ZXIgcGFuZWwsIGV0Yy4pXG4gICAtIEFkZCBSTUkgY29ubmVjdGlvbiBoYW5kbGluZyBzaW1pbGFyIHRvIExpY2hUcmluaFRhdVBhbmVsXG4gICAtIE1vZGlmeSBjb25zdHJ1Y3RvciB0byBhY2NlcHQgTmhhblZpZW4gcGFyYW1ldGVyXG5cbjIuICoqTW9kaWZ5IFRoYW5oVG9hbkdVSS5qYXZhKio6XG4gICAtIENvbnZlcnQgZnJvbSBKRnJhbWUgdG8gSlBhbmVsXG4gICAtIEltcGxlbWVudCBzaW1pbGFyIHN0cnVjdHVyZSB0byBMaWNoVHJpbmhUYXVQYW5lbFxuICAgLSBBZGQgUk1JIGNvbm5lY3Rpb24gaGFuZGxpbmdcbiAgIC0gTW9kaWZ5IGNvbnN0cnVjdG9yIHRvIGFjY2VwdCBuZWNlc3NhcnkgcGFyYW1ldGVyc1xuXG4zLiAqKlVwZGF0ZSBNYWluR1VJLmphdmEqKjpcbiAgIC0gQWRkIG1lbnUgaXRlbXMgZm9yIHRoZSBuZXcgcGFuZWxzXG4gICAtIEltcGxlbWVudCB0aGUgcGFuZWwgbG9hZGluZyBsb2dpYyBpbiB0aGUgc3dpdGNoVG9QYW5lbCBtZXRob2RcblxuTGV0J3Mgc3RhcnQgaW1wbGVtZW50aW5nIHRoZXNlIGNoYW5nZXM6XG5cbiMjIDEuIEZpcnN0LCBsZXQncyBtb2RpZnkgVHJhaW5UaWNrZXRCb29raW5nU3lzdGVtLmphdmE6XG4iLCJ3b3Jrc3BhY2VfZmlsZV9jaHVua3MiOltdfSx7InN0YXR1cyI6InN1Y2Nlc3MiLCJyZXF1ZXN0X2lkIjoiNWU3MmVkMmItZDk0ZS00YmJkLWE1NTUtYzQ1ZGEwOTM2ODFmIiwicmVxdWVzdF9tZXNzYWdlIjoiIiwic3RydWN0dXJlZF9vdXRwdXRfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjo1LCJjb250ZW50IjoiIiwidG9vbF91c2UiOnsidG9vbF91c2VfaWQiOiJ0b29sdV8wMU5kR0JQbVFoZnVaTVNtUksyUkRua2giLCJ0b29sX25hbWUiOiJjb2RlYmFzZS1yZXRyaWV2YWwiLCJpbnB1dF9qc29uIjoie1wiaW5mb3JtYXRpb25fcmVxdWVzdFwiOiBcIkdldCB0aGUgZnVsbCBjb250ZW50IG9mIFRyYWluVGlja2V0Qm9va2luZ1N5c3RlbS5qYXZhIGZpbGVcIn0ifX0seyJpZCI6MCwidHlwZSI6MCwiY29udGVudCI6IkxldCBtZSB0cnkgdG8gcmV0cmlldmUgdGhlIGZpbGUgY29udGVudCB1c2luZyB0aGUgY29kZWJhc2UtcmV0cmlldmFsIHRvb2w6XG4ifSx7ImlkIjoyLCJ0eXBlIjoyLCJjb250ZW50IjoiIn0seyJpZCI6MywidHlwZSI6MywiY29udGVudCI6IiJ9XSwic2Vlbl9zdGF0ZSI6InNlZW4iLCJzdHJ1Y3R1cmVkX3JlcXVlc3Rfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjoxLCJ0b29sX3Jlc3VsdF9ub2RlIjp7ImNvbnRlbnQiOiJSYW4gaW50byBVbmtub3duIGVycm9yIHdoaWxlIHRyeWluZyB0byByZWFkIFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZ3VpQ2xpZW50L1RyYWluVGlja2V0Qm9va2luZ1N5c3RlbS5qYXZhIiwiaXNfZXJyb3IiOnRydWUsInJlcXVlc3RfaWQiOiIiLCJ0b29sX3VzZV9pZCI6InRvb2x1XzAxMzh1MkFhcXhSY2t2OUVWVEVZWEZ4dyJ9fSx7ImlkIjoyLCJ0eXBlIjo0LCJpZGVfc3RhdGVfbm9kZSI6eyJ3b3Jrc3BhY2VGb2xkZXJzIjpbeyJyZXBvc2l0b3J5Um9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIiwiZm9sZGVyUm9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIn1dLCJ3b3Jrc3BhY2VGb2xkZXJzVW5jaGFuZ2VkIjpmYWxzZSwiY3VycmVudFRlcm1pbmFsIjp7InRlcm1pbmFsSWQiOjIyLCJjdXJyZW50V29ya2luZ0RpcmVjdG9yeSI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIn19fV0sInJlc3BvbnNlX3RleHQiOiJMZXQgbWUgdHJ5IHRvIHJldHJpZXZlIHRoZSBmaWxlIGNvbnRlbnQgdXNpbmcgdGhlIGNvZGViYXNlLXJldHJpZXZhbCB0b29sOlxuIiwid29ya3NwYWNlX2ZpbGVfY2h1bmtzIjpbXX0seyJzdGF0dXMiOiJzdWNjZXNzIiwicmVxdWVzdF9pZCI6IjA5ZjE2MjA0LWZjYjMtNGYxNC05OWY3LTk0NTg1OWQyNjFjZCIsInJlcXVlc3RfbWVzc2FnZSI6IiIsInN0cnVjdHVyZWRfb3V0cHV0X25vZGVzIjpbeyJpZCI6MCwidHlwZSI6MCwiY29udGVudCI6Ik5vdywgbGV0J3MgY3JlYXRlIHRoZSBtb2RpZmllZCB2ZXJzaW9uIG9mIFRyYWluVGlja2V0Qm9va2luZ1N5c3RlbSBhcyBhIEpQYW5lbDpcbiJ9LHsiaWQiOjIsInR5cGUiOjIsImNvbnRlbnQiOiIifSx7ImlkIjozLCJ0eXBlIjozLCJjb250ZW50IjoiIn1dLCJzZWVuX3N0YXRlIjoic2VlbiIsInN0cnVjdHVyZWRfcmVxdWVzdF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjEsInRvb2xfcmVzdWx0X25vZGUiOnsiY29udGVudCI6IlRoZSBmb2xsb3dpbmcgY29kZSBzZWN0aW9ucyB3ZXJlIHJldHJpZXZlZDpcblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZ3VpQ2xpZW50L1RyYWluVGlja2V0Qm9va2luZ1N5c3RlbS5qYXZhXG5wYWNrYWdlIGd1aUNsaWVudDtcblxuaW1wb3J0IGRhby4qO1xuaW1wb3J0IGRhby5pbXBsLio7XG5pbXBvcnQgbW9kZWwuKjtcblxuaW1wb3J0IGphdmF4LnN3aW5nLio7XG5pbXBvcnQgamF2YXguc3dpbmcuYm9yZGVyLio7XG5pbXBvcnQgamF2YXguc3dpbmcudGV4dC5EZWZhdWx0Q2FyZXQ7XG5pbXBvcnQgamF2YS5hd3QuKjtcbmltcG9ydCBqYXZhLmF3dC5ldmVudC4qO1xuaW1wb3J0IGphdmEucm1pLlJlbW90ZUV4Y2VwdGlvbjtcbmltcG9ydCBqYXZhLnRleHQuTnVtYmVyRm9ybWF0O1xuaW1wb3J0IGphdmEudGltZS5Mb2NhbERhdGU7XG5pbXBvcnQgamF2YS50aW1lLlpvbmVJZDtcbmltcG9ydCBqYXZhLnRpbWUuZm9ybWF0LkRhdGVUaW1lRm9ybWF0dGVyO1xuaW1wb3J0IGphdmEudXRpbC4qO1xuaW1wb3J0IGphdmEudXRpbC5MaXN0O1xuaW1wb3J0IGphdmF4LnN3aW5nLlRpbWVyO1xuaW1wb3J0IGphdmF4LnN3aW5nLnBsYWYuYmFzaWMuQmFzaWNTY3JvbGxCYXJVSTtcbmltcG9ydCBqYXZhLnV0aWwuc3RyZWFtLkNvbGxlY3RvcnM7XG5pbXBvcnQgY29tLnRvZWR0ZXIuY2FsZW5kYXIuSkRhdGVDaG9vc2VyO1xuXG4vKipcbiAqIFRyYWluIFRpY2tldCBCb29raW5nIFN5c3RlbSBHVUlcbiAqIEFsbG93cyB1c2VycyB0byBzZWFyY2ggZm9yIHRyYWlucywgdmlldyBjYXJzLCBzZWxlY3Qgc2VhdHMsIGFuZCBib29rIHRpY2tldHNcbiAqIEBhdXRob3IgbHVvbmd0YW4yMDRcbiAqL1xucHVibGljIGNsYXNzIFRyYWluVGlja2V0Qm9va2luZ1N5c3RlbSBleHRlbmRzIEpGcmFtZSB7XG4gICAgLy8gVUkgQ29tcG9uZW50c1xuICAgIHByaXZhdGUgSlBhbmVsIHNlYXRzUGFuZWw7XG4gICAgcHJpdmF0ZSBKUGFuZWwgY2Fyc1BhbmVsO1xuICAgIHByaXZhdGUgSlBhbmVsIHRyYWluc1BhbmVsO1xuICAgIHByaXZhdGUgSlNjcm9sbFBhbmUgdHJhaW5zU2Nyb2xsUGFuZTtcbiAgICBwcml2YXRlIEpTY3JvbGxQYW5lIGNhcnNTY3JvbGxQYW5lO1xuICAgIHByaXZhdGUgSkxhYmVsIHNlYXRpbmdTZWN0aW9uTGFiZWw7XG4gICAgcHJpdmF0ZSBKTGFiZWwgdG90YWxMYWJlbDtcblxuICAgIC8vIEZvcm0gZmllbGRzXG4gICAgcHJpdmF0ZSBKVGV4dEZpZWxkIGRlcGFydHVyZUZpZWxkO1xuICAgIHByaXZhdGUgSlRleHRGaWVsZCBhcnJpdmFsRmllbGQ7XG4gICAgcHJpdmF0ZSBKVGV4dEZpZWxkIGRlcGFydHVyZURhdGVGaWVsZDtcbiAgICBwcml2YXRlIEpUZXh0RmllbGQgcmV0dXJuRGF0ZUZpZWxkO1xuICAgIHByaXZhdGUgSlJhZGlvQnV0dG9uIG9uZVdheVJhZGlvO1xuICAgIHByaXZhdGUgSlJhZGlvQnV0dG9uIHJvdW5kVHJpcFJhZGlvO1xuXG4gICAgLy8gU3RhdGUgdmFyaWFibGVzXG4gICAgcHJpdmF0ZSBTdHJpbmcgc2VsZWN0ZWRUcmFpbklkID0gXCJcIjsgICAvLyBDb21wb3VuZCBJRCBmb3Igc2VsZWN0aW9uICh0cmFpbiBjb2RlICsgdGltZSlcbiAgICBwcml2YXRlIFN0cmluZyBjdXJyZW50VHJhaW5JZCA9IFwiXCI7ICAgIC8vIEp1c3QgdGhlIHRyYWluIGNvZGVcbiAgICBwcml2YXRlIFN0cmluZyBjdXJyZW50VG9hSWQgPSBcIlwiOyAgICAgIC8vIENhciBJRFxuICAgIHByaXZhdGUgU3RyaW5nIGN1cnJlbnRNYUxpY2ggPSBcIlwiOyAgICAgLy8gU2NoZWR1bGUgSUQgZm9yIHNlYXQgbG9hZGluZ1xuICAgIHByaXZhdGUgQXJyYXlMaXN0PFRpY2tldEl0ZW0+IGNhcnRJdGVtcyA9IG5ldyBBcnJheUxpc3Q8PigpO1xuICAgIHByaXZhdGUgZG91YmxlIHRvdGFsQW1vdW50ID0gMC4wO1xuXG4gICAgLy8gU2VhdCBzdGF0dXMgY29uc3RhbnRzXG4gICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgU3RyaW5nIFNUQVRVU19BVkFJTEFCTEUgPSBcIlRy4buRbmdcIjtcbiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmcgU1RBVFVTX0JPT0tFRCA9IFwixJDDoyDEkeG6t3RcIjtcbiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmcgU1RBVFVTX1BFTkRJTkcgPSBcIkNo4budIHjDoWMgbmjhuq1uXCI7XG5cbiAgICAvLyBTZWF0IGNvbG9yc1xuICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIENvbG9yIFNFQVRfQVZBSUxBQkxFX0NPTE9SID0gQ29sb3IuV0hJVEU7XG4gICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgQ29sb3IgU0VBVF9CT09LRURfQ09MT1IgPSBDb2xvci5MSUdIVF9HUkFZO1xuICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIENvbG9yIFNFQVRfUEVORElOR19DT0xPUiA9IENvbG9yLllFTExPVztcblxuICAgIHByaXZhdGUgTWFwPFN0cmluZywgVGltZXI+IHJlc2VydmF0aW9uVGltZXJzID0gbmV3IEhhc2hNYXA8PigpOyAvLyBTdG9yZSB0aW1lcnMgZm9yIGVhY2ggcmVzZXJ2ZWQgc2VhdFxuICAgIHByaXZhdGUgTWFwPFN0cmluZywgSW50ZWdlcj4gcmVtYWluaW5nVGltZXMgPSBuZXcgSGFzaE1hcDw+KCk7ICAvLyBTdG9yZSByZW1haW5pbmcgc2Vjb25kcyBmb3IgZWFjaCByZXNlcnZhdGlvblxuICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIGludCBSRVNFUlZBVElPTl9USU1FT1VUID0gMzAwOyAvLyAzMDAgc2Vjb25kcyAoNSBtaW51dGVzKVxuXG4gICAgLy8gVmlzdWFsIGVmZmVjdHNcbiAgICBwcml2YXRlIENvbG9yIGFjdGl2ZUNvbG9yID0gbmV3IENvbG9yKDAsIDEzNiwgMjA0KTtcbiAgICBwcml2YXRlIENvbG9yIGluYWN0aXZlQ29sb3IgPSBuZXcgQ29sb3IoMTUzLCAxNTMsIDE1Myk7XG4gICAgcHJpdmF0ZSBDb2xvciBob3ZlckNvbG9yID0gbmV3IENvbG9yKDUxLCAxNTMsIDI1NSk7XG4gICAgcHJpdmF0ZSBCb3JkZXIgYWN0aXZlQm9yZGVyID0gQm9yZGVyRmFjdG9yeS5jcmVhdGVDb21wb3VuZEJvcmRlcihcbiAgICAgICAgICAgIEJvcmRlckZhY3RvcnkuY3JlYXRlTGluZUJvcmRlcihuZXcgQ29sb3IoMjU1LCAyMTUsIDApLCAyKSwgLy8gR29sZCBib3JkZXJcbiAgICAgICAgICAgIEJvcmRlckZhY3RvcnkuY3JlYXRlRW1wdHlCb3JkZXIoMSwgMSwgMSwgMSlcbiAgICApO1xuICAgIHByaXZhdGUgQm9yZGVyIG5vcm1hbEJvcmRlciA9IEJvcmRlckZhY3RvcnkuY3JlYXRlRW1wdHlCb3JkZXIoMywgMywgMywgMyk7XG5cbiAgICAvLyBEQU9zXG4gICAgcHJpdmF0ZSBMaWNoVHJpbmhUYXVEQU8gbGljaFRyaW5oVGF1REFPO1xuICAgIHByaXZhdGUgVGF1REFPIHRhdURBTztcbiAgICBwcml2YXRlIFRvYVRhdURBTyB0b2FUYXVEQU87XG4gICAgcHJpdmF0ZSBDaG9OZ29pREFPIGNob05nb2lEQU87XG4gICAgcHJpdmF0ZSBLaHV5ZW5NYWlEQU8ga2h1eWVuTWFpREFPO1xuXG4gICAgLy8gRW1wbG95ZWUgaW5mb3JtYXRpb25cbiAgICBwcml2YXRlIE5oYW5WaWVuIG5oYW5WaWVuO1xuXG4gICAgLyoqXG4gICAgICogQ29uc3RydWN0b3IgLSBpbml0aWFsaXplcyB0aGUgYXBwbGljYXRpb25cbiAgICAgKiBAcGFyYW0gbnYgVGhlIGVtcGxveWVlIHdobyBpcyB1c2luZyB0aGUgc3lzdGVtXG4gICAgICovXG4gICAgcHVibGljIFRyYWluVGlja2V0Qm9va2luZ1N5c3RlbShOaGFuVmllbiBudikgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgICAgIHRoaXMubmhhblZpZW4gPSBudjtcbiAgICAgICAgc2V0VGl0bGUoXCJI4buHIHRo4buRbmcgxJHhurd0IHbDqSB0w6B1XCIpO1xuICAgICAgICBzZXRTaXplKDEyMDAsIDY1MCk7XG4gICAgICAgIHNldERlZmF1bHRDbG9zZU9wZXJhdGlvbihKRnJhbWUuRVhJVF9PTl9DTE9TRSk7XG4gICAgICAgIHNldExvY2F0aW9uUmVsYXRpdmVUbyhudWxsKTtcblxuICAgICAgICAvLyBJbml0aWFsaXplIERBT3NcbiAgICAgICAgbGljaFRyaW5oVGF1REFPID0gbmV3IExpY2hUcmluaFRhdURBT0ltcGwoKTtcbiAgICAgICAgdGF1REFPID0gbmV3IFRhdURBT0ltcGwoKTtcbiAgICAgICAgdG9hVGF1REFPID0gbmV3IFRvYVRhdURBT0ltcGwoKTtcbiAgICAgICAgY2hvTmdvaURBTyA9IG5ldyBDaG9OZ29pREFPSW1wbCgpO1xuICAgICAgICBraHV5ZW5NYWlEQU8gPSBuZXcgS2h1eWVuTWFpREFPSW1wbCgpO1xuXG4gICAgICAgIC8vIE1haW4gY29udGFpbmVyIHBhbmVsIHdpdGggQm9yZGVyTGF5b3V0XG4gICAgICAgIEpQYW5lbCBjb250YWluZXJQYW5lbCA9IG5ldyBKUGFuZWwobmV3IEJvcmRlckxheW91dCgxMCwgMTApKTtcblxuICAgICAgICAvLyBNYWluIHBhbmVsIChjZW50ZXIgY29udGVudClcbiAgICAgICAgSlBhbmVsIG1haW5QYW5lbCA9IG5ldyBKUGFuZWwoKTtcbiAgICAgICAgbWFpblBhbmVsLnNldExheW91dChuZXcgQm9yZGVyTGF5b3V0KDEwLCAxMCkpO1xuICAgICAgICBtYWluUGFuZWwuc2V0Qm9yZGVyKG5ldyBFbXB0eUJvcmRlcigxMCwgMTAsIDEwLCAxMCkpO1xuXG4gICAgICAgIC8vIEFkZCBjb21wb25lbnRzIHRvIG1haW4gcGFuZWxcbiAgICAgICAgbWFpblBhbmVsLmFkZChjcmVhdGVIZWFkZXJQYW5lbCgpLCBCb3JkZXJMYXlvdXQuTk9SVEgpO1xuICAgICAgICBtYWluUGFuZWwuYWRkKGNyZWF0ZVRyYWluc1BhbmVsKCksIEJvcmRlckxheW91dC5DRU5URVIpO1xuXG4gICAgICAgIC8vIExlZnQgcGFuZWwgLSBUcmlwIEluZm9ybWF0aW9uXG4gICAgICAgIEpQYW5lbCBsZWZ0UGFuZWwgPSBjcmVhdGVUcmlwSW5mb1BhbmVsKCk7XG5cbiAgICAgICAgLy8gUmlnaHQgcGFuZWwgLSBUaWNrZXQgQ2FydFxuICAgICAgICBKUGFuZWwgcmlnaHRQYW5lbCA9IGNyZWF0ZVRpY2tldENhcnRQYW5lbCgpO1xuXG4gICAgICAgIC8vIEFkZCBhbGwgcGFuZWxzIHRvIHRoZSBjb250YWluZXJcbiAgICAgICAgY29udGFpbmVyUGFuZWwuYWRkKGxlZnRQYW5lbCwgQm9yZGVyTGF5b3V0LldFU1QpO1xuICAgICAgICBjb250YWluZXJQYW5lbC5hZGQobWFpblBhbmVsLCBCb3JkZXJMYXlvdXQuQ0VOVEVSKTtcbiAgICAgICAgY29udGFpbmVyUGFuZWwuYWRkKHJpZ2h0UGFuZWwsIEJvcmRlckxheW91dC5FQVNUKTtcblxuICAgICAgICAvLyBBZGQgY29udGFpbmVyIHBhbmVsIHRvIGZyYW1lXG4gICAgICAgIGFkZChjb250YWluZXJQYW5lbCk7XG4gICAgfVxuLi4uXG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgdHJhaW4gY2FyZCBwYW5lbCB3aXRoIHRoZSBnaXZlbiBkZXRhaWxzXG4gICAgICovXG4gICAgcHJpdmF0ZSBKUGFuZWwgY3JlYXRlVHJhaW5DYXJkKFN0cmluZyB0cmFpbkNvZGUsIFN0cmluZyBkZXBhcnRUaW1lLCBsb25nIGF2YWlsYWJsZVNlYXRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib29sZWFuIGlzU2VsZWN0ZWQsIFRyYW5nVGhhaSBzdGF0dXMsIFN0cmluZyBtYUxpY2gpIHtcbiAgICAgICAgSlBhbmVsIGNhcmRQYW5lbCA9IG5ldyBKUGFuZWwoKTtcbiAgICAgICAgY2FyZFBhbmVsLnNldExheW91dChuZXcgQm9yZGVyTGF5b3V0KCkpO1xuICAgICAgICBjYXJkUGFuZWwuc2V0Qm9yZGVyKGlzU2VsZWN0ZWQgPyBhY3RpdmVCb3JkZXIgOiBub3JtYWxCb3JkZXIpO1xuXG4gICAgICAgIC8vIENyZWF0ZSBhIHVuaXF1ZSBpZGVudGlmaWVyIHVzaW5nIHRyYWluIGNvZGUgYW5kIGRlcGFydHVyZSB0aW1lXG4gICAgICAgIFN0cmluZyB1bmlxdWVJZCA9IHRyYWluQ29kZSArIFwiX1wiICsgZGVwYXJ0VGltZS5yZXBsYWNlKFwiL1wiLCBcIlwiKS5yZXBsYWNlKFwiOlwiLCBcIlwiKS5yZXBsYWNlKFwiIFwiLCBcIlwiKTtcblxuICAgICAgICAvLyBTdG9yZSBpbXBvcnRhbnQgZGF0YSBhcyBjbGllbnQgcHJvcGVydGllc1xuICAgICAgICBjYXJkUGFuZWwucHV0Q2xpZW50UHJvcGVydHkoXCJ0cmFpbklkXCIsIHVuaXF1ZUlkKTtcbiAgICAgICAgY2FyZFBhbmVsLnB1dENsaWVudFByb3BlcnR5KFwidHJhaW5Db2RlXCIsIHRyYWluQ29kZSk7XG4gICAgICAgIGNhcmRQYW5lbC5wdXRDbGllbnRQcm9wZXJ0eShcIm1hTGljaFwiLCBtYUxpY2gpO1xuLi4uXG5cbiAgICAgICAgY2FyZFBhbmVsLnNldFRvb2xUaXBUZXh0KFxuICAgICAgICAgICAgICAgIFwiPGh0bWw+XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCI8Yj5Uw6B1OiBcIiArIHRyYWluQ29kZSArIFwiPC9iPjxicj5cIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIlRo4budaSBnaWFuIMSRaTogXCIgKyBkZXBhcnRUaW1lICsgXCI8YnI+XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJT4buRIGNo4buXIHRy4buRbmc6IFwiICsgYXZhaWxhYmxlU2VhdHMgK1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzVGV4dCArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIjxicj5OaOG6pXAgxJHhu4MgeGVtIGNoaSB0aeG6v3QgdG9hIHTDoHUuXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCI8L2h0bWw+XCJcbiAgICAgICAgKTtcblxuICAgICAgICAvLyBBZGQgc2VsZWN0aW9uIGxpc3RlbmVyIHdpdGggY2xlYXIgZXZlbnQgaGFuZGxpbmdcbiAgICAgICAgY2FyZFBhbmVsLmFkZE1vdXNlTGlzdGVuZXIobmV3IE1vdXNlQWRhcHRlcigpIHtcbiAgICAgICAgICAgIEBPdmVycmlkZVxuICAgICAgICAgICAgcHVibGljIHZvaWQgbW91c2VDbGlja2VkKE1vdXNlRXZlbnQgZSkge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFN0b3JlIHRoZSB1bmlxdWUgSUQsIHRyYWluIGNvZGUgYW5kIHNjaGVkdWxlIElEXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkVHJhaW5JZCA9IHVuaXF1ZUlkO1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50TWFMaWNoID0gbWFMaWNoO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBzZWxlY3Rpb24gaW4gVUkgYW5kIGxvYWQgdGhlIGNvcnJlc3BvbmRpbmcgY2Fyc1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGVUcmFpblNlbGVjdGlvbih1bmlxdWVJZCwgdHJhaW5Db2RlKTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChSZW1vdGVFeGNlcHRpb24gZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coY2FyZFBhbmVsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2kga2hpIHThuqNpIHRow7RuZyB0aW4gdMOgdTogXCIgKyBleC5nZXRNZXNzYWdlKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaVwiLCBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4uLi5cblxuICAgICAgICAgICAgY2FyUGFuZWwuYWRkTW91c2VMaXN0ZW5lcihuZXcgTW91c2VBZGFwdGVyKCkge1xuICAgICAgICAgICAgICAgIEBPdmVycmlkZVxuICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIG1vdXNlQ2xpY2tlZChNb3VzZUV2ZW50IGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBjdXJyZW50IHRvYSBJRFxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFRvYUlkID0gdG9hSWQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgc2VhdGluZyBzZWN0aW9uIGxhYmVsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWF0aW5nU2VjdGlvbkxhYmVsLnNldFRleHQoXCJUb2Egc+G7kSBcIiArIGZpbmFsVG9hTnVtYmVyICsgXCI6IFwiICsgdG9hTmFtZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB2aXN1YWwgc2VsZWN0aW9uIGZvciBhbGwgY2Fyc1xuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlQ2FyU2VsZWN0aW9uKHRvYUlkKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTG9hZCBhbmQgZGlzcGxheSB0aGUgc2VhdCBjaGFydFxuICAgICAgICAgICAgICAgICAgICAgICAgbG9hZFNlYXRDaGFydChjdXJyZW50VHJhaW5JZCwgY3VycmVudFRvYUlkLCBjdXJyZW50TWFMaWNoKTtcblxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKGNhclBhbmVsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpIGtoaSBjaOG7jW4gdG9hOiBcIiArIGV4LmdldE1lc3NhZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaVwiLCBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbi4uLlxuXG4gICAgICAgICAgICAvLyBBZGQgYm90aCBwYW5lbHMgdG8gdGhlIHNlYXRzIHBhbmVsXG4gICAgICAgICAgICBzZWF0c1BhbmVsLmFkZChzZWF0VmlzdWFsaXphdGlvblBhbmVsLCBCb3JkZXJMYXlvdXQuQ0VOVEVSKTtcbiAgICAgICAgICAgIHNlYXRzUGFuZWwuYWRkKGxlZ2VuZFBhbmVsLCBCb3JkZXJMYXlvdXQuU09VVEgpO1xuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiTG9hZGluZyBzZWF0IGNoYXJ0IGZvciB0cmFpbjogXCIgKyB0cmFpbklkICsgXCIsIGNhcjogXCIgKyB0b2FJZCk7XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJTY2hlZHVsZSBJRDogXCIgKyBtYUxpY2gpO1xuICAgICAgICAgICAgaWYgKHNlYXRzTWFwICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJSZWNlaXZlZCBcIiArIHNlYXRzTWFwLnNpemUoKSArIFwiIHNlYXRzIGZyb20gREFPXCIpO1xuICAgICAgICAgICAgICAgIGlmIChzZWF0c01hcC5zaXplKCkgPiAxMDApIHtcbiAgICAgICAgICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiV0FSTklORzogVW51c3VhbGx5IGhpZ2ggc2VhdCBjb3VudCBkZXRlY3RlZCFcIik7XG4gICAgICAgICAgICAgICAgICAgIC8vIFByaW50IGZpcnN0IDEwIHNlYXRzIGZvciBpbnNwZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgIGludCBjb3VudCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoTWFwLkVudHJ5PFN0cmluZywgU3RyaW5nPiBlbnRyeSA6IHNlYXRzTWFwLmVudHJ5U2V0KCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIlNlYXQ6IFwiICsgZW50cnkuZ2V0S2V5KCkgKyBcIiwgU3RhdHVzOiBcIiArIGVudHJ5LmdldFZhbHVlKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCsrY291bnQgPj0gMTApIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VhdHNQYW5lbC5yZXZhbGlkYXRlKCk7XG4gICAgICAgICAgICBzZWF0c1BhbmVsLnJlcGFpbnQoKTtcbi4uLlxuXG4gICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIlRvdGFsIHNlYXRzOiBcIiArIHNlYXRJZHMuc2l6ZSgpKTtcblxuICAgICAgICAvLyBDYWxjdWxhdGUgY29sdW1ucyBiYXNlZCBvbiB0b3RhbCBzZWF0cyAoZW5zdXJpbmcgNCByb3dzKVxuICAgICAgICBpbnQgdG90YWxSb3dzID0gNDtcbiAgICAgICAgaW50IHRvdGFsU2VhdHNQZXJTaWRlID0gKGludClNYXRoLmNlaWwoc2VhdElkcy5zaXplKCkgLyAoZG91YmxlKXRvdGFsUm93cyAvIDIpO1xuICAgICAgICBpbnQgdG90YWxDb2x1bW5zID0gdG90YWxTZWF0c1BlclNpZGUgKiAyICogMiArIDE7IC8vIDIgc2lkZXMsIDIgc2VhdHMgcGVyIGJsb2NrLCArMSBmb3IgYWlzbGVcbiAgICAgICAgaW50IGFpc2xlUG9zaXRpb24gPSB0b3RhbENvbHVtbnMgLyAyO1xuXG4gICAgICAgIC8vIENyZWF0ZSBhIGdyaWQgbGF5b3V0IHdpdGggNCByb3dzXG4gICAgICAgIEdyaWRMYXlvdXQgZ3JpZExheW91dCA9IG5ldyBHcmlkTGF5b3V0KHRvdGFsUm93cywgdG90YWxDb2x1bW5zKTtcbiAgICAgICAgZ3JpZExheW91dC5zZXRIZ2FwKDIpO1xuICAgICAgICBncmlkTGF5b3V0LnNldFZnYXAoMik7XG4gICAgICAgIHNlYXRHcmlkUGFuZWwuc2V0TGF5b3V0KGdyaWRMYXlvdXQpO1xuXG4gICAgICAgIC8vIEZpcnN0LCBjcmVhdGUgZW1wdHkgcGFuZWxzIGZvciBhbGwgcG9zaXRpb25zIGluIHRoZSBncmlkXG4gICAgICAgIEpQYW5lbFtdW10gc2VhdFBhbmVscyA9IG5ldyBKUGFuZWxbdG90YWxSb3dzXVt0b3RhbENvbHVtbnNdO1xuLi4uXG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgc2VhdCBzZWxlY3Rpb25cbiAgICAgKi9cbiAgICBwcml2YXRlIHZvaWQgc2VsZWN0U2VhdChTdHJpbmcgc2VhdElkKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBDaGVjayBpZiBzZWF0IGlzIGFscmVhZHkgaW4gcGVuZGluZyBzdGF0dXNcbiAgICAgICAgICAgIGlmIChyZXNlcnZhdGlvblRpbWVycy5jb250YWluc0tleShzZWF0SWQpKSB7XG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2codGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiR2jhur8gbsOgeSDEkcOjIMSRxrDhu6NjIGdp4buvIGNo4buXIHbDoCDEkWFuZyBjaOG7nSB0aGFuaCB0b8Ohbi5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiVGjDtG5nIGLDoW9cIiwgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZXQgdGhlIHNlYXQgaW5mbyBmcm9tIERBT1xuICAgICAgICAgICAgQ2hvTmdvaSBjaG9OZ29pID0gY2hvTmdvaURBTy5nZXRCeUlkKHNlYXRJZCk7XG5cbiAgICAgICAgICAgIGlmIChjaG9OZ29pID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyh0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJLaMO0bmcgdMOsbSB0aOG6pXkgdGjDtG5nIHRpbiBnaOG6vzogXCIgKyBzZWF0SWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0UpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2V0IHNlYXQgcHJpY2UgYmFzZWQgb24gcm91dGUgYW5kIHNlYXQgY2xhc3NcbiAgICAgICAgICAgIGRvdWJsZSBwcmljZSA9IGdldFNlYXRQcmljZShjaG9OZ29pKTtcbiAgICAgICAgICAgIFN0cmluZyBkaXNwbGF5TmFtZSA9IChjaG9OZ29pLmdldFRlbkNobygpICE9IG51bGwpID8gY2hvTmdvaS5nZXRUZW5DaG8oKSA6IHNlYXRJZDtcblxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBVSSB0byByZWZsZWN0IHBlbmRpbmcgc3RhdHVzXG4gICAgICAgICAgICAgICAgdXBkYXRlU2VhdFN0YXR1cyhzZWF0SWQsIFNUQVRVU19QRU5ESU5HKTtcblxuICAgICAgICAgICAgICAgIC8vIEFkZCB0byBjYXJ0XG4gICAgICAgICAgICAgICAgYWRkVG9DYXJ0V2l0aFRpbWVvdXQoc2VhdElkLCBkaXNwbGF5TmFtZSwgcHJpY2UpO1xuXG4gICAgICAgICAgICAgICAgLy8gU3RhcnQgY291bnRkb3duIHRpbWVyIGZvciB0aGlzIHNlYXRcbiAgICAgICAgICAgICAgICBzdGFydFJlc2VydmF0aW9uQ291bnRkb3duKHNlYXRJZCwgZGlzcGxheU5hbWUsIHByaWNlKTtcblxuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZXgpIHtcbiAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIFwiTOG7l2kga2hpIGdp4buvIGNo4buXOiBcIiArIGV4LmdldE1lc3NhZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgXCJM4buXaVwiLCBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFKTtcbiAgICAgICAgICAgIGV4LnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICB9XG4gICAgfVxuLi4uXG4gICAgLyoqXG4gICAgICogU3RhcnQgY291bnRkb3duIHRpbWVyIGZvciBzZWF0IHJlc2VydmF0aW9uXG4gICAgICovXG4gICAgcHJpdmF0ZSB2b2lkIHN0YXJ0UmVzZXJ2YXRpb25Db3VudGRvd24oU3RyaW5nIHNlYXRJZCwgU3RyaW5nIGRpc3BsYXlOYW1lLCBkb3VibGUgcHJpY2UpIHtcbiAgICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgcmVtYWluaW5nIHRpbWVcbiAgICAgICAgcmVtYWluaW5nVGltZXMucHV0KHNlYXRJZCwgUkVTRVJWQVRJT05fVElNRU9VVCk7XG5cbiAgICAgICAgLy8gQ3JlYXRlIGFuZCBzdGFydCB0aGUgdGltZXJcbiAgICAgICAgVGltZXIgdGltZXIgPSBuZXcgVGltZXIoMTAwMCwgbnVsbCk7IC8vIDEgc2Vjb25kIGludGVydmFsc1xuICAgICAgICB0aW1lci5hZGRBY3Rpb25MaXN0ZW5lcihlIC0+IHtcbiAgICAgICAgICAgIGludCByZW1haW5pbmcgPSByZW1haW5pbmdUaW1lcy5nZXQoc2VhdElkKSAtIDE7XG4gICAgICAgICAgICByZW1haW5pbmdUaW1lcy5wdXQoc2VhdElkLCByZW1haW5pbmcpO1xuXG4gICAgICAgICAgICAvLyBVcGRhdGUgdGhlIGNvdW50ZG93biBpbiB0aGUgY2FydFxuICAgICAgICAgICAgdXBkYXRlQ2FydEl0ZW1Db3VudGRvd24oc2VhdElkLCByZW1haW5pbmcpO1xuXG4gICAgICAgICAgICAvLyBJZiB0aW1lIGlzIHVwLCByZWxlYXNlIHRoZSBzZWF0XG4gICAgICAgICAgICBpZiAocmVtYWluaW5nIDw9IDApIHtcbiAgICAgICAgICAgICAgICB0aW1lci5zdG9wKCk7XG4gICAgICAgICAgICAgICAgcmVsZWFzZVJlc2VydmF0aW9uKHNlYXRJZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFN0b3JlIHRoZSB0aW1lciBhbmQgc3RhcnQgaXRcbiAgICAgICAgcmVzZXJ2YXRpb25UaW1lcnMucHV0KHNlYXRJZCwgdGltZXIpO1xuICAgICAgICB0aW1lci5zdGFydCgpO1xuICAgIH1cbi4uLlxuXG4gICAgICAgIC8vIENyZWF0ZSBhbmQgYWRkIHRpY2tldCBpdGVtIHRvIGNhcnQgd2l0aCBzZWF0SWQgZm9yIGxhdGVyIHJlZmVyZW5jZVxuICAgICAgICBUaWNrZXRJdGVtIGl0ZW0gPSBuZXcgVGlja2V0SXRlbShjdXJyZW50VHJhaW5JZCwgc2VhdElkLCBkaXNwbGF5TmFtZSwgZnJvbSwgdG8sIGRlcGFydHVyZURhdGUsIHByaWNlLCBjYXJJZCwgY2FyTmFtZSk7XG4gICAgICAgIGNhcnRJdGVtcy5hZGQoaXRlbSk7XG5cbiAgICAgICAgLy8gVXBkYXRlIGNhcnQgZGlzcGxheVxuICAgICAgICB1cGRhdGVDYXJ0RGlzcGxheSgpO1xuXG4gICAgICAgIC8vIEltbWVkaWF0ZWx5IHVwZGF0ZSB0aGUgc2VhdCBzdGF0dXMgaW4gVUkgdG8gc2hvdyBhcyBwZW5kaW5nICh5ZWxsb3cpXG4gICAgICAgIHVwZGF0ZVNlYXRTdGF0dXMoc2VhdElkLCBTVEFUVVNfUEVORElORyk7XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgY2FydCBpdGVtIHRvIHNob3cgY291bnRkb3duXG4gICAgICovXG5cblxuICAgIC8qKlxuICAgICAqIEhlbHBlciB0byB1cGRhdGUgYSBwYW5lbCB3aXRoIGNvdW50ZG93blxuICAgICAqL1xuLi4uXG5cbiAgICAvKipcbiAgICAgKiBTZWFyY2ggZm9yIHRyYWlucyBiYXNlZCBvbiBmb3JtIGRhdGFcbiAgICAgKi9cbiAgICBwcml2YXRlIHZvaWQgc2VhcmNoVHJhaW5zKCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IGlucHV0IGRhdGFcbiAgICAgICAgICAgIFN0cmluZyBnYURpID0gZGVwYXJ0dXJlRmllbGQuZ2V0VGV4dCgpLnRyaW0oKTtcbiAgICAgICAgICAgIFN0cmluZyBnYURlbiA9IGFycml2YWxGaWVsZC5nZXRUZXh0KCkudHJpbSgpO1xuXG4gICAgICAgICAgICAvLyBQYXJzZSBkYXRlXG4gICAgICAgICAgICBEYXRlVGltZUZvcm1hdHRlciBmb3JtYXR0ZXIgPSBEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oXCJkZC9NTS95eXl5XCIpO1xuICAgICAgICAgICAgTG9jYWxEYXRlIGRlcGFydHVyZURhdGUgPSBMb2NhbERhdGUucGFyc2UoZGVwYXJ0dXJlRGF0ZUZpZWxkLmdldFRleHQoKS50cmltKCksIGZvcm1hdHRlcik7XG5cbiAgICAgICAgICAgIC8vIENhbGwgREFPIHRvIGdldCB0cmFpbiBzY2hlZHVsZXNcbiAgICAgICAgICAgIExpc3Q8TGljaFRyaW5oVGF1PiBhbGxMaWNoVHJpbmhMaXN0ID0gbGljaFRyaW5oVGF1REFPLmdldExpc3RMaWNoVHJpbmhUYXVCeURhdGVBbmRHYURpR2FEZW4oZGVwYXJ0dXJlRGF0ZSwgZ2FEaSwgZ2FEZW4pO1xuXG4gICAgICAgICAgICAvLyBGaWx0ZXIgdG8gb25seSBpbmNsdWRlIHRyYWlucyB0aGF0IGhhdmVuJ3QgZGVwYXJ0ZWQgb3IgYXJlIGluIG9wZXJhdGlvblxuICAgICAgICAgICAgTGlzdDxMaWNoVHJpbmhUYXU+IGZpbHRlcmVkTGljaFRyaW5oTGlzdCA9IGFsbExpY2hUcmluaExpc3Quc3RyZWFtKClcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihsaWNoVHJpbmggLT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgVHJhbmdUaGFpIHRyYW5nVGhhaSA9IGxpY2hUcmluaC5nZXRUcmFuZ1RoYWkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cmFuZ1RoYWkgPT0gVHJhbmdUaGFpLkNIVUFfS0hPSV9IQU5IIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5nVGhhaSA9PSBUcmFuZ1RoYWkuSE9BVF9ET05HO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuY29sbGVjdChDb2xsZWN0b3JzLnRvTGlzdCgpKTtcblxuICAgICAgICAgICAgaWYgKGZpbHRlcmVkTGljaFRyaW5oTGlzdC5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyh0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJLaMO0bmcgdMOsbSB0aOG6pXkgbOG7i2NoIHRyw6xuaCB0w6B1IHBow7kgaOG7o3AgxJFhbmcgaG/huqF0IMSR4buZbmcgaG/hurdjIGNoxrBhIGto4bufaSBow6BuaCB2w6BvIG5nw6B5IFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVwYXJ0dXJlRGF0ZUZpZWxkLmdldFRleHQoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiVGjDtG5nIGLDoW9cIiwgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuLi4uXG5cbiAgICAgICAgICAgIC8vIENyZWF0ZSB0cmFpbiBjYXJkcyBvbmx5IGZvciBmaWx0ZXJlZCBzY2hlZHVsZXNcbiAgICAgICAgICAgIGZvciAoTGljaFRyaW5oVGF1IGxpY2hUcmluaCA6IGZpbHRlcmVkTGljaFRyaW5oTGlzdCkge1xuICAgICAgICAgICAgICAgIC8vIEdldCB0cmFpbiBvYmplY3RcbiAgICAgICAgICAgICAgICBUYXUgdGF1ID0gdGF1REFPLmdldFRhdUJ5TGljaFRyaW5oVGF1KGxpY2hUcmluaCk7XG5cbiAgICAgICAgICAgICAgICAvLyBGb3JtYXQgZGVwYXJ0dXJlIHRpbWVcbiAgICAgICAgICAgICAgICBEYXRlVGltZUZvcm1hdHRlciB0aW1lRm9ybWF0dGVyID0gRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKFwiSEg6bW1cIik7XG4gICAgICAgICAgICAgICAgU3RyaW5nIGRlcGFydFRpbWUgPSBsaWNoVHJpbmguZ2V0R2lvRGkoKS5mb3JtYXQodGltZUZvcm1hdHRlcik7XG5cbiAgICAgICAgICAgICAgICAvLyBGb3JtYXQgZGF0ZVxuICAgICAgICAgICAgICAgIERhdGVUaW1lRm9ybWF0dGVyIGRhdGVGb3JtYXR0ZXIgPSBEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oXCJkZC9NTVwiKTtcbiAgICAgICAgICAgICAgICBTdHJpbmcgZGVwYXJ0RGF0ZSA9IGxpY2hUcmluaC5nZXROZ2F5RGkoKS5mb3JtYXQoZGF0ZUZvcm1hdHRlcik7XG5cbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgZm9ybWF0dGVkIHRpbWVzIGZvciBkaXNwbGF5XG4gICAgICAgICAgICAgICAgU3RyaW5nIGRlcGFydFRpbWVGb3JtYXR0ZWQgPSBkZXBhcnREYXRlICsgXCIgXCIgKyBkZXBhcnRUaW1lO1xuXG4gICAgICAgICAgICAgICAgLy8gR2V0IGF2YWlsYWJsZSBzZWF0c1xuICAgICAgICAgICAgICAgIGxvbmcgYXZhaWxhYmxlU2VhdHMgPSBsaWNoVHJpbmhUYXVEQU8uZ2V0QXZhaWxhYmxlU2VhdHNCeVNjaGVkdWxlKGxpY2hUcmluaC5nZXRNYUxpY2goKSk7XG5cbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgdHJhaW4gY2FyZCB3aXRoIHN0YXR1cyBpbmRpY2F0b3JcbiAgICAgICAgICAgICAgICBKUGFuZWwgdHJhaW5DYXJkID0gY3JlYXRlVHJhaW5DYXJkKFxuICAgICAgICAgICAgICAgICAgICAgICAgdGF1LmdldE1hVGF1KCksXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXBhcnRUaW1lRm9ybWF0dGVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXZhaWxhYmxlU2VhdHMsXG4gICAgICAgICAgICAgICAgICAgICAgICBmYWxzZSwgLy8gSW5pdGlhbGx5IG5vdCBzZWxlY3RlZFxuICAgICAgICAgICAgICAgICAgICAgICAgbGljaFRyaW5oLmdldFRyYW5nVGhhaSgpLCAgLy8gUGFzcyB0aGUgc3RhdHVzIHRvIHBvc3NpYmx5IGRpc3BsYXkgaXRcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpY2hUcmluaC5nZXRNYUxpY2goKSAgICAgIC8vIFN0b3JlIHNjaGVkdWxlIElEXG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIHRyYWluc1BhbmVsLmFkZCh0cmFpbkNhcmQpO1xuICAgICAgICAgICAgICAgIHRyYWluc1BhbmVsLmFkZChCb3guY3JlYXRlSG9yaXpvbnRhbFN0cnV0KDEwKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIENsZWFyIGNhciBwYW5lbCBhbmQgdXBkYXRlIGhlYWRlclxuICAgICAgICAgICAgbG9hZFRyYWluQ2FycyhcIlwiKTsgLy8gRW1wdHkgdHJhaW4gSUQgdG8gc2hvdyBwbGFjZWhvbGRlclxuICAgICAgICAgICAgc2VhdGluZ1NlY3Rpb25MYWJlbC5zZXRUZXh0KFwiVG9hOiBDaMawYSBjaOG7jW5cIik7XG5cbiAgICAgICAgICAgIC8vIFVwZGF0ZSBoZWFkZXJcbiAgICAgICAgICAgIHVwZGF0ZUhlYWRlckluZm8oZ2FEaSwgZ2FEZW4sIGRlcGFydHVyZURhdGVGaWVsZC5nZXRUZXh0KCkpO1xuXG4gICAgICAgICAgICAvLyBSZWZyZXNoIFVJXG4gICAgICAgICAgICB0cmFpbnNQYW5lbC5yZXZhbGlkYXRlKCk7XG4gICAgICAgICAgICB0cmFpbnNQYW5lbC5yZXBhaW50KCk7XG5cbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIlNlYXJjaCBjb21wbGV0ZWQsIFwiICsgZmlsdGVyZWRMaWNoVHJpbmhMaXN0LnNpemUoKSArIFwiIHRyYWlucyBmb3VuZFwiKTtcblxuICAgICAgICB9IGNhdGNoIChSZW1vdGVFeGNlcHRpb24gZXgpIHtcbiAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIFwiTOG7l2kga+G6v3QgbuG7kWkgxJHhur9uIG3DoXkgY2jhu6c6IFwiICsgZXguZ2V0TWVzc2FnZSgpLFxuICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0UpO1xuICAgICAgICAgICAgZXgucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBleCkge1xuICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2codGhpcyxcbiAgICAgICAgICAgICAgICAgICAgXCJM4buXaSB0w6xtIGtp4bq/bTogXCIgKyBleC5nZXRNZXNzYWdlKCksXG4gICAgICAgICAgICAgICAgICAgIFwiTOG7l2lcIiwgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRSk7XG4gICAgICAgICAgICBleC5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBoZWFkZXIgaW5mb3JtYXRpb24gd2l0aCByb3V0ZSBkZXRhaWxzXG4gICAgICovXG4gICAgcHJpdmF0ZSB2b2lkIHVwZGF0ZUhlYWRlckluZm8oU3RyaW5nIGZyb20sIFN0cmluZyB0bywgU3RyaW5nIGRhdGUpIHtcbiAgICAgICAgLy8gRmluZCB0aGUgaGVhZGVyIGxhYmVsIGFuZCB1cGRhdGUgaXRcbiAgICAgICAgQ29udGFpbmVyIGNvbnRlbnRQYW5lID0gZ2V0Q29udGVudFBhbmUoKTtcbiAgICAgICAgaWYgKGNvbnRlbnRQYW5lIGluc3RhbmNlb2YgSlBhbmVsKSB7XG4gICAgICAgICAgICBDb21wb25lbnRbXSBjb21wb25lbnRzID0gKChKUGFuZWwpIGNvbnRlbnRQYW5lKS5nZXRDb21wb25lbnRzKCk7XG4gICAgICAgICAgICBmb3IgKENvbXBvbmVudCBjb21wIDogY29tcG9uZW50cykge1xuICAgICAgICAgICAgICAgIGlmIChjb21wIGluc3RhbmNlb2YgSlBhbmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZUhlYWRlckluUGFuZWwoKEpQYW5lbCljb21wLCBmcm9tLCB0bywgZGF0ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuLi4uXG4gICAgICAgIGNoZWNrb3V0QnV0dG9uLmFkZEFjdGlvbkxpc3RlbmVyKGUgLT4ge1xuICAgICAgICAgICAgaWYgKGNhcnRJdGVtcy5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgICAgIFRyYWluVGlja2V0Qm9va2luZ1N5c3RlbS50aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJHaeG7jyB2w6kgdHLhu5FuZy4gVnVpIGzDsm5nIGNo4buNbiB2w6kgdHLGsOG7m2Mga2hpIHRoYW5oIHRvw6FuLlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJUaMO0bmcgYsOhb1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBDcmVhdGUgYSBtYXAgb2Ygc2VhdCBJRHMgdG8gc2NoZWR1bGUgSURzXG4gICAgICAgICAgICBNYXA8U3RyaW5nLCBTdHJpbmc+IHRpY2tldHNUb0NoZWNrb3V0ID0gbmV3IEhhc2hNYXA8PigpO1xuICAgICAgICAgICAgZm9yIChUaWNrZXRJdGVtIGl0ZW0gOiBjYXJ0SXRlbXMpIHtcbiAgICAgICAgICAgICAgICB0aWNrZXRzVG9DaGVja291dC5wdXQoaXRlbS5zZWF0SWQsIGN1cnJlbnRNYUxpY2gpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBPcGVuIGNoZWNrb3V0IHNjcmVlbiB3aXRoIG9ubHkgdGhlIG5lY2Vzc2FyeSBpZGVudGlmaWVycyBhbmQgZW1wbG95ZWUgaW5mb3JtYXRpb25cbiAgICAgICAgICAgIFRoYW5oVG9hbkdVSSBjaGVja291dFNjcmVlbiA9IG51bGw7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNoZWNrb3V0U2NyZWVuID0gbmV3IFRoYW5oVG9hbkdVSSh0aWNrZXRzVG9DaGVja291dCwgbmhhblZpZW4pO1xuICAgICAgICAgICAgfSBjYXRjaCAoUmVtb3RlRXhjZXB0aW9uIGV4KSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFeGNlcHRpb24oZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2hlY2tvdXRTY3JlZW4uc2V0VmlzaWJsZSh0cnVlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIE9wZW4gY2hlY2tvdXQgc2NyZWVuXG4uLi5cblxuXG5cblxuICAgIC8qKlxuICAgICAqIE1haW4gbWV0aG9kXG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyB2b2lkIG1haW4oU3RyaW5nW10gYXJncykge1xuICAgICAgICAvLyBTZXQgc3lzdGVtIHRpbWUgZm9yIGRlYnVnZ2luZyAtIGluIHByb2R1Y3Rpb24gdGhpcyB3b3VsZCBiZSByZW1vdmVkXG4gICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIlN5c3RlbSB0aW1lOiBcIiArIG5ldyBEYXRlKCkpO1xuICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJVc2VyOiBsdW9uZ3RhbjIwNHZpZXRcIik7XG5cbiAgICAgICAgU3dpbmdVdGlsaXRpZXMuaW52b2tlTGF0ZXIoKCkgLT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgYSBzYW1wbGUgZW1wbG95ZWUgZm9yIHRlc3RpbmdcbiAgICAgICAgICAgICAgICBOaGFuVmllbiBudiA9IG5ldyBOaGFuVmllbigpO1xuICAgICAgICAgICAgICAgIE5oYW5WaWVuREFPIG5oYW5WaWVuREFPID0gbmV3IE5oYW5WaWVuREFPSW1wbCgpO1xuICAgICAgICAgICAgICAgIG52ID0gbmhhblZpZW5EQU8uZ2V0bmhhbnZpZW5CeUlkKFwiTlYyMDI1MDQxODAwMDFcIik7XG5cbiAgICAgICAgICAgICAgICBUcmFpblRpY2tldEJvb2tpbmdTeXN0ZW0gYXBwID0gbmV3IFRyYWluVGlja2V0Qm9va2luZ1N5c3RlbShudik7XG4gICAgICAgICAgICAgICAgYXBwLnNldFZpc2libGUodHJ1ZSk7XG4gICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpIGto4bufaSDEkeG7mW5nIOG7qW5nIGThu6VuZzogXCIgKyBlLmdldE1lc3NhZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2lcIiwgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRSk7XG4gICAgICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufVxuLi4uXG4iLCJpc19lcnJvciI6ZmFsc2UsInJlcXVlc3RfaWQiOiIiLCJ0b29sX3VzZV9pZCI6InRvb2x1XzAxTmRHQlBtUWhmdVpNU21SSzJSRG5raCJ9fSx7ImlkIjoyLCJ0eXBlIjo0LCJpZGVfc3RhdGVfbm9kZSI6eyJ3b3Jrc3BhY2VGb2xkZXJzIjpbeyJyZXBvc2l0b3J5Um9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIiwiZm9sZGVyUm9vdCI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIn1dLCJ3b3Jrc3BhY2VGb2xkZXJzVW5jaGFuZ2VkIjpmYWxzZSwiY3VycmVudFRlcm1pbmFsIjp7InRlcm1pbmFsSWQiOjIyLCJjdXJyZW50V29ya2luZ0RpcmVjdG9yeSI6IkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nIn19fV0sInJlc3BvbnNlX3RleHQiOiJOb3csIGxldCdzIGNyZWF0ZSB0aGUgbW9kaWZpZWQgdmVyc2lvbiBvZiBUcmFpblRpY2tldEJvb2tpbmdTeXN0ZW0gYXMgYSBKUGFuZWw6XG5cbkknbSBzb3JyeS4gSSB0cmllZCB0byBjYWxsIGEgdG9vbCwgYnV0IHByb3ZpZGVkIHRvbyBsYXJnZSBvZiBhbiBpbnB1dC4gSG93IHdvdWxkIHlvdSBsaWtlIHRvIHByb2NlZWQ/XG4iLCJ3b3Jrc3BhY2VfZmlsZV9jaHVua3MiOltdfV0sImZlZWRiYWNrU3RhdGVzIjp7InRlbXAtZmUtMzA3YTM5YjctMDEzYy00ZDE4LWI3NDItODY0MGY1ZjAwNjFhIjp7InNlbGVjdGVkUmF0aW5nIjowLCJmZWVkYmFja05vdGUiOiIifSwidGVtcC1mZS0yYzg4MmE3ZS0yNjZkLTRiNDMtOThmMS02NzZmYmRlOGM4ZDciOnsic2VsZWN0ZWRSYXRpbmciOjAsImZlZWRiYWNrTm90ZSI6IiJ9LCJ0ZW1wLWZlLTM4Y2IwNzJmLWU5ZGEtNGUyMC05N2YyLWU2YTZmOWRkZjM5NSI6eyJzZWxlY3RlZFJhdGluZyI6MCwiZmVlZGJhY2tOb3RlIjoiIn0sInRlbXAtZmUtODk5NTRiMjMtMjgzOC00ZDg5LWE5NGYtODAyNTEzNGNkODhiIjp7InNlbGVjdGVkUmF0aW5nIjowLCJmZWVkYmFja05vdGUiOiIifSwidGVtcC1mZS1hMmU0MmYyYS1lZDBmLTRlMjQtYWVkMy01OTVhNGZjN2ZlZjMiOnsic2VsZWN0ZWRSYXRpbmciOjAsImZlZWRiYWNrTm90ZSI6IiJ9LCJ0ZW1wLWZlLWIwOWY2OGQ3LWIyZjktNDhkMS1hOWYxLWUzMWFkNDRkMDM1NSI6eyJzZWxlY3RlZFJhdGluZyI6MCwiZmVlZGJhY2tOb3RlIjoiIn19LCJ0b29sVXNlU3RhdGVzIjp7IjQyZmUwN2I1LWFiOGItNGQ3ZS04NjY2LTIyZGRjYjhiYjEwMzt0b29sdV8wMTJ4OGo5V0xhc3J2dFBaWVVKckdjeTUiOnsicGhhc2UiOjUsInJlc3VsdCI6eyJ0ZXh0IjoiVGhlIGZvbGxvd2luZyBjb2RlIHNlY3Rpb25zIHdlcmUgcmV0cmlldmVkOlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9ndWlDbGllbnQvTGljaFRyaW5oVGF1UGFuZWwuamF2YVxucGFja2FnZSBndWlDbGllbnQ7XG5cbmltcG9ydCBjb20udG9lZHRlci5jYWxlbmRhci5KRGF0ZUNob29zZXI7XG5pbXBvcnQgZGFvLkxpY2hUcmluaFRhdURBTztcbmltcG9ydCBkYW8uVGF1REFPO1xuaW1wb3J0IG1vZGVsLkxpY2hUcmluaFRhdTtcbmltcG9ydCBtb2RlbC5UYXU7XG5pbXBvcnQgbW9kZWwuVHJhbmdUaGFpO1xuaW1wb3J0IHNlcnZpY2UuQUlUcmF2ZWxUaW1lUHJlZGljdG9yO1xuaW1wb3J0IHNlcnZpY2UuU2NoZWR1bGVTdGF0dXNNYW5hZ2VyO1xuLi4uXG5cbiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2dnZXIgTE9HR0VSID0gTG9nZ2VyLmdldExvZ2dlcihMaWNoVHJpbmhUYXVQYW5lbC5jbGFzcy5nZXROYW1lKCkpO1xuICAgIC8vIMSQ4buLYSBjaOG7iSBJUCB2w6AgcG9ydCBj4bunYSBSTUkgc2VydmVyXG4gICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgU3RyaW5nIFJNSV9TRVJWRVJfSVAgPSBcIjEyNy4wLjAuMVwiO1xuICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIGludCBSTUlfU0VSVkVSX1BPUlQgPSA5MDkwO1xuICAgIHByaXZhdGUgSlRhYmxlIHNjaGVkdWxlVGFibGU7XG4gICAgcHJpdmF0ZSBEZWZhdWx0VGFibGVNb2RlbCB0YWJsZU1vZGVsO1xuICAgIHByaXZhdGUgSkRhdGVDaG9vc2VyIGRhdGVDaG9vc2VyO1xuICAgIHByaXZhdGUgSkJ1dHRvbiBzZWFyY2hCdXR0b247XG4gICAgcHJpdmF0ZSBKQnV0dG9uIHJlZnJlc2hCdXR0b247XG4gICAgcHJpdmF0ZSBKQnV0dG9uIGFkZEJ1dHRvbjtcbiAgICBwcml2YXRlIEpCdXR0b24gZWRpdEJ1dHRvbjtcbiAgICBwcml2YXRlIEpCdXR0b24gZGVsZXRlQnV0dG9uO1xuICAgIHByaXZhdGUgSkNvbWJvQm94PE9iamVjdD4gZmlsdGVyQ29tYm9Cb3g7XG4gICAgcHJpdmF0ZSBKVGFiYmVkUGFuZSB2aWV3VGFiYmVkUGFuZTsgLy8gVGFiIMSR4buDIGNodXnhu4NuIMSR4buVaSBnaeG7r2EgZOG6oW5nIGLhuqNuZyB2w6AgbOG7i2NoXG4gICAgcHJpdmF0ZSBUcmFpblNjaGVkdWxlQ2FsZW5kYXJQYW5lbCBjYWxlbmRhclBhbmVsOyAvLyBQYW5lbCBk4bqhbmcgbOG7i2NoXG4gICAgcHJpdmF0ZSBKUGFuZWwgdGFibGVWaWV3UGFuZWw7IC8vIFBhbmVsIGNo4bupYSBi4bqjbmdcbi4uLlxuXG4gICAgcHVibGljIExpY2hUcmluaFRhdVBhbmVsKCkge1xuICAgICAgICBzZXRMYXlvdXQobmV3IEJvcmRlckxheW91dCgxMCwgMTApKTtcbiAgICAgICAgc2V0Qm9yZGVyKEJvcmRlckZhY3RvcnkuY3JlYXRlRW1wdHlCb3JkZXIoMTAsIDEwLCAxMCwgMTApKTtcblxuICAgICAgICAvLyBDb25uZWN0IHRvIFJNSSBzZXJ2ZXJcbiAgICAgICAgY29ubmVjdFRvUk1JU2VydmVyKCk7XG5cbiAgICAgICAgLy8gQWRkIGNvbXBvbmVudHMgdG8gdGhlIHBhbmVsXG4gICAgICAgIGFkZChjcmVhdGVUaXRsZVBhbmVsKCksIEJvcmRlckxheW91dC5OT1JUSCk7XG4gICAgICAgIGFkZChjcmVhdGVDZW50ZXJQYW5lbCgpLCBCb3JkZXJMYXlvdXQuQ0VOVEVSKTtcblxuICAgICAgICAvLyBMb2FkIGluaXRpYWwgZGF0YVxuICAgICAgICBpZiAoaXNDb25uZWN0ZWQpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaW5pdFN0YXR1c01hbmFnZXIoKTtcbiAgICAgICAgICAgICAgICBsb2FkQWxsU2NoZWR1bGVEYXRhKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5haVByZWRpY3RvciA9IEFJVHJhdmVsVGltZVByZWRpY3Rvci5nZXRJbnN0YW5jZSgpO1xuICAgICAgICAgICAgfSBjYXRjaCAoUmVtb3RlRXhjZXB0aW9uIGV4KSB7XG4gICAgICAgICAgICAgICAgTE9HR0VSLmxvZyhMZXZlbC5TRVZFUkUsIFwiRXJyb3IgbG9hZGluZyBzY2hlZHVsZSBkYXRhXCIsIGV4KTtcbiAgICAgICAgICAgICAgICBzaG93RXJyb3JNZXNzYWdlKFwiS2jDtG5nIHRo4buDIHThuqNpIGThu68gbGnhu4d1IGzhu4tjaCB0csOsbmhcIiwgZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2hvd0Vycm9yTWVzc2FnZShcIktow7RuZyB0aOG7gyBr4bq/dCBu4buRaSDEkeG6v24gbcOheSBjaOG7p1wiLCBudWxsKTtcbiAgICAgICAgfVxuICAgICAgICBsb2FkRGF0YUluQmFja2dyb3VuZCgpO1xuICAgIH1cbi4uLlxuXG4gICAgICAgICAgICBAT3ZlcnJpZGVcbiAgICAgICAgICAgIHByb3RlY3RlZCB2b2lkIGRvbmUoKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgYm9vbGVhbiBjb25uZWN0ZWQgPSBnZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbm5lY3RlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gWMOzYSB0aMO0bmcgYsOhbyBcIsSRYW5nIHThuqNpXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlTW9kZWwuc2V0Um93Q291bnQoMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBU4bqjaSBk4buvIGxp4buHdSBs4buLY2ggdHLDrG5oXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2FkQWxsU2NoZWR1bGVEYXRhKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEto4bufaSB04bqhbyB0csOsbmggcXXhuqNuIGzDvSB0cuG6oW5nIHRow6FpXG4gICAgICAgICAgICAgICAgICAgICAgICBpbml0U3RhdHVzTWFuYWdlcigpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVNb2RlbC5zZXRSb3dDb3VudCgwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlTW9kZWwuYWRkUm93KG5ldyBPYmplY3RbXXtcIktow7RuZyB0aOG7gyBr4bq/dCBu4buRaSDEkeG6v24gbcOheSBjaOG7p1wiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwifSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaG93RXJyb3JNZXNzYWdlKFwiS2jDtG5nIHRo4buDIGvhur90IG7hu5FpIMSR4bq/biBtw6F5IGNo4bunXCIsIG51bGwpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICAgICAgTE9HR0VSLmxvZyhMZXZlbC5TRVZFUkUsIFwiRXJyb3IgbG9hZGluZyBzY2hlZHVsZSBkYXRhXCIsIGUpO1xuICAgICAgICAgICAgICAgICAgICB0YWJsZU1vZGVsLnNldFJvd0NvdW50KDApO1xuICAgICAgICAgICAgICAgICAgICB0YWJsZU1vZGVsLmFkZFJvdyhuZXcgT2JqZWN0W117XCJM4buXaTogXCIgKyBlLmdldE1lc3NhZ2UoKSwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIn0pO1xuICAgICAgICAgICAgICAgICAgICBzaG93RXJyb3JNZXNzYWdlKFwiS2jDtG5nIHRo4buDIHThuqNpIGThu68gbGnhu4d1IGzhu4tjaCB0csOsbmhcIiwgZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHdvcmtlci5leGVjdXRlKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSB2b2lkIGluaXRTdGF0dXNNYW5hZ2VyKCkge1xuICAgICAgICBpZiAoaXNDb25uZWN0ZWQgJiYgbGljaFRyaW5oVGF1REFPICE9IG51bGwpIHtcbiAgICAgICAgICAgIC8vIFThuqFvIGNhbGxiYWNrIGzDoG0gbeG7m2kgZOG7ryBsaeG7h3VcbiAgICAgICAgICAgIFJ1bm5hYmxlIHJlZnJlc2hDYWxsYmFjayA9IHRoaXM6OnJlZnJlc2hEYXRhQWZ0ZXJVcGRhdGU7XG5cbiAgICAgICAgICAgIC8vIEto4bufaSB04bqhbyB0csOsbmggcXXhuqNuIGzDvSB0cuG6oW5nIHRow6FpXG4gICAgICAgICAgICBzdGF0dXNNYW5hZ2VyID0gbmV3IFNjaGVkdWxlU3RhdHVzTWFuYWdlcihsaWNoVHJpbmhUYXVEQU8sIHJlZnJlc2hDYWxsYmFjayk7XG5cbiAgICAgICAgICAgIExPR0dFUi5pbmZvKFwixJDDoyBraOG7n2kgdOG6oW8gdHLDrG5oIHF14bqjbiBsw70gY+G6rXAgbmjhuq10IHRy4bqhbmcgdGjDoWkgdOG7sSDEkeG7mW5nXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHByaXZhdGUgdm9pZCByZWZyZXNoRGF0YUFmdGVyVXBkYXRlKCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gTMOgbSBt4bubaSBk4buvIGxp4buHdSB0csOqbiBnaWFvIGRp4buHbiBtw6Aga2jDtG5nIGfhu41pIGPhuq1wIG5o4bqtdCB0cuG6oW5nIHRow6FpIGzhuqFpXG4gICAgICAgICAgICBsb2FkRGF0YVdpdGhvdXRTdGF0dXNDaGVjaygpO1xuXG4gICAgICAgICAgICAvLyBIaeG7g24gdGjhu4sgdGjDtG5nIGLDoW8gbmjhu48gKHTDuXkgY2jhu41uKVxuICAgICAgICAgICAgc2hvd05vdGlmaWNhdGlvbihcIsSQw6MgY+G6rXAgbmjhuq10IHRy4bqhbmcgdGjDoWkgY8OhYyBs4buLY2ggdHLDrG5oIHTDoHVcIik7XG5cbiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGV4KSB7XG4gICAgICAgICAgICBMT0dHRVIubG9nKExldmVsLlNFVkVSRSwgXCJM4buXaSBraGkgbMOgbSBt4bubaSBk4buvIGxp4buHdSBzYXUga2hpIGPhuq1wIG5o4bqtdCB0cuG6oW5nIHRow6FpXCIsIGV4KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgdm9pZCBsb2FkRGF0YVdpdGhvdXRTdGF0dXNDaGVjaygpIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xuICAgICAgICBpZiAoIWlzQ29ubmVjdGVkIHx8IGxpY2hUcmluaFRhdURBTyA9PSBudWxsKSB7XG4gICAgICAgICAgICBjb25uZWN0VG9STUlTZXJ2ZXIoKTtcbiAgICAgICAgICAgIGlmICghaXNDb25uZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUmVtb3RlRXhjZXB0aW9uKFwiTm90IGNvbm5lY3RlZCB0byBSTUkgc2VydmVyXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGFibGVNb2RlbC5zZXRSb3dDb3VudCgwKTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgTGlzdDxMaWNoVHJpbmhUYXU+IHNjaGVkdWxlcyA9IGxpY2hUcmluaFRhdURBTy5nZXRBbGxMaXN0KCk7XG5cbiAgICAgICAgICAgIGlmIChzY2hlZHVsZXMgPT0gbnVsbCB8fCBzY2hlZHVsZXMuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgTE9HR0VSLmluZm8oXCJLaMO0bmcgY8OzIGzhu4tjaCB0csOsbmggbsOgbyDEkeG7gyBoaeG7g24gdGjhu4suXCIpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gTOG7jWMgdsOgIGhp4buDbiB0aOG7iyBk4buvIGxp4buHdSB0aGVvIGLhu5kgbOG7jWMgaGnhu4duIHThuqFpXG4gICAgICAgICAgICBTdHJpbmcgZmlsdGVyT3B0aW9uID0gZmlsdGVyQ29tYm9Cb3guZ2V0U2VsZWN0ZWRJdGVtKCkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIGZvciAoTGljaFRyaW5oVGF1IHNjaGVkdWxlIDogc2NoZWR1bGVzKSB7XG4gICAgICAgICAgICAgICAgaWYgKG1hdGNoZXNGaWx0ZXIoc2NoZWR1bGUsIGZpbHRlck9wdGlvbikpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFibGVNb2RlbC5hZGRSb3coY3JlYXRlVGFibGVSb3coc2NoZWR1bGUpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4uLi5cblxuICAgIHByaXZhdGUgSlBhbmVsIGNyZWF0ZVRpdGxlUGFuZWwoKSB7XG4gICAgICAgIEpQYW5lbCBwYW5lbCA9IG5ldyBKUGFuZWwobmV3IEJvcmRlckxheW91dCgpKTtcblxuICAgICAgICBKTGFiZWwgdGl0bGVMYWJlbCA9IG5ldyBKTGFiZWwoXCJRVeG6ok4gTMOdIEzhu4pDSCBUUsOMTkggVMOAVVwiLCBKTGFiZWwuQ0VOVEVSKTtcbiAgICAgICAgdGl0bGVMYWJlbC5zZXRGb250KG5ldyBGb250KFwiQXJpYWxcIiwgRm9udC5CT0xELCAyMCkpO1xuICAgICAgICB0aXRsZUxhYmVsLnNldEZvcmVncm91bmQobmV3IENvbG9yKDQxLCAxMjgsIDE4NSkpO1xuICAgICAgICB0aXRsZUxhYmVsLnNldEJvcmRlcihCb3JkZXJGYWN0b3J5LmNyZWF0ZUVtcHR5Qm9yZGVyKDAsIDAsIDEwLCAwKSk7XG5cbiAgICAgICAgcGFuZWwuYWRkKHRpdGxlTGFiZWwsIEJvcmRlckxheW91dC5DRU5URVIpO1xuICAgICAgICByZXR1cm4gcGFuZWw7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBKUGFuZWwgY3JlYXRlQ2VudGVyUGFuZWwoKSB7XG4gICAgICAgIEpQYW5lbCBwYW5lbCA9IG5ldyBKUGFuZWwobmV3IEJvcmRlckxheW91dCgxMCwgMTApKTtcblxuICAgICAgICBwYW5lbC5hZGQoY3JlYXRlU2VhcmNoUGFuZWwoKSwgQm9yZGVyTGF5b3V0Lk5PUlRIKTtcblxuICAgICAgICAvLyBU4bqhbyBUYWJiZWRQYW5lIMSR4buDIGNo4bupYSBj4bqjIGNo4bq/IMSR4buZIHhlbSBi4bqjbmcgdsOgIGzhu4tjaFxuICAgICAgICB2aWV3VGFiYmVkUGFuZSA9IG5ldyBKVGFiYmVkUGFuZSgpO1xuXG4gICAgICAgIC8vIFThuqFvIHBhbmVsIGNo4bq/IMSR4buZIHhlbSBi4bqjbmdcbiAgICAgICAgdGFibGVWaWV3UGFuZWwgPSBuZXcgSlBhbmVsKG5ldyBCb3JkZXJMYXlvdXQoKSk7XG4gICAgICAgIHRhYmxlVmlld1BhbmVsLmFkZChjcmVhdGVUYWJsZVBhbmVsKCksIEJvcmRlckxheW91dC5DRU5URVIpO1xuICAgICAgICBjYWxlbmRhclBhbmVsID0gbmV3IFRyYWluU2NoZWR1bGVDYWxlbmRhclBhbmVsKGlzQ29ubmVjdGVkID8gbGljaFRyaW5oVGF1REFPIDogbnVsbCk7XG4gICAgICAgIC8vIE7hur91IMSRw6Mga+G6v3QgbuG7kWksIHThuqFvIHBhbmVsIGzhu4tjaFxuICAgICAgICBpZiAoaXNDb25uZWN0ZWQgJiYgbGljaFRyaW5oVGF1REFPICE9IG51bGwpIHtcbiAgICAgICAgICAgIC8vIFRoaeG6v3QgbOG6rXAgbGlzdGVuZXIgY2hvIHPhu7Ega2nhu4duIGNsaWNrIG5nw6B5XG4gICAgICAgICAgICBjYWxlbmRhclBhbmVsLnNldERheVBhbmVsQ2xpY2tMaXN0ZW5lcigoZGF0ZSwgc2NoZWR1bGVzKSAtPiB7XG4gICAgICAgICAgICAgICAgLy8gSGnhu4NuIHRo4buLIGRhbmggc8OhY2ggbOG7i2NoIHRyw6xuaCBj4bunYSBuZ8OgeSDEkcaw4bujYyBjaOG7jW5cbiAgICAgICAgICAgICAgICBpZiAoIXNjaGVkdWxlcy5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgICAgICAgICAgc2hvd1NjaGVkdWxlRGV0YWlsc0RpYWxvZyhkYXRlLCBzY2hlZHVsZXMpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJLaMO0bmcgY8OzIGzhu4tjaCB0csOsbmggbsOgbyBjaG8gbmfDoHkgXCIgKyBkYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiVGjDtG5nIHRpblwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLklORk9STUFUSU9OX01FU1NBR0UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuLi4uXG5cbiAgICAgICAgLy8gVOG6oW8gbeG7mXQgbOG7jWMgdsSDbiBi4bqjbiDEkeG7gyB44butIGzDvSBz4buxIGtp4buHbiBiw6BuIHBow61tIHRoYXkgdsOsIGTDuW5nIERvY3VtZW50TGlzdGVuZXJcbiAgICAgICAgZWRpdG9yLmFkZEtleUxpc3RlbmVyKG5ldyBLZXlBZGFwdGVyKCkge1xuICAgICAgICAgICAgQE92ZXJyaWRlXG4gICAgICAgICAgICBwdWJsaWMgdm9pZCBrZXlSZWxlYXNlZChLZXlFdmVudCBlKSB7XG4gICAgICAgICAgICAgICAgLy8gQuG7jyBxdWEgY8OhYyBwaMOtbSDEkeG6t2MgYmnhu4d0XG4gICAgICAgICAgICAgICAgaWYgKGUuZ2V0S2V5Q29kZSgpID09IEtleUV2ZW50LlZLX0VOVEVSIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICBlLmdldEtleUNvZGUoKSA9PSBLZXlFdmVudC5WS19FU0NBUEUgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuZ2V0S2V5Q29kZSgpID09IEtleUV2ZW50LlZLX1VQIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICBlLmdldEtleUNvZGUoKSA9PSBLZXlFdmVudC5WS19ET1dOKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBM4bqleSB2xINuIGLhuqNuIGhp4buHbiB04bqhaSB0cm9uZyBlZGl0b3JcbiAgICAgICAgICAgICAgICBTdHJpbmcgdGV4dCA9IGVkaXRvci5nZXRUZXh0KCk7XG5cbiAgICAgICAgICAgICAgICAvLyBLaMO0bmcgdGjhu7FjIGhp4buHbiBs4buNYyBu4bq/dSB2xINuIGLhuqNuIHF1w6Egbmfhuq9uXG4gICAgICAgICAgICAgICAgaWYgKHRleHQubGVuZ3RoKCkgPCAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBT4butIGThu6VuZyBTd2luZ1V0aWxpdGllcy5pbnZva2VMYXRlciDEkeG7gyB0csOhbmggbOG7l2kga2hpIHPhu61hIMSR4buVaSBtw7QgaMOsbmggdHJvbmcgbMO6YyB44butIGzDvSBz4buxIGtp4buHblxuICAgICAgICAgICAgICAgIFN3aW5nVXRpbGl0aWVzLmludm9rZUxhdGVyKCgpIC0+IHtcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVySXRlbXMoY29tYm9Cb3gsIHRleHQsIG9yaWdpbmFsSXRlbXMpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4uLi5cblxuICAgICAgICAgICAgICAgICAgICAvLyDDgXAgZOG7pW5nIG1vZGVsIG3hu5tpXG4gICAgICAgICAgICAgICAgICAgIGNvbWJvQm94LnNldE1vZGVsKG1vZGVsKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyDEkOG6t3QgbOG6oWkgdsSDbiBi4bqjblxuICAgICAgICAgICAgICAgICAgICBjb21ib0JveC5nZXRFZGl0b3IoKS5zZXRJdGVtKHRleHQpO1xuICAgICAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0Q2FyZXRQb3NpdGlvbih0ZXh0Lmxlbmd0aCgpKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBIaeG7g24gdGjhu4sgbOG6oWkgcG9wdXAgbuG6v3UgdHLGsOG7m2MgxJHDsyDEkcOjIG3hu58gdsOgIGPDsyBr4bq/dCBxdeG6o1xuICAgICAgICAgICAgICAgICAgICBpZiAoKHdhc1Zpc2libGUgfHwgIXRleHQuaXNFbXB0eSgpKSAmJiBtb2RlbC5nZXRTaXplKCkgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb21ib0JveC5zaG93UG9wdXAoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHZvaWQgc2VhcmNoU2NoZWR1bGVzKExvY2FsRGF0ZSBkYXRlLCBTdHJpbmcgZ2FEaSwgU3RyaW5nIGdhRGVuLCBTdHJpbmcgZ2lvRGkpIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xuICAgICAgICBpZiAoIWlzQ29ubmVjdGVkIHx8IGxpY2hUcmluaFRhdURBTyA9PSBudWxsKSB7XG4gICAgICAgICAgICByZWNvbm5lY3RBbmRMb2FkRGF0YShkYXRlKTtcbiAgICAgICAgICAgIGlmICghaXNDb25uZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUmVtb3RlRXhjZXB0aW9uKFwiS2jDtG5nIHRo4buDIGvhur90IG7hu5FpIMSR4bq/biBzZXJ2ZXJcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0YWJsZU1vZGVsLnNldFJvd0NvdW50KDApO1xuICAgICAgICBMaXN0PExpY2hUcmluaFRhdT4gc2NoZWR1bGVzO1xuLi4uXG5cbiAgICAgICAgLy8gTsO6dCB0aMOqbSBuaGnhu4F1IGzhu4tjaCB0csOsbmggdOG7sSDEkeG7mW5nXG4gICAgICAgIEpCdXR0b24gYmF0Y2hBZGRCdXR0b24gPSBuZXcgSkJ1dHRvbihcIlThuqFvIE5oaeG7gXUgTOG7i2NoIFRyw6xuaFwiKTtcbiAgICAgICAgYmF0Y2hBZGRCdXR0b24uc2V0SWNvbihjcmVhdGVCYXRjaEljb24oMTYsIDE2KSk7XG4gICAgICAgIGJhdGNoQWRkQnV0dG9uLmFkZEFjdGlvbkxpc3RlbmVyKGUgLT4gY3JlYXRlQmF0Y2hTY2hlZHVsZXMoKSk7XG5cbiAgICAgICAgZWRpdEJ1dHRvbiA9IG5ldyBKQnV0dG9uKFwiQ2jhu4luaCBT4butYVwiKTtcbiAgICAgICAgZWRpdEJ1dHRvbi5zZXRJY29uKGNyZWF0ZUVkaXRJY29uKDE2LCAxNikpO1xuICAgICAgICBlZGl0QnV0dG9uLmFkZEFjdGlvbkxpc3RlbmVyKGUgLT4gZWRpdFNjaGVkdWxlKCkpO1xuXG4gICAgICAgIGRlbGV0ZUJ1dHRvbiA9IG5ldyBKQnV0dG9uKFwiWMOzYVwiKTtcbiAgICAgICAgZGVsZXRlQnV0dG9uLnNldEljb24oY3JlYXRlRGVsZXRlSWNvbigxNiwgMTYpKTtcbiAgICAgICAgZGVsZXRlQnV0dG9uLmFkZEFjdGlvbkxpc3RlbmVyKGUgLT4gZGVsZXRlU2NoZWR1bGUoKSk7XG5cbiAgICAgICAgLy8gQWRkIGJ1dHRvbnMgdG8gcGFuZWxcbiAgICAgICAgcGFuZWwuYWRkKGNoYXRib3RCdXR0b24pO1xuICAgICAgICBwYW5lbC5hZGQocHJlZGljdEJ1dHRvbik7XG4gICAgICAgIHBhbmVsLmFkZChhZGRCdXR0b24pO1xuICAgICAgICBwYW5lbC5hZGQoYmF0Y2hBZGRCdXR0b24pO1xuICAgICAgICBwYW5lbC5hZGQoZWRpdEJ1dHRvbik7XG4gICAgICAgIHBhbmVsLmFkZChkZWxldGVCdXR0b24pO1xuICAgICAgICByZXR1cm4gcGFuZWw7XG4gICAgfVxuLi4uXG5cbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIsSQYW5nIHTDrG0ga2nhur9tIGNobyBuZ8OgeTogXCIgKyBsb2NhbERhdGUpO1xuXG4gICAgICAgICAgICBpZiAoaXNDb25uZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICAvLyBO4bq/dSDEkWFuZyDhu58gY2jhur8gxJHhu5kgeGVtIGLhuqNuZywgdOG6o2kgZOG7ryBsaeG7h3UgdsOgbyBi4bqjbmdcbiAgICAgICAgICAgICAgICBpZiAodmlld1RhYmJlZFBhbmUuZ2V0U2VsZWN0ZWRJbmRleCgpID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbG9hZFNjaGVkdWxlRGF0YShsb2NhbERhdGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBO4bq/dSDEkWFuZyDhu58gY2jhur8gxJHhu5kgeGVtIGzhu4tjaCwgY2h1eeG7g24gxJHhur9uIG5nw6B5IMSRxrDhu6NjIGNo4buNblxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHZpZXdUYWJiZWRQYW5lLmdldFNlbGVjdGVkSW5kZXgoKSA9PSAxICYmIGNhbGVuZGFyUGFuZWwgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBjYWxlbmRhclBhbmVsLnNldFNlbGVjdGVkRGF0ZShsb2NhbERhdGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVjb25uZWN0QW5kTG9hZERhdGEobG9jYWxEYXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGV4KSB7XG4gICAgICAgICAgICBMT0dHRVIubG9nKExldmVsLldBUk5JTkcsIFwiSW52YWxpZCBkYXRlIHNlbGVjdGlvblwiLCBleCk7XG4gICAgICAgICAgICBzaG93RXJyb3JNZXNzYWdlKFwiVnVpIGzDsm5nIGNo4buNbiBuZ8OgeSBo4bujcCBs4buHLlwiLCBudWxsKTtcbiAgICAgICAgfSBjYXRjaCAoUmVtb3RlRXhjZXB0aW9uIGV4KSB7XG4gICAgICAgICAgICBMT0dHRVIubG9nKExldmVsLlNFVkVSRSwgXCJFcnJvciBsb2FkaW5nIHNjaGVkdWxlIGRhdGFcIiwgZXgpO1xuICAgICAgICAgICAgc2hvd0Vycm9yTWVzc2FnZShcIkzhu5dpIGtoaSB04bqjaSBk4buvIGxp4buHdVwiLCBleCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIHZvaWQgbG9hZFNjaGVkdWxlRGF0YShMb2NhbERhdGUgZGF0ZSkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgICAgIGlmICghaXNDb25uZWN0ZWQgfHwgbGljaFRyaW5oVGF1REFPID09IG51bGwpIHtcbiAgICAgICAgICAgIHJlY29ubmVjdEFuZExvYWREYXRhKGRhdGUpO1xuICAgICAgICAgICAgaWYgKCFpc0Nvbm5lY3RlZCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBSZW1vdGVFeGNlcHRpb24oXCJOb3QgY29ubmVjdGVkIHRvIFJNSSBzZXJ2ZXJcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbi4uLlxuXG4gICAgICAgIC8vIFThuqNpIGRhbmggc8OhY2ggdMOgdSB04burIFRhdURBT1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gVOG6oW8ga+G6v3QgbuG7kWkgxJHhur9uIFJNSSBzZXJ2ZXJcbiAgICAgICAgICAgIFJlZ2lzdHJ5IHJlZ2lzdHJ5ID0gTG9jYXRlUmVnaXN0cnkuZ2V0UmVnaXN0cnkoUk1JX1NFUlZFUl9JUCwgUk1JX1NFUlZFUl9QT1JUKTtcbiAgICAgICAgICAgIFRhdURBTyB0YXVEQU8gPSAoVGF1REFPKSByZWdpc3RyeS5sb29rdXAoXCJ0YXVEQU9cIik7XG5cbiAgICAgICAgICAgIC8vIEzhuqV5IGRhbmggc8OhY2ggdMOgdSB2w6AgdGjDqm0gdsOgbyBjb21ib2JveFxuICAgICAgICAgICAgTGlzdDxUYXU+IHRyYWlucyA9IHRhdURBTy5nZXRBbGxMaXN0VCgpO1xuICAgICAgICAgICAgaWYgKHRyYWlucyAhPSBudWxsICYmICF0cmFpbnMuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgRGVmYXVsdENvbWJvQm94TW9kZWw8VGF1PiBtb2RlbCA9IG5ldyBEZWZhdWx0Q29tYm9Cb3hNb2RlbDw+KCk7XG4gICAgICAgICAgICAgICAgZm9yIChUYXUgdHJhaW4gOiB0cmFpbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kZWwuYWRkRWxlbWVudCh0cmFpbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRyYWluQ29tYm9Cb3guc2V0TW9kZWwobW9kZWwpO1xuXG4gICAgICAgICAgICAgICAgLy8gSGnhu4NuIHRo4buLIHRow7RuZyB0aW4gdHV54bq/biDEkcaw4budbmcgY+G7p2EgdMOgdSDEkcaw4bujYyBjaOG7jW5cbiAgICAgICAgICAgICAgICB1cGRhdGVSb3V0ZUluZm8odHJhaW5Db21ib0JveCwgcm91dGVUZXh0RmllbGQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhiYXRjaERpYWxvZyxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiS2jDtG5nIGPDsyB0w6B1IG7DoG8gdHJvbmcgaOG7hyB0aOG7kW5nLiBWdWkgbMOybmcgdOG6oW8gdMOgdSB0csaw4bubYy5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2lcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0UpO1xuICAgICAgICAgICAgICAgIGJhdGNoRGlhbG9nLmRpc3Bvc2UoKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBleCkge1xuICAgICAgICAgICAgTE9HR0VSLmxvZyhMZXZlbC5TRVZFUkUsIFwiTOG7l2kga2hpIHThuqNpIGRhbmggc8OhY2ggdMOgdVwiLCBleCk7XG4gICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhiYXRjaERpYWxvZyxcbiAgICAgICAgICAgICAgICAgICAgXCJLaMO0bmcgdGjhu4MgdOG6o2kgZGFuaCBzw6FjaCB0w6B1OiBcIiArIGV4LmdldE1lc3NhZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgXCJM4buXaVwiLFxuICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFKTtcbiAgICAgICAgICAgIGJhdGNoRGlhbG9nLmRpc3Bvc2UoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEPhuq1wIG5o4bqtdCB0aMO0bmcgdGluIHR1eeG6v24gxJHGsOG7nW5nIGtoaSBjaOG7jW4gdMOgdSBraMOhY1xuICAgICAgICB0cmFpbkNvbWJvQm94LmFkZEFjdGlvbkxpc3RlbmVyKGUgLT4ge1xuICAgICAgICAgICAgdXBkYXRlUm91dGVJbmZvKHRyYWluQ29tYm9Cb3gsIHJvdXRlVGV4dEZpZWxkKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQ+G6rXAgbmjhuq10IHPhu5EgbMaw4bujbmcgbOG7i2NoIHRyw6xuaCBk4buxIGtp4bq/biBraGkgdGhheSDEkeG7lWkgbmfDoHkgaG/hurdjIGNoZWNrYm94XG4gICAgICAgIFByb3BlcnR5Q2hhbmdlTGlzdGVuZXIgZGF0ZUxpc3RlbmVyID0gZXZ0IC0+IHtcbiAgICAgICAgICAgIGlmIChcImRhdGVcIi5lcXVhbHMoZXZ0LmdldFByb3BlcnR5TmFtZSgpKSkge1xuICAgICAgICAgICAgICAgIHVwZGF0ZVNjaGVkdWxlQ291bnQoc3RhcnREYXRlQ2hvb3NlciwgZW5kRGF0ZUNob29zZXIsIHdlZWtkYXlDaGVja2JveGVzLCBjb3VudEluZm9MYWJlbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgc3RhcnREYXRlQ2hvb3Nlci5hZGRQcm9wZXJ0eUNoYW5nZUxpc3RlbmVyKGRhdGVMaXN0ZW5lcik7XG4gICAgICAgIGVuZERhdGVDaG9vc2VyLmFkZFByb3BlcnR5Q2hhbmdlTGlzdGVuZXIoZGF0ZUxpc3RlbmVyKTtcblxuICAgICAgICBmb3IgKEpDaGVja0JveCBjaGVja2JveCA6IHdlZWtkYXlDaGVja2JveGVzKSB7XG4gICAgICAgICAgICBjaGVja2JveC5hZGRBY3Rpb25MaXN0ZW5lcihlIC0+IHtcbiAgICAgICAgICAgICAgICB1cGRhdGVTY2hlZHVsZUNvdW50KHN0YXJ0RGF0ZUNob29zZXIsIGVuZERhdGVDaG9vc2VyLCB3ZWVrZGF5Q2hlY2tib3hlcywgY291bnRJbmZvTGFiZWwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBD4bqtcCBuaOG6rXQgYmFuIMSR4bqndVxuICAgICAgICB1cGRhdGVTY2hlZHVsZUNvdW50KHN0YXJ0RGF0ZUNob29zZXIsIGVuZERhdGVDaG9vc2VyLCB3ZWVrZGF5Q2hlY2tib3hlcywgY291bnRJbmZvTGFiZWwpO1xuXG4gICAgICAgIC8vIFjhu60gbMO9IHPhu7Ega2nhu4duIGtoaSBuaOG6pW4gbsO6dCBcIkjhu6d5XCJcbiAgICAgICAgY2FuY2VsQnV0dG9uLmFkZEFjdGlvbkxpc3RlbmVyKGUgLT4gYmF0Y2hEaWFsb2cuZGlzcG9zZSgpKTtcbi4uLlxuXG4gICAgcHJpdmF0ZSB2b2lkIGxvYWRBbGxTY2hlZHVsZURhdGEoKSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uIHtcbiAgICAgICAgaWYgKCFpc0Nvbm5lY3RlZCB8fCBsaWNoVHJpbmhUYXVEQU8gPT0gbnVsbCkge1xuICAgICAgICAgICAgY29ubmVjdFRvUk1JU2VydmVyKCk7XG4gICAgICAgICAgICBpZiAoIWlzQ29ubmVjdGVkKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFJlbW90ZUV4Y2VwdGlvbihcIk5vdCBjb25uZWN0ZWQgdG8gUk1JIHNlcnZlclwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRhYmxlTW9kZWwuc2V0Um93Q291bnQoMCk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIExpc3Q8TGljaFRyaW5oVGF1PiBzY2hlZHVsZXMgPSBsaWNoVHJpbmhUYXVEQU8uZ2V0QWxsTGlzdCgpO1xuXG4gICAgICAgICAgICBpZiAoc2NoZWR1bGVzID09IG51bGwgfHwgc2NoZWR1bGVzLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIktow7RuZyBjw7MgbOG7i2NoIHRyw6xuaCBuw6BvIMSR4buDIGhp4buDbiB0aOG7iy5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiVGjDtG5nIGLDoW9cIixcbiAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLklORk9STUFUSU9OX01FU1NBR0UpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQXBwbHkgZmlsdGVyIGlmIHNlbGVjdGVkXG4gICAgICAgICAgICBTdHJpbmcgZmlsdGVyT3B0aW9uID0gKFN0cmluZykgZmlsdGVyQ29tYm9Cb3guZ2V0U2VsZWN0ZWRJdGVtKCk7XG4gICAgICAgICAgICBmb3IgKExpY2hUcmluaFRhdSBzY2hlZHVsZSA6IHNjaGVkdWxlcykge1xuICAgICAgICAgICAgICAgIGlmIChtYXRjaGVzRmlsdGVyKHNjaGVkdWxlLCBmaWx0ZXJPcHRpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhYmxlTW9kZWwuYWRkUm93KGNyZWF0ZVRhYmxlUm93KHNjaGVkdWxlKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuLi4uXG5cbiAgICAgICAgLy8gVGjDqm0gdOG6pXQgY+G6oyBjw6FjIHBhbmVsIGNvbiB2w6BvIHBhbmVsIGNow61uaFxuICAgICAgICBtYWluUGFuZWwuYWRkKHRyYWluUGFuZWwpO1xuICAgICAgICBtYWluUGFuZWwuYWRkKEJveC5jcmVhdGVWZXJ0aWNhbFN0cnV0KDE1KSk7XG4gICAgICAgIG1haW5QYW5lbC5hZGQoZGF0ZVBhbmVsKTtcbiAgICAgICAgbWFpblBhbmVsLmFkZChCb3guY3JlYXRlVmVydGljYWxTdHJ1dCgxNSkpO1xuICAgICAgICBtYWluUGFuZWwuYWRkKHRpbWVQYW5lbCk7XG4gICAgICAgIG1haW5QYW5lbC5hZGQoQm94LmNyZWF0ZVZlcnRpY2FsU3RydXQoMTUpKTtcbiAgICAgICAgbWFpblBhbmVsLmFkZChzdGF0dXNQYW5lbCk7XG4gICAgICAgIG1haW5QYW5lbC5hZGQoQm94LmNyZWF0ZVZlcnRpY2FsU3RydXQoMTUpKTtcbiAgICAgICAgbWFpblBhbmVsLmFkZChyb3V0ZVBhbmVsKTtcblxuICAgICAgICAvLyBQYW5lbCBjaOG7qWEgY8OhYyBuw7p0IHRoYW8gdMOhY1xuICAgICAgICBKUGFuZWwgYnV0dG9uc1BhbmVsID0gbmV3IEpQYW5lbChuZXcgRmxvd0xheW91dChGbG93TGF5b3V0LlJJR0hULCAxMCwgMTApKTtcbiAgICAgICAgSkJ1dHRvbiBzYXZlQnV0dG9uID0gbmV3IEpCdXR0b24oXCJMxrB1XCIpO1xuICAgICAgICBzYXZlQnV0dG9uLnNldEZvbnQobmV3IEZvbnQoXCJBcmlhbFwiLCBGb250LkJPTEQsIDE0KSk7XG4gICAgICAgIHNhdmVCdXR0b24uc2V0UHJlZmVycmVkU2l6ZShuZXcgRGltZW5zaW9uKDEwMCwgMzUpKTtcblxuICAgICAgICBKQnV0dG9uIGNhbmNlbEJ1dHRvbiA9IG5ldyBKQnV0dG9uKFwiSOG7p3lcIik7XG4gICAgICAgIGNhbmNlbEJ1dHRvbi5zZXRGb250KG5ldyBGb250KFwiQXJpYWxcIiwgRm9udC5CT0xELCAxNCkpO1xuICAgICAgICBjYW5jZWxCdXR0b24uc2V0UHJlZmVycmVkU2l6ZShuZXcgRGltZW5zaW9uKDEwMCwgMzUpKTtcblxuICAgICAgICAvLyBUaMOqbSBpY29uIGNobyBuw7p0IChu4bq/dSBwaMawxqFuZyB0aOG7qWMgdOG6oW8gaWNvbiBob+G6oXQgxJHhu5luZylcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHNhdmVCdXR0b24uc2V0SWNvbihjcmVhdGVBZGRJY29uKDE2LCAxNikpO1xuICAgICAgICAgICAgY2FuY2VsQnV0dG9uLnNldEljb24oY3JlYXRlRGVsZXRlSWNvbigxNiwgMTYpKTtcbiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgIExPR0dFUi5sb2coTGV2ZWwuV0FSTklORywgXCJLaMO0bmcgdGjhu4MgdGhp4bq/dCBs4bqtcCBpY29uIGNobyBuw7p0XCIsIGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgYnV0dG9uc1BhbmVsLmFkZChzYXZlQnV0dG9uKTtcbiAgICAgICAgYnV0dG9uc1BhbmVsLmFkZChjYW5jZWxCdXR0b24pO1xuXG4gICAgICAgIC8vIFRow6ptIHBhbmVsIGNow61uaCB2w6AgcGFuZWwgbsO6dCB2w6BvIGRpYWxvZ1xuICAgICAgICBhZGREaWFsb2cuYWRkKG1haW5QYW5lbCwgQm9yZGVyTGF5b3V0LkNFTlRFUik7XG4gICAgICAgIGFkZERpYWxvZy5hZGQoYnV0dG9uc1BhbmVsLCBCb3JkZXJMYXlvdXQuU09VVEgpO1xuXG4gICAgICAgIC8vIFThuqNpIGRhbmggc8OhY2ggdMOgdSB04burIFRhdURBT1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gVOG6oW8ga+G6v3QgbuG7kWkgxJHhur9uIFJNSSBzZXJ2ZXJcbiAgICAgICAgICAgIFJlZ2lzdHJ5IHJlZ2lzdHJ5ID0gTG9jYXRlUmVnaXN0cnkuZ2V0UmVnaXN0cnkoUk1JX1NFUlZFUl9JUCwgUk1JX1NFUlZFUl9QT1JUKTtcbiAgICAgICAgICAgIFRhdURBTyB0YXVEQU8gPSAoVGF1REFPKSByZWdpc3RyeS5sb29rdXAoXCJ0YXVEQU9cIik7XG4uLi5cblxuICAgICAgICAgICAgcm91dGVJbmZvUGFuZWwuYWRkKHJvdXRlSW5mb0xhYmVsKTtcbiAgICAgICAgICAgIHJvdXRlSW5mb1BhbmVsLmFkZChyb3V0ZUluZm9GaWVsZCk7XG4gICAgICAgICAgICBtYWluUGFuZWwuYWRkKHJvdXRlSW5mb1BhbmVsKTtcblxuICAgICAgICAgICAgLy8gVOG6o2kgZGFuaCBzw6FjaCB0w6B1XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIFJlZ2lzdHJ5IHJlZ2lzdHJ5ID0gTG9jYXRlUmVnaXN0cnkuZ2V0UmVnaXN0cnkoUk1JX1NFUlZFUl9JUCwgUk1JX1NFUlZFUl9QT1JUKTtcbiAgICAgICAgICAgICAgICBUYXVEQU8gdGF1REFPID0gKFRhdURBTykgcmVnaXN0cnkubG9va3VwKFwidGF1REFPXCIpO1xuICAgICAgICAgICAgICAgIExpc3Q8VGF1PiB0cmFpbkxpc3QgPSB0YXVEQU8uZ2V0QWxsTGlzdFQoKTtcblxuICAgICAgICAgICAgICAgIC8vIFRow6ptIHTDoHUgdsOgbyBjb21ib2JveFxuICAgICAgICAgICAgICAgIERlZmF1bHRDb21ib0JveE1vZGVsPFRhdT4gdHJhaW5Nb2RlbCA9IG5ldyBEZWZhdWx0Q29tYm9Cb3hNb2RlbDw+KCk7XG4gICAgICAgICAgICAgICAgZm9yIChUYXUgdGF1IDogdHJhaW5MaXN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRyYWluTW9kZWwuYWRkRWxlbWVudCh0YXUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0cmFpbkNvbWJvQm94LnNldE1vZGVsKHRyYWluTW9kZWwpO1xuXG4gICAgICAgICAgICAgICAgLy8gxJDhurd0IHTDoHUgaGnhu4duIHThuqFpXG4gICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCB0cmFpbk1vZGVsLmdldFNpemUoKTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIFRhdSB0YXUgPSB0cmFpbk1vZGVsLmdldEVsZW1lbnRBdChpKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRhdS5nZXRNYVRhdSgpLmVxdWFscyhsaWNoVHJpbmguZ2V0VGF1KCkuZ2V0TWFUYXUoKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYWluQ29tYm9Cb3guc2V0U2VsZWN0ZWRJbmRleChpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuLi4uXG5cbiAgICAvLyBUaMOqbSB2w6BvIHBoxrDGoW5nIHRo4bupYyBraOG7n2kgdOG6oW8gaG/hurdjIG3hu5l0IHBoxrDGoW5nIHRo4bupYyByacOqbmcgYmnhu4d0XG4gICAgcHJpdmF0ZSB2b2lkIHNldHVwS2V5QmluZGluZ3MoKSB7XG4gICAgICAgIElucHV0TWFwIGlucHV0TWFwID0gc2NoZWR1bGVUYWJsZS5nZXRJbnB1dE1hcChKQ29tcG9uZW50LldIRU5fRk9DVVNFRCk7XG4gICAgICAgIEFjdGlvbk1hcCBhY3Rpb25NYXAgPSBzY2hlZHVsZVRhYmxlLmdldEFjdGlvbk1hcCgpO1xuXG4gICAgICAgIC8vIFRow6ptIHBow61tIHThuq90IERlbGV0ZSDEkeG7gyB4w7NhIGzhu4tjaCB0csOsbmhcbiAgICAgICAgaW5wdXRNYXAucHV0KEtleVN0cm9rZS5nZXRLZXlTdHJva2UoS2V5RXZlbnQuVktfREVMRVRFLCAwKSwgXCJkZWxldGVcIik7XG4gICAgICAgIGFjdGlvbk1hcC5wdXQoXCJkZWxldGVcIiwgbmV3IEFic3RyYWN0QWN0aW9uKCkge1xuICAgICAgICAgICAgQE92ZXJyaWRlXG4gICAgICAgICAgICBwdWJsaWMgdm9pZCBhY3Rpb25QZXJmb3JtZWQoQWN0aW9uRXZlbnQgZSkge1xuICAgICAgICAgICAgICAgIGRlbGV0ZVNjaGVkdWxlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFRow6ptIHBow61tIHThuq90IEVudGVyIMSR4buDIHhlbSBjaGkgdGnhur90XG4gICAgICAgIGlucHV0TWFwLnB1dChLZXlTdHJva2UuZ2V0S2V5U3Ryb2tlKEtleUV2ZW50LlZLX0VOVEVSLCAwKSwgXCJ2aWV3XCIpO1xuICAgICAgICBhY3Rpb25NYXAucHV0KFwidmlld1wiLCBuZXcgQWJzdHJhY3RBY3Rpb24oKSB7XG4gICAgICAgICAgICBAT3ZlcnJpZGVcbiAgICAgICAgICAgIHB1YmxpYyB2b2lkIGFjdGlvblBlcmZvcm1lZChBY3Rpb25FdmVudCBlKSB7XG4gICAgICAgICAgICAgICAgdmlld1NjaGVkdWxlRGV0YWlscygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4uLi5cblBhdGg6IFByb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nL3NyYy9tYWluL2phdmEvZ3VpQ2xpZW50L1RyYVZlUGFuZWwuamF2YVxuLi4uXG5cbnB1YmxpYyBjbGFzcyBUcmFWZVBhbmVsIGV4dGVuZHMgSlBhbmVsIHtcbiAgICBwcml2YXRlIFZlVGF1REFPIHZlVGF1REFPO1xuICAgIHByaXZhdGUgSlRleHRGaWVsZCB0eHRNYVZlO1xuICAgIHByaXZhdGUgSlRleHRGaWVsZCB0eHRUZW5LaGFjaEhhbmc7XG4gICAgcHJpdmF0ZSBKVGV4dEZpZWxkIHR4dEdpYXlUbztcbiAgICBwcml2YXRlIEpUZXh0RmllbGQgdHh0TmdheURpO1xuICAgIHByaXZhdGUgSkNvbWJvQm94PFN0cmluZz4gY2JvRG9pVHVvbmc7XG4gICAgcHJpdmF0ZSBKQnV0dG9uIGJ0blRpbUtpZW07XG4gICAgcHJpdmF0ZSBKQnV0dG9uIGJ0blRyYVZlO1xuICAgIHByaXZhdGUgSkJ1dHRvbiBidG5MYW1Nb2k7XG4gICAgcHJpdmF0ZSBKQnV0dG9uIGJ0blRob2F0O1xuICAgIHByaXZhdGUgSkxhYmVsIGxibExpY2hUcmluaDtcbiAgICBwcml2YXRlIEpMYWJlbCBsYmxDaG9OZ29pO1xuICAgIHByaXZhdGUgSkxhYmVsIGxibFRyYW5nVGhhaTtcbiAgICBwcml2YXRlIEpMYWJlbCBsYmxHaWFWZTtcbiAgICBwcml2YXRlIEpCdXR0b24gYnRuQ2hvbkxpY2hUcmluaDtcbiAgICBwcml2YXRlIEpCdXR0b24gYnRuQ2hvbkNob05nb2k7XG4gICAgcHJpdmF0ZSBKVGV4dEZpZWxkIHR4dFBoaVRyYVZlO1xuICAgIHByaXZhdGUgSkxhYmVsIGxibFRpZW5UcmFMYWk7XG4gICAgcHJpdmF0ZSBMaWNoVHJpbmhUYXVEQU8gbGljaFRyaW5oVGF1REFPO1xuICAgIC8vIFRow6ptIGPDoWMgYmnhur9uIHRow6BuaCB2acOqbiBt4bubaVxuICAgIHByaXZhdGUgSG9hRG9uREFPIGhvYURvbkRBTztcbiAgICBwcml2YXRlIENoaVRpZXRIb2FEb25EQU8gY2hpVGlldEhvYURvbkRBTztcbi4uLlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9ndWlDbGllbnQvVHJhaW5TY2hlZHVsZUNhbGVuZGFyUGFuZWwuamF2YVxucGFja2FnZSBndWlDbGllbnQ7XG5cbmltcG9ydCBkYW8uTGljaFRyaW5oVGF1REFPO1xuaW1wb3J0IG1vZGVsLkxpY2hUcmluaFRhdTtcbmltcG9ydCBtb2RlbC5UcmFuZ1RoYWk7XG5cbmltcG9ydCBqYXZheC5zd2luZy4qO1xuaW1wb3J0IGphdmEuYXd0Lio7XG5pbXBvcnQgamF2YS50aW1lLkRheU9mV2VlaztcbmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlO1xuaW1wb3J0IGphdmEudGltZS5mb3JtYXQuRGF0ZVRpbWVGb3JtYXR0ZXI7XG5pbXBvcnQgamF2YS50aW1lLmZvcm1hdC5UZXh0U3R5bGU7XG5pbXBvcnQgamF2YS51dGlsLio7XG5pbXBvcnQgamF2YS51dGlsLkxpc3Q7XG5pbXBvcnQgamF2YS51dGlsLmxvZ2dpbmcuTGV2ZWw7XG5pbXBvcnQgamF2YS51dGlsLmxvZ2dpbmcuTG9nZ2VyO1xuXG4vKipcbiAqIFBhbmVsIGhp4buDbiB0aOG7iyBs4buLY2ggdHLDrG5oIHTDoHUgdGhlbyBk4bqhbmcgbOG7i2NoXG4gKi9cbnB1YmxpYyBjbGFzcyBUcmFpblNjaGVkdWxlQ2FsZW5kYXJQYW5lbCBleHRlbmRzIEpQYW5lbCB7XG4gICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9nZ2VyIExPR0dFUiA9IExvZ2dlci5nZXRMb2dnZXIoVHJhaW5TY2hlZHVsZUNhbGVuZGFyUGFuZWwuY2xhc3MuZ2V0TmFtZSgpKTtcbi4uLlxuIiwiaXNFcnJvciI6ZmFsc2UsInJlcXVlc3RJZCI6IiJ9fSwiMjdjYmQ5NzktZjllYS00ODUyLWJkZGYtYjEyYWQ5ODkxYzhhO3Rvb2x1XzAxVFhyVkRSYWg1ZXE1TjhSeEx2N3ZNVCI6eyJwaGFzZSI6NSwicmVzdWx0Ijp7InRleHQiOiJUaGUgZm9sbG93aW5nIGNvZGUgc2VjdGlvbnMgd2VyZSByZXRyaWV2ZWQ6XG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9UcmFpblRpY2tldEJvb2tpbmdTeXN0ZW0uamF2YVxucGFja2FnZSBndWlDbGllbnQ7XG5cbmltcG9ydCBkYW8uKjtcbmltcG9ydCBkYW8uaW1wbC4qO1xuaW1wb3J0IG1vZGVsLio7XG5cbmltcG9ydCBqYXZheC5zd2luZy4qO1xuaW1wb3J0IGphdmF4LnN3aW5nLmJvcmRlci4qO1xuaW1wb3J0IGphdmF4LnN3aW5nLnRleHQuRGVmYXVsdENhcmV0O1xuaW1wb3J0IGphdmEuYXd0Lio7XG5pbXBvcnQgamF2YS5hd3QuZXZlbnQuKjtcbmltcG9ydCBqYXZhLnJtaS5SZW1vdGVFeGNlcHRpb247XG5pbXBvcnQgamF2YS50ZXh0Lk51bWJlckZvcm1hdDtcbmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlO1xuaW1wb3J0IGphdmEudGltZS5ab25lSWQ7XG5pbXBvcnQgamF2YS50aW1lLmZvcm1hdC5EYXRlVGltZUZvcm1hdHRlcjtcbmltcG9ydCBqYXZhLnV0aWwuKjtcbmltcG9ydCBqYXZhLnV0aWwuTGlzdDtcbmltcG9ydCBqYXZheC5zd2luZy5UaW1lcjtcbmltcG9ydCBqYXZheC5zd2luZy5wbGFmLmJhc2ljLkJhc2ljU2Nyb2xsQmFyVUk7XG5pbXBvcnQgamF2YS51dGlsLnN0cmVhbS5Db2xsZWN0b3JzO1xuaW1wb3J0IGNvbS50b2VkdGVyLmNhbGVuZGFyLkpEYXRlQ2hvb3NlcjtcblxuLyoqXG4gKiBUcmFpbiBUaWNrZXQgQm9va2luZyBTeXN0ZW0gR1VJXG4gKiBBbGxvd3MgdXNlcnMgdG8gc2VhcmNoIGZvciB0cmFpbnMsIHZpZXcgY2Fycywgc2VsZWN0IHNlYXRzLCBhbmQgYm9vayB0aWNrZXRzXG4gKiBAYXV0aG9yIGx1b25ndGFuMjA0XG4gKi9cbnB1YmxpYyBjbGFzcyBUcmFpblRpY2tldEJvb2tpbmdTeXN0ZW0gZXh0ZW5kcyBKRnJhbWUge1xuICAgIC8vIFVJIENvbXBvbmVudHNcbiAgICBwcml2YXRlIEpQYW5lbCBzZWF0c1BhbmVsO1xuICAgIHByaXZhdGUgSlBhbmVsIGNhcnNQYW5lbDtcbiAgICBwcml2YXRlIEpQYW5lbCB0cmFpbnNQYW5lbDtcbiAgICBwcml2YXRlIEpTY3JvbGxQYW5lIHRyYWluc1Njcm9sbFBhbmU7XG4gICAgcHJpdmF0ZSBKU2Nyb2xsUGFuZSBjYXJzU2Nyb2xsUGFuZTtcbiAgICBwcml2YXRlIEpMYWJlbCBzZWF0aW5nU2VjdGlvbkxhYmVsO1xuICAgIHByaXZhdGUgSkxhYmVsIHRvdGFsTGFiZWw7XG5cbiAgICAvLyBGb3JtIGZpZWxkc1xuICAgIHByaXZhdGUgSlRleHRGaWVsZCBkZXBhcnR1cmVGaWVsZDtcbiAgICBwcml2YXRlIEpUZXh0RmllbGQgYXJyaXZhbEZpZWxkO1xuICAgIHByaXZhdGUgSlRleHRGaWVsZCBkZXBhcnR1cmVEYXRlRmllbGQ7XG4gICAgcHJpdmF0ZSBKVGV4dEZpZWxkIHJldHVybkRhdGVGaWVsZDtcbiAgICBwcml2YXRlIEpSYWRpb0J1dHRvbiBvbmVXYXlSYWRpbztcbiAgICBwcml2YXRlIEpSYWRpb0J1dHRvbiByb3VuZFRyaXBSYWRpbztcblxuICAgIC8vIFN0YXRlIHZhcmlhYmxlc1xuICAgIHByaXZhdGUgU3RyaW5nIHNlbGVjdGVkVHJhaW5JZCA9IFwiXCI7ICAgLy8gQ29tcG91bmQgSUQgZm9yIHNlbGVjdGlvbiAodHJhaW4gY29kZSArIHRpbWUpXG4gICAgcHJpdmF0ZSBTdHJpbmcgY3VycmVudFRyYWluSWQgPSBcIlwiOyAgICAvLyBKdXN0IHRoZSB0cmFpbiBjb2RlXG4gICAgcHJpdmF0ZSBTdHJpbmcgY3VycmVudFRvYUlkID0gXCJcIjsgICAgICAvLyBDYXIgSURcbiAgICBwcml2YXRlIFN0cmluZyBjdXJyZW50TWFMaWNoID0gXCJcIjsgICAgIC8vIFNjaGVkdWxlIElEIGZvciBzZWF0IGxvYWRpbmdcbiAgICBwcml2YXRlIEFycmF5TGlzdDxUaWNrZXRJdGVtPiBjYXJ0SXRlbXMgPSBuZXcgQXJyYXlMaXN0PD4oKTtcbiAgICBwcml2YXRlIGRvdWJsZSB0b3RhbEFtb3VudCA9IDAuMDtcblxuICAgIC8vIFNlYXQgc3RhdHVzIGNvbnN0YW50c1xuICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyBTVEFUVVNfQVZBSUxBQkxFID0gXCJUcuG7kW5nXCI7XG4gICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgU3RyaW5nIFNUQVRVU19CT09LRUQgPSBcIsSQw6MgxJHhurd0XCI7XG4gICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgU3RyaW5nIFNUQVRVU19QRU5ESU5HID0gXCJDaOG7nSB4w6FjIG5o4bqtblwiO1xuXG4gICAgLy8gU2VhdCBjb2xvcnNcbiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBDb2xvciBTRUFUX0FWQUlMQUJMRV9DT0xPUiA9IENvbG9yLldISVRFO1xuICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIENvbG9yIFNFQVRfQk9PS0VEX0NPTE9SID0gQ29sb3IuTElHSFRfR1JBWTtcbiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBDb2xvciBTRUFUX1BFTkRJTkdfQ09MT1IgPSBDb2xvci5ZRUxMT1c7XG5cbiAgICBwcml2YXRlIE1hcDxTdHJpbmcsIFRpbWVyPiByZXNlcnZhdGlvblRpbWVycyA9IG5ldyBIYXNoTWFwPD4oKTsgLy8gU3RvcmUgdGltZXJzIGZvciBlYWNoIHJlc2VydmVkIHNlYXRcbiAgICBwcml2YXRlIE1hcDxTdHJpbmcsIEludGVnZXI+IHJlbWFpbmluZ1RpbWVzID0gbmV3IEhhc2hNYXA8PigpOyAgLy8gU3RvcmUgcmVtYWluaW5nIHNlY29uZHMgZm9yIGVhY2ggcmVzZXJ2YXRpb25cbiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBpbnQgUkVTRVJWQVRJT05fVElNRU9VVCA9IDMwMDsgLy8gMzAwIHNlY29uZHMgKDUgbWludXRlcylcblxuICAgIC8vIFZpc3VhbCBlZmZlY3RzXG4gICAgcHJpdmF0ZSBDb2xvciBhY3RpdmVDb2xvciA9IG5ldyBDb2xvcigwLCAxMzYsIDIwNCk7XG4gICAgcHJpdmF0ZSBDb2xvciBpbmFjdGl2ZUNvbG9yID0gbmV3IENvbG9yKDE1MywgMTUzLCAxNTMpO1xuICAgIHByaXZhdGUgQ29sb3IgaG92ZXJDb2xvciA9IG5ldyBDb2xvcig1MSwgMTUzLCAyNTUpO1xuICAgIHByaXZhdGUgQm9yZGVyIGFjdGl2ZUJvcmRlciA9IEJvcmRlckZhY3RvcnkuY3JlYXRlQ29tcG91bmRCb3JkZXIoXG4gICAgICAgICAgICBCb3JkZXJGYWN0b3J5LmNyZWF0ZUxpbmVCb3JkZXIobmV3IENvbG9yKDI1NSwgMjE1LCAwKSwgMiksIC8vIEdvbGQgYm9yZGVyXG4gICAgICAgICAgICBCb3JkZXJGYWN0b3J5LmNyZWF0ZUVtcHR5Qm9yZGVyKDEsIDEsIDEsIDEpXG4gICAgKTtcbiAgICBwcml2YXRlIEJvcmRlciBub3JtYWxCb3JkZXIgPSBCb3JkZXJGYWN0b3J5LmNyZWF0ZUVtcHR5Qm9yZGVyKDMsIDMsIDMsIDMpO1xuXG4gICAgLy8gREFPc1xuICAgIHByaXZhdGUgTGljaFRyaW5oVGF1REFPIGxpY2hUcmluaFRhdURBTztcbiAgICBwcml2YXRlIFRhdURBTyB0YXVEQU87XG4gICAgcHJpdmF0ZSBUb2FUYXVEQU8gdG9hVGF1REFPO1xuICAgIHByaXZhdGUgQ2hvTmdvaURBTyBjaG9OZ29pREFPO1xuICAgIHByaXZhdGUgS2h1eWVuTWFpREFPIGtodXllbk1haURBTztcblxuICAgIC8vIEVtcGxveWVlIGluZm9ybWF0aW9uXG4gICAgcHJpdmF0ZSBOaGFuVmllbiBuaGFuVmllbjtcblxuICAgIC8qKlxuICAgICAqIENvbnN0cnVjdG9yIC0gaW5pdGlhbGl6ZXMgdGhlIGFwcGxpY2F0aW9uXG4gICAgICogQHBhcmFtIG52IFRoZSBlbXBsb3llZSB3aG8gaXMgdXNpbmcgdGhlIHN5c3RlbVxuICAgICAqL1xuICAgIHB1YmxpYyBUcmFpblRpY2tldEJvb2tpbmdTeXN0ZW0oTmhhblZpZW4gbnYpIHRocm93cyBSZW1vdGVFeGNlcHRpb24ge1xuICAgICAgICB0aGlzLm5oYW5WaWVuID0gbnY7XG4gICAgICAgIHNldFRpdGxlKFwiSOG7hyB0aOG7kW5nIMSR4bq3dCB2w6kgdMOgdVwiKTtcbiAgICAgICAgc2V0U2l6ZSgxMjAwLCA2NTApO1xuICAgICAgICBzZXREZWZhdWx0Q2xvc2VPcGVyYXRpb24oSkZyYW1lLkVYSVRfT05fQ0xPU0UpO1xuICAgICAgICBzZXRMb2NhdGlvblJlbGF0aXZlVG8obnVsbCk7XG5cbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBEQU9zXG4gICAgICAgIGxpY2hUcmluaFRhdURBTyA9IG5ldyBMaWNoVHJpbmhUYXVEQU9JbXBsKCk7XG4gICAgICAgIHRhdURBTyA9IG5ldyBUYXVEQU9JbXBsKCk7XG4gICAgICAgIHRvYVRhdURBTyA9IG5ldyBUb2FUYXVEQU9JbXBsKCk7XG4gICAgICAgIGNob05nb2lEQU8gPSBuZXcgQ2hvTmdvaURBT0ltcGwoKTtcbiAgICAgICAga2h1eWVuTWFpREFPID0gbmV3IEtodXllbk1haURBT0ltcGwoKTtcblxuICAgICAgICAvLyBNYWluIGNvbnRhaW5lciBwYW5lbCB3aXRoIEJvcmRlckxheW91dFxuICAgICAgICBKUGFuZWwgY29udGFpbmVyUGFuZWwgPSBuZXcgSlBhbmVsKG5ldyBCb3JkZXJMYXlvdXQoMTAsIDEwKSk7XG4uLi5cblxuICAgICAgICAgICAgLy8gR2V0IHNlYXQgcHJpY2UgYmFzZWQgb24gcm91dGUgYW5kIHNlYXQgY2xhc3NcbiAgICAgICAgICAgIGRvdWJsZSBwcmljZSA9IGdldFNlYXRQcmljZShjaG9OZ29pKTtcbiAgICAgICAgICAgIFN0cmluZyBkaXNwbGF5TmFtZSA9IChjaG9OZ29pLmdldFRlbkNobygpICE9IG51bGwpID8gY2hvTmdvaS5nZXRUZW5DaG8oKSA6IHNlYXRJZDtcblxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBVSSB0byByZWZsZWN0IHBlbmRpbmcgc3RhdHVzXG4gICAgICAgICAgICAgICAgdXBkYXRlU2VhdFN0YXR1cyhzZWF0SWQsIFNUQVRVU19QRU5ESU5HKTtcblxuICAgICAgICAgICAgICAgIC8vIEFkZCB0byBjYXJ0XG4gICAgICAgICAgICAgICAgYWRkVG9DYXJ0V2l0aFRpbWVvdXQoc2VhdElkLCBkaXNwbGF5TmFtZSwgcHJpY2UpO1xuXG4gICAgICAgICAgICAgICAgLy8gU3RhcnQgY291bnRkb3duIHRpbWVyIGZvciB0aGlzIHNlYXRcbiAgICAgICAgICAgICAgICBzdGFydFJlc2VydmF0aW9uQ291bnRkb3duKHNlYXRJZCwgZGlzcGxheU5hbWUsIHByaWNlKTtcblxuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZXgpIHtcbiAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIFwiTOG7l2kga2hpIGdp4buvIGNo4buXOiBcIiArIGV4LmdldE1lc3NhZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgXCJM4buXaVwiLCBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFKTtcbiAgICAgICAgICAgIGV4LnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICB9XG4gICAgfVxuLi4uXG5cbiAgICAgICAgLy8gQ3JlYXRlIGFuZCBhZGQgdGlja2V0IGl0ZW0gdG8gY2FydCB3aXRoIHNlYXRJZCBmb3IgbGF0ZXIgcmVmZXJlbmNlXG4gICAgICAgIFRpY2tldEl0ZW0gaXRlbSA9IG5ldyBUaWNrZXRJdGVtKGN1cnJlbnRUcmFpbklkLCBzZWF0SWQsIGRpc3BsYXlOYW1lLCBmcm9tLCB0bywgZGVwYXJ0dXJlRGF0ZSwgcHJpY2UsIGNhcklkLCBjYXJOYW1lKTtcbiAgICAgICAgY2FydEl0ZW1zLmFkZChpdGVtKTtcblxuICAgICAgICAvLyBVcGRhdGUgY2FydCBkaXNwbGF5XG4gICAgICAgIHVwZGF0ZUNhcnREaXNwbGF5KCk7XG5cbiAgICAgICAgLy8gSW1tZWRpYXRlbHkgdXBkYXRlIHRoZSBzZWF0IHN0YXR1cyBpbiBVSSB0byBzaG93IGFzIHBlbmRpbmcgKHllbGxvdylcbiAgICAgICAgdXBkYXRlU2VhdFN0YXR1cyhzZWF0SWQsIFNUQVRVU19QRU5ESU5HKTtcbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBjYXJ0IGl0ZW0gdG8gc2hvdyBjb3VudGRvd25cbiAgICAgKi9cblxuXG4gICAgLyoqXG4gICAgICogSGVscGVyIHRvIHVwZGF0ZSBhIHBhbmVsIHdpdGggY291bnRkb3duXG4gICAgICovXG4uLi5cblxuICAgIC8qKlxuICAgICAqIFNlYXJjaCBmb3IgdHJhaW5zIGJhc2VkIG9uIGZvcm0gZGF0YVxuICAgICAqL1xuICAgIHByaXZhdGUgdm9pZCBzZWFyY2hUcmFpbnMoKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZXQgaW5wdXQgZGF0YVxuICAgICAgICAgICAgU3RyaW5nIGdhRGkgPSBkZXBhcnR1cmVGaWVsZC5nZXRUZXh0KCkudHJpbSgpO1xuICAgICAgICAgICAgU3RyaW5nIGdhRGVuID0gYXJyaXZhbEZpZWxkLmdldFRleHQoKS50cmltKCk7XG5cbiAgICAgICAgICAgIC8vIFBhcnNlIGRhdGVcbiAgICAgICAgICAgIERhdGVUaW1lRm9ybWF0dGVyIGZvcm1hdHRlciA9IERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybihcImRkL01NL3l5eXlcIik7XG4gICAgICAgICAgICBMb2NhbERhdGUgZGVwYXJ0dXJlRGF0ZSA9IExvY2FsRGF0ZS5wYXJzZShkZXBhcnR1cmVEYXRlRmllbGQuZ2V0VGV4dCgpLnRyaW0oKSwgZm9ybWF0dGVyKTtcblxuICAgICAgICAgICAgLy8gQ2FsbCBEQU8gdG8gZ2V0IHRyYWluIHNjaGVkdWxlc1xuICAgICAgICAgICAgTGlzdDxMaWNoVHJpbmhUYXU+IGFsbExpY2hUcmluaExpc3QgPSBsaWNoVHJpbmhUYXVEQU8uZ2V0TGlzdExpY2hUcmluaFRhdUJ5RGF0ZUFuZEdhRGlHYURlbihkZXBhcnR1cmVEYXRlLCBnYURpLCBnYURlbik7XG4uLi5cblxuICAgICAgICAgICAgLy8gQ3JlYXRlIHRyYWluIGNhcmRzIG9ubHkgZm9yIGZpbHRlcmVkIHNjaGVkdWxlc1xuICAgICAgICAgICAgZm9yIChMaWNoVHJpbmhUYXUgbGljaFRyaW5oIDogZmlsdGVyZWRMaWNoVHJpbmhMaXN0KSB7XG4gICAgICAgICAgICAgICAgLy8gR2V0IHRyYWluIG9iamVjdFxuICAgICAgICAgICAgICAgIFRhdSB0YXUgPSB0YXVEQU8uZ2V0VGF1QnlMaWNoVHJpbmhUYXUobGljaFRyaW5oKTtcblxuICAgICAgICAgICAgICAgIC8vIEZvcm1hdCBkZXBhcnR1cmUgdGltZVxuICAgICAgICAgICAgICAgIERhdGVUaW1lRm9ybWF0dGVyIHRpbWVGb3JtYXR0ZXIgPSBEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oXCJISDptbVwiKTtcbiAgICAgICAgICAgICAgICBTdHJpbmcgZGVwYXJ0VGltZSA9IGxpY2hUcmluaC5nZXRHaW9EaSgpLmZvcm1hdCh0aW1lRm9ybWF0dGVyKTtcblxuICAgICAgICAgICAgICAgIC8vIEZvcm1hdCBkYXRlXG4gICAgICAgICAgICAgICAgRGF0ZVRpbWVGb3JtYXR0ZXIgZGF0ZUZvcm1hdHRlciA9IERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybihcImRkL01NXCIpO1xuICAgICAgICAgICAgICAgIFN0cmluZyBkZXBhcnREYXRlID0gbGljaFRyaW5oLmdldE5nYXlEaSgpLmZvcm1hdChkYXRlRm9ybWF0dGVyKTtcblxuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBmb3JtYXR0ZWQgdGltZXMgZm9yIGRpc3BsYXlcbiAgICAgICAgICAgICAgICBTdHJpbmcgZGVwYXJ0VGltZUZvcm1hdHRlZCA9IGRlcGFydERhdGUgKyBcIiBcIiArIGRlcGFydFRpbWU7XG5cbiAgICAgICAgICAgICAgICAvLyBHZXQgYXZhaWxhYmxlIHNlYXRzXG4gICAgICAgICAgICAgICAgbG9uZyBhdmFpbGFibGVTZWF0cyA9IGxpY2hUcmluaFRhdURBTy5nZXRBdmFpbGFibGVTZWF0c0J5U2NoZWR1bGUobGljaFRyaW5oLmdldE1hTGljaCgpKTtcblxuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSB0cmFpbiBjYXJkIHdpdGggc3RhdHVzIGluZGljYXRvclxuICAgICAgICAgICAgICAgIEpQYW5lbCB0cmFpbkNhcmQgPSBjcmVhdGVUcmFpbkNhcmQoXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXUuZ2V0TWFUYXUoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlcGFydFRpbWVGb3JtYXR0ZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBhdmFpbGFibGVTZWF0cyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhbHNlLCAvLyBJbml0aWFsbHkgbm90IHNlbGVjdGVkXG4gICAgICAgICAgICAgICAgICAgICAgICBsaWNoVHJpbmguZ2V0VHJhbmdUaGFpKCksICAvLyBQYXNzIHRoZSBzdGF0dXMgdG8gcG9zc2libHkgZGlzcGxheSBpdFxuICAgICAgICAgICAgICAgICAgICAgICAgbGljaFRyaW5oLmdldE1hTGljaCgpICAgICAgLy8gU3RvcmUgc2NoZWR1bGUgSURcbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgdHJhaW5zUGFuZWwuYWRkKHRyYWluQ2FyZCk7XG4gICAgICAgICAgICAgICAgdHJhaW5zUGFuZWwuYWRkKEJveC5jcmVhdGVIb3Jpem9udGFsU3RydXQoMTApKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQ2xlYXIgY2FyIHBhbmVsIGFuZCB1cGRhdGUgaGVhZGVyXG4gICAgICAgICAgICBsb2FkVHJhaW5DYXJzKFwiXCIpOyAvLyBFbXB0eSB0cmFpbiBJRCB0byBzaG93IHBsYWNlaG9sZGVyXG4gICAgICAgICAgICBzZWF0aW5nU2VjdGlvbkxhYmVsLnNldFRleHQoXCJUb2E6IENoxrBhIGNo4buNblwiKTtcblxuICAgICAgICAgICAgLy8gVXBkYXRlIGhlYWRlclxuICAgICAgICAgICAgdXBkYXRlSGVhZGVySW5mbyhnYURpLCBnYURlbiwgZGVwYXJ0dXJlRGF0ZUZpZWxkLmdldFRleHQoKSk7XG5cbiAgICAgICAgICAgIC8vIFJlZnJlc2ggVUlcbiAgICAgICAgICAgIHRyYWluc1BhbmVsLnJldmFsaWRhdGUoKTtcbiAgICAgICAgICAgIHRyYWluc1BhbmVsLnJlcGFpbnQoKTtcblxuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiU2VhcmNoIGNvbXBsZXRlZCwgXCIgKyBmaWx0ZXJlZExpY2hUcmluaExpc3Quc2l6ZSgpICsgXCIgdHJhaW5zIGZvdW5kXCIpO1xuLi4uXG4gICAgICAgIGNoZWNrb3V0QnV0dG9uLmFkZEFjdGlvbkxpc3RlbmVyKGUgLT4ge1xuICAgICAgICAgICAgaWYgKGNhcnRJdGVtcy5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhcbiAgICAgICAgICAgICAgICAgICAgICAgIFRyYWluVGlja2V0Qm9va2luZ1N5c3RlbS50aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJHaeG7jyB2w6kgdHLhu5FuZy4gVnVpIGzDsm5nIGNo4buNbiB2w6kgdHLGsOG7m2Mga2hpIHRoYW5oIHRvw6FuLlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJUaMO0bmcgYsOhb1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBDcmVhdGUgYSBtYXAgb2Ygc2VhdCBJRHMgdG8gc2NoZWR1bGUgSURzXG4gICAgICAgICAgICBNYXA8U3RyaW5nLCBTdHJpbmc+IHRpY2tldHNUb0NoZWNrb3V0ID0gbmV3IEhhc2hNYXA8PigpO1xuICAgICAgICAgICAgZm9yIChUaWNrZXRJdGVtIGl0ZW0gOiBjYXJ0SXRlbXMpIHtcbiAgICAgICAgICAgICAgICB0aWNrZXRzVG9DaGVja291dC5wdXQoaXRlbS5zZWF0SWQsIGN1cnJlbnRNYUxpY2gpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBPcGVuIGNoZWNrb3V0IHNjcmVlbiB3aXRoIG9ubHkgdGhlIG5lY2Vzc2FyeSBpZGVudGlmaWVycyBhbmQgZW1wbG95ZWUgaW5mb3JtYXRpb25cbiAgICAgICAgICAgIFRoYW5oVG9hbkdVSSBjaGVja291dFNjcmVlbiA9IG51bGw7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNoZWNrb3V0U2NyZWVuID0gbmV3IFRoYW5oVG9hbkdVSSh0aWNrZXRzVG9DaGVja291dCwgbmhhblZpZW4pO1xuICAgICAgICAgICAgfSBjYXRjaCAoUmVtb3RlRXhjZXB0aW9uIGV4KSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFeGNlcHRpb24oZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2hlY2tvdXRTY3JlZW4uc2V0VmlzaWJsZSh0cnVlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIE9wZW4gY2hlY2tvdXQgc2NyZWVuXG4uLi5cblxuXG5cblxuICAgIC8qKlxuICAgICAqIE1haW4gbWV0aG9kXG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyB2b2lkIG1haW4oU3RyaW5nW10gYXJncykge1xuICAgICAgICAvLyBTZXQgc3lzdGVtIHRpbWUgZm9yIGRlYnVnZ2luZyAtIGluIHByb2R1Y3Rpb24gdGhpcyB3b3VsZCBiZSByZW1vdmVkXG4gICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIlN5c3RlbSB0aW1lOiBcIiArIG5ldyBEYXRlKCkpO1xuICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJVc2VyOiBsdW9uZ3RhbjIwNHZpZXRcIik7XG5cbiAgICAgICAgU3dpbmdVdGlsaXRpZXMuaW52b2tlTGF0ZXIoKCkgLT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgYSBzYW1wbGUgZW1wbG95ZWUgZm9yIHRlc3RpbmdcbiAgICAgICAgICAgICAgICBOaGFuVmllbiBudiA9IG5ldyBOaGFuVmllbigpO1xuICAgICAgICAgICAgICAgIE5oYW5WaWVuREFPIG5oYW5WaWVuREFPID0gbmV3IE5oYW5WaWVuREFPSW1wbCgpO1xuICAgICAgICAgICAgICAgIG52ID0gbmhhblZpZW5EQU8uZ2V0bmhhbnZpZW5CeUlkKFwiTlYyMDI1MDQxODAwMDFcIik7XG5cbiAgICAgICAgICAgICAgICBUcmFpblRpY2tldEJvb2tpbmdTeXN0ZW0gYXBwID0gbmV3IFRyYWluVGlja2V0Qm9va2luZ1N5c3RlbShudik7XG4gICAgICAgICAgICAgICAgYXBwLnNldFZpc2libGUodHJ1ZSk7XG4gICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpIGto4bufaSDEkeG7mW5nIOG7qW5nIGThu6VuZzogXCIgKyBlLmdldE1lc3NhZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2lcIiwgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRSk7XG4gICAgICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufVxuLi4uXG5QYXRoOiBQcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9UaGFuaFRvYW5HVUkuamF2YVxucGFja2FnZSBndWlDbGllbnQ7XG5cbmltcG9ydCBkYW8uKjtcbmltcG9ydCBkYW8uaW1wbC4qO1xuaW1wb3J0IG1vZGVsLio7XG5cbmltcG9ydCBqYXZheC5zd2luZy4qO1xuaW1wb3J0IGphdmF4LnN3aW5nLmJvcmRlci4qO1xuaW1wb3J0IGphdmF4LnN3aW5nLnRhYmxlLio7XG5pbXBvcnQgamF2YS5hd3QuKjtcbmltcG9ydCBqYXZhLmF3dC5ldmVudC4qO1xuaW1wb3J0IGphdmEucm1pLlJlbW90ZUV4Y2VwdGlvbjtcbmltcG9ydCBqYXZhLnRleHQuTnVtYmVyRm9ybWF0O1xuaW1wb3J0IGphdmEudGltZS5Mb2NhbERhdGU7XG5pbXBvcnQgamF2YS50aW1lLmZvcm1hdC5EYXRlVGltZUZvcm1hdHRlcjtcbmltcG9ydCBqYXZhLnV0aWwuKjtcbmltcG9ydCBqYXZhLnV0aWwuTGlzdDtcblxuLyoqXG4gKiBDaGVja291dCBpbnRlcmZhY2UgZm9yIHRyYWluIHRpY2tldCBib29raW5nIHN5c3RlbVxuICogRGlzcGxheXMgc2VsZWN0ZWQgdGlja2V0cyBhbmQgY29sbGVjdHMgcGFzc2VuZ2VyIGluZm9ybWF0aW9uXG4gKiBAYXV0aG9yIGx1b25ndGFuMjA0XG4gKi9cbnB1YmxpYyBjbGFzcyBUaGFuaFRvYW5HVUkgZXh0ZW5kcyBKRnJhbWUge1xuICAgIC8vIE1haW4gcGFuZWxzXG4gICAgcHJpdmF0ZSBKUGFuZWwgbWFpblBhbmVsO1xuICAgIHByaXZhdGUgSlRhYmxlIHRpY2tldFRhYmxlO1xuICAgIHByaXZhdGUgRGVmYXVsdFRhYmxlTW9kZWwgdGFibGVNb2RlbDtcblxuICAgIC8vIEZvcm0gZmllbGRzXG4gICAgcHJpdmF0ZSBKVGV4dEZpZWxkIG5hbWVGaWVsZDtcbiAgICBwcml2YXRlIEpUZXh0RmllbGQgaWRDYXJkRmllbGQ7XG4gICAgcHJpdmF0ZSBKVGV4dEZpZWxkIGVtYWlsRmllbGQ7XG4gICAgcHJpdmF0ZSBKVGV4dEZpZWxkIGNvbmZpcm1FbWFpbEZpZWxkO1xuICAgIHByaXZhdGUgSlRleHRGaWVsZCBwaG9uZUZpZWxkO1xuICAgIHByaXZhdGUgSkNvbWJvQm94PEtodXllbk1haT4gcHJvbW90aW9uQ29tYm9Cb3g7XG5cbiAgICAvLyBTdG9yZSB0aGUgc2NoZWR1bGUgZGF0ZSBmb3IgcHJvbW90aW9uc1xuICAgIHByaXZhdGUgTG9jYWxEYXRlIHNjaGVkdWxlRGF0ZTtcblxuICAgIC8vIFN1bW1hcnkgZmllbGRzXG4gICAgcHJpdmF0ZSBKTGFiZWwgdG90YWxBbW91bnRMYWJlbDtcbiAgICBwcml2YXRlIGRvdWJsZSB0b3RhbEFtb3VudCA9IDAuMDtcblxuICAgIC8vIENvbmZpcm1hdGlvbiBwYW5lbFxuICAgIHByaXZhdGUgSlRleHRBcmVhIGNvbmZpcm1hdGlvblRleHRBcmVhO1xuXG4gICAgLy8gUGF5bWVudCBmaWVsZHNcbiAgICBwcml2YXRlIEpUZXh0RmllbGQgYW1vdW50UGFpZEZpZWxkO1xuICAgIHByaXZhdGUgSkxhYmVsIGNoYW5nZUFtb3VudExhYmVsO1xuXG4gICAgLy8gRGF0YVxuICAgIHByaXZhdGUgTWFwPFN0cmluZywgU3RyaW5nPiB0aWNrZXRzTWFwOyAvLyBNYXAgb2Ygc2VhdCBJRHMgdG8gc2NoZWR1bGUgSURzXG4gICAgcHJpdmF0ZSBDb2xvciBwcmltYXJ5Q29sb3IgPSBuZXcgQ29sb3IoMCwgMTM2LCAyMDQpO1xuXG4gICAgLy8gRW1wbG95ZWUgaW5mb3JtYXRpb25cbiAgICBwcml2YXRlIE5oYW5WaWVuIG5oYW5WaWVuO1xuXG4gICAgLy8gREFPc1xuICAgIHByaXZhdGUgTGljaFRyaW5oVGF1REFPIGxpY2hUcmluaFRhdURBTztcbiAgICBwcml2YXRlIENob05nb2lEQU8gY2hvTmdvaURBTztcbiAgICBwcml2YXRlIFRvYVRhdURBTyB0b2FUYXVEQU87XG4gICAgcHJpdmF0ZSBUYXVEQU8gdGF1REFPO1xuICAgIHByaXZhdGUgS2h1eWVuTWFpREFPIGtodXllbk1haURBTztcbiAgICBwcml2YXRlIEtoYWNoSGFuZ0RBTyBraGFjaEhhbmdEQU87XG4gICAgcHJpdmF0ZSBkYW8uTG9haUtoYWNoSGFuZ0RBTyBsb2FpS2hhY2hIYW5nREFPO1xuICAgIHByaXZhdGUgVmVUYXVEQU8gdmVUYXVEQU87XG4gICAgcHJpdmF0ZSBIb2FEb25EQU8gaG9hRG9uREFPO1xuICAgIHByaXZhdGUgQ2hpVGlldEhvYURvbkRBTyBjaGlUaWV0SG9hRG9uREFPO1xuICAgIHByaXZhdGUgTG9haUhvYURvbkRBTyBsb2FpSG9hRG9uREFPO1xuXG4gICAgLyoqXG4gICAgICogQ29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0gdGlja2V0c01hcCBNYXAgb2Ygc2VhdCBJRHMgdG8gc2NoZWR1bGUgSURzXG4gICAgICogQHBhcmFtIG52IFRoZSBlbXBsb3llZSB3aG8gaXMgcHJvY2Vzc2luZyB0aGUgcGF5bWVudFxuICAgICAqL1xuICAgIHB1YmxpYyBUaGFuaFRvYW5HVUkoTWFwPFN0cmluZywgU3RyaW5nPiB0aWNrZXRzTWFwLCBOaGFuVmllbiBudikgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgICAgIHRoaXMudGlja2V0c01hcCA9IHRpY2tldHNNYXA7XG4gICAgICAgIHRoaXMubmhhblZpZW4gPSBudjtcblxuICAgICAgICAvLyBJbml0aWFsaXplIERBT3NcbiAgICAgICAgbGljaFRyaW5oVGF1REFPID0gbmV3IExpY2hUcmluaFRhdURBT0ltcGwoKTtcbiAgICAgICAgY2hvTmdvaURBTyA9IG5ldyBDaG9OZ29pREFPSW1wbCgpO1xuICAgICAgICB0b2FUYXVEQU8gPSBuZXcgVG9hVGF1REFPSW1wbCgpO1xuICAgICAgICB0YXVEQU8gPSBuZXcgVGF1REFPSW1wbCgpO1xuICAgICAgICBraHV5ZW5NYWlEQU8gPSBuZXcgS2h1eWVuTWFpREFPSW1wbCgpO1xuICAgICAgICBraGFjaEhhbmdEQU8gPSBuZXcgS2hhY2hIYW5nREFPSW1wbCgpO1xuICAgICAgICBsb2FpS2hhY2hIYW5nREFPID0gbmV3IExvYWlLaGFjaEhhbmdEQU9JbXBsKCk7XG4gICAgICAgIHZlVGF1REFPID0gbmV3IFZlVGF1REFPSW1wbCgpO1xuICAgICAgICBob2FEb25EQU8gPSBuZXcgSG9hRG9uREFPSW1wbCgpO1xuICAgICAgICBjaGlUaWV0SG9hRG9uREFPID0gbmV3IENoaVRpZXRIb2FEb25EQU9JbXBsKCk7XG4gICAgICAgIGxvYWlIb2FEb25EQU8gPSBuZXcgTG9haUhvYURvbkRBT0ltcGwoKTtcblxuICAgICAgICBzZXRUaXRsZShcIlRoYW5oIHRvw6FuIHbDqSB0w6B1XCIpO1xuICAgICAgICBzZXRTaXplKDEwMDAsIDcwMCk7XG4gICAgICAgIHNldERlZmF1bHRDbG9zZU9wZXJhdGlvbihKRnJhbWUuRElTUE9TRV9PTl9DTE9TRSk7XG4gICAgICAgIHNldExvY2F0aW9uUmVsYXRpdmVUbyhudWxsKTtcblxuICAgICAgICBpbml0Q29tcG9uZW50cygpO1xuICAgICAgICBjYWxjdWxhdGVUb3RhbCgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEluaXRpYWxpemUgY29tcG9uZW50c1xuICAgICAqL1xuICAgIHByaXZhdGUgdm9pZCBpbml0Q29tcG9uZW50cygpIHtcbiAgICAgICAgLy8gTWFpbiBjb250YWluZXIgd2l0aCBwYWRkaW5nXG4gICAgICAgIG1haW5QYW5lbCA9IG5ldyBKUGFuZWwobmV3IEJvcmRlckxheW91dCgxMCwgMTApKTtcbiAgICAgICAgbWFpblBhbmVsLnNldEJvcmRlcihuZXcgRW1wdHlCb3JkZXIoMTUsIDE1LCAxNSwgMTUpKTtcblxuICAgICAgICAvLyBUaXRsZSBwYW5lbFxuICAgICAgICBKUGFuZWwgdGl0bGVQYW5lbCA9IGNyZWF0ZVRpdGxlUGFuZWwoKTtcbiAgICAgICAgbWFpblBhbmVsLmFkZCh0aXRsZVBhbmVsLCBCb3JkZXJMYXlvdXQuTk9SVEgpO1xuXG4gICAgICAgIC8vIEluaXRpYWxpemUgcHJvbW90aW9uQ29tYm9Cb3ggYmVmb3JlIGNyZWF0aW5nIHRpY2tldHMgdGFibGVcbiAgICAgICAgcHJvbW90aW9uQ29tYm9Cb3ggPSBuZXcgSkNvbWJvQm94PD4oKTtcbiAgICAgICAgcHJvbW90aW9uQ29tYm9Cb3guc2V0UHJlZmVycmVkU2l6ZShuZXcgRGltZW5zaW9uKDIwMCwgMzApKTtcblxuICAgICAgICAvLyBDZW50ZXIgcGFuZWwgY29udGFpbmluZyB0aWNrZXRzIHRhYmxlIGFuZCBib3R0b20gY29udHJvbHNcbiAgICAgICAgSlBhbmVsIGNlbnRlclBhbmVsID0gbmV3IEpQYW5lbChuZXcgQm9yZGVyTGF5b3V0KDAsIDEwKSk7XG5cbiAgICAgICAgLy8gQ3JlYXRlIHRpY2tldHMgdGFibGVcbiAgICAgICAgY3JlYXRlVGlja2V0c1RhYmxlKCk7XG4gICAgICAgIEpTY3JvbGxQYW5lIHRhYmxlU2Nyb2xsUGFuZSA9IG5ldyBKU2Nyb2xsUGFuZSh0aWNrZXRUYWJsZSk7XG4gICAgICAgIHRhYmxlU2Nyb2xsUGFuZS5zZXRCb3JkZXIoQm9yZGVyRmFjdG9yeS5jcmVhdGVMaW5lQm9yZGVyKG5ldyBDb2xvcigyMDAsIDIwMCwgMjAwKSkpO1xuICAgICAgICBjZW50ZXJQYW5lbC5hZGQodGFibGVTY3JvbGxQYW5lLCBCb3JkZXJMYXlvdXQuQ0VOVEVSKTtcblxuICAgICAgICAvLyBCb3R0b20gcGFuZWwgZm9yIGJ1dHRvbnMgYW5kIGRpc2NvdW50XG4gICAgICAgIEpQYW5lbCBib3R0b21QYW5lbCA9IG5ldyBKUGFuZWwobmV3IEJvcmRlckxheW91dCg1LCAwKSk7XG5cbiAgICAgICAgLy8gTGVmdCAtIFJlbW92ZSBhbGwgdGlja2V0cyBidXR0b25cbiAgICAgICAgSlBhbmVsIGJ1dHRvblBhbmVsID0gbmV3IEpQYW5lbChuZXcgRmxvd0xheW91dChGbG93TGF5b3V0LkxFRlQpKTtcbiAgICAgICAgSkJ1dHRvbiByZW1vdmVBbGxCdXR0b24gPSBuZXcgSkJ1dHRvbihcIljDs2EgdOG6pXQgY+G6oyBjw6FjIHbDqVwiKTtcbiAgICAgICAgcmVtb3ZlQWxsQnV0dG9uLnNldEljb24oY3JlYXRlVHJhc2hJY29uKCkpO1xuICAgICAgICByZW1vdmVBbGxCdXR0b24uYWRkQWN0aW9uTGlzdGVuZXIoZSAtPiByZW1vdmVBbGxUaWNrZXRzKCkpO1xuICAgICAgICBidXR0b25QYW5lbC5hZGQocmVtb3ZlQWxsQnV0dG9uKTtcbiAgICAgICAgYm90dG9tUGFuZWwuYWRkKGJ1dHRvblBhbmVsLCBCb3JkZXJMYXlvdXQuV0VTVCk7XG4uLi5cblxuICAgICAgICAvLyBDcmVhdGUgc291dGggcGFuZWwgZm9yIGN1c3RvbWVyIGluZm8gYW5kIHBheW1lbnQgYnV0dG9uXG4gICAgICAgIEpQYW5lbCBzb3V0aFBhbmVsID0gbmV3IEpQYW5lbChuZXcgQm9yZGVyTGF5b3V0KDAsIDEwKSk7XG5cbiAgICAgICAgLy8gQ3VzdG9tZXIgaW5mb3JtYXRpb24gc2VjdGlvblxuICAgICAgICBKUGFuZWwgY3VzdG9tZXJQYW5lbCA9IGNyZWF0ZUN1c3RvbWVySW5mb1BhbmVsKCk7XG4gICAgICAgIHNvdXRoUGFuZWwuYWRkKGN1c3RvbWVyUGFuZWwsIEJvcmRlckxheW91dC5OT1JUSCk7XG5cbiAgICAgICAgLy8gUGF5bWVudCBidXR0b25cbiAgICAgICAgSlBhbmVsIHBheW1lbnRQYW5lbCA9IG5ldyBKUGFuZWwobmV3IEZsb3dMYXlvdXQoRmxvd0xheW91dC5SSUdIVCkpO1xuICAgICAgICBKQnV0dG9uIHBheUJ1dHRvbiA9IG5ldyBKQnV0dG9uKFwiVGhhbmggdG/DoW5cIik7XG4gICAgICAgIHBheUJ1dHRvbi5zZXRCYWNrZ3JvdW5kKHByaW1hcnlDb2xvcik7XG4gICAgICAgIHBheUJ1dHRvbi5zZXRGb3JlZ3JvdW5kKENvbG9yLldISVRFKTtcbiAgICAgICAgcGF5QnV0dG9uLnNldEZvbnQobmV3IEZvbnQoXCJBcmlhbFwiLCBGb250LkJPTEQsIDE0KSk7XG4gICAgICAgIHBheUJ1dHRvbi5zZXRQcmVmZXJyZWRTaXplKG5ldyBEaW1lbnNpb24oMTIwLCAzNSkpO1xuICAgICAgICBwYXlCdXR0b24uYWRkQWN0aW9uTGlzdGVuZXIoZSAtPiBwcm9jZXNzUGF5bWVudCgpKTtcbiAgICAgICAgcGF5bWVudFBhbmVsLmFkZChwYXlCdXR0b24pO1xuICAgICAgICBzb3V0aFBhbmVsLmFkZChwYXltZW50UGFuZWwsIEJvcmRlckxheW91dC5TT1VUSCk7XG4uLi5cblxuICAgICAgICAgICAgaWRGaWVsZC5zZXRCb3JkZXIoQm9yZGVyRmFjdG9yeS5jcmVhdGVUaXRsZWRCb3JkZXIoXG4gICAgICAgICAgICAgICAgICAgIEJvcmRlckZhY3RvcnkuY3JlYXRlTGluZUJvcmRlcihuZXcgQ29sb3IoMjAwLCAyMDAsIDIwMCkpLFxuICAgICAgICAgICAgICAgICAgICBcIlPhu5EgZ2nhuqV5IHThu51cIixcbiAgICAgICAgICAgICAgICAgICAgVGl0bGVkQm9yZGVyLkRFRkFVTFRfSlVTVElGSUNBVElPTixcbiAgICAgICAgICAgICAgICAgICAgVGl0bGVkQm9yZGVyLlRPUCxcbiAgICAgICAgICAgICAgICAgICAgbmV3IEZvbnQoXCJBcmlhbFwiLCBGb250LlBMQUlOLCAxMCksXG4gICAgICAgICAgICAgICAgICAgIG5ldyBDb2xvcigxMDAsIDEwMCwgMTAwKVxuICAgICAgICAgICAgKSk7XG5cbiAgICAgICAgICAgIGFnZUZpZWxkLnNldEJvcmRlcihCb3JkZXJGYWN0b3J5LmNyZWF0ZVRpdGxlZEJvcmRlcihcbiAgICAgICAgICAgICAgICAgICAgQm9yZGVyRmFjdG9yeS5jcmVhdGVMaW5lQm9yZGVyKG5ldyBDb2xvcigyMDAsIDIwMCwgMjAwKSksXG4gICAgICAgICAgICAgICAgICAgIFwiVHXhu5VpIChjaG8gdHLhursgZW0pXCIsXG4gICAgICAgICAgICAgICAgICAgIFRpdGxlZEJvcmRlci5ERUZBVUxUX0pVU1RJRklDQVRJT04sXG4gICAgICAgICAgICAgICAgICAgIFRpdGxlZEJvcmRlci5UT1AsXG4gICAgICAgICAgICAgICAgICAgIG5ldyBGb250KFwiQXJpYWxcIiwgRm9udC5QTEFJTiwgMTApLFxuICAgICAgICAgICAgICAgICAgICBuZXcgQ29sb3IoMTAwLCAxMDAsIDEwMClcbiAgICAgICAgICAgICkpO1xuXG4gICAgICAgICAgICBhZGQobmFtZUZpZWxkKTtcbiAgICAgICAgICAgIGFkZCh0eXBlQ29tYm8pO1xuICAgICAgICAgICAgYWRkKGlkRmllbGQpO1xuICAgICAgICAgICAgYWRkKGFnZUZpZWxkKTtcblxuICAgICAgICAgICAgc2V0QmFja2dyb3VuZChDb2xvci5XSElURSk7XG4gICAgICAgIH1cbi4uLlxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBkb3VibGUgYW1vdW50UGFpZCA9IERvdWJsZS5wYXJzZURvdWJsZShhbW91bnRQYWlkRmllbGQuZ2V0VGV4dCgpLnRyaW0oKS5yZXBsYWNlKFwiLFwiLCBcIlwiKSk7XG4gICAgICAgICAgICBpZiAoYW1vdW50UGFpZCA8IHRvdGFsQW1vdW50KSB7XG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJT4buRIHRp4buBbiBraMOhY2ggxJHGsGEga2jDtG5nIMSR4bunIMSR4buDIHRoYW5oIHRvw6FuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBhbW91bnRQYWlkRmllbGQucmVxdWVzdEZvY3VzKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChOdW1iZXJGb3JtYXRFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIFwiU+G7kSB0aeG7gW4ga2jDoWNoIMSRxrBhIGtow7RuZyBo4bujcCBs4buHXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiTOG7l2lcIixcbiAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGFtb3VudFBhaWRGaWVsZC5yZXF1ZXN0Rm9jdXMoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNob3cgcGF5bWVudCBvcHRpb25zIGRpYWxvZ1xuICAgICAgICBTdHJpbmdbXSBvcHRpb25zID0ge1wiVGnhu4FuIG3hurd0XCIsIFwiVGjhursgdMOtbiBk4bulbmdcIiwgXCJDaHV54buDbiBraG/huqNuXCIsIFwiVsOtIMSRaeG7h24gdOG7rVwifTtcbiAgICAgICAgaW50IGNob2ljZSA9IEpPcHRpb25QYW5lLnNob3dPcHRpb25EaWFsb2coXG4gICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICBcIkNo4buNbiBwaMawxqFuZyB0aOG7qWMgdGhhbmggdG/DoW5cIixcbiAgICAgICAgICAgICAgICBcIlRoYW5oIHRvw6FuXCIsXG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuREVGQVVMVF9PUFRJT04sXG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuUVVFU1RJT05fTUVTU0FHRSxcbiAgICAgICAgICAgICAgICBudWxsLFxuICAgICAgICAgICAgICAgIG9wdGlvbnMsXG4gICAgICAgICAgICAgICAgb3B0aW9uc1swXVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIFByb2Nlc3MgYmFzZWQgb24gc2VsZWN0ZWQgcGF5bWVudCBtZXRob2RcbiAgICAgICAgaWYgKGNob2ljZSA+PSAwKSB7XG4gICAgICAgICAgICAvLyBTaG93IHByb2Nlc3NpbmcgbWVzc2FnZVxuICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIFwixJBhbmcgeOG7rSBsw70gdGhhbmggdG/DoW4uLi5cIixcbiAgICAgICAgICAgICAgICAgICAgXCJUaGFuaCB0b8OhblwiLFxuICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5JTkZPUk1BVElPTl9NRVNTQUdFXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIEdldCBjdXN0b21lciBpbmZvcm1hdGlvbiBmcm9tIGZvcm1cbiAgICAgICAgICAgICAgICBTdHJpbmcgY3VzdG9tZXJOYW1lID0gbmFtZUZpZWxkLmdldFRleHQoKS50cmltKCk7XG4gICAgICAgICAgICAgICAgU3RyaW5nIGlkQ2FyZCA9IGlkQ2FyZEZpZWxkLmdldFRleHQoKS50cmltKCk7XG4gICAgICAgICAgICAgICAgU3RyaW5nIHBob25lID0gcGhvbmVGaWVsZC5nZXRUZXh0KCkudHJpbSgpO1xuICAgICAgICAgICAgICAgIFN0cmluZyBlbWFpbCA9IGVtYWlsRmllbGQuZ2V0VGV4dCgpLnRyaW0oKTsgLy8gVGhpcyBpcyB0aGUgYWRkcmVzcyBmaWVsZCBhcyBwZXIgcmVxdWlyZW1lbnRzXG5cbiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiBjdXN0b21lciBleGlzdHMgYnkgSUQgY2FyZCBhbmQgcGhvbmUgbnVtYmVyXG4gICAgICAgICAgICAgICAgS2hhY2hIYW5nIGV4aXN0aW5nQ3VzdG9tZXIgPSBraGFjaEhhbmdEQU8uZmluZEJ5SWRDYXJkQW5kUGhvbmUoaWRDYXJkLCBwaG9uZSk7XG4uLi5cblxuICAgICAgICAgICAgICAgICAgICAvLyBTYXZlIGludm9pY2UgZGV0YWlsIHRvIGRhdGFiYXNlXG4gICAgICAgICAgICAgICAgICAgIGlmICghY2hpVGlldEhvYURvbkRBTy5zYXZlKGRldGFpbCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oXCJM4buXaSBraGkgbMawdSBjaGkgdGnhur90IGjDs2EgxJHGoW4gY2hvIHbDqTogXCIgKyB0aWNrZXQuZ2V0TWFWZSgpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBjaGFuZ2UgZm9yIGNhc2ggcGF5bWVudFxuICAgICAgICAgICAgICAgIFN0cmluZyBjaGFuZ2VNZXNzYWdlID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoY2hvaWNlID09IDApIHsgLy8gQ2FzaCBwYXltZW50XG4gICAgICAgICAgICAgICAgICAgIGRvdWJsZSBhbW91bnRQYWlkID0gRG91YmxlLnBhcnNlRG91YmxlKGFtb3VudFBhaWRGaWVsZC5nZXRUZXh0KCkudHJpbSgpLnJlcGxhY2UoXCIsXCIsIFwiXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgZG91YmxlIGNoYW5nZSA9IGFtb3VudFBhaWQgLSB0b3RhbEFtb3VudDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoYW5nZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZU1lc3NhZ2UgPSBcIlxcblRp4buBbiB0aOG7kWkgbOG6oWk6IFwiICsgZm9ybWF0Q3VycmVuY3koY2hhbmdlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFNob3cgc3VjY2VzcyBtZXNzYWdlXG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJUaGFuaCB0b8OhbiB0aMOgbmggY8O0bmchIFbDqSBj4bunYSBi4bqhbiDEkcOjIMSRxrDhu6NjIMSR4bq3dC5cIiArIGNoYW5nZU1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIlRow6BuaCBjw7RuZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuSU5GT1JNQVRJT05fTUVTU0FHRVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICAvLyBDbG9zZSBjaGVja291dCB3aW5kb3dcbiAgICAgICAgICAgICAgICBkaXNwb3NlKCk7XG4uLi5cbiIsImlzRXJyb3IiOmZhbHNlLCJyZXF1ZXN0SWQiOiIifX0sImQxOTM4YjdjLTU0NjctNDZjMi1hYzViLWEyNzIzMGU2YmUwZDt0b29sdV8wMTlRMWNmUkNWc2hrc2lkUTFjbm5kN0UiOnsicGhhc2UiOjUsInJlc3VsdCI6eyJ0ZXh0IjoiVGhlIGZvbGxvd2luZyBjb2RlIHNlY3Rpb25zIHdlcmUgcmV0cmlldmVkOlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9ndWlDbGllbnQvTWFpbkdVSS5qYXZhXG5wYWNrYWdlIGd1aUNsaWVudDtcblxuaW1wb3J0IGRhby5Eb2lWZURBTztcbmltcG9ydCBkYW8uaW1wbC5Eb2lWZURBT0ltcGw7XG5pbXBvcnQgZGFvLmltcGwuTmhhblZpZW5EQU9JbXBsO1xuaW1wb3J0IG1vZGVsLk5oYW5WaWVuO1xuXG5pbXBvcnQgamF2YXguc3dpbmcuKjtcbmltcG9ydCBqYXZhLmF3dC4qO1xuaW1wb3J0IGphdmEuYXd0LmV2ZW50Lk1vdXNlQWRhcHRlcjtcbmltcG9ydCBqYXZhLmF3dC5ldmVudC5Nb3VzZUV2ZW50O1xuaW1wb3J0IGphdmEuYXd0LmV2ZW50LldpbmRvd0FkYXB0ZXI7XG5pbXBvcnQgamF2YS5hd3QuZXZlbnQuV2luZG93RXZlbnQ7XG5pbXBvcnQgamF2YS5hd3QuaW1hZ2UuQnVmZmVyZWRJbWFnZTtcbmltcG9ydCBqYXZhLnJtaS5SZW1vdGVFeGNlcHRpb247XG5pbXBvcnQgamF2YS50aW1lLkxvY2FsRGF0ZTtcbmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDtcbmltcG9ydCBqYXZhLnV0aWwuTWFwO1xuXG5wdWJsaWMgY2xhc3MgTWFpbkdVSSBleHRlbmRzIEpGcmFtZSB7XG5cbiAgICBwcml2YXRlIEpQYW5lbCBjb250ZW50UGFuZWw7IC8vIENvbnRlbnQgcGFuZWwgbWFuYWdlZCBieSBDYXJkTGF5b3V0XG4gICAgcHJpdmF0ZSBDYXJkTGF5b3V0IGNhcmRMYXlvdXQ7IC8vIENhcmRMYXlvdXQgZm9yIHN3aXRjaGluZyBwYW5lbHNcbiAgICBwcml2YXRlIE1hcDxTdHJpbmcsIEpQYW5lbD4gcGFuZWxNYXA7IC8vIENhY2hlIGZvciBwYW5lbHNcbiAgICBwcml2YXRlIExpY2hUcmluaFRhdVBhbmVsIGxpY2hUcmluaFRhdVBhbmVsO1xuICAgIHByaXZhdGUgTmhhblZpZW4gbmhhblZpZW47XG5cbiAgICBwdWJsaWMgTWFpbkdVSShOaGFuVmllbiBudikge1xuICAgICAgICBuaGFuVmllbiA9IG52O1xuICAgICAgICBzZXRUaXRsZShcIlF14bqjbiBsw70gdMOgdSBo4buPYVwiKTtcbiAgICAgICAgc2V0U2l6ZSgxMjAwLCA4MDApO1xuICAgICAgICBzZXREZWZhdWx0Q2xvc2VPcGVyYXRpb24oSkZyYW1lLkVYSVRfT05fQ0xPU0UpO1xuICAgICAgICBzZXRMb2NhdGlvblJlbGF0aXZlVG8obnVsbCk7XG5cbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBwYW5lbCBtYXBcbiAgICAgICAgcGFuZWxNYXAgPSBuZXcgSGFzaE1hcDw+KCk7XG5cbiAgICAgICAgLy8gQ3JlYXRlIHRoZSBtYWluIGxheW91dFxuICAgICAgICBKUGFuZWwgbWFpblBhbmVsID0gbmV3IEpQYW5lbChuZXcgQm9yZGVyTGF5b3V0KCkpO1xuXG4gICAgICAgIC8vIENyZWF0ZSBoZWFkZXJcbiAgICAgICAgSlBhbmVsIGhlYWRlclBhbmVsID0gY3JlYXRlSGVhZGVyUGFuZWwoKTtcbiAgICAgICAgbWFpblBhbmVsLmFkZChoZWFkZXJQYW5lbCwgQm9yZGVyTGF5b3V0Lk5PUlRIKTtcblxuICAgICAgICAvLyBDcmVhdGUgdmVydGljYWwgbWVudVxuICAgICAgICBKUGFuZWwgdmVydGljYWxNZW51ID0gY3JlYXRlVmVydGljYWxNZW51KCk7XG4gICAgICAgIG1haW5QYW5lbC5hZGQodmVydGljYWxNZW51LCBCb3JkZXJMYXlvdXQuV0VTVCk7XG5cbiAgICAgICAgLy8gQ3JlYXRlIGNvbnRlbnQgcGFuZWwgd2l0aCBDYXJkTGF5b3V0XG4gICAgICAgIGNhcmRMYXlvdXQgPSBuZXcgQ2FyZExheW91dCgpO1xuICAgICAgICBjb250ZW50UGFuZWwgPSBuZXcgSlBhbmVsKGNhcmRMYXlvdXQpO1xuXG4gICAgICAgIC8vIEFkZCBkZWZhdWx0IGNvbnRlbnQgcGFuZWxcbiAgICAgICAgSlBhbmVsIGRlZmF1bHRQYW5lbCA9IGNyZWF0ZURlZmF1bHRDb250ZW50UGFuZWwoKTtcbiAgICAgICAgY29udGVudFBhbmVsLmFkZChkZWZhdWx0UGFuZWwsIFwiVHJhbmcgY2jhu6dcIik7XG4gICAgICAgIHBhbmVsTWFwLnB1dChcIlRyYW5nIGNo4bunXCIsIGRlZmF1bHRQYW5lbCk7XG5cbiAgICAgICAgbWFpblBhbmVsLmFkZChjb250ZW50UGFuZWwsIEJvcmRlckxheW91dC5DRU5URVIpO1xuXG4gICAgICAgIGFkZChtYWluUGFuZWwpO1xuICAgIH1cblxuICAgIHByaXZhdGUgSlBhbmVsIGNyZWF0ZUhlYWRlclBhbmVsKCkge1xuICAgICAgICBKUGFuZWwgaGVhZGVyUGFuZWwgPSBuZXcgSlBhbmVsKG5ldyBCb3JkZXJMYXlvdXQoKSk7XG4gICAgICAgIGhlYWRlclBhbmVsLnNldEJhY2tncm91bmQobmV3IENvbG9yKDQxLCAxMjgsIDE4NSkpOyAvLyBCbHVlIGhlYWRlciBiYWNrZ3JvdW5kXG4gICAgICAgIGhlYWRlclBhbmVsLnNldFByZWZlcnJlZFNpemUobmV3IERpbWVuc2lvbigwLCA2MCkpO1xuXG4gICAgICAgIEpMYWJlbCB0aXRsZUxhYmVsID0gbmV3IEpMYWJlbChcIkjhu4cgdGjhu5FuZyBxdeG6o24gbMO9IHTDoHUgaOG7j2FcIiwgSkxhYmVsLkNFTlRFUik7XG4gICAgICAgIHRpdGxlTGFiZWwuc2V0Rm9udChuZXcgRm9udChcIkFyaWFsXCIsIEZvbnQuQk9MRCwgMjQpKTtcbiAgICAgICAgdGl0bGVMYWJlbC5zZXRGb3JlZ3JvdW5kKENvbG9yLldISVRFKTtcblxuICAgICAgICBoZWFkZXJQYW5lbC5hZGQodGl0bGVMYWJlbCwgQm9yZGVyTGF5b3V0LkNFTlRFUik7XG4gICAgICAgIHJldHVybiBoZWFkZXJQYW5lbDtcbiAgICB9XG5cbiAgICBAT3ZlcnJpZGVcbiAgICBwdWJsaWMgdm9pZCBkaXNwb3NlKCkge1xuICAgICAgICAvLyBHaeG6o2kgcGjDs25nIGPDoWMgdMOgaSBuZ3V5w6puXG4gICAgICAgIGlmIChsaWNoVHJpbmhUYXVQYW5lbCAhPSBudWxsKSB7XG4gICAgICAgICAgICBsaWNoVHJpbmhUYXVQYW5lbC5zaHV0ZG93bigpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gR+G7jWkgcGjGsMahbmcgdGjhu6ljIGRpc3Bvc2UgY+G7p2EgbOG7m3AgY2hhXG4gICAgICAgIHN1cGVyLmRpc3Bvc2UoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHZvaWQgc2V0dXBXaW5kb3dMaXN0ZW5lcnMoKSB7XG4gICAgICAgIGFkZFdpbmRvd0xpc3RlbmVyKG5ldyBXaW5kb3dBZGFwdGVyKCkge1xuICAgICAgICAgICAgQE92ZXJyaWRlXG4gICAgICAgICAgICBwdWJsaWMgdm9pZCB3aW5kb3dDbG9zaW5nKFdpbmRvd0V2ZW50IGUpIHtcbiAgICAgICAgICAgICAgICAvLyBHaeG6o2kgcGjDs25nIHTDoGkgbmd1ecOqbiB0csaw4bubYyBraGkgxJHDs25nXG4gICAgICAgICAgICAgICAgaWYgKGxpY2hUcmluaFRhdVBhbmVsICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgbGljaFRyaW5oVGF1UGFuZWwuc2h1dGRvd24oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZGlzcG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIEpQYW5lbCBjcmVhdGVWZXJ0aWNhbE1lbnUoKSB7XG4gICAgICAgIEpQYW5lbCBtZW51UGFuZWwgPSBuZXcgSlBhbmVsKCk7XG4gICAgICAgIG1lbnVQYW5lbC5zZXRMYXlvdXQobmV3IEJveExheW91dChtZW51UGFuZWwsIEJveExheW91dC5ZX0FYSVMpKTtcbiAgICAgICAgbWVudVBhbmVsLnNldEJhY2tncm91bmQobmV3IENvbG9yKDUyLCA3MywgOTQpKTsgLy8gRGFyayBncmF5IG1lbnUgYmFja2dyb3VuZFxuICAgICAgICBtZW51UGFuZWwuc2V0UHJlZmVycmVkU2l6ZShuZXcgRGltZW5zaW9uKDI1MCwgMCkpO1xuXG4gICAgICAgIFN0cmluZ1tdIG1lbnVJdGVtcyA9IHtcbiAgICAgICAgICAgICAgICBcIlRyYW5nIGNo4bunXCIsIFwiVGjDtG5nIHRpbiBob+G6oXQgxJHhu5luZ1wiLCBcIlF14bqjbiBsw70ga2jDoWNoIGjDoG5nXCIsXG4gICAgICAgICAgICAgICAgXCJRdeG6o24gbMO9IHbDqVwiLCBcIlF14bqjbiBsw70gbOG7i2NoIHRyw6xuaFwiLCBcIkLDoW8gY8Ohb1wiLCBcIlRyYSBj4bupdSB2w6lcIiwgXCLEkOG7lWkgdsOpXCIsIFwiVHLhuqMgdsOpXCIsIFwiUXXhuqNuIGzDvSBuaMOibiB2acOqblwiLFxuICAgICAgICAgICAgICAgIFwiVGjhu5FuZyBrw6ogc+G7kSBsxrDhu6NuZyB2w6kgdGhlbyB0aOG7nWkgZ2lhblwiLCBcIlF14bqjbiBsw70ga2h1eeG6v24gbcOjaVwiXG4gICAgICAgIH07XG5cbiAgICAgICAgZm9yIChTdHJpbmcgaXRlbSA6IG1lbnVJdGVtcykge1xuICAgICAgICAgICAgSlBhbmVsIG1lbnVJdGVtUGFuZWwgPSBuZXcgSlBhbmVsKG5ldyBCb3JkZXJMYXlvdXQoKSk7XG4gICAgICAgICAgICBtZW51SXRlbVBhbmVsLnNldEJhY2tncm91bmQobmV3IENvbG9yKDUyLCA3MywgOTQpKTtcbiAgICAgICAgICAgIG1lbnVJdGVtUGFuZWwuc2V0TWF4aW11bVNpemUobmV3IERpbWVuc2lvbigyNTAsIDUwKSk7XG5cbiAgICAgICAgICAgIEpMYWJlbCBtZW51TGFiZWwgPSBuZXcgSkxhYmVsKGl0ZW0pO1xuICAgICAgICAgICAgbWVudUxhYmVsLnNldEZvcmVncm91bmQoQ29sb3IuV0hJVEUpO1xuICAgICAgICAgICAgbWVudUxhYmVsLnNldEZvbnQobmV3IEZvbnQoXCJBcmlhbFwiLCBGb250LlBMQUlOLCAxNikpO1xuICAgICAgICAgICAgbWVudUxhYmVsLnNldEJvcmRlcihCb3JkZXJGYWN0b3J5LmNyZWF0ZUVtcHR5Qm9yZGVyKDEwLCAyMCwgMTAsIDEwKSk7XG5cbiAgICAgICAgICAgIG1lbnVJdGVtUGFuZWwuYWRkKG1lbnVMYWJlbCwgQm9yZGVyTGF5b3V0LkNFTlRFUik7XG5cbiAgICAgICAgICAgIC8vIEhvdmVyIGVmZmVjdFxuICAgICAgICAgICAgbWVudUl0ZW1QYW5lbC5hZGRNb3VzZUxpc3RlbmVyKG5ldyBNb3VzZUFkYXB0ZXIoKSB7XG4gICAgICAgICAgICAgICAgQE92ZXJyaWRlXG4gICAgICAgICAgICAgICAgcHVibGljIHZvaWQgbW91c2VFbnRlcmVkKE1vdXNlRXZlbnQgZSkge1xuICAgICAgICAgICAgICAgICAgICBtZW51SXRlbVBhbmVsLnNldEJhY2tncm91bmQobmV3IENvbG9yKDQxLCAxMjgsIDE4NSkpOyAvLyBCbHVlIGhvdmVyIGJhY2tncm91bmRcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBAT3ZlcnJpZGVcbiAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBtb3VzZUV4aXRlZChNb3VzZUV2ZW50IGUpIHtcbiAgICAgICAgICAgICAgICAgICAgbWVudUl0ZW1QYW5lbC5zZXRCYWNrZ3JvdW5kKG5ldyBDb2xvcig1MiwgNzMsIDk0KSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgQE92ZXJyaWRlXG4gICAgICAgICAgICAgICAgcHVibGljIHZvaWQgbW91c2VDbGlja2VkKE1vdXNlRXZlbnQgZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBTd2l0Y2ggY29udGVudCBiYXNlZCBvbiB0aGUgbWVudSBpdGVtIGNsaWNrZWRcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoVG9QYW5lbChpdGVtKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgbWVudVBhbmVsLmFkZChtZW51SXRlbVBhbmVsKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBtZW51UGFuZWw7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBKUGFuZWwgY3JlYXRlRGVmYXVsdENvbnRlbnRQYW5lbCgpIHtcbiAgICAgICAgSlBhbmVsIHBhbmVsID0gbmV3IEpQYW5lbChuZXcgQm9yZGVyTGF5b3V0KCkpO1xuICAgICAgICBwYW5lbC5zZXRCYWNrZ3JvdW5kKENvbG9yLldISVRFKTtcblxuICAgICAgICBKTGFiZWwgY29udGVudExhYmVsID0gbmV3IEpMYWJlbChcIkNow6BvIG3hu6tuZyDEkeG6v24gaOG7hyB0aOG7kW5nIHF14bqjbiBsw70gdMOgdSBo4buPYSFcIiwgSkxhYmVsLkNFTlRFUik7XG4gICAgICAgIGNvbnRlbnRMYWJlbC5zZXRGb250KG5ldyBGb250KFwiQXJpYWxcIiwgRm9udC5JVEFMSUMsIDE4KSk7XG4gICAgICAgIGNvbnRlbnRMYWJlbC5zZXRGb3JlZ3JvdW5kKENvbG9yLkdSQVkpO1xuXG4gICAgICAgIHBhbmVsLmFkZChjb250ZW50TGFiZWwsIEJvcmRlckxheW91dC5DRU5URVIpO1xuICAgICAgICByZXR1cm4gcGFuZWw7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBKUGFuZWwgY3JlYXRlUGxhY2Vob2xkZXJQYW5lbChTdHJpbmcgbWVudU5hbWUpIHtcbiAgICAgICAgSlBhbmVsIHBhbmVsID0gbmV3IEpQYW5lbChuZXcgQm9yZGVyTGF5b3V0KCkpO1xuICAgICAgICBwYW5lbC5zZXRCYWNrZ3JvdW5kKENvbG9yLldISVRFKTtcblxuICAgICAgICBKTGFiZWwgcGxhY2Vob2xkZXJMYWJlbCA9IG5ldyBKTGFiZWwoXCJO4buZaSBkdW5nIGNobyBcIiArIG1lbnVOYW1lICsgXCIgxJFhbmcgxJHGsOG7o2MgcGjDoXQgdHJp4buDbi5cIiwgSkxhYmVsLkNFTlRFUik7XG4gICAgICAgIHBsYWNlaG9sZGVyTGFiZWwuc2V0Rm9udChuZXcgRm9udChcIkFyaWFsXCIsIEZvbnQuSVRBTElDLCAxOCkpO1xuICAgICAgICBwbGFjZWhvbGRlckxhYmVsLnNldEZvcmVncm91bmQoQ29sb3IuR1JBWSk7XG5cbiAgICAgICAgcGFuZWwuYWRkKHBsYWNlaG9sZGVyTGFiZWwsIEJvcmRlckxheW91dC5DRU5URVIpO1xuICAgICAgICByZXR1cm4gcGFuZWw7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSB2b2lkIHN3aXRjaFRvUGFuZWwoU3RyaW5nIHBhbmVsTmFtZSkge1xuICAgICAgICAvLyBDaGVjayBpZiB0aGUgcGFuZWwgYWxyZWFkeSBleGlzdHMgaW4gdGhlIGNhY2hlXG4gICAgICAgIGlmICghcGFuZWxNYXAuY29udGFpbnNLZXkocGFuZWxOYW1lKSkge1xuICAgICAgICAgICAgSlBhbmVsIG5ld1BhbmVsO1xuXG4gICAgICAgICAgICBpZiAocGFuZWxOYW1lLmVxdWFscyhcIlF14bqjbiBsw70ga2jDoWNoIGjDoG5nXCIpKSB7XG4gICAgICAgICAgICAgICAgLy8gRGlzcGxheSBsb2FkaW5nIGludGVyZmFjZVxuICAgICAgICAgICAgICAgIEpQYW5lbCBsb2FkaW5nUGFuZWwgPSBjcmVhdGVMb2FkaW5nUGFuZWwoXCLEkGFuZyB04bqjaSBk4buvIGxp4buHdSBraMOhY2ggaMOgbmcuLi5cIik7XG4gICAgICAgICAgICAgICAgY29udGVudFBhbmVsLmFkZChsb2FkaW5nUGFuZWwsIFwiTG9hZGluZ19cIiArIHBhbmVsTmFtZSk7XG4gICAgICAgICAgICAgICAgY2FyZExheW91dC5zaG93KGNvbnRlbnRQYW5lbCwgXCJMb2FkaW5nX1wiICsgcGFuZWxOYW1lKTtcblxuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBjdXN0b21lciBtYW5hZ2VtZW50IHBhbmVsIGluIGEgc2VwYXJhdGUgdGhyZWFkXG4gICAgICAgICAgICAgICAgU3dpbmdXb3JrZXI8UXVhbkx5S2hhY2hIYW5nUGFuZWwsIFZvaWQ+IHdvcmtlciA9IG5ldyBTd2luZ1dvcmtlcjw+KCkge1xuICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGVcbiAgICAgICAgICAgICAgICAgICAgcHJvdGVjdGVkIFF1YW5MeUtoYWNoSGFuZ1BhbmVsIGRvSW5CYWNrZ3JvdW5kKCkgdGhyb3dzIEV4Y2VwdGlvbiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFF1YW5MeUtoYWNoSGFuZ1BhbmVsKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGVcbiAgICAgICAgICAgICAgICAgICAgcHJvdGVjdGVkIHZvaWQgZG9uZSgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gR2V0IHRoZSBwYW5lbCBhZnRlciBpdCdzIGNyZWF0ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBRdWFuTHlLaGFjaEhhbmdQYW5lbCBwYW5lbCA9IGdldCgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkIHRvIGNhY2hlIGFuZCBkaXNwbGF5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFBhbmVsLmFkZChwYW5lbCwgcGFuZWxOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYW5lbE1hcC5wdXQocGFuZWxOYW1lLCBwYW5lbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyZExheW91dC5zaG93KGNvbnRlbnRQYW5lbCwgcGFuZWxOYW1lKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBsb2FkaW5nIHBhbmVsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFBhbmVsLnJlbW92ZShsb2FkaW5nUGFuZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKE1haW5HVUkudGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiS2jDtG5nIHRo4buDIHThuqNpIGThu68gbGnhu4d1IGtow6FjaCBow6BuZzogXCIgKyBlLmdldE1lc3NhZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2kga+G6v3QgbuG7kWlcIiwgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyZExheW91dC5zaG93KGNvbnRlbnRQYW5lbCwgXCJUcmFuZyBjaOG7p1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB3b3JrZXIuZXhlY3V0ZSgpO1xuICAgICAgICAgICAgICAgIHJldHVybjsgLy8gRXhpdCBlYXJseSwgZG9uJ3QgZXhlY3V0ZSB0aGUgcmVzdCBvZiB0aGUgbWV0aG9kXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhbmVsTmFtZS5lcXVhbHMoXCJRdeG6o24gbMO9IGzhu4tjaCB0csOsbmhcIikpIHtcbiAgICAgICAgICAgICAgICAvLyBIaeG7g24gdGjhu4sgZ2lhbyBkaeG7h24gdOG6o2kgZOG7ryBsaeG7h3VcbiAgICAgICAgICAgICAgICBKUGFuZWwgbG9hZGluZ1BhbmVsID0gY3JlYXRlTG9hZGluZ1BhbmVsKFwixJBhbmcgdOG6o2kgZOG7ryBsaeG7h3UgbOG7i2NoIHRyw6xuaC4uLlwiKTtcbiAgICAgICAgICAgICAgICBjb250ZW50UGFuZWwuYWRkKGxvYWRpbmdQYW5lbCwgXCJMb2FkaW5nX1wiICsgcGFuZWxOYW1lKTtcbiAgICAgICAgICAgICAgICBjYXJkTGF5b3V0LnNob3coY29udGVudFBhbmVsLCBcIkxvYWRpbmdfXCIgKyBwYW5lbE5hbWUpO1xuXG4gICAgICAgICAgICAgICAgLy8gVOG6oW8gcGFuZWwgcXXhuqNuIGzDvSBs4buLY2ggdHLDrG5oIHRyb25nIGx14buTbmcgcmnDqm5nXG4gICAgICAgICAgICAgICAgU3dpbmdXb3JrZXI8TGljaFRyaW5oVGF1UGFuZWwsIFZvaWQ+IHdvcmtlciA9IG5ldyBTd2luZ1dvcmtlcjw+KCkge1xuICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGVcbiAgICAgICAgICAgICAgICAgICAgcHJvdGVjdGVkIExpY2hUcmluaFRhdVBhbmVsIGRvSW5CYWNrZ3JvdW5kKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBMaWNoVHJpbmhUYXVQYW5lbCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlXG4gICAgICAgICAgICAgICAgICAgIHByb3RlY3RlZCB2b2lkIGRvbmUoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEzhuqV5IHBhbmVsIHNhdSBraGkgxJHDoyB04bqhbyB4b25nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTGljaFRyaW5oVGF1UGFuZWwgcGFuZWwgPSBnZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWNoVHJpbmhUYXVQYW5lbCA9IHBhbmVsO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGjDqm0gdsOgbyBjYWNoZSB2w6AgaGnhu4NuIHRo4buLXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFBhbmVsLmFkZChwYW5lbCwgcGFuZWxOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYW5lbE1hcC5wdXQocGFuZWxOYW1lLCBwYW5lbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyZExheW91dC5zaG93KGNvbnRlbnRQYW5lbCwgcGFuZWxOYW1lKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFjDs2EgcGFuZWwgbG9hZGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRQYW5lbC5yZW1vdmUobG9hZGluZ1BhbmVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhNYWluR1VJLnRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIktow7RuZyB0aOG7gyB04bqjaSBk4buvIGxp4buHdTogXCIgKyBlLmdldE1lc3NhZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2kga+G6v3QgbuG7kWlcIiwgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyZExheW91dC5zaG93KGNvbnRlbnRQYW5lbCwgXCJUcmFuZyBjaOG7p1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuLi4uXG5cbiAgICAgICAgICAgICAgICAvLyBU4bqhbyBwYW5lbCBxdeG6o24gbMO9IHbDqSB0cm9uZyBsdeG7k25nIHJpw6puZ1xuICAgICAgICAgICAgICAgIFN3aW5nV29ya2VyPERvaVZlUGFuZWwsIFZvaWQ+IHdvcmtlciA9IG5ldyBTd2luZ1dvcmtlcjw+KCkge1xuICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGVcbiAgICAgICAgICAgICAgICAgICAgcHJvdGVjdGVkIERvaVZlUGFuZWwgZG9JbkJhY2tncm91bmQoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERvaVZlUGFuZWwobmhhblZpZW4pO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlXG4gICAgICAgICAgICAgICAgICAgIHByb3RlY3RlZCB2b2lkIGRvbmUoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEzhuqV5IHBhbmVsIHNhdSBraGkgxJHDoyB04bqhbyB4b25nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgRG9pVmVQYW5lbCBwYW5lbCA9IGdldCgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGjDqm0gdsOgbyBjYWNoZSB2w6AgaGnhu4NuIHRo4buLXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFBhbmVsLmFkZChwYW5lbCwgcGFuZWxOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYW5lbE1hcC5wdXQocGFuZWxOYW1lLCBwYW5lbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyZExheW91dC5zaG93KGNvbnRlbnRQYW5lbCwgcGFuZWxOYW1lKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFjDs2EgcGFuZWwgbG9hZGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRQYW5lbC5yZW1vdmUobG9hZGluZ1BhbmVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhNYWluR1VJLnRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIktow7RuZyB0aOG7gyB04bqjaSBk4buvIGxp4buHdTogXCIgKyBlLmdldE1lc3NhZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2kga+G6v3QgbuG7kWlcIiwgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyZExheW91dC5zaG93KGNvbnRlbnRQYW5lbCwgXCJUcmFuZyBjaOG7p1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4uLi5cblxuICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGVcbiAgICAgICAgICAgICAgICAgICAgcHJvdGVjdGVkIHZvaWQgZG9uZSgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTOG6pXkgcGFuZWwgc2F1IGtoaSDEkcOjIHThuqFvIHhvbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUcmFWZVBhbmVsIHBhbmVsID0gZ2V0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGjDqm0gdsOgbyBjYWNoZSB2w6AgaGnhu4NuIHRo4buLXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFBhbmVsLmFkZChwYW5lbCwgcGFuZWxOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYW5lbE1hcC5wdXQocGFuZWxOYW1lLCBwYW5lbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyZExheW91dC5zaG93KGNvbnRlbnRQYW5lbCwgcGFuZWxOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBYw7NhIHBhbmVsIGxvYWRpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50UGFuZWwucmVtb3ZlKGxvYWRpbmdQYW5lbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coTWFpbkdVSS50aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJLaMO0bmcgdGjhu4MgdOG6o2kgZOG7ryBsaeG7h3UgdHLhuqMgdsOpOiBcIiArIGUuZ2V0TWVzc2FnZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaSBr4bq/dCBu4buRaVwiLCBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkTGF5b3V0LnNob3coY29udGVudFBhbmVsLCBcIlRyYW5nIGNo4bunXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB3b3JrZXIuZXhlY3V0ZSgpO1xuICAgICAgICAgICAgICAgIHJldHVybjsgLy8gVGhvw6F0IHPhu5ttXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhbmVsTmFtZS5lcXVhbHMoXCJRdeG6o24gbMO9IG5ow6JuIHZpw6puXCIpKSB7XG4gICAgICAgICAgICAgICAgLy8gSGnhu4NuIHRo4buLIGdpYW8gZGnhu4duIHThuqNpIGThu68gbGnhu4d1XG4gICAgICAgICAgICAgICAgSlBhbmVsIGxvYWRpbmdQYW5lbCA9IGNyZWF0ZUxvYWRpbmdQYW5lbChcIsSQYW5nIHThuqNpIGThu68gbGnhu4d1IG5ow6JuIHZpw6puLi4uXCIpO1xuICAgICAgICAgICAgICAgIGNvbnRlbnRQYW5lbC5hZGQobG9hZGluZ1BhbmVsLCBcIkxvYWRpbmdfXCIgKyBwYW5lbE5hbWUpO1xuICAgICAgICAgICAgICAgIGNhcmRMYXlvdXQuc2hvdyhjb250ZW50UGFuZWwsIFwiTG9hZGluZ19cIiArIHBhbmVsTmFtZSk7XG5cbiAgICAgICAgICAgICAgICAvLyBU4bqhbyBwYW5lbCB0cuG6oyB2w6kgdHJvbmcgbHXhu5NuZyByacOqbmdcbiAgICAgICAgICAgICAgICBTd2luZ1dvcmtlcjxRdWFuTHlOaGFuVmllblBhbmVsLCBWb2lkPiB3b3JrZXIgPSBuZXcgU3dpbmdXb3JrZXI8PigpIHtcbiAgICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlXG4gICAgICAgICAgICAgICAgICAgIHByb3RlY3RlZCBRdWFuTHlOaGFuVmllblBhbmVsIGRvSW5CYWNrZ3JvdW5kKCkgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFF1YW5MeU5oYW5WaWVuUGFuZWwoKTsgLy8gVHJhVmVQYW5lbCBz4bq9IHThu7Ega+G6v3QgbuG7kWkgUk1JXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGVcbiAgICAgICAgICAgICAgICAgICAgcHJvdGVjdGVkIHZvaWQgZG9uZSgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTOG6pXkgcGFuZWwgc2F1IGtoaSDEkcOjIHThuqFvIHhvbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBRdWFuTHlOaGFuVmllblBhbmVsIHBhbmVsID0gZ2V0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaMOqbSB2w6BvIGNhY2hlIHbDoCBoaeG7g24gdGjhu4tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50UGFuZWwuYWRkKHBhbmVsLCBwYW5lbE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhbmVsTWFwLnB1dChwYW5lbE5hbWUsIHBhbmVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkTGF5b3V0LnNob3coY29udGVudFBhbmVsLCBwYW5lbE5hbWUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gWMOzYSBwYW5lbCBsb2FkaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFBhbmVsLnJlbW92ZShsb2FkaW5nUGFuZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKE1haW5HVUkudGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiS2jDtG5nIHRo4buDIHThuqNpIGThu68gbGnhu4d1IG5ow6JuIHZpw6puOiBcIiArIGUuZ2V0TWVzc2FnZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaSBr4bq/dCBu4buRaVwiLCBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkTGF5b3V0LnNob3coY29udGVudFBhbmVsLCBcIlRyYW5nIGNo4bunXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbi4uLlxuXG4gICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZVxuICAgICAgICAgICAgICAgICAgICBwcm90ZWN0ZWQgdm9pZCBkb25lKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBM4bqleSBwYW5lbCBzYXUga2hpIMSRw6MgdOG6oW8geG9uZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEtodXllbk1haVBhbmVsIHBhbmVsID0gZ2V0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaMOqbSB2w6BvIGNhY2hlIHbDoCBoaeG7g24gdGjhu4tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50UGFuZWwuYWRkKHBhbmVsLCBwYW5lbE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhbmVsTWFwLnB1dChwYW5lbE5hbWUsIHBhbmVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkTGF5b3V0LnNob3coY29udGVudFBhbmVsLCBwYW5lbE5hbWUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gWMOzYSBwYW5lbCBsb2FkaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFBhbmVsLnJlbW92ZShsb2FkaW5nUGFuZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKE1haW5HVUkudGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiS2jDtG5nIHRo4buDIHThuqNpIGThu68gbGnhu4d1IGtodXnhur9uIG3Do2k6IFwiICsgZS5nZXRNZXNzYWdlKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpIGvhur90IG7hu5FpXCIsIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRMYXlvdXQuc2hvdyhjb250ZW50UGFuZWwsIFwiVHJhbmcgY2jhu6dcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuLi4uXG5cbiAgICAgICAgICAgICAgICAvLyBU4bqhbyBwYW5lbCBxdeG6o24gbMO9IHbDqSB0cm9uZyBsdeG7k25nIHJpw6puZ1xuICAgICAgICAgICAgICAgIFN3aW5nV29ya2VyPFRyYUN1dVZlUGFuZWwsIFZvaWQ+IHdvcmtlciA9IG5ldyBTd2luZ1dvcmtlcjw+KCkge1xuICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGVcbiAgICAgICAgICAgICAgICAgICAgcHJvdGVjdGVkIFRyYUN1dVZlUGFuZWwgZG9JbkJhY2tncm91bmQoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFRyYUN1dVZlUGFuZWwoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZVxuICAgICAgICAgICAgICAgICAgICBwcm90ZWN0ZWQgdm9pZCBkb25lKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBM4bqleSBwYW5lbCBzYXUga2hpIMSRw6MgdOG6oW8geG9uZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRyYUN1dVZlUGFuZWwgcGFuZWwgPSBnZXQoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRow6ptIHbDoG8gY2FjaGUgdsOgIGhp4buDbiB0aOG7i1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRQYW5lbC5hZGQocGFuZWwsIHBhbmVsTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFuZWxNYXAucHV0KHBhbmVsTmFtZSwgcGFuZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRMYXlvdXQuc2hvdyhjb250ZW50UGFuZWwsIHBhbmVsTmFtZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBYw7NhIHBhbmVsIGxvYWRpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50UGFuZWwucmVtb3ZlKGxvYWRpbmdQYW5lbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coTWFpbkdVSS50aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJLaMO0bmcgdGjhu4MgdOG6o2kgZOG7ryBsaeG7h3U6IFwiICsgZS5nZXRNZXNzYWdlKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpIGvhur90IG7hu5FpXCIsIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRMYXlvdXQuc2hvdyhjb250ZW50UGFuZWwsIFwiVHJhbmcgY2jhu6dcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuLi4uXG5cbiAgICAgICAgICAgICAgICAvLyBU4bqhbyBwYW5lbCBxdeG6o24gbMO9IHbDqSB0cm9uZyBsdeG7k25nIHJpw6puZ1xuICAgICAgICAgICAgICAgIFN3aW5nV29ya2VyPFRob25nS2VWZVBhbmVsLCBWb2lkPiB3b3JrZXIgPSBuZXcgU3dpbmdXb3JrZXI8PigpIHtcbiAgICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlXG4gICAgICAgICAgICAgICAgICAgIHByb3RlY3RlZCBUaG9uZ0tlVmVQYW5lbCBkb0luQmFja2dyb3VuZCgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVGhvbmdLZVZlUGFuZWwoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZVxuICAgICAgICAgICAgICAgICAgICBwcm90ZWN0ZWQgdm9pZCBkb25lKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBM4bqleSBwYW5lbCBzYXUga2hpIMSRw6MgdOG6oW8geG9uZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRob25nS2VWZVBhbmVsIHBhbmVsID0gZ2V0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaMOqbSB2w6BvIGNhY2hlIHbDoCBoaeG7g24gdGjhu4tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50UGFuZWwuYWRkKHBhbmVsLCBwYW5lbE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhbmVsTWFwLnB1dChwYW5lbE5hbWUsIHBhbmVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkTGF5b3V0LnNob3coY29udGVudFBhbmVsLCBwYW5lbE5hbWUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gWMOzYSBwYW5lbCBsb2FkaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFBhbmVsLnJlbW92ZShsb2FkaW5nUGFuZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKE1haW5HVUkudGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiS2jDtG5nIHRo4buDIHThuqNpIGThu68gbGnhu4d1OiBcIiArIGUuZ2V0TWVzc2FnZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaSBr4bq/dCBu4buRaVwiLCBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkTGF5b3V0LnNob3coY29udGVudFBhbmVsLCBcIlRyYW5nIGNo4bunXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHdvcmtlci5leGVjdXRlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuOyAvLyBUaG/DoXQgc+G7m21cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG5cbiAgICAgICAgLy8gU3dpdGNoIHRvIHRoZSBwYW5lbFxuICAgICAgICBjYXJkTGF5b3V0LnNob3coY29udGVudFBhbmVsLCBwYW5lbE5hbWUpO1xuICAgIH1cblxuICAgIHByaXZhdGUgSlBhbmVsIGNyZWF0ZUxvYWRpbmdQYW5lbChTdHJpbmcgbWVzc2FnZSkge1xuICAgICAgICBKUGFuZWwgbG9hZGluZ1BhbmVsID0gbmV3IEpQYW5lbChuZXcgQm9yZGVyTGF5b3V0KCkpO1xuICAgICAgICBsb2FkaW5nUGFuZWwuc2V0QmFja2dyb3VuZChDb2xvci5XSElURSk7XG5cbiAgICAgICAgSkxhYmVsIGxvYWRpbmdMYWJlbCA9IG5ldyBKTGFiZWwobWVzc2FnZSwgSkxhYmVsLkNFTlRFUik7XG4gICAgICAgIGxvYWRpbmdMYWJlbC5zZXRGb250KG5ldyBGb250KFwiQXJpYWxcIiwgRm9udC5JVEFMSUMsIDE4KSk7XG4gICAgICAgIGxvYWRpbmdMYWJlbC5zZXRGb3JlZ3JvdW5kKENvbG9yLkdSQVkpO1xuXG4gICAgICAgIGxvYWRpbmdQYW5lbC5hZGQobG9hZGluZ0xhYmVsLCBCb3JkZXJMYXlvdXQuQ0VOVEVSKTtcbiAgICAgICAgcmV0dXJuIGxvYWRpbmdQYW5lbDtcbiAgICB9XG5cbiAgICAvLyBQaMawxqFuZyB0aOG7qWMgdOG6oW8gc3Bpbm5lciAoaG/hurdjIGLhuqFuIGPDsyB0aOG7gyBz4butIGThu6VuZyBt4buZdCDhuqNuaCBHSUYgc3Bpbm5lciBjw7Mgc+G6tW4pXG4gICAgcHJpdmF0ZSBJbWFnZSBjcmVhdGVMb2FkaW5nU3Bpbm5lckdpZigpIHtcbiAgICAgICAgLy8gQuG6oW4gY8OzIHRo4buDIHRoYXkgdGjhur8gY8OhaSBuw6B5IGLhurFuZyBt4buZdCDhuqNuaCBHSUYgc3Bpbm5lciB0aOG7sWMgdOG6v1xuICAgICAgICAvLyDEkMOieSBjaOG7iSBsw6AgbeG7mXQgcGxhY2Vob2xkZXIgxJHGoW4gZ2nhuqNuXG4gICAgICAgIEJ1ZmZlcmVkSW1hZ2UgaW1hZ2UgPSBuZXcgQnVmZmVyZWRJbWFnZSg1MCwgNTAsIEJ1ZmZlcmVkSW1hZ2UuVFlQRV9JTlRfQVJHQik7XG4gICAgICAgIEdyYXBoaWNzMkQgZzIgPSBpbWFnZS5jcmVhdGVHcmFwaGljcygpO1xuICAgICAgICBnMi5zZXRDb2xvcihuZXcgQ29sb3IoNDEsIDEyOCwgMTg1KSk7XG4gICAgICAgIGcyLmZpbGxPdmFsKDAsIDAsIDUwLCA1MCk7XG4gICAgICAgIGcyLmRpc3Bvc2UoKTtcbiAgICAgICAgcmV0dXJuIGltYWdlO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpIHtcbiAgICAgICAgU3dpbmdVdGlsaXRpZXMuaW52b2tlTGF0ZXIoKCkgLT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBVSU1hbmFnZXIuc2V0TG9va0FuZEZlZWwoVUlNYW5hZ2VyLmdldFN5c3RlbUxvb2tBbmRGZWVsQ2xhc3NOYW1lKCkpO1xuICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHtcbiAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBuZXcgTWFpbkdVSShuZXcgTmhhblZpZW4oKSkuc2V0VmlzaWJsZSh0cnVlKTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuLi4uXG4iLCJpc0Vycm9yIjpmYWxzZSwicmVxdWVzdElkIjoiIn19LCJkMzk2MDk0MC03N2M2LTQ1NTQtOTFjMS03NDQ3ZDI3Y2MxNGM7dG9vbHVfMDEzOHUyQWFxeFJja3Y5RVZURVlYRnh3Ijp7InBoYXNlIjo2LCJyZXN1bHQiOnsidGV4dCI6IlJhbiBpbnRvIFVua25vd24gZXJyb3Igd2hpbGUgdHJ5aW5nIHRvIHJlYWQgUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9ndWlDbGllbnQvVHJhaW5UaWNrZXRCb29raW5nU3lzdGVtLmphdmEiLCJpc0Vycm9yIjp0cnVlLCJyZXF1ZXN0SWQiOiIifX0sIjVlNzJlZDJiLWQ5NGUtNGJiZC1hNTU1LWM0NWRhMDkzNjgxZjt0b29sdV8wMU5kR0JQbVFoZnVaTVNtUksyUkRua2giOnsicGhhc2UiOjUsInJlc3VsdCI6eyJ0ZXh0IjoiVGhlIGZvbGxvd2luZyBjb2RlIHNlY3Rpb25zIHdlcmUgcmV0cmlldmVkOlxuUGF0aDogUHJvamVjdF9CYW5WZVRhdVRhaUdhc0xhY0hvbmcvc3JjL21haW4vamF2YS9ndWlDbGllbnQvVHJhaW5UaWNrZXRCb29raW5nU3lzdGVtLmphdmFcbnBhY2thZ2UgZ3VpQ2xpZW50O1xuXG5pbXBvcnQgZGFvLio7XG5pbXBvcnQgZGFvLmltcGwuKjtcbmltcG9ydCBtb2RlbC4qO1xuXG5pbXBvcnQgamF2YXguc3dpbmcuKjtcbmltcG9ydCBqYXZheC5zd2luZy5ib3JkZXIuKjtcbmltcG9ydCBqYXZheC5zd2luZy50ZXh0LkRlZmF1bHRDYXJldDtcbmltcG9ydCBqYXZhLmF3dC4qO1xuaW1wb3J0IGphdmEuYXd0LmV2ZW50Lio7XG5pbXBvcnQgamF2YS5ybWkuUmVtb3RlRXhjZXB0aW9uO1xuaW1wb3J0IGphdmEudGV4dC5OdW1iZXJGb3JtYXQ7XG5pbXBvcnQgamF2YS50aW1lLkxvY2FsRGF0ZTtcbmltcG9ydCBqYXZhLnRpbWUuWm9uZUlkO1xuaW1wb3J0IGphdmEudGltZS5mb3JtYXQuRGF0ZVRpbWVGb3JtYXR0ZXI7XG5pbXBvcnQgamF2YS51dGlsLio7XG5pbXBvcnQgamF2YS51dGlsLkxpc3Q7XG5pbXBvcnQgamF2YXguc3dpbmcuVGltZXI7XG5pbXBvcnQgamF2YXguc3dpbmcucGxhZi5iYXNpYy5CYXNpY1Njcm9sbEJhclVJO1xuaW1wb3J0IGphdmEudXRpbC5zdHJlYW0uQ29sbGVjdG9ycztcbmltcG9ydCBjb20udG9lZHRlci5jYWxlbmRhci5KRGF0ZUNob29zZXI7XG5cbi8qKlxuICogVHJhaW4gVGlja2V0IEJvb2tpbmcgU3lzdGVtIEdVSVxuICogQWxsb3dzIHVzZXJzIHRvIHNlYXJjaCBmb3IgdHJhaW5zLCB2aWV3IGNhcnMsIHNlbGVjdCBzZWF0cywgYW5kIGJvb2sgdGlja2V0c1xuICogQGF1dGhvciBsdW9uZ3RhbjIwNFxuICovXG5wdWJsaWMgY2xhc3MgVHJhaW5UaWNrZXRCb29raW5nU3lzdGVtIGV4dGVuZHMgSkZyYW1lIHtcbiAgICAvLyBVSSBDb21wb25lbnRzXG4gICAgcHJpdmF0ZSBKUGFuZWwgc2VhdHNQYW5lbDtcbiAgICBwcml2YXRlIEpQYW5lbCBjYXJzUGFuZWw7XG4gICAgcHJpdmF0ZSBKUGFuZWwgdHJhaW5zUGFuZWw7XG4gICAgcHJpdmF0ZSBKU2Nyb2xsUGFuZSB0cmFpbnNTY3JvbGxQYW5lO1xuICAgIHByaXZhdGUgSlNjcm9sbFBhbmUgY2Fyc1Njcm9sbFBhbmU7XG4gICAgcHJpdmF0ZSBKTGFiZWwgc2VhdGluZ1NlY3Rpb25MYWJlbDtcbiAgICBwcml2YXRlIEpMYWJlbCB0b3RhbExhYmVsO1xuXG4gICAgLy8gRm9ybSBmaWVsZHNcbiAgICBwcml2YXRlIEpUZXh0RmllbGQgZGVwYXJ0dXJlRmllbGQ7XG4gICAgcHJpdmF0ZSBKVGV4dEZpZWxkIGFycml2YWxGaWVsZDtcbiAgICBwcml2YXRlIEpUZXh0RmllbGQgZGVwYXJ0dXJlRGF0ZUZpZWxkO1xuICAgIHByaXZhdGUgSlRleHRGaWVsZCByZXR1cm5EYXRlRmllbGQ7XG4gICAgcHJpdmF0ZSBKUmFkaW9CdXR0b24gb25lV2F5UmFkaW87XG4gICAgcHJpdmF0ZSBKUmFkaW9CdXR0b24gcm91bmRUcmlwUmFkaW87XG5cbiAgICAvLyBTdGF0ZSB2YXJpYWJsZXNcbiAgICBwcml2YXRlIFN0cmluZyBzZWxlY3RlZFRyYWluSWQgPSBcIlwiOyAgIC8vIENvbXBvdW5kIElEIGZvciBzZWxlY3Rpb24gKHRyYWluIGNvZGUgKyB0aW1lKVxuICAgIHByaXZhdGUgU3RyaW5nIGN1cnJlbnRUcmFpbklkID0gXCJcIjsgICAgLy8gSnVzdCB0aGUgdHJhaW4gY29kZVxuICAgIHByaXZhdGUgU3RyaW5nIGN1cnJlbnRUb2FJZCA9IFwiXCI7ICAgICAgLy8gQ2FyIElEXG4gICAgcHJpdmF0ZSBTdHJpbmcgY3VycmVudE1hTGljaCA9IFwiXCI7ICAgICAvLyBTY2hlZHVsZSBJRCBmb3Igc2VhdCBsb2FkaW5nXG4gICAgcHJpdmF0ZSBBcnJheUxpc3Q8VGlja2V0SXRlbT4gY2FydEl0ZW1zID0gbmV3IEFycmF5TGlzdDw+KCk7XG4gICAgcHJpdmF0ZSBkb3VibGUgdG90YWxBbW91bnQgPSAwLjA7XG5cbiAgICAvLyBTZWF0IHN0YXR1cyBjb25zdGFudHNcbiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmcgU1RBVFVTX0FWQUlMQUJMRSA9IFwiVHLhu5FuZ1wiO1xuICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyBTVEFUVVNfQk9PS0VEID0gXCLEkMOjIMSR4bq3dFwiO1xuICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyBTVEFUVVNfUEVORElORyA9IFwiQ2jhu50geMOhYyBuaOG6rW5cIjtcblxuICAgIC8vIFNlYXQgY29sb3JzXG4gICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgQ29sb3IgU0VBVF9BVkFJTEFCTEVfQ09MT1IgPSBDb2xvci5XSElURTtcbiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBDb2xvciBTRUFUX0JPT0tFRF9DT0xPUiA9IENvbG9yLkxJR0hUX0dSQVk7XG4gICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgQ29sb3IgU0VBVF9QRU5ESU5HX0NPTE9SID0gQ29sb3IuWUVMTE9XO1xuXG4gICAgcHJpdmF0ZSBNYXA8U3RyaW5nLCBUaW1lcj4gcmVzZXJ2YXRpb25UaW1lcnMgPSBuZXcgSGFzaE1hcDw+KCk7IC8vIFN0b3JlIHRpbWVycyBmb3IgZWFjaCByZXNlcnZlZCBzZWF0XG4gICAgcHJpdmF0ZSBNYXA8U3RyaW5nLCBJbnRlZ2VyPiByZW1haW5pbmdUaW1lcyA9IG5ldyBIYXNoTWFwPD4oKTsgIC8vIFN0b3JlIHJlbWFpbmluZyBzZWNvbmRzIGZvciBlYWNoIHJlc2VydmF0aW9uXG4gICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgaW50IFJFU0VSVkFUSU9OX1RJTUVPVVQgPSAzMDA7IC8vIDMwMCBzZWNvbmRzICg1IG1pbnV0ZXMpXG5cbiAgICAvLyBWaXN1YWwgZWZmZWN0c1xuICAgIHByaXZhdGUgQ29sb3IgYWN0aXZlQ29sb3IgPSBuZXcgQ29sb3IoMCwgMTM2LCAyMDQpO1xuICAgIHByaXZhdGUgQ29sb3IgaW5hY3RpdmVDb2xvciA9IG5ldyBDb2xvcigxNTMsIDE1MywgMTUzKTtcbiAgICBwcml2YXRlIENvbG9yIGhvdmVyQ29sb3IgPSBuZXcgQ29sb3IoNTEsIDE1MywgMjU1KTtcbiAgICBwcml2YXRlIEJvcmRlciBhY3RpdmVCb3JkZXIgPSBCb3JkZXJGYWN0b3J5LmNyZWF0ZUNvbXBvdW5kQm9yZGVyKFxuICAgICAgICAgICAgQm9yZGVyRmFjdG9yeS5jcmVhdGVMaW5lQm9yZGVyKG5ldyBDb2xvcigyNTUsIDIxNSwgMCksIDIpLCAvLyBHb2xkIGJvcmRlclxuICAgICAgICAgICAgQm9yZGVyRmFjdG9yeS5jcmVhdGVFbXB0eUJvcmRlcigxLCAxLCAxLCAxKVxuICAgICk7XG4gICAgcHJpdmF0ZSBCb3JkZXIgbm9ybWFsQm9yZGVyID0gQm9yZGVyRmFjdG9yeS5jcmVhdGVFbXB0eUJvcmRlcigzLCAzLCAzLCAzKTtcblxuICAgIC8vIERBT3NcbiAgICBwcml2YXRlIExpY2hUcmluaFRhdURBTyBsaWNoVHJpbmhUYXVEQU87XG4gICAgcHJpdmF0ZSBUYXVEQU8gdGF1REFPO1xuICAgIHByaXZhdGUgVG9hVGF1REFPIHRvYVRhdURBTztcbiAgICBwcml2YXRlIENob05nb2lEQU8gY2hvTmdvaURBTztcbiAgICBwcml2YXRlIEtodXllbk1haURBTyBraHV5ZW5NYWlEQU87XG5cbiAgICAvLyBFbXBsb3llZSBpbmZvcm1hdGlvblxuICAgIHByaXZhdGUgTmhhblZpZW4gbmhhblZpZW47XG5cbiAgICAvKipcbiAgICAgKiBDb25zdHJ1Y3RvciAtIGluaXRpYWxpemVzIHRoZSBhcHBsaWNhdGlvblxuICAgICAqIEBwYXJhbSBudiBUaGUgZW1wbG95ZWUgd2hvIGlzIHVzaW5nIHRoZSBzeXN0ZW1cbiAgICAgKi9cbiAgICBwdWJsaWMgVHJhaW5UaWNrZXRCb29raW5nU3lzdGVtKE5oYW5WaWVuIG52KSB0aHJvd3MgUmVtb3RlRXhjZXB0aW9uIHtcbiAgICAgICAgdGhpcy5uaGFuVmllbiA9IG52O1xuICAgICAgICBzZXRUaXRsZShcIkjhu4cgdGjhu5FuZyDEkeG6t3QgdsOpIHTDoHVcIik7XG4gICAgICAgIHNldFNpemUoMTIwMCwgNjUwKTtcbiAgICAgICAgc2V0RGVmYXVsdENsb3NlT3BlcmF0aW9uKEpGcmFtZS5FWElUX09OX0NMT1NFKTtcbiAgICAgICAgc2V0TG9jYXRpb25SZWxhdGl2ZVRvKG51bGwpO1xuXG4gICAgICAgIC8vIEluaXRpYWxpemUgREFPc1xuICAgICAgICBsaWNoVHJpbmhUYXVEQU8gPSBuZXcgTGljaFRyaW5oVGF1REFPSW1wbCgpO1xuICAgICAgICB0YXVEQU8gPSBuZXcgVGF1REFPSW1wbCgpO1xuICAgICAgICB0b2FUYXVEQU8gPSBuZXcgVG9hVGF1REFPSW1wbCgpO1xuICAgICAgICBjaG9OZ29pREFPID0gbmV3IENob05nb2lEQU9JbXBsKCk7XG4gICAgICAgIGtodXllbk1haURBTyA9IG5ldyBLaHV5ZW5NYWlEQU9JbXBsKCk7XG5cbiAgICAgICAgLy8gTWFpbiBjb250YWluZXIgcGFuZWwgd2l0aCBCb3JkZXJMYXlvdXRcbiAgICAgICAgSlBhbmVsIGNvbnRhaW5lclBhbmVsID0gbmV3IEpQYW5lbChuZXcgQm9yZGVyTGF5b3V0KDEwLCAxMCkpO1xuXG4gICAgICAgIC8vIE1haW4gcGFuZWwgKGNlbnRlciBjb250ZW50KVxuICAgICAgICBKUGFuZWwgbWFpblBhbmVsID0gbmV3IEpQYW5lbCgpO1xuICAgICAgICBtYWluUGFuZWwuc2V0TGF5b3V0KG5ldyBCb3JkZXJMYXlvdXQoMTAsIDEwKSk7XG4gICAgICAgIG1haW5QYW5lbC5zZXRCb3JkZXIobmV3IEVtcHR5Qm9yZGVyKDEwLCAxMCwgMTAsIDEwKSk7XG5cbiAgICAgICAgLy8gQWRkIGNvbXBvbmVudHMgdG8gbWFpbiBwYW5lbFxuICAgICAgICBtYWluUGFuZWwuYWRkKGNyZWF0ZUhlYWRlclBhbmVsKCksIEJvcmRlckxheW91dC5OT1JUSCk7XG4gICAgICAgIG1haW5QYW5lbC5hZGQoY3JlYXRlVHJhaW5zUGFuZWwoKSwgQm9yZGVyTGF5b3V0LkNFTlRFUik7XG5cbiAgICAgICAgLy8gTGVmdCBwYW5lbCAtIFRyaXAgSW5mb3JtYXRpb25cbiAgICAgICAgSlBhbmVsIGxlZnRQYW5lbCA9IGNyZWF0ZVRyaXBJbmZvUGFuZWwoKTtcblxuICAgICAgICAvLyBSaWdodCBwYW5lbCAtIFRpY2tldCBDYXJ0XG4gICAgICAgIEpQYW5lbCByaWdodFBhbmVsID0gY3JlYXRlVGlja2V0Q2FydFBhbmVsKCk7XG5cbiAgICAgICAgLy8gQWRkIGFsbCBwYW5lbHMgdG8gdGhlIGNvbnRhaW5lclxuICAgICAgICBjb250YWluZXJQYW5lbC5hZGQobGVmdFBhbmVsLCBCb3JkZXJMYXlvdXQuV0VTVCk7XG4gICAgICAgIGNvbnRhaW5lclBhbmVsLmFkZChtYWluUGFuZWwsIEJvcmRlckxheW91dC5DRU5URVIpO1xuICAgICAgICBjb250YWluZXJQYW5lbC5hZGQocmlnaHRQYW5lbCwgQm9yZGVyTGF5b3V0LkVBU1QpO1xuXG4gICAgICAgIC8vIEFkZCBjb250YWluZXIgcGFuZWwgdG8gZnJhbWVcbiAgICAgICAgYWRkKGNvbnRhaW5lclBhbmVsKTtcbiAgICB9XG4uLi5cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSB0cmFpbiBjYXJkIHBhbmVsIHdpdGggdGhlIGdpdmVuIGRldGFpbHNcbiAgICAgKi9cbiAgICBwcml2YXRlIEpQYW5lbCBjcmVhdGVUcmFpbkNhcmQoU3RyaW5nIHRyYWluQ29kZSwgU3RyaW5nIGRlcGFydFRpbWUsIGxvbmcgYXZhaWxhYmxlU2VhdHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2xlYW4gaXNTZWxlY3RlZCwgVHJhbmdUaGFpIHN0YXR1cywgU3RyaW5nIG1hTGljaCkge1xuICAgICAgICBKUGFuZWwgY2FyZFBhbmVsID0gbmV3IEpQYW5lbCgpO1xuICAgICAgICBjYXJkUGFuZWwuc2V0TGF5b3V0KG5ldyBCb3JkZXJMYXlvdXQoKSk7XG4gICAgICAgIGNhcmRQYW5lbC5zZXRCb3JkZXIoaXNTZWxlY3RlZCA/IGFjdGl2ZUJvcmRlciA6IG5vcm1hbEJvcmRlcik7XG5cbiAgICAgICAgLy8gQ3JlYXRlIGEgdW5pcXVlIGlkZW50aWZpZXIgdXNpbmcgdHJhaW4gY29kZSBhbmQgZGVwYXJ0dXJlIHRpbWVcbiAgICAgICAgU3RyaW5nIHVuaXF1ZUlkID0gdHJhaW5Db2RlICsgXCJfXCIgKyBkZXBhcnRUaW1lLnJlcGxhY2UoXCIvXCIsIFwiXCIpLnJlcGxhY2UoXCI6XCIsIFwiXCIpLnJlcGxhY2UoXCIgXCIsIFwiXCIpO1xuXG4gICAgICAgIC8vIFN0b3JlIGltcG9ydGFudCBkYXRhIGFzIGNsaWVudCBwcm9wZXJ0aWVzXG4gICAgICAgIGNhcmRQYW5lbC5wdXRDbGllbnRQcm9wZXJ0eShcInRyYWluSWRcIiwgdW5pcXVlSWQpO1xuICAgICAgICBjYXJkUGFuZWwucHV0Q2xpZW50UHJvcGVydHkoXCJ0cmFpbkNvZGVcIiwgdHJhaW5Db2RlKTtcbiAgICAgICAgY2FyZFBhbmVsLnB1dENsaWVudFByb3BlcnR5KFwibWFMaWNoXCIsIG1hTGljaCk7XG4uLi5cblxuICAgICAgICBjYXJkUGFuZWwuc2V0VG9vbFRpcFRleHQoXG4gICAgICAgICAgICAgICAgXCI8aHRtbD5cIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIjxiPlTDoHU6IFwiICsgdHJhaW5Db2RlICsgXCI8L2I+PGJyPlwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiVGjhu51pIGdpYW4gxJFpOiBcIiArIGRlcGFydFRpbWUgKyBcIjxicj5cIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIlPhu5EgY2jhu5cgdHLhu5FuZzogXCIgKyBhdmFpbGFibGVTZWF0cyArXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXNUZXh0ICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiPGJyPk5o4bqlcCDEkeG7gyB4ZW0gY2hpIHRp4bq/dCB0b2EgdMOgdS5cIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIjwvaHRtbD5cIlxuICAgICAgICApO1xuXG4gICAgICAgIC8vIEFkZCBzZWxlY3Rpb24gbGlzdGVuZXIgd2l0aCBjbGVhciBldmVudCBoYW5kbGluZ1xuICAgICAgICBjYXJkUGFuZWwuYWRkTW91c2VMaXN0ZW5lcihuZXcgTW91c2VBZGFwdGVyKCkge1xuICAgICAgICAgICAgQE92ZXJyaWRlXG4gICAgICAgICAgICBwdWJsaWMgdm9pZCBtb3VzZUNsaWNrZWQoTW91c2VFdmVudCBlKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gU3RvcmUgdGhlIHVuaXF1ZSBJRCwgdHJhaW4gY29kZSBhbmQgc2NoZWR1bGUgSURcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRUcmFpbklkID0gdW5pcXVlSWQ7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRNYUxpY2ggPSBtYUxpY2g7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHNlbGVjdGlvbiBpbiBVSSBhbmQgbG9hZCB0aGUgY29ycmVzcG9uZGluZyBjYXJzXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZVRyYWluU2VsZWN0aW9uKHVuaXF1ZUlkLCB0cmFpbkNvZGUpO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKFJlbW90ZUV4Y2VwdGlvbiBleCkge1xuICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyhjYXJkUGFuZWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaSBraGkgdOG6o2kgdGjDtG5nIHRpbiB0w6B1OiBcIiArIGV4LmdldE1lc3NhZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbi4uLlxuXG4gICAgICAgICAgICBjYXJQYW5lbC5hZGRNb3VzZUxpc3RlbmVyKG5ldyBNb3VzZUFkYXB0ZXIoKSB7XG4gICAgICAgICAgICAgICAgQE92ZXJyaWRlXG4gICAgICAgICAgICAgICAgcHVibGljIHZvaWQgbW91c2VDbGlja2VkKE1vdXNlRXZlbnQgZSkge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIGN1cnJlbnQgdG9hIElEXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50VG9hSWQgPSB0b2FJZDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBzZWF0aW5nIHNlY3Rpb24gbGFiZWxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlYXRpbmdTZWN0aW9uTGFiZWwuc2V0VGV4dChcIlRvYSBz4buRIFwiICsgZmluYWxUb2FOdW1iZXIgKyBcIjogXCIgKyB0b2FOYW1lKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHZpc3VhbCBzZWxlY3Rpb24gZm9yIGFsbCBjYXJzXG4gICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVDYXJTZWxlY3Rpb24odG9hSWQpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBMb2FkIGFuZCBkaXNwbGF5IHRoZSBzZWF0IGNoYXJ0XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2FkU2VhdENoYXJ0KGN1cnJlbnRUcmFpbklkLCBjdXJyZW50VG9hSWQsIGN1cnJlbnRNYUxpY2gpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBleCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2coY2FyUGFuZWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2kga2hpIGNo4buNbiB0b2E6IFwiICsgZXguZ2V0TWVzc2FnZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuLi4uXG5cbiAgICAgICAgICAgIC8vIEFkZCBib3RoIHBhbmVscyB0byB0aGUgc2VhdHMgcGFuZWxcbiAgICAgICAgICAgIHNlYXRzUGFuZWwuYWRkKHNlYXRWaXN1YWxpemF0aW9uUGFuZWwsIEJvcmRlckxheW91dC5DRU5URVIpO1xuICAgICAgICAgICAgc2VhdHNQYW5lbC5hZGQobGVnZW5kUGFuZWwsIEJvcmRlckxheW91dC5TT1VUSCk7XG4gICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJMb2FkaW5nIHNlYXQgY2hhcnQgZm9yIHRyYWluOiBcIiArIHRyYWluSWQgKyBcIiwgY2FyOiBcIiArIHRvYUlkKTtcbiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIlNjaGVkdWxlIElEOiBcIiArIG1hTGljaCk7XG4gICAgICAgICAgICBpZiAoc2VhdHNNYXAgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIlJlY2VpdmVkIFwiICsgc2VhdHNNYXAuc2l6ZSgpICsgXCIgc2VhdHMgZnJvbSBEQU9cIik7XG4gICAgICAgICAgICAgICAgaWYgKHNlYXRzTWFwLnNpemUoKSA+IDEwMCkge1xuICAgICAgICAgICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oXCJXQVJOSU5HOiBVbnVzdWFsbHkgaGlnaCBzZWF0IGNvdW50IGRldGVjdGVkIVwiKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gUHJpbnQgZmlyc3QgMTAgc2VhdHMgZm9yIGluc3BlY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgaW50IGNvdW50ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChNYXAuRW50cnk8U3RyaW5nLCBTdHJpbmc+IGVudHJ5IDogc2VhdHNNYXAuZW50cnlTZXQoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiU2VhdDogXCIgKyBlbnRyeS5nZXRLZXkoKSArIFwiLCBTdGF0dXM6IFwiICsgZW50cnkuZ2V0VmFsdWUoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKytjb3VudCA+PSAxMCkgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZWF0c1BhbmVsLnJldmFsaWRhdGUoKTtcbiAgICAgICAgICAgIHNlYXRzUGFuZWwucmVwYWludCgpO1xuLi4uXG5cbiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiVG90YWwgc2VhdHM6IFwiICsgc2VhdElkcy5zaXplKCkpO1xuXG4gICAgICAgIC8vIENhbGN1bGF0ZSBjb2x1bW5zIGJhc2VkIG9uIHRvdGFsIHNlYXRzIChlbnN1cmluZyA0IHJvd3MpXG4gICAgICAgIGludCB0b3RhbFJvd3MgPSA0O1xuICAgICAgICBpbnQgdG90YWxTZWF0c1BlclNpZGUgPSAoaW50KU1hdGguY2VpbChzZWF0SWRzLnNpemUoKSAvIChkb3VibGUpdG90YWxSb3dzIC8gMik7XG4gICAgICAgIGludCB0b3RhbENvbHVtbnMgPSB0b3RhbFNlYXRzUGVyU2lkZSAqIDIgKiAyICsgMTsgLy8gMiBzaWRlcywgMiBzZWF0cyBwZXIgYmxvY2ssICsxIGZvciBhaXNsZVxuICAgICAgICBpbnQgYWlzbGVQb3NpdGlvbiA9IHRvdGFsQ29sdW1ucyAvIDI7XG5cbiAgICAgICAgLy8gQ3JlYXRlIGEgZ3JpZCBsYXlvdXQgd2l0aCA0IHJvd3NcbiAgICAgICAgR3JpZExheW91dCBncmlkTGF5b3V0ID0gbmV3IEdyaWRMYXlvdXQodG90YWxSb3dzLCB0b3RhbENvbHVtbnMpO1xuICAgICAgICBncmlkTGF5b3V0LnNldEhnYXAoMik7XG4gICAgICAgIGdyaWRMYXlvdXQuc2V0VmdhcCgyKTtcbiAgICAgICAgc2VhdEdyaWRQYW5lbC5zZXRMYXlvdXQoZ3JpZExheW91dCk7XG5cbiAgICAgICAgLy8gRmlyc3QsIGNyZWF0ZSBlbXB0eSBwYW5lbHMgZm9yIGFsbCBwb3NpdGlvbnMgaW4gdGhlIGdyaWRcbiAgICAgICAgSlBhbmVsW11bXSBzZWF0UGFuZWxzID0gbmV3IEpQYW5lbFt0b3RhbFJvd3NdW3RvdGFsQ29sdW1uc107XG4uLi5cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSBzZWF0IHNlbGVjdGlvblxuICAgICAqL1xuICAgIHByaXZhdGUgdm9pZCBzZWxlY3RTZWF0KFN0cmluZyBzZWF0SWQpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIHNlYXQgaXMgYWxyZWFkeSBpbiBwZW5kaW5nIHN0YXR1c1xuICAgICAgICAgICAgaWYgKHJlc2VydmF0aW9uVGltZXJzLmNvbnRhaW5zS2V5KHNlYXRJZCkpIHtcbiAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyh0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJHaOG6vyBuw6B5IMSRw6MgxJHGsOG7o2MgZ2nhu68gY2jhu5cgdsOgIMSRYW5nIGNo4budIHRoYW5oIHRvw6FuLlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJUaMO0bmcgYsOhb1wiLCBKT3B0aW9uUGFuZS5JTkZPUk1BVElPTl9NRVNTQUdFKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdldCB0aGUgc2VhdCBpbmZvIGZyb20gREFPXG4gICAgICAgICAgICBDaG9OZ29pIGNob05nb2kgPSBjaG9OZ29pREFPLmdldEJ5SWQoc2VhdElkKTtcblxuICAgICAgICAgICAgaWYgKGNob05nb2kgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIktow7RuZyB0w6xtIHRo4bqleSB0aMO0bmcgdGluIGdo4bq/OiBcIiArIHNlYXRJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2lcIiwgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZXQgc2VhdCBwcmljZSBiYXNlZCBvbiByb3V0ZSBhbmQgc2VhdCBjbGFzc1xuICAgICAgICAgICAgZG91YmxlIHByaWNlID0gZ2V0U2VhdFByaWNlKGNob05nb2kpO1xuICAgICAgICAgICAgU3RyaW5nIGRpc3BsYXlOYW1lID0gKGNob05nb2kuZ2V0VGVuQ2hvKCkgIT0gbnVsbCkgPyBjaG9OZ29pLmdldFRlbkNobygpIDogc2VhdElkO1xuXG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIFVJIHRvIHJlZmxlY3QgcGVuZGluZyBzdGF0dXNcbiAgICAgICAgICAgICAgICB1cGRhdGVTZWF0U3RhdHVzKHNlYXRJZCwgU1RBVFVTX1BFTkRJTkcpO1xuXG4gICAgICAgICAgICAgICAgLy8gQWRkIHRvIGNhcnRcbiAgICAgICAgICAgICAgICBhZGRUb0NhcnRXaXRoVGltZW91dChzZWF0SWQsIGRpc3BsYXlOYW1lLCBwcmljZSk7XG5cbiAgICAgICAgICAgICAgICAvLyBTdGFydCBjb3VudGRvd24gdGltZXIgZm9yIHRoaXMgc2VhdFxuICAgICAgICAgICAgICAgIHN0YXJ0UmVzZXJ2YXRpb25Db3VudGRvd24oc2VhdElkLCBkaXNwbGF5TmFtZSwgcHJpY2UpO1xuXG4gICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBleCkge1xuICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2codGhpcyxcbiAgICAgICAgICAgICAgICAgICAgXCJM4buXaSBraGkgZ2nhu68gY2jhu5c6IFwiICsgZXguZ2V0TWVzc2FnZSgpLFxuICAgICAgICAgICAgICAgICAgICBcIkzhu5dpXCIsIEpPcHRpb25QYW5lLkVSUk9SX01FU1NBR0UpO1xuICAgICAgICAgICAgZXgucHJpbnRTdGFja1RyYWNlKCk7XG4gICAgICAgIH1cbiAgICB9XG4uLi5cbiAgICAvKipcbiAgICAgKiBTdGFydCBjb3VudGRvd24gdGltZXIgZm9yIHNlYXQgcmVzZXJ2YXRpb25cbiAgICAgKi9cbiAgICBwcml2YXRlIHZvaWQgc3RhcnRSZXNlcnZhdGlvbkNvdW50ZG93bihTdHJpbmcgc2VhdElkLCBTdHJpbmcgZGlzcGxheU5hbWUsIGRvdWJsZSBwcmljZSkge1xuICAgICAgICAvLyBJbml0aWFsaXplIHRoZSByZW1haW5pbmcgdGltZVxuICAgICAgICByZW1haW5pbmdUaW1lcy5wdXQoc2VhdElkLCBSRVNFUlZBVElPTl9USU1FT1VUKTtcblxuICAgICAgICAvLyBDcmVhdGUgYW5kIHN0YXJ0IHRoZSB0aW1lclxuICAgICAgICBUaW1lciB0aW1lciA9IG5ldyBUaW1lcigxMDAwLCBudWxsKTsgLy8gMSBzZWNvbmQgaW50ZXJ2YWxzXG4gICAgICAgIHRpbWVyLmFkZEFjdGlvbkxpc3RlbmVyKGUgLT4ge1xuICAgICAgICAgICAgaW50IHJlbWFpbmluZyA9IHJlbWFpbmluZ1RpbWVzLmdldChzZWF0SWQpIC0gMTtcbiAgICAgICAgICAgIHJlbWFpbmluZ1RpbWVzLnB1dChzZWF0SWQsIHJlbWFpbmluZyk7XG5cbiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgY291bnRkb3duIGluIHRoZSBjYXJ0XG4gICAgICAgICAgICB1cGRhdGVDYXJ0SXRlbUNvdW50ZG93bihzZWF0SWQsIHJlbWFpbmluZyk7XG5cbiAgICAgICAgICAgIC8vIElmIHRpbWUgaXMgdXAsIHJlbGVhc2UgdGhlIHNlYXRcbiAgICAgICAgICAgIGlmIChyZW1haW5pbmcgPD0gMCkge1xuICAgICAgICAgICAgICAgIHRpbWVyLnN0b3AoKTtcbiAgICAgICAgICAgICAgICByZWxlYXNlUmVzZXJ2YXRpb24oc2VhdElkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gU3RvcmUgdGhlIHRpbWVyIGFuZCBzdGFydCBpdFxuICAgICAgICByZXNlcnZhdGlvblRpbWVycy5wdXQoc2VhdElkLCB0aW1lcik7XG4gICAgICAgIHRpbWVyLnN0YXJ0KCk7XG4gICAgfVxuLi4uXG5cbiAgICAgICAgLy8gQ3JlYXRlIGFuZCBhZGQgdGlja2V0IGl0ZW0gdG8gY2FydCB3aXRoIHNlYXRJZCBmb3IgbGF0ZXIgcmVmZXJlbmNlXG4gICAgICAgIFRpY2tldEl0ZW0gaXRlbSA9IG5ldyBUaWNrZXRJdGVtKGN1cnJlbnRUcmFpbklkLCBzZWF0SWQsIGRpc3BsYXlOYW1lLCBmcm9tLCB0bywgZGVwYXJ0dXJlRGF0ZSwgcHJpY2UsIGNhcklkLCBjYXJOYW1lKTtcbiAgICAgICAgY2FydEl0ZW1zLmFkZChpdGVtKTtcblxuICAgICAgICAvLyBVcGRhdGUgY2FydCBkaXNwbGF5XG4gICAgICAgIHVwZGF0ZUNhcnREaXNwbGF5KCk7XG5cbiAgICAgICAgLy8gSW1tZWRpYXRlbHkgdXBkYXRlIHRoZSBzZWF0IHN0YXR1cyBpbiBVSSB0byBzaG93IGFzIHBlbmRpbmcgKHllbGxvdylcbiAgICAgICAgdXBkYXRlU2VhdFN0YXR1cyhzZWF0SWQsIFNUQVRVU19QRU5ESU5HKTtcbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBjYXJ0IGl0ZW0gdG8gc2hvdyBjb3VudGRvd25cbiAgICAgKi9cblxuXG4gICAgLyoqXG4gICAgICogSGVscGVyIHRvIHVwZGF0ZSBhIHBhbmVsIHdpdGggY291bnRkb3duXG4gICAgICovXG4uLi5cblxuICAgIC8qKlxuICAgICAqIFNlYXJjaCBmb3IgdHJhaW5zIGJhc2VkIG9uIGZvcm0gZGF0YVxuICAgICAqL1xuICAgIHByaXZhdGUgdm9pZCBzZWFyY2hUcmFpbnMoKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZXQgaW5wdXQgZGF0YVxuICAgICAgICAgICAgU3RyaW5nIGdhRGkgPSBkZXBhcnR1cmVGaWVsZC5nZXRUZXh0KCkudHJpbSgpO1xuICAgICAgICAgICAgU3RyaW5nIGdhRGVuID0gYXJyaXZhbEZpZWxkLmdldFRleHQoKS50cmltKCk7XG5cbiAgICAgICAgICAgIC8vIFBhcnNlIGRhdGVcbiAgICAgICAgICAgIERhdGVUaW1lRm9ybWF0dGVyIGZvcm1hdHRlciA9IERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybihcImRkL01NL3l5eXlcIik7XG4gICAgICAgICAgICBMb2NhbERhdGUgZGVwYXJ0dXJlRGF0ZSA9IExvY2FsRGF0ZS5wYXJzZShkZXBhcnR1cmVEYXRlRmllbGQuZ2V0VGV4dCgpLnRyaW0oKSwgZm9ybWF0dGVyKTtcblxuICAgICAgICAgICAgLy8gQ2FsbCBEQU8gdG8gZ2V0IHRyYWluIHNjaGVkdWxlc1xuICAgICAgICAgICAgTGlzdDxMaWNoVHJpbmhUYXU+IGFsbExpY2hUcmluaExpc3QgPSBsaWNoVHJpbmhUYXVEQU8uZ2V0TGlzdExpY2hUcmluaFRhdUJ5RGF0ZUFuZEdhRGlHYURlbihkZXBhcnR1cmVEYXRlLCBnYURpLCBnYURlbik7XG5cbiAgICAgICAgICAgIC8vIEZpbHRlciB0byBvbmx5IGluY2x1ZGUgdHJhaW5zIHRoYXQgaGF2ZW4ndCBkZXBhcnRlZCBvciBhcmUgaW4gb3BlcmF0aW9uXG4gICAgICAgICAgICBMaXN0PExpY2hUcmluaFRhdT4gZmlsdGVyZWRMaWNoVHJpbmhMaXN0ID0gYWxsTGljaFRyaW5oTGlzdC5zdHJlYW0oKVxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKGxpY2hUcmluaCAtPiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBUcmFuZ1RoYWkgdHJhbmdUaGFpID0gbGljaFRyaW5oLmdldFRyYW5nVGhhaSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRyYW5nVGhhaSA9PSBUcmFuZ1RoYWkuQ0hVQV9LSE9JX0hBTkggfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbmdUaGFpID09IFRyYW5nVGhhaS5IT0FUX0RPTkc7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5jb2xsZWN0KENvbGxlY3RvcnMudG9MaXN0KCkpO1xuXG4gICAgICAgICAgICBpZiAoZmlsdGVyZWRMaWNoVHJpbmhMaXN0LmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIktow7RuZyB0w6xtIHRo4bqleSBs4buLY2ggdHLDrG5oIHTDoHUgcGjDuSBo4bujcCDEkWFuZyBob+G6oXQgxJHhu5luZyBob+G6t2MgY2jGsGEga2jhu59pIGjDoG5oIHbDoG8gbmfDoHkgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXBhcnR1cmVEYXRlRmllbGQuZ2V0VGV4dCgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJUaMO0bmcgYsOhb1wiLCBKT3B0aW9uUGFuZS5JTkZPUk1BVElPTl9NRVNTQUdFKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4uLi5cblxuICAgICAgICAgICAgLy8gQ3JlYXRlIHRyYWluIGNhcmRzIG9ubHkgZm9yIGZpbHRlcmVkIHNjaGVkdWxlc1xuICAgICAgICAgICAgZm9yIChMaWNoVHJpbmhUYXUgbGljaFRyaW5oIDogZmlsdGVyZWRMaWNoVHJpbmhMaXN0KSB7XG4gICAgICAgICAgICAgICAgLy8gR2V0IHRyYWluIG9iamVjdFxuICAgICAgICAgICAgICAgIFRhdSB0YXUgPSB0YXVEQU8uZ2V0VGF1QnlMaWNoVHJpbmhUYXUobGljaFRyaW5oKTtcblxuICAgICAgICAgICAgICAgIC8vIEZvcm1hdCBkZXBhcnR1cmUgdGltZVxuICAgICAgICAgICAgICAgIERhdGVUaW1lRm9ybWF0dGVyIHRpbWVGb3JtYXR0ZXIgPSBEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oXCJISDptbVwiKTtcbiAgICAgICAgICAgICAgICBTdHJpbmcgZGVwYXJ0VGltZSA9IGxpY2hUcmluaC5nZXRHaW9EaSgpLmZvcm1hdCh0aW1lRm9ybWF0dGVyKTtcblxuICAgICAgICAgICAgICAgIC8vIEZvcm1hdCBkYXRlXG4gICAgICAgICAgICAgICAgRGF0ZVRpbWVGb3JtYXR0ZXIgZGF0ZUZvcm1hdHRlciA9IERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybihcImRkL01NXCIpO1xuICAgICAgICAgICAgICAgIFN0cmluZyBkZXBhcnREYXRlID0gbGljaFRyaW5oLmdldE5nYXlEaSgpLmZvcm1hdChkYXRlRm9ybWF0dGVyKTtcblxuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBmb3JtYXR0ZWQgdGltZXMgZm9yIGRpc3BsYXlcbiAgICAgICAgICAgICAgICBTdHJpbmcgZGVwYXJ0VGltZUZvcm1hdHRlZCA9IGRlcGFydERhdGUgKyBcIiBcIiArIGRlcGFydFRpbWU7XG5cbiAgICAgICAgICAgICAgICAvLyBHZXQgYXZhaWxhYmxlIHNlYXRzXG4gICAgICAgICAgICAgICAgbG9uZyBhdmFpbGFibGVTZWF0cyA9IGxpY2hUcmluaFRhdURBTy5nZXRBdmFpbGFibGVTZWF0c0J5U2NoZWR1bGUobGljaFRyaW5oLmdldE1hTGljaCgpKTtcblxuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSB0cmFpbiBjYXJkIHdpdGggc3RhdHVzIGluZGljYXRvclxuICAgICAgICAgICAgICAgIEpQYW5lbCB0cmFpbkNhcmQgPSBjcmVhdGVUcmFpbkNhcmQoXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXUuZ2V0TWFUYXUoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlcGFydFRpbWVGb3JtYXR0ZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBhdmFpbGFibGVTZWF0cyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhbHNlLCAvLyBJbml0aWFsbHkgbm90IHNlbGVjdGVkXG4gICAgICAgICAgICAgICAgICAgICAgICBsaWNoVHJpbmguZ2V0VHJhbmdUaGFpKCksICAvLyBQYXNzIHRoZSBzdGF0dXMgdG8gcG9zc2libHkgZGlzcGxheSBpdFxuICAgICAgICAgICAgICAgICAgICAgICAgbGljaFRyaW5oLmdldE1hTGljaCgpICAgICAgLy8gU3RvcmUgc2NoZWR1bGUgSURcbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgdHJhaW5zUGFuZWwuYWRkKHRyYWluQ2FyZCk7XG4gICAgICAgICAgICAgICAgdHJhaW5zUGFuZWwuYWRkKEJveC5jcmVhdGVIb3Jpem9udGFsU3RydXQoMTApKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQ2xlYXIgY2FyIHBhbmVsIGFuZCB1cGRhdGUgaGVhZGVyXG4gICAgICAgICAgICBsb2FkVHJhaW5DYXJzKFwiXCIpOyAvLyBFbXB0eSB0cmFpbiBJRCB0byBzaG93IHBsYWNlaG9sZGVyXG4gICAgICAgICAgICBzZWF0aW5nU2VjdGlvbkxhYmVsLnNldFRleHQoXCJUb2E6IENoxrBhIGNo4buNblwiKTtcblxuICAgICAgICAgICAgLy8gVXBkYXRlIGhlYWRlclxuICAgICAgICAgICAgdXBkYXRlSGVhZGVySW5mbyhnYURpLCBnYURlbiwgZGVwYXJ0dXJlRGF0ZUZpZWxkLmdldFRleHQoKSk7XG5cbiAgICAgICAgICAgIC8vIFJlZnJlc2ggVUlcbiAgICAgICAgICAgIHRyYWluc1BhbmVsLnJldmFsaWRhdGUoKTtcbiAgICAgICAgICAgIHRyYWluc1BhbmVsLnJlcGFpbnQoKTtcblxuICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiU2VhcmNoIGNvbXBsZXRlZCwgXCIgKyBmaWx0ZXJlZExpY2hUcmluaExpc3Quc2l6ZSgpICsgXCIgdHJhaW5zIGZvdW5kXCIpO1xuXG4gICAgICAgIH0gY2F0Y2ggKFJlbW90ZUV4Y2VwdGlvbiBleCkge1xuICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2codGhpcyxcbiAgICAgICAgICAgICAgICAgICAgXCJM4buXaSBr4bq/dCBu4buRaSDEkeG6v24gbcOheSBjaOG7pzogXCIgKyBleC5nZXRNZXNzYWdlKCksXG4gICAgICAgICAgICAgICAgICAgIFwiTOG7l2lcIiwgSk9wdGlvblBhbmUuRVJST1JfTUVTU0FHRSk7XG4gICAgICAgICAgICBleC5wcmludFN0YWNrVHJhY2UoKTtcbiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGV4KSB7XG4gICAgICAgICAgICBKT3B0aW9uUGFuZS5zaG93TWVzc2FnZURpYWxvZyh0aGlzLFxuICAgICAgICAgICAgICAgICAgICBcIkzhu5dpIHTDrG0ga2nhur9tOiBcIiArIGV4LmdldE1lc3NhZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgXCJM4buXaVwiLCBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFKTtcbiAgICAgICAgICAgIGV4LnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIGhlYWRlciBpbmZvcm1hdGlvbiB3aXRoIHJvdXRlIGRldGFpbHNcbiAgICAgKi9cbiAgICBwcml2YXRlIHZvaWQgdXBkYXRlSGVhZGVySW5mbyhTdHJpbmcgZnJvbSwgU3RyaW5nIHRvLCBTdHJpbmcgZGF0ZSkge1xuICAgICAgICAvLyBGaW5kIHRoZSBoZWFkZXIgbGFiZWwgYW5kIHVwZGF0ZSBpdFxuICAgICAgICBDb250YWluZXIgY29udGVudFBhbmUgPSBnZXRDb250ZW50UGFuZSgpO1xuICAgICAgICBpZiAoY29udGVudFBhbmUgaW5zdGFuY2VvZiBKUGFuZWwpIHtcbiAgICAgICAgICAgIENvbXBvbmVudFtdIGNvbXBvbmVudHMgPSAoKEpQYW5lbCkgY29udGVudFBhbmUpLmdldENvbXBvbmVudHMoKTtcbiAgICAgICAgICAgIGZvciAoQ29tcG9uZW50IGNvbXAgOiBjb21wb25lbnRzKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbXAgaW5zdGFuY2VvZiBKUGFuZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlSGVhZGVySW5QYW5lbCgoSlBhbmVsKWNvbXAsIGZyb20sIHRvLCBkYXRlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4uLi5cbiAgICAgICAgY2hlY2tvdXRCdXR0b24uYWRkQWN0aW9uTGlzdGVuZXIoZSAtPiB7XG4gICAgICAgICAgICBpZiAoY2FydEl0ZW1zLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgICAgIEpPcHRpb25QYW5lLnNob3dNZXNzYWdlRGlhbG9nKFxuICAgICAgICAgICAgICAgICAgICAgICAgVHJhaW5UaWNrZXRCb29raW5nU3lzdGVtLnRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkdp4buPIHbDqSB0cuG7kW5nLiBWdWkgbMOybmcgY2jhu41uIHbDqSB0csaw4bubYyBraGkgdGhhbmggdG/DoW4uXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIlRow7RuZyBiw6FvXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBKT3B0aW9uUGFuZS5JTkZPUk1BVElPTl9NRVNTQUdFXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIENyZWF0ZSBhIG1hcCBvZiBzZWF0IElEcyB0byBzY2hlZHVsZSBJRHNcbiAgICAgICAgICAgIE1hcDxTdHJpbmcsIFN0cmluZz4gdGlja2V0c1RvQ2hlY2tvdXQgPSBuZXcgSGFzaE1hcDw+KCk7XG4gICAgICAgICAgICBmb3IgKFRpY2tldEl0ZW0gaXRlbSA6IGNhcnRJdGVtcykge1xuICAgICAgICAgICAgICAgIHRpY2tldHNUb0NoZWNrb3V0LnB1dChpdGVtLnNlYXRJZCwgY3VycmVudE1hTGljaCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIE9wZW4gY2hlY2tvdXQgc2NyZWVuIHdpdGggb25seSB0aGUgbmVjZXNzYXJ5IGlkZW50aWZpZXJzIGFuZCBlbXBsb3llZSBpbmZvcm1hdGlvblxuICAgICAgICAgICAgVGhhbmhUb2FuR1VJIGNoZWNrb3V0U2NyZWVuID0gbnVsbDtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY2hlY2tvdXRTY3JlZW4gPSBuZXcgVGhhbmhUb2FuR1VJKHRpY2tldHNUb0NoZWNrb3V0LCBuaGFuVmllbik7XG4gICAgICAgICAgICB9IGNhdGNoIChSZW1vdGVFeGNlcHRpb24gZXgpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUnVudGltZUV4Y2VwdGlvbihleCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjaGVja291dFNjcmVlbi5zZXRWaXNpYmxlKHRydWUpO1xuICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gT3BlbiBjaGVja291dCBzY3JlZW5cbi4uLlxuXG5cblxuXG4gICAgLyoqXG4gICAgICogTWFpbiBtZXRob2RcbiAgICAgKi9cbiAgICBwdWJsaWMgc3RhdGljIHZvaWQgbWFpbihTdHJpbmdbXSBhcmdzKSB7XG4gICAgICAgIC8vIFNldCBzeXN0ZW0gdGltZSBmb3IgZGVidWdnaW5nIC0gaW4gcHJvZHVjdGlvbiB0aGlzIHdvdWxkIGJlIHJlbW92ZWRcbiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKFwiU3lzdGVtIHRpbWU6IFwiICsgbmV3IERhdGUoKSk7XG4gICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihcIlVzZXI6IGx1b25ndGFuMjA0dmlldFwiKTtcblxuICAgICAgICBTd2luZ1V0aWxpdGllcy5pbnZva2VMYXRlcigoKSAtPiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBhIHNhbXBsZSBlbXBsb3llZSBmb3IgdGVzdGluZ1xuICAgICAgICAgICAgICAgIE5oYW5WaWVuIG52ID0gbmV3IE5oYW5WaWVuKCk7XG4gICAgICAgICAgICAgICAgTmhhblZpZW5EQU8gbmhhblZpZW5EQU8gPSBuZXcgTmhhblZpZW5EQU9JbXBsKCk7XG4gICAgICAgICAgICAgICAgbnYgPSBuaGFuVmllbkRBTy5nZXRuaGFudmllbkJ5SWQoXCJOVjIwMjUwNDE4MDAwMVwiKTtcblxuICAgICAgICAgICAgICAgIFRyYWluVGlja2V0Qm9va2luZ1N5c3RlbSBhcHAgPSBuZXcgVHJhaW5UaWNrZXRCb29raW5nU3lzdGVtKG52KTtcbiAgICAgICAgICAgICAgICBhcHAuc2V0VmlzaWJsZSh0cnVlKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7XG4gICAgICAgICAgICAgICAgSk9wdGlvblBhbmUuc2hvd01lc3NhZ2VEaWFsb2cobnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiTOG7l2kga2jhu59pIMSR4buZbmcg4bupbmcgZOG7pW5nOiBcIiArIGUuZ2V0TWVzc2FnZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJM4buXaVwiLCBKT3B0aW9uUGFuZS5FUlJPUl9NRVNTQUdFKTtcbiAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59XG4uLi5cbiIsImlzRXJyb3IiOmZhbHNlLCJyZXF1ZXN0SWQiOiIifX19LCJkcmFmdEV4Y2hhbmdlIjp7InJlcXVlc3RfbWVzc2FnZSI6IiIsInJpY2hfdGV4dF9qc29uX3JlcHIiOnsidHlwZSI6ImRvYyIsImNvbnRlbnQiOlt7InR5cGUiOiJwYXJhZ3JhcGgifV19LCJtZW50aW9uZWRfaXRlbXMiOltdLCJzdGF0dXMiOiJkcmFmdCJ9LCJyZXF1ZXN0SWRzIjpbXSwiaXNQaW5uZWQiOmZhbHNlLCJpc1NoYXJlYWJsZSI6dHJ1ZSwiZXh0cmFEYXRhIjp7ImlzQWdlbnRDb252ZXJzYXRpb24iOnRydWUsImhhc0RpcnR5RWRpdHMiOmZhbHNlfSwicGVyc29uYVR5cGUiOjAsImRyYWZ0QWN0aXZlQ29udGV4dElkcyI6WyJFOi9MVFBUSkFWQS9OaG9tL1BoYW5UYW5KYXZhTmhvbUdQVC9Qcm9qZWN0X0JhblZlVGF1VGFpR2FzTGFjSG9uZy9zcmMvbWFpbi9qYXZhL2d1aUNsaWVudC9UcmFpblRpY2tldEJvb2tpbmdTeXN0ZW0uamF2YSIsIkU6L0xUUFRKQVZBL05ob20vUGhhblRhbkphdmFOaG9tR1BUL1Byb2plY3RfQmFuVmVUYXVUYWlHYXNMYWNIb25nZmFsc2VmYWxzZSIsImFnZW50TWVtb3JpZXMiXX0sImUzMTRjNzAwLTA5NTMtNGYzYy04MGQxLTI5OWY5YzdlNmMxMyI6eyJpZCI6ImUzMTRjNzAwLTA5NTMtNGYzYy04MGQxLTI5OWY5YzdlNmMxMyIsImNyZWF0ZWRBdElzbyI6IjIwMjUtMDQtMjJUMDk6MTg6MzcuMjI1WiIsImxhc3RJbnRlcmFjdGVkQXRJc28iOiIyMDI1LTA0LTIyVDA5OjE4OjM3LjIyNVoiLCJjaGF0SGlzdG9yeSI6W10sImZlZWRiYWNrU3RhdGVzIjp7fSwidG9vbFVzZVN0YXRlcyI6e30sImRyYWZ0RXhjaGFuZ2UiOnsicmVxdWVzdF9tZXNzYWdlIjoiIiwicmljaF90ZXh0X2pzb25fcmVwciI6eyJ0eXBlIjoiZG9jIiwiY29udGVudCI6W3sidHlwZSI6InBhcmFncmFwaCJ9XX0sIm1lbnRpb25lZF9pdGVtcyI6W10sInN0YXR1cyI6ImRyYWZ0In0sInJlcXVlc3RJZHMiOltdLCJpc1Bpbm5lZCI6ZmFsc2UsImlzU2hhcmVhYmxlIjpmYWxzZSwiZXh0cmFEYXRhIjp7ImlzQWdlbnRDb252ZXJzYXRpb24iOmZhbHNlLCJoYXNEaXJ0eUVkaXRzIjpmYWxzZX0sInBlcnNvbmFUeXBlIjowfX0sImFnZW50RXhlY3V0aW9uTW9kZSI6Im1hbnVhbCIsImlzQWdlbnRFZGl0c0NvbGxhcHNlZCI6dHJ1ZX0=" />
      </map>
    </option>
  </component>
</project>